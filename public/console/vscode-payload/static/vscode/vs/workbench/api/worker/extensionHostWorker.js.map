{"version":3,"sources":["out-vscode-web/vs/workbench/api/worker/fake","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/base/common/assert.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/base/common/collections.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/base/common/decorators.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/base/common/idGenerator.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/base/common/json.ts","out-vscode-web/vs/workbench/api/worker/vs/base/common/marked/marked.js","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/base/common/numbers.ts","out-vscode-web/vs/workbench/api/worker/vs/base/common/performance.js","out-vscode-web/vs/workbench/api/worker/vs/base/common/semver/semver.js","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/base/common/stream.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/base/common/buffer.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/base/common/uuid.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/editor/common/core/textModelDefaults.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/editor/common/languages/languageConfiguration.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/base/common/date.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/base/common/errorMessage.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/base/common/mime.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/base/common/extpath.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/base/common/map.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/base/common/filters.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/base/common/iconLabels.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/base/common/severity.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/base/common/marshalling.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/base/common/network.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/base/common/resources.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/base/common/async.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/base/common/comparers.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/base/common/glob.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/base/common/htmlContent.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/base/common/labels.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/base/common/uriIpc.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/editor/common/languageSelector.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/editor/common/services/semanticTokensDto.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/editor/common/config/editorOptions.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/editor/common/editor.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/extensions/common/extensionValidator.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/instantiation/common/descriptors.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/instantiation/common/extensions.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/instantiation/common/graph.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/instantiation/common/instantiation.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/configuration/common/configuration.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/contextkey/common/contextkey.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/environment/common/environment.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/extensionManagement/common/extensionManagement.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/files/common/files.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/instantiation/common/serviceCollection.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/instantiation/common/instantiationService.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/log/common/log.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/markers/common/markers.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/notification/common/notification.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/opener/common/opener.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/product/common/productService.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/progress/common/progress.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/registry/common/platform.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/jsonschemas/common/jsonContributionRegistry.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/configuration/common/configurationRegistry.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/configuration/common/configurationModels.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/remote/common/remoteAuthorityResolver.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/remote/common/remoteHosts.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/extensions/common/extensions.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/extensionManagement/common/extensionManagementUtil.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/terminal/common/terminalDataBuffering.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/theme/common/theme.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/theme/common/themeService.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/tunnel/common/tunnel.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/workspace/common/virtualWorkspace.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/platform/workspace/common/workspace.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/cache.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostFileSystemInfo.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostInitDataService.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostMemento.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostNotebookDocuments.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostRpcService.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostSecrets.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostTelemetry.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostTunnelService.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostTypes.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostDocumentData.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostTheming.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostUriTransformerService.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostWebviewMessaging.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/common/editor.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/common/webview.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostCodeInsets.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/contrib/debug/common/abstractDebugAdapter.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/contrib/debug/common/debug.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/contrib/debug/common/debugUtils.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/contrib/notebook/common/notebookCommon.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/contrib/notebook/common/notebookExecutionService.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/contrib/terminal/common/environmentVariableShared.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/contrib/testing/common/testId.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/contrib/testing/common/testTypes.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/contrib/testing/common/testItemCollection.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostTestingPrivateApi.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/services/configurationResolver/common/variableResolver.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/services/editor/common/editorGroupsService.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/services/editor/common/editorService.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostTypeConverters.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostDocumentSaveParticipant.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostNotebookDocument.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostNotebookEditor.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostNotebookEditors.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostProgress.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostTestItem.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostTextEditor.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/services/environment/common/environmentService.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/services/extensions/common/extensionDescriptionRegistry.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/services/extensions/common/extensionHostProtocol.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/services/extensions/common/extensions.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostExtensionActivator.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostLogService.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/services/extensions/common/extensionsApiProposals.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/services/extensions/common/extensionsRegistry.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/contrib/tasks/common/taskDefinitionRegistry.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/contrib/tasks/common/tasks.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/services/extensions/common/lazyPromise.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/services/extensions/common/proxyIdentifier.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHost.protocol.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/exHostSecretState.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostApiDeprecationService.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostAuthentication.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostBulkEdits.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostClipboard.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostCommands.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostApiCommands.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostComments.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostConsoleForwarder.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostDecorations.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostDiagnostics.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostDialogs.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostDocumentContentProviders.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostDocuments.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostDocumentsAndEditors.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostEditorTabs.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostFileSystem.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostFileSystemConsumer.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostFileSystemEventService.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostInteractive.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostLabelService.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostLanguageFeatures.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostLanguages.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostLoggerService.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostMessageService.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostNotebook.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostNotebookKernels.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostNotebookRenderers.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostQuickOpen.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostSCM.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostStatusBar.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostStorage.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostStoragePaths.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostTerminalService.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostTesting.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostTextEditors.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostTimeline.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostUriOpener.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostUrls.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostWebview.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostCustomEditors.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostWebviewPanels.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostWebviewView.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostWindow.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/worker/extHostConsoleForwarder.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/services/extensions/common/rpcProtocol.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/services/extensions/worker/polyfillNestedWorker.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/services/output/common/output.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostOutput.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/services/remote/common/remoteAgentService.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/services/path/common/pathService.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/services/search/common/searchExtTypes.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/services/search/common/search.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostWorkspace.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostConfiguration.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostTask.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/services/search/common/fileSearchManager.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/services/search/common/queryBuilder.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/services/extensions/common/workspaceContains.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostExtensionService.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostRequireInterceptor.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostVariableResolverService.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostDebugService.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extensionHostMain.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/services/search/common/textSearchManager.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostSearch.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHost.common.services.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/services/views/common/treeViewsService.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHostTreeViews.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/common/extHost.api.impl.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/worker/extHostExtensionService.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/worker/extHost.worker.services.ts","out-vscode-web/vs/workbench/api/worker/file:/Users/fezhang/workspace/github/github1s/vscode-web/lib/vscode/src/vs/workbench/api/worker/extensionHostWorker.ts"],"sourcesContent":["}).call(this);","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n/**\n * Throws an error with the provided message if the provided value does not evaluate to a true Javascript value.\n */\nexport function ok(value?: unknown, message?: string) {\n\tif (!value) {\n\t\tthrow new Error(message ? `Assertion failed (${message})` : 'Assertion Failed');\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n/**\n * An interface for a JavaScript object that\n * acts a dictionary. The keys are strings.\n */\nexport type IStringDictionary<V> = Record<string, V>;\n\n/**\n * An interface for a JavaScript object that\n * acts a dictionary. The keys are numbers.\n */\nexport type INumberDictionary<V> = Record<number, V>;\n\n/**\n * Groups the collection into a dictionary based on the provided\n * group function.\n */\nexport function groupBy<K extends string | number | symbol, V>(data: V[], groupFn: (element: V) => K): Record<K, V[]> {\n\tconst result: Record<K, V[]> = Object.create(null);\n\tfor (const element of data) {\n\t\tconst key = groupFn(element);\n\t\tlet target = result[key];\n\t\tif (!target) {\n\t\t\ttarget = result[key] = [];\n\t\t}\n\t\ttarget.push(element);\n\t}\n\treturn result;\n}\n\nexport function diffSets<T>(before: Set<T>, after: Set<T>): { removed: T[]; added: T[] } {\n\tconst removed: T[] = [];\n\tconst added: T[] = [];\n\tfor (const element of before) {\n\t\tif (!after.has(element)) {\n\t\t\tremoved.push(element);\n\t\t}\n\t}\n\tfor (const element of after) {\n\t\tif (!before.has(element)) {\n\t\t\tadded.push(element);\n\t\t}\n\t}\n\treturn { removed, added };\n}\n\nexport function diffMaps<K, V>(before: Map<K, V>, after: Map<K, V>): { removed: V[]; added: V[] } {\n\tconst removed: V[] = [];\n\tconst added: V[] = [];\n\tfor (const [index, value] of before) {\n\t\tif (!after.has(index)) {\n\t\t\tremoved.push(value);\n\t\t}\n\t}\n\tfor (const [index, value] of after) {\n\t\tif (!before.has(index)) {\n\t\t\tadded.push(value);\n\t\t}\n\t}\n\treturn { removed, added };\n}\nexport class SetMap<K, V> {\n\n\tprivate map = new Map<K, Set<V>>();\n\n\tadd(key: K, value: V): void {\n\t\tlet values = this.map.get(key);\n\n\t\tif (!values) {\n\t\t\tvalues = new Set<V>();\n\t\t\tthis.map.set(key, values);\n\t\t}\n\n\t\tvalues.add(value);\n\t}\n\n\tdelete(key: K, value: V): void {\n\t\tconst values = this.map.get(key);\n\n\t\tif (!values) {\n\t\t\treturn;\n\t\t}\n\n\t\tvalues.delete(value);\n\n\t\tif (values.size === 0) {\n\t\t\tthis.map.delete(key);\n\t\t}\n\t}\n\n\tforEach(key: K, fn: (value: V) => void): void {\n\t\tconst values = this.map.get(key);\n\n\t\tif (!values) {\n\t\t\treturn;\n\t\t}\n\n\t\tvalues.forEach(fn);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport function createDecorator(mapFn: (fn: Function, key: string) => Function): Function {\n\treturn (target: any, key: string, descriptor: any) => {\n\t\tlet fnKey: string | null = null;\n\t\tlet fn: Function | null = null;\n\n\t\tif (typeof descriptor.value === 'function') {\n\t\t\tfnKey = 'value';\n\t\t\tfn = descriptor.value;\n\t\t} else if (typeof descriptor.get === 'function') {\n\t\t\tfnKey = 'get';\n\t\t\tfn = descriptor.get;\n\t\t}\n\n\t\tif (!fn) {\n\t\t\tthrow new Error('not supported');\n\t\t}\n\n\t\tdescriptor[fnKey!] = mapFn(fn, key);\n\t};\n}\n\nexport function memoize(_target: any, key: string, descriptor: any) {\n\tlet fnKey: string | null = null;\n\tlet fn: Function | null = null;\n\n\tif (typeof descriptor.value === 'function') {\n\t\tfnKey = 'value';\n\t\tfn = descriptor.value;\n\n\t\tif (fn!.length !== 0) {\n\t\t\tconsole.warn('Memoize should only be used in functions with zero parameters');\n\t\t}\n\t} else if (typeof descriptor.get === 'function') {\n\t\tfnKey = 'get';\n\t\tfn = descriptor.get;\n\t}\n\n\tif (!fn) {\n\t\tthrow new Error('not supported');\n\t}\n\n\tconst memoizeKey = `$memoize$${key}`;\n\tdescriptor[fnKey!] = function (...args: any[]) {\n\t\tif (!this.hasOwnProperty(memoizeKey)) {\n\t\t\tObject.defineProperty(this, memoizeKey, {\n\t\t\t\tconfigurable: false,\n\t\t\t\tenumerable: false,\n\t\t\t\twritable: false,\n\t\t\t\tvalue: fn!.apply(this, args)\n\t\t\t});\n\t\t}\n\n\t\treturn this[memoizeKey];\n\t};\n}\n\nexport interface IDebounceReducer<T> {\n\t(previousValue: T, ...args: any[]): T;\n}\n\nexport function debounce<T>(delay: number, reducer?: IDebounceReducer<T>, initialValueProvider?: () => T): Function {\n\treturn createDecorator((fn, key) => {\n\t\tconst timerKey = `$debounce$${key}`;\n\t\tconst resultKey = `$debounce$result$${key}`;\n\n\t\treturn function (this: any, ...args: any[]) {\n\t\t\tif (!this[resultKey]) {\n\t\t\t\tthis[resultKey] = initialValueProvider ? initialValueProvider() : undefined;\n\t\t\t}\n\n\t\t\tclearTimeout(this[timerKey]);\n\n\t\t\tif (reducer) {\n\t\t\t\tthis[resultKey] = reducer(this[resultKey], ...args);\n\t\t\t\targs = [this[resultKey]];\n\t\t\t}\n\n\t\t\tthis[timerKey] = setTimeout(() => {\n\t\t\t\tfn.apply(this, args);\n\t\t\t\tthis[resultKey] = initialValueProvider ? initialValueProvider() : undefined;\n\t\t\t}, delay);\n\t\t};\n\t});\n}\n\nexport function throttle<T>(delay: number, reducer?: IDebounceReducer<T>, initialValueProvider?: () => T): Function {\n\treturn createDecorator((fn, key) => {\n\t\tconst timerKey = `$throttle$timer$${key}`;\n\t\tconst resultKey = `$throttle$result$${key}`;\n\t\tconst lastRunKey = `$throttle$lastRun$${key}`;\n\t\tconst pendingKey = `$throttle$pending$${key}`;\n\n\t\treturn function (this: any, ...args: any[]) {\n\t\t\tif (!this[resultKey]) {\n\t\t\t\tthis[resultKey] = initialValueProvider ? initialValueProvider() : undefined;\n\t\t\t}\n\t\t\tif (this[lastRunKey] === null || this[lastRunKey] === undefined) {\n\t\t\t\tthis[lastRunKey] = -Number.MAX_VALUE;\n\t\t\t}\n\n\t\t\tif (reducer) {\n\t\t\t\tthis[resultKey] = reducer(this[resultKey], ...args);\n\t\t\t}\n\n\t\t\tif (this[pendingKey]) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst nextTime = this[lastRunKey] + delay;\n\t\t\tif (nextTime <= Date.now()) {\n\t\t\t\tthis[lastRunKey] = Date.now();\n\t\t\t\tfn.apply(this, [this[resultKey]]);\n\t\t\t\tthis[resultKey] = initialValueProvider ? initialValueProvider() : undefined;\n\t\t\t} else {\n\t\t\t\tthis[pendingKey] = true;\n\t\t\t\tthis[timerKey] = setTimeout(() => {\n\t\t\t\t\tthis[pendingKey] = false;\n\t\t\t\t\tthis[lastRunKey] = Date.now();\n\t\t\t\t\tfn.apply(this, [this[resultKey]]);\n\t\t\t\t\tthis[resultKey] = initialValueProvider ? initialValueProvider() : undefined;\n\t\t\t\t}, nextTime - Date.now());\n\t\t\t}\n\t\t};\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport class IdGenerator {\n\n\tprivate _prefix: string;\n\tprivate _lastId: number;\n\n\tconstructor(prefix: string) {\n\t\tthis._prefix = prefix;\n\t\tthis._lastId = 0;\n\t}\n\n\tpublic nextId(): string {\n\t\treturn this._prefix + (++this._lastId);\n\t}\n}\n\nexport const defaultGenerator = new IdGenerator('id#');","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport const enum ScanError {\n\tNone = 0,\n\tUnexpectedEndOfComment = 1,\n\tUnexpectedEndOfString = 2,\n\tUnexpectedEndOfNumber = 3,\n\tInvalidUnicode = 4,\n\tInvalidEscapeCharacter = 5,\n\tInvalidCharacter = 6\n}\n\nexport const enum SyntaxKind {\n\tOpenBraceToken = 1,\n\tCloseBraceToken = 2,\n\tOpenBracketToken = 3,\n\tCloseBracketToken = 4,\n\tCommaToken = 5,\n\tColonToken = 6,\n\tNullKeyword = 7,\n\tTrueKeyword = 8,\n\tFalseKeyword = 9,\n\tStringLiteral = 10,\n\tNumericLiteral = 11,\n\tLineCommentTrivia = 12,\n\tBlockCommentTrivia = 13,\n\tLineBreakTrivia = 14,\n\tTrivia = 15,\n\tUnknown = 16,\n\tEOF = 17\n}\n\n/**\n * The scanner object, representing a JSON scanner at a position in the input string.\n */\nexport interface JSONScanner {\n\t/**\n\t * Sets the scan position to a new offset. A call to 'scan' is needed to get the first token.\n\t */\n\tsetPosition(pos: number): void;\n\t/**\n\t * Read the next token. Returns the token code.\n\t */\n\tscan(): SyntaxKind;\n\t/**\n\t * Returns the current scan position, which is after the last read token.\n\t */\n\tgetPosition(): number;\n\t/**\n\t * Returns the last read token.\n\t */\n\tgetToken(): SyntaxKind;\n\t/**\n\t * Returns the last read token value. The value for strings is the decoded string content. For numbers its of type number, for boolean it's true or false.\n\t */\n\tgetTokenValue(): string;\n\t/**\n\t * The start offset of the last read token.\n\t */\n\tgetTokenOffset(): number;\n\t/**\n\t * The length of the last read token.\n\t */\n\tgetTokenLength(): number;\n\t/**\n\t * An error code of the last scan.\n\t */\n\tgetTokenError(): ScanError;\n}\n\n\n\nexport interface ParseError {\n\terror: ParseErrorCode;\n\toffset: number;\n\tlength: number;\n}\n\nexport const enum ParseErrorCode {\n\tInvalidSymbol = 1,\n\tInvalidNumberFormat = 2,\n\tPropertyNameExpected = 3,\n\tValueExpected = 4,\n\tColonExpected = 5,\n\tCommaExpected = 6,\n\tCloseBraceExpected = 7,\n\tCloseBracketExpected = 8,\n\tEndOfFileExpected = 9,\n\tInvalidCommentToken = 10,\n\tUnexpectedEndOfComment = 11,\n\tUnexpectedEndOfString = 12,\n\tUnexpectedEndOfNumber = 13,\n\tInvalidUnicode = 14,\n\tInvalidEscapeCharacter = 15,\n\tInvalidCharacter = 16\n}\n\nexport type NodeType = 'object' | 'array' | 'property' | 'string' | 'number' | 'boolean' | 'null';\n\nexport interface Node {\n\treadonly type: NodeType;\n\treadonly value?: any;\n\treadonly offset: number;\n\treadonly length: number;\n\treadonly colonOffset?: number;\n\treadonly parent?: Node;\n\treadonly children?: Node[];\n}\n\nexport type Segment = string | number;\nexport type JSONPath = Segment[];\n\nexport interface Location {\n\t/**\n\t * The previous property key or literal value (string, number, boolean or null) or undefined.\n\t */\n\tpreviousNode?: Node;\n\t/**\n\t * The path describing the location in the JSON document. The path consists of a sequence strings\n\t * representing an object property or numbers for array indices.\n\t */\n\tpath: JSONPath;\n\t/**\n\t * Matches the locations path against a pattern consisting of strings (for properties) and numbers (for array indices).\n\t * '*' will match a single segment, of any property name or index.\n\t * '**' will match a sequence of segments or no segment, of any property name or index.\n\t */\n\tmatches: (patterns: JSONPath) => boolean;\n\t/**\n\t * If set, the location's offset is at a property key.\n\t */\n\tisAtPropertyKey: boolean;\n}\n\nexport interface ParseOptions {\n\tdisallowComments?: boolean;\n\tallowTrailingComma?: boolean;\n\tallowEmptyContent?: boolean;\n}\n\nexport namespace ParseOptions {\n\texport const DEFAULT = {\n\t\tallowTrailingComma: true\n\t};\n}\n\nexport interface JSONVisitor {\n\t/**\n\t * Invoked when an open brace is encountered and an object is started. The offset and length represent the location of the open brace.\n\t */\n\tonObjectBegin?: (offset: number, length: number) => void;\n\n\t/**\n\t * Invoked when a property is encountered. The offset and length represent the location of the property name.\n\t */\n\tonObjectProperty?: (property: string, offset: number, length: number) => void;\n\n\t/**\n\t * Invoked when a closing brace is encountered and an object is completed. The offset and length represent the location of the closing brace.\n\t */\n\tonObjectEnd?: (offset: number, length: number) => void;\n\n\t/**\n\t * Invoked when an open bracket is encountered. The offset and length represent the location of the open bracket.\n\t */\n\tonArrayBegin?: (offset: number, length: number) => void;\n\n\t/**\n\t * Invoked when a closing bracket is encountered. The offset and length represent the location of the closing bracket.\n\t */\n\tonArrayEnd?: (offset: number, length: number) => void;\n\n\t/**\n\t * Invoked when a literal value is encountered. The offset and length represent the location of the literal value.\n\t */\n\tonLiteralValue?: (value: any, offset: number, length: number) => void;\n\n\t/**\n\t * Invoked when a comma or colon separator is encountered. The offset and length represent the location of the separator.\n\t */\n\tonSeparator?: (character: string, offset: number, length: number) => void;\n\n\t/**\n\t * When comments are allowed, invoked when a line or block comment is encountered. The offset and length represent the location of the comment.\n\t */\n\tonComment?: (offset: number, length: number) => void;\n\n\t/**\n\t * Invoked on an error.\n\t */\n\tonError?: (error: ParseErrorCode, offset: number, length: number) => void;\n}\n\n/**\n * Creates a JSON scanner on the given text.\n * If ignoreTrivia is set, whitespaces or comments are ignored.\n */\nexport function createScanner(text: string, ignoreTrivia: boolean = false): JSONScanner {\n\n\tlet pos = 0;\n\tconst len = text.length;\n\tlet value: string = '';\n\tlet tokenOffset = 0;\n\tlet token: SyntaxKind = SyntaxKind.Unknown;\n\tlet scanError: ScanError = ScanError.None;\n\n\tfunction scanHexDigits(count: number): number {\n\t\tlet digits = 0;\n\t\tlet hexValue = 0;\n\t\twhile (digits < count) {\n\t\t\tconst ch = text.charCodeAt(pos);\n\t\t\tif (ch >= CharacterCodes._0 && ch <= CharacterCodes._9) {\n\t\t\t\thexValue = hexValue * 16 + ch - CharacterCodes._0;\n\t\t\t}\n\t\t\telse if (ch >= CharacterCodes.A && ch <= CharacterCodes.F) {\n\t\t\t\thexValue = hexValue * 16 + ch - CharacterCodes.A + 10;\n\t\t\t}\n\t\t\telse if (ch >= CharacterCodes.a && ch <= CharacterCodes.f) {\n\t\t\t\thexValue = hexValue * 16 + ch - CharacterCodes.a + 10;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tpos++;\n\t\t\tdigits++;\n\t\t}\n\t\tif (digits < count) {\n\t\t\thexValue = -1;\n\t\t}\n\t\treturn hexValue;\n\t}\n\n\tfunction setPosition(newPosition: number) {\n\t\tpos = newPosition;\n\t\tvalue = '';\n\t\ttokenOffset = 0;\n\t\ttoken = SyntaxKind.Unknown;\n\t\tscanError = ScanError.None;\n\t}\n\n\tfunction scanNumber(): string {\n\t\tconst start = pos;\n\t\tif (text.charCodeAt(pos) === CharacterCodes._0) {\n\t\t\tpos++;\n\t\t} else {\n\t\t\tpos++;\n\t\t\twhile (pos < text.length && isDigit(text.charCodeAt(pos))) {\n\t\t\t\tpos++;\n\t\t\t}\n\t\t}\n\t\tif (pos < text.length && text.charCodeAt(pos) === CharacterCodes.dot) {\n\t\t\tpos++;\n\t\t\tif (pos < text.length && isDigit(text.charCodeAt(pos))) {\n\t\t\t\tpos++;\n\t\t\t\twhile (pos < text.length && isDigit(text.charCodeAt(pos))) {\n\t\t\t\t\tpos++;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tscanError = ScanError.UnexpectedEndOfNumber;\n\t\t\t\treturn text.substring(start, pos);\n\t\t\t}\n\t\t}\n\t\tlet end = pos;\n\t\tif (pos < text.length && (text.charCodeAt(pos) === CharacterCodes.E || text.charCodeAt(pos) === CharacterCodes.e)) {\n\t\t\tpos++;\n\t\t\tif (pos < text.length && text.charCodeAt(pos) === CharacterCodes.plus || text.charCodeAt(pos) === CharacterCodes.minus) {\n\t\t\t\tpos++;\n\t\t\t}\n\t\t\tif (pos < text.length && isDigit(text.charCodeAt(pos))) {\n\t\t\t\tpos++;\n\t\t\t\twhile (pos < text.length && isDigit(text.charCodeAt(pos))) {\n\t\t\t\t\tpos++;\n\t\t\t\t}\n\t\t\t\tend = pos;\n\t\t\t} else {\n\t\t\t\tscanError = ScanError.UnexpectedEndOfNumber;\n\t\t\t}\n\t\t}\n\t\treturn text.substring(start, end);\n\t}\n\n\tfunction scanString(): string {\n\n\t\tlet result = '',\n\t\t\tstart = pos;\n\n\t\twhile (true) {\n\t\t\tif (pos >= len) {\n\t\t\t\tresult += text.substring(start, pos);\n\t\t\t\tscanError = ScanError.UnexpectedEndOfString;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tconst ch = text.charCodeAt(pos);\n\t\t\tif (ch === CharacterCodes.doubleQuote) {\n\t\t\t\tresult += text.substring(start, pos);\n\t\t\t\tpos++;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (ch === CharacterCodes.backslash) {\n\t\t\t\tresult += text.substring(start, pos);\n\t\t\t\tpos++;\n\t\t\t\tif (pos >= len) {\n\t\t\t\t\tscanError = ScanError.UnexpectedEndOfString;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tconst ch2 = text.charCodeAt(pos++);\n\t\t\t\tswitch (ch2) {\n\t\t\t\t\tcase CharacterCodes.doubleQuote:\n\t\t\t\t\t\tresult += '\\\"';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase CharacterCodes.backslash:\n\t\t\t\t\t\tresult += '\\\\';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase CharacterCodes.slash:\n\t\t\t\t\t\tresult += '/';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase CharacterCodes.b:\n\t\t\t\t\t\tresult += '\\b';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase CharacterCodes.f:\n\t\t\t\t\t\tresult += '\\f';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase CharacterCodes.n:\n\t\t\t\t\t\tresult += '\\n';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase CharacterCodes.r:\n\t\t\t\t\t\tresult += '\\r';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase CharacterCodes.t:\n\t\t\t\t\t\tresult += '\\t';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase CharacterCodes.u: {\n\t\t\t\t\t\tconst ch3 = scanHexDigits(4);\n\t\t\t\t\t\tif (ch3 >= 0) {\n\t\t\t\t\t\t\tresult += String.fromCharCode(ch3);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tscanError = ScanError.InvalidUnicode;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tscanError = ScanError.InvalidEscapeCharacter;\n\t\t\t\t}\n\t\t\t\tstart = pos;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (ch >= 0 && ch <= 0x1F) {\n\t\t\t\tif (isLineBreak(ch)) {\n\t\t\t\t\tresult += text.substring(start, pos);\n\t\t\t\t\tscanError = ScanError.UnexpectedEndOfString;\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\tscanError = ScanError.InvalidCharacter;\n\t\t\t\t\t// mark as error but continue with string\n\t\t\t\t}\n\t\t\t}\n\t\t\tpos++;\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction scanNext(): SyntaxKind {\n\n\t\tvalue = '';\n\t\tscanError = ScanError.None;\n\n\t\ttokenOffset = pos;\n\n\t\tif (pos >= len) {\n\t\t\t// at the end\n\t\t\ttokenOffset = len;\n\t\t\treturn token = SyntaxKind.EOF;\n\t\t}\n\n\t\tlet code = text.charCodeAt(pos);\n\t\t// trivia: whitespace\n\t\tif (isWhitespace(code)) {\n\t\t\tdo {\n\t\t\t\tpos++;\n\t\t\t\tvalue += String.fromCharCode(code);\n\t\t\t\tcode = text.charCodeAt(pos);\n\t\t\t} while (isWhitespace(code));\n\n\t\t\treturn token = SyntaxKind.Trivia;\n\t\t}\n\n\t\t// trivia: newlines\n\t\tif (isLineBreak(code)) {\n\t\t\tpos++;\n\t\t\tvalue += String.fromCharCode(code);\n\t\t\tif (code === CharacterCodes.carriageReturn && text.charCodeAt(pos) === CharacterCodes.lineFeed) {\n\t\t\t\tpos++;\n\t\t\t\tvalue += '\\n';\n\t\t\t}\n\t\t\treturn token = SyntaxKind.LineBreakTrivia;\n\t\t}\n\n\t\tswitch (code) {\n\t\t\t// tokens: []{}:,\n\t\t\tcase CharacterCodes.openBrace:\n\t\t\t\tpos++;\n\t\t\t\treturn token = SyntaxKind.OpenBraceToken;\n\t\t\tcase CharacterCodes.closeBrace:\n\t\t\t\tpos++;\n\t\t\t\treturn token = SyntaxKind.CloseBraceToken;\n\t\t\tcase CharacterCodes.openBracket:\n\t\t\t\tpos++;\n\t\t\t\treturn token = SyntaxKind.OpenBracketToken;\n\t\t\tcase CharacterCodes.closeBracket:\n\t\t\t\tpos++;\n\t\t\t\treturn token = SyntaxKind.CloseBracketToken;\n\t\t\tcase CharacterCodes.colon:\n\t\t\t\tpos++;\n\t\t\t\treturn token = SyntaxKind.ColonToken;\n\t\t\tcase CharacterCodes.comma:\n\t\t\t\tpos++;\n\t\t\t\treturn token = SyntaxKind.CommaToken;\n\n\t\t\t// strings\n\t\t\tcase CharacterCodes.doubleQuote:\n\t\t\t\tpos++;\n\t\t\t\tvalue = scanString();\n\t\t\t\treturn token = SyntaxKind.StringLiteral;\n\n\t\t\t// comments\n\t\t\tcase CharacterCodes.slash: {\n\t\t\t\tconst start = pos - 1;\n\t\t\t\t// Single-line comment\n\t\t\t\tif (text.charCodeAt(pos + 1) === CharacterCodes.slash) {\n\t\t\t\t\tpos += 2;\n\n\t\t\t\t\twhile (pos < len) {\n\t\t\t\t\t\tif (isLineBreak(text.charCodeAt(pos))) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpos++;\n\n\t\t\t\t\t}\n\t\t\t\t\tvalue = text.substring(start, pos);\n\t\t\t\t\treturn token = SyntaxKind.LineCommentTrivia;\n\t\t\t\t}\n\n\t\t\t\t// Multi-line comment\n\t\t\t\tif (text.charCodeAt(pos + 1) === CharacterCodes.asterisk) {\n\t\t\t\t\tpos += 2;\n\n\t\t\t\t\tconst safeLength = len - 1; // For lookahead.\n\t\t\t\t\tlet commentClosed = false;\n\t\t\t\t\twhile (pos < safeLength) {\n\t\t\t\t\t\tconst ch = text.charCodeAt(pos);\n\n\t\t\t\t\t\tif (ch === CharacterCodes.asterisk && text.charCodeAt(pos + 1) === CharacterCodes.slash) {\n\t\t\t\t\t\t\tpos += 2;\n\t\t\t\t\t\t\tcommentClosed = true;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpos++;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!commentClosed) {\n\t\t\t\t\t\tpos++;\n\t\t\t\t\t\tscanError = ScanError.UnexpectedEndOfComment;\n\t\t\t\t\t}\n\n\t\t\t\t\tvalue = text.substring(start, pos);\n\t\t\t\t\treturn token = SyntaxKind.BlockCommentTrivia;\n\t\t\t\t}\n\t\t\t\t// just a single slash\n\t\t\t\tvalue += String.fromCharCode(code);\n\t\t\t\tpos++;\n\t\t\t\treturn token = SyntaxKind.Unknown;\n\t\t\t}\n\t\t\t// numbers\n\t\t\tcase CharacterCodes.minus:\n\t\t\t\tvalue += String.fromCharCode(code);\n\t\t\t\tpos++;\n\t\t\t\tif (pos === len || !isDigit(text.charCodeAt(pos))) {\n\t\t\t\t\treturn token = SyntaxKind.Unknown;\n\t\t\t\t}\n\t\t\t// found a minus, followed by a number so\n\t\t\t// we fall through to proceed with scanning\n\t\t\t// numbers\n\t\t\tcase CharacterCodes._0:\n\t\t\tcase CharacterCodes._1:\n\t\t\tcase CharacterCodes._2:\n\t\t\tcase CharacterCodes._3:\n\t\t\tcase CharacterCodes._4:\n\t\t\tcase CharacterCodes._5:\n\t\t\tcase CharacterCodes._6:\n\t\t\tcase CharacterCodes._7:\n\t\t\tcase CharacterCodes._8:\n\t\t\tcase CharacterCodes._9:\n\t\t\t\tvalue += scanNumber();\n\t\t\t\treturn token = SyntaxKind.NumericLiteral;\n\t\t\t// literals and unknown symbols\n\t\t\tdefault:\n\t\t\t\t// is a literal? Read the full word.\n\t\t\t\twhile (pos < len && isUnknownContentCharacter(code)) {\n\t\t\t\t\tpos++;\n\t\t\t\t\tcode = text.charCodeAt(pos);\n\t\t\t\t}\n\t\t\t\tif (tokenOffset !== pos) {\n\t\t\t\t\tvalue = text.substring(tokenOffset, pos);\n\t\t\t\t\t// keywords: true, false, null\n\t\t\t\t\tswitch (value) {\n\t\t\t\t\t\tcase 'true': return token = SyntaxKind.TrueKeyword;\n\t\t\t\t\t\tcase 'false': return token = SyntaxKind.FalseKeyword;\n\t\t\t\t\t\tcase 'null': return token = SyntaxKind.NullKeyword;\n\t\t\t\t\t}\n\t\t\t\t\treturn token = SyntaxKind.Unknown;\n\t\t\t\t}\n\t\t\t\t// some\n\t\t\t\tvalue += String.fromCharCode(code);\n\t\t\t\tpos++;\n\t\t\t\treturn token = SyntaxKind.Unknown;\n\t\t}\n\t}\n\n\tfunction isUnknownContentCharacter(code: CharacterCodes) {\n\t\tif (isWhitespace(code) || isLineBreak(code)) {\n\t\t\treturn false;\n\t\t}\n\t\tswitch (code) {\n\t\t\tcase CharacterCodes.closeBrace:\n\t\t\tcase CharacterCodes.closeBracket:\n\t\t\tcase CharacterCodes.openBrace:\n\t\t\tcase CharacterCodes.openBracket:\n\t\t\tcase CharacterCodes.doubleQuote:\n\t\t\tcase CharacterCodes.colon:\n\t\t\tcase CharacterCodes.comma:\n\t\t\tcase CharacterCodes.slash:\n\t\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\n\tfunction scanNextNonTrivia(): SyntaxKind {\n\t\tlet result: SyntaxKind;\n\t\tdo {\n\t\t\tresult = scanNext();\n\t\t} while (result >= SyntaxKind.LineCommentTrivia && result <= SyntaxKind.Trivia);\n\t\treturn result;\n\t}\n\n\treturn {\n\t\tsetPosition: setPosition,\n\t\tgetPosition: () => pos,\n\t\tscan: ignoreTrivia ? scanNextNonTrivia : scanNext,\n\t\tgetToken: () => token,\n\t\tgetTokenValue: () => value,\n\t\tgetTokenOffset: () => tokenOffset,\n\t\tgetTokenLength: () => pos - tokenOffset,\n\t\tgetTokenError: () => scanError\n\t};\n}\n\nfunction isWhitespace(ch: number): boolean {\n\treturn ch === CharacterCodes.space || ch === CharacterCodes.tab || ch === CharacterCodes.verticalTab || ch === CharacterCodes.formFeed ||\n\t\tch === CharacterCodes.nonBreakingSpace || ch === CharacterCodes.ogham || ch >= CharacterCodes.enQuad && ch <= CharacterCodes.zeroWidthSpace ||\n\t\tch === CharacterCodes.narrowNoBreakSpace || ch === CharacterCodes.mathematicalSpace || ch === CharacterCodes.ideographicSpace || ch === CharacterCodes.byteOrderMark;\n}\n\nfunction isLineBreak(ch: number): boolean {\n\treturn ch === CharacterCodes.lineFeed || ch === CharacterCodes.carriageReturn || ch === CharacterCodes.lineSeparator || ch === CharacterCodes.paragraphSeparator;\n}\n\nfunction isDigit(ch: number): boolean {\n\treturn ch >= CharacterCodes._0 && ch <= CharacterCodes._9;\n}\n\nconst enum CharacterCodes {\n\tnullCharacter = 0,\n\tmaxAsciiCharacter = 0x7F,\n\n\tlineFeed = 0x0A,              // \\n\n\tcarriageReturn = 0x0D,        // \\r\n\tlineSeparator = 0x2028,\n\tparagraphSeparator = 0x2029,\n\n\t// REVIEW: do we need to support this?  The scanner doesn't, but our IText does.  This seems\n\t// like an odd disparity?  (Or maybe it's completely fine for them to be different).\n\tnextLine = 0x0085,\n\n\t// Unicode 3.0 space characters\n\tspace = 0x0020,   // \" \"\n\tnonBreakingSpace = 0x00A0,   //\n\tenQuad = 0x2000,\n\temQuad = 0x2001,\n\tenSpace = 0x2002,\n\temSpace = 0x2003,\n\tthreePerEmSpace = 0x2004,\n\tfourPerEmSpace = 0x2005,\n\tsixPerEmSpace = 0x2006,\n\tfigureSpace = 0x2007,\n\tpunctuationSpace = 0x2008,\n\tthinSpace = 0x2009,\n\thairSpace = 0x200A,\n\tzeroWidthSpace = 0x200B,\n\tnarrowNoBreakSpace = 0x202F,\n\tideographicSpace = 0x3000,\n\tmathematicalSpace = 0x205F,\n\togham = 0x1680,\n\n\t_ = 0x5F,\n\t$ = 0x24,\n\n\t_0 = 0x30,\n\t_1 = 0x31,\n\t_2 = 0x32,\n\t_3 = 0x33,\n\t_4 = 0x34,\n\t_5 = 0x35,\n\t_6 = 0x36,\n\t_7 = 0x37,\n\t_8 = 0x38,\n\t_9 = 0x39,\n\n\ta = 0x61,\n\tb = 0x62,\n\tc = 0x63,\n\td = 0x64,\n\te = 0x65,\n\tf = 0x66,\n\tg = 0x67,\n\th = 0x68,\n\ti = 0x69,\n\tj = 0x6A,\n\tk = 0x6B,\n\tl = 0x6C,\n\tm = 0x6D,\n\tn = 0x6E,\n\to = 0x6F,\n\tp = 0x70,\n\tq = 0x71,\n\tr = 0x72,\n\ts = 0x73,\n\tt = 0x74,\n\tu = 0x75,\n\tv = 0x76,\n\tw = 0x77,\n\tx = 0x78,\n\ty = 0x79,\n\tz = 0x7A,\n\n\tA = 0x41,\n\tB = 0x42,\n\tC = 0x43,\n\tD = 0x44,\n\tE = 0x45,\n\tF = 0x46,\n\tG = 0x47,\n\tH = 0x48,\n\tI = 0x49,\n\tJ = 0x4A,\n\tK = 0x4B,\n\tL = 0x4C,\n\tM = 0x4D,\n\tN = 0x4E,\n\tO = 0x4F,\n\tP = 0x50,\n\tQ = 0x51,\n\tR = 0x52,\n\tS = 0x53,\n\tT = 0x54,\n\tU = 0x55,\n\tV = 0x56,\n\tW = 0x57,\n\tX = 0x58,\n\tY = 0x59,\n\tZ = 0x5A,\n\n\tampersand = 0x26,             // &\n\tasterisk = 0x2A,              // *\n\tat = 0x40,                    // @\n\tbackslash = 0x5C,             // \\\n\tbar = 0x7C,                   // |\n\tcaret = 0x5E,                 // ^\n\tcloseBrace = 0x7D,            // }\n\tcloseBracket = 0x5D,          // ]\n\tcloseParen = 0x29,            // )\n\tcolon = 0x3A,                 // :\n\tcomma = 0x2C,                 // ,\n\tdot = 0x2E,                   // .\n\tdoubleQuote = 0x22,           // \"\n\tequals = 0x3D,                // =\n\texclamation = 0x21,           // !\n\tgreaterThan = 0x3E,           // >\n\tlessThan = 0x3C,              // <\n\tminus = 0x2D,                 // -\n\topenBrace = 0x7B,             // {\n\topenBracket = 0x5B,           // [\n\topenParen = 0x28,             // (\n\tpercent = 0x25,               // %\n\tplus = 0x2B,                  // +\n\tquestion = 0x3F,              // ?\n\tsemicolon = 0x3B,             // ;\n\tsingleQuote = 0x27,           // '\n\tslash = 0x2F,                 // /\n\ttilde = 0x7E,                 // ~\n\n\tbackspace = 0x08,             // \\b\n\tformFeed = 0x0C,              // \\f\n\tbyteOrderMark = 0xFEFF,\n\ttab = 0x09,                   // \\t\n\tverticalTab = 0x0B,           // \\v\n}\n\ninterface NodeImpl extends Node {\n\ttype: NodeType;\n\tvalue?: any;\n\toffset: number;\n\tlength: number;\n\tcolonOffset?: number;\n\tparent?: NodeImpl;\n\tchildren?: NodeImpl[];\n}\n\n/**\n * For a given offset, evaluate the location in the JSON document. Each segment in the location path is either a property name or an array index.\n */\nexport function getLocation(text: string, position: number): Location {\n\tconst segments: Segment[] = []; // strings or numbers\n\tconst earlyReturnException = new Object();\n\tlet previousNode: NodeImpl | undefined = undefined;\n\tconst previousNodeInst: NodeImpl = {\n\t\tvalue: {},\n\t\toffset: 0,\n\t\tlength: 0,\n\t\ttype: 'object',\n\t\tparent: undefined\n\t};\n\tlet isAtPropertyKey = false;\n\tfunction setPreviousNode(value: string, offset: number, length: number, type: NodeType) {\n\t\tpreviousNodeInst.value = value;\n\t\tpreviousNodeInst.offset = offset;\n\t\tpreviousNodeInst.length = length;\n\t\tpreviousNodeInst.type = type;\n\t\tpreviousNodeInst.colonOffset = undefined;\n\t\tpreviousNode = previousNodeInst;\n\t}\n\ttry {\n\n\t\tvisit(text, {\n\t\t\tonObjectBegin: (offset: number, length: number) => {\n\t\t\t\tif (position <= offset) {\n\t\t\t\t\tthrow earlyReturnException;\n\t\t\t\t}\n\t\t\t\tpreviousNode = undefined;\n\t\t\t\tisAtPropertyKey = position > offset;\n\t\t\t\tsegments.push(''); // push a placeholder (will be replaced)\n\t\t\t},\n\t\t\tonObjectProperty: (name: string, offset: number, length: number) => {\n\t\t\t\tif (position < offset) {\n\t\t\t\t\tthrow earlyReturnException;\n\t\t\t\t}\n\t\t\t\tsetPreviousNode(name, offset, length, 'property');\n\t\t\t\tsegments[segments.length - 1] = name;\n\t\t\t\tif (position <= offset + length) {\n\t\t\t\t\tthrow earlyReturnException;\n\t\t\t\t}\n\t\t\t},\n\t\t\tonObjectEnd: (offset: number, length: number) => {\n\t\t\t\tif (position <= offset) {\n\t\t\t\t\tthrow earlyReturnException;\n\t\t\t\t}\n\t\t\t\tpreviousNode = undefined;\n\t\t\t\tsegments.pop();\n\t\t\t},\n\t\t\tonArrayBegin: (offset: number, length: number) => {\n\t\t\t\tif (position <= offset) {\n\t\t\t\t\tthrow earlyReturnException;\n\t\t\t\t}\n\t\t\t\tpreviousNode = undefined;\n\t\t\t\tsegments.push(0);\n\t\t\t},\n\t\t\tonArrayEnd: (offset: number, length: number) => {\n\t\t\t\tif (position <= offset) {\n\t\t\t\t\tthrow earlyReturnException;\n\t\t\t\t}\n\t\t\t\tpreviousNode = undefined;\n\t\t\t\tsegments.pop();\n\t\t\t},\n\t\t\tonLiteralValue: (value: any, offset: number, length: number) => {\n\t\t\t\tif (position < offset) {\n\t\t\t\t\tthrow earlyReturnException;\n\t\t\t\t}\n\t\t\t\tsetPreviousNode(value, offset, length, getNodeType(value));\n\n\t\t\t\tif (position <= offset + length) {\n\t\t\t\t\tthrow earlyReturnException;\n\t\t\t\t}\n\t\t\t},\n\t\t\tonSeparator: (sep: string, offset: number, length: number) => {\n\t\t\t\tif (position <= offset) {\n\t\t\t\t\tthrow earlyReturnException;\n\t\t\t\t}\n\t\t\t\tif (sep === ':' && previousNode && previousNode.type === 'property') {\n\t\t\t\t\tpreviousNode.colonOffset = offset;\n\t\t\t\t\tisAtPropertyKey = false;\n\t\t\t\t\tpreviousNode = undefined;\n\t\t\t\t} else if (sep === ',') {\n\t\t\t\t\tconst last = segments[segments.length - 1];\n\t\t\t\t\tif (typeof last === 'number') {\n\t\t\t\t\t\tsegments[segments.length - 1] = last + 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tisAtPropertyKey = true;\n\t\t\t\t\t\tsegments[segments.length - 1] = '';\n\t\t\t\t\t}\n\t\t\t\t\tpreviousNode = undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t} catch (e) {\n\t\tif (e !== earlyReturnException) {\n\t\t\tthrow e;\n\t\t}\n\t}\n\n\treturn {\n\t\tpath: segments,\n\t\tpreviousNode,\n\t\tisAtPropertyKey,\n\t\tmatches: (pattern: Segment[]) => {\n\t\t\tlet k = 0;\n\t\t\tfor (let i = 0; k < pattern.length && i < segments.length; i++) {\n\t\t\t\tif (pattern[k] === segments[i] || pattern[k] === '*') {\n\t\t\t\t\tk++;\n\t\t\t\t} else if (pattern[k] !== '**') {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn k === pattern.length;\n\t\t}\n\t};\n}\n\n\n/**\n * Parses the given text and returns the object the JSON content represents. On invalid input, the parser tries to be as fault tolerant as possible, but still return a result.\n * Therefore always check the errors list to find out if the input was valid.\n */\nexport function parse(text: string, errors: ParseError[] = [], options: ParseOptions = ParseOptions.DEFAULT): any {\n\tlet currentProperty: string | null = null;\n\tlet currentParent: any = [];\n\tconst previousParents: any[] = [];\n\n\tfunction onValue(value: any) {\n\t\tif (Array.isArray(currentParent)) {\n\t\t\t(<any[]>currentParent).push(value);\n\t\t} else if (currentProperty !== null) {\n\t\t\tcurrentParent[currentProperty] = value;\n\t\t}\n\t}\n\n\tconst visitor: JSONVisitor = {\n\t\tonObjectBegin: () => {\n\t\t\tconst object = {};\n\t\t\tonValue(object);\n\t\t\tpreviousParents.push(currentParent);\n\t\t\tcurrentParent = object;\n\t\t\tcurrentProperty = null;\n\t\t},\n\t\tonObjectProperty: (name: string) => {\n\t\t\tcurrentProperty = name;\n\t\t},\n\t\tonObjectEnd: () => {\n\t\t\tcurrentParent = previousParents.pop();\n\t\t},\n\t\tonArrayBegin: () => {\n\t\t\tconst array: any[] = [];\n\t\t\tonValue(array);\n\t\t\tpreviousParents.push(currentParent);\n\t\t\tcurrentParent = array;\n\t\t\tcurrentProperty = null;\n\t\t},\n\t\tonArrayEnd: () => {\n\t\t\tcurrentParent = previousParents.pop();\n\t\t},\n\t\tonLiteralValue: onValue,\n\t\tonError: (error: ParseErrorCode, offset: number, length: number) => {\n\t\t\terrors.push({ error, offset, length });\n\t\t}\n\t};\n\tvisit(text, visitor, options);\n\treturn currentParent[0];\n}\n\n\n/**\n * Parses the given text and returns a tree representation the JSON content. On invalid input, the parser tries to be as fault tolerant as possible, but still return a result.\n */\nexport function parseTree(text: string, errors: ParseError[] = [], options: ParseOptions = ParseOptions.DEFAULT): Node {\n\tlet currentParent: NodeImpl = { type: 'array', offset: -1, length: -1, children: [], parent: undefined }; // artificial root\n\n\tfunction ensurePropertyComplete(endOffset: number) {\n\t\tif (currentParent.type === 'property') {\n\t\t\tcurrentParent.length = endOffset - currentParent.offset;\n\t\t\tcurrentParent = currentParent.parent!;\n\t\t}\n\t}\n\n\tfunction onValue(valueNode: Node): Node {\n\t\tcurrentParent.children!.push(valueNode);\n\t\treturn valueNode;\n\t}\n\n\tconst visitor: JSONVisitor = {\n\t\tonObjectBegin: (offset: number) => {\n\t\t\tcurrentParent = onValue({ type: 'object', offset, length: -1, parent: currentParent, children: [] });\n\t\t},\n\t\tonObjectProperty: (name: string, offset: number, length: number) => {\n\t\t\tcurrentParent = onValue({ type: 'property', offset, length: -1, parent: currentParent, children: [] });\n\t\t\tcurrentParent.children!.push({ type: 'string', value: name, offset, length, parent: currentParent });\n\t\t},\n\t\tonObjectEnd: (offset: number, length: number) => {\n\t\t\tcurrentParent.length = offset + length - currentParent.offset;\n\t\t\tcurrentParent = currentParent.parent!;\n\t\t\tensurePropertyComplete(offset + length);\n\t\t},\n\t\tonArrayBegin: (offset: number, length: number) => {\n\t\t\tcurrentParent = onValue({ type: 'array', offset, length: -1, parent: currentParent, children: [] });\n\t\t},\n\t\tonArrayEnd: (offset: number, length: number) => {\n\t\t\tcurrentParent.length = offset + length - currentParent.offset;\n\t\t\tcurrentParent = currentParent.parent!;\n\t\t\tensurePropertyComplete(offset + length);\n\t\t},\n\t\tonLiteralValue: (value: any, offset: number, length: number) => {\n\t\t\tonValue({ type: getNodeType(value), offset, length, parent: currentParent, value });\n\t\t\tensurePropertyComplete(offset + length);\n\t\t},\n\t\tonSeparator: (sep: string, offset: number, length: number) => {\n\t\t\tif (currentParent.type === 'property') {\n\t\t\t\tif (sep === ':') {\n\t\t\t\t\tcurrentParent.colonOffset = offset;\n\t\t\t\t} else if (sep === ',') {\n\t\t\t\t\tensurePropertyComplete(offset);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonError: (error: ParseErrorCode, offset: number, length: number) => {\n\t\t\terrors.push({ error, offset, length });\n\t\t}\n\t};\n\tvisit(text, visitor, options);\n\n\tconst result = currentParent.children![0];\n\tif (result) {\n\t\tdelete result.parent;\n\t}\n\treturn result;\n}\n\n/**\n * Finds the node at the given path in a JSON DOM.\n */\nexport function findNodeAtLocation(root: Node, path: JSONPath): Node | undefined {\n\tif (!root) {\n\t\treturn undefined;\n\t}\n\tlet node = root;\n\tfor (const segment of path) {\n\t\tif (typeof segment === 'string') {\n\t\t\tif (node.type !== 'object' || !Array.isArray(node.children)) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\tlet found = false;\n\t\t\tfor (const propertyNode of node.children) {\n\t\t\t\tif (Array.isArray(propertyNode.children) && propertyNode.children[0].value === segment) {\n\t\t\t\t\tnode = propertyNode.children[1];\n\t\t\t\t\tfound = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!found) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t} else {\n\t\t\tconst index = <number>segment;\n\t\t\tif (node.type !== 'array' || index < 0 || !Array.isArray(node.children) || index >= node.children.length) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\tnode = node.children[index];\n\t\t}\n\t}\n\treturn node;\n}\n\n/**\n * Gets the JSON path of the given JSON DOM node\n */\nexport function getNodePath(node: Node): JSONPath {\n\tif (!node.parent || !node.parent.children) {\n\t\treturn [];\n\t}\n\tconst path = getNodePath(node.parent);\n\tif (node.parent.type === 'property') {\n\t\tconst key = node.parent.children[0].value;\n\t\tpath.push(key);\n\t} else if (node.parent.type === 'array') {\n\t\tconst index = node.parent.children.indexOf(node);\n\t\tif (index !== -1) {\n\t\t\tpath.push(index);\n\t\t}\n\t}\n\treturn path;\n}\n\n/**\n * Evaluates the JavaScript object of the given JSON DOM node\n */\nexport function getNodeValue(node: Node): any {\n\tswitch (node.type) {\n\t\tcase 'array':\n\t\t\treturn node.children!.map(getNodeValue);\n\t\tcase 'object': {\n\t\t\tconst obj = Object.create(null);\n\t\t\tfor (const prop of node.children!) {\n\t\t\t\tconst valueNode = prop.children![1];\n\t\t\t\tif (valueNode) {\n\t\t\t\t\tobj[prop.children![0].value] = getNodeValue(valueNode);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t}\n\t\tcase 'null':\n\t\tcase 'string':\n\t\tcase 'number':\n\t\tcase 'boolean':\n\t\t\treturn node.value;\n\t\tdefault:\n\t\t\treturn undefined;\n\t}\n\n}\n\nexport function contains(node: Node, offset: number, includeRightBound = false): boolean {\n\treturn (offset >= node.offset && offset < (node.offset + node.length)) || includeRightBound && (offset === (node.offset + node.length));\n}\n\n/**\n * Finds the most inner node at the given offset. If includeRightBound is set, also finds nodes that end at the given offset.\n */\nexport function findNodeAtOffset(node: Node, offset: number, includeRightBound = false): Node | undefined {\n\tif (contains(node, offset, includeRightBound)) {\n\t\tconst children = node.children;\n\t\tif (Array.isArray(children)) {\n\t\t\tfor (let i = 0; i < children.length && children[i].offset <= offset; i++) {\n\t\t\t\tconst item = findNodeAtOffset(children[i], offset, includeRightBound);\n\t\t\t\tif (item) {\n\t\t\t\t\treturn item;\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t\treturn node;\n\t}\n\treturn undefined;\n}\n\n\n/**\n * Parses the given text and invokes the visitor functions for each object, array and literal reached.\n */\nexport function visit(text: string, visitor: JSONVisitor, options: ParseOptions = ParseOptions.DEFAULT): any {\n\n\tconst _scanner = createScanner(text, false);\n\n\tfunction toNoArgVisit(visitFunction?: (offset: number, length: number) => void): () => void {\n\t\treturn visitFunction ? () => visitFunction(_scanner.getTokenOffset(), _scanner.getTokenLength()) : () => true;\n\t}\n\tfunction toOneArgVisit<T>(visitFunction?: (arg: T, offset: number, length: number) => void): (arg: T) => void {\n\t\treturn visitFunction ? (arg: T) => visitFunction(arg, _scanner.getTokenOffset(), _scanner.getTokenLength()) : () => true;\n\t}\n\n\tconst onObjectBegin = toNoArgVisit(visitor.onObjectBegin),\n\t\tonObjectProperty = toOneArgVisit(visitor.onObjectProperty),\n\t\tonObjectEnd = toNoArgVisit(visitor.onObjectEnd),\n\t\tonArrayBegin = toNoArgVisit(visitor.onArrayBegin),\n\t\tonArrayEnd = toNoArgVisit(visitor.onArrayEnd),\n\t\tonLiteralValue = toOneArgVisit(visitor.onLiteralValue),\n\t\tonSeparator = toOneArgVisit(visitor.onSeparator),\n\t\tonComment = toNoArgVisit(visitor.onComment),\n\t\tonError = toOneArgVisit(visitor.onError);\n\n\tconst disallowComments = options && options.disallowComments;\n\tconst allowTrailingComma = options && options.allowTrailingComma;\n\tfunction scanNext(): SyntaxKind {\n\t\twhile (true) {\n\t\t\tconst token = _scanner.scan();\n\t\t\tswitch (_scanner.getTokenError()) {\n\t\t\t\tcase ScanError.InvalidUnicode:\n\t\t\t\t\thandleError(ParseErrorCode.InvalidUnicode);\n\t\t\t\t\tbreak;\n\t\t\t\tcase ScanError.InvalidEscapeCharacter:\n\t\t\t\t\thandleError(ParseErrorCode.InvalidEscapeCharacter);\n\t\t\t\t\tbreak;\n\t\t\t\tcase ScanError.UnexpectedEndOfNumber:\n\t\t\t\t\thandleError(ParseErrorCode.UnexpectedEndOfNumber);\n\t\t\t\t\tbreak;\n\t\t\t\tcase ScanError.UnexpectedEndOfComment:\n\t\t\t\t\tif (!disallowComments) {\n\t\t\t\t\t\thandleError(ParseErrorCode.UnexpectedEndOfComment);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase ScanError.UnexpectedEndOfString:\n\t\t\t\t\thandleError(ParseErrorCode.UnexpectedEndOfString);\n\t\t\t\t\tbreak;\n\t\t\t\tcase ScanError.InvalidCharacter:\n\t\t\t\t\thandleError(ParseErrorCode.InvalidCharacter);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tswitch (token) {\n\t\t\t\tcase SyntaxKind.LineCommentTrivia:\n\t\t\t\tcase SyntaxKind.BlockCommentTrivia:\n\t\t\t\t\tif (disallowComments) {\n\t\t\t\t\t\thandleError(ParseErrorCode.InvalidCommentToken);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tonComment();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase SyntaxKind.Unknown:\n\t\t\t\t\thandleError(ParseErrorCode.InvalidSymbol);\n\t\t\t\t\tbreak;\n\t\t\t\tcase SyntaxKind.Trivia:\n\t\t\t\tcase SyntaxKind.LineBreakTrivia:\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\treturn token;\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction handleError(error: ParseErrorCode, skipUntilAfter: SyntaxKind[] = [], skipUntil: SyntaxKind[] = []): void {\n\t\tonError(error);\n\t\tif (skipUntilAfter.length + skipUntil.length > 0) {\n\t\t\tlet token = _scanner.getToken();\n\t\t\twhile (token !== SyntaxKind.EOF) {\n\t\t\t\tif (skipUntilAfter.indexOf(token) !== -1) {\n\t\t\t\t\tscanNext();\n\t\t\t\t\tbreak;\n\t\t\t\t} else if (skipUntil.indexOf(token) !== -1) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\ttoken = scanNext();\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction parseString(isValue: boolean): boolean {\n\t\tconst value = _scanner.getTokenValue();\n\t\tif (isValue) {\n\t\t\tonLiteralValue(value);\n\t\t} else {\n\t\t\tonObjectProperty(value);\n\t\t}\n\t\tscanNext();\n\t\treturn true;\n\t}\n\n\tfunction parseLiteral(): boolean {\n\t\tswitch (_scanner.getToken()) {\n\t\t\tcase SyntaxKind.NumericLiteral: {\n\t\t\t\tlet value = 0;\n\t\t\t\ttry {\n\t\t\t\t\tvalue = JSON.parse(_scanner.getTokenValue());\n\t\t\t\t\tif (typeof value !== 'number') {\n\t\t\t\t\t\thandleError(ParseErrorCode.InvalidNumberFormat);\n\t\t\t\t\t\tvalue = 0;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\thandleError(ParseErrorCode.InvalidNumberFormat);\n\t\t\t\t}\n\t\t\t\tonLiteralValue(value);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase SyntaxKind.NullKeyword:\n\t\t\t\tonLiteralValue(null);\n\t\t\t\tbreak;\n\t\t\tcase SyntaxKind.TrueKeyword:\n\t\t\t\tonLiteralValue(true);\n\t\t\t\tbreak;\n\t\t\tcase SyntaxKind.FalseKeyword:\n\t\t\t\tonLiteralValue(false);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn false;\n\t\t}\n\t\tscanNext();\n\t\treturn true;\n\t}\n\n\tfunction parseProperty(): boolean {\n\t\tif (_scanner.getToken() !== SyntaxKind.StringLiteral) {\n\t\t\thandleError(ParseErrorCode.PropertyNameExpected, [], [SyntaxKind.CloseBraceToken, SyntaxKind.CommaToken]);\n\t\t\treturn false;\n\t\t}\n\t\tparseString(false);\n\t\tif (_scanner.getToken() === SyntaxKind.ColonToken) {\n\t\t\tonSeparator(':');\n\t\t\tscanNext(); // consume colon\n\n\t\t\tif (!parseValue()) {\n\t\t\t\thandleError(ParseErrorCode.ValueExpected, [], [SyntaxKind.CloseBraceToken, SyntaxKind.CommaToken]);\n\t\t\t}\n\t\t} else {\n\t\t\thandleError(ParseErrorCode.ColonExpected, [], [SyntaxKind.CloseBraceToken, SyntaxKind.CommaToken]);\n\t\t}\n\t\treturn true;\n\t}\n\n\tfunction parseObject(): boolean {\n\t\tonObjectBegin();\n\t\tscanNext(); // consume open brace\n\n\t\tlet needsComma = false;\n\t\twhile (_scanner.getToken() !== SyntaxKind.CloseBraceToken && _scanner.getToken() !== SyntaxKind.EOF) {\n\t\t\tif (_scanner.getToken() === SyntaxKind.CommaToken) {\n\t\t\t\tif (!needsComma) {\n\t\t\t\t\thandleError(ParseErrorCode.ValueExpected, [], []);\n\t\t\t\t}\n\t\t\t\tonSeparator(',');\n\t\t\t\tscanNext(); // consume comma\n\t\t\t\tif (_scanner.getToken() === SyntaxKind.CloseBraceToken && allowTrailingComma) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else if (needsComma) {\n\t\t\t\thandleError(ParseErrorCode.CommaExpected, [], []);\n\t\t\t}\n\t\t\tif (!parseProperty()) {\n\t\t\t\thandleError(ParseErrorCode.ValueExpected, [], [SyntaxKind.CloseBraceToken, SyntaxKind.CommaToken]);\n\t\t\t}\n\t\t\tneedsComma = true;\n\t\t}\n\t\tonObjectEnd();\n\t\tif (_scanner.getToken() !== SyntaxKind.CloseBraceToken) {\n\t\t\thandleError(ParseErrorCode.CloseBraceExpected, [SyntaxKind.CloseBraceToken], []);\n\t\t} else {\n\t\t\tscanNext(); // consume close brace\n\t\t}\n\t\treturn true;\n\t}\n\n\tfunction parseArray(): boolean {\n\t\tonArrayBegin();\n\t\tscanNext(); // consume open bracket\n\n\t\tlet needsComma = false;\n\t\twhile (_scanner.getToken() !== SyntaxKind.CloseBracketToken && _scanner.getToken() !== SyntaxKind.EOF) {\n\t\t\tif (_scanner.getToken() === SyntaxKind.CommaToken) {\n\t\t\t\tif (!needsComma) {\n\t\t\t\t\thandleError(ParseErrorCode.ValueExpected, [], []);\n\t\t\t\t}\n\t\t\t\tonSeparator(',');\n\t\t\t\tscanNext(); // consume comma\n\t\t\t\tif (_scanner.getToken() === SyntaxKind.CloseBracketToken && allowTrailingComma) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else if (needsComma) {\n\t\t\t\thandleError(ParseErrorCode.CommaExpected, [], []);\n\t\t\t}\n\t\t\tif (!parseValue()) {\n\t\t\t\thandleError(ParseErrorCode.ValueExpected, [], [SyntaxKind.CloseBracketToken, SyntaxKind.CommaToken]);\n\t\t\t}\n\t\t\tneedsComma = true;\n\t\t}\n\t\tonArrayEnd();\n\t\tif (_scanner.getToken() !== SyntaxKind.CloseBracketToken) {\n\t\t\thandleError(ParseErrorCode.CloseBracketExpected, [SyntaxKind.CloseBracketToken], []);\n\t\t} else {\n\t\t\tscanNext(); // consume close bracket\n\t\t}\n\t\treturn true;\n\t}\n\n\tfunction parseValue(): boolean {\n\t\tswitch (_scanner.getToken()) {\n\t\t\tcase SyntaxKind.OpenBracketToken:\n\t\t\t\treturn parseArray();\n\t\t\tcase SyntaxKind.OpenBraceToken:\n\t\t\t\treturn parseObject();\n\t\t\tcase SyntaxKind.StringLiteral:\n\t\t\t\treturn parseString(true);\n\t\t\tdefault:\n\t\t\t\treturn parseLiteral();\n\t\t}\n\t}\n\n\tscanNext();\n\tif (_scanner.getToken() === SyntaxKind.EOF) {\n\t\tif (options.allowEmptyContent) {\n\t\t\treturn true;\n\t\t}\n\t\thandleError(ParseErrorCode.ValueExpected, [], []);\n\t\treturn false;\n\t}\n\tif (!parseValue()) {\n\t\thandleError(ParseErrorCode.ValueExpected, [], []);\n\t\treturn false;\n\t}\n\tif (_scanner.getToken() !== SyntaxKind.EOF) {\n\t\thandleError(ParseErrorCode.EndOfFileExpected, [], []);\n\t}\n\treturn true;\n}\n\n/**\n * Takes JSON with JavaScript-style comments and remove\n * them. Optionally replaces every none-newline character\n * of comments with a replaceCharacter\n */\nexport function stripComments(text: string, replaceCh?: string): string {\n\n\tconst _scanner = createScanner(text);\n\tconst parts: string[] = [];\n\tlet kind: SyntaxKind;\n\tlet offset = 0;\n\tlet pos: number;\n\n\tdo {\n\t\tpos = _scanner.getPosition();\n\t\tkind = _scanner.scan();\n\t\tswitch (kind) {\n\t\t\tcase SyntaxKind.LineCommentTrivia:\n\t\t\tcase SyntaxKind.BlockCommentTrivia:\n\t\t\tcase SyntaxKind.EOF:\n\t\t\t\tif (offset !== pos) {\n\t\t\t\t\tparts.push(text.substring(offset, pos));\n\t\t\t\t}\n\t\t\t\tif (replaceCh !== undefined) {\n\t\t\t\t\tparts.push(_scanner.getTokenValue().replace(/[^\\r\\n]/g, replaceCh));\n\t\t\t\t}\n\t\t\t\toffset = _scanner.getPosition();\n\t\t\t\tbreak;\n\t\t}\n\t} while (kind !== SyntaxKind.EOF);\n\n\treturn parts.join('');\n}\n\nexport function getNodeType(value: any): NodeType {\n\tswitch (typeof value) {\n\t\tcase 'boolean': return 'boolean';\n\t\tcase 'number': return 'number';\n\t\tcase 'string': return 'string';\n\t\tcase 'object': {\n\t\t\tif (!value) {\n\t\t\t\treturn 'null';\n\t\t\t} else if (Array.isArray(value)) {\n\t\t\t\treturn 'array';\n\t\t\t}\n\t\t\treturn 'object';\n\t\t}\n\t\tdefault: return 'null';\n\t}\n}\n","/**\n * marked - a markdown parser\n * Copyright (c) 2011-2022, Christopher Jeffrey. (MIT Licensed)\n * https://github.com/markedjs/marked\n */\n\n/**\n * DO NOT EDIT THIS FILE\n * The code in this file is generated from files in ./src/\n */\n\n// ESM-uncomment-begin\n// let __marked_exports = {};\n// (function() {\n//   function define(deps, factory) {\n//     factory(__marked_exports);\n//   }\n//   define.amd = true;\n// ESM-uncomment-end\n\n (function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n  typeof define === 'function' && define.amd ? define(__m[105/*vs/base/common/marked/marked*/], __M([0/*exports*/]), factory) :\n  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global.marked = {}));\n})(this, (function (exports) { 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    Object.defineProperty(Constructor, \"prototype\", {\n      writable: false\n    });\n    return Constructor;\n  }\n\n  function _unsupportedIterableToArray(o, minLen) {\n    if (!o) return;\n    if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n    var n = Object.prototype.toString.call(o).slice(8, -1);\n    if (n === \"Object\" && o.constructor) n = o.constructor.name;\n    if (n === \"Map\" || n === \"Set\") return Array.from(o);\n    if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n  }\n\n  function _arrayLikeToArray(arr, len) {\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }\n\n  function _createForOfIteratorHelperLoose(o, allowArrayLike) {\n    var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n    if (it) return (it = it.call(o)).next.bind(it);\n\n    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n      return function () {\n        if (i >= o.length) return {\n          done: true\n        };\n        return {\n          done: false,\n          value: o[i++]\n        };\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  function getDefaults() {\n    return {\n      baseUrl: null,\n      breaks: false,\n      extensions: null,\n      gfm: true,\n      headerIds: true,\n      headerPrefix: '',\n      highlight: null,\n      langPrefix: 'language-',\n      mangle: true,\n      pedantic: false,\n      renderer: null,\n      sanitize: false,\n      sanitizer: null,\n      silent: false,\n      smartLists: false,\n      smartypants: false,\n      tokenizer: null,\n      walkTokens: null,\n      xhtml: false\n    };\n  }\n  exports.defaults = getDefaults();\n  function changeDefaults(newDefaults) {\n    exports.defaults = newDefaults;\n  }\n\n  /**\n   * Helpers\n   */\n  var escapeTest = /[&<>\"']/;\n  var escapeReplace = /[&<>\"']/g;\n  var escapeTestNoEncode = /[<>\"']|&(?!#?\\w+;)/;\n  var escapeReplaceNoEncode = /[<>\"']|&(?!#?\\w+;)/g;\n  var escapeReplacements = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#39;'\n  };\n\n  var getEscapeReplacement = function getEscapeReplacement(ch) {\n    return escapeReplacements[ch];\n  };\n\n  function escape(html, encode) {\n    if (encode) {\n      if (escapeTest.test(html)) {\n        return html.replace(escapeReplace, getEscapeReplacement);\n      }\n    } else {\n      if (escapeTestNoEncode.test(html)) {\n        return html.replace(escapeReplaceNoEncode, getEscapeReplacement);\n      }\n    }\n\n    return html;\n  }\n  var unescapeTest = /&(#(?:\\d+)|(?:#x[0-9A-Fa-f]+)|(?:\\w+));?/ig;\n  /**\n   * @param {string} html\n   */\n\n  function unescape(html) {\n    // explicitly match decimal, hex, and named HTML entities\n    return html.replace(unescapeTest, function (_, n) {\n      n = n.toLowerCase();\n      if (n === 'colon') return ':';\n\n      if (n.charAt(0) === '#') {\n        return n.charAt(1) === 'x' ? String.fromCharCode(parseInt(n.substring(2), 16)) : String.fromCharCode(+n.substring(1));\n      }\n\n      return '';\n    });\n  }\n  var caret = /(^|[^\\[])\\^/g;\n  /**\n   * @param {string | RegExp} regex\n   * @param {string} opt\n   */\n\n  function edit(regex, opt) {\n    regex = typeof regex === 'string' ? regex : regex.source;\n    opt = opt || '';\n    var obj = {\n      replace: function replace(name, val) {\n        val = val.source || val;\n        val = val.replace(caret, '$1');\n        regex = regex.replace(name, val);\n        return obj;\n      },\n      getRegex: function getRegex() {\n        return new RegExp(regex, opt);\n      }\n    };\n    return obj;\n  }\n  var nonWordAndColonTest = /[^\\w:]/g;\n  var originIndependentUrl = /^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;\n  /**\n   * @param {boolean} sanitize\n   * @param {string} base\n   * @param {string} href\n   */\n\n  function cleanUrl(sanitize, base, href) {\n    if (sanitize) {\n      var prot;\n\n      try {\n        prot = decodeURIComponent(unescape(href)).replace(nonWordAndColonTest, '').toLowerCase();\n      } catch (e) {\n        return null;\n      }\n\n      if (prot.indexOf('javascript:') === 0 || prot.indexOf('vbscript:') === 0 || prot.indexOf('data:') === 0) {\n        return null;\n      }\n    }\n\n    if (base && !originIndependentUrl.test(href)) {\n      href = resolveUrl(base, href);\n    }\n\n    try {\n      href = encodeURI(href).replace(/%25/g, '%');\n    } catch (e) {\n      return null;\n    }\n\n    return href;\n  }\n  var baseUrls = {};\n  var justDomain = /^[^:]+:\\/*[^/]*$/;\n  var protocol = /^([^:]+:)[\\s\\S]*$/;\n  var domain = /^([^:]+:\\/*[^/]*)[\\s\\S]*$/;\n  /**\n   * @param {string} base\n   * @param {string} href\n   */\n\n  function resolveUrl(base, href) {\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n      } else {\n        baseUrls[' ' + base] = rtrim(base, '/', true);\n      }\n    }\n\n    base = baseUrls[' ' + base];\n    var relativeBase = base.indexOf(':') === -1;\n\n    if (href.substring(0, 2) === '//') {\n      if (relativeBase) {\n        return href;\n      }\n\n      return base.replace(protocol, '$1') + href;\n    } else if (href.charAt(0) === '/') {\n      if (relativeBase) {\n        return href;\n      }\n\n      return base.replace(domain, '$1') + href;\n    } else {\n      return base + href;\n    }\n  }\n  var noopTest = {\n    exec: function noopTest() {}\n  };\n  function merge(obj) {\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }\n  function splitCells(tableRow, count) {\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        escaped = !escaped;\n      }\n\n      if (escaped) {\n        // odd number of slashes means | is escaped\n        // so we leave it alone\n        return '|';\n      } else {\n        // add space before unescaped |\n        return ' |';\n      }\n    }),\n        cells = row.split(/ \\|/);\n    var i = 0; // First/last cell in a row cannot be empty if it has no leading/trailing pipe\n\n    if (!cells[0].trim()) {\n      cells.shift();\n    }\n\n    if (cells.length > 0 && !cells[cells.length - 1].trim()) {\n      cells.pop();\n    }\n\n    if (cells.length > count) {\n      cells.splice(count);\n    } else {\n      while (cells.length < count) {\n        cells.push('');\n      }\n    }\n\n    for (; i < cells.length; i++) {\n      // leading or trailing whitespace is ignored per the gfm spec\n      cells[i] = cells[i].trim().replace(/\\\\\\|/g, '|');\n    }\n\n    return cells;\n  }\n  /**\n   * Remove trailing 'c's. Equivalent to str.replace(/c*$/, '').\n   * /c*$/ is vulnerable to REDOS.\n   *\n   * @param {string} str\n   * @param {string} c\n   * @param {boolean} invert Remove suffix of non-c chars instead. Default falsey.\n   */\n\n  function rtrim(str, c, invert) {\n    var l = str.length;\n\n    if (l === 0) {\n      return '';\n    } // Length of suffix matching the invert condition.\n\n\n    var suffLen = 0; // Step left until we fail to match the invert condition.\n\n    while (suffLen < l) {\n      var currChar = str.charAt(l - suffLen - 1);\n\n      if (currChar === c && !invert) {\n        suffLen++;\n      } else if (currChar !== c && invert) {\n        suffLen++;\n      } else {\n        break;\n      }\n    }\n\n    return str.slice(0, l - suffLen);\n  }\n  function findClosingBracket(str, b) {\n    if (str.indexOf(b[1]) === -1) {\n      return -1;\n    }\n\n    var l = str.length;\n    var level = 0,\n        i = 0;\n\n    for (; i < l; i++) {\n      if (str[i] === '\\\\') {\n        i++;\n      } else if (str[i] === b[0]) {\n        level++;\n      } else if (str[i] === b[1]) {\n        level--;\n\n        if (level < 0) {\n          return i;\n        }\n      }\n    }\n\n    return -1;\n  }\n  function checkSanitizeDeprecation(opt) {\n    if (opt && opt.sanitize && !opt.silent) {\n      console.warn('marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options');\n    }\n  } // copied from https://stackoverflow.com/a/5450113/806777\n\n  /**\n   * @param {string} pattern\n   * @param {number} count\n   */\n\n  function repeatString(pattern, count) {\n    if (count < 1) {\n      return '';\n    }\n\n    var result = '';\n\n    while (count > 1) {\n      if (count & 1) {\n        result += pattern;\n      }\n\n      count >>= 1;\n      pattern += pattern;\n    }\n\n    return result + pattern;\n  }\n\n  function outputLink(cap, link, raw, lexer) {\n    var href = link.href;\n    var title = link.title ? escape(link.title) : null;\n    var text = cap[1].replace(/\\\\([\\[\\]])/g, '$1');\n\n    if (cap[0].charAt(0) !== '!') {\n      lexer.state.inLink = true;\n      var token = {\n        type: 'link',\n        raw: raw,\n        href: href,\n        title: title,\n        text: text,\n        tokens: lexer.inlineTokens(text, [])\n      };\n      lexer.state.inLink = false;\n      return token;\n    }\n\n    return {\n      type: 'image',\n      raw: raw,\n      href: href,\n      title: title,\n      text: escape(text)\n    };\n  }\n\n  function indentCodeCompensation(raw, text) {\n    var matchIndentToCode = raw.match(/^(\\s+)(?:```)/);\n\n    if (matchIndentToCode === null) {\n      return text;\n    }\n\n    var indentToCode = matchIndentToCode[1];\n    return text.split('\\n').map(function (node) {\n      var matchIndentInNode = node.match(/^\\s+/);\n\n      if (matchIndentInNode === null) {\n        return node;\n      }\n\n      var indentInNode = matchIndentInNode[0];\n\n      if (indentInNode.length >= indentToCode.length) {\n        return node.slice(indentToCode.length);\n      }\n\n      return node;\n    }).join('\\n');\n  }\n  /**\n   * Tokenizer\n   */\n\n\n  var Tokenizer = /*#__PURE__*/function () {\n    function Tokenizer(options) {\n      this.options = options || exports.defaults;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap && cap[0].length > 0) {\n        return {\n          type: 'space',\n          raw: cap[0]\n        };\n      }\n    };\n\n    _proto.code = function code(src) {\n      var cap = this.rules.block.code.exec(src);\n\n      if (cap) {\n        var text = cap[0].replace(/^ {1,4}/gm, '');\n        return {\n          type: 'code',\n          raw: cap[0],\n          codeBlockStyle: 'indented',\n          text: !this.options.pedantic ? rtrim(text, '\\n') : text\n        };\n      }\n    };\n\n    _proto.fences = function fences(src) {\n      var cap = this.rules.block.fences.exec(src);\n\n      if (cap) {\n        var raw = cap[0];\n        var text = indentCodeCompensation(raw, cap[3] || '');\n        return {\n          type: 'code',\n          raw: raw,\n          lang: cap[2] ? cap[2].trim() : cap[2],\n          text: text\n        };\n      }\n    };\n\n    _proto.heading = function heading(src) {\n      var cap = this.rules.block.heading.exec(src);\n\n      if (cap) {\n        var text = cap[2].trim(); // remove trailing #s\n\n        if (/#$/.test(text)) {\n          var trimmed = rtrim(text, '#');\n\n          if (this.options.pedantic) {\n            text = trimmed.trim();\n          } else if (!trimmed || / $/.test(trimmed)) {\n            // CommonMark requires space before trailing #s\n            text = trimmed.trim();\n          }\n        }\n\n        var token = {\n          type: 'heading',\n          raw: cap[0],\n          depth: cap[1].length,\n          text: text,\n          tokens: []\n        };\n        this.lexer.inline(token.text, token.tokens);\n        return token;\n      }\n    };\n\n    _proto.hr = function hr(src) {\n      var cap = this.rules.block.hr.exec(src);\n\n      if (cap) {\n        return {\n          type: 'hr',\n          raw: cap[0]\n        };\n      }\n    };\n\n    _proto.blockquote = function blockquote(src) {\n      var cap = this.rules.block.blockquote.exec(src);\n\n      if (cap) {\n        var text = cap[0].replace(/^ *>[ \\t]?/gm, '');\n        return {\n          type: 'blockquote',\n          raw: cap[0],\n          tokens: this.lexer.blockTokens(text, []),\n          text: text\n        };\n      }\n    };\n\n    _proto.list = function list(src) {\n      var cap = this.rules.block.list.exec(src);\n\n      if (cap) {\n        var raw, istask, ischecked, indent, i, blankLine, endsWithBlankLine, line, nextLine, rawLine, itemContents, endEarly;\n        var bull = cap[1].trim();\n        var isordered = bull.length > 1;\n        var list = {\n          type: 'list',\n          raw: '',\n          ordered: isordered,\n          start: isordered ? +bull.slice(0, -1) : '',\n          loose: false,\n          items: []\n        };\n        bull = isordered ? \"\\\\d{1,9}\\\\\" + bull.slice(-1) : \"\\\\\" + bull;\n\n        if (this.options.pedantic) {\n          bull = isordered ? bull : '[*+-]';\n        } // Get next list item\n\n\n        var itemRegex = new RegExp(\"^( {0,3}\" + bull + \")((?:[\\t ][^\\\\n]*)?(?:\\\\n|$))\"); // Check if current bullet point can start a new List Item\n\n        while (src) {\n          endEarly = false;\n\n          if (!(cap = itemRegex.exec(src))) {\n            break;\n          }\n\n          if (this.rules.block.hr.test(src)) {\n            // End list if bullet was actually HR (possibly move into itemRegex?)\n            break;\n          }\n\n          raw = cap[0];\n          src = src.substring(raw.length);\n          line = cap[2].split('\\n', 1)[0];\n          nextLine = src.split('\\n', 1)[0];\n\n          if (this.options.pedantic) {\n            indent = 2;\n            itemContents = line.trimLeft();\n          } else {\n            indent = cap[2].search(/[^ ]/); // Find first non-space char\n\n            indent = indent > 4 ? 1 : indent; // Treat indented code blocks (> 4 spaces) as having only 1 indent\n\n            itemContents = line.slice(indent);\n            indent += cap[1].length;\n          }\n\n          blankLine = false;\n\n          if (!line && /^ *$/.test(nextLine)) {\n            // Items begin with at most one blank line\n            raw += nextLine + '\\n';\n            src = src.substring(nextLine.length + 1);\n            endEarly = true;\n          }\n\n          if (!endEarly) {\n            var nextBulletRegex = new RegExp(\"^ {0,\" + Math.min(3, indent - 1) + \"}(?:[*+-]|\\\\d{1,9}[.)])((?: [^\\\\n]*)?(?:\\\\n|$))\");\n            var hrRegex = new RegExp(\"^ {0,\" + Math.min(3, indent - 1) + \"}((?:- *){3,}|(?:_ *){3,}|(?:\\\\* *){3,})(?:\\\\n+|$)\"); // Check if following lines should be included in List Item\n\n            while (src) {\n              rawLine = src.split('\\n', 1)[0];\n              line = rawLine; // Re-align to follow commonmark nesting rules\n\n              if (this.options.pedantic) {\n                line = line.replace(/^ {1,4}(?=( {4})*[^ ])/g, '  ');\n              } // End list item if found start of new bullet\n\n\n              if (nextBulletRegex.test(line)) {\n                break;\n              } // Horizontal rule found\n\n\n              if (hrRegex.test(src)) {\n                break;\n              }\n\n              if (line.search(/[^ ]/) >= indent || !line.trim()) {\n                // Dedent if possible\n                itemContents += '\\n' + line.slice(indent);\n              } else if (!blankLine) {\n                // Until blank line, item doesn't need indentation\n                itemContents += '\\n' + line;\n              } else {\n                // Otherwise, improper indentation ends this item\n                break;\n              }\n\n              if (!blankLine && !line.trim()) {\n                // Check if current line is blank\n                blankLine = true;\n              }\n\n              raw += rawLine + '\\n';\n              src = src.substring(rawLine.length + 1);\n            }\n          }\n\n          if (!list.loose) {\n            // If the previous item ended with a blank line, the list is loose\n            if (endsWithBlankLine) {\n              list.loose = true;\n            } else if (/\\n *\\n *$/.test(raw)) {\n              endsWithBlankLine = true;\n            }\n          } // Check for task list items\n\n\n          if (this.options.gfm) {\n            istask = /^\\[[ xX]\\] /.exec(itemContents);\n\n            if (istask) {\n              ischecked = istask[0] !== '[ ] ';\n              itemContents = itemContents.replace(/^\\[[ xX]\\] +/, '');\n            }\n          }\n\n          list.items.push({\n            type: 'list_item',\n            raw: raw,\n            task: !!istask,\n            checked: ischecked,\n            loose: false,\n            text: itemContents\n          });\n          list.raw += raw;\n        } // Do not consume newlines at end of final item. Alternatively, make itemRegex *start* with any newlines to simplify/speed up endsWithBlankLine logic\n\n\n        list.items[list.items.length - 1].raw = raw.trimRight();\n        list.items[list.items.length - 1].text = itemContents.trimRight();\n        list.raw = list.raw.trimRight();\n        var l = list.items.length; // Item child tokens handled here at end because we needed to have the final item to trim it first\n\n        for (i = 0; i < l; i++) {\n          this.lexer.state.top = false;\n          list.items[i].tokens = this.lexer.blockTokens(list.items[i].text, []);\n          var spacers = list.items[i].tokens.filter(function (t) {\n            return t.type === 'space';\n          });\n          var hasMultipleLineBreaks = spacers.every(function (t) {\n            var chars = t.raw.split('');\n            var lineBreaks = 0;\n\n            for (var _iterator = _createForOfIteratorHelperLoose(chars), _step; !(_step = _iterator()).done;) {\n              var _char = _step.value;\n\n              if (_char === '\\n') {\n                lineBreaks += 1;\n              }\n\n              if (lineBreaks > 1) {\n                return true;\n              }\n            }\n\n            return false;\n          });\n\n          if (!list.loose && spacers.length && hasMultipleLineBreaks) {\n            // Having a single line break doesn't mean a list is loose. A single line break is terminating the last list item\n            list.loose = true;\n            list.items[i].loose = true;\n          }\n        }\n\n        return list;\n      }\n    };\n\n    _proto.html = function html(src) {\n      var cap = this.rules.block.html.exec(src);\n\n      if (cap) {\n        var token = {\n          type: 'html',\n          raw: cap[0],\n          pre: !this.options.sanitizer && (cap[1] === 'pre' || cap[1] === 'script' || cap[1] === 'style'),\n          text: cap[0]\n        };\n\n        if (this.options.sanitize) {\n          token.type = 'paragraph';\n          token.text = this.options.sanitizer ? this.options.sanitizer(cap[0]) : escape(cap[0]);\n          token.tokens = [];\n          this.lexer.inline(token.text, token.tokens);\n        }\n\n        return token;\n      }\n    };\n\n    _proto.def = function def(src) {\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          type: 'def',\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: cap[3]\n        };\n      }\n    };\n\n    _proto.table = function table(src) {\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells(cap[1]).map(function (c) {\n            return {\n              text: c\n            };\n          }),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          rows: cap[3] && cap[3].trim() ? cap[3].replace(/\\n[ \\t]*$/, '').split('\\n') : []\n        };\n\n        if (item.header.length === item.align.length) {\n          item.raw = cap[0];\n          var l = item.align.length;\n          var i, j, k, row;\n\n          for (i = 0; i < l; i++) {\n            if (/^ *-+: *$/.test(item.align[i])) {\n              item.align[i] = 'right';\n            } else if (/^ *:-+: *$/.test(item.align[i])) {\n              item.align[i] = 'center';\n            } else if (/^ *:-+ *$/.test(item.align[i])) {\n              item.align[i] = 'left';\n            } else {\n              item.align[i] = null;\n            }\n          }\n\n          l = item.rows.length;\n\n          for (i = 0; i < l; i++) {\n            item.rows[i] = splitCells(item.rows[i], item.header.length).map(function (c) {\n              return {\n                text: c\n              };\n            });\n          } // parse child tokens inside headers and cells\n          // header child tokens\n\n\n          l = item.header.length;\n\n          for (j = 0; j < l; j++) {\n            item.header[j].tokens = [];\n            this.lexer.inline(item.header[j].text, item.header[j].tokens);\n          } // cell child tokens\n\n\n          l = item.rows.length;\n\n          for (j = 0; j < l; j++) {\n            row = item.rows[j];\n\n            for (k = 0; k < row.length; k++) {\n              row[k].tokens = [];\n              this.lexer.inline(row[k].text, row[k].tokens);\n            }\n          }\n\n          return item;\n        }\n      }\n    };\n\n    _proto.lheading = function lheading(src) {\n      var cap = this.rules.block.lheading.exec(src);\n\n      if (cap) {\n        var token = {\n          type: 'heading',\n          raw: cap[0],\n          depth: cap[2].charAt(0) === '=' ? 1 : 2,\n          text: cap[1],\n          tokens: []\n        };\n        this.lexer.inline(token.text, token.tokens);\n        return token;\n      }\n    };\n\n    _proto.paragraph = function paragraph(src) {\n      var cap = this.rules.block.paragraph.exec(src);\n\n      if (cap) {\n        var token = {\n          type: 'paragraph',\n          raw: cap[0],\n          text: cap[1].charAt(cap[1].length - 1) === '\\n' ? cap[1].slice(0, -1) : cap[1],\n          tokens: []\n        };\n        this.lexer.inline(token.text, token.tokens);\n        return token;\n      }\n    };\n\n    _proto.text = function text(src) {\n      var cap = this.rules.block.text.exec(src);\n\n      if (cap) {\n        var token = {\n          type: 'text',\n          raw: cap[0],\n          text: cap[0],\n          tokens: []\n        };\n        this.lexer.inline(token.text, token.tokens);\n        return token;\n      }\n    };\n\n    _proto.escape = function escape$1(src) {\n      var cap = this.rules.inline.escape.exec(src);\n\n      if (cap) {\n        return {\n          type: 'escape',\n          raw: cap[0],\n          text: escape(cap[1])\n        };\n      }\n    };\n\n    _proto.tag = function tag(src) {\n      var cap = this.rules.inline.tag.exec(src);\n\n      if (cap) {\n        if (!this.lexer.state.inLink && /^<a /i.test(cap[0])) {\n          this.lexer.state.inLink = true;\n        } else if (this.lexer.state.inLink && /^<\\/a>/i.test(cap[0])) {\n          this.lexer.state.inLink = false;\n        }\n\n        if (!this.lexer.state.inRawBlock && /^<(pre|code|kbd|script)(\\s|>)/i.test(cap[0])) {\n          this.lexer.state.inRawBlock = true;\n        } else if (this.lexer.state.inRawBlock && /^<\\/(pre|code|kbd|script)(\\s|>)/i.test(cap[0])) {\n          this.lexer.state.inRawBlock = false;\n        }\n\n        return {\n          type: this.options.sanitize ? 'text' : 'html',\n          raw: cap[0],\n          inLink: this.lexer.state.inLink,\n          inRawBlock: this.lexer.state.inRawBlock,\n          text: this.options.sanitize ? this.options.sanitizer ? this.options.sanitizer(cap[0]) : escape(cap[0]) : cap[0]\n        };\n      }\n    };\n\n    _proto.link = function link(src) {\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n          } // ending angle bracket cannot be escaped\n\n\n          var rtrimSlash = rtrim(trimmedUrl.slice(0, -1), '\\\\');\n\n          if ((trimmedUrl.length - rtrimSlash.length) % 2 === 0) {\n            return;\n          }\n        } else {\n          // find closing parenthesis\n          var lastParenIndex = findClosingBracket(cap[2], '()');\n\n          if (lastParenIndex > -1) {\n            var start = cap[0].indexOf('!') === 0 ? 5 : 4;\n            var linkLen = start + cap[1].length + lastParenIndex;\n            cap[2] = cap[2].substring(0, lastParenIndex);\n            cap[0] = cap[0].substring(0, linkLen).trim();\n            cap[3] = '';\n          }\n        }\n\n        var href = cap[2];\n        var title = '';\n\n        if (this.options.pedantic) {\n          // split pedantic href and title\n          var link = /^([^'\"]*[^\\s])\\s+(['\"])(.*)\\2/.exec(href);\n\n          if (link) {\n            href = link[1];\n            title = link[3];\n          }\n        } else {\n          title = cap[3] ? cap[3].slice(1, -1) : '';\n        }\n\n        href = href.trim();\n\n        if (/^</.test(href)) {\n          if (this.options.pedantic && !/>$/.test(trimmedUrl)) {\n            // pedantic allows starting angle bracket without ending angle bracket\n            href = href.slice(1);\n          } else {\n            href = href.slice(1, -1);\n          }\n        }\n\n        return outputLink(cap, {\n          href: href ? href.replace(this.rules.inline._escapes, '$1') : href,\n          title: title ? title.replace(this.rules.inline._escapes, '$1') : title\n        }, cap[0], this.lexer);\n      }\n    };\n\n    _proto.reflink = function reflink(src, links) {\n      var cap;\n\n      if ((cap = this.rules.inline.reflink.exec(src)) || (cap = this.rules.inline.nolink.exec(src))) {\n        var link = (cap[2] || cap[1]).replace(/\\s+/g, ' ');\n        link = links[link.toLowerCase()];\n\n        if (!link || !link.href) {\n          var text = cap[0].charAt(0);\n          return {\n            type: 'text',\n            raw: text,\n            text: text\n          };\n        }\n\n        return outputLink(cap, link, cap[0], this.lexer);\n      }\n    };\n\n    _proto.emStrong = function emStrong(src, maskedSrc, prevChar) {\n      if (prevChar === void 0) {\n        prevChar = '';\n      }\n\n      var match = this.rules.inline.emStrong.lDelim.exec(src);\n      if (!match) return; // _ can't be between two alphanumerics. \\p{L}\\p{N} includes non-english alphabet/numbers as well\n\n      if (match[3] && prevChar.match(/(?:[0-9A-Za-z\\xAA\\xB2\\xB3\\xB5\\xB9\\xBA\\xBC-\\xBE\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0560-\\u0588\\u05D0-\\u05EA\\u05EF-\\u05F2\\u0620-\\u064A\\u0660-\\u0669\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07C0-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u0860-\\u086A\\u0870-\\u0887\\u0889-\\u088E\\u08A0-\\u08C9\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0966-\\u096F\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09E6-\\u09F1\\u09F4-\\u09F9\\u09FC\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A6F\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0AE6-\\u0AEF\\u0AF9\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B66-\\u0B6F\\u0B71-\\u0B77\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0BE6-\\u0BF2\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58-\\u0C5A\\u0C5D\\u0C60\\u0C61\\u0C66-\\u0C6F\\u0C78-\\u0C7E\\u0C80\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDD\\u0CDE\\u0CE0\\u0CE1\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D04-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D54-\\u0D56\\u0D58-\\u0D61\\u0D66-\\u0D78\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DE6-\\u0DEF\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E86-\\u0E8A\\u0E8C-\\u0EA3\\u0EA5\\u0EA7-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F20-\\u0F33\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F-\\u1049\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u1090-\\u1099\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1369-\\u137C\\u1380-\\u138F\\u13A0-\\u13F5\\u13F8-\\u13FD\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u1711\\u171F-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u17E0-\\u17E9\\u17F0-\\u17F9\\u1810-\\u1819\\u1820-\\u1878\\u1880-\\u1884\\u1887-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19DA\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1A80-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4C\\u1B50-\\u1B59\\u1B83-\\u1BA0\\u1BAE-\\u1BE5\\u1C00-\\u1C23\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1C80-\\u1C88\\u1C90-\\u1CBA\\u1CBD-\\u1CBF\\u1CE9-\\u1CEC\\u1CEE-\\u1CF3\\u1CF5\\u1CF6\\u1CFA\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2070\\u2071\\u2074-\\u2079\\u207F-\\u2089\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2150-\\u2189\\u2460-\\u249B\\u24EA-\\u24FF\\u2776-\\u2793\\u2C00-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2CFD\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312F\\u3131-\\u318E\\u3192-\\u3195\\u31A0-\\u31BF\\u31F0-\\u31FF\\u3220-\\u3229\\u3248-\\u324F\\u3251-\\u325F\\u3280-\\u3289\\u32B1-\\u32BF\\u3400-\\u4DBF\\u4E00-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA7CA\\uA7D0\\uA7D1\\uA7D3\\uA7D5-\\uA7D9\\uA7F2-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA830-\\uA835\\uA840-\\uA873\\uA882-\\uA8B3\\uA8D0-\\uA8D9\\uA8F2-\\uA8F7\\uA8FB\\uA8FD\\uA8FE\\uA900-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF-\\uA9D9\\uA9E0-\\uA9E4\\uA9E6-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB69\\uAB70-\\uABE2\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]|\\uD800[\\uDC00-\\uDC0B\\uDC0D-\\uDC26\\uDC28-\\uDC3A\\uDC3C\\uDC3D\\uDC3F-\\uDC4D\\uDC50-\\uDC5D\\uDC80-\\uDCFA\\uDD07-\\uDD33\\uDD40-\\uDD78\\uDD8A\\uDD8B\\uDE80-\\uDE9C\\uDEA0-\\uDED0\\uDEE1-\\uDEFB\\uDF00-\\uDF23\\uDF2D-\\uDF4A\\uDF50-\\uDF75\\uDF80-\\uDF9D\\uDFA0-\\uDFC3\\uDFC8-\\uDFCF\\uDFD1-\\uDFD5]|\\uD801[\\uDC00-\\uDC9D\\uDCA0-\\uDCA9\\uDCB0-\\uDCD3\\uDCD8-\\uDCFB\\uDD00-\\uDD27\\uDD30-\\uDD63\\uDD70-\\uDD7A\\uDD7C-\\uDD8A\\uDD8C-\\uDD92\\uDD94\\uDD95\\uDD97-\\uDDA1\\uDDA3-\\uDDB1\\uDDB3-\\uDDB9\\uDDBB\\uDDBC\\uDE00-\\uDF36\\uDF40-\\uDF55\\uDF60-\\uDF67\\uDF80-\\uDF85\\uDF87-\\uDFB0\\uDFB2-\\uDFBA]|\\uD802[\\uDC00-\\uDC05\\uDC08\\uDC0A-\\uDC35\\uDC37\\uDC38\\uDC3C\\uDC3F-\\uDC55\\uDC58-\\uDC76\\uDC79-\\uDC9E\\uDCA7-\\uDCAF\\uDCE0-\\uDCF2\\uDCF4\\uDCF5\\uDCFB-\\uDD1B\\uDD20-\\uDD39\\uDD80-\\uDDB7\\uDDBC-\\uDDCF\\uDDD2-\\uDE00\\uDE10-\\uDE13\\uDE15-\\uDE17\\uDE19-\\uDE35\\uDE40-\\uDE48\\uDE60-\\uDE7E\\uDE80-\\uDE9F\\uDEC0-\\uDEC7\\uDEC9-\\uDEE4\\uDEEB-\\uDEEF\\uDF00-\\uDF35\\uDF40-\\uDF55\\uDF58-\\uDF72\\uDF78-\\uDF91\\uDFA9-\\uDFAF]|\\uD803[\\uDC00-\\uDC48\\uDC80-\\uDCB2\\uDCC0-\\uDCF2\\uDCFA-\\uDD23\\uDD30-\\uDD39\\uDE60-\\uDE7E\\uDE80-\\uDEA9\\uDEB0\\uDEB1\\uDF00-\\uDF27\\uDF30-\\uDF45\\uDF51-\\uDF54\\uDF70-\\uDF81\\uDFB0-\\uDFCB\\uDFE0-\\uDFF6]|\\uD804[\\uDC03-\\uDC37\\uDC52-\\uDC6F\\uDC71\\uDC72\\uDC75\\uDC83-\\uDCAF\\uDCD0-\\uDCE8\\uDCF0-\\uDCF9\\uDD03-\\uDD26\\uDD36-\\uDD3F\\uDD44\\uDD47\\uDD50-\\uDD72\\uDD76\\uDD83-\\uDDB2\\uDDC1-\\uDDC4\\uDDD0-\\uDDDA\\uDDDC\\uDDE1-\\uDDF4\\uDE00-\\uDE11\\uDE13-\\uDE2B\\uDE80-\\uDE86\\uDE88\\uDE8A-\\uDE8D\\uDE8F-\\uDE9D\\uDE9F-\\uDEA8\\uDEB0-\\uDEDE\\uDEF0-\\uDEF9\\uDF05-\\uDF0C\\uDF0F\\uDF10\\uDF13-\\uDF28\\uDF2A-\\uDF30\\uDF32\\uDF33\\uDF35-\\uDF39\\uDF3D\\uDF50\\uDF5D-\\uDF61]|\\uD805[\\uDC00-\\uDC34\\uDC47-\\uDC4A\\uDC50-\\uDC59\\uDC5F-\\uDC61\\uDC80-\\uDCAF\\uDCC4\\uDCC5\\uDCC7\\uDCD0-\\uDCD9\\uDD80-\\uDDAE\\uDDD8-\\uDDDB\\uDE00-\\uDE2F\\uDE44\\uDE50-\\uDE59\\uDE80-\\uDEAA\\uDEB8\\uDEC0-\\uDEC9\\uDF00-\\uDF1A\\uDF30-\\uDF3B\\uDF40-\\uDF46]|\\uD806[\\uDC00-\\uDC2B\\uDCA0-\\uDCF2\\uDCFF-\\uDD06\\uDD09\\uDD0C-\\uDD13\\uDD15\\uDD16\\uDD18-\\uDD2F\\uDD3F\\uDD41\\uDD50-\\uDD59\\uDDA0-\\uDDA7\\uDDAA-\\uDDD0\\uDDE1\\uDDE3\\uDE00\\uDE0B-\\uDE32\\uDE3A\\uDE50\\uDE5C-\\uDE89\\uDE9D\\uDEB0-\\uDEF8]|\\uD807[\\uDC00-\\uDC08\\uDC0A-\\uDC2E\\uDC40\\uDC50-\\uDC6C\\uDC72-\\uDC8F\\uDD00-\\uDD06\\uDD08\\uDD09\\uDD0B-\\uDD30\\uDD46\\uDD50-\\uDD59\\uDD60-\\uDD65\\uDD67\\uDD68\\uDD6A-\\uDD89\\uDD98\\uDDA0-\\uDDA9\\uDEE0-\\uDEF2\\uDFB0\\uDFC0-\\uDFD4]|\\uD808[\\uDC00-\\uDF99]|\\uD809[\\uDC00-\\uDC6E\\uDC80-\\uDD43]|\\uD80B[\\uDF90-\\uDFF0]|[\\uD80C\\uD81C-\\uD820\\uD822\\uD840-\\uD868\\uD86A-\\uD86C\\uD86F-\\uD872\\uD874-\\uD879\\uD880-\\uD883][\\uDC00-\\uDFFF]|\\uD80D[\\uDC00-\\uDC2E]|\\uD811[\\uDC00-\\uDE46]|\\uD81A[\\uDC00-\\uDE38\\uDE40-\\uDE5E\\uDE60-\\uDE69\\uDE70-\\uDEBE\\uDEC0-\\uDEC9\\uDED0-\\uDEED\\uDF00-\\uDF2F\\uDF40-\\uDF43\\uDF50-\\uDF59\\uDF5B-\\uDF61\\uDF63-\\uDF77\\uDF7D-\\uDF8F]|\\uD81B[\\uDE40-\\uDE96\\uDF00-\\uDF4A\\uDF50\\uDF93-\\uDF9F\\uDFE0\\uDFE1\\uDFE3]|\\uD821[\\uDC00-\\uDFF7]|\\uD823[\\uDC00-\\uDCD5\\uDD00-\\uDD08]|\\uD82B[\\uDFF0-\\uDFF3\\uDFF5-\\uDFFB\\uDFFD\\uDFFE]|\\uD82C[\\uDC00-\\uDD22\\uDD50-\\uDD52\\uDD64-\\uDD67\\uDD70-\\uDEFB]|\\uD82F[\\uDC00-\\uDC6A\\uDC70-\\uDC7C\\uDC80-\\uDC88\\uDC90-\\uDC99]|\\uD834[\\uDEE0-\\uDEF3\\uDF60-\\uDF78]|\\uD835[\\uDC00-\\uDC54\\uDC56-\\uDC9C\\uDC9E\\uDC9F\\uDCA2\\uDCA5\\uDCA6\\uDCA9-\\uDCAC\\uDCAE-\\uDCB9\\uDCBB\\uDCBD-\\uDCC3\\uDCC5-\\uDD05\\uDD07-\\uDD0A\\uDD0D-\\uDD14\\uDD16-\\uDD1C\\uDD1E-\\uDD39\\uDD3B-\\uDD3E\\uDD40-\\uDD44\\uDD46\\uDD4A-\\uDD50\\uDD52-\\uDEA5\\uDEA8-\\uDEC0\\uDEC2-\\uDEDA\\uDEDC-\\uDEFA\\uDEFC-\\uDF14\\uDF16-\\uDF34\\uDF36-\\uDF4E\\uDF50-\\uDF6E\\uDF70-\\uDF88\\uDF8A-\\uDFA8\\uDFAA-\\uDFC2\\uDFC4-\\uDFCB\\uDFCE-\\uDFFF]|\\uD837[\\uDF00-\\uDF1E]|\\uD838[\\uDD00-\\uDD2C\\uDD37-\\uDD3D\\uDD40-\\uDD49\\uDD4E\\uDE90-\\uDEAD\\uDEC0-\\uDEEB\\uDEF0-\\uDEF9]|\\uD839[\\uDFE0-\\uDFE6\\uDFE8-\\uDFEB\\uDFED\\uDFEE\\uDFF0-\\uDFFE]|\\uD83A[\\uDC00-\\uDCC4\\uDCC7-\\uDCCF\\uDD00-\\uDD43\\uDD4B\\uDD50-\\uDD59]|\\uD83B[\\uDC71-\\uDCAB\\uDCAD-\\uDCAF\\uDCB1-\\uDCB4\\uDD01-\\uDD2D\\uDD2F-\\uDD3D\\uDE00-\\uDE03\\uDE05-\\uDE1F\\uDE21\\uDE22\\uDE24\\uDE27\\uDE29-\\uDE32\\uDE34-\\uDE37\\uDE39\\uDE3B\\uDE42\\uDE47\\uDE49\\uDE4B\\uDE4D-\\uDE4F\\uDE51\\uDE52\\uDE54\\uDE57\\uDE59\\uDE5B\\uDE5D\\uDE5F\\uDE61\\uDE62\\uDE64\\uDE67-\\uDE6A\\uDE6C-\\uDE72\\uDE74-\\uDE77\\uDE79-\\uDE7C\\uDE7E\\uDE80-\\uDE89\\uDE8B-\\uDE9B\\uDEA1-\\uDEA3\\uDEA5-\\uDEA9\\uDEAB-\\uDEBB]|\\uD83C[\\uDD00-\\uDD0C]|\\uD83E[\\uDFF0-\\uDFF9]|\\uD869[\\uDC00-\\uDEDF\\uDF00-\\uDFFF]|\\uD86D[\\uDC00-\\uDF38\\uDF40-\\uDFFF]|\\uD86E[\\uDC00-\\uDC1D\\uDC20-\\uDFFF]|\\uD873[\\uDC00-\\uDEA1\\uDEB0-\\uDFFF]|\\uD87A[\\uDC00-\\uDFE0]|\\uD87E[\\uDC00-\\uDE1D]|\\uD884[\\uDC00-\\uDF4A])/)) return;\n      var nextChar = match[1] || match[2] || '';\n\n      if (!nextChar || nextChar && (prevChar === '' || this.rules.inline.punctuation.exec(prevChar))) {\n        var lLength = match[0].length - 1;\n        var rDelim,\n            rLength,\n            delimTotal = lLength,\n            midDelimTotal = 0;\n        var endReg = match[0][0] === '*' ? this.rules.inline.emStrong.rDelimAst : this.rules.inline.emStrong.rDelimUnd;\n        endReg.lastIndex = 0; // Clip maskedSrc to same section of string as src (move to lexer?)\n\n        maskedSrc = maskedSrc.slice(-1 * src.length + lLength);\n\n        while ((match = endReg.exec(maskedSrc)) != null) {\n          rDelim = match[1] || match[2] || match[3] || match[4] || match[5] || match[6];\n          if (!rDelim) continue; // skip single * in __abc*abc__\n\n          rLength = rDelim.length;\n\n          if (match[3] || match[4]) {\n            // found another Left Delim\n            delimTotal += rLength;\n            continue;\n          } else if (match[5] || match[6]) {\n            // either Left or Right Delim\n            if (lLength % 3 && !((lLength + rLength) % 3)) {\n              midDelimTotal += rLength;\n              continue; // CommonMark Emphasis Rules 9-10\n            }\n          }\n\n          delimTotal -= rLength;\n          if (delimTotal > 0) continue; // Haven't found enough closing delimiters\n          // Remove extra characters. *a*** -> *a*\n\n          rLength = Math.min(rLength, rLength + delimTotal + midDelimTotal); // Create `em` if smallest delimiter has odd char count. *a***\n\n          if (Math.min(lLength, rLength) % 2) {\n            var _text = src.slice(1, lLength + match.index + rLength);\n\n            return {\n              type: 'em',\n              raw: src.slice(0, lLength + match.index + rLength + 1),\n              text: _text,\n              tokens: this.lexer.inlineTokens(_text, [])\n            };\n          } // Create 'strong' if smallest delimiter has even char count. **a***\n\n\n          var text = src.slice(2, lLength + match.index + rLength - 1);\n          return {\n            type: 'strong',\n            raw: src.slice(0, lLength + match.index + rLength + 1),\n            text: text,\n            tokens: this.lexer.inlineTokens(text, [])\n          };\n        }\n      }\n    };\n\n    _proto.codespan = function codespan(src) {\n      var cap = this.rules.inline.code.exec(src);\n\n      if (cap) {\n        var text = cap[2].replace(/\\n/g, ' ');\n        var hasNonSpaceChars = /[^ ]/.test(text);\n        var hasSpaceCharsOnBothEnds = /^ /.test(text) && / $/.test(text);\n\n        if (hasNonSpaceChars && hasSpaceCharsOnBothEnds) {\n          text = text.substring(1, text.length - 1);\n        }\n\n        text = escape(text, true);\n        return {\n          type: 'codespan',\n          raw: cap[0],\n          text: text\n        };\n      }\n    };\n\n    _proto.br = function br(src) {\n      var cap = this.rules.inline.br.exec(src);\n\n      if (cap) {\n        return {\n          type: 'br',\n          raw: cap[0]\n        };\n      }\n    };\n\n    _proto.del = function del(src) {\n      var cap = this.rules.inline.del.exec(src);\n\n      if (cap) {\n        return {\n          type: 'del',\n          raw: cap[0],\n          text: cap[2],\n          tokens: this.lexer.inlineTokens(cap[2], [])\n        };\n      }\n    };\n\n    _proto.autolink = function autolink(src, mangle) {\n      var cap = this.rules.inline.autolink.exec(src);\n\n      if (cap) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = escape(this.options.mangle ? mangle(cap[1]) : cap[1]);\n          href = 'mailto:' + text;\n        } else {\n          text = escape(cap[1]);\n          href = text;\n        }\n\n        return {\n          type: 'link',\n          raw: cap[0],\n          text: text,\n          href: href,\n          tokens: [{\n            type: 'text',\n            raw: text,\n            text: text\n          }]\n        };\n      }\n    };\n\n    _proto.url = function url(src, mangle) {\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n          var prevCapZero;\n\n          do {\n            prevCapZero = cap[0];\n            cap[0] = this.rules.inline._backpedal.exec(cap[0])[0];\n          } while (prevCapZero !== cap[0]);\n\n          text = escape(cap[0]);\n\n          if (cap[1] === 'www.') {\n            href = 'http://' + text;\n          } else {\n            href = text;\n          }\n        }\n\n        return {\n          type: 'link',\n          raw: cap[0],\n          text: text,\n          href: href,\n          tokens: [{\n            type: 'text',\n            raw: text,\n            text: text\n          }]\n        };\n      }\n    };\n\n    _proto.inlineText = function inlineText(src, smartypants) {\n      var cap = this.rules.inline.text.exec(src);\n\n      if (cap) {\n        var text;\n\n        if (this.lexer.state.inRawBlock) {\n          text = this.options.sanitize ? this.options.sanitizer ? this.options.sanitizer(cap[0]) : escape(cap[0]) : cap[0];\n        } else {\n          text = escape(this.options.smartypants ? smartypants(cap[0]) : cap[0]);\n        }\n\n        return {\n          type: 'text',\n          raw: cap[0],\n          text: text\n        };\n      }\n    };\n\n    return Tokenizer;\n  }();\n\n  /**\n   * Block-Level Grammar\n   */\n\n  var block = {\n    newline: /^(?: *(?:\\n|$))+/,\n    code: /^( {4}[^\\n]+(?:\\n(?: *(?:\\n|$))*)?)+/,\n    fences: /^ {0,3}(`{3,}(?=[^`\\n]*\\n)|~{3,})([^\\n]*)\\n(?:|([\\s\\S]*?)\\n)(?: {0,3}\\1[~`]* *(?=\\n|$)|$)/,\n    hr: /^ {0,3}((?:-[\\t ]*){3,}|(?:_[ \\t]*){3,}|(?:\\*[ \\t]*){3,})(?:\\n+|$)/,\n    heading: /^ {0,3}(#{1,6})(?=\\s|$)(.*)(?:\\n+|$)/,\n    blockquote: /^( {0,3}> ?(paragraph|[^\\n]*)(?:\\n|$))+/,\n    list: /^( {0,3}bull)([ \\t][^\\n]+?)?(?:\\n|$)/,\n    html: '^ {0,3}(?:' // optional indentation\n    + '<(script|pre|style|textarea)[\\\\s>][\\\\s\\\\S]*?(?:</\\\\1>[^\\\\n]*\\\\n+|$)' // (1)\n    + '|comment[^\\\\n]*(\\\\n+|$)' // (2)\n    + '|<\\\\?[\\\\s\\\\S]*?(?:\\\\?>\\\\n*|$)' // (3)\n    + '|<![A-Z][\\\\s\\\\S]*?(?:>\\\\n*|$)' // (4)\n    + '|<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?(?:\\\\]\\\\]>\\\\n*|$)' // (5)\n    + '|</?(tag)(?: +|\\\\n|/?>)[\\\\s\\\\S]*?(?:(?:\\\\n *)+\\\\n|$)' // (6)\n    + '|<(?!script|pre|style|textarea)([a-z][\\\\w-]*)(?:attribute)*? */?>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:(?:\\\\n *)+\\\\n|$)' // (7) open tag\n    + '|</(?!script|pre|style|textarea)[a-z][\\\\w-]*\\\\s*>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:(?:\\\\n *)+\\\\n|$)' // (7) closing tag\n    + ')',\n    def: /^ {0,3}\\[(label)\\]: *(?:\\n *)?<?([^\\s>]+)>?(?:(?: +(?:\\n *)?| *\\n *)(title))? *(?:\\n+|$)/,\n    table: noopTest,\n    lheading: /^([^\\n]+)\\n {0,3}(=+|-+) *(?:\\n+|$)/,\n    // regex template, placeholders will be replaced according to different paragraph\n    // interruption rules of commonmark and the original markdown spec:\n    _paragraph: /^([^\\n]+(?:\\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\\n)[^\\n]+)*)/,\n    text: /^[^\\n]+/\n  };\n  block._label = /(?!\\s*\\])(?:\\\\.|[^\\[\\]\\\\])+/;\n  block._title = /(?:\"(?:\\\\\"?|[^\"\\\\])*\"|'[^'\\n]*(?:\\n[^'\\n]+)*\\n?'|\\([^()]*\\))/;\n  block.def = edit(block.def).replace('label', block._label).replace('title', block._title).getRegex();\n  block.bullet = /(?:[*+-]|\\d{1,9}[.)])/;\n  block.listItemStart = edit(/^( *)(bull) */).replace('bull', block.bullet).getRegex();\n  block.list = edit(block.list).replace(/bull/g, block.bullet).replace('hr', '\\\\n+(?=\\\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\\\* *){3,})(?:\\\\n+|$))').replace('def', '\\\\n+(?=' + block.def.source + ')').getRegex();\n  block._tag = 'address|article|aside|base|basefont|blockquote|body|caption' + '|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption' + '|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe' + '|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option' + '|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr' + '|track|ul';\n  block._comment = /<!--(?!-?>)[\\s\\S]*?(?:-->|$)/;\n  block.html = edit(block.html, 'i').replace('comment', block._comment).replace('tag', block._tag).replace('attribute', / +[a-zA-Z:_][\\w.:-]*(?: *= *\"[^\"\\n]*\"| *= *'[^'\\n]*'| *= *[^\\s\"'=<>`]+)?/).getRegex();\n  block.paragraph = edit(block._paragraph).replace('hr', block.hr).replace('heading', ' {0,3}#{1,6} ').replace('|lheading', '') // setex headings don't interrupt commonmark paragraphs\n  .replace('|table', '').replace('blockquote', ' {0,3}>').replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n').replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n  .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)').replace('tag', block._tag) // pars can be interrupted by type (6) html blocks\n  .getRegex();\n  block.blockquote = edit(block.blockquote).replace('paragraph', block.paragraph).getRegex();\n  /**\n   * Normal Block Grammar\n   */\n\n  block.normal = merge({}, block);\n  /**\n   * GFM Block Grammar\n   */\n\n  block.gfm = merge({}, block.normal, {\n    table: '^ *([^\\\\n ].*\\\\|.*)\\\\n' // Header\n    + ' {0,3}(?:\\\\| *)?(:?-+:? *(?:\\\\| *:?-+:? *)*)(?:\\\\| *)?' // Align\n    + '(?:\\\\n((?:(?! *\\\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\\\n|$))*)\\\\n*|$)' // Cells\n\n  });\n  block.gfm.table = edit(block.gfm.table).replace('hr', block.hr).replace('heading', ' {0,3}#{1,6} ').replace('blockquote', ' {0,3}>').replace('code', ' {4}[^\\\\n]').replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n').replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n  .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)').replace('tag', block._tag) // tables can be interrupted by type (6) html blocks\n  .getRegex();\n  block.gfm.paragraph = edit(block._paragraph).replace('hr', block.hr).replace('heading', ' {0,3}#{1,6} ').replace('|lheading', '') // setex headings don't interrupt commonmark paragraphs\n  .replace('table', block.gfm.table) // interrupt paragraphs with table\n  .replace('blockquote', ' {0,3}>').replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n').replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n  .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)').replace('tag', block._tag) // pars can be interrupted by type (6) html blocks\n  .getRegex();\n  /**\n   * Pedantic grammar (original John Gruber's loose markdown specification)\n   */\n\n  block.pedantic = merge({}, block.normal, {\n    html: edit('^ *(?:comment *(?:\\\\n|\\\\s*$)' + '|<(tag)[\\\\s\\\\S]+?</\\\\1> *(?:\\\\n{2,}|\\\\s*$)' // closed tag\n    + '|<tag(?:\"[^\"]*\"|\\'[^\\']*\\'|\\\\s[^\\'\"/>\\\\s]*)*?/?> *(?:\\\\n{2,}|\\\\s*$))').replace('comment', block._comment).replace(/tag/g, '(?!(?:' + 'a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub' + '|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)' + '\\\\b)\\\\w+(?!:|[^\\\\w\\\\s@]*@)\\\\b').getRegex(),\n    def: /^ *\\[([^\\]]+)\\]: *<?([^\\s>]+)>?(?: +([\"(][^\\n]+[\")]))? *(?:\\n+|$)/,\n    heading: /^(#{1,6})(.*)(?:\\n+|$)/,\n    fences: noopTest,\n    // fences not supported\n    paragraph: edit(block.normal._paragraph).replace('hr', block.hr).replace('heading', ' *#{1,6} *[^\\n]').replace('lheading', block.lheading).replace('blockquote', ' {0,3}>').replace('|fences', '').replace('|list', '').replace('|html', '').getRegex()\n  });\n  /**\n   * Inline-Level Grammar\n   */\n\n  var inline = {\n    escape: /^\\\\([!\"#$%&'()*+,\\-./:;<=>?@\\[\\]\\\\^_`{|}~])/,\n    autolink: /^<(scheme:[^\\s\\x00-\\x1f<>]*|email)>/,\n    url: noopTest,\n    tag: '^comment' + '|^</[a-zA-Z][\\\\w:-]*\\\\s*>' // self-closing tag\n    + '|^<[a-zA-Z][\\\\w-]*(?:attribute)*?\\\\s*/?>' // open tag\n    + '|^<\\\\?[\\\\s\\\\S]*?\\\\?>' // processing instruction, e.g. <?php ?>\n    + '|^<![a-zA-Z]+\\\\s[\\\\s\\\\S]*?>' // declaration, e.g. <!DOCTYPE html>\n    + '|^<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?\\\\]\\\\]>',\n    // CDATA section\n    link: /^!?\\[(label)\\]\\(\\s*(href)(?:\\s+(title))?\\s*\\)/,\n    reflink: /^!?\\[(label)\\]\\[(ref)\\]/,\n    nolink: /^!?\\[(ref)\\](?:\\[\\])?/,\n    reflinkSearch: 'reflink|nolink(?!\\\\()',\n    emStrong: {\n      lDelim: /^(?:\\*+(?:([punct_])|[^\\s*]))|^_+(?:([punct*])|([^\\s_]))/,\n      //        (1) and (2) can only be a Right Delimiter. (3) and (4) can only be Left.  (5) and (6) can be either Left or Right.\n      //          () Skip orphan inside strong  () Consume to delim (1) #***                (2) a***#, a***                   (3) #***a, ***a                 (4) ***#              (5) #***#                 (6) a***a\n      rDelimAst: /^[^_*]*?\\_\\_[^_*]*?\\*[^_*]*?(?=\\_\\_)|[^*]+(?=[^*])|[punct_](\\*+)(?=[\\s]|$)|[^punct*_\\s](\\*+)(?=[punct_\\s]|$)|[punct_\\s](\\*+)(?=[^punct*_\\s])|[\\s](\\*+)(?=[punct_])|[punct_](\\*+)(?=[punct_])|[^punct*_\\s](\\*+)(?=[^punct*_\\s])/,\n      rDelimUnd: /^[^_*]*?\\*\\*[^_*]*?\\_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|[punct*](\\_+)(?=[\\s]|$)|[^punct*_\\s](\\_+)(?=[punct*\\s]|$)|[punct*\\s](\\_+)(?=[^punct*_\\s])|[\\s](\\_+)(?=[punct*])|[punct*](\\_+)(?=[punct*])/ // ^- Not allowed for _\n\n    },\n    code: /^(`+)([^`]|[^`][\\s\\S]*?[^`])\\1(?!`)/,\n    br: /^( {2,}|\\\\)\\n(?!\\s*$)/,\n    del: noopTest,\n    text: /^(`+|[^`])(?:(?= {2,}\\n)|[\\s\\S]*?(?:(?=[\\\\<!\\[`*_]|\\b_|$)|[^ ](?= {2,}\\n)))/,\n    punctuation: /^([\\spunctuation])/\n  }; // list of punctuation marks from CommonMark spec\n  // without * and _ to handle the different emphasis markers * and _\n\n  inline._punctuation = '!\"#$%&\\'()+\\\\-.,/:;<=>?@\\\\[\\\\]`^{|}~';\n  inline.punctuation = edit(inline.punctuation).replace(/punctuation/g, inline._punctuation).getRegex(); // sequences em should skip over [title](link), `code`, <html>\n\n  inline.blockSkip = /\\[[^\\]]*?\\]\\([^\\)]*?\\)|`[^`]*?`|<[^>]*?>/g;\n  inline.escapedEmSt = /\\\\\\*|\\\\_/g;\n  inline._comment = edit(block._comment).replace('(?:-->|$)', '-->').getRegex();\n  inline.emStrong.lDelim = edit(inline.emStrong.lDelim).replace(/punct/g, inline._punctuation).getRegex();\n  inline.emStrong.rDelimAst = edit(inline.emStrong.rDelimAst, 'g').replace(/punct/g, inline._punctuation).getRegex();\n  inline.emStrong.rDelimUnd = edit(inline.emStrong.rDelimUnd, 'g').replace(/punct/g, inline._punctuation).getRegex();\n  inline._escapes = /\\\\([!\"#$%&'()*+,\\-./:;<=>?@\\[\\]\\\\^_`{|}~])/g;\n  inline._scheme = /[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;\n  inline._email = /[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;\n  inline.autolink = edit(inline.autolink).replace('scheme', inline._scheme).replace('email', inline._email).getRegex();\n  inline._attribute = /\\s+[a-zA-Z:_][\\w.:-]*(?:\\s*=\\s*\"[^\"]*\"|\\s*=\\s*'[^']*'|\\s*=\\s*[^\\s\"'=<>`]+)?/;\n  inline.tag = edit(inline.tag).replace('comment', inline._comment).replace('attribute', inline._attribute).getRegex();\n  inline._label = /(?:\\[(?:\\\\.|[^\\[\\]\\\\])*\\]|\\\\.|`[^`]*`|[^\\[\\]\\\\`])*?/;\n  inline._href = /<(?:\\\\.|[^\\n<>\\\\])+>|[^\\s\\x00-\\x1f]*/;\n  inline._title = /\"(?:\\\\\"?|[^\"\\\\])*\"|'(?:\\\\'?|[^'\\\\])*'|\\((?:\\\\\\)?|[^)\\\\])*\\)/;\n  inline.link = edit(inline.link).replace('label', inline._label).replace('href', inline._href).replace('title', inline._title).getRegex();\n  inline.reflink = edit(inline.reflink).replace('label', inline._label).replace('ref', block._label).getRegex();\n  inline.nolink = edit(inline.nolink).replace('ref', block._label).getRegex();\n  inline.reflinkSearch = edit(inline.reflinkSearch, 'g').replace('reflink', inline.reflink).replace('nolink', inline.nolink).getRegex();\n  /**\n   * Normal Inline Grammar\n   */\n\n  inline.normal = merge({}, inline);\n  /**\n   * Pedantic Inline Grammar\n   */\n\n  inline.pedantic = merge({}, inline.normal, {\n    strong: {\n      start: /^__|\\*\\*/,\n      middle: /^__(?=\\S)([\\s\\S]*?\\S)__(?!_)|^\\*\\*(?=\\S)([\\s\\S]*?\\S)\\*\\*(?!\\*)/,\n      endAst: /\\*\\*(?!\\*)/g,\n      endUnd: /__(?!_)/g\n    },\n    em: {\n      start: /^_|\\*/,\n      middle: /^()\\*(?=\\S)([\\s\\S]*?\\S)\\*(?!\\*)|^_(?=\\S)([\\s\\S]*?\\S)_(?!_)/,\n      endAst: /\\*(?!\\*)/g,\n      endUnd: /_(?!_)/g\n    },\n    link: edit(/^!?\\[(label)\\]\\((.*?)\\)/).replace('label', inline._label).getRegex(),\n    reflink: edit(/^!?\\[(label)\\]\\s*\\[([^\\]]*)\\]/).replace('label', inline._label).getRegex()\n  });\n  /**\n   * GFM Inline Grammar\n   */\n\n  inline.gfm = merge({}, inline.normal, {\n    escape: edit(inline.escape).replace('])', '~|])').getRegex(),\n    _extended_email: /[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,\n    url: /^((?:ftp|https?):\\/\\/|www\\.)(?:[a-zA-Z0-9\\-]+\\.?)+[^\\s<]*|^email/,\n    _backpedal: /(?:[^?!.,:;*_~()&]+|\\([^)]*\\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,\n    del: /^(~~?)(?=[^\\s~])([\\s\\S]*?[^\\s~])\\1(?=[^~]|$)/,\n    text: /^([`~]+|[^`~])(?:(?= {2,}\\n)|(?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@)|[\\s\\S]*?(?:(?=[\\\\<!\\[`*~_]|\\b_|https?:\\/\\/|ftp:\\/\\/|www\\.|$)|[^ ](?= {2,}\\n)|[^a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-](?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@)))/\n  });\n  inline.gfm.url = edit(inline.gfm.url, 'i').replace('email', inline.gfm._extended_email).getRegex();\n  /**\n   * GFM + Line Breaks Inline Grammar\n   */\n\n  inline.breaks = merge({}, inline.gfm, {\n    br: edit(inline.br).replace('{2,}', '*').getRegex(),\n    text: edit(inline.gfm.text).replace('\\\\b_', '\\\\b_| {2,}\\\\n').replace(/\\{2,\\}/g, '*').getRegex()\n  });\n\n  /**\n   * smartypants text replacement\n   * @param {string} text\n   */\n\n  function smartypants(text) {\n    return text // em-dashes\n    .replace(/---/g, \"\\u2014\") // en-dashes\n    .replace(/--/g, \"\\u2013\") // opening singles\n    .replace(/(^|[-\\u2014/(\\[{\"\\s])'/g, \"$1\\u2018\") // closing singles & apostrophes\n    .replace(/'/g, \"\\u2019\") // opening doubles\n    .replace(/(^|[-\\u2014/(\\[{\\u2018\\s])\"/g, \"$1\\u201C\") // closing doubles\n    .replace(/\"/g, \"\\u201D\") // ellipses\n    .replace(/\\.{3}/g, \"\\u2026\");\n  }\n  /**\n   * mangle email addresses\n   * @param {string} text\n   */\n\n\n  function mangle(text) {\n    var out = '',\n        i,\n        ch;\n    var l = text.length;\n\n    for (i = 0; i < l; i++) {\n      ch = text.charCodeAt(i);\n\n      if (Math.random() > 0.5) {\n        ch = 'x' + ch.toString(16);\n      }\n\n      out += '&#' + ch + ';';\n    }\n\n    return out;\n  }\n  /**\n   * Block Lexer\n   */\n\n\n  var Lexer = /*#__PURE__*/function () {\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || exports.defaults;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options = this.options;\n      this.tokenizer.lexer = this;\n      this.inlineQueue = [];\n      this.state = {\n        inLink: false,\n        inRawBlock: false,\n        top: true\n      };\n      var rules = {\n        block: block.normal,\n        inline: inline.normal\n      };\n\n      if (this.options.pedantic) {\n        rules.block = block.pedantic;\n        rules.inline = inline.pedantic;\n      } else if (this.options.gfm) {\n        rules.block = block.gfm;\n\n        if (this.options.breaks) {\n          rules.inline = inline.breaks;\n        } else {\n          rules.inline = inline.gfm;\n        }\n      }\n\n      this.tokenizer.rules = rules;\n    }\n    /**\n     * Expose Rules\n     */\n\n\n    /**\n     * Static Lex Method\n     */\n    Lexer.lex = function lex(src, options) {\n      var lexer = new Lexer(options);\n      return lexer.lex(src);\n    }\n    /**\n     * Static Lex Inline Method\n     */\n    ;\n\n    Lexer.lexInline = function lexInline(src, options) {\n      var lexer = new Lexer(options);\n      return lexer.inlineTokens(src);\n    }\n    /**\n     * Preprocessing\n     */\n    ;\n\n    var _proto = Lexer.prototype;\n\n    _proto.lex = function lex(src) {\n      src = src.replace(/\\r\\n|\\r/g, '\\n');\n      this.blockTokens(src, this.tokens);\n      var next;\n\n      while (next = this.inlineQueue.shift()) {\n        this.inlineTokens(next.src, next.tokens);\n      }\n\n      return this.tokens;\n    }\n    /**\n     * Lexing\n     */\n    ;\n\n    _proto.blockTokens = function blockTokens(src, tokens) {\n      var _this = this;\n\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/\\t/g, '    ').replace(/^ +$/gm, '');\n      } else {\n        src = src.replace(/^( *)(\\t+)/gm, function (_, leading, tabs) {\n          return leading + '    '.repeat(tabs.length);\n        });\n      }\n\n      var token, lastToken, cutSrc, lastParagraphClipped;\n\n      while (src) {\n        if (this.options.extensions && this.options.extensions.block && this.options.extensions.block.some(function (extTokenizer) {\n          if (token = extTokenizer.call({\n            lexer: _this\n          }, src, tokens)) {\n            src = src.substring(token.raw.length);\n            tokens.push(token);\n            return true;\n          }\n\n          return false;\n        })) {\n          continue;\n        } // newline\n\n\n        if (token = this.tokenizer.space(src)) {\n          src = src.substring(token.raw.length);\n\n          if (token.raw.length === 1 && tokens.length > 0) {\n            // if there's a single \\n as a spacer, it's terminating the last line,\n            // so move it there so that we don't get unecessary paragraph tags\n            tokens[tokens.length - 1].raw += '\\n';\n          } else {\n            tokens.push(token);\n          }\n\n          continue;\n        } // code\n\n\n        if (token = this.tokenizer.code(src)) {\n          src = src.substring(token.raw.length);\n          lastToken = tokens[tokens.length - 1]; // An indented code block cannot interrupt a paragraph.\n\n          if (lastToken && (lastToken.type === 'paragraph' || lastToken.type === 'text')) {\n            lastToken.raw += '\\n' + token.raw;\n            lastToken.text += '\\n' + token.text;\n            this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n          } else {\n            tokens.push(token);\n          }\n\n          continue;\n        } // fences\n\n\n        if (token = this.tokenizer.fences(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // heading\n\n\n        if (token = this.tokenizer.heading(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // hr\n\n\n        if (token = this.tokenizer.hr(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // blockquote\n\n\n        if (token = this.tokenizer.blockquote(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // list\n\n\n        if (token = this.tokenizer.list(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // html\n\n\n        if (token = this.tokenizer.html(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // def\n\n\n        if (token = this.tokenizer.def(src)) {\n          src = src.substring(token.raw.length);\n          lastToken = tokens[tokens.length - 1];\n\n          if (lastToken && (lastToken.type === 'paragraph' || lastToken.type === 'text')) {\n            lastToken.raw += '\\n' + token.raw;\n            lastToken.text += '\\n' + token.raw;\n            this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n          } else if (!this.tokens.links[token.tag]) {\n            this.tokens.links[token.tag] = {\n              href: token.href,\n              title: token.title\n            };\n          }\n\n          continue;\n        } // table (gfm)\n\n\n        if (token = this.tokenizer.table(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // lheading\n\n\n        if (token = this.tokenizer.lheading(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // top-level paragraph\n        // prevent paragraph consuming extensions by clipping 'src' to extension start\n\n\n        cutSrc = src;\n\n        if (this.options.extensions && this.options.extensions.startBlock) {\n          (function () {\n            var startIndex = Infinity;\n            var tempSrc = src.slice(1);\n            var tempStart = void 0;\n\n            _this.options.extensions.startBlock.forEach(function (getStartIndex) {\n              tempStart = getStartIndex.call({\n                lexer: this\n              }, tempSrc);\n\n              if (typeof tempStart === 'number' && tempStart >= 0) {\n                startIndex = Math.min(startIndex, tempStart);\n              }\n            });\n\n            if (startIndex < Infinity && startIndex >= 0) {\n              cutSrc = src.substring(0, startIndex + 1);\n            }\n          })();\n        }\n\n        if (this.state.top && (token = this.tokenizer.paragraph(cutSrc))) {\n          lastToken = tokens[tokens.length - 1];\n\n          if (lastParagraphClipped && lastToken.type === 'paragraph') {\n            lastToken.raw += '\\n' + token.raw;\n            lastToken.text += '\\n' + token.text;\n            this.inlineQueue.pop();\n            this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n          } else {\n            tokens.push(token);\n          }\n\n          lastParagraphClipped = cutSrc.length !== src.length;\n          src = src.substring(token.raw.length);\n          continue;\n        } // text\n\n\n        if (token = this.tokenizer.text(src)) {\n          src = src.substring(token.raw.length);\n          lastToken = tokens[tokens.length - 1];\n\n          if (lastToken && lastToken.type === 'text') {\n            lastToken.raw += '\\n' + token.raw;\n            lastToken.text += '\\n' + token.text;\n            this.inlineQueue.pop();\n            this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n          } else {\n            tokens.push(token);\n          }\n\n          continue;\n        }\n\n        if (src) {\n          var errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);\n\n          if (this.options.silent) {\n            console.error(errMsg);\n            break;\n          } else {\n            throw new Error(errMsg);\n          }\n        }\n      }\n\n      this.state.top = true;\n      return tokens;\n    };\n\n    _proto.inline = function inline(src, tokens) {\n      this.inlineQueue.push({\n        src: src,\n        tokens: tokens\n      });\n    }\n    /**\n     * Lexing/Compiling\n     */\n    ;\n\n    _proto.inlineTokens = function inlineTokens(src, tokens) {\n      var _this2 = this;\n\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      var token, lastToken, cutSrc; // String with links masked to avoid interference with em and strong\n\n      var maskedSrc = src;\n      var match;\n      var keepPrevChar, prevChar; // Mask out reflinks\n\n      if (this.tokens.links) {\n        var links = Object.keys(this.tokens.links);\n\n        if (links.length > 0) {\n          while ((match = this.tokenizer.rules.inline.reflinkSearch.exec(maskedSrc)) != null) {\n            if (links.includes(match[0].slice(match[0].lastIndexOf('[') + 1, -1))) {\n              maskedSrc = maskedSrc.slice(0, match.index) + '[' + repeatString('a', match[0].length - 2) + ']' + maskedSrc.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex);\n            }\n          }\n        }\n      } // Mask out other blocks\n\n\n      while ((match = this.tokenizer.rules.inline.blockSkip.exec(maskedSrc)) != null) {\n        maskedSrc = maskedSrc.slice(0, match.index) + '[' + repeatString('a', match[0].length - 2) + ']' + maskedSrc.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);\n      } // Mask out escaped em & strong delimiters\n\n\n      while ((match = this.tokenizer.rules.inline.escapedEmSt.exec(maskedSrc)) != null) {\n        maskedSrc = maskedSrc.slice(0, match.index) + '++' + maskedSrc.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);\n      }\n\n      while (src) {\n        if (!keepPrevChar) {\n          prevChar = '';\n        }\n\n        keepPrevChar = false; // extensions\n\n        if (this.options.extensions && this.options.extensions.inline && this.options.extensions.inline.some(function (extTokenizer) {\n          if (token = extTokenizer.call({\n            lexer: _this2\n          }, src, tokens)) {\n            src = src.substring(token.raw.length);\n            tokens.push(token);\n            return true;\n          }\n\n          return false;\n        })) {\n          continue;\n        } // escape\n\n\n        if (token = this.tokenizer.escape(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // tag\n\n\n        if (token = this.tokenizer.tag(src)) {\n          src = src.substring(token.raw.length);\n          lastToken = tokens[tokens.length - 1];\n\n          if (lastToken && token.type === 'text' && lastToken.type === 'text') {\n            lastToken.raw += token.raw;\n            lastToken.text += token.text;\n          } else {\n            tokens.push(token);\n          }\n\n          continue;\n        } // link\n\n\n        if (token = this.tokenizer.link(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // reflink, nolink\n\n\n        if (token = this.tokenizer.reflink(src, this.tokens.links)) {\n          src = src.substring(token.raw.length);\n          lastToken = tokens[tokens.length - 1];\n\n          if (lastToken && token.type === 'text' && lastToken.type === 'text') {\n            lastToken.raw += token.raw;\n            lastToken.text += token.text;\n          } else {\n            tokens.push(token);\n          }\n\n          continue;\n        } // em & strong\n\n\n        if (token = this.tokenizer.emStrong(src, maskedSrc, prevChar)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // code\n\n\n        if (token = this.tokenizer.codespan(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // br\n\n\n        if (token = this.tokenizer.br(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // del (gfm)\n\n\n        if (token = this.tokenizer.del(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // autolink\n\n\n        if (token = this.tokenizer.autolink(src, mangle)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // url (gfm)\n\n\n        if (!this.state.inLink && (token = this.tokenizer.url(src, mangle))) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // text\n        // prevent inlineText consuming extensions by clipping 'src' to extension start\n\n\n        cutSrc = src;\n\n        if (this.options.extensions && this.options.extensions.startInline) {\n          (function () {\n            var startIndex = Infinity;\n            var tempSrc = src.slice(1);\n            var tempStart = void 0;\n\n            _this2.options.extensions.startInline.forEach(function (getStartIndex) {\n              tempStart = getStartIndex.call({\n                lexer: this\n              }, tempSrc);\n\n              if (typeof tempStart === 'number' && tempStart >= 0) {\n                startIndex = Math.min(startIndex, tempStart);\n              }\n            });\n\n            if (startIndex < Infinity && startIndex >= 0) {\n              cutSrc = src.substring(0, startIndex + 1);\n            }\n          })();\n        }\n\n        if (token = this.tokenizer.inlineText(cutSrc, smartypants)) {\n          src = src.substring(token.raw.length);\n\n          if (token.raw.slice(-1) !== '_') {\n            // Track prevChar before string of ____ started\n            prevChar = token.raw.slice(-1);\n          }\n\n          keepPrevChar = true;\n          lastToken = tokens[tokens.length - 1];\n\n          if (lastToken && lastToken.type === 'text') {\n            lastToken.raw += token.raw;\n            lastToken.text += token.text;\n          } else {\n            tokens.push(token);\n          }\n\n          continue;\n        }\n\n        if (src) {\n          var errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);\n\n          if (this.options.silent) {\n            console.error(errMsg);\n            break;\n          } else {\n            throw new Error(errMsg);\n          }\n        }\n      }\n\n      return tokens;\n    };\n\n    _createClass(Lexer, null, [{\n      key: \"rules\",\n      get: function get() {\n        return {\n          block: block,\n          inline: inline\n        };\n      }\n    }]);\n\n    return Lexer;\n  }();\n\n  /**\n   * Renderer\n   */\n\n  var Renderer = /*#__PURE__*/function () {\n    function Renderer(options) {\n      this.options = options || exports.defaults;\n    }\n\n    var _proto = Renderer.prototype;\n\n    _proto.code = function code(_code, infostring, escaped) {\n      var lang = (infostring || '').match(/\\S*/)[0];\n\n      if (this.options.highlight) {\n        var out = this.options.highlight(_code, lang);\n\n        if (out != null && out !== _code) {\n          escaped = true;\n          _code = out;\n        }\n      }\n\n      _code = _code.replace(/\\n$/, '') + '\\n';\n\n      if (!lang) {\n        return '<pre><code>' + (escaped ? _code : escape(_code, true)) + '</code></pre>\\n';\n      }\n\n      return '<pre><code class=\"' + this.options.langPrefix + escape(lang, true) + '\">' + (escaped ? _code : escape(_code, true)) + '</code></pre>\\n';\n    }\n    /**\n     * @param {string} quote\n     */\n    ;\n\n    _proto.blockquote = function blockquote(quote) {\n      return \"<blockquote>\\n\" + quote + \"</blockquote>\\n\";\n    };\n\n    _proto.html = function html(_html) {\n      return _html;\n    }\n    /**\n     * @param {string} text\n     * @param {string} level\n     * @param {string} raw\n     * @param {any} slugger\n     */\n    ;\n\n    _proto.heading = function heading(text, level, raw, slugger) {\n      if (this.options.headerIds) {\n        var id = this.options.headerPrefix + slugger.slug(raw);\n        return \"<h\" + level + \" id=\\\"\" + id + \"\\\">\" + text + \"</h\" + level + \">\\n\";\n      } // ignore IDs\n\n\n      return \"<h\" + level + \">\" + text + \"</h\" + level + \">\\n\";\n    };\n\n    _proto.hr = function hr() {\n      return this.options.xhtml ? '<hr/>\\n' : '<hr>\\n';\n    };\n\n    _proto.list = function list(body, ordered, start) {\n      var type = ordered ? 'ol' : 'ul',\n          startatt = ordered && start !== 1 ? ' start=\"' + start + '\"' : '';\n      return '<' + type + startatt + '>\\n' + body + '</' + type + '>\\n';\n    }\n    /**\n     * @param {string} text\n     */\n    ;\n\n    _proto.listitem = function listitem(text) {\n      return \"<li>\" + text + \"</li>\\n\";\n    };\n\n    _proto.checkbox = function checkbox(checked) {\n      return '<input ' + (checked ? 'checked=\"\" ' : '') + 'disabled=\"\" type=\"checkbox\"' + (this.options.xhtml ? ' /' : '') + '> ';\n    }\n    /**\n     * @param {string} text\n     */\n    ;\n\n    _proto.paragraph = function paragraph(text) {\n      return \"<p>\" + text + \"</p>\\n\";\n    }\n    /**\n     * @param {string} header\n     * @param {string} body\n     */\n    ;\n\n    _proto.table = function table(header, body) {\n      if (body) body = \"<tbody>\" + body + \"</tbody>\";\n      return '<table>\\n' + '<thead>\\n' + header + '</thead>\\n' + body + '</table>\\n';\n    }\n    /**\n     * @param {string} content\n     */\n    ;\n\n    _proto.tablerow = function tablerow(content) {\n      return \"<tr>\\n\" + content + \"</tr>\\n\";\n    };\n\n    _proto.tablecell = function tablecell(content, flags) {\n      var type = flags.header ? 'th' : 'td';\n      var tag = flags.align ? \"<\" + type + \" align=\\\"\" + flags.align + \"\\\">\" : \"<\" + type + \">\";\n      return tag + content + (\"</\" + type + \">\\n\");\n    }\n    /**\n     * span level renderer\n     * @param {string} text\n     */\n    ;\n\n    _proto.strong = function strong(text) {\n      return \"<strong>\" + text + \"</strong>\";\n    }\n    /**\n     * @param {string} text\n     */\n    ;\n\n    _proto.em = function em(text) {\n      return \"<em>\" + text + \"</em>\";\n    }\n    /**\n     * @param {string} text\n     */\n    ;\n\n    _proto.codespan = function codespan(text) {\n      return \"<code>\" + text + \"</code>\";\n    };\n\n    _proto.br = function br() {\n      return this.options.xhtml ? '<br/>' : '<br>';\n    }\n    /**\n     * @param {string} text\n     */\n    ;\n\n    _proto.del = function del(text) {\n      return \"<del>\" + text + \"</del>\";\n    }\n    /**\n     * @param {string} href\n     * @param {string} title\n     * @param {string} text\n     */\n    ;\n\n    _proto.link = function link(href, title, text) {\n      href = cleanUrl(this.options.sanitize, this.options.baseUrl, href);\n\n      if (href === null) {\n        return text;\n      }\n\n      var out = '<a href=\"' + escape(href) + '\"';\n\n      if (title) {\n        out += ' title=\"' + title + '\"';\n      }\n\n      out += '>' + text + '</a>';\n      return out;\n    }\n    /**\n     * @param {string} href\n     * @param {string} title\n     * @param {string} text\n     */\n    ;\n\n    _proto.image = function image(href, title, text) {\n      href = cleanUrl(this.options.sanitize, this.options.baseUrl, href);\n\n      if (href === null) {\n        return text;\n      }\n\n      var out = \"<img src=\\\"\" + href + \"\\\" alt=\\\"\" + text + \"\\\"\";\n\n      if (title) {\n        out += \" title=\\\"\" + title + \"\\\"\";\n      }\n\n      out += this.options.xhtml ? '/>' : '>';\n      return out;\n    };\n\n    _proto.text = function text(_text) {\n      return _text;\n    };\n\n    return Renderer;\n  }();\n\n  /**\n   * TextRenderer\n   * returns only the textual part of the token\n   */\n  var TextRenderer = /*#__PURE__*/function () {\n    function TextRenderer() {}\n\n    var _proto = TextRenderer.prototype;\n\n    // no need for block level renderers\n    _proto.strong = function strong(text) {\n      return text;\n    };\n\n    _proto.em = function em(text) {\n      return text;\n    };\n\n    _proto.codespan = function codespan(text) {\n      return text;\n    };\n\n    _proto.del = function del(text) {\n      return text;\n    };\n\n    _proto.html = function html(text) {\n      return text;\n    };\n\n    _proto.text = function text(_text) {\n      return _text;\n    };\n\n    _proto.link = function link(href, title, text) {\n      return '' + text;\n    };\n\n    _proto.image = function image(href, title, text) {\n      return '' + text;\n    };\n\n    _proto.br = function br() {\n      return '';\n    };\n\n    return TextRenderer;\n  }();\n\n  /**\n   * Slugger generates header id\n   */\n  var Slugger = /*#__PURE__*/function () {\n    function Slugger() {\n      this.seen = {};\n    }\n    /**\n     * @param {string} value\n     */\n\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2E00-\\u2E7F\\\\'!\"#$%&()*+,./:;<=>?@[\\]^`{|}~]/g, '').replace(/\\s/g, '-');\n    }\n    /**\n     * Finds the next safe (unique) slug to use\n     * @param {string} originalSlug\n     * @param {boolean} isDryRun\n     */\n    ;\n\n    _proto.getNextSafeSlug = function getNextSafeSlug(originalSlug, isDryRun) {\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.seen.hasOwnProperty(slug));\n      }\n\n      if (!isDryRun) {\n        this.seen[originalSlug] = occurenceAccumulator;\n        this.seen[slug] = 0;\n      }\n\n      return slug;\n    }\n    /**\n     * Convert string to unique id\n     * @param {object} [options]\n     * @param {boolean} [options.dryrun] Generates the next unique slug without\n     * updating the internal accumulator.\n     */\n    ;\n\n    _proto.slug = function slug(value, options) {\n      if (options === void 0) {\n        options = {};\n      }\n\n      var slug = this.serialize(value);\n      return this.getNextSafeSlug(slug, options.dryrun);\n    };\n\n    return Slugger;\n  }();\n\n  /**\n   * Parsing & Compiling\n   */\n\n  var Parser = /*#__PURE__*/function () {\n    function Parser(options) {\n      this.options = options || exports.defaults;\n      this.options.renderer = this.options.renderer || new Renderer();\n      this.renderer = this.options.renderer;\n      this.renderer.options = this.options;\n      this.textRenderer = new TextRenderer();\n      this.slugger = new Slugger();\n    }\n    /**\n     * Static Parse Method\n     */\n\n\n    Parser.parse = function parse(tokens, options) {\n      var parser = new Parser(options);\n      return parser.parse(tokens);\n    }\n    /**\n     * Static Parse Inline Method\n     */\n    ;\n\n    Parser.parseInline = function parseInline(tokens, options) {\n      var parser = new Parser(options);\n      return parser.parseInline(tokens);\n    }\n    /**\n     * Parse Loop\n     */\n    ;\n\n    var _proto = Parser.prototype;\n\n    _proto.parse = function parse(tokens, top) {\n      if (top === void 0) {\n        top = true;\n      }\n\n      var out = '',\n          i,\n          j,\n          k,\n          l2,\n          l3,\n          row,\n          cell,\n          header,\n          body,\n          token,\n          ordered,\n          start,\n          loose,\n          itemBody,\n          item,\n          checked,\n          task,\n          checkbox,\n          ret;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i]; // Run any renderer extensions\n\n        if (this.options.extensions && this.options.extensions.renderers && this.options.extensions.renderers[token.type]) {\n          ret = this.options.extensions.renderers[token.type].call({\n            parser: this\n          }, token);\n\n          if (ret !== false || !['space', 'hr', 'heading', 'code', 'table', 'blockquote', 'list', 'html', 'paragraph', 'text'].includes(token.type)) {\n            out += ret || '';\n            continue;\n          }\n        }\n\n        switch (token.type) {\n          case 'space':\n            {\n              continue;\n            }\n\n          case 'hr':\n            {\n              out += this.renderer.hr();\n              continue;\n            }\n\n          case 'heading':\n            {\n              out += this.renderer.heading(this.parseInline(token.tokens), token.depth, unescape(this.parseInline(token.tokens, this.textRenderer)), this.slugger);\n              continue;\n            }\n\n          case 'code':\n            {\n              out += this.renderer.code(token.text, token.lang, token.escaped);\n              continue;\n            }\n\n          case 'table':\n            {\n              header = ''; // header\n\n              cell = '';\n              l2 = token.header.length;\n\n              for (j = 0; j < l2; j++) {\n                cell += this.renderer.tablecell(this.parseInline(token.header[j].tokens), {\n                  header: true,\n                  align: token.align[j]\n                });\n              }\n\n              header += this.renderer.tablerow(cell);\n              body = '';\n              l2 = token.rows.length;\n\n              for (j = 0; j < l2; j++) {\n                row = token.rows[j];\n                cell = '';\n                l3 = row.length;\n\n                for (k = 0; k < l3; k++) {\n                  cell += this.renderer.tablecell(this.parseInline(row[k].tokens), {\n                    header: false,\n                    align: token.align[k]\n                  });\n                }\n\n                body += this.renderer.tablerow(cell);\n              }\n\n              out += this.renderer.table(header, body);\n              continue;\n            }\n\n          case 'blockquote':\n            {\n              body = this.parse(token.tokens);\n              out += this.renderer.blockquote(body);\n              continue;\n            }\n\n          case 'list':\n            {\n              ordered = token.ordered;\n              start = token.start;\n              loose = token.loose;\n              l2 = token.items.length;\n              body = '';\n\n              for (j = 0; j < l2; j++) {\n                item = token.items[j];\n                checked = item.checked;\n                task = item.task;\n                itemBody = '';\n\n                if (item.task) {\n                  checkbox = this.renderer.checkbox(checked);\n\n                  if (loose) {\n                    if (item.tokens.length > 0 && item.tokens[0].type === 'paragraph') {\n                      item.tokens[0].text = checkbox + ' ' + item.tokens[0].text;\n\n                      if (item.tokens[0].tokens && item.tokens[0].tokens.length > 0 && item.tokens[0].tokens[0].type === 'text') {\n                        item.tokens[0].tokens[0].text = checkbox + ' ' + item.tokens[0].tokens[0].text;\n                      }\n                    } else {\n                      item.tokens.unshift({\n                        type: 'text',\n                        text: checkbox\n                      });\n                    }\n                  } else {\n                    itemBody += checkbox;\n                  }\n                }\n\n                itemBody += this.parse(item.tokens, loose);\n                body += this.renderer.listitem(itemBody, task, checked);\n              }\n\n              out += this.renderer.list(body, ordered, start);\n              continue;\n            }\n\n          case 'html':\n            {\n              // TODO parse inline content if parameter markdown=1\n              out += this.renderer.html(token.text);\n              continue;\n            }\n\n          case 'paragraph':\n            {\n              out += this.renderer.paragraph(this.parseInline(token.tokens));\n              continue;\n            }\n\n          case 'text':\n            {\n              body = token.tokens ? this.parseInline(token.tokens) : token.text;\n\n              while (i + 1 < l && tokens[i + 1].type === 'text') {\n                token = tokens[++i];\n                body += '\\n' + (token.tokens ? this.parseInline(token.tokens) : token.text);\n              }\n\n              out += top ? this.renderer.paragraph(body) : body;\n              continue;\n            }\n\n          default:\n            {\n              var errMsg = 'Token with \"' + token.type + '\" type was not found.';\n\n              if (this.options.silent) {\n                console.error(errMsg);\n                return;\n              } else {\n                throw new Error(errMsg);\n              }\n            }\n        }\n      }\n\n      return out;\n    }\n    /**\n     * Parse Inline Tokens\n     */\n    ;\n\n    _proto.parseInline = function parseInline(tokens, renderer) {\n      renderer = renderer || this.renderer;\n      var out = '',\n          i,\n          token,\n          ret;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i]; // Run any renderer extensions\n\n        if (this.options.extensions && this.options.extensions.renderers && this.options.extensions.renderers[token.type]) {\n          ret = this.options.extensions.renderers[token.type].call({\n            parser: this\n          }, token);\n\n          if (ret !== false || !['escape', 'html', 'link', 'image', 'strong', 'em', 'codespan', 'br', 'del', 'text'].includes(token.type)) {\n            out += ret || '';\n            continue;\n          }\n        }\n\n        switch (token.type) {\n          case 'escape':\n            {\n              out += renderer.text(token.text);\n              break;\n            }\n\n          case 'html':\n            {\n              out += renderer.html(token.text);\n              break;\n            }\n\n          case 'link':\n            {\n              out += renderer.link(token.href, token.title, this.parseInline(token.tokens, renderer));\n              break;\n            }\n\n          case 'image':\n            {\n              out += renderer.image(token.href, token.title, token.text);\n              break;\n            }\n\n          case 'strong':\n            {\n              out += renderer.strong(this.parseInline(token.tokens, renderer));\n              break;\n            }\n\n          case 'em':\n            {\n              out += renderer.em(this.parseInline(token.tokens, renderer));\n              break;\n            }\n\n          case 'codespan':\n            {\n              out += renderer.codespan(token.text);\n              break;\n            }\n\n          case 'br':\n            {\n              out += renderer.br();\n              break;\n            }\n\n          case 'del':\n            {\n              out += renderer.del(this.parseInline(token.tokens, renderer));\n              break;\n            }\n\n          case 'text':\n            {\n              out += renderer.text(token.text);\n              break;\n            }\n\n          default:\n            {\n              var errMsg = 'Token with \"' + token.type + '\" type was not found.';\n\n              if (this.options.silent) {\n                console.error(errMsg);\n                return;\n              } else {\n                throw new Error(errMsg);\n              }\n            }\n        }\n      }\n\n      return out;\n    };\n\n    return Parser;\n  }();\n\n  /**\n   * Marked\n   */\n\n  function marked(src, opt, callback) {\n    // throw error in case of non string input\n    if (typeof src === 'undefined' || src === null) {\n      throw new Error('marked(): input parameter is undefined or null');\n    }\n\n    if (typeof src !== 'string') {\n      throw new Error('marked(): input parameter is of type ' + Object.prototype.toString.call(src) + ', string expected');\n    }\n\n    if (typeof opt === 'function') {\n      callback = opt;\n      opt = null;\n    }\n\n    opt = merge({}, marked.defaults, opt || {});\n    checkSanitizeDeprecation(opt);\n\n    if (callback) {\n      var highlight = opt.highlight;\n      var tokens;\n\n      try {\n        tokens = Lexer.lex(src, opt);\n      } catch (e) {\n        return callback(e);\n      }\n\n      var done = function done(err) {\n        var out;\n\n        if (!err) {\n          try {\n            if (opt.walkTokens) {\n              marked.walkTokens(tokens, opt.walkTokens);\n            }\n\n            out = Parser.parse(tokens, opt);\n          } catch (e) {\n            err = e;\n          }\n        }\n\n        opt.highlight = highlight;\n        return err ? callback(err) : callback(null, out);\n      };\n\n      if (!highlight || highlight.length < 3) {\n        return done();\n      }\n\n      delete opt.highlight;\n      if (!tokens.length) return done();\n      var pending = 0;\n      marked.walkTokens(tokens, function (token) {\n        if (token.type === 'code') {\n          pending++;\n          setTimeout(function () {\n            highlight(token.text, token.lang, function (err, code) {\n              if (err) {\n                return done(err);\n              }\n\n              if (code != null && code !== token.text) {\n                token.text = code;\n                token.escaped = true;\n              }\n\n              pending--;\n\n              if (pending === 0) {\n                done();\n              }\n            });\n          }, 0);\n        }\n      });\n\n      if (pending === 0) {\n        done();\n      }\n\n      return;\n    }\n\n    try {\n      var _tokens = Lexer.lex(src, opt);\n\n      if (opt.walkTokens) {\n        marked.walkTokens(_tokens, opt.walkTokens);\n      }\n\n      return Parser.parse(_tokens, opt);\n    } catch (e) {\n      e.message += '\\nPlease report this to https://github.com/markedjs/marked.';\n\n      if (opt.silent) {\n        return '<p>An error occurred:</p><pre>' + escape(e.message + '', true) + '</pre>';\n      }\n\n      throw e;\n    }\n  }\n  /**\n   * Options\n   */\n\n  marked.options = marked.setOptions = function (opt) {\n    merge(marked.defaults, opt);\n    changeDefaults(marked.defaults);\n    return marked;\n  };\n\n  marked.getDefaults = getDefaults;\n  marked.defaults = exports.defaults;\n  /**\n   * Use Extension\n   */\n\n  marked.use = function () {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    var opts = merge.apply(void 0, [{}].concat(args));\n    var extensions = marked.defaults.extensions || {\n      renderers: {},\n      childTokens: {}\n    };\n    var hasExtensions;\n    args.forEach(function (pack) {\n      // ==-- Parse \"addon\" extensions --== //\n      if (pack.extensions) {\n        hasExtensions = true;\n        pack.extensions.forEach(function (ext) {\n          if (!ext.name) {\n            throw new Error('extension name required');\n          }\n\n          if (ext.renderer) {\n            // Renderer extensions\n            var prevRenderer = extensions.renderers ? extensions.renderers[ext.name] : null;\n\n            if (prevRenderer) {\n              // Replace extension with func to run new extension but fall back if false\n              extensions.renderers[ext.name] = function () {\n                for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n                  args[_key2] = arguments[_key2];\n                }\n\n                var ret = ext.renderer.apply(this, args);\n\n                if (ret === false) {\n                  ret = prevRenderer.apply(this, args);\n                }\n\n                return ret;\n              };\n            } else {\n              extensions.renderers[ext.name] = ext.renderer;\n            }\n          }\n\n          if (ext.tokenizer) {\n            // Tokenizer Extensions\n            if (!ext.level || ext.level !== 'block' && ext.level !== 'inline') {\n              throw new Error(\"extension level must be 'block' or 'inline'\");\n            }\n\n            if (extensions[ext.level]) {\n              extensions[ext.level].unshift(ext.tokenizer);\n            } else {\n              extensions[ext.level] = [ext.tokenizer];\n            }\n\n            if (ext.start) {\n              // Function to check for start of token\n              if (ext.level === 'block') {\n                if (extensions.startBlock) {\n                  extensions.startBlock.push(ext.start);\n                } else {\n                  extensions.startBlock = [ext.start];\n                }\n              } else if (ext.level === 'inline') {\n                if (extensions.startInline) {\n                  extensions.startInline.push(ext.start);\n                } else {\n                  extensions.startInline = [ext.start];\n                }\n              }\n            }\n          }\n\n          if (ext.childTokens) {\n            // Child tokens to be visited by walkTokens\n            extensions.childTokens[ext.name] = ext.childTokens;\n          }\n        });\n      } // ==-- Parse \"overwrite\" extensions --== //\n\n\n      if (pack.renderer) {\n        (function () {\n          var renderer = marked.defaults.renderer || new Renderer();\n\n          var _loop = function _loop(prop) {\n            var prevRenderer = renderer[prop]; // Replace renderer with func to run extension, but fall back if false\n\n            renderer[prop] = function () {\n              for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n                args[_key3] = arguments[_key3];\n              }\n\n              var ret = pack.renderer[prop].apply(renderer, args);\n\n              if (ret === false) {\n                ret = prevRenderer.apply(renderer, args);\n              }\n\n              return ret;\n            };\n          };\n\n          for (var prop in pack.renderer) {\n            _loop(prop);\n          }\n\n          opts.renderer = renderer;\n        })();\n      }\n\n      if (pack.tokenizer) {\n        (function () {\n          var tokenizer = marked.defaults.tokenizer || new Tokenizer();\n\n          var _loop2 = function _loop2(prop) {\n            var prevTokenizer = tokenizer[prop]; // Replace tokenizer with func to run extension, but fall back if false\n\n            tokenizer[prop] = function () {\n              for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n                args[_key4] = arguments[_key4];\n              }\n\n              var ret = pack.tokenizer[prop].apply(tokenizer, args);\n\n              if (ret === false) {\n                ret = prevTokenizer.apply(tokenizer, args);\n              }\n\n              return ret;\n            };\n          };\n\n          for (var prop in pack.tokenizer) {\n            _loop2(prop);\n          }\n\n          opts.tokenizer = tokenizer;\n        })();\n      } // ==-- Parse WalkTokens extensions --== //\n\n\n      if (pack.walkTokens) {\n        var _walkTokens = marked.defaults.walkTokens;\n\n        opts.walkTokens = function (token) {\n          pack.walkTokens.call(this, token);\n\n          if (_walkTokens) {\n            _walkTokens.call(this, token);\n          }\n        };\n      }\n\n      if (hasExtensions) {\n        opts.extensions = extensions;\n      }\n\n      marked.setOptions(opts);\n    });\n  };\n  /**\n   * Run callback for every token\n   */\n\n\n  marked.walkTokens = function (tokens, callback) {\n    var _loop3 = function _loop3() {\n      var token = _step.value;\n      callback.call(marked, token);\n\n      switch (token.type) {\n        case 'table':\n          {\n            for (var _iterator2 = _createForOfIteratorHelperLoose(token.header), _step2; !(_step2 = _iterator2()).done;) {\n              var cell = _step2.value;\n              marked.walkTokens(cell.tokens, callback);\n            }\n\n            for (var _iterator3 = _createForOfIteratorHelperLoose(token.rows), _step3; !(_step3 = _iterator3()).done;) {\n              var row = _step3.value;\n\n              for (var _iterator4 = _createForOfIteratorHelperLoose(row), _step4; !(_step4 = _iterator4()).done;) {\n                var _cell = _step4.value;\n                marked.walkTokens(_cell.tokens, callback);\n              }\n            }\n\n            break;\n          }\n\n        case 'list':\n          {\n            marked.walkTokens(token.items, callback);\n            break;\n          }\n\n        default:\n          {\n            if (marked.defaults.extensions && marked.defaults.extensions.childTokens && marked.defaults.extensions.childTokens[token.type]) {\n              // Walk any extensions\n              marked.defaults.extensions.childTokens[token.type].forEach(function (childTokens) {\n                marked.walkTokens(token[childTokens], callback);\n              });\n            } else if (token.tokens) {\n              marked.walkTokens(token.tokens, callback);\n            }\n          }\n      }\n    };\n\n    for (var _iterator = _createForOfIteratorHelperLoose(tokens), _step; !(_step = _iterator()).done;) {\n      _loop3();\n    }\n  };\n  /**\n   * Parse Inline\n   * @param {string} src\n   */\n\n\n  marked.parseInline = function (src, opt) {\n    // throw error in case of non string input\n    if (typeof src === 'undefined' || src === null) {\n      throw new Error('marked.parseInline(): input parameter is undefined or null');\n    }\n\n    if (typeof src !== 'string') {\n      throw new Error('marked.parseInline(): input parameter is of type ' + Object.prototype.toString.call(src) + ', string expected');\n    }\n\n    opt = merge({}, marked.defaults, opt || {});\n    checkSanitizeDeprecation(opt);\n\n    try {\n      var tokens = Lexer.lexInline(src, opt);\n\n      if (opt.walkTokens) {\n        marked.walkTokens(tokens, opt.walkTokens);\n      }\n\n      return Parser.parseInline(tokens, opt);\n    } catch (e) {\n      e.message += '\\nPlease report this to https://github.com/markedjs/marked.';\n\n      if (opt.silent) {\n        return '<p>An error occurred:</p><pre>' + escape(e.message + '', true) + '</pre>';\n      }\n\n      throw e;\n    }\n  };\n  /**\n   * Expose\n   */\n\n\n  marked.Parser = Parser;\n  marked.parser = Parser.parse;\n  marked.Renderer = Renderer;\n  marked.TextRenderer = TextRenderer;\n  marked.Lexer = Lexer;\n  marked.lexer = Lexer.lex;\n  marked.Tokenizer = Tokenizer;\n  marked.Slugger = Slugger;\n  marked.parse = marked;\n  var options = marked.options;\n  var setOptions = marked.setOptions;\n  var use = marked.use;\n  var walkTokens = marked.walkTokens;\n  var parseInline = marked.parseInline;\n  var parse = marked;\n  var parser = Parser.parse;\n  var lexer = Lexer.lex;\n\n  exports.Lexer = Lexer;\n  exports.Parser = Parser;\n  exports.Renderer = Renderer;\n  exports.Slugger = Slugger;\n  exports.TextRenderer = TextRenderer;\n  exports.Tokenizer = Tokenizer;\n  exports.getDefaults = getDefaults;\n  exports.lexer = lexer;\n  exports.marked = marked;\n  exports.options = options;\n  exports.parse = parse;\n  exports.parseInline = parseInline;\n  exports.parser = parser;\n  exports.setOptions = setOptions;\n  exports.use = use;\n  exports.walkTokens = walkTokens;\n\n  Object.defineProperty(exports, '__esModule', { value: true });\n\n}));\n\n// ESM-uncomment-begin\n// })();\n// export var marked = (__marked_exports || exports);\n// ESM-uncomment-end\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport function clamp(value: number, min: number, max: number): number {\n\treturn Math.min(Math.max(value, min), max);\n}\n\nexport function rot(index: number, modulo: number): number {\n\treturn (modulo + (index % modulo)) % modulo;\n}\n\nexport class Counter {\n\tprivate _next = 0;\n\n\tgetNext(): number {\n\t\treturn this._next++;\n\t}\n}\n\nexport class MovingAverage {\n\n\tprivate _n = 1;\n\tprivate _val = 0;\n\n\tupdate(value: number): number {\n\t\tthis._val = this._val + (value - this._val) / this._n;\n\t\tthis._n += 1;\n\t\treturn this._val;\n\t}\n\n\tget value(): number {\n\t\treturn this._val;\n\t}\n}\n\nexport class SlidingWindowAverage {\n\n\tprivate _n: number = 0;\n\tprivate _val = 0;\n\n\tprivate readonly _values: number[] = [];\n\tprivate _index: number = 0;\n\tprivate _sum = 0;\n\n\tconstructor(size: number) {\n\t\tthis._values = new Array(size);\n\t\tthis._values.fill(0, 0, size);\n\t}\n\n\tupdate(value: number): number {\n\t\tconst oldValue = this._values[this._index];\n\t\tthis._values[this._index] = value;\n\t\tthis._index = (this._index + 1) % this._values.length;\n\n\t\tthis._sum -= oldValue;\n\t\tthis._sum += value;\n\n\t\tif (this._n < this._values.length) {\n\t\t\tthis._n += 1;\n\t\t}\n\n\t\tthis._val = this._sum / this._n;\n\t\treturn this._val;\n\t}\n\n\tget value(): number {\n\t\treturn this._val;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n'use strict';\n\n//@ts-check\n\n(function () {\n\n\t/**\n\t * @returns {{mark(name:string):void, getMarks():{name:string, startTime:number}[]}}\n\t */\n\tfunction _definePolyfillMarks(timeOrigin) {\n\n\t\tconst _data = [];\n\t\tif (typeof timeOrigin === 'number') {\n\t\t\t_data.push('code/timeOrigin', timeOrigin);\n\t\t}\n\n\t\tfunction mark(name) {\n\t\t\t_data.push(name, Date.now());\n\t\t}\n\t\tfunction getMarks() {\n\t\t\tconst result = [];\n\t\t\tfor (let i = 0; i < _data.length; i += 2) {\n\t\t\t\tresult.push({\n\t\t\t\t\tname: _data[i],\n\t\t\t\t\tstartTime: _data[i + 1],\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\t\treturn { mark, getMarks };\n\t}\n\n\t/**\n\t * @returns {{mark(name:string):void, getMarks():{name:string, startTime:number}[]}}\n\t */\n\tfunction _define() {\n\n\t\t// Identify browser environment when following property is not present\n\t\t// https://nodejs.org/dist/latest-v16.x/docs/api/perf_hooks.html#performancenodetiming\n\t\tif (typeof performance === 'object' && typeof performance.mark === 'function' && !performance.nodeTiming) {\n\t\t\t// in a browser context, reuse performance-util\n\n\t\t\tif (typeof performance.timeOrigin !== 'number' && !performance.timing) {\n\t\t\t\t// safari & webworker: because there is no timeOrigin and no workaround\n\t\t\t\t// we use the `Date.now`-based polyfill.\n\t\t\t\treturn _definePolyfillMarks();\n\n\t\t\t} else {\n\t\t\t\t// use \"native\" performance for mark and getMarks\n\t\t\t\treturn {\n\t\t\t\t\tmark(name) {\n\t\t\t\t\t\tperformance.mark(name);\n\t\t\t\t\t},\n\t\t\t\t\tgetMarks() {\n\t\t\t\t\t\tlet timeOrigin = performance.timeOrigin;\n\t\t\t\t\t\tif (typeof timeOrigin !== 'number') {\n\t\t\t\t\t\t\t// safari: there is no timerOrigin but in renderers there is the timing-property\n\t\t\t\t\t\t\t// see https://bugs.webkit.org/show_bug.cgi?id=174862\n\t\t\t\t\t\t\ttimeOrigin = performance.timing.navigationStart || performance.timing.redirectStart || performance.timing.fetchStart;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst result = [{ name: 'code/timeOrigin', startTime: Math.round(timeOrigin) }];\n\t\t\t\t\t\tfor (const entry of performance.getEntriesByType('mark')) {\n\t\t\t\t\t\t\tresult.push({\n\t\t\t\t\t\t\t\tname: entry.name,\n\t\t\t\t\t\t\t\tstartTime: Math.round(timeOrigin + entry.startTime)\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\n\t\t} else if (typeof process === 'object') {\n\t\t\t// node.js: use the normal polyfill but add the timeOrigin\n\t\t\t// from the node perf_hooks API as very first mark\n\t\t\tconst timeOrigin = Math.round((require.nodeRequire || require)('perf_hooks').performance.timeOrigin);\n\t\t\treturn _definePolyfillMarks(timeOrigin);\n\n\t\t} else {\n\t\t\t// unknown environment\n\t\t\tconsole.trace('perf-util loaded in UNKNOWN environment');\n\t\t\treturn _definePolyfillMarks();\n\t\t}\n\t}\n\n\tfunction _factory(sharedObj) {\n\t\tif (!sharedObj.MonacoPerformanceMarks) {\n\t\t\tsharedObj.MonacoPerformanceMarks = _define();\n\t\t}\n\t\treturn sharedObj.MonacoPerformanceMarks;\n\t}\n\n\t// This module can be loaded in an amd and commonjs-context.\n\t// Because we want both instances to use the same perf-data\n\t// we store them globally\n\n\t// eslint-disable-next-line no-var\n\tvar sharedObj;\n\tif (typeof global === 'object') {\n\t\t// nodejs\n\t\tsharedObj = global;\n\t} else if (typeof self === 'object') {\n\t\t// browser\n\t\tsharedObj = self;\n\t} else {\n\t\tsharedObj = {};\n\t}\n\n\tif (typeof define === 'function') {\n\t\t// amd\n\t\tdefine(\"vs/base/common/performance\", [], function () { return _factory(sharedObj); });\n\t} else if (typeof module === 'object' && typeof module.exports === 'object') {\n\t\t// commonjs\n\t\tmodule.exports = _factory(sharedObj);\n\t} else {\n\t\tconsole.trace('perf-util defined in UNKNOWN context (neither requirejs or commonjs)');\n\t\tsharedObj.perf = _factory(sharedObj);\n\t}\n\n})();\n","/**\n * Semver UMD module\n * Copyright (c) Isaac Z. Schlueter and Contributors\n * https://github.com/npm/node-semver\n */\n\n/**\n * DO NOT EDIT THIS FILE\n */\n\n!function(e,r){if(\"object\"==typeof exports&&\"object\"==typeof module)module.exports=r();else if(\"function\"==typeof define&&define.amd)define(\"vs/base/common/semver/semver\", [],r);else{var t=r();for(var n in t)(\"object\"==typeof exports?exports:e)[n]=t[n]}}(\"undefined\"!=typeof self?self:this,(function(){return function(e){var r={};function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&r&&\"string\"!=typeof e)for(var o in e)t.d(n,o,function(r){return e[r]}.bind(null,o));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,\"a\",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p=\"\",t(t.s=0)}([function(e,r,t){(function(t){var n;r=e.exports=H,n=\"object\"==typeof t&&t.env&&t.env.NODE_DEBUG&&/\\bsemver\\b/i.test(t.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift(\"SEMVER\"),console.log.apply(console,e)}:function(){},r.SEMVER_SPEC_VERSION=\"2.0.0\";var o=256,i=Number.MAX_SAFE_INTEGER||9007199254740991,s=r.re=[],a=r.src=[],u=0,c=u++;a[c]=\"0|[1-9]\\\\d*\";var p=u++;a[p]=\"[0-9]+\";var f=u++;a[f]=\"\\\\d*[a-zA-Z-][a-zA-Z0-9-]*\";var l=u++;a[l]=\"(\"+a[c]+\")\\\\.(\"+a[c]+\")\\\\.(\"+a[c]+\")\";var h=u++;a[h]=\"(\"+a[p]+\")\\\\.(\"+a[p]+\")\\\\.(\"+a[p]+\")\";var v=u++;a[v]=\"(?:\"+a[c]+\"|\"+a[f]+\")\";var m=u++;a[m]=\"(?:\"+a[p]+\"|\"+a[f]+\")\";var w=u++;a[w]=\"(?:-(\"+a[v]+\"(?:\\\\.\"+a[v]+\")*))\";var g=u++;a[g]=\"(?:-?(\"+a[m]+\"(?:\\\\.\"+a[m]+\")*))\";var y=u++;a[y]=\"[0-9A-Za-z-]+\";var d=u++;a[d]=\"(?:\\\\+(\"+a[y]+\"(?:\\\\.\"+a[y]+\")*))\";var b=u++,j=\"v?\"+a[l]+a[w]+\"?\"+a[d]+\"?\";a[b]=\"^\"+j+\"$\";var E=\"[v=\\\\s]*\"+a[h]+a[g]+\"?\"+a[d]+\"?\",T=u++;a[T]=\"^\"+E+\"$\";var x=u++;a[x]=\"((?:<|>)?=?)\";var $=u++;a[$]=a[p]+\"|x|X|\\\\*\";var k=u++;a[k]=a[c]+\"|x|X|\\\\*\";var S=u++;a[S]=\"[v=\\\\s]*(\"+a[k]+\")(?:\\\\.(\"+a[k]+\")(?:\\\\.(\"+a[k]+\")(?:\"+a[w]+\")?\"+a[d]+\"?)?)?\";var R=u++;a[R]=\"[v=\\\\s]*(\"+a[$]+\")(?:\\\\.(\"+a[$]+\")(?:\\\\.(\"+a[$]+\")(?:\"+a[g]+\")?\"+a[d]+\"?)?)?\";var I=u++;a[I]=\"^\"+a[x]+\"\\\\s*\"+a[S]+\"$\";var _=u++;a[_]=\"^\"+a[x]+\"\\\\s*\"+a[R]+\"$\";var O=u++;a[O]=\"(?:^|[^\\\\d])(\\\\d{1,16})(?:\\\\.(\\\\d{1,16}))?(?:\\\\.(\\\\d{1,16}))?(?:$|[^\\\\d])\";var A=u++;a[A]=\"(?:~>?)\";var M=u++;a[M]=\"(\\\\s*)\"+a[A]+\"\\\\s+\",s[M]=new RegExp(a[M],\"g\");var V=u++;a[V]=\"^\"+a[A]+a[S]+\"$\";var P=u++;a[P]=\"^\"+a[A]+a[R]+\"$\";var C=u++;a[C]=\"(?:\\\\^)\";var L=u++;a[L]=\"(\\\\s*)\"+a[C]+\"\\\\s+\",s[L]=new RegExp(a[L],\"g\");var N=u++;a[N]=\"^\"+a[C]+a[S]+\"$\";var q=u++;a[q]=\"^\"+a[C]+a[R]+\"$\";var D=u++;a[D]=\"^\"+a[x]+\"\\\\s*(\"+E+\")$|^$\";var X=u++;a[X]=\"^\"+a[x]+\"\\\\s*(\"+j+\")$|^$\";var z=u++;a[z]=\"(\\\\s*)\"+a[x]+\"\\\\s*(\"+E+\"|\"+a[S]+\")\",s[z]=new RegExp(a[z],\"g\");var G=u++;a[G]=\"^\\\\s*(\"+a[S]+\")\\\\s+-\\\\s+(\"+a[S]+\")\\\\s*$\";var Z=u++;a[Z]=\"^\\\\s*(\"+a[R]+\")\\\\s+-\\\\s+(\"+a[R]+\")\\\\s*$\";var B=u++;a[B]=\"(<|>)?=?\\\\s*\\\\*\";for(var U=0;U<35;U++)n(U,a[U]),s[U]||(s[U]=new RegExp(a[U]));function F(e,r){if(e instanceof H)return e;if(\"string\"!=typeof e)return null;if(e.length>o)return null;if(!(r?s[T]:s[b]).test(e))return null;try{return new H(e,r)}catch(e){return null}}function H(e,r){if(e instanceof H){if(e.loose===r)return e;e=e.version}else if(\"string\"!=typeof e)throw new TypeError(\"Invalid Version: \"+e);if(e.length>o)throw new TypeError(\"version is longer than \"+o+\" characters\");if(!(this instanceof H))return new H(e,r);n(\"SemVer\",e,r),this.loose=r;var t=e.trim().match(r?s[T]:s[b]);if(!t)throw new TypeError(\"Invalid Version: \"+e);if(this.raw=e,this.major=+t[1],this.minor=+t[2],this.patch=+t[3],this.major>i||this.major<0)throw new TypeError(\"Invalid major version\");if(this.minor>i||this.minor<0)throw new TypeError(\"Invalid minor version\");if(this.patch>i||this.patch<0)throw new TypeError(\"Invalid patch version\");t[4]?this.prerelease=t[4].split(\".\").map((function(e){if(/^[0-9]+$/.test(e)){var r=+e;if(r>=0&&r<i)return r}return e})):this.prerelease=[],this.build=t[5]?t[5].split(\".\"):[],this.format()}r.parse=F,r.valid=function(e,r){var t=F(e,r);return t?t.version:null},r.clean=function(e,r){var t=F(e.trim().replace(/^[=v]+/,\"\"),r);return t?t.version:null},r.SemVer=H,H.prototype.format=function(){return this.version=this.major+\".\"+this.minor+\".\"+this.patch,this.prerelease.length&&(this.version+=\"-\"+this.prerelease.join(\".\")),this.version},H.prototype.toString=function(){return this.version},H.prototype.compare=function(e){return n(\"SemVer.compare\",this.version,this.loose,e),e instanceof H||(e=new H(e,this.loose)),this.compareMain(e)||this.comparePre(e)},H.prototype.compareMain=function(e){return e instanceof H||(e=new H(e,this.loose)),K(this.major,e.major)||K(this.minor,e.minor)||K(this.patch,e.patch)},H.prototype.comparePre=function(e){if(e instanceof H||(e=new H(e,this.loose)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var r=0;do{var t=this.prerelease[r],o=e.prerelease[r];if(n(\"prerelease compare\",r,t,o),void 0===t&&void 0===o)return 0;if(void 0===o)return 1;if(void 0===t)return-1;if(t!==o)return K(t,o)}while(++r)},H.prototype.inc=function(e,r){switch(e){case\"premajor\":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc(\"pre\",r);break;case\"preminor\":this.prerelease.length=0,this.patch=0,this.minor++,this.inc(\"pre\",r);break;case\"prepatch\":this.prerelease.length=0,this.inc(\"patch\",r),this.inc(\"pre\",r);break;case\"prerelease\":0===this.prerelease.length&&this.inc(\"patch\",r),this.inc(\"pre\",r);break;case\"major\":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case\"minor\":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case\"patch\":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case\"pre\":if(0===this.prerelease.length)this.prerelease=[0];else{for(var t=this.prerelease.length;--t>=0;)\"number\"==typeof this.prerelease[t]&&(this.prerelease[t]++,t=-2);-1===t&&this.prerelease.push(0)}r&&(this.prerelease[0]===r?isNaN(this.prerelease[1])&&(this.prerelease=[r,0]):this.prerelease=[r,0]);break;default:throw new Error(\"invalid increment argument: \"+e)}return this.format(),this.raw=this.version,this},r.inc=function(e,r,t,n){\"string\"==typeof t&&(n=t,t=void 0);try{return new H(e,t).inc(r,n).version}catch(e){return null}},r.diff=function(e,r){if(ee(e,r))return null;var t=F(e),n=F(r);if(t.prerelease.length||n.prerelease.length){for(var o in t)if((\"major\"===o||\"minor\"===o||\"patch\"===o)&&t[o]!==n[o])return\"pre\"+o;return\"prerelease\"}for(var o in t)if((\"major\"===o||\"minor\"===o||\"patch\"===o)&&t[o]!==n[o])return o},r.compareIdentifiers=K;var J=/^[0-9]+$/;function K(e,r){var t=J.test(e),n=J.test(r);return t&&n&&(e=+e,r=+r),t&&!n?-1:n&&!t?1:e<r?-1:e>r?1:0}function Q(e,r,t){return new H(e,t).compare(new H(r,t))}function W(e,r,t){return Q(e,r,t)>0}function Y(e,r,t){return Q(e,r,t)<0}function ee(e,r,t){return 0===Q(e,r,t)}function re(e,r,t){return 0!==Q(e,r,t)}function te(e,r,t){return Q(e,r,t)>=0}function ne(e,r,t){return Q(e,r,t)<=0}function oe(e,r,t,n){var o;switch(r){case\"===\":\"object\"==typeof e&&(e=e.version),\"object\"==typeof t&&(t=t.version),o=e===t;break;case\"!==\":\"object\"==typeof e&&(e=e.version),\"object\"==typeof t&&(t=t.version),o=e!==t;break;case\"\":case\"=\":case\"==\":o=ee(e,t,n);break;case\"!=\":o=re(e,t,n);break;case\">\":o=W(e,t,n);break;case\">=\":o=te(e,t,n);break;case\"<\":o=Y(e,t,n);break;case\"<=\":o=ne(e,t,n);break;default:throw new TypeError(\"Invalid operator: \"+r)}return o}function ie(e,r){if(e instanceof ie){if(e.loose===r)return e;e=e.value}if(!(this instanceof ie))return new ie(e,r);n(\"comparator\",e,r),this.loose=r,this.parse(e),this.semver===se?this.value=\"\":this.value=this.operator+this.semver.version,n(\"comp\",this)}r.rcompareIdentifiers=function(e,r){return K(r,e)},r.major=function(e,r){return new H(e,r).major},r.minor=function(e,r){return new H(e,r).minor},r.patch=function(e,r){return new H(e,r).patch},r.compare=Q,r.compareLoose=function(e,r){return Q(e,r,!0)},r.rcompare=function(e,r,t){return Q(r,e,t)},r.sort=function(e,t){return e.sort((function(e,n){return r.compare(e,n,t)}))},r.rsort=function(e,t){return e.sort((function(e,n){return r.rcompare(e,n,t)}))},r.gt=W,r.lt=Y,r.eq=ee,r.neq=re,r.gte=te,r.lte=ne,r.cmp=oe,r.Comparator=ie;var se={};function ae(e,r){if(e instanceof ae)return e.loose===r?e:new ae(e.raw,r);if(e instanceof ie)return new ae(e.value,r);if(!(this instanceof ae))return new ae(e,r);if(this.loose=r,this.raw=e,this.set=e.split(/\\s*\\|\\|\\s*/).map((function(e){return this.parseRange(e.trim())}),this).filter((function(e){return e.length})),!this.set.length)throw new TypeError(\"Invalid SemVer Range: \"+e);this.format()}function ue(e){return!e||\"x\"===e.toLowerCase()||\"*\"===e}function ce(e,r,t,n,o,i,s,a,u,c,p,f,l){return((r=ue(t)?\"\":ue(n)?\">=\"+t+\".0.0\":ue(o)?\">=\"+t+\".\"+n+\".0\":\">=\"+r)+\" \"+(a=ue(u)?\"\":ue(c)?\"<\"+(+u+1)+\".0.0\":ue(p)?\"<\"+u+\".\"+(+c+1)+\".0\":f?\"<=\"+u+\".\"+c+\".\"+p+\"-\"+f:\"<=\"+a)).trim()}function pe(e,r){for(var t=0;t<e.length;t++)if(!e[t].test(r))return!1;if(r.prerelease.length){for(t=0;t<e.length;t++)if(n(e[t].semver),e[t].semver!==se&&e[t].semver.prerelease.length>0){var o=e[t].semver;if(o.major===r.major&&o.minor===r.minor&&o.patch===r.patch)return!0}return!1}return!0}function fe(e,r,t){try{r=new ae(r,t)}catch(e){return!1}return r.test(e)}function le(e,r,t,n){var o,i,s,a,u;switch(e=new H(e,n),r=new ae(r,n),t){case\">\":o=W,i=ne,s=Y,a=\">\",u=\">=\";break;case\"<\":o=Y,i=te,s=W,a=\"<\",u=\"<=\";break;default:throw new TypeError('Must provide a hilo val of \"<\" or \">\"')}if(fe(e,r,n))return!1;for(var c=0;c<r.set.length;++c){var p=r.set[c],f=null,l=null;if(p.forEach((function(e){e.semver===se&&(e=new ie(\">=0.0.0\")),f=f||e,l=l||e,o(e.semver,f.semver,n)?f=e:s(e.semver,l.semver,n)&&(l=e)})),f.operator===a||f.operator===u)return!1;if((!l.operator||l.operator===a)&&i(e,l.semver))return!1;if(l.operator===u&&s(e,l.semver))return!1}return!0}ie.prototype.parse=function(e){var r=this.loose?s[D]:s[X],t=e.match(r);if(!t)throw new TypeError(\"Invalid comparator: \"+e);this.operator=t[1],\"=\"===this.operator&&(this.operator=\"\"),t[2]?this.semver=new H(t[2],this.loose):this.semver=se},ie.prototype.toString=function(){return this.value},ie.prototype.test=function(e){return n(\"Comparator.test\",e,this.loose),this.semver===se||(\"string\"==typeof e&&(e=new H(e,this.loose)),oe(e,this.operator,this.semver,this.loose))},ie.prototype.intersects=function(e,r){if(!(e instanceof ie))throw new TypeError(\"a Comparator is required\");var t;if(\"\"===this.operator)return t=new ae(e.value,r),fe(this.value,t,r);if(\"\"===e.operator)return t=new ae(this.value,r),fe(e.semver,t,r);var n=!(\">=\"!==this.operator&&\">\"!==this.operator||\">=\"!==e.operator&&\">\"!==e.operator),o=!(\"<=\"!==this.operator&&\"<\"!==this.operator||\"<=\"!==e.operator&&\"<\"!==e.operator),i=this.semver.version===e.semver.version,s=!(\">=\"!==this.operator&&\"<=\"!==this.operator||\">=\"!==e.operator&&\"<=\"!==e.operator),a=oe(this.semver,\"<\",e.semver,r)&&(\">=\"===this.operator||\">\"===this.operator)&&(\"<=\"===e.operator||\"<\"===e.operator),u=oe(this.semver,\">\",e.semver,r)&&(\"<=\"===this.operator||\"<\"===this.operator)&&(\">=\"===e.operator||\">\"===e.operator);return n||o||i&&s||a||u},r.Range=ae,ae.prototype.format=function(){return this.range=this.set.map((function(e){return e.join(\" \").trim()})).join(\"||\").trim(),this.range},ae.prototype.toString=function(){return this.range},ae.prototype.parseRange=function(e){var r=this.loose;e=e.trim(),n(\"range\",e,r);var t=r?s[Z]:s[G];e=e.replace(t,ce),n(\"hyphen replace\",e),e=e.replace(s[z],\"$1$2$3\"),n(\"comparator trim\",e,s[z]),e=(e=(e=e.replace(s[M],\"$1~\")).replace(s[L],\"$1^\")).split(/\\s+/).join(\" \");var o=r?s[D]:s[X],i=e.split(\" \").map((function(e){return function(e,r){return n(\"comp\",e),e=function(e,r){return e.trim().split(/\\s+/).map((function(e){return function(e,r){n(\"caret\",e,r);var t=r?s[q]:s[N];return e.replace(t,(function(r,t,o,i,s){var a;return n(\"caret\",e,r,t,o,i,s),ue(t)?a=\"\":ue(o)?a=\">=\"+t+\".0.0 <\"+(+t+1)+\".0.0\":ue(i)?a=\"0\"===t?\">=\"+t+\".\"+o+\".0 <\"+t+\".\"+(+o+1)+\".0\":\">=\"+t+\".\"+o+\".0 <\"+(+t+1)+\".0.0\":s?(n(\"replaceCaret pr\",s),\"-\"!==s.charAt(0)&&(s=\"-\"+s),a=\"0\"===t?\"0\"===o?\">=\"+t+\".\"+o+\".\"+i+s+\" <\"+t+\".\"+o+\".\"+(+i+1):\">=\"+t+\".\"+o+\".\"+i+s+\" <\"+t+\".\"+(+o+1)+\".0\":\">=\"+t+\".\"+o+\".\"+i+s+\" <\"+(+t+1)+\".0.0\"):(n(\"no pr\"),a=\"0\"===t?\"0\"===o?\">=\"+t+\".\"+o+\".\"+i+\" <\"+t+\".\"+o+\".\"+(+i+1):\">=\"+t+\".\"+o+\".\"+i+\" <\"+t+\".\"+(+o+1)+\".0\":\">=\"+t+\".\"+o+\".\"+i+\" <\"+(+t+1)+\".0.0\"),n(\"caret return\",a),a}))}(e,r)})).join(\" \")}(e,r),n(\"caret\",e),e=function(e,r){return e.trim().split(/\\s+/).map((function(e){return function(e,r){var t=r?s[P]:s[V];return e.replace(t,(function(r,t,o,i,s){var a;return n(\"tilde\",e,r,t,o,i,s),ue(t)?a=\"\":ue(o)?a=\">=\"+t+\".0.0 <\"+(+t+1)+\".0.0\":ue(i)?a=\">=\"+t+\".\"+o+\".0 <\"+t+\".\"+(+o+1)+\".0\":s?(n(\"replaceTilde pr\",s),\"-\"!==s.charAt(0)&&(s=\"-\"+s),a=\">=\"+t+\".\"+o+\".\"+i+s+\" <\"+t+\".\"+(+o+1)+\".0\"):a=\">=\"+t+\".\"+o+\".\"+i+\" <\"+t+\".\"+(+o+1)+\".0\",n(\"tilde return\",a),a}))}(e,r)})).join(\" \")}(e,r),n(\"tildes\",e),e=function(e,r){return n(\"replaceXRanges\",e,r),e.split(/\\s+/).map((function(e){return function(e,r){e=e.trim();var t=r?s[_]:s[I];return e.replace(t,(function(r,t,o,i,s,a){n(\"xRange\",e,r,t,o,i,s,a);var u=ue(o),c=u||ue(i),p=c||ue(s);return\"=\"===t&&p&&(t=\"\"),u?r=\">\"===t||\"<\"===t?\"<0.0.0\":\"*\":t&&p?(c&&(i=0),p&&(s=0),\">\"===t?(t=\">=\",c?(o=+o+1,i=0,s=0):p&&(i=+i+1,s=0)):\"<=\"===t&&(t=\"<\",c?o=+o+1:i=+i+1),r=t+o+\".\"+i+\".\"+s):c?r=\">=\"+o+\".0.0 <\"+(+o+1)+\".0.0\":p&&(r=\">=\"+o+\".\"+i+\".0 <\"+o+\".\"+(+i+1)+\".0\"),n(\"xRange return\",r),r}))}(e,r)})).join(\" \")}(e,r),n(\"xrange\",e),e=function(e,r){return n(\"replaceStars\",e,r),e.trim().replace(s[B],\"\")}(e,r),n(\"stars\",e),e}(e,r)})).join(\" \").split(/\\s+/);return this.loose&&(i=i.filter((function(e){return!!e.match(o)}))),i=i.map((function(e){return new ie(e,r)}))},ae.prototype.intersects=function(e,r){if(!(e instanceof ae))throw new TypeError(\"a Range is required\");return this.set.some((function(t){return t.every((function(t){return e.set.some((function(e){return e.every((function(e){return t.intersects(e,r)}))}))}))}))},r.toComparators=function(e,r){return new ae(e,r).set.map((function(e){return e.map((function(e){return e.value})).join(\" \").trim().split(\" \")}))},ae.prototype.test=function(e){if(!e)return!1;\"string\"==typeof e&&(e=new H(e,this.loose));for(var r=0;r<this.set.length;r++)if(pe(this.set[r],e))return!0;return!1},r.satisfies=fe,r.maxSatisfying=function(e,r,t){var n=null,o=null;try{var i=new ae(r,t)}catch(e){return null}return e.forEach((function(e){i.test(e)&&(n&&-1!==o.compare(e)||(o=new H(n=e,t)))})),n},r.minSatisfying=function(e,r,t){var n=null,o=null;try{var i=new ae(r,t)}catch(e){return null}return e.forEach((function(e){i.test(e)&&(n&&1!==o.compare(e)||(o=new H(n=e,t)))})),n},r.validRange=function(e,r){try{return new ae(e,r).range||\"*\"}catch(e){return null}},r.ltr=function(e,r,t){return le(e,r,\"<\",t)},r.gtr=function(e,r,t){return le(e,r,\">\",t)},r.outside=le,r.prerelease=function(e,r){var t=F(e,r);return t&&t.prerelease.length?t.prerelease:null},r.intersects=function(e,r,t){return e=new ae(e,t),r=new ae(r,t),e.intersects(r)},r.coerce=function(e){if(e instanceof H)return e;if(\"string\"!=typeof e)return null;var r=e.match(s[O]);return null==r?null:F((r[1]||\"0\")+\".\"+(r[2]||\"0\")+\".\"+(r[3]||\"0\"))}}).call(this,t(1))},function(e,r){var t,n,o=e.exports={};function i(){throw new Error(\"setTimeout has not been defined\")}function s(){throw new Error(\"clearTimeout has not been defined\")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t=\"function\"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{n=\"function\"==typeof clearTimeout?clearTimeout:s}catch(e){n=s}}();var u,c=[],p=!1,f=-1;function l(){p&&u&&(p=!1,u.length?c=u.concat(c):f=-1,c.length&&h())}function h(){if(!p){var e=a(l);p=!0;for(var r=c.length;r;){for(u=c,c=[];++f<r;)u&&u[f].run();f=-1,r=c.length}u=null,p=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(r){try{return n.call(null,e)}catch(r){return n.call(this,e)}}}(e)}}function v(e,r){this.fun=e,this.array=r}function m(){}o.nextTick=function(e){var r=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)r[t-1]=arguments[t];c.push(new v(e,r)),1!==c.length||p||a(h)},v.prototype.run=function(){this.fun.apply(null,this.array)},o.title=\"browser\",o.browser=!0,o.env={},o.argv=[],o.version=\"\",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw new Error(\"process.binding is not supported\")},o.cwd=function(){return\"/\"},o.chdir=function(e){throw new Error(\"process.chdir is not supported\")},o.umask=function(){return 0}}])}));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { onUnexpectedError } from 'vs/base/common/errors';\nimport { DisposableStore, IDisposable, toDisposable } from 'vs/base/common/lifecycle';\n\n/**\n * The payload that flows in readable stream events.\n */\nexport type ReadableStreamEventPayload<T> = T | Error | 'end';\n\nexport interface ReadableStreamEvents<T> {\n\n\t/**\n\t * The 'data' event is emitted whenever the stream is\n\t * relinquishing ownership of a chunk of data to a consumer.\n\t *\n\t * NOTE: PLEASE UNDERSTAND THAT ADDING A DATA LISTENER CAN\n\t * TURN THE STREAM INTO FLOWING MODE. IT IS THEREFOR THE\n\t * LAST LISTENER THAT SHOULD BE ADDED AND NOT THE FIRST\n\t *\n\t * Use `listenStream` as a helper method to listen to\n\t * stream events in the right order.\n\t */\n\ton(event: 'data', callback: (data: T) => void): void;\n\n\t/**\n\t * Emitted when any error occurs.\n\t */\n\ton(event: 'error', callback: (err: Error) => void): void;\n\n\t/**\n\t * The 'end' event is emitted when there is no more data\n\t * to be consumed from the stream. The 'end' event will\n\t * not be emitted unless the data is completely consumed.\n\t */\n\ton(event: 'end', callback: () => void): void;\n}\n\n/**\n * A interface that emulates the API shape of a node.js readable\n * stream for use in native and web environments.\n */\nexport interface ReadableStream<T> extends ReadableStreamEvents<T> {\n\n\t/**\n\t * Stops emitting any events until resume() is called.\n\t */\n\tpause(): void;\n\n\t/**\n\t * Starts emitting events again after pause() was called.\n\t */\n\tresume(): void;\n\n\t/**\n\t * Destroys the stream and stops emitting any event.\n\t */\n\tdestroy(): void;\n\n\t/**\n\t * Allows to remove a listener that was previously added.\n\t */\n\tremoveListener(event: string, callback: Function): void;\n}\n\n/**\n * A interface that emulates the API shape of a node.js readable\n * for use in native and web environments.\n */\nexport interface Readable<T> {\n\n\t/**\n\t * Read data from the underlying source. Will return\n\t * null to indicate that no more data can be read.\n\t */\n\tread(): T | null;\n}\n\nexport function isReadable<T>(obj: unknown): obj is Readable<T> {\n\tconst candidate = obj as Readable<T> | undefined;\n\tif (!candidate) {\n\t\treturn false;\n\t}\n\n\treturn typeof candidate.read === 'function';\n}\n\n/**\n * A interface that emulates the API shape of a node.js writeable\n * stream for use in native and web environments.\n */\nexport interface WriteableStream<T> extends ReadableStream<T> {\n\n\t/**\n\t * Writing data to the stream will trigger the on('data')\n\t * event listener if the stream is flowing and buffer the\n\t * data otherwise until the stream is flowing.\n\t *\n\t * If a `highWaterMark` is configured and writing to the\n\t * stream reaches this mark, a promise will be returned\n\t * that should be awaited on before writing more data.\n\t * Otherwise there is a risk of buffering a large number\n\t * of data chunks without consumer.\n\t */\n\twrite(data: T): void | Promise<void>;\n\n\t/**\n\t * Signals an error to the consumer of the stream via the\n\t * on('error') handler if the stream is flowing.\n\t *\n\t * NOTE: call `end` to signal that the stream has ended,\n\t * this DOES NOT happen automatically from `error`.\n\t */\n\terror(error: Error): void;\n\n\t/**\n\t * Signals the end of the stream to the consumer. If the\n\t * result is provided, will trigger the on('data') event\n\t * listener if the stream is flowing and buffer the data\n\t * otherwise until the stream is flowing.\n\t */\n\tend(result?: T): void;\n}\n\n/**\n * A stream that has a buffer already read. Returns the original stream\n * that was read as well as the chunks that got read.\n *\n * The `ended` flag indicates if the stream has been fully consumed.\n */\nexport interface ReadableBufferedStream<T> {\n\n\t/**\n\t * The original stream that is being read.\n\t */\n\tstream: ReadableStream<T>;\n\n\t/**\n\t * An array of chunks already read from this stream.\n\t */\n\tbuffer: T[];\n\n\t/**\n\t * Signals if the stream has ended or not. If not, consumers\n\t * should continue to read from the stream until consumed.\n\t */\n\tended: boolean;\n}\n\nexport function isReadableStream<T>(obj: unknown): obj is ReadableStream<T> {\n\tconst candidate = obj as ReadableStream<T> | undefined;\n\tif (!candidate) {\n\t\treturn false;\n\t}\n\n\treturn [candidate.on, candidate.pause, candidate.resume, candidate.destroy].every(fn => typeof fn === 'function');\n}\n\nexport function isReadableBufferedStream<T>(obj: unknown): obj is ReadableBufferedStream<T> {\n\tconst candidate = obj as ReadableBufferedStream<T> | undefined;\n\tif (!candidate) {\n\t\treturn false;\n\t}\n\n\treturn isReadableStream(candidate.stream) && Array.isArray(candidate.buffer) && typeof candidate.ended === 'boolean';\n}\n\nexport interface IReducer<T, R = T> {\n\t(data: T[]): R;\n}\n\nexport interface IDataTransformer<Original, Transformed> {\n\t(data: Original): Transformed;\n}\n\nexport interface IErrorTransformer {\n\t(error: Error): Error;\n}\n\nexport interface ITransformer<Original, Transformed> {\n\tdata: IDataTransformer<Original, Transformed>;\n\terror?: IErrorTransformer;\n}\n\nexport function newWriteableStream<T>(reducer: IReducer<T>, options?: WriteableStreamOptions): WriteableStream<T> {\n\treturn new WriteableStreamImpl<T>(reducer, options);\n}\n\nexport interface WriteableStreamOptions {\n\n\t/**\n\t * The number of objects to buffer before WriteableStream#write()\n\t * signals back that the buffer is full. Can be used to reduce\n\t * the memory pressure when the stream is not flowing.\n\t */\n\thighWaterMark?: number;\n}\n\nclass WriteableStreamImpl<T> implements WriteableStream<T> {\n\n\tprivate readonly state = {\n\t\tflowing: false,\n\t\tended: false,\n\t\tdestroyed: false\n\t};\n\n\tprivate readonly buffer = {\n\t\tdata: [] as T[],\n\t\terror: [] as Error[]\n\t};\n\n\tprivate readonly listeners = {\n\t\tdata: [] as { (data: T): void }[],\n\t\terror: [] as { (error: Error): void }[],\n\t\tend: [] as { (): void }[]\n\t};\n\n\tprivate readonly pendingWritePromises: Function[] = [];\n\n\tconstructor(private reducer: IReducer<T>, private options?: WriteableStreamOptions) { }\n\n\tpause(): void {\n\t\tif (this.state.destroyed) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.state.flowing = false;\n\t}\n\n\tresume(): void {\n\t\tif (this.state.destroyed) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.state.flowing) {\n\t\t\tthis.state.flowing = true;\n\n\t\t\t// emit buffered events\n\t\t\tthis.flowData();\n\t\t\tthis.flowErrors();\n\t\t\tthis.flowEnd();\n\t\t}\n\t}\n\n\twrite(data: T): void | Promise<void> {\n\t\tif (this.state.destroyed) {\n\t\t\treturn;\n\t\t}\n\n\t\t// flowing: directly send the data to listeners\n\t\tif (this.state.flowing) {\n\t\t\tthis.emitData(data);\n\t\t}\n\n\t\t// not yet flowing: buffer data until flowing\n\t\telse {\n\t\t\tthis.buffer.data.push(data);\n\n\t\t\t// highWaterMark: if configured, signal back when buffer reached limits\n\t\t\tif (typeof this.options?.highWaterMark === 'number' && this.buffer.data.length > this.options.highWaterMark) {\n\t\t\t\treturn new Promise(resolve => this.pendingWritePromises.push(resolve));\n\t\t\t}\n\t\t}\n\t}\n\n\terror(error: Error): void {\n\t\tif (this.state.destroyed) {\n\t\t\treturn;\n\t\t}\n\n\t\t// flowing: directly send the error to listeners\n\t\tif (this.state.flowing) {\n\t\t\tthis.emitError(error);\n\t\t}\n\n\t\t// not yet flowing: buffer errors until flowing\n\t\telse {\n\t\t\tthis.buffer.error.push(error);\n\t\t}\n\t}\n\n\tend(result?: T): void {\n\t\tif (this.state.destroyed) {\n\t\t\treturn;\n\t\t}\n\n\t\t// end with data if provided\n\t\tif (typeof result !== 'undefined') {\n\t\t\tthis.write(result);\n\t\t}\n\n\t\t// flowing: send end event to listeners\n\t\tif (this.state.flowing) {\n\t\t\tthis.emitEnd();\n\n\t\t\tthis.destroy();\n\t\t}\n\n\t\t// not yet flowing: remember state\n\t\telse {\n\t\t\tthis.state.ended = true;\n\t\t}\n\t}\n\n\tprivate emitData(data: T): void {\n\t\tthis.listeners.data.slice(0).forEach(listener => listener(data)); // slice to avoid listener mutation from delivering event\n\t}\n\n\tprivate emitError(error: Error): void {\n\t\tif (this.listeners.error.length === 0) {\n\t\t\tonUnexpectedError(error); // nobody listened to this error so we log it as unexpected\n\t\t} else {\n\t\t\tthis.listeners.error.slice(0).forEach(listener => listener(error)); // slice to avoid listener mutation from delivering event\n\t\t}\n\t}\n\n\tprivate emitEnd(): void {\n\t\tthis.listeners.end.slice(0).forEach(listener => listener()); // slice to avoid listener mutation from delivering event\n\t}\n\n\ton(event: 'data', callback: (data: T) => void): void;\n\ton(event: 'error', callback: (err: Error) => void): void;\n\ton(event: 'end', callback: () => void): void;\n\ton(event: 'data' | 'error' | 'end', callback: (arg0?: any) => void): void {\n\t\tif (this.state.destroyed) {\n\t\t\treturn;\n\t\t}\n\n\t\tswitch (event) {\n\t\t\tcase 'data':\n\t\t\t\tthis.listeners.data.push(callback);\n\n\t\t\t\t// switch into flowing mode as soon as the first 'data'\n\t\t\t\t// listener is added and we are not yet in flowing mode\n\t\t\t\tthis.resume();\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'end':\n\t\t\t\tthis.listeners.end.push(callback);\n\n\t\t\t\t// emit 'end' event directly if we are flowing\n\t\t\t\t// and the end has already been reached\n\t\t\t\t//\n\t\t\t\t// finish() when it went through\n\t\t\t\tif (this.state.flowing && this.flowEnd()) {\n\t\t\t\t\tthis.destroy();\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase 'error':\n\t\t\t\tthis.listeners.error.push(callback);\n\n\t\t\t\t// emit buffered 'error' events unless done already\n\t\t\t\t// now that we know that we have at least one listener\n\t\t\t\tif (this.state.flowing) {\n\t\t\t\t\tthis.flowErrors();\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tremoveListener(event: string, callback: Function): void {\n\t\tif (this.state.destroyed) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet listeners: unknown[] | undefined = undefined;\n\n\t\tswitch (event) {\n\t\t\tcase 'data':\n\t\t\t\tlisteners = this.listeners.data;\n\t\t\t\tbreak;\n\n\t\t\tcase 'end':\n\t\t\t\tlisteners = this.listeners.end;\n\t\t\t\tbreak;\n\n\t\t\tcase 'error':\n\t\t\t\tlisteners = this.listeners.error;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (listeners) {\n\t\t\tconst index = listeners.indexOf(callback);\n\t\t\tif (index >= 0) {\n\t\t\t\tlisteners.splice(index, 1);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate flowData(): void {\n\t\tif (this.buffer.data.length > 0) {\n\t\t\tconst fullDataBuffer = this.reducer(this.buffer.data);\n\n\t\t\tthis.emitData(fullDataBuffer);\n\n\t\t\tthis.buffer.data.length = 0;\n\n\t\t\t// When the buffer is empty, resolve all pending writers\n\t\t\tconst pendingWritePromises = [...this.pendingWritePromises];\n\t\t\tthis.pendingWritePromises.length = 0;\n\t\t\tpendingWritePromises.forEach(pendingWritePromise => pendingWritePromise());\n\t\t}\n\t}\n\n\tprivate flowErrors(): void {\n\t\tif (this.listeners.error.length > 0) {\n\t\t\tfor (const error of this.buffer.error) {\n\t\t\t\tthis.emitError(error);\n\t\t\t}\n\n\t\t\tthis.buffer.error.length = 0;\n\t\t}\n\t}\n\n\tprivate flowEnd(): boolean {\n\t\tif (this.state.ended) {\n\t\t\tthis.emitEnd();\n\n\t\t\treturn this.listeners.end.length > 0;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tdestroy(): void {\n\t\tif (!this.state.destroyed) {\n\t\t\tthis.state.destroyed = true;\n\t\t\tthis.state.ended = true;\n\n\t\t\tthis.buffer.data.length = 0;\n\t\t\tthis.buffer.error.length = 0;\n\n\t\t\tthis.listeners.data.length = 0;\n\t\t\tthis.listeners.error.length = 0;\n\t\t\tthis.listeners.end.length = 0;\n\n\t\t\tthis.pendingWritePromises.length = 0;\n\t\t}\n\t}\n}\n\n/**\n * Helper to fully read a T readable into a T.\n */\nexport function consumeReadable<T>(readable: Readable<T>, reducer: IReducer<T>): T {\n\tconst chunks: T[] = [];\n\n\tlet chunk: T | null;\n\twhile ((chunk = readable.read()) !== null) {\n\t\tchunks.push(chunk);\n\t}\n\n\treturn reducer(chunks);\n}\n\n/**\n * Helper to read a T readable up to a maximum of chunks. If the limit is\n * reached, will return a readable instead to ensure all data can still\n * be read.\n */\nexport function peekReadable<T>(readable: Readable<T>, reducer: IReducer<T>, maxChunks: number): T | Readable<T> {\n\tconst chunks: T[] = [];\n\n\tlet chunk: T | null | undefined = undefined;\n\twhile ((chunk = readable.read()) !== null && chunks.length < maxChunks) {\n\t\tchunks.push(chunk);\n\t}\n\n\t// If the last chunk is null, it means we reached the end of\n\t// the readable and return all the data at once\n\tif (chunk === null && chunks.length > 0) {\n\t\treturn reducer(chunks);\n\t}\n\n\t// Otherwise, we still have a chunk, it means we reached the maxChunks\n\t// value and as such we return a new Readable that first returns\n\t// the existing read chunks and then continues with reading from\n\t// the underlying readable.\n\treturn {\n\t\tread: () => {\n\n\t\t\t// First consume chunks from our array\n\t\t\tif (chunks.length > 0) {\n\t\t\t\treturn chunks.shift()!;\n\t\t\t}\n\n\t\t\t// Then ensure to return our last read chunk\n\t\t\tif (typeof chunk !== 'undefined') {\n\t\t\t\tconst lastReadChunk = chunk;\n\n\t\t\t\t// explicitly use undefined here to indicate that we consumed\n\t\t\t\t// the chunk, which could have either been null or valued.\n\t\t\t\tchunk = undefined;\n\n\t\t\t\treturn lastReadChunk;\n\t\t\t}\n\n\t\t\t// Finally delegate back to the Readable\n\t\t\treturn readable.read();\n\t\t}\n\t};\n}\n\n/**\n * Helper to fully read a T stream into a T or consuming\n * a stream fully, awaiting all the events without caring\n * about the data.\n */\nexport function consumeStream<T, R = T>(stream: ReadableStreamEvents<T>, reducer: IReducer<T, R>): Promise<R>;\nexport function consumeStream(stream: ReadableStreamEvents<unknown>): Promise<undefined>;\nexport function consumeStream<T, R = T>(stream: ReadableStreamEvents<T>, reducer?: IReducer<T, R>): Promise<R | undefined> {\n\treturn new Promise((resolve, reject) => {\n\t\tconst chunks: T[] = [];\n\n\t\tlistenStream(stream, {\n\t\t\tonData: chunk => {\n\t\t\t\tif (reducer) {\n\t\t\t\t\tchunks.push(chunk);\n\t\t\t\t}\n\t\t\t},\n\t\t\tonError: error => {\n\t\t\t\tif (reducer) {\n\t\t\t\t\treject(error);\n\t\t\t\t} else {\n\t\t\t\t\tresolve(undefined);\n\t\t\t\t}\n\t\t\t},\n\t\t\tonEnd: () => {\n\t\t\t\tif (reducer) {\n\t\t\t\t\tresolve(reducer(chunks));\n\t\t\t\t} else {\n\t\t\t\t\tresolve(undefined);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n}\n\nexport interface IStreamListener<T> {\n\n\t/**\n\t * The 'data' event is emitted whenever the stream is\n\t * relinquishing ownership of a chunk of data to a consumer.\n\t */\n\tonData(data: T): void;\n\n\t/**\n\t * Emitted when any error occurs.\n\t */\n\tonError(err: Error): void;\n\n\t/**\n\t * The 'end' event is emitted when there is no more data\n\t * to be consumed from the stream. The 'end' event will\n\t * not be emitted unless the data is completely consumed.\n\t */\n\tonEnd(): void;\n}\n\n/**\n * Helper to listen to all events of a T stream in proper order.\n */\nexport function listenStream<T>(stream: ReadableStreamEvents<T>, listener: IStreamListener<T>): IDisposable {\n\tlet destroyed = false;\n\n\tstream.on('error', error => {\n\t\tif (!destroyed) {\n\t\t\tlistener.onError(error);\n\t\t}\n\t});\n\n\tstream.on('end', () => {\n\t\tif (!destroyed) {\n\t\t\tlistener.onEnd();\n\t\t}\n\t});\n\n\t// Adding the `data` listener will turn the stream\n\t// into flowing mode. As such it is important to\n\t// add this listener last (DO NOT CHANGE!)\n\tstream.on('data', data => {\n\t\tif (!destroyed) {\n\t\t\tlistener.onData(data);\n\t\t}\n\t});\n\n\treturn toDisposable(() => destroyed = true);\n}\n\n/**\n * Helper to peek up to `maxChunks` into a stream. The return type signals if\n * the stream has ended or not. If not, caller needs to add a `data` listener\n * to continue reading.\n */\nexport function peekStream<T>(stream: ReadableStream<T>, maxChunks: number): Promise<ReadableBufferedStream<T>> {\n\treturn new Promise((resolve, reject) => {\n\t\tconst streamListeners = new DisposableStore();\n\t\tconst buffer: T[] = [];\n\n\t\t// Data Listener\n\t\tconst dataListener = (chunk: T) => {\n\n\t\t\t// Add to buffer\n\t\t\tbuffer.push(chunk);\n\n\t\t\t// We reached maxChunks and thus need to return\n\t\t\tif (buffer.length > maxChunks) {\n\n\t\t\t\t// Dispose any listeners and ensure to pause the\n\t\t\t\t// stream so that it can be consumed again by caller\n\t\t\t\tstreamListeners.dispose();\n\t\t\t\tstream.pause();\n\n\t\t\t\treturn resolve({ stream, buffer, ended: false });\n\t\t\t}\n\t\t};\n\n\t\t// Error Listener\n\t\tconst errorListener = (error: Error) => {\n\t\t\treturn reject(error);\n\t\t};\n\n\t\t// End Listener\n\t\tconst endListener = () => {\n\t\t\treturn resolve({ stream, buffer, ended: true });\n\t\t};\n\n\t\tstreamListeners.add(toDisposable(() => stream.removeListener('error', errorListener)));\n\t\tstream.on('error', errorListener);\n\n\t\tstreamListeners.add(toDisposable(() => stream.removeListener('end', endListener)));\n\t\tstream.on('end', endListener);\n\n\t\t// Important: leave the `data` listener last because\n\t\t// this can turn the stream into flowing mode and we\n\t\t// want `error` events to be received as well.\n\t\tstreamListeners.add(toDisposable(() => stream.removeListener('data', dataListener)));\n\t\tstream.on('data', dataListener);\n\t});\n}\n\n/**\n * Helper to create a readable stream from an existing T.\n */\nexport function toStream<T>(t: T, reducer: IReducer<T>): ReadableStream<T> {\n\tconst stream = newWriteableStream<T>(reducer);\n\n\tstream.end(t);\n\n\treturn stream;\n}\n\n/**\n * Helper to create an empty stream\n */\nexport function emptyStream(): ReadableStream<never> {\n\tconst stream = newWriteableStream<never>(() => { throw new Error('not supported'); });\n\tstream.end();\n\n\treturn stream;\n}\n\n/**\n * Helper to convert a T into a Readable<T>.\n */\nexport function toReadable<T>(t: T): Readable<T> {\n\tlet consumed = false;\n\n\treturn {\n\t\tread: () => {\n\t\t\tif (consumed) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconsumed = true;\n\n\t\t\treturn t;\n\t\t}\n\t};\n}\n\n/**\n * Helper to transform a readable stream into another stream.\n */\nexport function transform<Original, Transformed>(stream: ReadableStreamEvents<Original>, transformer: ITransformer<Original, Transformed>, reducer: IReducer<Transformed>): ReadableStream<Transformed> {\n\tconst target = newWriteableStream<Transformed>(reducer);\n\n\tlistenStream(stream, {\n\t\tonData: data => target.write(transformer.data(data)),\n\t\tonError: error => target.error(transformer.error ? transformer.error(error) : error),\n\t\tonEnd: () => target.end()\n\t});\n\n\treturn target;\n}\n\n/**\n * Helper to take an existing readable that will\n * have a prefix injected to the beginning.\n */\nexport function prefixedReadable<T>(prefix: T, readable: Readable<T>, reducer: IReducer<T>): Readable<T> {\n\tlet prefixHandled = false;\n\n\treturn {\n\t\tread: () => {\n\t\t\tconst chunk = readable.read();\n\n\t\t\t// Handle prefix only once\n\t\t\tif (!prefixHandled) {\n\t\t\t\tprefixHandled = true;\n\n\t\t\t\t// If we have also a read-result, make\n\t\t\t\t// sure to reduce it to a single result\n\t\t\t\tif (chunk !== null) {\n\t\t\t\t\treturn reducer([prefix, chunk]);\n\t\t\t\t}\n\n\t\t\t\t// Otherwise, just return prefix directly\n\t\t\t\treturn prefix;\n\t\t\t}\n\n\t\t\treturn chunk;\n\t\t}\n\t};\n}\n\n/**\n * Helper to take an existing stream that will\n * have a prefix injected to the beginning.\n */\nexport function prefixedStream<T>(prefix: T, stream: ReadableStream<T>, reducer: IReducer<T>): ReadableStream<T> {\n\tlet prefixHandled = false;\n\n\tconst target = newWriteableStream<T>(reducer);\n\n\tlistenStream(stream, {\n\t\tonData: data => {\n\n\t\t\t// Handle prefix only once\n\t\t\tif (!prefixHandled) {\n\t\t\t\tprefixHandled = true;\n\n\t\t\t\treturn target.write(reducer([prefix, data]));\n\t\t\t}\n\n\t\t\treturn target.write(data);\n\t\t},\n\t\tonError: error => target.error(error),\n\t\tonEnd: () => {\n\n\t\t\t// Handle prefix only once\n\t\t\tif (!prefixHandled) {\n\t\t\t\tprefixHandled = true;\n\n\t\t\t\ttarget.write(prefix);\n\t\t\t}\n\n\t\t\ttarget.end();\n\t\t}\n\t});\n\n\treturn target;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as streams from 'vs/base/common/stream';\n\ndeclare const Buffer: any;\n\nconst hasBuffer = (typeof Buffer !== 'undefined');\n\nlet textEncoder: TextEncoder | null;\nlet textDecoder: TextDecoder | null;\n\nexport class VSBuffer {\n\n\t/**\n\t * When running in a nodejs context, the backing store for the returned `VSBuffer` instance\n\t * might use a nodejs Buffer allocated from node's Buffer pool, which is not transferrable.\n\t */\n\tstatic alloc(byteLength: number): VSBuffer {\n\t\tif (hasBuffer) {\n\t\t\treturn new VSBuffer(Buffer.allocUnsafe(byteLength));\n\t\t} else {\n\t\t\treturn new VSBuffer(new Uint8Array(byteLength));\n\t\t}\n\t}\n\n\t/**\n\t * When running in a nodejs context, if `actual` is not a nodejs Buffer, the backing store for\n\t * the returned `VSBuffer` instance might use a nodejs Buffer allocated from node's Buffer pool,\n\t * which is not transferrable.\n\t */\n\tstatic wrap(actual: Uint8Array): VSBuffer {\n\t\tif (hasBuffer && !(Buffer.isBuffer(actual))) {\n\t\t\t// https://nodejs.org/dist/latest-v10.x/docs/api/buffer.html#buffer_class_method_buffer_from_arraybuffer_byteoffset_length\n\t\t\t// Create a zero-copy Buffer wrapper around the ArrayBuffer pointed to by the Uint8Array\n\t\t\tactual = Buffer.from(actual.buffer, actual.byteOffset, actual.byteLength);\n\t\t}\n\t\treturn new VSBuffer(actual);\n\t}\n\n\t/**\n\t * When running in a nodejs context, the backing store for the returned `VSBuffer` instance\n\t * might use a nodejs Buffer allocated from node's Buffer pool, which is not transferrable.\n\t */\n\tstatic fromString(source: string, options?: { dontUseNodeBuffer?: boolean }): VSBuffer {\n\t\tconst dontUseNodeBuffer = options?.dontUseNodeBuffer || false;\n\t\tif (!dontUseNodeBuffer && hasBuffer) {\n\t\t\treturn new VSBuffer(Buffer.from(source));\n\t\t} else {\n\t\t\tif (!textEncoder) {\n\t\t\t\ttextEncoder = new TextEncoder();\n\t\t\t}\n\t\t\treturn new VSBuffer(textEncoder.encode(source));\n\t\t}\n\t}\n\n\t/**\n\t * When running in a nodejs context, the backing store for the returned `VSBuffer` instance\n\t * might use a nodejs Buffer allocated from node's Buffer pool, which is not transferrable.\n\t */\n\tstatic fromByteArray(source: number[]): VSBuffer {\n\t\tconst result = VSBuffer.alloc(source.length);\n\t\tfor (let i = 0, len = source.length; i < len; i++) {\n\t\t\tresult.buffer[i] = source[i];\n\t\t}\n\t\treturn result;\n\t}\n\n\t/**\n\t * When running in a nodejs context, the backing store for the returned `VSBuffer` instance\n\t * might use a nodejs Buffer allocated from node's Buffer pool, which is not transferrable.\n\t */\n\tstatic concat(buffers: VSBuffer[], totalLength?: number): VSBuffer {\n\t\tif (typeof totalLength === 'undefined') {\n\t\t\ttotalLength = 0;\n\t\t\tfor (let i = 0, len = buffers.length; i < len; i++) {\n\t\t\t\ttotalLength += buffers[i].byteLength;\n\t\t\t}\n\t\t}\n\n\t\tconst ret = VSBuffer.alloc(totalLength);\n\t\tlet offset = 0;\n\t\tfor (let i = 0, len = buffers.length; i < len; i++) {\n\t\t\tconst element = buffers[i];\n\t\t\tret.set(element, offset);\n\t\t\toffset += element.byteLength;\n\t\t}\n\n\t\treturn ret;\n\t}\n\n\treadonly buffer: Uint8Array;\n\treadonly byteLength: number;\n\n\tprivate constructor(buffer: Uint8Array) {\n\t\tthis.buffer = buffer;\n\t\tthis.byteLength = this.buffer.byteLength;\n\t}\n\n\t/**\n\t * When running in a nodejs context, the backing store for the returned `VSBuffer` instance\n\t * might use a nodejs Buffer allocated from node's Buffer pool, which is not transferrable.\n\t */\n\tclone(): VSBuffer {\n\t\tconst result = VSBuffer.alloc(this.byteLength);\n\t\tresult.set(this);\n\t\treturn result;\n\t}\n\n\ttoString(): string {\n\t\tif (hasBuffer) {\n\t\t\treturn this.buffer.toString();\n\t\t} else {\n\t\t\tif (!textDecoder) {\n\t\t\t\ttextDecoder = new TextDecoder();\n\t\t\t}\n\t\t\treturn textDecoder.decode(this.buffer);\n\t\t}\n\t}\n\n\tslice(start?: number, end?: number): VSBuffer {\n\t\t// IMPORTANT: use subarray instead of slice because TypedArray#slice\n\t\t// creates shallow copy and NodeBuffer#slice doesn't. The use of subarray\n\t\t// ensures the same, performance, behaviour.\n\t\treturn new VSBuffer(this.buffer.subarray(start, end));\n\t}\n\n\tset(array: VSBuffer, offset?: number): void;\n\tset(array: Uint8Array, offset?: number): void;\n\tset(array: ArrayBuffer, offset?: number): void;\n\tset(array: ArrayBufferView, offset?: number): void;\n\tset(array: VSBuffer | Uint8Array | ArrayBuffer | ArrayBufferView, offset?: number): void;\n\tset(array: VSBuffer | Uint8Array | ArrayBuffer | ArrayBufferView, offset?: number): void {\n\t\tif (array instanceof VSBuffer) {\n\t\t\tthis.buffer.set(array.buffer, offset);\n\t\t} else if (array instanceof Uint8Array) {\n\t\t\tthis.buffer.set(array, offset);\n\t\t} else if (array instanceof ArrayBuffer) {\n\t\t\tthis.buffer.set(new Uint8Array(array), offset);\n\t\t} else if (ArrayBuffer.isView(array)) {\n\t\t\tthis.buffer.set(new Uint8Array(array.buffer, array.byteOffset, array.byteLength), offset);\n\t\t} else {\n\t\t\tthrow new Error(`Unknown argument 'array'`);\n\t\t}\n\t}\n\n\treadUInt32BE(offset: number): number {\n\t\treturn readUInt32BE(this.buffer, offset);\n\t}\n\n\twriteUInt32BE(value: number, offset: number): void {\n\t\twriteUInt32BE(this.buffer, value, offset);\n\t}\n\n\treadUInt32LE(offset: number): number {\n\t\treturn readUInt32LE(this.buffer, offset);\n\t}\n\n\twriteUInt32LE(value: number, offset: number): void {\n\t\twriteUInt32LE(this.buffer, value, offset);\n\t}\n\n\treadUInt8(offset: number): number {\n\t\treturn readUInt8(this.buffer, offset);\n\t}\n\n\twriteUInt8(value: number, offset: number): void {\n\t\twriteUInt8(this.buffer, value, offset);\n\t}\n}\n\nexport function readUInt16LE(source: Uint8Array, offset: number): number {\n\treturn (\n\t\t((source[offset + 0] << 0) >>> 0) |\n\t\t((source[offset + 1] << 8) >>> 0)\n\t);\n}\n\nexport function writeUInt16LE(destination: Uint8Array, value: number, offset: number): void {\n\tdestination[offset + 0] = (value & 0b11111111);\n\tvalue = value >>> 8;\n\tdestination[offset + 1] = (value & 0b11111111);\n}\n\nexport function readUInt32BE(source: Uint8Array, offset: number): number {\n\treturn (\n\t\tsource[offset] * 2 ** 24\n\t\t+ source[offset + 1] * 2 ** 16\n\t\t+ source[offset + 2] * 2 ** 8\n\t\t+ source[offset + 3]\n\t);\n}\n\nexport function writeUInt32BE(destination: Uint8Array, value: number, offset: number): void {\n\tdestination[offset + 3] = value;\n\tvalue = value >>> 8;\n\tdestination[offset + 2] = value;\n\tvalue = value >>> 8;\n\tdestination[offset + 1] = value;\n\tvalue = value >>> 8;\n\tdestination[offset] = value;\n}\n\nexport function readUInt32LE(source: Uint8Array, offset: number): number {\n\treturn (\n\t\t((source[offset + 0] << 0) >>> 0) |\n\t\t((source[offset + 1] << 8) >>> 0) |\n\t\t((source[offset + 2] << 16) >>> 0) |\n\t\t((source[offset + 3] << 24) >>> 0)\n\t);\n}\n\nexport function writeUInt32LE(destination: Uint8Array, value: number, offset: number): void {\n\tdestination[offset + 0] = (value & 0b11111111);\n\tvalue = value >>> 8;\n\tdestination[offset + 1] = (value & 0b11111111);\n\tvalue = value >>> 8;\n\tdestination[offset + 2] = (value & 0b11111111);\n\tvalue = value >>> 8;\n\tdestination[offset + 3] = (value & 0b11111111);\n}\n\nexport function readUInt8(source: Uint8Array, offset: number): number {\n\treturn source[offset];\n}\n\nexport function writeUInt8(destination: Uint8Array, value: number, offset: number): void {\n\tdestination[offset] = value;\n}\n\nexport interface VSBufferReadable extends streams.Readable<VSBuffer> { }\n\nexport interface VSBufferReadableStream extends streams.ReadableStream<VSBuffer> { }\n\nexport interface VSBufferWriteableStream extends streams.WriteableStream<VSBuffer> { }\n\nexport interface VSBufferReadableBufferedStream extends streams.ReadableBufferedStream<VSBuffer> { }\n\nexport function readableToBuffer(readable: VSBufferReadable): VSBuffer {\n\treturn streams.consumeReadable<VSBuffer>(readable, chunks => VSBuffer.concat(chunks));\n}\n\nexport function bufferToReadable(buffer: VSBuffer): VSBufferReadable {\n\treturn streams.toReadable<VSBuffer>(buffer);\n}\n\nexport function streamToBuffer(stream: streams.ReadableStream<VSBuffer>): Promise<VSBuffer> {\n\treturn streams.consumeStream<VSBuffer>(stream, chunks => VSBuffer.concat(chunks));\n}\n\nexport async function bufferedStreamToBuffer(bufferedStream: streams.ReadableBufferedStream<VSBuffer>): Promise<VSBuffer> {\n\tif (bufferedStream.ended) {\n\t\treturn VSBuffer.concat(bufferedStream.buffer);\n\t}\n\n\treturn VSBuffer.concat([\n\n\t\t// Include already read chunks...\n\t\t...bufferedStream.buffer,\n\n\t\t// ...and all additional chunks\n\t\tawait streamToBuffer(bufferedStream.stream)\n\t]);\n}\n\nexport function bufferToStream(buffer: VSBuffer): streams.ReadableStream<VSBuffer> {\n\treturn streams.toStream<VSBuffer>(buffer, chunks => VSBuffer.concat(chunks));\n}\n\nexport function streamToBufferReadableStream(stream: streams.ReadableStreamEvents<Uint8Array | string>): streams.ReadableStream<VSBuffer> {\n\treturn streams.transform<Uint8Array | string, VSBuffer>(stream, { data: data => typeof data === 'string' ? VSBuffer.fromString(data) : VSBuffer.wrap(data) }, chunks => VSBuffer.concat(chunks));\n}\n\nexport function newWriteableBufferStream(options?: streams.WriteableStreamOptions): streams.WriteableStream<VSBuffer> {\n\treturn streams.newWriteableStream<VSBuffer>(chunks => VSBuffer.concat(chunks), options);\n}\n\nexport function prefixedBufferReadable(prefix: VSBuffer, readable: VSBufferReadable): VSBufferReadable {\n\treturn streams.prefixedReadable(prefix, readable, chunks => VSBuffer.concat(chunks));\n}\n\nexport function prefixedBufferStream(prefix: VSBuffer, stream: VSBufferReadableStream): VSBufferReadableStream {\n\treturn streams.prefixedStream(prefix, stream, chunks => VSBuffer.concat(chunks));\n}\n\n/** Decodes base64 to a uint8 array. URL-encoded and unpadded base64 is allowed. */\nexport function decodeBase64(encoded: string) {\n\tlet building = 0;\n\tlet remainder = 0;\n\tlet bufi = 0;\n\n\t// The simpler way to do this is `Uint8Array.from(atob(str), c => c.charCodeAt(0))`,\n\t// but that's about 10-20x slower than this function in current Chromium versions.\n\n\tconst buffer = new Uint8Array(Math.floor(encoded.length / 4 * 3));\n\tconst append = (value: number) => {\n\t\tswitch (remainder) {\n\t\t\tcase 3:\n\t\t\t\tbuffer[bufi++] = building | value;\n\t\t\t\tremainder = 0;\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tbuffer[bufi++] = building | (value >>> 2);\n\t\t\t\tbuilding = value << 6;\n\t\t\t\tremainder = 3;\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tbuffer[bufi++] = building | (value >>> 4);\n\t\t\t\tbuilding = value << 4;\n\t\t\t\tremainder = 2;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbuilding = value << 2;\n\t\t\t\tremainder = 1;\n\t\t}\n\t};\n\n\tfor (let i = 0; i < encoded.length; i++) {\n\t\tconst code = encoded.charCodeAt(i);\n\t\t// See https://datatracker.ietf.org/doc/html/rfc4648#section-4\n\t\t// This branchy code is about 3x faster than an indexOf on a base64 char string.\n\t\tif (code >= 65 && code <= 90) {\n\t\t\tappend(code - 65); // A-Z starts ranges from char code 65 to 90\n\t\t} else if (code >= 97 && code <= 122) {\n\t\t\tappend(code - 97 + 26); // a-z starts ranges from char code 97 to 122, starting at byte 26\n\t\t} else if (code >= 48 && code <= 57) {\n\t\t\tappend(code - 48 + 52); // 0-9 starts ranges from char code 48 to 58, starting at byte 52\n\t\t} else if (code === 43 || code === 45) {\n\t\t\tappend(62); // \"+\" or \"-\" for URLS\n\t\t} else if (code === 47 || code === 95) {\n\t\t\tappend(63); // \"/\" or \"_\" for URLS\n\t\t} else if (code === 61) {\n\t\t\tbreak; // \"=\"\n\t\t} else {\n\t\t\tthrow new SyntaxError(`Unexpected base64 character ${encoded[i]}`);\n\t\t}\n\t}\n\n\tconst unpadded = bufi;\n\twhile (remainder > 0) {\n\t\tappend(0);\n\t}\n\n\t// slice is needed to account for overestimation due to padding\n\treturn VSBuffer.wrap(buffer).slice(0, unpadded);\n}\n\nconst base64Alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\nconst base64UrlSafeAlphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_';\n\n/** Encodes a buffer to a base64 string. */\nexport function encodeBase64({ buffer }: VSBuffer, padded = true, urlSafe = false) {\n\tconst dictionary = urlSafe ? base64UrlSafeAlphabet : base64Alphabet;\n\tlet output = '';\n\n\tconst remainder = buffer.byteLength % 3;\n\n\tlet i = 0;\n\tfor (; i < buffer.byteLength - remainder; i += 3) {\n\t\tconst a = buffer[i + 0];\n\t\tconst b = buffer[i + 1];\n\t\tconst c = buffer[i + 2];\n\n\t\toutput += dictionary[a >>> 2];\n\t\toutput += dictionary[(a << 4 | b >>> 4) & 0b111111];\n\t\toutput += dictionary[(b << 2 | c >>> 6) & 0b111111];\n\t\toutput += dictionary[c & 0b111111];\n\t}\n\n\tif (remainder === 1) {\n\t\tconst a = buffer[i + 0];\n\t\toutput += dictionary[a >>> 2];\n\t\toutput += dictionary[(a << 4) & 0b111111];\n\t\tif (padded) { output += '=='; }\n\t} else if (remainder === 2) {\n\t\tconst a = buffer[i + 0];\n\t\tconst b = buffer[i + 1];\n\t\toutput += dictionary[a >>> 2];\n\t\toutput += dictionary[(a << 4 | b >>> 4) & 0b111111];\n\t\toutput += dictionary[(b << 2) & 0b111111];\n\t\tif (padded) { output += '='; }\n\t}\n\n\treturn output;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n\nconst _UUIDPattern = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;\n\nexport function isUUID(value: string): boolean {\n\treturn _UUIDPattern.test(value);\n}\n\ndeclare const crypto: undefined | {\n\t//https://developer.mozilla.org/en-US/docs/Web/API/Crypto/getRandomValues#browser_compatibility\n\tgetRandomValues?(data: Uint8Array): Uint8Array;\n\t//https://developer.mozilla.org/en-US/docs/Web/API/Crypto/randomUUID#browser_compatibility\n\trandomUUID?(): string;\n};\n\nexport const generateUuid = (function (): () => string {\n\n\t// use `randomUUID` if possible\n\tif (typeof crypto === 'object' && typeof crypto.randomUUID === 'function') {\n\t\treturn crypto.randomUUID.bind(crypto);\n\t}\n\n\t// use `randomValues` if possible\n\tlet getRandomValues: (bucket: Uint8Array) => Uint8Array;\n\tif (typeof crypto === 'object' && typeof crypto.getRandomValues === 'function') {\n\t\tgetRandomValues = crypto.getRandomValues.bind(crypto);\n\n\t} else {\n\t\tgetRandomValues = function (bucket: Uint8Array): Uint8Array {\n\t\t\tfor (let i = 0; i < bucket.length; i++) {\n\t\t\t\tbucket[i] = Math.floor(Math.random() * 256);\n\t\t\t}\n\t\t\treturn bucket;\n\t\t};\n\t}\n\n\t// prep-work\n\tconst _data = new Uint8Array(16);\n\tconst _hex: string[] = [];\n\tfor (let i = 0; i < 256; i++) {\n\t\t_hex.push(i.toString(16).padStart(2, '0'));\n\t}\n\n\treturn function generateUuid(): string {\n\t\t// get data\n\t\tgetRandomValues(_data);\n\n\t\t// set version bits\n\t\t_data[6] = (_data[6] & 0x0f) | 0x40;\n\t\t_data[8] = (_data[8] & 0x3f) | 0x80;\n\n\t\t// print as string\n\t\tlet i = 0;\n\t\tlet result = '';\n\t\tresult += _hex[_data[i++]];\n\t\tresult += _hex[_data[i++]];\n\t\tresult += _hex[_data[i++]];\n\t\tresult += _hex[_data[i++]];\n\t\tresult += '-';\n\t\tresult += _hex[_data[i++]];\n\t\tresult += _hex[_data[i++]];\n\t\tresult += '-';\n\t\tresult += _hex[_data[i++]];\n\t\tresult += _hex[_data[i++]];\n\t\tresult += '-';\n\t\tresult += _hex[_data[i++]];\n\t\tresult += _hex[_data[i++]];\n\t\tresult += '-';\n\t\tresult += _hex[_data[i++]];\n\t\tresult += _hex[_data[i++]];\n\t\tresult += _hex[_data[i++]];\n\t\tresult += _hex[_data[i++]];\n\t\tresult += _hex[_data[i++]];\n\t\tresult += _hex[_data[i++]];\n\t\treturn result;\n\t};\n})();\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport const EDITOR_MODEL_DEFAULTS = {\n\ttabSize: 4,\n\tindentSize: 4,\n\tinsertSpaces: true,\n\tdetectIndentation: true,\n\ttrimAutoWhitespace: true,\n\tlargeFileOptimizations: true,\n\tbracketPairColorizationOptions: {\n\t\tenabled: true,\n\t\tindependentColorPoolPerBracketType: false,\n\t},\n};\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CharCode } from 'vs/base/common/charCode';\nimport { StandardTokenType } from 'vs/editor/common/encodedTokenAttributes';\nimport { ScopedLineTokens } from 'vs/editor/common/languages/supports';\n\n/**\n * Describes how comments for a language work.\n */\nexport interface CommentRule {\n\t/**\n\t * The line comment token, like `// this is a comment`\n\t */\n\tlineComment?: string | null;\n\t/**\n\t * The block comment character pair, like `/* block comment *&#47;`\n\t */\n\tblockComment?: CharacterPair | null;\n}\n\n/**\n * The language configuration interface defines the contract between extensions and\n * various editor features, like automatic bracket insertion, automatic indentation etc.\n */\nexport interface LanguageConfiguration {\n\t/**\n\t * The language's comment settings.\n\t */\n\tcomments?: CommentRule;\n\t/**\n\t * The language's brackets.\n\t * This configuration implicitly affects pressing Enter around these brackets.\n\t */\n\tbrackets?: CharacterPair[];\n\t/**\n\t * The language's word definition.\n\t * If the language supports Unicode identifiers (e.g. JavaScript), it is preferable\n\t * to provide a word definition that uses exclusion of known separators.\n\t * e.g.: A regex that matches anything except known separators (and dot is allowed to occur in a floating point number):\n\t *   /(-?\\d*\\.\\d\\w*)|([^\\`\\~\\!\\@\\#\\%\\^\\&\\*\\(\\)\\-\\=\\+\\[\\{\\]\\}\\\\\\|\\;\\:\\'\\\"\\,\\.\\<\\>\\/\\?\\s]+)/g\n\t */\n\twordPattern?: RegExp;\n\t/**\n\t * The language's indentation settings.\n\t */\n\tindentationRules?: IndentationRule;\n\t/**\n\t * The language's rules to be evaluated when pressing Enter.\n\t */\n\tonEnterRules?: OnEnterRule[];\n\t/**\n\t * The language's auto closing pairs. The 'close' character is automatically inserted with the\n\t * 'open' character is typed. If not set, the configured brackets will be used.\n\t */\n\tautoClosingPairs?: IAutoClosingPairConditional[];\n\t/**\n\t * The language's surrounding pairs. When the 'open' character is typed on a selection, the\n\t * selected string is surrounded by the open and close characters. If not set, the autoclosing pairs\n\t * settings will be used.\n\t */\n\tsurroundingPairs?: IAutoClosingPair[];\n\t/**\n\t * Defines a list of bracket pairs that are colorized depending on their nesting level.\n\t * If not set, the configured brackets will be used.\n\t*/\n\tcolorizedBracketPairs?: CharacterPair[];\n\t/**\n\t * Defines what characters must be after the cursor for bracket or quote autoclosing to occur when using the \\'languageDefined\\' autoclosing setting.\n\t *\n\t * This is typically the set of characters which can not start an expression, such as whitespace, closing brackets, non-unary operators, etc.\n\t */\n\tautoCloseBefore?: string;\n\n\t/**\n\t * The language's folding rules.\n\t */\n\tfolding?: FoldingRules;\n\n\t/**\n\t * **Deprecated** Do not use.\n\t *\n\t * @deprecated Will be replaced by a better API soon.\n\t */\n\t__electricCharacterSupport?: {\n\t\tdocComment?: IDocComment;\n\t};\n}\n\n/**\n * @internal\n */\ntype OrUndefined<T> = { [P in keyof T]: T[P] | undefined };\n\n/**\n * @internal\n */\nexport type ExplicitLanguageConfiguration = OrUndefined<Required<LanguageConfiguration>>;\n\n/**\n * Describes indentation rules for a language.\n */\nexport interface IndentationRule {\n\t/**\n\t * If a line matches this pattern, then all the lines after it should be unindented once (until another rule matches).\n\t */\n\tdecreaseIndentPattern: RegExp;\n\t/**\n\t * If a line matches this pattern, then all the lines after it should be indented once (until another rule matches).\n\t */\n\tincreaseIndentPattern: RegExp;\n\t/**\n\t * If a line matches this pattern, then **only the next line** after it should be indented once.\n\t */\n\tindentNextLinePattern?: RegExp | null;\n\t/**\n\t * If a line matches this pattern, then its indentation should not be changed and it should not be evaluated against the other rules.\n\t */\n\tunIndentedLinePattern?: RegExp | null;\n\n}\n\n/**\n * Describes language specific folding markers such as '#region' and '#endregion'.\n * The start and end regexes will be tested against the contents of all lines and must be designed efficiently:\n * - the regex should start with '^'\n * - regexp flags (i, g) are ignored\n */\nexport interface FoldingMarkers {\n\tstart: RegExp;\n\tend: RegExp;\n}\n\n/**\n * Describes folding rules for a language.\n */\nexport interface FoldingRules {\n\t/**\n\t * Used by the indentation based strategy to decide whether empty lines belong to the previous or the next block.\n\t * A language adheres to the off-side rule if blocks in that language are expressed by their indentation.\n\t * See [wikipedia](https://en.wikipedia.org/wiki/Off-side_rule) for more information.\n\t * If not set, `false` is used and empty lines belong to the previous block.\n\t */\n\toffSide?: boolean;\n\n\t/**\n\t * Region markers used by the language.\n\t */\n\tmarkers?: FoldingMarkers;\n}\n\n/**\n * Describes a rule to be evaluated when pressing Enter.\n */\nexport interface OnEnterRule {\n\t/**\n\t * This rule will only execute if the text before the cursor matches this regular expression.\n\t */\n\tbeforeText: RegExp;\n\t/**\n\t * This rule will only execute if the text after the cursor matches this regular expression.\n\t */\n\tafterText?: RegExp;\n\t/**\n\t * This rule will only execute if the text above the this line matches this regular expression.\n\t */\n\tpreviousLineText?: RegExp;\n\t/**\n\t * The action to execute.\n\t */\n\taction: EnterAction;\n}\n\n/**\n * Definition of documentation comments (e.g. Javadoc/JSdoc)\n */\nexport interface IDocComment {\n\t/**\n\t * The string that starts a doc comment (e.g. '/**')\n\t */\n\topen: string;\n\t/**\n\t * The string that appears on the last line and closes the doc comment (e.g. ' * /').\n\t */\n\tclose?: string;\n}\n\n/**\n * A tuple of two characters, like a pair of\n * opening and closing brackets.\n */\nexport type CharacterPair = [string, string];\n\nexport interface IAutoClosingPair {\n\topen: string;\n\tclose: string;\n}\n\nexport interface IAutoClosingPairConditional extends IAutoClosingPair {\n\tnotIn?: string[];\n}\n\n/**\n * Describes what to do with the indentation when pressing Enter.\n */\nexport enum IndentAction {\n\t/**\n\t * Insert new line and copy the previous line's indentation.\n\t */\n\tNone = 0,\n\t/**\n\t * Insert new line and indent once (relative to the previous line's indentation).\n\t */\n\tIndent = 1,\n\t/**\n\t * Insert two new lines:\n\t *  - the first one indented which will hold the cursor\n\t *  - the second one at the same indentation level\n\t */\n\tIndentOutdent = 2,\n\t/**\n\t * Insert new line and outdent once (relative to the previous line's indentation).\n\t */\n\tOutdent = 3\n}\n\n/**\n * Describes what to do when pressing Enter.\n */\nexport interface EnterAction {\n\t/**\n\t * Describe what to do with the indentation.\n\t */\n\tindentAction: IndentAction;\n\t/**\n\t * Describes text to be appended after the new line and after the indentation.\n\t */\n\tappendText?: string;\n\t/**\n\t * Describes the number of characters to remove from the new line's indentation.\n\t */\n\tremoveText?: number;\n}\n\n/**\n * @internal\n */\nexport interface CompleteEnterAction {\n\t/**\n\t * Describe what to do with the indentation.\n\t */\n\tindentAction: IndentAction;\n\t/**\n\t * Describes text to be appended after the new line and after the indentation.\n\t */\n\tappendText: string;\n\t/**\n\t * Describes the number of characters to remove from the new line's indentation.\n\t */\n\tremoveText: number;\n\t/**\n\t * The line's indentation minus removeText\n\t */\n\tindentation: string;\n}\n\n/**\n * @internal\n */\nexport class StandardAutoClosingPairConditional {\n\n\treadonly open: string;\n\treadonly close: string;\n\tprivate readonly _inString: boolean;\n\tprivate readonly _inComment: boolean;\n\tprivate readonly _inRegEx: boolean;\n\tprivate _neutralCharacter: string | null = null;\n\tprivate _neutralCharacterSearched: boolean = false;\n\n\tconstructor(source: IAutoClosingPairConditional) {\n\t\tthis.open = source.open;\n\t\tthis.close = source.close;\n\n\t\t// initially allowed in all tokens\n\t\tthis._inString = true;\n\t\tthis._inComment = true;\n\t\tthis._inRegEx = true;\n\n\t\tif (Array.isArray(source.notIn)) {\n\t\t\tfor (let i = 0, len = source.notIn.length; i < len; i++) {\n\t\t\t\tconst notIn: string = source.notIn[i];\n\t\t\t\tswitch (notIn) {\n\t\t\t\t\tcase 'string':\n\t\t\t\t\t\tthis._inString = false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'comment':\n\t\t\t\t\t\tthis._inComment = false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'regex':\n\t\t\t\t\t\tthis._inRegEx = false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic isOK(standardToken: StandardTokenType): boolean {\n\t\tswitch (standardToken) {\n\t\t\tcase StandardTokenType.Other:\n\t\t\t\treturn true;\n\t\t\tcase StandardTokenType.Comment:\n\t\t\t\treturn this._inComment;\n\t\t\tcase StandardTokenType.String:\n\t\t\t\treturn this._inString;\n\t\t\tcase StandardTokenType.RegEx:\n\t\t\t\treturn this._inRegEx;\n\t\t}\n\t}\n\n\tpublic shouldAutoClose(context: ScopedLineTokens, column: number): boolean {\n\t\t// Always complete on empty line\n\t\tif (context.getTokenCount() === 0) {\n\t\t\treturn true;\n\t\t}\n\n\t\tconst tokenIndex = context.findTokenIndexAtOffset(column - 2);\n\t\tconst standardTokenType = context.getStandardTokenType(tokenIndex);\n\t\treturn this.isOK(standardTokenType);\n\t}\n\n\tprivate _findNeutralCharacterInRange(fromCharCode: number, toCharCode: number): string | null {\n\t\tfor (let charCode = fromCharCode; charCode <= toCharCode; charCode++) {\n\t\t\tconst character = String.fromCharCode(charCode);\n\t\t\tif (!this.open.includes(character) && !this.close.includes(character)) {\n\t\t\t\treturn character;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\t/**\n\t * Find a character in the range [0-9a-zA-Z] that does not appear in the open or close\n\t */\n\tpublic findNeutralCharacter(): string | null {\n\t\tif (!this._neutralCharacterSearched) {\n\t\t\tthis._neutralCharacterSearched = true;\n\t\t\tif (!this._neutralCharacter) {\n\t\t\t\tthis._neutralCharacter = this._findNeutralCharacterInRange(CharCode.Digit0, CharCode.Digit9);\n\t\t\t}\n\t\t\tif (!this._neutralCharacter) {\n\t\t\t\tthis._neutralCharacter = this._findNeutralCharacterInRange(CharCode.a, CharCode.z);\n\t\t\t}\n\t\t\tif (!this._neutralCharacter) {\n\t\t\t\tthis._neutralCharacter = this._findNeutralCharacterInRange(CharCode.A, CharCode.Z);\n\t\t\t}\n\t\t}\n\t\treturn this._neutralCharacter;\n\t}\n}\n\n/**\n * @internal\n */\nexport class AutoClosingPairs {\n\t// it is useful to be able to get pairs using either end of open and close\n\n\t/** Key is first character of open */\n\tpublic readonly autoClosingPairsOpenByStart: Map<string, StandardAutoClosingPairConditional[]>;\n\t/** Key is last character of open */\n\tpublic readonly autoClosingPairsOpenByEnd: Map<string, StandardAutoClosingPairConditional[]>;\n\t/** Key is first character of close */\n\tpublic readonly autoClosingPairsCloseByStart: Map<string, StandardAutoClosingPairConditional[]>;\n\t/** Key is last character of close */\n\tpublic readonly autoClosingPairsCloseByEnd: Map<string, StandardAutoClosingPairConditional[]>;\n\t/** Key is close. Only has pairs that are a single character */\n\tpublic readonly autoClosingPairsCloseSingleChar: Map<string, StandardAutoClosingPairConditional[]>;\n\n\tconstructor(autoClosingPairs: StandardAutoClosingPairConditional[]) {\n\t\tthis.autoClosingPairsOpenByStart = new Map<string, StandardAutoClosingPairConditional[]>();\n\t\tthis.autoClosingPairsOpenByEnd = new Map<string, StandardAutoClosingPairConditional[]>();\n\t\tthis.autoClosingPairsCloseByStart = new Map<string, StandardAutoClosingPairConditional[]>();\n\t\tthis.autoClosingPairsCloseByEnd = new Map<string, StandardAutoClosingPairConditional[]>();\n\t\tthis.autoClosingPairsCloseSingleChar = new Map<string, StandardAutoClosingPairConditional[]>();\n\t\tfor (const pair of autoClosingPairs) {\n\t\t\tappendEntry(this.autoClosingPairsOpenByStart, pair.open.charAt(0), pair);\n\t\t\tappendEntry(this.autoClosingPairsOpenByEnd, pair.open.charAt(pair.open.length - 1), pair);\n\t\t\tappendEntry(this.autoClosingPairsCloseByStart, pair.close.charAt(0), pair);\n\t\t\tappendEntry(this.autoClosingPairsCloseByEnd, pair.close.charAt(pair.close.length - 1), pair);\n\t\t\tif (pair.close.length === 1 && pair.open.length === 1) {\n\t\t\t\tappendEntry(this.autoClosingPairsCloseSingleChar, pair.close, pair);\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction appendEntry<K, V>(target: Map<K, V[]>, key: K, value: V): void {\n\tif (target.has(key)) {\n\t\ttarget.get(key)!.push(value);\n\t} else {\n\t\ttarget.set(key, [value]);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { localize } from 'vs/nls';\n\nconst minute = 60;\nconst hour = minute * 60;\nconst day = hour * 24;\nconst week = day * 7;\nconst month = day * 30;\nconst year = day * 365;\n\nexport function fromNow(date: number | Date, appendAgoLabel?: boolean, useFullTimeWords?: boolean): string {\n\tif (typeof date !== 'number') {\n\t\tdate = date.getTime();\n\t}\n\n\tconst seconds = Math.round((new Date().getTime() - date) / 1000);\n\tif (seconds < -30) {\n\t\treturn localize('date.fromNow.in', 'in {0}', fromNow(new Date().getTime() + seconds * 1000, false));\n\t}\n\n\tif (seconds < 30) {\n\t\treturn localize('date.fromNow.now', 'now');\n\t}\n\n\tlet value: number;\n\tif (seconds < minute) {\n\t\tvalue = seconds;\n\n\t\tif (appendAgoLabel) {\n\t\t\tif (value === 1) {\n\t\t\t\treturn useFullTimeWords\n\t\t\t\t\t? localize('date.fromNow.seconds.singular.ago.fullWord', '{0} second ago', value)\n\t\t\t\t\t: localize('date.fromNow.seconds.singular.ago', '{0} sec ago', value);\n\t\t\t} else {\n\t\t\t\treturn useFullTimeWords\n\t\t\t\t\t? localize('date.fromNow.seconds.plural.ago.fullWord', '{0} seconds ago', value)\n\t\t\t\t\t: localize('date.fromNow.seconds.plural.ago', '{0} secs ago', value);\n\t\t\t}\n\t\t} else {\n\t\t\tif (value === 1) {\n\t\t\t\treturn useFullTimeWords\n\t\t\t\t\t? localize('date.fromNow.seconds.singular.fullWord', '{0} second', value)\n\t\t\t\t\t: localize('date.fromNow.seconds.singular', '{0} sec', value);\n\t\t\t} else {\n\t\t\t\treturn useFullTimeWords\n\t\t\t\t\t? localize('date.fromNow.seconds.plural.fullWord', '{0} seconds', value)\n\t\t\t\t\t: localize('date.fromNow.seconds.plural', '{0} secs', value);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (seconds < hour) {\n\t\tvalue = Math.floor(seconds / minute);\n\t\tif (appendAgoLabel) {\n\t\t\tif (value === 1) {\n\t\t\t\treturn useFullTimeWords\n\t\t\t\t\t? localize('date.fromNow.minutes.singular.ago.fullWord', '{0} minute ago', value)\n\t\t\t\t\t: localize('date.fromNow.minutes.singular.ago', '{0} min ago', value);\n\t\t\t} else {\n\t\t\t\treturn useFullTimeWords\n\t\t\t\t\t? localize('date.fromNow.minutes.plural.ago.fullWord', '{0} minutes ago', value)\n\t\t\t\t\t: localize('date.fromNow.minutes.plural.ago', '{0} mins ago', value);\n\t\t\t}\n\t\t} else {\n\t\t\tif (value === 1) {\n\t\t\t\treturn useFullTimeWords\n\t\t\t\t\t? localize('date.fromNow.minutes.singular.fullWord', '{0} minute', value)\n\t\t\t\t\t: localize('date.fromNow.minutes.singular', '{0} min', value);\n\t\t\t} else {\n\t\t\t\treturn useFullTimeWords\n\t\t\t\t\t? localize('date.fromNow.minutes.plural.fullWord', '{0} minutes', value)\n\t\t\t\t\t: localize('date.fromNow.minutes.plural', '{0} mins', value);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (seconds < day) {\n\t\tvalue = Math.floor(seconds / hour);\n\t\tif (appendAgoLabel) {\n\t\t\tif (value === 1) {\n\t\t\t\treturn useFullTimeWords\n\t\t\t\t\t? localize('date.fromNow.hours.singular.ago.fullWord', '{0} hour ago', value)\n\t\t\t\t\t: localize('date.fromNow.hours.singular.ago', '{0} hr ago', value);\n\t\t\t} else {\n\t\t\t\treturn useFullTimeWords\n\t\t\t\t\t? localize('date.fromNow.hours.plural.ago.fullWord', '{0} hours ago', value)\n\t\t\t\t\t: localize('date.fromNow.hours.plural.ago', '{0} hrs ago', value);\n\t\t\t}\n\t\t} else {\n\t\t\tif (value === 1) {\n\t\t\t\treturn useFullTimeWords\n\t\t\t\t\t? localize('date.fromNow.hours.singular.fullWord', '{0} hour', value)\n\t\t\t\t\t: localize('date.fromNow.hours.singular', '{0} hr', value);\n\t\t\t} else {\n\t\t\t\treturn useFullTimeWords\n\t\t\t\t\t? localize('date.fromNow.hours.plural.fullWord', '{0} hours', value)\n\t\t\t\t\t: localize('date.fromNow.hours.plural', '{0} hrs', value);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (seconds < week) {\n\t\tvalue = Math.floor(seconds / day);\n\t\tif (appendAgoLabel) {\n\t\t\treturn value === 1\n\t\t\t\t? localize('date.fromNow.days.singular.ago', '{0} day ago', value)\n\t\t\t\t: localize('date.fromNow.days.plural.ago', '{0} days ago', value);\n\t\t} else {\n\t\t\treturn value === 1\n\t\t\t\t? localize('date.fromNow.days.singular', '{0} day', value)\n\t\t\t\t: localize('date.fromNow.days.plural', '{0} days', value);\n\t\t}\n\t}\n\n\tif (seconds < month) {\n\t\tvalue = Math.floor(seconds / week);\n\t\tif (appendAgoLabel) {\n\t\t\tif (value === 1) {\n\t\t\t\treturn useFullTimeWords\n\t\t\t\t\t? localize('date.fromNow.weeks.singular.ago.fullWord', '{0} week ago', value)\n\t\t\t\t\t: localize('date.fromNow.weeks.singular.ago', '{0} wk ago', value);\n\t\t\t} else {\n\t\t\t\treturn useFullTimeWords\n\t\t\t\t\t? localize('date.fromNow.weeks.plural.ago.fullWord', '{0} weeks ago', value)\n\t\t\t\t\t: localize('date.fromNow.weeks.plural.ago', '{0} wks ago', value);\n\t\t\t}\n\t\t} else {\n\t\t\tif (value === 1) {\n\t\t\t\treturn useFullTimeWords\n\t\t\t\t\t? localize('date.fromNow.weeks.singular.fullWord', '{0} week', value)\n\t\t\t\t\t: localize('date.fromNow.weeks.singular', '{0} wk', value);\n\t\t\t} else {\n\t\t\t\treturn useFullTimeWords\n\t\t\t\t\t? localize('date.fromNow.weeks.plural.fullWord', '{0} weeks', value)\n\t\t\t\t\t: localize('date.fromNow.weeks.plural', '{0} wks', value);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (seconds < year) {\n\t\tvalue = Math.floor(seconds / month);\n\t\tif (appendAgoLabel) {\n\t\t\tif (value === 1) {\n\t\t\t\treturn useFullTimeWords\n\t\t\t\t\t? localize('date.fromNow.months.singular.ago.fullWord', '{0} month ago', value)\n\t\t\t\t\t: localize('date.fromNow.months.singular.ago', '{0} mo ago', value);\n\t\t\t} else {\n\t\t\t\treturn useFullTimeWords\n\t\t\t\t\t? localize('date.fromNow.months.plural.ago.fullWord', '{0} months ago', value)\n\t\t\t\t\t: localize('date.fromNow.months.plural.ago', '{0} mos ago', value);\n\t\t\t}\n\t\t} else {\n\t\t\tif (value === 1) {\n\t\t\t\treturn useFullTimeWords\n\t\t\t\t\t? localize('date.fromNow.months.singular.fullWord', '{0} month', value)\n\t\t\t\t\t: localize('date.fromNow.months.singular', '{0} mo', value);\n\t\t\t} else {\n\t\t\t\treturn useFullTimeWords\n\t\t\t\t\t? localize('date.fromNow.months.plural.fullWord', '{0} months', value)\n\t\t\t\t\t: localize('date.fromNow.months.plural', '{0} mos', value);\n\t\t\t}\n\t\t}\n\t}\n\n\tvalue = Math.floor(seconds / year);\n\tif (appendAgoLabel) {\n\t\tif (value === 1) {\n\t\t\treturn useFullTimeWords\n\t\t\t\t? localize('date.fromNow.years.singular.ago.fullWord', '{0} year ago', value)\n\t\t\t\t: localize('date.fromNow.years.singular.ago', '{0} yr ago', value);\n\t\t} else {\n\t\t\treturn useFullTimeWords\n\t\t\t\t? localize('date.fromNow.years.plural.ago.fullWord', '{0} years ago', value)\n\t\t\t\t: localize('date.fromNow.years.plural.ago', '{0} yrs ago', value);\n\t\t}\n\t} else {\n\t\tif (value === 1) {\n\t\t\treturn useFullTimeWords\n\t\t\t\t? localize('date.fromNow.years.singular.fullWord', '{0} year', value)\n\t\t\t\t: localize('date.fromNow.years.singular', '{0} yr', value);\n\t\t} else {\n\t\t\treturn useFullTimeWords\n\t\t\t\t? localize('date.fromNow.years.plural.fullWord', '{0} years', value)\n\t\t\t\t: localize('date.fromNow.years.plural', '{0} yrs', value);\n\t\t}\n\t}\n}\n\nexport function toLocalISOString(date: Date): string {\n\treturn date.getFullYear() +\n\t\t'-' + String(date.getMonth() + 1).padStart(2, '0') +\n\t\t'-' + String(date.getDate()).padStart(2, '0') +\n\t\t'T' + String(date.getHours()).padStart(2, '0') +\n\t\t':' + String(date.getMinutes()).padStart(2, '0') +\n\t\t':' + String(date.getSeconds()).padStart(2, '0') +\n\t\t'.' + (date.getMilliseconds() / 1000).toFixed(3).slice(2, 5) +\n\t\t'Z';\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as arrays from 'vs/base/common/arrays';\nimport * as types from 'vs/base/common/types';\nimport * as nls from 'vs/nls';\nimport { IAction } from 'vs/base/common/actions';\n\nfunction exceptionToErrorMessage(exception: any, verbose: boolean): string {\n\tif (verbose && (exception.stack || exception.stacktrace)) {\n\t\treturn nls.localize('stackTrace.format', \"{0}: {1}\", detectSystemErrorMessage(exception), stackToString(exception.stack) || stackToString(exception.stacktrace));\n\t}\n\n\treturn detectSystemErrorMessage(exception);\n}\n\nfunction stackToString(stack: string[] | string | undefined): string | undefined {\n\tif (Array.isArray(stack)) {\n\t\treturn stack.join('\\n');\n\t}\n\n\treturn stack;\n}\n\nfunction detectSystemErrorMessage(exception: any): string {\n\n\t// See https://nodejs.org/api/errors.html#errors_class_system_error\n\tif (typeof exception.code === 'string' && typeof exception.errno === 'number' && typeof exception.syscall === 'string') {\n\t\treturn nls.localize('nodeExceptionMessage', \"A system error occurred ({0})\", exception.message);\n\t}\n\n\treturn exception.message || nls.localize('error.defaultMessage', \"An unknown error occurred. Please consult the log for more details.\");\n}\n\n/**\n * Tries to generate a human readable error message out of the error. If the verbose parameter\n * is set to true, the error message will include stacktrace details if provided.\n *\n * @returns A string containing the error message.\n */\nexport function toErrorMessage(error: any = null, verbose: boolean = false): string {\n\tif (!error) {\n\t\treturn nls.localize('error.defaultMessage', \"An unknown error occurred. Please consult the log for more details.\");\n\t}\n\n\tif (Array.isArray(error)) {\n\t\tconst errors: any[] = arrays.coalesce(error);\n\t\tconst msg = toErrorMessage(errors[0], verbose);\n\n\t\tif (errors.length > 1) {\n\t\t\treturn nls.localize('error.moreErrors', \"{0} ({1} errors in total)\", msg, errors.length);\n\t\t}\n\n\t\treturn msg;\n\t}\n\n\tif (types.isString(error)) {\n\t\treturn error;\n\t}\n\n\tif (error.detail) {\n\t\tconst detail = error.detail;\n\n\t\tif (detail.error) {\n\t\t\treturn exceptionToErrorMessage(detail.error, verbose);\n\t\t}\n\n\t\tif (detail.exception) {\n\t\t\treturn exceptionToErrorMessage(detail.exception, verbose);\n\t\t}\n\t}\n\n\tif (error.stack) {\n\t\treturn exceptionToErrorMessage(error, verbose);\n\t}\n\n\tif (error.message) {\n\t\treturn error.message;\n\t}\n\n\treturn nls.localize('error.defaultMessage', \"An unknown error occurred. Please consult the log for more details.\");\n}\n\n\nexport interface IErrorWithActions extends Error {\n\tactions: IAction[];\n}\n\nexport function isErrorWithActions(obj: unknown): obj is IErrorWithActions {\n\tconst candidate = obj as IErrorWithActions | undefined;\n\n\treturn candidate instanceof Error && Array.isArray(candidate.actions);\n}\n\nexport function createErrorWithActions(messageOrError: string | Error, actions: IAction[]): IErrorWithActions {\n\tlet error: IErrorWithActions;\n\tif (typeof messageOrError === 'string') {\n\t\terror = new Error(messageOrError) as IErrorWithActions;\n\t} else {\n\t\terror = messageOrError as IErrorWithActions;\n\t}\n\n\terror.actions = actions;\n\n\treturn error;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { extname } from 'vs/base/common/path';\n\nexport const Mimes = Object.freeze({\n\ttext: 'text/plain',\n\tbinary: 'application/octet-stream',\n\tunknown: 'application/unknown',\n\tmarkdown: 'text/markdown',\n\tlatex: 'text/latex',\n\turiList: 'text/uri-list',\n});\n\ninterface MapExtToMediaMimes {\n\t[index: string]: string;\n}\n\nconst mapExtToTextMimes: MapExtToMediaMimes = {\n\t'.css': 'text/css',\n\t'.csv': 'text/csv',\n\t'.htm': 'text/html',\n\t'.html': 'text/html',\n\t'.ics': 'text/calendar',\n\t'.js': 'text/javascript',\n\t'.mjs': 'text/javascript',\n\t'.txt': 'text/plain',\n\t'.xml': 'text/xml'\n};\n\n// Known media mimes that we can handle\nconst mapExtToMediaMimes: MapExtToMediaMimes = {\n\t'.aac': 'audio/x-aac',\n\t'.avi': 'video/x-msvideo',\n\t'.bmp': 'image/bmp',\n\t'.flv': 'video/x-flv',\n\t'.gif': 'image/gif',\n\t'.ico': 'image/x-icon',\n\t'.jpe': 'image/jpg',\n\t'.jpeg': 'image/jpg',\n\t'.jpg': 'image/jpg',\n\t'.m1v': 'video/mpeg',\n\t'.m2a': 'audio/mpeg',\n\t'.m2v': 'video/mpeg',\n\t'.m3a': 'audio/mpeg',\n\t'.mid': 'audio/midi',\n\t'.midi': 'audio/midi',\n\t'.mk3d': 'video/x-matroska',\n\t'.mks': 'video/x-matroska',\n\t'.mkv': 'video/x-matroska',\n\t'.mov': 'video/quicktime',\n\t'.movie': 'video/x-sgi-movie',\n\t'.mp2': 'audio/mpeg',\n\t'.mp2a': 'audio/mpeg',\n\t'.mp3': 'audio/mpeg',\n\t'.mp4': 'video/mp4',\n\t'.mp4a': 'audio/mp4',\n\t'.mp4v': 'video/mp4',\n\t'.mpe': 'video/mpeg',\n\t'.mpeg': 'video/mpeg',\n\t'.mpg': 'video/mpeg',\n\t'.mpg4': 'video/mp4',\n\t'.mpga': 'audio/mpeg',\n\t'.oga': 'audio/ogg',\n\t'.ogg': 'audio/ogg',\n\t'.opus': 'audio/opus',\n\t'.ogv': 'video/ogg',\n\t'.png': 'image/png',\n\t'.psd': 'image/vnd.adobe.photoshop',\n\t'.qt': 'video/quicktime',\n\t'.spx': 'audio/ogg',\n\t'.svg': 'image/svg+xml',\n\t'.tga': 'image/x-tga',\n\t'.tif': 'image/tiff',\n\t'.tiff': 'image/tiff',\n\t'.wav': 'audio/x-wav',\n\t'.webm': 'video/webm',\n\t'.webp': 'image/webp',\n\t'.wma': 'audio/x-ms-wma',\n\t'.wmv': 'video/x-ms-wmv',\n\t'.woff': 'application/font-woff',\n};\n\nexport function getMediaOrTextMime(path: string): string | undefined {\n\tconst ext = extname(path);\n\tconst textMime = mapExtToTextMimes[ext.toLowerCase()];\n\tif (textMime !== undefined) {\n\t\treturn textMime;\n\t} else {\n\t\treturn getMediaMime(path);\n\t}\n}\n\nexport function getMediaMime(path: string): string | undefined {\n\tconst ext = extname(path);\n\treturn mapExtToMediaMimes[ext.toLowerCase()];\n}\n\nexport function getExtensionForMimeType(mimeType: string): string | undefined {\n\tfor (const extension in mapExtToMediaMimes) {\n\t\tif (mapExtToMediaMimes[extension] === mimeType) {\n\t\t\treturn extension;\n\t\t}\n\t}\n\n\treturn undefined;\n}\n\nconst _simplePattern = /^(.+)\\/(.+?)(;.+)?$/;\n\nexport function normalizeMimeType(mimeType: string): string;\nexport function normalizeMimeType(mimeType: string, strict: true): string | undefined;\nexport function normalizeMimeType(mimeType: string, strict?: true): string | undefined {\n\n\tconst match = _simplePattern.exec(mimeType);\n\tif (!match) {\n\t\treturn strict\n\t\t\t? undefined\n\t\t\t: mimeType;\n\t}\n\t// https://datatracker.ietf.org/doc/html/rfc2045#section-5.1\n\t// media and subtype must ALWAYS be lowercase, parameter not\n\treturn `${match[1].toLowerCase()}/${match[2].toLowerCase()}${match[3] ?? ''}`;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CharCode } from 'vs/base/common/charCode';\nimport { isAbsolute, join, normalize, posix, sep } from 'vs/base/common/path';\nimport { isWindows } from 'vs/base/common/platform';\nimport { equalsIgnoreCase, rtrim, startsWithIgnoreCase } from 'vs/base/common/strings';\nimport { isNumber } from 'vs/base/common/types';\n\nexport function isPathSeparator(code: number) {\n\treturn code === CharCode.Slash || code === CharCode.Backslash;\n}\n\n/**\n * Takes a Windows OS path and changes backward slashes to forward slashes.\n * This should only be done for OS paths from Windows (or user provided paths potentially from Windows).\n * Using it on a Linux or MaxOS path might change it.\n */\nexport function toSlashes(osPath: string) {\n\treturn osPath.replace(/[\\\\/]/g, posix.sep);\n}\n\n/**\n * Takes a Windows OS path (using backward or forward slashes) and turns it into a posix path:\n * - turns backward slashes into forward slashes\n * - makes it absolute if it starts with a drive letter\n * This should only be done for OS paths from Windows (or user provided paths potentially from Windows).\n * Using it on a Linux or MaxOS path might change it.\n */\nexport function toPosixPath(osPath: string) {\n\tif (osPath.indexOf('/') === -1) {\n\t\tosPath = toSlashes(osPath);\n\t}\n\tif (/^[a-zA-Z]:(\\/|$)/.test(osPath)) { // starts with a drive letter\n\t\tosPath = '/' + osPath;\n\t}\n\treturn osPath;\n}\n\n/**\n * Computes the _root_ this path, like `getRoot('c:\\files') === c:\\`,\n * `getRoot('files:///files/path') === files:///`,\n * or `getRoot('\\\\server\\shares\\path') === \\\\server\\shares\\`\n */\nexport function getRoot(path: string, sep: string = posix.sep): string {\n\tif (!path) {\n\t\treturn '';\n\t}\n\n\tconst len = path.length;\n\tconst firstLetter = path.charCodeAt(0);\n\tif (isPathSeparator(firstLetter)) {\n\t\tif (isPathSeparator(path.charCodeAt(1))) {\n\t\t\t// UNC candidate \\\\localhost\\shares\\ddd\n\t\t\t//               ^^^^^^^^^^^^^^^^^^^\n\t\t\tif (!isPathSeparator(path.charCodeAt(2))) {\n\t\t\t\tlet pos = 3;\n\t\t\t\tconst start = pos;\n\t\t\t\tfor (; pos < len; pos++) {\n\t\t\t\t\tif (isPathSeparator(path.charCodeAt(pos))) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (start !== pos && !isPathSeparator(path.charCodeAt(pos + 1))) {\n\t\t\t\t\tpos += 1;\n\t\t\t\t\tfor (; pos < len; pos++) {\n\t\t\t\t\t\tif (isPathSeparator(path.charCodeAt(pos))) {\n\t\t\t\t\t\t\treturn path.slice(0, pos + 1) // consume this separator\n\t\t\t\t\t\t\t\t.replace(/[\\\\/]/g, sep);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// /user/far\n\t\t// ^\n\t\treturn sep;\n\n\t} else if (isWindowsDriveLetter(firstLetter)) {\n\t\t// check for windows drive letter c:\\ or c:\n\n\t\tif (path.charCodeAt(1) === CharCode.Colon) {\n\t\t\tif (isPathSeparator(path.charCodeAt(2))) {\n\t\t\t\t// C:\\fff\n\t\t\t\t// ^^^\n\t\t\t\treturn path.slice(0, 2) + sep;\n\t\t\t} else {\n\t\t\t\t// C:\n\t\t\t\t// ^^\n\t\t\t\treturn path.slice(0, 2);\n\t\t\t}\n\t\t}\n\t}\n\n\t// check for URI\n\t// scheme://authority/path\n\t// ^^^^^^^^^^^^^^^^^^^\n\tlet pos = path.indexOf('://');\n\tif (pos !== -1) {\n\t\tpos += 3; // 3 -> \"://\".length\n\t\tfor (; pos < len; pos++) {\n\t\t\tif (isPathSeparator(path.charCodeAt(pos))) {\n\t\t\t\treturn path.slice(0, pos + 1); // consume this separator\n\t\t\t}\n\t\t}\n\t}\n\n\treturn '';\n}\n\n/**\n * Check if the path follows this pattern: `\\\\hostname\\sharename`.\n *\n * @see https://msdn.microsoft.com/en-us/library/gg465305.aspx\n * @return A boolean indication if the path is a UNC path, on none-windows\n * always false.\n */\nexport function isUNC(path: string): boolean {\n\tif (!isWindows) {\n\t\t// UNC is a windows concept\n\t\treturn false;\n\t}\n\n\tif (!path || path.length < 5) {\n\t\t// at least \\\\a\\b\n\t\treturn false;\n\t}\n\n\tlet code = path.charCodeAt(0);\n\tif (code !== CharCode.Backslash) {\n\t\treturn false;\n\t}\n\n\tcode = path.charCodeAt(1);\n\n\tif (code !== CharCode.Backslash) {\n\t\treturn false;\n\t}\n\n\tlet pos = 2;\n\tconst start = pos;\n\tfor (; pos < path.length; pos++) {\n\t\tcode = path.charCodeAt(pos);\n\t\tif (code === CharCode.Backslash) {\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (start === pos) {\n\t\treturn false;\n\t}\n\n\tcode = path.charCodeAt(pos + 1);\n\n\tif (isNaN(code) || code === CharCode.Backslash) {\n\t\treturn false;\n\t}\n\n\treturn true;\n}\n\n// Reference: https://en.wikipedia.org/wiki/Filename\nconst WINDOWS_INVALID_FILE_CHARS = /[\\\\/:\\*\\?\"<>\\|]/g;\nconst UNIX_INVALID_FILE_CHARS = /[\\\\/]/g;\nconst WINDOWS_FORBIDDEN_NAMES = /^(con|prn|aux|clock\\$|nul|lpt[0-9]|com[0-9])(\\.(.*?))?$/i;\nexport function isValidBasename(name: string | null | undefined, isWindowsOS: boolean = isWindows): boolean {\n\tconst invalidFileChars = isWindowsOS ? WINDOWS_INVALID_FILE_CHARS : UNIX_INVALID_FILE_CHARS;\n\n\tif (!name || name.length === 0 || /^\\s+$/.test(name)) {\n\t\treturn false; // require a name that is not just whitespace\n\t}\n\n\tinvalidFileChars.lastIndex = 0; // the holy grail of software development\n\tif (invalidFileChars.test(name)) {\n\t\treturn false; // check for certain invalid file characters\n\t}\n\n\tif (isWindowsOS && WINDOWS_FORBIDDEN_NAMES.test(name)) {\n\t\treturn false; // check for certain invalid file names\n\t}\n\n\tif (name === '.' || name === '..') {\n\t\treturn false; // check for reserved values\n\t}\n\n\tif (isWindowsOS && name[name.length - 1] === '.') {\n\t\treturn false; // Windows: file cannot end with a \".\"\n\t}\n\n\tif (isWindowsOS && name.length !== name.trim().length) {\n\t\treturn false; // Windows: file cannot end with a whitespace\n\t}\n\n\tif (name.length > 255) {\n\t\treturn false; // most file systems do not allow files > 255 length\n\t}\n\n\treturn true;\n}\n\n/**\n * @deprecated please use `IUriIdentityService.extUri.isEqual` instead. If you are\n * in a context without services, consider to pass down the `extUri` from the outside\n * or use `extUriBiasedIgnorePathCase` if you know what you are doing.\n */\nexport function isEqual(pathA: string, pathB: string, ignoreCase?: boolean): boolean {\n\tconst identityEquals = (pathA === pathB);\n\tif (!ignoreCase || identityEquals) {\n\t\treturn identityEquals;\n\t}\n\n\tif (!pathA || !pathB) {\n\t\treturn false;\n\t}\n\n\treturn equalsIgnoreCase(pathA, pathB);\n}\n\n/**\n * @deprecated please use `IUriIdentityService.extUri.isEqualOrParent` instead. If\n * you are in a context without services, consider to pass down the `extUri` from the\n * outside, or use `extUriBiasedIgnorePathCase` if you know what you are doing.\n */\nexport function isEqualOrParent(base: string, parentCandidate: string, ignoreCase?: boolean, separator = sep): boolean {\n\tif (base === parentCandidate) {\n\t\treturn true;\n\t}\n\n\tif (!base || !parentCandidate) {\n\t\treturn false;\n\t}\n\n\tif (parentCandidate.length > base.length) {\n\t\treturn false;\n\t}\n\n\tif (ignoreCase) {\n\t\tconst beginsWith = startsWithIgnoreCase(base, parentCandidate);\n\t\tif (!beginsWith) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (parentCandidate.length === base.length) {\n\t\t\treturn true; // same path, different casing\n\t\t}\n\n\t\tlet sepOffset = parentCandidate.length;\n\t\tif (parentCandidate.charAt(parentCandidate.length - 1) === separator) {\n\t\t\tsepOffset--; // adjust the expected sep offset in case our candidate already ends in separator character\n\t\t}\n\n\t\treturn base.charAt(sepOffset) === separator;\n\t}\n\n\tif (parentCandidate.charAt(parentCandidate.length - 1) !== separator) {\n\t\tparentCandidate += separator;\n\t}\n\n\treturn base.indexOf(parentCandidate) === 0;\n}\n\nexport function isWindowsDriveLetter(char0: number): boolean {\n\treturn char0 >= CharCode.A && char0 <= CharCode.Z || char0 >= CharCode.a && char0 <= CharCode.z;\n}\n\nexport function sanitizeFilePath(candidate: string, cwd: string): string {\n\n\t// Special case: allow to open a drive letter without trailing backslash\n\tif (isWindows && candidate.endsWith(':')) {\n\t\tcandidate += sep;\n\t}\n\n\t// Ensure absolute\n\tif (!isAbsolute(candidate)) {\n\t\tcandidate = join(cwd, candidate);\n\t}\n\n\t// Ensure normalized\n\tcandidate = normalize(candidate);\n\n\t// Ensure no trailing slash/backslash\n\tif (isWindows) {\n\t\tcandidate = rtrim(candidate, sep);\n\n\t\t// Special case: allow to open drive root ('C:\\')\n\t\tif (candidate.endsWith(':')) {\n\t\t\tcandidate += sep;\n\t\t}\n\n\t} else {\n\t\tcandidate = rtrim(candidate, sep);\n\n\t\t// Special case: allow to open root ('/')\n\t\tif (!candidate) {\n\t\t\tcandidate = sep;\n\t\t}\n\t}\n\n\treturn candidate;\n}\n\nexport function isRootOrDriveLetter(path: string): boolean {\n\tconst pathNormalized = normalize(path);\n\n\tif (isWindows) {\n\t\tif (path.length > 3) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn hasDriveLetter(pathNormalized) &&\n\t\t\t(path.length === 2 || pathNormalized.charCodeAt(2) === CharCode.Backslash);\n\t}\n\n\treturn pathNormalized === posix.sep;\n}\n\nexport function hasDriveLetter(path: string, isWindowsOS: boolean = isWindows): boolean {\n\tif (isWindowsOS) {\n\t\treturn isWindowsDriveLetter(path.charCodeAt(0)) && path.charCodeAt(1) === CharCode.Colon;\n\t}\n\n\treturn false;\n}\n\nexport function getDriveLetter(path: string): string | undefined {\n\treturn hasDriveLetter(path) ? path[0] : undefined;\n}\n\nexport function indexOfPath(path: string, candidate: string, ignoreCase?: boolean): number {\n\tif (candidate.length > path.length) {\n\t\treturn -1;\n\t}\n\n\tif (path === candidate) {\n\t\treturn 0;\n\t}\n\n\tif (ignoreCase) {\n\t\tpath = path.toLowerCase();\n\t\tcandidate = candidate.toLowerCase();\n\t}\n\n\treturn path.indexOf(candidate);\n}\n\nexport interface IPathWithLineAndColumn {\n\tpath: string;\n\tline?: number;\n\tcolumn?: number;\n}\n\nexport function parseLineAndColumnAware(rawPath: string): IPathWithLineAndColumn {\n\tconst segments = rawPath.split(':'); // C:\\file.txt:<line>:<column>\n\n\tlet path: string | undefined = undefined;\n\tlet line: number | undefined = undefined;\n\tlet column: number | undefined = undefined;\n\n\tfor (const segment of segments) {\n\t\tconst segmentAsNumber = Number(segment);\n\t\tif (!isNumber(segmentAsNumber)) {\n\t\t\tpath = !!path ? [path, segment].join(':') : segment; // a colon can well be part of a path (e.g. C:\\...)\n\t\t} else if (line === undefined) {\n\t\t\tline = segmentAsNumber;\n\t\t} else if (column === undefined) {\n\t\t\tcolumn = segmentAsNumber;\n\t\t}\n\t}\n\n\tif (!path) {\n\t\tthrow new Error('Format for `--goto` should be: `FILE:LINE(:COLUMN)`');\n\t}\n\n\treturn {\n\t\tpath,\n\t\tline: line !== undefined ? line : undefined,\n\t\tcolumn: column !== undefined ? column : line !== undefined ? 1 : undefined // if we have a line, make sure column is also set\n\t};\n}\n\nconst pathChars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n\nexport function randomPath(parent?: string, prefix?: string, randomLength = 8): string {\n\tlet suffix = '';\n\tfor (let i = 0; i < randomLength; i++) {\n\t\tsuffix += pathChars.charAt(Math.floor(Math.random() * pathChars.length));\n\t}\n\n\tlet randomFileName: string;\n\tif (prefix) {\n\t\trandomFileName = `${prefix}-${suffix}`;\n\t} else {\n\t\trandomFileName = suffix;\n\t}\n\n\tif (parent) {\n\t\treturn join(parent, randomFileName);\n\t}\n\n\treturn randomFileName;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { shuffle } from 'vs/base/common/arrays';\nimport { CharCode } from 'vs/base/common/charCode';\nimport { compare, compareIgnoreCase, compareSubstring, compareSubstringIgnoreCase } from 'vs/base/common/strings';\nimport { URI } from 'vs/base/common/uri';\n\nexport function getOrSet<K, V>(map: Map<K, V>, key: K, value: V): V {\n\tlet result = map.get(key);\n\tif (result === undefined) {\n\t\tresult = value;\n\t\tmap.set(key, result);\n\t}\n\n\treturn result;\n}\n\nexport function mapToString<K, V>(map: Map<K, V>): string {\n\tconst entries: string[] = [];\n\tmap.forEach((value, key) => {\n\t\tentries.push(`${key} => ${value}`);\n\t});\n\n\treturn `Map(${map.size}) {${entries.join(', ')}}`;\n}\n\nexport function setToString<K>(set: Set<K>): string {\n\tconst entries: K[] = [];\n\tset.forEach(value => {\n\t\tentries.push(value);\n\t});\n\n\treturn `Set(${set.size}) {${entries.join(', ')}}`;\n}\n\nexport interface IKeyIterator<K> {\n\treset(key: K): this;\n\tnext(): this;\n\n\thasNext(): boolean;\n\tcmp(a: string): number;\n\tvalue(): string;\n}\n\nexport class StringIterator implements IKeyIterator<string> {\n\n\tprivate _value: string = '';\n\tprivate _pos: number = 0;\n\n\treset(key: string): this {\n\t\tthis._value = key;\n\t\tthis._pos = 0;\n\t\treturn this;\n\t}\n\n\tnext(): this {\n\t\tthis._pos += 1;\n\t\treturn this;\n\t}\n\n\thasNext(): boolean {\n\t\treturn this._pos < this._value.length - 1;\n\t}\n\n\tcmp(a: string): number {\n\t\tconst aCode = a.charCodeAt(0);\n\t\tconst thisCode = this._value.charCodeAt(this._pos);\n\t\treturn aCode - thisCode;\n\t}\n\n\tvalue(): string {\n\t\treturn this._value[this._pos];\n\t}\n}\n\nexport class ConfigKeysIterator implements IKeyIterator<string> {\n\n\tprivate _value!: string;\n\tprivate _from!: number;\n\tprivate _to!: number;\n\n\tconstructor(\n\t\tprivate readonly _caseSensitive: boolean = true\n\t) { }\n\n\treset(key: string): this {\n\t\tthis._value = key;\n\t\tthis._from = 0;\n\t\tthis._to = 0;\n\t\treturn this.next();\n\t}\n\n\thasNext(): boolean {\n\t\treturn this._to < this._value.length;\n\t}\n\n\tnext(): this {\n\t\t// this._data = key.split(/[\\\\/]/).filter(s => !!s);\n\t\tthis._from = this._to;\n\t\tlet justSeps = true;\n\t\tfor (; this._to < this._value.length; this._to++) {\n\t\t\tconst ch = this._value.charCodeAt(this._to);\n\t\t\tif (ch === CharCode.Period) {\n\t\t\t\tif (justSeps) {\n\t\t\t\t\tthis._from++;\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tjustSeps = false;\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\tcmp(a: string): number {\n\t\treturn this._caseSensitive\n\t\t\t? compareSubstring(a, this._value, 0, a.length, this._from, this._to)\n\t\t\t: compareSubstringIgnoreCase(a, this._value, 0, a.length, this._from, this._to);\n\t}\n\n\tvalue(): string {\n\t\treturn this._value.substring(this._from, this._to);\n\t}\n}\n\nexport class PathIterator implements IKeyIterator<string> {\n\n\tprivate _value!: string;\n\tprivate _valueLen!: number;\n\tprivate _from!: number;\n\tprivate _to!: number;\n\n\tconstructor(\n\t\tprivate readonly _splitOnBackslash: boolean = true,\n\t\tprivate readonly _caseSensitive: boolean = true\n\t) { }\n\n\treset(key: string): this {\n\t\tthis._from = 0;\n\t\tthis._to = 0;\n\t\tthis._value = key;\n\t\tthis._valueLen = key.length;\n\t\tfor (let pos = key.length - 1; pos >= 0; pos--, this._valueLen--) {\n\t\t\tconst ch = this._value.charCodeAt(pos);\n\t\t\tif (!(ch === CharCode.Slash || this._splitOnBackslash && ch === CharCode.Backslash)) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn this.next();\n\t}\n\n\thasNext(): boolean {\n\t\treturn this._to < this._valueLen;\n\t}\n\n\tnext(): this {\n\t\t// this._data = key.split(/[\\\\/]/).filter(s => !!s);\n\t\tthis._from = this._to;\n\t\tlet justSeps = true;\n\t\tfor (; this._to < this._valueLen; this._to++) {\n\t\t\tconst ch = this._value.charCodeAt(this._to);\n\t\t\tif (ch === CharCode.Slash || this._splitOnBackslash && ch === CharCode.Backslash) {\n\t\t\t\tif (justSeps) {\n\t\t\t\t\tthis._from++;\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tjustSeps = false;\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\tcmp(a: string): number {\n\t\treturn this._caseSensitive\n\t\t\t? compareSubstring(a, this._value, 0, a.length, this._from, this._to)\n\t\t\t: compareSubstringIgnoreCase(a, this._value, 0, a.length, this._from, this._to);\n\t}\n\n\tvalue(): string {\n\t\treturn this._value.substring(this._from, this._to);\n\t}\n}\n\nconst enum UriIteratorState {\n\tScheme = 1, Authority = 2, Path = 3, Query = 4, Fragment = 5\n}\n\nexport class UriIterator implements IKeyIterator<URI> {\n\n\tprivate _pathIterator!: PathIterator;\n\tprivate _value!: URI;\n\tprivate _states: UriIteratorState[] = [];\n\tprivate _stateIdx: number = 0;\n\n\tconstructor(\n\t\tprivate readonly _ignorePathCasing: (uri: URI) => boolean,\n\t\tprivate readonly _ignoreQueryAndFragment: (uri: URI) => boolean) { }\n\n\treset(key: URI): this {\n\t\tthis._value = key;\n\t\tthis._states = [];\n\t\tif (this._value.scheme) {\n\t\t\tthis._states.push(UriIteratorState.Scheme);\n\t\t}\n\t\tif (this._value.authority) {\n\t\t\tthis._states.push(UriIteratorState.Authority);\n\t\t}\n\t\tif (this._value.path) {\n\t\t\tthis._pathIterator = new PathIterator(false, !this._ignorePathCasing(key));\n\t\t\tthis._pathIterator.reset(key.path);\n\t\t\tif (this._pathIterator.value()) {\n\t\t\t\tthis._states.push(UriIteratorState.Path);\n\t\t\t}\n\t\t}\n\t\tif (!this._ignoreQueryAndFragment(key)) {\n\t\t\tif (this._value.query) {\n\t\t\t\tthis._states.push(UriIteratorState.Query);\n\t\t\t}\n\t\t\tif (this._value.fragment) {\n\t\t\t\tthis._states.push(UriIteratorState.Fragment);\n\t\t\t}\n\t\t}\n\t\tthis._stateIdx = 0;\n\t\treturn this;\n\t}\n\n\tnext(): this {\n\t\tif (this._states[this._stateIdx] === UriIteratorState.Path && this._pathIterator.hasNext()) {\n\t\t\tthis._pathIterator.next();\n\t\t} else {\n\t\t\tthis._stateIdx += 1;\n\t\t}\n\t\treturn this;\n\t}\n\n\thasNext(): boolean {\n\t\treturn (this._states[this._stateIdx] === UriIteratorState.Path && this._pathIterator.hasNext())\n\t\t\t|| this._stateIdx < this._states.length - 1;\n\t}\n\n\tcmp(a: string): number {\n\t\tif (this._states[this._stateIdx] === UriIteratorState.Scheme) {\n\t\t\treturn compareIgnoreCase(a, this._value.scheme);\n\t\t} else if (this._states[this._stateIdx] === UriIteratorState.Authority) {\n\t\t\treturn compareIgnoreCase(a, this._value.authority);\n\t\t} else if (this._states[this._stateIdx] === UriIteratorState.Path) {\n\t\t\treturn this._pathIterator.cmp(a);\n\t\t} else if (this._states[this._stateIdx] === UriIteratorState.Query) {\n\t\t\treturn compare(a, this._value.query);\n\t\t} else if (this._states[this._stateIdx] === UriIteratorState.Fragment) {\n\t\t\treturn compare(a, this._value.fragment);\n\t\t}\n\t\tthrow new Error();\n\t}\n\n\tvalue(): string {\n\t\tif (this._states[this._stateIdx] === UriIteratorState.Scheme) {\n\t\t\treturn this._value.scheme;\n\t\t} else if (this._states[this._stateIdx] === UriIteratorState.Authority) {\n\t\t\treturn this._value.authority;\n\t\t} else if (this._states[this._stateIdx] === UriIteratorState.Path) {\n\t\t\treturn this._pathIterator.value();\n\t\t} else if (this._states[this._stateIdx] === UriIteratorState.Query) {\n\t\t\treturn this._value.query;\n\t\t} else if (this._states[this._stateIdx] === UriIteratorState.Fragment) {\n\t\t\treturn this._value.fragment;\n\t\t}\n\t\tthrow new Error();\n\t}\n}\n\nclass TernarySearchTreeNode<K, V> {\n\theight: number = 1;\n\tsegment!: string;\n\tvalue: V | undefined;\n\tkey: K | undefined;\n\tleft: TernarySearchTreeNode<K, V> | undefined;\n\tmid: TernarySearchTreeNode<K, V> | undefined;\n\tright: TernarySearchTreeNode<K, V> | undefined;\n\n\tisEmpty(): boolean {\n\t\treturn !this.left && !this.mid && !this.right && !this.value;\n\t}\n\n\trotateLeft() {\n\t\tconst tmp = this.right!;\n\t\tthis.right = tmp.left;\n\t\ttmp.left = this;\n\t\tthis.updateHeight();\n\t\ttmp.updateHeight();\n\t\treturn tmp;\n\t}\n\n\trotateRight() {\n\t\tconst tmp = this.left!;\n\t\tthis.left = tmp.right;\n\t\ttmp.right = this;\n\t\tthis.updateHeight();\n\t\ttmp.updateHeight();\n\t\treturn tmp;\n\t}\n\n\tupdateHeight() {\n\t\tthis.height = 1 + Math.max(this.heightLeft, this.heightRight);\n\t}\n\n\tbalanceFactor() {\n\t\treturn this.heightRight - this.heightLeft;\n\t}\n\n\tget heightLeft() {\n\t\treturn this.left?.height ?? 0;\n\t}\n\n\tget heightRight() {\n\t\treturn this.right?.height ?? 0;\n\t}\n}\n\nconst enum Dir {\n\tLeft = -1,\n\tMid = 0,\n\tRight = 1,\n}\n\nexport class TernarySearchTree<K, V> {\n\n\tstatic forUris<E>(ignorePathCasing: (key: URI) => boolean = () => false, ignoreQueryAndFragment: (key: URI) => boolean = () => false): TernarySearchTree<URI, E> {\n\t\treturn new TernarySearchTree<URI, E>(new UriIterator(ignorePathCasing, ignoreQueryAndFragment));\n\t}\n\n\tstatic forPaths<E>(ignorePathCasing = false): TernarySearchTree<string, E> {\n\t\treturn new TernarySearchTree<string, E>(new PathIterator(undefined, !ignorePathCasing));\n\t}\n\n\tstatic forStrings<E>(): TernarySearchTree<string, E> {\n\t\treturn new TernarySearchTree<string, E>(new StringIterator());\n\t}\n\n\tstatic forConfigKeys<E>(): TernarySearchTree<string, E> {\n\t\treturn new TernarySearchTree<string, E>(new ConfigKeysIterator());\n\t}\n\n\tprivate _iter: IKeyIterator<K>;\n\tprivate _root: TernarySearchTreeNode<K, V> | undefined;\n\n\tconstructor(segments: IKeyIterator<K>) {\n\t\tthis._iter = segments;\n\t}\n\n\tclear(): void {\n\t\tthis._root = undefined;\n\t}\n\n\t/**\n\t * Fill the tree with the same value of the given keys\n\t */\n\tfill(element: V, keys: readonly K[]): void;\n\t/**\n\t * Fill the tree with given [key,value]-tuples\n\t */\n\tfill(values: readonly [K, V][]): void;\n\tfill(values: readonly [K, V][] | V, keys?: readonly K[]): void {\n\t\tif (keys) {\n\t\t\tconst arr = keys.slice(0);\n\t\t\tshuffle(arr);\n\t\t\tfor (const k of arr) {\n\t\t\t\tthis.set(k, (<V>values));\n\t\t\t}\n\t\t} else {\n\t\t\tconst arr = (<[K, V][]>values).slice(0);\n\t\t\tshuffle(arr);\n\t\t\tfor (const entry of arr) {\n\t\t\t\tthis.set(entry[0], entry[1]);\n\t\t\t}\n\t\t}\n\t}\n\n\tset(key: K, element: V): V | undefined {\n\t\tconst iter = this._iter.reset(key);\n\t\tlet node: TernarySearchTreeNode<K, V>;\n\n\t\tif (!this._root) {\n\t\t\tthis._root = new TernarySearchTreeNode<K, V>();\n\t\t\tthis._root.segment = iter.value();\n\t\t}\n\t\tconst stack: [Dir, TernarySearchTreeNode<K, V>][] = [];\n\n\t\t// find insert_node\n\t\tnode = this._root;\n\t\twhile (true) {\n\t\t\tconst val = iter.cmp(node.segment);\n\t\t\tif (val > 0) {\n\t\t\t\t// left\n\t\t\t\tif (!node.left) {\n\t\t\t\t\tnode.left = new TernarySearchTreeNode<K, V>();\n\t\t\t\t\tnode.left.segment = iter.value();\n\t\t\t\t}\n\t\t\t\tstack.push([Dir.Left, node]);\n\t\t\t\tnode = node.left;\n\n\t\t\t} else if (val < 0) {\n\t\t\t\t// right\n\t\t\t\tif (!node.right) {\n\t\t\t\t\tnode.right = new TernarySearchTreeNode<K, V>();\n\t\t\t\t\tnode.right.segment = iter.value();\n\t\t\t\t}\n\t\t\t\tstack.push([Dir.Right, node]);\n\t\t\t\tnode = node.right;\n\n\t\t\t} else if (iter.hasNext()) {\n\t\t\t\t// mid\n\t\t\t\titer.next();\n\t\t\t\tif (!node.mid) {\n\t\t\t\t\tnode.mid = new TernarySearchTreeNode<K, V>();\n\t\t\t\t\tnode.mid.segment = iter.value();\n\t\t\t\t}\n\t\t\t\tstack.push([Dir.Mid, node]);\n\t\t\t\tnode = node.mid;\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\t// set value\n\t\tconst oldElement = node.value;\n\t\tnode.value = element;\n\t\tnode.key = key;\n\n\t\t// balance\n\t\tfor (let i = stack.length - 1; i >= 0; i--) {\n\t\t\tconst node = stack[i][1];\n\n\t\t\tnode.updateHeight();\n\t\t\tconst bf = node.balanceFactor();\n\n\t\t\tif (bf < -1 || bf > 1) {\n\t\t\t\t// needs rotate\n\t\t\t\tconst d1 = stack[i][0];\n\t\t\t\tconst d2 = stack[i + 1][0];\n\n\t\t\t\tif (d1 === Dir.Right && d2 === Dir.Right) {\n\t\t\t\t\t//right, right -> rotate left\n\t\t\t\t\tstack[i][1] = node.rotateLeft();\n\n\t\t\t\t} else if (d1 === Dir.Left && d2 === Dir.Left) {\n\t\t\t\t\t// left, left -> rotate right\n\t\t\t\t\tstack[i][1] = node.rotateRight();\n\n\t\t\t\t} else if (d1 === Dir.Right && d2 === Dir.Left) {\n\t\t\t\t\t// right, left -> double rotate right, left\n\t\t\t\t\tnode.right = stack[i + 1][1] = stack[i + 1][1].rotateRight();\n\t\t\t\t\tstack[i][1] = node.rotateLeft();\n\n\t\t\t\t} else if (d1 === Dir.Left && d2 === Dir.Right) {\n\t\t\t\t\t// left, right -> double rotate left, right\n\t\t\t\t\tnode.left = stack[i + 1][1] = stack[i + 1][1].rotateLeft();\n\t\t\t\t\tstack[i][1] = node.rotateRight();\n\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error();\n\t\t\t\t}\n\n\t\t\t\t// patch path to parent\n\t\t\t\tif (i > 0) {\n\t\t\t\t\tswitch (stack[i - 1][0]) {\n\t\t\t\t\t\tcase Dir.Left:\n\t\t\t\t\t\t\tstack[i - 1][1].left = stack[i][1];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase Dir.Right:\n\t\t\t\t\t\t\tstack[i - 1][1].right = stack[i][1];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase Dir.Mid:\n\t\t\t\t\t\t\tstack[i - 1][1].mid = stack[i][1];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis._root = stack[0][1];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn oldElement;\n\t}\n\n\tget(key: K): V | undefined {\n\t\treturn this._getNode(key)?.value;\n\t}\n\n\tprivate _getNode(key: K) {\n\t\tconst iter = this._iter.reset(key);\n\t\tlet node = this._root;\n\t\twhile (node) {\n\t\t\tconst val = iter.cmp(node.segment);\n\t\t\tif (val > 0) {\n\t\t\t\t// left\n\t\t\t\tnode = node.left;\n\t\t\t} else if (val < 0) {\n\t\t\t\t// right\n\t\t\t\tnode = node.right;\n\t\t\t} else if (iter.hasNext()) {\n\t\t\t\t// mid\n\t\t\t\titer.next();\n\t\t\t\tnode = node.mid;\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn node;\n\t}\n\n\thas(key: K): boolean {\n\t\tconst node = this._getNode(key);\n\t\treturn !(node?.value === undefined && node?.mid === undefined);\n\t}\n\n\tdelete(key: K): void {\n\t\treturn this._delete(key, false);\n\t}\n\n\tdeleteSuperstr(key: K): void {\n\t\treturn this._delete(key, true);\n\t}\n\n\tprivate _delete(key: K, superStr: boolean): void {\n\t\tconst iter = this._iter.reset(key);\n\t\tconst stack: [Dir, TernarySearchTreeNode<K, V>][] = [];\n\t\tlet node = this._root;\n\n\t\t// find node\n\t\twhile (node) {\n\t\t\tconst val = iter.cmp(node.segment);\n\t\t\tif (val > 0) {\n\t\t\t\t// left\n\t\t\t\tstack.push([Dir.Left, node]);\n\t\t\t\tnode = node.left;\n\t\t\t} else if (val < 0) {\n\t\t\t\t// right\n\t\t\t\tstack.push([Dir.Right, node]);\n\t\t\t\tnode = node.right;\n\t\t\t} else if (iter.hasNext()) {\n\t\t\t\t// mid\n\t\t\t\titer.next();\n\t\t\t\tstack.push([Dir.Mid, node]);\n\t\t\t\tnode = node.mid;\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (!node) {\n\t\t\t// node not found\n\t\t\treturn;\n\t\t}\n\n\t\tif (superStr) {\n\t\t\t// removing children, reset height\n\t\t\tnode.left = undefined;\n\t\t\tnode.mid = undefined;\n\t\t\tnode.right = undefined;\n\t\t\tnode.height = 1;\n\t\t} else {\n\t\t\t// removing element\n\t\t\tnode.key = undefined;\n\t\t\tnode.value = undefined;\n\t\t}\n\n\t\t// BST node removal\n\t\tif (!node.mid && !node.value) {\n\t\t\tif (node.left && node.right) {\n\t\t\t\t// full node\n\t\t\t\tconst min = this._min(node.right);\n\t\t\t\tconst { key, value, segment } = min;\n\t\t\t\tthis._delete(min.key!, false);\n\t\t\t\tnode.key = key;\n\t\t\t\tnode.value = value;\n\t\t\t\tnode.segment = segment;\n\n\t\t\t} else {\n\t\t\t\t// empty or half empty\n\t\t\t\tconst newChild = node.left ?? node.right;\n\t\t\t\tif (stack.length > 0) {\n\t\t\t\t\tconst [dir, parent] = stack[stack.length - 1];\n\t\t\t\t\tswitch (dir) {\n\t\t\t\t\t\tcase Dir.Left: parent.left = newChild; break;\n\t\t\t\t\t\tcase Dir.Mid: parent.mid = newChild; break;\n\t\t\t\t\t\tcase Dir.Right: parent.right = newChild; break;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis._root = newChild;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// AVL balance\n\t\tfor (let i = stack.length - 1; i >= 0; i--) {\n\t\t\tconst node = stack[i][1];\n\n\t\t\tnode.updateHeight();\n\t\t\tconst bf = node.balanceFactor();\n\t\t\tif (bf > 1) {\n\t\t\t\t// right heavy\n\t\t\t\tif (node.right!.balanceFactor() >= 0) {\n\t\t\t\t\t// right, right -> rotate left\n\t\t\t\t\tstack[i][1] = node.rotateLeft();\n\t\t\t\t} else {\n\t\t\t\t\t// right, left -> double rotate\n\t\t\t\t\tnode.right = node.right!.rotateRight();\n\t\t\t\t\tstack[i][1] = node.rotateLeft();\n\t\t\t\t}\n\n\t\t\t} else if (bf < -1) {\n\t\t\t\t// left heavy\n\t\t\t\tif (node.left!.balanceFactor() <= 0) {\n\t\t\t\t\t// left, left -> rotate right\n\t\t\t\t\tstack[i][1] = node.rotateRight();\n\t\t\t\t} else {\n\t\t\t\t\t// left, right -> double rotate\n\t\t\t\t\tnode.left = node.left!.rotateLeft();\n\t\t\t\t\tstack[i][1] = node.rotateRight();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// patch path to parent\n\t\t\tif (i > 0) {\n\t\t\t\tswitch (stack[i - 1][0]) {\n\t\t\t\t\tcase Dir.Left:\n\t\t\t\t\t\tstack[i - 1][1].left = stack[i][1];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase Dir.Right:\n\t\t\t\t\t\tstack[i - 1][1].right = stack[i][1];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase Dir.Mid:\n\t\t\t\t\t\tstack[i - 1][1].mid = stack[i][1];\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._root = stack[0][1];\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _min(node: TernarySearchTreeNode<K, V>): TernarySearchTreeNode<K, V> {\n\t\twhile (node.left) {\n\t\t\tnode = node.left;\n\t\t}\n\t\treturn node;\n\t}\n\n\tfindSubstr(key: K): V | undefined {\n\t\tconst iter = this._iter.reset(key);\n\t\tlet node = this._root;\n\t\tlet candidate: V | undefined = undefined;\n\t\twhile (node) {\n\t\t\tconst val = iter.cmp(node.segment);\n\t\t\tif (val > 0) {\n\t\t\t\t// left\n\t\t\t\tnode = node.left;\n\t\t\t} else if (val < 0) {\n\t\t\t\t// right\n\t\t\t\tnode = node.right;\n\t\t\t} else if (iter.hasNext()) {\n\t\t\t\t// mid\n\t\t\t\titer.next();\n\t\t\t\tcandidate = node.value || candidate;\n\t\t\t\tnode = node.mid;\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn node && node.value || candidate;\n\t}\n\n\tfindSuperstr(key: K): IterableIterator<[K, V]> | undefined {\n\t\tconst iter = this._iter.reset(key);\n\t\tlet node = this._root;\n\t\twhile (node) {\n\t\t\tconst val = iter.cmp(node.segment);\n\t\t\tif (val > 0) {\n\t\t\t\t// left\n\t\t\t\tnode = node.left;\n\t\t\t} else if (val < 0) {\n\t\t\t\t// right\n\t\t\t\tnode = node.right;\n\t\t\t} else if (iter.hasNext()) {\n\t\t\t\t// mid\n\t\t\t\titer.next();\n\t\t\t\tnode = node.mid;\n\t\t\t} else {\n\t\t\t\t// collect\n\t\t\t\tif (!node.mid) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t} else {\n\t\t\t\t\treturn this._entries(node.mid);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tforEach(callback: (value: V, index: K) => any): void {\n\t\tfor (const [key, value] of this) {\n\t\t\tcallback(value, key);\n\t\t}\n\t}\n\n\t*[Symbol.iterator](): IterableIterator<[K, V]> {\n\t\tyield* this._entries(this._root);\n\t}\n\n\tprivate _entries(node: TernarySearchTreeNode<K, V> | undefined): IterableIterator<[K, V]> {\n\t\tconst result: [K, V][] = [];\n\t\tthis._dfsEntries(node, result);\n\t\treturn result[Symbol.iterator]();\n\t}\n\n\tprivate _dfsEntries(node: TernarySearchTreeNode<K, V> | undefined, bucket: [K, V][]) {\n\t\t// DFS\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\t\tif (node.left) {\n\t\t\tthis._dfsEntries(node.left, bucket);\n\t\t}\n\t\tif (node.value) {\n\t\t\tbucket.push([node.key!, node.value]);\n\t\t}\n\t\tif (node.mid) {\n\t\t\tthis._dfsEntries(node.mid, bucket);\n\t\t}\n\t\tif (node.right) {\n\t\t\tthis._dfsEntries(node.right, bucket);\n\t\t}\n\t}\n\n\t// for debug/testing\n\t_isBalanced(): boolean {\n\t\tconst nodeIsBalanced = (node: TernarySearchTreeNode<any, any> | undefined): boolean => {\n\t\t\tif (!node) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tconst bf = node.balanceFactor();\n\t\t\tif (bf < -1 || bf > 1) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn nodeIsBalanced(node.left) && nodeIsBalanced(node.right);\n\t\t};\n\t\treturn nodeIsBalanced(this._root);\n\t}\n}\n\ninterface ResourceMapKeyFn {\n\t(resource: URI): string;\n}\n\nclass ResourceMapEntry<T> {\n\tconstructor(readonly uri: URI, readonly value: T) { }\n}\n\nexport class ResourceMap<T> implements Map<URI, T> {\n\n\tprivate static readonly defaultToKey = (resource: URI) => resource.toString();\n\n\treadonly [Symbol.toStringTag] = 'ResourceMap';\n\n\tprivate readonly map: Map<string, ResourceMapEntry<T>>;\n\tprivate readonly toKey: ResourceMapKeyFn;\n\n\t/**\n\t *\n\t * @param toKey Custom uri identity function, e.g use an existing `IExtUri#getComparison`-util\n\t */\n\tconstructor(toKey?: ResourceMapKeyFn);\n\n\t/**\n\t *\n\t * @param other Another resource which this maps is created from\n\t * @param toKey Custom uri identity function, e.g use an existing `IExtUri#getComparison`-util\n\t */\n\tconstructor(other?: ResourceMap<T>, toKey?: ResourceMapKeyFn);\n\n\tconstructor(mapOrKeyFn?: ResourceMap<T> | ResourceMapKeyFn, toKey?: ResourceMapKeyFn) {\n\t\tif (mapOrKeyFn instanceof ResourceMap) {\n\t\t\tthis.map = new Map(mapOrKeyFn.map);\n\t\t\tthis.toKey = toKey ?? ResourceMap.defaultToKey;\n\t\t} else {\n\t\t\tthis.map = new Map();\n\t\t\tthis.toKey = mapOrKeyFn ?? ResourceMap.defaultToKey;\n\t\t}\n\t}\n\n\tset(resource: URI, value: T): this {\n\t\tthis.map.set(this.toKey(resource), new ResourceMapEntry(resource, value));\n\t\treturn this;\n\t}\n\n\tget(resource: URI): T | undefined {\n\t\treturn this.map.get(this.toKey(resource))?.value;\n\t}\n\n\thas(resource: URI): boolean {\n\t\treturn this.map.has(this.toKey(resource));\n\t}\n\n\tget size(): number {\n\t\treturn this.map.size;\n\t}\n\n\tclear(): void {\n\t\tthis.map.clear();\n\t}\n\n\tdelete(resource: URI): boolean {\n\t\treturn this.map.delete(this.toKey(resource));\n\t}\n\n\tforEach(clb: (value: T, key: URI, map: Map<URI, T>) => void, thisArg?: any): void {\n\t\tif (typeof thisArg !== 'undefined') {\n\t\t\tclb = clb.bind(thisArg);\n\t\t}\n\t\tfor (const [_, entry] of this.map) {\n\t\t\tclb(entry.value, entry.uri, <any>this);\n\t\t}\n\t}\n\n\t*values(): IterableIterator<T> {\n\t\tfor (const entry of this.map.values()) {\n\t\t\tyield entry.value;\n\t\t}\n\t}\n\n\t*keys(): IterableIterator<URI> {\n\t\tfor (const entry of this.map.values()) {\n\t\t\tyield entry.uri;\n\t\t}\n\t}\n\n\t*entries(): IterableIterator<[URI, T]> {\n\t\tfor (const entry of this.map.values()) {\n\t\t\tyield [entry.uri, entry.value];\n\t\t}\n\t}\n\n\t*[Symbol.iterator](): IterableIterator<[URI, T]> {\n\t\tfor (const [, entry] of this.map) {\n\t\t\tyield [entry.uri, entry.value];\n\t\t}\n\t}\n}\n\nexport class ResourceSet implements Set<URI> {\n\n\treadonly [Symbol.toStringTag]: string = 'ResourceSet';\n\n\tprivate readonly _map: ResourceMap<URI>;\n\n\tconstructor(toKey?: ResourceMapKeyFn);\n\tconstructor(entries: readonly URI[], toKey?: ResourceMapKeyFn);\n\tconstructor(entriesOrKey?: readonly URI[] | ResourceMapKeyFn, toKey?: ResourceMapKeyFn) {\n\t\tif (!entriesOrKey || typeof entriesOrKey === 'function') {\n\t\t\tthis._map = new ResourceMap(entriesOrKey);\n\t\t} else {\n\t\t\tthis._map = new ResourceMap(toKey);\n\t\t\tentriesOrKey.forEach(this.add, this);\n\t\t}\n\t}\n\n\n\tget size(): number {\n\t\treturn this._map.size;\n\t}\n\n\tadd(value: URI): this {\n\t\tthis._map.set(value, value);\n\t\treturn this;\n\t}\n\n\tclear(): void {\n\t\tthis._map.clear();\n\t}\n\n\tdelete(value: URI): boolean {\n\t\treturn this._map.delete(value);\n\t}\n\n\tforEach(callbackfn: (value: URI, value2: URI, set: Set<URI>) => void, thisArg?: any): void {\n\t\tthis._map.forEach((_value, key) => callbackfn.call(thisArg, key, key, this));\n\t}\n\n\thas(value: URI): boolean {\n\t\treturn this._map.has(value);\n\t}\n\n\tentries(): IterableIterator<[URI, URI]> {\n\t\treturn this._map.entries();\n\t}\n\n\tkeys(): IterableIterator<URI> {\n\t\treturn this._map.keys();\n\t}\n\n\tvalues(): IterableIterator<URI> {\n\t\treturn this._map.keys();\n\t}\n\n\t[Symbol.iterator](): IterableIterator<URI> {\n\t\treturn this.keys();\n\t}\n}\n\n\ninterface Item<K, V> {\n\tprevious: Item<K, V> | undefined;\n\tnext: Item<K, V> | undefined;\n\tkey: K;\n\tvalue: V;\n}\n\nexport const enum Touch {\n\tNone = 0,\n\tAsOld = 1,\n\tAsNew = 2\n}\n\nexport class LinkedMap<K, V> implements Map<K, V> {\n\n\treadonly [Symbol.toStringTag] = 'LinkedMap';\n\n\tprivate _map: Map<K, Item<K, V>>;\n\tprivate _head: Item<K, V> | undefined;\n\tprivate _tail: Item<K, V> | undefined;\n\tprivate _size: number;\n\n\tprivate _state: number;\n\n\tconstructor() {\n\t\tthis._map = new Map<K, Item<K, V>>();\n\t\tthis._head = undefined;\n\t\tthis._tail = undefined;\n\t\tthis._size = 0;\n\t\tthis._state = 0;\n\t}\n\n\tclear(): void {\n\t\tthis._map.clear();\n\t\tthis._head = undefined;\n\t\tthis._tail = undefined;\n\t\tthis._size = 0;\n\t\tthis._state++;\n\t}\n\n\tisEmpty(): boolean {\n\t\treturn !this._head && !this._tail;\n\t}\n\n\tget size(): number {\n\t\treturn this._size;\n\t}\n\n\tget first(): V | undefined {\n\t\treturn this._head?.value;\n\t}\n\n\tget last(): V | undefined {\n\t\treturn this._tail?.value;\n\t}\n\n\thas(key: K): boolean {\n\t\treturn this._map.has(key);\n\t}\n\n\tget(key: K, touch: Touch = Touch.None): V | undefined {\n\t\tconst item = this._map.get(key);\n\t\tif (!item) {\n\t\t\treturn undefined;\n\t\t}\n\t\tif (touch !== Touch.None) {\n\t\t\tthis.touch(item, touch);\n\t\t}\n\t\treturn item.value;\n\t}\n\n\tset(key: K, value: V, touch: Touch = Touch.None): this {\n\t\tlet item = this._map.get(key);\n\t\tif (item) {\n\t\t\titem.value = value;\n\t\t\tif (touch !== Touch.None) {\n\t\t\t\tthis.touch(item, touch);\n\t\t\t}\n\t\t} else {\n\t\t\titem = { key, value, next: undefined, previous: undefined };\n\t\t\tswitch (touch) {\n\t\t\t\tcase Touch.None:\n\t\t\t\t\tthis.addItemLast(item);\n\t\t\t\t\tbreak;\n\t\t\t\tcase Touch.AsOld:\n\t\t\t\t\tthis.addItemFirst(item);\n\t\t\t\t\tbreak;\n\t\t\t\tcase Touch.AsNew:\n\t\t\t\t\tthis.addItemLast(item);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthis.addItemLast(item);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tthis._map.set(key, item);\n\t\t\tthis._size++;\n\t\t}\n\t\treturn this;\n\t}\n\n\tdelete(key: K): boolean {\n\t\treturn !!this.remove(key);\n\t}\n\n\tremove(key: K): V | undefined {\n\t\tconst item = this._map.get(key);\n\t\tif (!item) {\n\t\t\treturn undefined;\n\t\t}\n\t\tthis._map.delete(key);\n\t\tthis.removeItem(item);\n\t\tthis._size--;\n\t\treturn item.value;\n\t}\n\n\tshift(): V | undefined {\n\t\tif (!this._head && !this._tail) {\n\t\t\treturn undefined;\n\t\t}\n\t\tif (!this._head || !this._tail) {\n\t\t\tthrow new Error('Invalid list');\n\t\t}\n\t\tconst item = this._head;\n\t\tthis._map.delete(item.key);\n\t\tthis.removeItem(item);\n\t\tthis._size--;\n\t\treturn item.value;\n\t}\n\n\tforEach(callbackfn: (value: V, key: K, map: LinkedMap<K, V>) => void, thisArg?: any): void {\n\t\tconst state = this._state;\n\t\tlet current = this._head;\n\t\twhile (current) {\n\t\t\tif (thisArg) {\n\t\t\t\tcallbackfn.bind(thisArg)(current.value, current.key, this);\n\t\t\t} else {\n\t\t\t\tcallbackfn(current.value, current.key, this);\n\t\t\t}\n\t\t\tif (this._state !== state) {\n\t\t\t\tthrow new Error(`LinkedMap got modified during iteration.`);\n\t\t\t}\n\t\t\tcurrent = current.next;\n\t\t}\n\t}\n\n\tkeys(): IterableIterator<K> {\n\t\tconst map = this;\n\t\tconst state = this._state;\n\t\tlet current = this._head;\n\t\tconst iterator: IterableIterator<K> = {\n\t\t\t[Symbol.iterator]() {\n\t\t\t\treturn iterator;\n\t\t\t},\n\t\t\tnext(): IteratorResult<K> {\n\t\t\t\tif (map._state !== state) {\n\t\t\t\t\tthrow new Error(`LinkedMap got modified during iteration.`);\n\t\t\t\t}\n\t\t\t\tif (current) {\n\t\t\t\t\tconst result = { value: current.key, done: false };\n\t\t\t\t\tcurrent = current.next;\n\t\t\t\t\treturn result;\n\t\t\t\t} else {\n\t\t\t\t\treturn { value: undefined, done: true };\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\treturn iterator;\n\t}\n\n\tvalues(): IterableIterator<V> {\n\t\tconst map = this;\n\t\tconst state = this._state;\n\t\tlet current = this._head;\n\t\tconst iterator: IterableIterator<V> = {\n\t\t\t[Symbol.iterator]() {\n\t\t\t\treturn iterator;\n\t\t\t},\n\t\t\tnext(): IteratorResult<V> {\n\t\t\t\tif (map._state !== state) {\n\t\t\t\t\tthrow new Error(`LinkedMap got modified during iteration.`);\n\t\t\t\t}\n\t\t\t\tif (current) {\n\t\t\t\t\tconst result = { value: current.value, done: false };\n\t\t\t\t\tcurrent = current.next;\n\t\t\t\t\treturn result;\n\t\t\t\t} else {\n\t\t\t\t\treturn { value: undefined, done: true };\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\treturn iterator;\n\t}\n\n\tentries(): IterableIterator<[K, V]> {\n\t\tconst map = this;\n\t\tconst state = this._state;\n\t\tlet current = this._head;\n\t\tconst iterator: IterableIterator<[K, V]> = {\n\t\t\t[Symbol.iterator]() {\n\t\t\t\treturn iterator;\n\t\t\t},\n\t\t\tnext(): IteratorResult<[K, V]> {\n\t\t\t\tif (map._state !== state) {\n\t\t\t\t\tthrow new Error(`LinkedMap got modified during iteration.`);\n\t\t\t\t}\n\t\t\t\tif (current) {\n\t\t\t\t\tconst result: IteratorResult<[K, V]> = { value: [current.key, current.value], done: false };\n\t\t\t\t\tcurrent = current.next;\n\t\t\t\t\treturn result;\n\t\t\t\t} else {\n\t\t\t\t\treturn { value: undefined, done: true };\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\treturn iterator;\n\t}\n\n\t[Symbol.iterator](): IterableIterator<[K, V]> {\n\t\treturn this.entries();\n\t}\n\n\tprotected trimOld(newSize: number) {\n\t\tif (newSize >= this.size) {\n\t\t\treturn;\n\t\t}\n\t\tif (newSize === 0) {\n\t\t\tthis.clear();\n\t\t\treturn;\n\t\t}\n\t\tlet current = this._head;\n\t\tlet currentSize = this.size;\n\t\twhile (current && currentSize > newSize) {\n\t\t\tthis._map.delete(current.key);\n\t\t\tcurrent = current.next;\n\t\t\tcurrentSize--;\n\t\t}\n\t\tthis._head = current;\n\t\tthis._size = currentSize;\n\t\tif (current) {\n\t\t\tcurrent.previous = undefined;\n\t\t}\n\t\tthis._state++;\n\t}\n\n\tprivate addItemFirst(item: Item<K, V>): void {\n\t\t// First time Insert\n\t\tif (!this._head && !this._tail) {\n\t\t\tthis._tail = item;\n\t\t} else if (!this._head) {\n\t\t\tthrow new Error('Invalid list');\n\t\t} else {\n\t\t\titem.next = this._head;\n\t\t\tthis._head.previous = item;\n\t\t}\n\t\tthis._head = item;\n\t\tthis._state++;\n\t}\n\n\tprivate addItemLast(item: Item<K, V>): void {\n\t\t// First time Insert\n\t\tif (!this._head && !this._tail) {\n\t\t\tthis._head = item;\n\t\t} else if (!this._tail) {\n\t\t\tthrow new Error('Invalid list');\n\t\t} else {\n\t\t\titem.previous = this._tail;\n\t\t\tthis._tail.next = item;\n\t\t}\n\t\tthis._tail = item;\n\t\tthis._state++;\n\t}\n\n\tprivate removeItem(item: Item<K, V>): void {\n\t\tif (item === this._head && item === this._tail) {\n\t\t\tthis._head = undefined;\n\t\t\tthis._tail = undefined;\n\t\t}\n\t\telse if (item === this._head) {\n\t\t\t// This can only happen if size === 1 which is handled\n\t\t\t// by the case above.\n\t\t\tif (!item.next) {\n\t\t\t\tthrow new Error('Invalid list');\n\t\t\t}\n\t\t\titem.next.previous = undefined;\n\t\t\tthis._head = item.next;\n\t\t}\n\t\telse if (item === this._tail) {\n\t\t\t// This can only happen if size === 1 which is handled\n\t\t\t// by the case above.\n\t\t\tif (!item.previous) {\n\t\t\t\tthrow new Error('Invalid list');\n\t\t\t}\n\t\t\titem.previous.next = undefined;\n\t\t\tthis._tail = item.previous;\n\t\t}\n\t\telse {\n\t\t\tconst next = item.next;\n\t\t\tconst previous = item.previous;\n\t\t\tif (!next || !previous) {\n\t\t\t\tthrow new Error('Invalid list');\n\t\t\t}\n\t\t\tnext.previous = previous;\n\t\t\tprevious.next = next;\n\t\t}\n\t\titem.next = undefined;\n\t\titem.previous = undefined;\n\t\tthis._state++;\n\t}\n\n\tprivate touch(item: Item<K, V>, touch: Touch): void {\n\t\tif (!this._head || !this._tail) {\n\t\t\tthrow new Error('Invalid list');\n\t\t}\n\t\tif ((touch !== Touch.AsOld && touch !== Touch.AsNew)) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (touch === Touch.AsOld) {\n\t\t\tif (item === this._head) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst next = item.next;\n\t\t\tconst previous = item.previous;\n\n\t\t\t// Unlink the item\n\t\t\tif (item === this._tail) {\n\t\t\t\t// previous must be defined since item was not head but is tail\n\t\t\t\t// So there are more than on item in the map\n\t\t\t\tprevious!.next = undefined;\n\t\t\t\tthis._tail = previous;\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Both next and previous are not undefined since item was neither head nor tail.\n\t\t\t\tnext!.previous = previous;\n\t\t\t\tprevious!.next = next;\n\t\t\t}\n\n\t\t\t// Insert the node at head\n\t\t\titem.previous = undefined;\n\t\t\titem.next = this._head;\n\t\t\tthis._head.previous = item;\n\t\t\tthis._head = item;\n\t\t\tthis._state++;\n\t\t} else if (touch === Touch.AsNew) {\n\t\t\tif (item === this._tail) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst next = item.next;\n\t\t\tconst previous = item.previous;\n\n\t\t\t// Unlink the item.\n\t\t\tif (item === this._head) {\n\t\t\t\t// next must be defined since item was not tail but is head\n\t\t\t\t// So there are more than on item in the map\n\t\t\t\tnext!.previous = undefined;\n\t\t\t\tthis._head = next;\n\t\t\t} else {\n\t\t\t\t// Both next and previous are not undefined since item was neither head nor tail.\n\t\t\t\tnext!.previous = previous;\n\t\t\t\tprevious!.next = next;\n\t\t\t}\n\t\t\titem.next = undefined;\n\t\t\titem.previous = this._tail;\n\t\t\tthis._tail.next = item;\n\t\t\tthis._tail = item;\n\t\t\tthis._state++;\n\t\t}\n\t}\n\n\ttoJSON(): [K, V][] {\n\t\tconst data: [K, V][] = [];\n\n\t\tthis.forEach((value, key) => {\n\t\t\tdata.push([key, value]);\n\t\t});\n\n\t\treturn data;\n\t}\n\n\tfromJSON(data: [K, V][]): void {\n\t\tthis.clear();\n\n\t\tfor (const [key, value] of data) {\n\t\t\tthis.set(key, value);\n\t\t}\n\t}\n}\n\nexport class LRUCache<K, V> extends LinkedMap<K, V> {\n\n\tprivate _limit: number;\n\tprivate _ratio: number;\n\n\tconstructor(limit: number, ratio: number = 1) {\n\t\tsuper();\n\t\tthis._limit = limit;\n\t\tthis._ratio = Math.min(Math.max(0, ratio), 1);\n\t}\n\n\tget limit(): number {\n\t\treturn this._limit;\n\t}\n\n\tset limit(limit: number) {\n\t\tthis._limit = limit;\n\t\tthis.checkTrim();\n\t}\n\n\tget ratio(): number {\n\t\treturn this._ratio;\n\t}\n\n\tset ratio(ratio: number) {\n\t\tthis._ratio = Math.min(Math.max(0, ratio), 1);\n\t\tthis.checkTrim();\n\t}\n\n\toverride get(key: K, touch: Touch = Touch.AsNew): V | undefined {\n\t\treturn super.get(key, touch);\n\t}\n\n\tpeek(key: K): V | undefined {\n\t\treturn super.get(key, Touch.None);\n\t}\n\n\toverride set(key: K, value: V): this {\n\t\tsuper.set(key, value, Touch.AsNew);\n\t\tthis.checkTrim();\n\t\treturn this;\n\t}\n\n\tprivate checkTrim() {\n\t\tif (this.size > this._limit) {\n\t\t\tthis.trimOld(Math.round(this._limit * this._ratio));\n\t\t}\n\t}\n}\n\n/**\n * Wraps the map in type that only implements readonly properties. Useful\n * in the extension host to prevent the consumer from making any mutations.\n */\nexport class ReadonlyMapView<K, V> implements ReadonlyMap<K, V>{\n\treadonly #source: ReadonlyMap<K, V>;\n\n\tpublic get size() {\n\t\treturn this.#source.size;\n\t}\n\n\tconstructor(source: ReadonlyMap<K, V>) {\n\t\tthis.#source = source;\n\t}\n\n\tforEach(callbackfn: (value: V, key: K, map: ReadonlyMap<K, V>) => void, thisArg?: any): void {\n\t\tthis.#source.forEach(callbackfn, thisArg);\n\t}\n\n\tget(key: K): V | undefined {\n\t\treturn this.#source.get(key);\n\t}\n\n\thas(key: K): boolean {\n\t\treturn this.#source.has(key);\n\t}\n\n\tentries(): IterableIterator<[K, V]> {\n\t\treturn this.#source.entries();\n\t}\n\n\tkeys(): IterableIterator<K> {\n\t\treturn this.#source.keys();\n\t}\n\n\tvalues(): IterableIterator<V> {\n\t\treturn this.#source.values();\n\t}\n\n\t[Symbol.iterator](): IterableIterator<[K, V]> {\n\t\treturn this.#source.entries();\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CharCode } from 'vs/base/common/charCode';\nimport { LRUCache } from 'vs/base/common/map';\nimport * as strings from 'vs/base/common/strings';\n\nexport interface IFilter {\n\t// Returns null if word doesn't match.\n\t(word: string, wordToMatchAgainst: string): IMatch[] | null;\n}\n\nexport interface IMatch {\n\tstart: number;\n\tend: number;\n}\n\n// Combined filters\n\n/**\n * @returns A filter which combines the provided set\n * of filters with an or. The *first* filters that\n * matches defined the return value of the returned\n * filter.\n */\nexport function or(...filter: IFilter[]): IFilter {\n\treturn function (word: string, wordToMatchAgainst: string): IMatch[] | null {\n\t\tfor (let i = 0, len = filter.length; i < len; i++) {\n\t\t\tconst match = filter[i](word, wordToMatchAgainst);\n\t\t\tif (match) {\n\t\t\t\treturn match;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t};\n}\n\n// Prefix\n\nexport const matchesStrictPrefix: IFilter = _matchesPrefix.bind(undefined, false);\nexport const matchesPrefix: IFilter = _matchesPrefix.bind(undefined, true);\n\nfunction _matchesPrefix(ignoreCase: boolean, word: string, wordToMatchAgainst: string): IMatch[] | null {\n\tif (!wordToMatchAgainst || wordToMatchAgainst.length < word.length) {\n\t\treturn null;\n\t}\n\n\tlet matches: boolean;\n\tif (ignoreCase) {\n\t\tmatches = strings.startsWithIgnoreCase(wordToMatchAgainst, word);\n\t} else {\n\t\tmatches = wordToMatchAgainst.indexOf(word) === 0;\n\t}\n\n\tif (!matches) {\n\t\treturn null;\n\t}\n\n\treturn word.length > 0 ? [{ start: 0, end: word.length }] : [];\n}\n\n// Contiguous Substring\n\nexport function matchesContiguousSubString(word: string, wordToMatchAgainst: string): IMatch[] | null {\n\tconst index = wordToMatchAgainst.toLowerCase().indexOf(word.toLowerCase());\n\tif (index === -1) {\n\t\treturn null;\n\t}\n\n\treturn [{ start: index, end: index + word.length }];\n}\n\n// Substring\n\nexport function matchesSubString(word: string, wordToMatchAgainst: string): IMatch[] | null {\n\treturn _matchesSubString(word.toLowerCase(), wordToMatchAgainst.toLowerCase(), 0, 0);\n}\n\nfunction _matchesSubString(word: string, wordToMatchAgainst: string, i: number, j: number): IMatch[] | null {\n\tif (i === word.length) {\n\t\treturn [];\n\t} else if (j === wordToMatchAgainst.length) {\n\t\treturn null;\n\t} else {\n\t\tif (word[i] === wordToMatchAgainst[j]) {\n\t\t\tlet result: IMatch[] | null = null;\n\t\t\tif (result = _matchesSubString(word, wordToMatchAgainst, i + 1, j + 1)) {\n\t\t\t\treturn join({ start: j, end: j + 1 }, result);\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\treturn _matchesSubString(word, wordToMatchAgainst, i, j + 1);\n\t}\n}\n\n// CamelCase\n\nfunction isLower(code: number): boolean {\n\treturn CharCode.a <= code && code <= CharCode.z;\n}\n\nexport function isUpper(code: number): boolean {\n\treturn CharCode.A <= code && code <= CharCode.Z;\n}\n\nfunction isNumber(code: number): boolean {\n\treturn CharCode.Digit0 <= code && code <= CharCode.Digit9;\n}\n\nfunction isWhitespace(code: number): boolean {\n\treturn (\n\t\tcode === CharCode.Space\n\t\t|| code === CharCode.Tab\n\t\t|| code === CharCode.LineFeed\n\t\t|| code === CharCode.CarriageReturn\n\t);\n}\n\nconst wordSeparators = new Set<number>();\n// These are chosen as natural word separators based on writen text.\n// It is a subset of the word separators used by the monaco editor.\n'()[]{}<>`\\'\"-/;:,.?!'\n\t.split('')\n\t.forEach(s => wordSeparators.add(s.charCodeAt(0)));\n\nfunction isWordSeparator(code: number): boolean {\n\treturn isWhitespace(code) || wordSeparators.has(code);\n}\n\nfunction charactersMatch(codeA: number, codeB: number): boolean {\n\treturn (codeA === codeB) || (isWordSeparator(codeA) && isWordSeparator(codeB));\n}\n\nfunction isAlphanumeric(code: number): boolean {\n\treturn isLower(code) || isUpper(code) || isNumber(code);\n}\n\nfunction join(head: IMatch, tail: IMatch[]): IMatch[] {\n\tif (tail.length === 0) {\n\t\ttail = [head];\n\t} else if (head.end === tail[0].start) {\n\t\ttail[0].start = head.start;\n\t} else {\n\t\ttail.unshift(head);\n\t}\n\treturn tail;\n}\n\nfunction nextAnchor(camelCaseWord: string, start: number): number {\n\tfor (let i = start; i < camelCaseWord.length; i++) {\n\t\tconst c = camelCaseWord.charCodeAt(i);\n\t\tif (isUpper(c) || isNumber(c) || (i > 0 && !isAlphanumeric(camelCaseWord.charCodeAt(i - 1)))) {\n\t\t\treturn i;\n\t\t}\n\t}\n\treturn camelCaseWord.length;\n}\n\nfunction _matchesCamelCase(word: string, camelCaseWord: string, i: number, j: number): IMatch[] | null {\n\tif (i === word.length) {\n\t\treturn [];\n\t} else if (j === camelCaseWord.length) {\n\t\treturn null;\n\t} else if (word[i] !== camelCaseWord[j].toLowerCase()) {\n\t\treturn null;\n\t} else {\n\t\tlet result: IMatch[] | null = null;\n\t\tlet nextUpperIndex = j + 1;\n\t\tresult = _matchesCamelCase(word, camelCaseWord, i + 1, j + 1);\n\t\twhile (!result && (nextUpperIndex = nextAnchor(camelCaseWord, nextUpperIndex)) < camelCaseWord.length) {\n\t\t\tresult = _matchesCamelCase(word, camelCaseWord, i + 1, nextUpperIndex);\n\t\t\tnextUpperIndex++;\n\t\t}\n\t\treturn result === null ? null : join({ start: j, end: j + 1 }, result);\n\t}\n}\n\ninterface ICamelCaseAnalysis {\n\tupperPercent: number;\n\tlowerPercent: number;\n\talphaPercent: number;\n\tnumericPercent: number;\n}\n\n// Heuristic to avoid computing camel case matcher for words that don't\n// look like camelCaseWords.\nfunction analyzeCamelCaseWord(word: string): ICamelCaseAnalysis {\n\tlet upper = 0, lower = 0, alpha = 0, numeric = 0, code = 0;\n\n\tfor (let i = 0; i < word.length; i++) {\n\t\tcode = word.charCodeAt(i);\n\n\t\tif (isUpper(code)) { upper++; }\n\t\tif (isLower(code)) { lower++; }\n\t\tif (isAlphanumeric(code)) { alpha++; }\n\t\tif (isNumber(code)) { numeric++; }\n\t}\n\n\tconst upperPercent = upper / word.length;\n\tconst lowerPercent = lower / word.length;\n\tconst alphaPercent = alpha / word.length;\n\tconst numericPercent = numeric / word.length;\n\n\treturn { upperPercent, lowerPercent, alphaPercent, numericPercent };\n}\n\nfunction isUpperCaseWord(analysis: ICamelCaseAnalysis): boolean {\n\tconst { upperPercent, lowerPercent } = analysis;\n\treturn lowerPercent === 0 && upperPercent > 0.6;\n}\n\nfunction isCamelCaseWord(analysis: ICamelCaseAnalysis): boolean {\n\tconst { upperPercent, lowerPercent, alphaPercent, numericPercent } = analysis;\n\treturn lowerPercent > 0.2 && upperPercent < 0.8 && alphaPercent > 0.6 && numericPercent < 0.2;\n}\n\n// Heuristic to avoid computing camel case matcher for words that don't\n// look like camel case patterns.\nfunction isCamelCasePattern(word: string): boolean {\n\tlet upper = 0, lower = 0, code = 0, whitespace = 0;\n\n\tfor (let i = 0; i < word.length; i++) {\n\t\tcode = word.charCodeAt(i);\n\n\t\tif (isUpper(code)) { upper++; }\n\t\tif (isLower(code)) { lower++; }\n\t\tif (isWhitespace(code)) { whitespace++; }\n\t}\n\n\tif ((upper === 0 || lower === 0) && whitespace === 0) {\n\t\treturn word.length <= 30;\n\t} else {\n\t\treturn upper <= 5;\n\t}\n}\n\nexport function matchesCamelCase(word: string, camelCaseWord: string): IMatch[] | null {\n\tif (!camelCaseWord) {\n\t\treturn null;\n\t}\n\n\tcamelCaseWord = camelCaseWord.trim();\n\n\tif (camelCaseWord.length === 0) {\n\t\treturn null;\n\t}\n\n\tif (!isCamelCasePattern(word)) {\n\t\treturn null;\n\t}\n\n\tif (camelCaseWord.length > 60) {\n\t\treturn null;\n\t}\n\n\tconst analysis = analyzeCamelCaseWord(camelCaseWord);\n\n\tif (!isCamelCaseWord(analysis)) {\n\t\tif (!isUpperCaseWord(analysis)) {\n\t\t\treturn null;\n\t\t}\n\n\t\tcamelCaseWord = camelCaseWord.toLowerCase();\n\t}\n\n\tlet result: IMatch[] | null = null;\n\tlet i = 0;\n\n\tword = word.toLowerCase();\n\twhile (i < camelCaseWord.length && (result = _matchesCamelCase(word, camelCaseWord, 0, i)) === null) {\n\t\ti = nextAnchor(camelCaseWord, i + 1);\n\t}\n\n\treturn result;\n}\n\n// Matches beginning of words supporting non-ASCII languages\n// If `contiguous` is true then matches word with beginnings of the words in the target. E.g. \"pul\" will match \"Git: Pull\"\n// Otherwise also matches sub string of the word with beginnings of the words in the target. E.g. \"gp\" or \"g p\" will match \"Git: Pull\"\n// Useful in cases where the target is words (e.g. command labels)\n\nexport function matchesWords(word: string, target: string, contiguous: boolean = false): IMatch[] | null {\n\tif (!target || target.length === 0) {\n\t\treturn null;\n\t}\n\n\tlet result: IMatch[] | null = null;\n\tlet i = 0;\n\n\tword = word.toLowerCase();\n\ttarget = target.toLowerCase();\n\twhile (i < target.length && (result = _matchesWords(word, target, 0, i, contiguous)) === null) {\n\t\ti = nextWord(target, i + 1);\n\t}\n\n\treturn result;\n}\n\nfunction _matchesWords(word: string, target: string, i: number, j: number, contiguous: boolean): IMatch[] | null {\n\tif (i === word.length) {\n\t\treturn [];\n\t} else if (j === target.length) {\n\t\treturn null;\n\t} else if (!charactersMatch(word.charCodeAt(i), target.charCodeAt(j))) {\n\t\treturn null;\n\t} else {\n\t\tlet result: IMatch[] | null = null;\n\t\tlet nextWordIndex = j + 1;\n\t\tresult = _matchesWords(word, target, i + 1, j + 1, contiguous);\n\t\tif (!contiguous) {\n\t\t\twhile (!result && (nextWordIndex = nextWord(target, nextWordIndex)) < target.length) {\n\t\t\t\tresult = _matchesWords(word, target, i + 1, nextWordIndex, contiguous);\n\t\t\t\tnextWordIndex++;\n\t\t\t}\n\t\t}\n\t\treturn result === null ? null : join({ start: j, end: j + 1 }, result);\n\t}\n}\n\nfunction nextWord(word: string, start: number): number {\n\tfor (let i = start; i < word.length; i++) {\n\t\tif (isWordSeparator(word.charCodeAt(i)) ||\n\t\t\t(i > 0 && isWordSeparator(word.charCodeAt(i - 1)))) {\n\t\t\treturn i;\n\t\t}\n\t}\n\treturn word.length;\n}\n\n// Fuzzy\n\nconst fuzzyContiguousFilter = or(matchesPrefix, matchesCamelCase, matchesContiguousSubString);\nconst fuzzySeparateFilter = or(matchesPrefix, matchesCamelCase, matchesSubString);\nconst fuzzyRegExpCache = new LRUCache<string, RegExp>(10000); // bounded to 10000 elements\n\nexport function matchesFuzzy(word: string, wordToMatchAgainst: string, enableSeparateSubstringMatching = false): IMatch[] | null {\n\tif (typeof word !== 'string' || typeof wordToMatchAgainst !== 'string') {\n\t\treturn null; // return early for invalid input\n\t}\n\n\t// Form RegExp for wildcard matches\n\tlet regexp = fuzzyRegExpCache.get(word);\n\tif (!regexp) {\n\t\tregexp = new RegExp(strings.convertSimple2RegExpPattern(word), 'i');\n\t\tfuzzyRegExpCache.set(word, regexp);\n\t}\n\n\t// RegExp Filter\n\tconst match = regexp.exec(wordToMatchAgainst);\n\tif (match) {\n\t\treturn [{ start: match.index, end: match.index + match[0].length }];\n\t}\n\n\t// Default Filter\n\treturn enableSeparateSubstringMatching ? fuzzySeparateFilter(word, wordToMatchAgainst) : fuzzyContiguousFilter(word, wordToMatchAgainst);\n}\n\n/**\n * Match pattern against word in a fuzzy way. As in IntelliSense and faster and more\n * powerful than `matchesFuzzy`\n */\nexport function matchesFuzzy2(pattern: string, word: string): IMatch[] | null {\n\tconst score = fuzzyScore(pattern, pattern.toLowerCase(), 0, word, word.toLowerCase(), 0, { firstMatchCanBeWeak: true, boostFullMatch: true });\n\treturn score ? createMatches(score) : null;\n}\n\nexport function anyScore(pattern: string, lowPattern: string, patternPos: number, word: string, lowWord: string, wordPos: number): FuzzyScore {\n\tconst max = Math.min(13, pattern.length);\n\tfor (; patternPos < max; patternPos++) {\n\t\tconst result = fuzzyScore(pattern, lowPattern, patternPos, word, lowWord, wordPos, { firstMatchCanBeWeak: false, boostFullMatch: true });\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t}\n\treturn [0, wordPos];\n}\n\n//#region --- fuzzyScore ---\n\nexport function createMatches(score: undefined | FuzzyScore): IMatch[] {\n\tif (typeof score === 'undefined') {\n\t\treturn [];\n\t}\n\tconst res: IMatch[] = [];\n\tconst wordPos = score[1];\n\tfor (let i = score.length - 1; i > 1; i--) {\n\t\tconst pos = score[i] + wordPos;\n\t\tconst last = res[res.length - 1];\n\t\tif (last && last.end === pos) {\n\t\t\tlast.end = pos + 1;\n\t\t} else {\n\t\t\tres.push({ start: pos, end: pos + 1 });\n\t\t}\n\t}\n\treturn res;\n}\n\nconst _maxLen = 128;\n\nfunction initTable() {\n\tconst table: number[][] = [];\n\tconst row: number[] = [];\n\tfor (let i = 0; i <= _maxLen; i++) {\n\t\trow[i] = 0;\n\t}\n\tfor (let i = 0; i <= _maxLen; i++) {\n\t\ttable.push(row.slice(0));\n\t}\n\treturn table;\n}\n\nfunction initArr(maxLen: number) {\n\tconst row: number[] = [];\n\tfor (let i = 0; i <= maxLen; i++) {\n\t\trow[i] = 0;\n\t}\n\treturn row;\n}\n\nconst _minWordMatchPos = initArr(2 * _maxLen); // min word position for a certain pattern position\nconst _maxWordMatchPos = initArr(2 * _maxLen); // max word position for a certain pattern position\nconst _diag = initTable(); // the length of a contiguous diagonal match\nconst _table = initTable();\nconst _arrows = <Arrow[][]>initTable();\nconst _debug = false;\n\nfunction printTable(table: number[][], pattern: string, patternLen: number, word: string, wordLen: number): string {\n\tfunction pad(s: string, n: number, pad = ' ') {\n\t\twhile (s.length < n) {\n\t\t\ts = pad + s;\n\t\t}\n\t\treturn s;\n\t}\n\tlet ret = ` |   |${word.split('').map(c => pad(c, 3)).join('|')}\\n`;\n\n\tfor (let i = 0; i <= patternLen; i++) {\n\t\tif (i === 0) {\n\t\t\tret += ' |';\n\t\t} else {\n\t\t\tret += `${pattern[i - 1]}|`;\n\t\t}\n\t\tret += table[i].slice(0, wordLen + 1).map(n => pad(n.toString(), 3)).join('|') + '\\n';\n\t}\n\treturn ret;\n}\n\nfunction printTables(pattern: string, patternStart: number, word: string, wordStart: number): void {\n\tpattern = pattern.substr(patternStart);\n\tword = word.substr(wordStart);\n\tconsole.log(printTable(_table, pattern, pattern.length, word, word.length));\n\tconsole.log(printTable(_arrows, pattern, pattern.length, word, word.length));\n\tconsole.log(printTable(_diag, pattern, pattern.length, word, word.length));\n}\n\nfunction isSeparatorAtPos(value: string, index: number): boolean {\n\tif (index < 0 || index >= value.length) {\n\t\treturn false;\n\t}\n\tconst code = value.codePointAt(index);\n\tswitch (code) {\n\t\tcase CharCode.Underline:\n\t\tcase CharCode.Dash:\n\t\tcase CharCode.Period:\n\t\tcase CharCode.Space:\n\t\tcase CharCode.Slash:\n\t\tcase CharCode.Backslash:\n\t\tcase CharCode.SingleQuote:\n\t\tcase CharCode.DoubleQuote:\n\t\tcase CharCode.Colon:\n\t\tcase CharCode.DollarSign:\n\t\tcase CharCode.LessThan:\n\t\tcase CharCode.GreaterThan:\n\t\tcase CharCode.OpenParen:\n\t\tcase CharCode.CloseParen:\n\t\tcase CharCode.OpenSquareBracket:\n\t\tcase CharCode.CloseSquareBracket:\n\t\tcase CharCode.OpenCurlyBrace:\n\t\tcase CharCode.CloseCurlyBrace:\n\t\t\treturn true;\n\t\tcase undefined:\n\t\t\treturn false;\n\t\tdefault:\n\t\t\tif (strings.isEmojiImprecise(code)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t}\n}\n\nfunction isWhitespaceAtPos(value: string, index: number): boolean {\n\tif (index < 0 || index >= value.length) {\n\t\treturn false;\n\t}\n\tconst code = value.charCodeAt(index);\n\tswitch (code) {\n\t\tcase CharCode.Space:\n\t\tcase CharCode.Tab:\n\t\t\treturn true;\n\t\tdefault:\n\t\t\treturn false;\n\t}\n}\n\nfunction isUpperCaseAtPos(pos: number, word: string, wordLow: string): boolean {\n\treturn word[pos] !== wordLow[pos];\n}\n\nexport function isPatternInWord(patternLow: string, patternPos: number, patternLen: number, wordLow: string, wordPos: number, wordLen: number, fillMinWordPosArr = false): boolean {\n\twhile (patternPos < patternLen && wordPos < wordLen) {\n\t\tif (patternLow[patternPos] === wordLow[wordPos]) {\n\t\t\tif (fillMinWordPosArr) {\n\t\t\t\t// Remember the min word position for each pattern position\n\t\t\t\t_minWordMatchPos[patternPos] = wordPos;\n\t\t\t}\n\t\t\tpatternPos += 1;\n\t\t}\n\t\twordPos += 1;\n\t}\n\treturn patternPos === patternLen; // pattern must be exhausted\n}\n\nconst enum Arrow { Diag = 1, Left = 2, LeftLeft = 3 }\n\n/**\n * An array representing a fuzzy match.\n *\n * 0. the score\n * 1. the offset at which matching started\n * 2. `<match_pos_N>`\n * 3. `<match_pos_1>`\n * 4. `<match_pos_0>` etc\n */\nexport type FuzzyScore = [score: number, wordStart: number, ...matches: number[]];\n\nexport namespace FuzzyScore {\n\t/**\n\t * No matches and value `-100`\n\t */\n\texport const Default: FuzzyScore = ([-100, 0]);\n\n\texport function isDefault(score?: FuzzyScore): score is [-100, 0] {\n\t\treturn !score || (score.length === 2 && score[0] === -100 && score[1] === 0);\n\t}\n}\n\nexport abstract class FuzzyScoreOptions {\n\n\tstatic default = { boostFullMatch: true, firstMatchCanBeWeak: false };\n\n\tconstructor(\n\t\treadonly firstMatchCanBeWeak: boolean,\n\t\treadonly boostFullMatch: boolean,\n\t) { }\n}\n\nexport interface FuzzyScorer {\n\t(pattern: string, lowPattern: string, patternPos: number, word: string, lowWord: string, wordPos: number, options?: FuzzyScoreOptions): FuzzyScore | undefined;\n}\n\nexport function fuzzyScore(pattern: string, patternLow: string, patternStart: number, word: string, wordLow: string, wordStart: number, options: FuzzyScoreOptions = FuzzyScoreOptions.default): FuzzyScore | undefined {\n\n\tconst patternLen = pattern.length > _maxLen ? _maxLen : pattern.length;\n\tconst wordLen = word.length > _maxLen ? _maxLen : word.length;\n\n\tif (patternStart >= patternLen || wordStart >= wordLen || (patternLen - patternStart) > (wordLen - wordStart)) {\n\t\treturn undefined;\n\t}\n\n\t// Run a simple check if the characters of pattern occur\n\t// (in order) at all in word. If that isn't the case we\n\t// stop because no match will be possible\n\tif (!isPatternInWord(patternLow, patternStart, patternLen, wordLow, wordStart, wordLen, true)) {\n\t\treturn undefined;\n\t}\n\n\t// Find the max matching word position for each pattern position\n\t// NOTE: the min matching word position was filled in above, in the `isPatternInWord` call\n\t_fillInMaxWordMatchPos(patternLen, wordLen, patternStart, wordStart, patternLow, wordLow);\n\n\tlet row: number = 1;\n\tlet column: number = 1;\n\tlet patternPos = patternStart;\n\tlet wordPos = wordStart;\n\n\tconst hasStrongFirstMatch = [false];\n\n\t// There will be a match, fill in tables\n\tfor (row = 1, patternPos = patternStart; patternPos < patternLen; row++, patternPos++) {\n\n\t\t// Reduce search space to possible matching word positions and to possible access from next row\n\t\tconst minWordMatchPos = _minWordMatchPos[patternPos];\n\t\tconst maxWordMatchPos = _maxWordMatchPos[patternPos];\n\t\tconst nextMaxWordMatchPos = (patternPos + 1 < patternLen ? _maxWordMatchPos[patternPos + 1] : wordLen);\n\n\t\tfor (column = minWordMatchPos - wordStart + 1, wordPos = minWordMatchPos; wordPos < nextMaxWordMatchPos; column++, wordPos++) {\n\n\t\t\tlet score = Number.MIN_SAFE_INTEGER;\n\t\t\tlet canComeDiag = false;\n\n\t\t\tif (wordPos <= maxWordMatchPos) {\n\t\t\t\tscore = _doScore(\n\t\t\t\t\tpattern, patternLow, patternPos, patternStart,\n\t\t\t\t\tword, wordLow, wordPos, wordLen, wordStart,\n\t\t\t\t\t_diag[row - 1][column - 1] === 0,\n\t\t\t\t\thasStrongFirstMatch\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tlet diagScore = 0;\n\t\t\tif (score !== Number.MAX_SAFE_INTEGER) {\n\t\t\t\tcanComeDiag = true;\n\t\t\t\tdiagScore = score + _table[row - 1][column - 1];\n\t\t\t}\n\n\t\t\tconst canComeLeft = wordPos > minWordMatchPos;\n\t\t\tconst leftScore = canComeLeft ? _table[row][column - 1] + (_diag[row][column - 1] > 0 ? -5 : 0) : 0; // penalty for a gap start\n\n\t\t\tconst canComeLeftLeft = wordPos > minWordMatchPos + 1 && _diag[row][column - 1] > 0;\n\t\t\tconst leftLeftScore = canComeLeftLeft ? _table[row][column - 2] + (_diag[row][column - 2] > 0 ? -5 : 0) : 0; // penalty for a gap start\n\n\t\t\tif (canComeLeftLeft && (!canComeLeft || leftLeftScore >= leftScore) && (!canComeDiag || leftLeftScore >= diagScore)) {\n\t\t\t\t// always prefer choosing left left to jump over a diagonal because that means a match is earlier in the word\n\t\t\t\t_table[row][column] = leftLeftScore;\n\t\t\t\t_arrows[row][column] = Arrow.LeftLeft;\n\t\t\t\t_diag[row][column] = 0;\n\t\t\t} else if (canComeLeft && (!canComeDiag || leftScore >= diagScore)) {\n\t\t\t\t// always prefer choosing left since that means a match is earlier in the word\n\t\t\t\t_table[row][column] = leftScore;\n\t\t\t\t_arrows[row][column] = Arrow.Left;\n\t\t\t\t_diag[row][column] = 0;\n\t\t\t} else if (canComeDiag) {\n\t\t\t\t_table[row][column] = diagScore;\n\t\t\t\t_arrows[row][column] = Arrow.Diag;\n\t\t\t\t_diag[row][column] = _diag[row - 1][column - 1] + 1;\n\t\t\t} else {\n\t\t\t\tthrow new Error(`not possible`);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (_debug) {\n\t\tprintTables(pattern, patternStart, word, wordStart);\n\t}\n\n\tif (!hasStrongFirstMatch[0] && !options.firstMatchCanBeWeak) {\n\t\treturn undefined;\n\t}\n\n\trow--;\n\tcolumn--;\n\n\tconst result: FuzzyScore = [_table[row][column], wordStart];\n\n\tlet backwardsDiagLength = 0;\n\tlet maxMatchColumn = 0;\n\n\twhile (row >= 1) {\n\t\t// Find the column where we go diagonally up\n\t\tlet diagColumn = column;\n\t\tdo {\n\t\t\tconst arrow = _arrows[row][diagColumn];\n\t\t\tif (arrow === Arrow.LeftLeft) {\n\t\t\t\tdiagColumn = diagColumn - 2;\n\t\t\t} else if (arrow === Arrow.Left) {\n\t\t\t\tdiagColumn = diagColumn - 1;\n\t\t\t} else {\n\t\t\t\t// found the diagonal\n\t\t\t\tbreak;\n\t\t\t}\n\t\t} while (diagColumn >= 1);\n\n\t\t// Overturn the \"forwards\" decision if keeping the \"backwards\" diagonal would give a better match\n\t\tif (\n\t\t\tbackwardsDiagLength > 1 // only if we would have a contiguous match of 3 characters\n\t\t\t&& patternLow[patternStart + row - 1] === wordLow[wordStart + column - 1] // only if we can do a contiguous match diagonally\n\t\t\t&& !isUpperCaseAtPos(diagColumn + wordStart - 1, word, wordLow) // only if the forwards chose diagonal is not an uppercase\n\t\t\t&& backwardsDiagLength + 1 > _diag[row][diagColumn] // only if our contiguous match would be longer than the \"forwards\" contiguous match\n\t\t) {\n\t\t\tdiagColumn = column;\n\t\t}\n\n\t\tif (diagColumn === column) {\n\t\t\t// this is a contiguous match\n\t\t\tbackwardsDiagLength++;\n\t\t} else {\n\t\t\tbackwardsDiagLength = 1;\n\t\t}\n\n\t\tif (!maxMatchColumn) {\n\t\t\t// remember the last matched column\n\t\t\tmaxMatchColumn = diagColumn;\n\t\t}\n\n\t\trow--;\n\t\tcolumn = diagColumn - 1;\n\t\tresult.push(column);\n\t}\n\n\tif (wordLen === patternLen && options.boostFullMatch) {\n\t\t// the word matches the pattern with all characters!\n\t\t// giving the score a total match boost (to come up ahead other words)\n\t\tresult[0] += 2;\n\t}\n\n\t// Add 1 penalty for each skipped character in the word\n\tconst skippedCharsCount = maxMatchColumn - patternLen;\n\tresult[0] -= skippedCharsCount;\n\n\treturn result;\n}\n\nfunction _fillInMaxWordMatchPos(patternLen: number, wordLen: number, patternStart: number, wordStart: number, patternLow: string, wordLow: string) {\n\tlet patternPos = patternLen - 1;\n\tlet wordPos = wordLen - 1;\n\twhile (patternPos >= patternStart && wordPos >= wordStart) {\n\t\tif (patternLow[patternPos] === wordLow[wordPos]) {\n\t\t\t_maxWordMatchPos[patternPos] = wordPos;\n\t\t\tpatternPos--;\n\t\t}\n\t\twordPos--;\n\t}\n}\n\nfunction _doScore(\n\tpattern: string, patternLow: string, patternPos: number, patternStart: number,\n\tword: string, wordLow: string, wordPos: number, wordLen: number, wordStart: number,\n\tnewMatchStart: boolean,\n\toutFirstMatchStrong: boolean[],\n): number {\n\tif (patternLow[patternPos] !== wordLow[wordPos]) {\n\t\treturn Number.MIN_SAFE_INTEGER;\n\t}\n\n\tlet score = 1;\n\tlet isGapLocation = false;\n\tif (wordPos === (patternPos - patternStart)) {\n\t\t// common prefix: `foobar <-> foobaz`\n\t\t//                            ^^^^^\n\t\tscore = pattern[patternPos] === word[wordPos] ? 7 : 5;\n\n\t} else if (isUpperCaseAtPos(wordPos, word, wordLow) && (wordPos === 0 || !isUpperCaseAtPos(wordPos - 1, word, wordLow))) {\n\t\t// hitting upper-case: `foo <-> forOthers`\n\t\t//                              ^^ ^\n\t\tscore = pattern[patternPos] === word[wordPos] ? 7 : 5;\n\t\tisGapLocation = true;\n\n\t} else if (isSeparatorAtPos(wordLow, wordPos) && (wordPos === 0 || !isSeparatorAtPos(wordLow, wordPos - 1))) {\n\t\t// hitting a separator: `. <-> foo.bar`\n\t\t//                                ^\n\t\tscore = 5;\n\n\t} else if (isSeparatorAtPos(wordLow, wordPos - 1) || isWhitespaceAtPos(wordLow, wordPos - 1)) {\n\t\t// post separator: `foo <-> bar_foo`\n\t\t//                              ^^^\n\t\tscore = 5;\n\t\tisGapLocation = true;\n\t}\n\n\tif (score > 1 && patternPos === patternStart) {\n\t\toutFirstMatchStrong[0] = true;\n\t}\n\n\tif (!isGapLocation) {\n\t\tisGapLocation = isUpperCaseAtPos(wordPos, word, wordLow) || isSeparatorAtPos(wordLow, wordPos - 1) || isWhitespaceAtPos(wordLow, wordPos - 1);\n\t}\n\n\t//\n\tif (patternPos === patternStart) { // first character in pattern\n\t\tif (wordPos > wordStart) {\n\t\t\t// the first pattern character would match a word character that is not at the word start\n\t\t\t// so introduce a penalty to account for the gap preceding this match\n\t\t\tscore -= isGapLocation ? 3 : 5;\n\t\t}\n\t} else {\n\t\tif (newMatchStart) {\n\t\t\t// this would be the beginning of a new match (i.e. there would be a gap before this location)\n\t\t\tscore += isGapLocation ? 2 : 0;\n\t\t} else {\n\t\t\t// this is part of a contiguous match, so give it a slight bonus, but do so only if it would not be a preferred gap location\n\t\t\tscore += isGapLocation ? 0 : 1;\n\t\t}\n\t}\n\n\tif (wordPos + 1 === wordLen) {\n\t\t// we always penalize gaps, but this gives unfair advantages to a match that would match the last character in the word\n\t\t// so pretend there is a gap after the last character in the word to normalize things\n\t\tscore -= isGapLocation ? 3 : 5;\n\t}\n\n\treturn score;\n}\n\n//#endregion\n\n\n//#region --- graceful ---\n\nexport function fuzzyScoreGracefulAggressive(pattern: string, lowPattern: string, patternPos: number, word: string, lowWord: string, wordPos: number, options?: FuzzyScoreOptions): FuzzyScore | undefined {\n\treturn fuzzyScoreWithPermutations(pattern, lowPattern, patternPos, word, lowWord, wordPos, true, options);\n}\n\nexport function fuzzyScoreGraceful(pattern: string, lowPattern: string, patternPos: number, word: string, lowWord: string, wordPos: number, options?: FuzzyScoreOptions): FuzzyScore | undefined {\n\treturn fuzzyScoreWithPermutations(pattern, lowPattern, patternPos, word, lowWord, wordPos, false, options);\n}\n\nfunction fuzzyScoreWithPermutations(pattern: string, lowPattern: string, patternPos: number, word: string, lowWord: string, wordPos: number, aggressive: boolean, options?: FuzzyScoreOptions): FuzzyScore | undefined {\n\tlet top = fuzzyScore(pattern, lowPattern, patternPos, word, lowWord, wordPos, options);\n\n\tif (top && !aggressive) {\n\t\t// when using the original pattern yield a result we`\n\t\t// return it unless we are aggressive and try to find\n\t\t// a better alignment, e.g. `cno` -> `^co^ns^ole` or `^c^o^nsole`.\n\t\treturn top;\n\t}\n\n\tif (pattern.length >= 3) {\n\t\t// When the pattern is long enough then try a few (max 7)\n\t\t// permutations of the pattern to find a better match. The\n\t\t// permutations only swap neighbouring characters, e.g\n\t\t// `cnoso` becomes `conso`, `cnsoo`, `cnoos`.\n\t\tconst tries = Math.min(7, pattern.length - 1);\n\t\tfor (let movingPatternPos = patternPos + 1; movingPatternPos < tries; movingPatternPos++) {\n\t\t\tconst newPattern = nextTypoPermutation(pattern, movingPatternPos);\n\t\t\tif (newPattern) {\n\t\t\t\tconst candidate = fuzzyScore(newPattern, newPattern.toLowerCase(), patternPos, word, lowWord, wordPos, options);\n\t\t\t\tif (candidate) {\n\t\t\t\t\tcandidate[0] -= 3; // permutation penalty\n\t\t\t\t\tif (!top || candidate[0] > top[0]) {\n\t\t\t\t\t\ttop = candidate;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn top;\n}\n\nfunction nextTypoPermutation(pattern: string, patternPos: number): string | undefined {\n\n\tif (patternPos + 1 >= pattern.length) {\n\t\treturn undefined;\n\t}\n\n\tconst swap1 = pattern[patternPos];\n\tconst swap2 = pattern[patternPos + 1];\n\n\tif (swap1 === swap2) {\n\t\treturn undefined;\n\t}\n\n\treturn pattern.slice(0, patternPos)\n\t\t+ swap2\n\t\t+ swap1\n\t\t+ pattern.slice(patternPos + 2);\n}\n\n//#endregion\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CSSIcon } from 'vs/base/common/codicons';\nimport { IMatch, matchesFuzzy } from 'vs/base/common/filters';\nimport { ltrim } from 'vs/base/common/strings';\n\nexport const iconStartMarker = '$(';\n\nconst iconsRegex = new RegExp(`\\\\$\\\\(${CSSIcon.iconNameExpression}(?:${CSSIcon.iconModifierExpression})?\\\\)`, 'g'); // no capturing groups\nconst iconNameCharacterRegexp = new RegExp(CSSIcon.iconNameCharacter);\n\nconst escapeIconsRegex = new RegExp(`(\\\\\\\\)?${iconsRegex.source}`, 'g');\nexport function escapeIcons(text: string): string {\n\treturn text.replace(escapeIconsRegex, (match, escaped) => escaped ? match : `\\\\${match}`);\n}\n\nconst markdownEscapedIconsRegex = new RegExp(`\\\\\\\\${iconsRegex.source}`, 'g');\nexport function markdownEscapeEscapedIcons(text: string): string {\n\t// Need to add an extra \\ for escaping in markdown\n\treturn text.replace(markdownEscapedIconsRegex, match => `\\\\${match}`);\n}\n\nconst stripIconsRegex = new RegExp(`(\\\\s)?(\\\\\\\\)?${iconsRegex.source}(\\\\s)?`, 'g');\nexport function stripIcons(text: string): string {\n\tif (text.indexOf(iconStartMarker) === -1) {\n\t\treturn text;\n\t}\n\n\treturn text.replace(stripIconsRegex, (match, preWhitespace, escaped, postWhitespace) => escaped ? match : preWhitespace || postWhitespace || '');\n}\n\n\nexport interface IParsedLabelWithIcons {\n\treadonly text: string;\n\treadonly iconOffsets?: readonly number[];\n}\n\nexport function parseLabelWithIcons(text: string): IParsedLabelWithIcons {\n\tconst firstIconIndex = text.indexOf(iconStartMarker);\n\tif (firstIconIndex === -1) {\n\t\treturn { text }; // return early if the word does not include an icon\n\t}\n\n\treturn doParseLabelWithIcons(text, firstIconIndex);\n}\n\nfunction doParseLabelWithIcons(text: string, firstIconIndex: number): IParsedLabelWithIcons {\n\tconst iconOffsets: number[] = [];\n\tlet textWithoutIcons: string = '';\n\n\tfunction appendChars(chars: string) {\n\t\tif (chars) {\n\t\t\ttextWithoutIcons += chars;\n\n\t\t\tfor (const _ of chars) {\n\t\t\t\ticonOffsets.push(iconsOffset); // make sure to fill in icon offsets\n\t\t\t}\n\t\t}\n\t}\n\n\tlet currentIconStart = -1;\n\tlet currentIconValue: string = '';\n\tlet iconsOffset = 0;\n\n\tlet char: string;\n\tlet nextChar: string;\n\n\tlet offset = firstIconIndex;\n\tconst length = text.length;\n\n\t// Append all characters until the first icon\n\tappendChars(text.substr(0, firstIconIndex));\n\n\t// example: $(file-symlink-file) my cool $(other-icon) entry\n\twhile (offset < length) {\n\t\tchar = text[offset];\n\t\tnextChar = text[offset + 1];\n\n\t\t// beginning of icon: some value $( <--\n\t\tif (char === iconStartMarker[0] && nextChar === iconStartMarker[1]) {\n\t\t\tcurrentIconStart = offset;\n\n\t\t\t// if we had a previous potential icon value without\n\t\t\t// the closing ')', it was actually not an icon and\n\t\t\t// so we have to add it to the actual value\n\t\t\tappendChars(currentIconValue);\n\n\t\t\tcurrentIconValue = iconStartMarker;\n\n\t\t\toffset++; // jump over '('\n\t\t}\n\n\t\t// end of icon: some value $(some-icon) <--\n\t\telse if (char === ')' && currentIconStart !== -1) {\n\t\t\tconst currentIconLength = offset - currentIconStart + 1; // +1 to include the closing ')'\n\t\t\ticonsOffset += currentIconLength;\n\t\t\tcurrentIconStart = -1;\n\t\t\tcurrentIconValue = '';\n\t\t}\n\n\t\t// within icon\n\t\telse if (currentIconStart !== -1) {\n\t\t\t// Make sure this is a real icon name\n\t\t\tif (iconNameCharacterRegexp.test(char)) {\n\t\t\t\tcurrentIconValue += char;\n\t\t\t} else {\n\t\t\t\t// This is not a real icon, treat it as text\n\t\t\t\tappendChars(currentIconValue);\n\n\t\t\t\tcurrentIconStart = -1;\n\t\t\t\tcurrentIconValue = '';\n\t\t\t}\n\t\t}\n\n\t\t// any value outside of icon\n\t\telse {\n\t\t\tappendChars(char);\n\t\t}\n\n\t\toffset++;\n\t}\n\n\t// if we had a previous potential icon value without\n\t// the closing ')', it was actually not an icon and\n\t// so we have to add it to the actual value\n\tappendChars(currentIconValue);\n\n\treturn { text: textWithoutIcons, iconOffsets };\n}\n\nexport function matchesFuzzyIconAware(query: string, target: IParsedLabelWithIcons, enableSeparateSubstringMatching = false): IMatch[] | null {\n\tconst { text, iconOffsets } = target;\n\n\t// Return early if there are no icon markers in the word to match against\n\tif (!iconOffsets || iconOffsets.length === 0) {\n\t\treturn matchesFuzzy(query, text, enableSeparateSubstringMatching);\n\t}\n\n\t// Trim the word to match against because it could have leading\n\t// whitespace now if the word started with an icon\n\tconst wordToMatchAgainstWithoutIconsTrimmed = ltrim(text, ' ');\n\tconst leadingWhitespaceOffset = text.length - wordToMatchAgainstWithoutIconsTrimmed.length;\n\n\t// match on value without icon\n\tconst matches = matchesFuzzy(query, wordToMatchAgainstWithoutIconsTrimmed, enableSeparateSubstringMatching);\n\n\t// Map matches back to offsets with icon and trimming\n\tif (matches) {\n\t\tfor (const match of matches) {\n\t\t\tconst iconOffset = iconOffsets[match.start + leadingWhitespaceOffset] /* icon offsets at index */ + leadingWhitespaceOffset /* overall leading whitespace offset */;\n\t\t\tmatch.start += iconOffset;\n\t\t\tmatch.end += iconOffset;\n\t\t}\n\t}\n\n\treturn matches;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as strings from 'vs/base/common/strings';\n\nenum Severity {\n\tIgnore = 0,\n\tInfo = 1,\n\tWarning = 2,\n\tError = 3\n}\n\nnamespace Severity {\n\n\tconst _error = 'error';\n\tconst _warning = 'warning';\n\tconst _warn = 'warn';\n\tconst _info = 'info';\n\tconst _ignore = 'ignore';\n\n\t/**\n\t * Parses 'error', 'warning', 'warn', 'info' in call casings\n\t * and falls back to ignore.\n\t */\n\texport function fromValue(value: string): Severity {\n\t\tif (!value) {\n\t\t\treturn Severity.Ignore;\n\t\t}\n\n\t\tif (strings.equalsIgnoreCase(_error, value)) {\n\t\t\treturn Severity.Error;\n\t\t}\n\n\t\tif (strings.equalsIgnoreCase(_warning, value) || strings.equalsIgnoreCase(_warn, value)) {\n\t\t\treturn Severity.Warning;\n\t\t}\n\n\t\tif (strings.equalsIgnoreCase(_info, value)) {\n\t\t\treturn Severity.Info;\n\t\t}\n\t\treturn Severity.Ignore;\n\t}\n\n\texport function toString(severity: Severity): string {\n\t\tswitch (severity) {\n\t\t\tcase Severity.Error: return _error;\n\t\t\tcase Severity.Warning: return _warning;\n\t\t\tcase Severity.Info: return _info;\n\t\t\tdefault: return _ignore;\n\t\t}\n\t}\n}\n\nexport default Severity;\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { VSBuffer } from 'vs/base/common/buffer';\nimport { regExpFlags } from 'vs/base/common/strings';\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { MarshalledId } from './marshallingIds';\n\nexport function stringify(obj: any): string {\n\treturn JSON.stringify(obj, replacer);\n}\n\nexport function parse(text: string): any {\n\tlet data = JSON.parse(text);\n\tdata = revive(data);\n\treturn data;\n}\n\nexport interface MarshalledObject {\n\t$mid: MarshalledId;\n}\n\nfunction replacer(key: string, value: any): any {\n\t// URI is done via toJSON-member\n\tif (value instanceof RegExp) {\n\t\treturn {\n\t\t\t$mid: MarshalledId.Regexp,\n\t\t\tsource: value.source,\n\t\t\tflags: regExpFlags(value),\n\t\t};\n\t}\n\treturn value;\n}\n\n\ntype Deserialize<T> = T extends UriComponents ? URI\n\t: T extends VSBuffer ? VSBuffer\n\t: T extends object\n\t? Revived<T>\n\t: T;\n\nexport type Revived<T> = { [K in keyof T]: Deserialize<T[K]> };\n\nexport function revive<T = any>(obj: any, depth = 0): Revived<T> {\n\tif (!obj || depth > 200) {\n\t\treturn obj;\n\t}\n\n\tif (typeof obj === 'object') {\n\n\t\tswitch ((<MarshalledObject>obj).$mid) {\n\t\t\tcase MarshalledId.Uri: return <any>URI.revive(obj);\n\t\t\tcase MarshalledId.Regexp: return <any>new RegExp(obj.source, obj.flags);\n\t\t\tcase MarshalledId.Date: return <any>new Date(obj.source);\n\t\t}\n\n\t\tif (\n\t\t\tobj instanceof VSBuffer\n\t\t\t|| obj instanceof Uint8Array\n\t\t) {\n\t\t\treturn <any>obj;\n\t\t}\n\n\t\tif (Array.isArray(obj)) {\n\t\t\tfor (let i = 0; i < obj.length; ++i) {\n\t\t\t\tobj[i] = revive(obj[i], depth + 1);\n\t\t\t}\n\t\t} else {\n\t\t\t// walk object\n\t\t\tfor (const key in obj) {\n\t\t\t\tif (Object.hasOwnProperty.call(obj, key)) {\n\t\t\t\t\tobj[key] = revive(obj[key], depth + 1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn obj;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as platform from 'vs/base/common/platform';\nimport { URI } from 'vs/base/common/uri';\n\nexport namespace Schemas {\n\n\t/**\n\t * A schema that is used for models that exist in memory\n\t * only and that have no correspondence on a server or such.\n\t */\n\texport const inMemory = 'inmemory';\n\n\t/**\n\t * A schema that is used for setting files\n\t */\n\texport const vscode = 'vscode';\n\n\t/**\n\t * A schema that is used for internal private files\n\t */\n\texport const internal = 'private';\n\n\t/**\n\t * A walk-through document.\n\t */\n\texport const walkThrough = 'walkThrough';\n\n\t/**\n\t * An embedded code snippet.\n\t */\n\texport const walkThroughSnippet = 'walkThroughSnippet';\n\n\texport const http = 'http';\n\n\texport const https = 'https';\n\n\texport const file = 'file';\n\n\texport const mailto = 'mailto';\n\n\texport const untitled = 'untitled';\n\n\texport const data = 'data';\n\n\texport const command = 'command';\n\n\texport const vscodeRemote = 'vscode-remote';\n\n\texport const vscodeRemoteResource = 'vscode-remote-resource';\n\n\texport const vscodeUserData = 'vscode-userdata';\n\n\texport const vscodeCustomEditor = 'vscode-custom-editor';\n\n\texport const vscodeNotebook = 'vscode-notebook';\n\n\texport const vscodeNotebookCell = 'vscode-notebook-cell';\n\n\texport const vscodeNotebookCellMetadata = 'vscode-notebook-cell-metadata';\n\texport const vscodeNotebookCellOutput = 'vscode-notebook-cell-output';\n\texport const vscodeInteractive = 'vscode-interactive';\n\texport const vscodeInteractiveInput = 'vscode-interactive-input';\n\n\texport const vscodeSettings = 'vscode-settings';\n\n\texport const vscodeWorkspaceTrust = 'vscode-workspace-trust';\n\n\texport const vscodeTerminal = 'vscode-terminal';\n\n\t/**\n\t * Scheme used internally for webviews that aren't linked to a resource (i.e. not custom editors)\n\t */\n\texport const webviewPanel = 'webview-panel';\n\n\t/**\n\t * Scheme used for loading the wrapper html and script in webviews.\n\t */\n\texport const vscodeWebview = 'vscode-webview';\n\n\t/**\n\t * Scheme used for extension pages\n\t */\n\texport const extension = 'extension';\n\n\t/**\n\t * Scheme used as a replacement of `file` scheme to load\n\t * files with our custom protocol handler (desktop only).\n\t */\n\texport const vscodeFileResource = 'vscode-file';\n\n\t/**\n\t * Scheme used for temporary resources\n\t */\n\texport const tmp = 'tmp';\n\n\t/**\n\t * Scheme used vs live share\n\t */\n\texport const vsls = 'vsls';\n\n\t/**\n\t * Scheme used for the Source Control commit input's text document\n\t */\n\texport const vscodeSourceControl = 'vscode-scm';\n}\n\nexport const connectionTokenCookieName = 'vscode-tkn';\nexport const connectionTokenQueryName = 'tkn';\n\nclass RemoteAuthoritiesImpl {\n\tprivate readonly _hosts: { [authority: string]: string | undefined } = Object.create(null);\n\tprivate readonly _ports: { [authority: string]: number | undefined } = Object.create(null);\n\tprivate readonly _connectionTokens: { [authority: string]: string | undefined } = Object.create(null);\n\tprivate _preferredWebSchema: 'http' | 'https' = 'http';\n\tprivate _delegate: ((uri: URI) => URI) | null = null;\n\tprivate _remoteResourcesPath: string = `/${Schemas.vscodeRemoteResource}`;\n\n\tsetPreferredWebSchema(schema: 'http' | 'https') {\n\t\tthis._preferredWebSchema = schema;\n\t}\n\n\tsetDelegate(delegate: (uri: URI) => URI): void {\n\t\tthis._delegate = delegate;\n\t}\n\n\tsetServerRootPath(serverRootPath: string): void {\n\t\tthis._remoteResourcesPath = `${serverRootPath}/${Schemas.vscodeRemoteResource}`;\n\t}\n\n\tset(authority: string, host: string, port: number): void {\n\t\tthis._hosts[authority] = host;\n\t\tthis._ports[authority] = port;\n\t}\n\n\tsetConnectionToken(authority: string, connectionToken: string): void {\n\t\tthis._connectionTokens[authority] = connectionToken;\n\t}\n\n\tgetPreferredWebSchema(): 'http' | 'https' {\n\t\treturn this._preferredWebSchema;\n\t}\n\n\trewrite(uri: URI): URI {\n\t\tif (this._delegate) {\n\t\t\treturn this._delegate(uri);\n\t\t}\n\t\tconst authority = uri.authority;\n\t\tlet host = this._hosts[authority];\n\t\tif (host && host.indexOf(':') !== -1) {\n\t\t\thost = `[${host}]`;\n\t\t}\n\t\tconst port = this._ports[authority];\n\t\tconst connectionToken = this._connectionTokens[authority];\n\t\tlet query = `path=${encodeURIComponent(uri.path)}`;\n\t\tif (typeof connectionToken === 'string') {\n\t\t\tquery += `&${connectionTokenQueryName}=${encodeURIComponent(connectionToken)}`;\n\t\t}\n\t\treturn URI.from({\n\t\t\tscheme: platform.isWeb ? this._preferredWebSchema : Schemas.vscodeRemoteResource,\n\t\t\tauthority: `${host}:${port}`,\n\t\t\tpath: this._remoteResourcesPath,\n\t\t\tquery\n\t\t});\n\t}\n}\n\nexport const RemoteAuthorities = new RemoteAuthoritiesImpl();\n\nclass FileAccessImpl {\n\n\tprivate static readonly FALLBACK_AUTHORITY = 'vscode-app';\n\n\t/**\n\t * Returns a URI to use in contexts where the browser is responsible\n\t * for loading (e.g. fetch()) or when used within the DOM.\n\t *\n\t * **Note:** use `dom.ts#asCSSUrl` whenever the URL is to be used in CSS context.\n\t */\n\tasBrowserUri(uri: URI): URI;\n\tasBrowserUri(moduleId: string, moduleIdToUrl: { toUrl(moduleId: string): string }): URI;\n\tasBrowserUri(uriOrModule: URI | string, moduleIdToUrl?: { toUrl(moduleId: string): string }): URI {\n\t\tconst uri = this.toUri(uriOrModule, moduleIdToUrl);\n\n\t\t// Handle remote URIs via `RemoteAuthorities`\n\t\tif (uri.scheme === Schemas.vscodeRemote) {\n\t\t\treturn RemoteAuthorities.rewrite(uri);\n\t\t}\n\n\t\t// Convert to `vscode-file` resource..\n\t\tif (\n\t\t\t// ...only ever for `file` resources\n\t\t\turi.scheme === Schemas.file &&\n\t\t\t(\n\t\t\t\t// ...and we run in native environments\n\t\t\t\tplatform.isNative ||\n\t\t\t\t// ...or web worker extensions on desktop\n\t\t\t\t(platform.isWebWorker && platform.globals.origin === `${Schemas.vscodeFileResource}://${FileAccessImpl.FALLBACK_AUTHORITY}`)\n\t\t\t)\n\t\t) {\n\t\t\treturn uri.with({\n\t\t\t\tscheme: Schemas.vscodeFileResource,\n\t\t\t\t// We need to provide an authority here so that it can serve\n\t\t\t\t// as origin for network and loading matters in chromium.\n\t\t\t\t// If the URI is not coming with an authority already, we\n\t\t\t\t// add our own\n\t\t\t\tauthority: uri.authority || FileAccessImpl.FALLBACK_AUTHORITY,\n\t\t\t\tquery: null,\n\t\t\t\tfragment: null\n\t\t\t});\n\t\t}\n\n\t\treturn uri;\n\t}\n\n\t/**\n\t * Returns the `file` URI to use in contexts where node.js\n\t * is responsible for loading.\n\t */\n\tasFileUri(uri: URI): URI;\n\tasFileUri(moduleId: string, moduleIdToUrl: { toUrl(moduleId: string): string }): URI;\n\tasFileUri(uriOrModule: URI | string, moduleIdToUrl?: { toUrl(moduleId: string): string }): URI {\n\t\tconst uri = this.toUri(uriOrModule, moduleIdToUrl);\n\n\t\t// Only convert the URI if it is `vscode-file:` scheme\n\t\tif (uri.scheme === Schemas.vscodeFileResource) {\n\t\t\treturn uri.with({\n\t\t\t\tscheme: Schemas.file,\n\t\t\t\t// Only preserve the `authority` if it is different from\n\t\t\t\t// our fallback authority. This ensures we properly preserve\n\t\t\t\t// Windows UNC paths that come with their own authority.\n\t\t\t\tauthority: uri.authority !== FileAccessImpl.FALLBACK_AUTHORITY ? uri.authority : null,\n\t\t\t\tquery: null,\n\t\t\t\tfragment: null\n\t\t\t});\n\t\t}\n\n\t\treturn uri;\n\t}\n\n\tprivate toUri(uriOrModule: URI | string, moduleIdToUrl?: { toUrl(moduleId: string): string }): URI {\n\t\tif (URI.isUri(uriOrModule)) {\n\t\t\treturn uriOrModule;\n\t\t}\n\n\t\treturn URI.parse(moduleIdToUrl!.toUrl(uriOrModule));\n\t}\n}\n\nexport const FileAccess = new FileAccessImpl();\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CharCode } from 'vs/base/common/charCode';\nimport * as extpath from 'vs/base/common/extpath';\nimport { Schemas } from 'vs/base/common/network';\nimport * as paths from 'vs/base/common/path';\nimport { isLinux, isWindows } from 'vs/base/common/platform';\nimport { compare as strCompare, equalsIgnoreCase } from 'vs/base/common/strings';\nimport { URI, uriToFsPath } from 'vs/base/common/uri';\n\nexport function originalFSPath(uri: URI): string {\n\treturn uriToFsPath(uri, true);\n}\n\n//#region IExtUri\n\nexport interface IExtUri {\n\n\t// --- identity\n\n\t/**\n\t * Compares two uris.\n\t *\n\t * @param uri1 Uri\n\t * @param uri2 Uri\n\t * @param ignoreFragment Ignore the fragment (defaults to `false`)\n\t */\n\tcompare(uri1: URI, uri2: URI, ignoreFragment?: boolean): number;\n\n\t/**\n\t * Tests whether two uris are equal\n\t *\n\t * @param uri1 Uri\n\t * @param uri2 Uri\n\t * @param ignoreFragment Ignore the fragment (defaults to `false`)\n\t */\n\tisEqual(uri1: URI | undefined, uri2: URI | undefined, ignoreFragment?: boolean): boolean;\n\n\t/**\n\t * Tests whether a `candidate` URI is a parent or equal of a given `base` URI.\n\t *\n\t * @param base A uri which is \"longer\" or at least same length as `parentCandidate`\n\t * @param parentCandidate A uri which is \"shorter\" or up to same length as `base`\n\t * @param ignoreFragment Ignore the fragment (defaults to `false`)\n\t */\n\tisEqualOrParent(base: URI, parentCandidate: URI, ignoreFragment?: boolean): boolean;\n\n\t/**\n\t * Creates a key from a resource URI to be used to resource comparison and for resource maps.\n\t * @see {@link ResourceMap}\n\t * @param uri Uri\n\t * @param ignoreFragment Ignore the fragment (defaults to `false`)\n\t */\n\tgetComparisonKey(uri: URI, ignoreFragment?: boolean): string;\n\n\t/**\n\t * Whether the casing of the path-component of the uri should be ignored.\n\t */\n\tignorePathCasing(uri: URI): boolean;\n\n\t// --- path math\n\n\tbasenameOrAuthority(resource: URI): string;\n\n\t/**\n\t * Returns the basename of the path component of an uri.\n\t * @param resource\n\t */\n\tbasename(resource: URI): string;\n\n\t/**\n\t * Returns the extension of the path component of an uri.\n\t * @param resource\n\t */\n\textname(resource: URI): string;\n\t/**\n\t * Return a URI representing the directory of a URI path.\n\t *\n\t * @param resource The input URI.\n\t * @returns The URI representing the directory of the input URI.\n\t */\n\tdirname(resource: URI): URI;\n\t/**\n\t * Join a URI path with path fragments and normalizes the resulting path.\n\t *\n\t * @param resource The input URI.\n\t * @param pathFragment The path fragment to add to the URI path.\n\t * @returns The resulting URI.\n\t */\n\tjoinPath(resource: URI, ...pathFragment: string[]): URI;\n\t/**\n\t * Normalizes the path part of a URI: Resolves `.` and `..` elements with directory names.\n\t *\n\t * @param resource The URI to normalize the path.\n\t * @returns The URI with the normalized path.\n\t */\n\tnormalizePath(resource: URI): URI;\n\t/**\n\t *\n\t * @param from\n\t * @param to\n\t */\n\trelativePath(from: URI, to: URI): string | undefined;\n\t/**\n\t * Resolves an absolute or relative path against a base URI.\n\t * The path can be relative or absolute posix or a Windows path\n\t */\n\tresolvePath(base: URI, path: string): URI;\n\n\t// --- misc\n\n\t/**\n\t * Returns true if the URI path is absolute.\n\t */\n\tisAbsolutePath(resource: URI): boolean;\n\t/**\n\t * Tests whether the two authorities are the same\n\t */\n\tisEqualAuthority(a1: string, a2: string): boolean;\n\t/**\n\t * Returns true if the URI path has a trailing path separator\n\t */\n\thasTrailingPathSeparator(resource: URI, sep?: string): boolean;\n\t/**\n\t * Removes a trailing path separator, if there's one.\n\t * Important: Doesn't remove the first slash, it would make the URI invalid\n\t */\n\tremoveTrailingPathSeparator(resource: URI, sep?: string): URI;\n\t/**\n\t * Adds a trailing path separator to the URI if there isn't one already.\n\t * For example, c:\\ would be unchanged, but c:\\users would become c:\\users\\\n\t */\n\taddTrailingPathSeparator(resource: URI, sep?: string): URI;\n}\n\nexport class ExtUri implements IExtUri {\n\n\tconstructor(private _ignorePathCasing: (uri: URI) => boolean) { }\n\n\tcompare(uri1: URI, uri2: URI, ignoreFragment: boolean = false): number {\n\t\tif (uri1 === uri2) {\n\t\t\treturn 0;\n\t\t}\n\t\treturn strCompare(this.getComparisonKey(uri1, ignoreFragment), this.getComparisonKey(uri2, ignoreFragment));\n\t}\n\n\tisEqual(uri1: URI | undefined, uri2: URI | undefined, ignoreFragment: boolean = false): boolean {\n\t\tif (uri1 === uri2) {\n\t\t\treturn true;\n\t\t}\n\t\tif (!uri1 || !uri2) {\n\t\t\treturn false;\n\t\t}\n\t\treturn this.getComparisonKey(uri1, ignoreFragment) === this.getComparisonKey(uri2, ignoreFragment);\n\t}\n\n\tgetComparisonKey(uri: URI, ignoreFragment: boolean = false): string {\n\t\treturn uri.with({\n\t\t\tpath: this._ignorePathCasing(uri) ? uri.path.toLowerCase() : undefined,\n\t\t\tfragment: ignoreFragment ? null : undefined\n\t\t}).toString();\n\t}\n\n\tignorePathCasing(uri: URI): boolean {\n\t\treturn this._ignorePathCasing(uri);\n\t}\n\n\tisEqualOrParent(base: URI, parentCandidate: URI, ignoreFragment: boolean = false): boolean {\n\t\tif (base.scheme === parentCandidate.scheme) {\n\t\t\tif (base.scheme === Schemas.file) {\n\t\t\t\treturn extpath.isEqualOrParent(originalFSPath(base), originalFSPath(parentCandidate), this._ignorePathCasing(base)) && base.query === parentCandidate.query && (ignoreFragment || base.fragment === parentCandidate.fragment);\n\t\t\t}\n\t\t\tif (isEqualAuthority(base.authority, parentCandidate.authority)) {\n\t\t\t\treturn extpath.isEqualOrParent(base.path, parentCandidate.path, this._ignorePathCasing(base), '/') && base.query === parentCandidate.query && (ignoreFragment || base.fragment === parentCandidate.fragment);\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\t// --- path math\n\n\tjoinPath(resource: URI, ...pathFragment: string[]): URI {\n\t\treturn URI.joinPath(resource, ...pathFragment);\n\t}\n\n\tbasenameOrAuthority(resource: URI): string {\n\t\treturn basename(resource) || resource.authority;\n\t}\n\n\tbasename(resource: URI): string {\n\t\treturn paths.posix.basename(resource.path);\n\t}\n\n\textname(resource: URI): string {\n\t\treturn paths.posix.extname(resource.path);\n\t}\n\n\tdirname(resource: URI): URI {\n\t\tif (resource.path.length === 0) {\n\t\t\treturn resource;\n\t\t}\n\t\tlet dirname;\n\t\tif (resource.scheme === Schemas.file) {\n\t\t\tdirname = URI.file(paths.dirname(originalFSPath(resource))).path;\n\t\t} else {\n\t\t\tdirname = paths.posix.dirname(resource.path);\n\t\t\tif (resource.authority && dirname.length && dirname.charCodeAt(0) !== CharCode.Slash) {\n\t\t\t\tconsole.error(`dirname(\"${resource.toString})) resulted in a relative path`);\n\t\t\t\tdirname = '/'; // If a URI contains an authority component, then the path component must either be empty or begin with a CharCode.Slash (\"/\") character\n\t\t\t}\n\t\t}\n\t\treturn resource.with({\n\t\t\tpath: dirname\n\t\t});\n\t}\n\n\tnormalizePath(resource: URI): URI {\n\t\tif (!resource.path.length) {\n\t\t\treturn resource;\n\t\t}\n\t\tlet normalizedPath: string;\n\t\tif (resource.scheme === Schemas.file) {\n\t\t\tnormalizedPath = URI.file(paths.normalize(originalFSPath(resource))).path;\n\t\t} else {\n\t\t\tnormalizedPath = paths.posix.normalize(resource.path);\n\t\t}\n\t\treturn resource.with({\n\t\t\tpath: normalizedPath\n\t\t});\n\t}\n\n\trelativePath(from: URI, to: URI): string | undefined {\n\t\tif (from.scheme !== to.scheme || !isEqualAuthority(from.authority, to.authority)) {\n\t\t\treturn undefined;\n\t\t}\n\t\tif (from.scheme === Schemas.file) {\n\t\t\tconst relativePath = paths.relative(originalFSPath(from), originalFSPath(to));\n\t\t\treturn isWindows ? extpath.toSlashes(relativePath) : relativePath;\n\t\t}\n\t\tlet fromPath = from.path || '/';\n\t\tconst toPath = to.path || '/';\n\t\tif (this._ignorePathCasing(from)) {\n\t\t\t// make casing of fromPath match toPath\n\t\t\tlet i = 0;\n\t\t\tfor (const len = Math.min(fromPath.length, toPath.length); i < len; i++) {\n\t\t\t\tif (fromPath.charCodeAt(i) !== toPath.charCodeAt(i)) {\n\t\t\t\t\tif (fromPath.charAt(i).toLowerCase() !== toPath.charAt(i).toLowerCase()) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfromPath = toPath.substr(0, i) + fromPath.substr(i);\n\t\t}\n\t\treturn paths.posix.relative(fromPath, toPath);\n\t}\n\n\tresolvePath(base: URI, path: string): URI {\n\t\tif (base.scheme === Schemas.file) {\n\t\t\tconst newURI = URI.file(paths.resolve(originalFSPath(base), path));\n\t\t\treturn base.with({\n\t\t\t\tauthority: newURI.authority,\n\t\t\t\tpath: newURI.path\n\t\t\t});\n\t\t}\n\t\tpath = extpath.toPosixPath(path); // we allow path to be a windows path\n\t\treturn base.with({\n\t\t\tpath: paths.posix.resolve(base.path, path)\n\t\t});\n\t}\n\n\t// --- misc\n\n\tisAbsolutePath(resource: URI): boolean {\n\t\treturn !!resource.path && resource.path[0] === '/';\n\t}\n\n\tisEqualAuthority(a1: string | undefined, a2: string | undefined) {\n\t\treturn a1 === a2 || (a1 !== undefined && a2 !== undefined && equalsIgnoreCase(a1, a2));\n\t}\n\n\thasTrailingPathSeparator(resource: URI, sep: string = paths.sep): boolean {\n\t\tif (resource.scheme === Schemas.file) {\n\t\t\tconst fsp = originalFSPath(resource);\n\t\t\treturn fsp.length > extpath.getRoot(fsp).length && fsp[fsp.length - 1] === sep;\n\t\t} else {\n\t\t\tconst p = resource.path;\n\t\t\treturn (p.length > 1 && p.charCodeAt(p.length - 1) === CharCode.Slash) && !(/^[a-zA-Z]:(\\/$|\\\\$)/.test(resource.fsPath)); // ignore the slash at offset 0\n\t\t}\n\t}\n\n\tremoveTrailingPathSeparator(resource: URI, sep: string = paths.sep): URI {\n\t\t// Make sure that the path isn't a drive letter. A trailing separator there is not removable.\n\t\tif (hasTrailingPathSeparator(resource, sep)) {\n\t\t\treturn resource.with({ path: resource.path.substr(0, resource.path.length - 1) });\n\t\t}\n\t\treturn resource;\n\t}\n\n\taddTrailingPathSeparator(resource: URI, sep: string = paths.sep): URI {\n\t\tlet isRootSep: boolean = false;\n\t\tif (resource.scheme === Schemas.file) {\n\t\t\tconst fsp = originalFSPath(resource);\n\t\t\tisRootSep = ((fsp !== undefined) && (fsp.length === extpath.getRoot(fsp).length) && (fsp[fsp.length - 1] === sep));\n\t\t} else {\n\t\t\tsep = '/';\n\t\t\tconst p = resource.path;\n\t\t\tisRootSep = p.length === 1 && p.charCodeAt(p.length - 1) === CharCode.Slash;\n\t\t}\n\t\tif (!isRootSep && !hasTrailingPathSeparator(resource, sep)) {\n\t\t\treturn resource.with({ path: resource.path + '/' });\n\t\t}\n\t\treturn resource;\n\t}\n}\n\n\n/**\n * Unbiased utility that takes uris \"as they are\". This means it can be interchanged with\n * uri#toString() usages. The following is true\n * ```\n * assertEqual(aUri.toString() === bUri.toString(), exturi.isEqual(aUri, bUri))\n * ```\n */\nexport const extUri = new ExtUri(() => false);\n\n/**\n * BIASED utility that _mostly_ ignored the case of urs paths. ONLY use this util if you\n * understand what you are doing.\n *\n * This utility is INCOMPATIBLE with `uri.toString()`-usages and both CANNOT be used interchanged.\n *\n * When dealing with uris from files or documents, `extUri` (the unbiased friend)is sufficient\n * because those uris come from a \"trustworthy source\". When creating unknown uris it's always\n * better to use `IUriIdentityService` which exposes an `IExtUri`-instance which knows when path\n * casing matters.\n */\nexport const extUriBiasedIgnorePathCase = new ExtUri(uri => {\n\t// A file scheme resource is in the same platform as code, so ignore case for non linux platforms\n\t// Resource can be from another platform. Lowering the case as an hack. Should come from File system provider\n\treturn uri.scheme === Schemas.file ? !isLinux : true;\n});\n\n\n/**\n * BIASED utility that always ignores the casing of uris paths. ONLY use this util if you\n * understand what you are doing.\n *\n * This utility is INCOMPATIBLE with `uri.toString()`-usages and both CANNOT be used interchanged.\n *\n * When dealing with uris from files or documents, `extUri` (the unbiased friend)is sufficient\n * because those uris come from a \"trustworthy source\". When creating unknown uris it's always\n * better to use `IUriIdentityService` which exposes an `IExtUri`-instance which knows when path\n * casing matters.\n */\nexport const extUriIgnorePathCase = new ExtUri(_ => true);\n\nexport const isEqual = extUri.isEqual.bind(extUri);\nexport const isEqualOrParent = extUri.isEqualOrParent.bind(extUri);\nexport const getComparisonKey = extUri.getComparisonKey.bind(extUri);\nexport const basenameOrAuthority = extUri.basenameOrAuthority.bind(extUri);\nexport const basename = extUri.basename.bind(extUri);\nexport const extname = extUri.extname.bind(extUri);\nexport const dirname = extUri.dirname.bind(extUri);\nexport const joinPath = extUri.joinPath.bind(extUri);\nexport const normalizePath = extUri.normalizePath.bind(extUri);\nexport const relativePath = extUri.relativePath.bind(extUri);\nexport const resolvePath = extUri.resolvePath.bind(extUri);\nexport const isAbsolutePath = extUri.isAbsolutePath.bind(extUri);\nexport const isEqualAuthority = extUri.isEqualAuthority.bind(extUri);\nexport const hasTrailingPathSeparator = extUri.hasTrailingPathSeparator.bind(extUri);\nexport const removeTrailingPathSeparator = extUri.removeTrailingPathSeparator.bind(extUri);\nexport const addTrailingPathSeparator = extUri.addTrailingPathSeparator.bind(extUri);\n\n//#endregion\n\nexport function distinctParents<T>(items: T[], resourceAccessor: (item: T) => URI): T[] {\n\tconst distinctParents: T[] = [];\n\tfor (let i = 0; i < items.length; i++) {\n\t\tconst candidateResource = resourceAccessor(items[i]);\n\t\tif (items.some((otherItem, index) => {\n\t\t\tif (index === i) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn isEqualOrParent(candidateResource, resourceAccessor(otherItem));\n\t\t})) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tdistinctParents.push(items[i]);\n\t}\n\n\treturn distinctParents;\n}\n\n/**\n * Data URI related helpers.\n */\nexport namespace DataUri {\n\n\texport const META_DATA_LABEL = 'label';\n\texport const META_DATA_DESCRIPTION = 'description';\n\texport const META_DATA_SIZE = 'size';\n\texport const META_DATA_MIME = 'mime';\n\n\texport function parseMetaData(dataUri: URI): Map<string, string> {\n\t\tconst metadata = new Map<string, string>();\n\n\t\t// Given a URI of:  data:image/png;size:2313;label:SomeLabel;description:SomeDescription;base64,77+9UE5...\n\t\t// the metadata is: size:2313;label:SomeLabel;description:SomeDescription\n\t\tconst meta = dataUri.path.substring(dataUri.path.indexOf(';') + 1, dataUri.path.lastIndexOf(';'));\n\t\tmeta.split(';').forEach(property => {\n\t\t\tconst [key, value] = property.split(':');\n\t\t\tif (key && value) {\n\t\t\t\tmetadata.set(key, value);\n\t\t\t}\n\t\t});\n\n\t\t// Given a URI of:  data:image/png;size:2313;label:SomeLabel;description:SomeDescription;base64,77+9UE5...\n\t\t// the mime is: image/png\n\t\tconst mime = dataUri.path.substring(0, dataUri.path.indexOf(';'));\n\t\tif (mime) {\n\t\t\tmetadata.set(META_DATA_MIME, mime);\n\t\t}\n\n\t\treturn metadata;\n\t}\n}\n\nexport function toLocalResource(resource: URI, authority: string | undefined, localScheme: string): URI {\n\tif (authority) {\n\t\tlet path = resource.path;\n\t\tif (path && path[0] !== paths.posix.sep) {\n\t\t\tpath = paths.posix.sep + path;\n\t\t}\n\n\t\treturn resource.with({ scheme: localScheme, authority, path });\n\t}\n\n\treturn resource.with({ scheme: localScheme });\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationToken, CancellationTokenSource } from 'vs/base/common/cancellation';\nimport { CancellationError } from 'vs/base/common/errors';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { Disposable, IDisposable, MutableDisposable, toDisposable } from 'vs/base/common/lifecycle';\nimport { extUri as defaultExtUri, IExtUri } from 'vs/base/common/resources';\nimport { URI } from 'vs/base/common/uri';\nimport { setTimeout0 } from 'vs/base/common/platform';\n\nexport function isThenable<T>(obj: unknown): obj is Promise<T> {\n\treturn !!obj && typeof (obj as unknown as Promise<T>).then === 'function';\n}\n\nexport interface CancelablePromise<T> extends Promise<T> {\n\tcancel(): void;\n}\n\nexport function createCancelablePromise<T>(callback: (token: CancellationToken) => Promise<T>): CancelablePromise<T> {\n\tconst source = new CancellationTokenSource();\n\n\tconst thenable = callback(source.token);\n\tconst promise = new Promise<T>((resolve, reject) => {\n\t\tconst subscription = source.token.onCancellationRequested(() => {\n\t\t\tsubscription.dispose();\n\t\t\tsource.dispose();\n\t\t\treject(new CancellationError());\n\t\t});\n\t\tPromise.resolve(thenable).then(value => {\n\t\t\tsubscription.dispose();\n\t\t\tsource.dispose();\n\t\t\tresolve(value);\n\t\t}, err => {\n\t\t\tsubscription.dispose();\n\t\t\tsource.dispose();\n\t\t\treject(err);\n\t\t});\n\t});\n\n\treturn <CancelablePromise<T>>new class {\n\t\tcancel() {\n\t\t\tsource.cancel();\n\t\t}\n\t\tthen<TResult1 = T, TResult2 = never>(resolve?: ((value: T) => TResult1 | Promise<TResult1>) | undefined | null, reject?: ((reason: any) => TResult2 | Promise<TResult2>) | undefined | null): Promise<TResult1 | TResult2> {\n\t\t\treturn promise.then(resolve, reject);\n\t\t}\n\t\tcatch<TResult = never>(reject?: ((reason: any) => TResult | Promise<TResult>) | undefined | null): Promise<T | TResult> {\n\t\t\treturn this.then(undefined, reject);\n\t\t}\n\t\tfinally(onfinally?: (() => void) | undefined | null): Promise<T> {\n\t\t\treturn promise.finally(onfinally);\n\t\t}\n\t};\n}\n\n/**\n * Returns a promise that resolves with `undefined` as soon as the passed token is cancelled.\n * @see {@link raceCancellationError}\n */\nexport function raceCancellation<T>(promise: Promise<T>, token: CancellationToken): Promise<T | undefined>;\n\n/**\n * Returns a promise that resolves with `defaultValue` as soon as the passed token is cancelled.\n * @see {@link raceCancellationError}\n */\nexport function raceCancellation<T>(promise: Promise<T>, token: CancellationToken, defaultValue: T): Promise<T>;\n\nexport function raceCancellation<T>(promise: Promise<T>, token: CancellationToken, defaultValue?: T): Promise<T | undefined> {\n\treturn new Promise((resolve, reject) => {\n\t\tconst ref = token.onCancellationRequested(() => {\n\t\t\tref.dispose();\n\t\t\tresolve(defaultValue);\n\t\t});\n\t\tpromise.then(resolve, reject).finally(() => ref.dispose());\n\t});\n}\n\n/**\n * Returns a promise that rejects with an {@CancellationError} as soon as the passed token is cancelled.\n * @see {@link raceCancellation}\n */\nexport function raceCancellationError<T>(promise: Promise<T>, token: CancellationToken): Promise<T> {\n\treturn new Promise((resolve, reject) => {\n\t\tconst ref = token.onCancellationRequested(() => {\n\t\t\tref.dispose();\n\t\t\treject(new CancellationError());\n\t\t});\n\t\tpromise.then(resolve, reject).finally(() => ref.dispose());\n\t});\n}\n\n/**\n * Returns as soon as one of the promises is resolved and cancels remaining promises\n */\nexport async function raceCancellablePromises<T>(cancellablePromises: CancelablePromise<T>[]): Promise<T> {\n\tlet resolvedPromiseIndex = -1;\n\tconst promises = cancellablePromises.map((promise, index) => promise.then(result => { resolvedPromiseIndex = index; return result; }));\n\tconst result = await Promise.race(promises);\n\tcancellablePromises.forEach((cancellablePromise, index) => {\n\t\tif (index !== resolvedPromiseIndex) {\n\t\t\tcancellablePromise.cancel();\n\t\t}\n\t});\n\treturn result;\n}\n\nexport function raceTimeout<T>(promise: Promise<T>, timeout: number, onTimeout?: () => void): Promise<T | undefined> {\n\tlet promiseResolve: ((value: T | undefined) => void) | undefined = undefined;\n\n\tconst timer = setTimeout(() => {\n\t\tpromiseResolve?.(undefined);\n\t\tonTimeout?.();\n\t}, timeout);\n\n\treturn Promise.race([\n\t\tpromise.finally(() => clearTimeout(timer)),\n\t\tnew Promise<T | undefined>(resolve => promiseResolve = resolve)\n\t]);\n}\n\nexport function asPromise<T>(callback: () => T | Thenable<T>): Promise<T> {\n\treturn new Promise<T>((resolve, reject) => {\n\t\tconst item = callback();\n\t\tif (isThenable<T>(item)) {\n\t\t\titem.then(resolve, reject);\n\t\t} else {\n\t\t\tresolve(item);\n\t\t}\n\t});\n}\n\nexport interface ITask<T> {\n\t(): T;\n}\n\n/**\n * A helper to prevent accumulation of sequential async tasks.\n *\n * Imagine a mail man with the sole task of delivering letters. As soon as\n * a letter submitted for delivery, he drives to the destination, delivers it\n * and returns to his base. Imagine that during the trip, N more letters were submitted.\n * When the mail man returns, he picks those N letters and delivers them all in a\n * single trip. Even though N+1 submissions occurred, only 2 deliveries were made.\n *\n * The throttler implements this via the queue() method, by providing it a task\n * factory. Following the example:\n *\n * \t\tconst throttler = new Throttler();\n * \t\tconst letters = [];\n *\n * \t\tfunction deliver() {\n * \t\t\tconst lettersToDeliver = letters;\n * \t\t\tletters = [];\n * \t\t\treturn makeTheTrip(lettersToDeliver);\n * \t\t}\n *\n * \t\tfunction onLetterReceived(l) {\n * \t\t\tletters.push(l);\n * \t\t\tthrottler.queue(deliver);\n * \t\t}\n */\nexport class Throttler {\n\n\tprivate activePromise: Promise<any> | null;\n\tprivate queuedPromise: Promise<any> | null;\n\tprivate queuedPromiseFactory: ITask<Promise<any>> | null;\n\n\tconstructor() {\n\t\tthis.activePromise = null;\n\t\tthis.queuedPromise = null;\n\t\tthis.queuedPromiseFactory = null;\n\t}\n\n\tqueue<T>(promiseFactory: ITask<Promise<T>>): Promise<T> {\n\t\tif (this.activePromise) {\n\t\t\tthis.queuedPromiseFactory = promiseFactory;\n\n\t\t\tif (!this.queuedPromise) {\n\t\t\t\tconst onComplete = () => {\n\t\t\t\t\tthis.queuedPromise = null;\n\n\t\t\t\t\tconst result = this.queue(this.queuedPromiseFactory!);\n\t\t\t\t\tthis.queuedPromiseFactory = null;\n\n\t\t\t\t\treturn result;\n\t\t\t\t};\n\n\t\t\t\tthis.queuedPromise = new Promise(resolve => {\n\t\t\t\t\tthis.activePromise!.then(onComplete, onComplete).then(resolve);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tthis.queuedPromise!.then(resolve, reject);\n\t\t\t});\n\t\t}\n\n\t\tthis.activePromise = promiseFactory();\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.activePromise!.then((result: T) => {\n\t\t\t\tthis.activePromise = null;\n\t\t\t\tresolve(result);\n\t\t\t}, (err: unknown) => {\n\t\t\t\tthis.activePromise = null;\n\t\t\t\treject(err);\n\t\t\t});\n\t\t});\n\t}\n}\n\nexport class Sequencer {\n\n\tprivate current: Promise<unknown> = Promise.resolve(null);\n\n\tqueue<T>(promiseTask: ITask<Promise<T>>): Promise<T> {\n\t\treturn this.current = this.current.then(() => promiseTask(), () => promiseTask());\n\t}\n}\n\nexport class SequencerByKey<TKey> {\n\n\tprivate promiseMap = new Map<TKey, Promise<unknown>>();\n\n\tqueue<T>(key: TKey, promiseTask: ITask<Promise<T>>): Promise<T> {\n\t\tconst runningPromise = this.promiseMap.get(key) ?? Promise.resolve();\n\t\tconst newPromise = runningPromise\n\t\t\t.catch(() => { })\n\t\t\t.then(promiseTask)\n\t\t\t.finally(() => {\n\t\t\t\tif (this.promiseMap.get(key) === newPromise) {\n\t\t\t\t\tthis.promiseMap.delete(key);\n\t\t\t\t}\n\t\t\t});\n\t\tthis.promiseMap.set(key, newPromise);\n\t\treturn newPromise;\n\t}\n}\n\ninterface IScheduledLater extends IDisposable {\n\tisTriggered(): boolean;\n}\n\nconst timeoutDeferred = (timeout: number, fn: () => void): IScheduledLater => {\n\tlet scheduled = true;\n\tconst handle = setTimeout(() => {\n\t\tscheduled = false;\n\t\tfn();\n\t}, timeout);\n\treturn {\n\t\tisTriggered: () => scheduled,\n\t\tdispose: () => {\n\t\t\tclearTimeout(handle);\n\t\t\tscheduled = false;\n\t\t},\n\t};\n};\n\nconst microtaskDeferred = (fn: () => void): IScheduledLater => {\n\tlet scheduled = true;\n\tqueueMicrotask(() => {\n\t\tif (scheduled) {\n\t\t\tscheduled = false;\n\t\t\tfn();\n\t\t}\n\t});\n\n\treturn {\n\t\tisTriggered: () => scheduled,\n\t\tdispose: () => { scheduled = false; },\n\t};\n};\n\n/** Can be passed into the Delayed to defer using a microtask */\nexport const MicrotaskDelay = Symbol('MicrotaskDelay');\n\n/**\n * A helper to delay (debounce) execution of a task that is being requested often.\n *\n * Following the throttler, now imagine the mail man wants to optimize the number of\n * trips proactively. The trip itself can be long, so he decides not to make the trip\n * as soon as a letter is submitted. Instead he waits a while, in case more\n * letters are submitted. After said waiting period, if no letters were submitted, he\n * decides to make the trip. Imagine that N more letters were submitted after the first\n * one, all within a short period of time between each other. Even though N+1\n * submissions occurred, only 1 delivery was made.\n *\n * The delayer offers this behavior via the trigger() method, into which both the task\n * to be executed and the waiting period (delay) must be passed in as arguments. Following\n * the example:\n *\n * \t\tconst delayer = new Delayer(WAITING_PERIOD);\n * \t\tconst letters = [];\n *\n * \t\tfunction letterReceived(l) {\n * \t\t\tletters.push(l);\n * \t\t\tdelayer.trigger(() => { return makeTheTrip(); });\n * \t\t}\n */\nexport class Delayer<T> implements IDisposable {\n\n\tprivate deferred: IScheduledLater | null;\n\tprivate completionPromise: Promise<any> | null;\n\tprivate doResolve: ((value?: any | Promise<any>) => void) | null;\n\tprivate doReject: ((err: any) => void) | null;\n\tprivate task: ITask<T | Promise<T>> | null;\n\n\tconstructor(public defaultDelay: number | typeof MicrotaskDelay) {\n\t\tthis.deferred = null;\n\t\tthis.completionPromise = null;\n\t\tthis.doResolve = null;\n\t\tthis.doReject = null;\n\t\tthis.task = null;\n\t}\n\n\ttrigger(task: ITask<T | Promise<T>>, delay = this.defaultDelay): Promise<T> {\n\t\tthis.task = task;\n\t\tthis.cancelTimeout();\n\n\t\tif (!this.completionPromise) {\n\t\t\tthis.completionPromise = new Promise((resolve, reject) => {\n\t\t\t\tthis.doResolve = resolve;\n\t\t\t\tthis.doReject = reject;\n\t\t\t}).then(() => {\n\t\t\t\tthis.completionPromise = null;\n\t\t\t\tthis.doResolve = null;\n\t\t\t\tif (this.task) {\n\t\t\t\t\tconst task = this.task;\n\t\t\t\t\tthis.task = null;\n\t\t\t\t\treturn task();\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t});\n\t\t}\n\n\t\tconst fn = () => {\n\t\t\tthis.deferred = null;\n\t\t\tthis.doResolve?.(null);\n\t\t};\n\n\t\tthis.deferred = delay === MicrotaskDelay ? microtaskDeferred(fn) : timeoutDeferred(delay, fn);\n\n\t\treturn this.completionPromise;\n\t}\n\n\tisTriggered(): boolean {\n\t\treturn !!this.deferred?.isTriggered();\n\t}\n\n\tcancel(): void {\n\t\tthis.cancelTimeout();\n\n\t\tif (this.completionPromise) {\n\t\t\tthis.doReject?.(new CancellationError());\n\t\t\tthis.completionPromise = null;\n\t\t}\n\t}\n\n\tprivate cancelTimeout(): void {\n\t\tthis.deferred?.dispose();\n\t\tthis.deferred = null;\n\t}\n\n\tdispose(): void {\n\t\tthis.cancel();\n\t}\n}\n\n/**\n * A helper to delay execution of a task that is being requested often, while\n * preventing accumulation of consecutive executions, while the task runs.\n *\n * The mail man is clever and waits for a certain amount of time, before going\n * out to deliver letters. While the mail man is going out, more letters arrive\n * and can only be delivered once he is back. Once he is back the mail man will\n * do one more trip to deliver the letters that have accumulated while he was out.\n */\nexport class ThrottledDelayer<T> {\n\n\tprivate delayer: Delayer<Promise<T>>;\n\tprivate throttler: Throttler;\n\n\tconstructor(defaultDelay: number) {\n\t\tthis.delayer = new Delayer(defaultDelay);\n\t\tthis.throttler = new Throttler();\n\t}\n\n\ttrigger(promiseFactory: ITask<Promise<T>>, delay?: number): Promise<T> {\n\t\treturn this.delayer.trigger(() => this.throttler.queue(promiseFactory), delay) as unknown as Promise<T>;\n\t}\n\n\tisTriggered(): boolean {\n\t\treturn this.delayer.isTriggered();\n\t}\n\n\tcancel(): void {\n\t\tthis.delayer.cancel();\n\t}\n\n\tdispose(): void {\n\t\tthis.delayer.dispose();\n\t}\n}\n\n/**\n * A barrier that is initially closed and then becomes opened permanently.\n */\nexport class Barrier {\n\n\tprivate _isOpen: boolean;\n\tprivate _promise: Promise<boolean>;\n\tprivate _completePromise!: (v: boolean) => void;\n\n\tconstructor() {\n\t\tthis._isOpen = false;\n\t\tthis._promise = new Promise<boolean>((c, e) => {\n\t\t\tthis._completePromise = c;\n\t\t});\n\t}\n\n\tisOpen(): boolean {\n\t\treturn this._isOpen;\n\t}\n\n\topen(): void {\n\t\tthis._isOpen = true;\n\t\tthis._completePromise(true);\n\t}\n\n\twait(): Promise<boolean> {\n\t\treturn this._promise;\n\t}\n}\n\n/**\n * A barrier that is initially closed and then becomes opened permanently after a certain period of\n * time or when open is called explicitly\n */\nexport class AutoOpenBarrier extends Barrier {\n\n\tprivate readonly _timeout: any;\n\n\tconstructor(autoOpenTimeMs: number) {\n\t\tsuper();\n\t\tthis._timeout = setTimeout(() => this.open(), autoOpenTimeMs);\n\t}\n\n\toverride open(): void {\n\t\tclearTimeout(this._timeout);\n\t\tsuper.open();\n\t}\n}\n\nexport function timeout(millis: number): CancelablePromise<void>;\nexport function timeout(millis: number, token: CancellationToken): Promise<void>;\nexport function timeout(millis: number, token?: CancellationToken): CancelablePromise<void> | Promise<void> {\n\tif (!token) {\n\t\treturn createCancelablePromise(token => timeout(millis, token));\n\t}\n\n\treturn new Promise((resolve, reject) => {\n\t\tconst handle = setTimeout(() => {\n\t\t\tdisposable.dispose();\n\t\t\tresolve();\n\t\t}, millis);\n\t\tconst disposable = token.onCancellationRequested(() => {\n\t\t\tclearTimeout(handle);\n\t\t\tdisposable.dispose();\n\t\t\treject(new CancellationError());\n\t\t});\n\t});\n}\n\nexport function disposableTimeout(handler: () => void, timeout = 0): IDisposable {\n\tconst timer = setTimeout(handler, timeout);\n\treturn toDisposable(() => clearTimeout(timer));\n}\n\n/**\n * Runs the provided list of promise factories in sequential order. The returned\n * promise will complete to an array of results from each promise.\n */\n\nexport function sequence<T>(promiseFactories: ITask<Promise<T>>[]): Promise<T[]> {\n\tconst results: T[] = [];\n\tlet index = 0;\n\tconst len = promiseFactories.length;\n\n\tfunction next(): Promise<T> | null {\n\t\treturn index < len ? promiseFactories[index++]() : null;\n\t}\n\n\tfunction thenHandler(result: any): Promise<any> {\n\t\tif (result !== undefined && result !== null) {\n\t\t\tresults.push(result);\n\t\t}\n\n\t\tconst n = next();\n\t\tif (n) {\n\t\t\treturn n.then(thenHandler);\n\t\t}\n\n\t\treturn Promise.resolve(results);\n\t}\n\n\treturn Promise.resolve(null).then(thenHandler);\n}\n\nexport function first<T>(promiseFactories: ITask<Promise<T>>[], shouldStop: (t: T) => boolean = t => !!t, defaultValue: T | null = null): Promise<T | null> {\n\tlet index = 0;\n\tconst len = promiseFactories.length;\n\n\tconst loop: () => Promise<T | null> = () => {\n\t\tif (index >= len) {\n\t\t\treturn Promise.resolve(defaultValue);\n\t\t}\n\n\t\tconst factory = promiseFactories[index++];\n\t\tconst promise = Promise.resolve(factory());\n\n\t\treturn promise.then(result => {\n\t\t\tif (shouldStop(result)) {\n\t\t\t\treturn Promise.resolve(result);\n\t\t\t}\n\n\t\t\treturn loop();\n\t\t});\n\t};\n\n\treturn loop();\n}\n\n/**\n * Returns the result of the first promise that matches the \"shouldStop\",\n * running all promises in parallel. Supports cancelable promises.\n */\nexport function firstParallel<T>(promiseList: Promise<T>[], shouldStop?: (t: T) => boolean, defaultValue?: T | null): Promise<T | null>;\nexport function firstParallel<T, R extends T>(promiseList: Promise<T>[], shouldStop: (t: T) => t is R, defaultValue?: R | null): Promise<R | null>;\nexport function firstParallel<T>(promiseList: Promise<T>[], shouldStop: (t: T) => boolean = t => !!t, defaultValue: T | null = null) {\n\tif (promiseList.length === 0) {\n\t\treturn Promise.resolve(defaultValue);\n\t}\n\n\tlet todo = promiseList.length;\n\tconst finish = () => {\n\t\ttodo = -1;\n\t\tfor (const promise of promiseList) {\n\t\t\t(promise as Partial<CancelablePromise<T>>).cancel?.();\n\t\t}\n\t};\n\n\treturn new Promise<T | null>((resolve, reject) => {\n\t\tfor (const promise of promiseList) {\n\t\t\tpromise.then(result => {\n\t\t\t\tif (--todo >= 0 && shouldStop(result)) {\n\t\t\t\t\tfinish();\n\t\t\t\t\tresolve(result);\n\t\t\t\t} else if (todo === 0) {\n\t\t\t\t\tresolve(defaultValue);\n\t\t\t\t}\n\t\t\t})\n\t\t\t\t.catch(err => {\n\t\t\t\t\tif (--todo >= 0) {\n\t\t\t\t\t\tfinish();\n\t\t\t\t\t\treject(err);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t}\n\t});\n}\n\ninterface ILimitedTaskFactory<T> {\n\tfactory: ITask<Promise<T>>;\n\tc: (value: T | Promise<T>) => void;\n\te: (error?: unknown) => void;\n}\n\nexport interface ILimiter<T> {\n\n\treadonly size: number;\n\n\tqueue(factory: ITask<Promise<T>>): Promise<T>;\n}\n\n/**\n * A helper to queue N promises and run them all with a max degree of parallelism. The helper\n * ensures that at any time no more than M promises are running at the same time.\n */\nexport class Limiter<T> implements ILimiter<T>{\n\n\tprivate _size = 0;\n\tprivate runningPromises: number;\n\tprivate readonly maxDegreeOfParalellism: number;\n\tprivate readonly outstandingPromises: ILimitedTaskFactory<T>[];\n\tprivate readonly _onDrained: Emitter<void>;\n\n\tconstructor(maxDegreeOfParalellism: number) {\n\t\tthis.maxDegreeOfParalellism = maxDegreeOfParalellism;\n\t\tthis.outstandingPromises = [];\n\t\tthis.runningPromises = 0;\n\t\tthis._onDrained = new Emitter<void>();\n\t}\n\n\t/**\n\t * An event that fires when every promise in the queue\n\t * has started to execute. In other words: no work is\n\t * pending to be scheduled.\n\t *\n\t * This is NOT an event that signals when all promises\n\t * have finished though.\n\t */\n\tget onDrained(): Event<void> {\n\t\treturn this._onDrained.event;\n\t}\n\n\tget size(): number {\n\t\treturn this._size;\n\t}\n\n\tqueue(factory: ITask<Promise<T>>): Promise<T> {\n\t\tthis._size++;\n\n\t\treturn new Promise<T>((c, e) => {\n\t\t\tthis.outstandingPromises.push({ factory, c, e });\n\t\t\tthis.consume();\n\t\t});\n\t}\n\n\tprivate consume(): void {\n\t\twhile (this.outstandingPromises.length && this.runningPromises < this.maxDegreeOfParalellism) {\n\t\t\tconst iLimitedTask = this.outstandingPromises.shift()!;\n\t\t\tthis.runningPromises++;\n\n\t\t\tconst promise = iLimitedTask.factory();\n\t\t\tpromise.then(iLimitedTask.c, iLimitedTask.e);\n\t\t\tpromise.then(() => this.consumed(), () => this.consumed());\n\t\t}\n\t}\n\n\tprivate consumed(): void {\n\t\tthis._size--;\n\t\tthis.runningPromises--;\n\n\t\tif (this.outstandingPromises.length > 0) {\n\t\t\tthis.consume();\n\t\t} else {\n\t\t\tthis._onDrained.fire();\n\t\t}\n\t}\n\n\tdispose(): void {\n\t\tthis._onDrained.dispose();\n\t}\n}\n\n/**\n * A queue is handles one promise at a time and guarantees that at any time only one promise is executing.\n */\nexport class Queue<T> extends Limiter<T> {\n\n\tconstructor() {\n\t\tsuper(1);\n\t}\n}\n\n/**\n * A helper to organize queues per resource. The ResourceQueue makes sure to manage queues per resource\n * by disposing them once the queue is empty.\n */\nexport class ResourceQueue implements IDisposable {\n\n\tprivate readonly queues = new Map<string, Queue<void>>();\n\n\tprivate readonly drainers = new Set<DeferredPromise<void>>();\n\n\tasync whenDrained(): Promise<void> {\n\t\tif (this.isDrained()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst promise = new DeferredPromise<void>();\n\t\tthis.drainers.add(promise);\n\n\t\treturn promise.p;\n\t}\n\n\tprivate isDrained(): boolean {\n\t\tfor (const [, queue] of this.queues) {\n\t\t\tif (queue.size > 0) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tqueueFor(resource: URI, extUri: IExtUri = defaultExtUri): ILimiter<void> {\n\t\tconst key = extUri.getComparisonKey(resource);\n\n\t\tlet queue = this.queues.get(key);\n\t\tif (!queue) {\n\t\t\tqueue = new Queue<void>();\n\t\t\tEvent.once(queue.onDrained)(() => {\n\t\t\t\tqueue?.dispose();\n\t\t\t\tthis.queues.delete(key);\n\t\t\t\tthis.onDidQueueDrain();\n\t\t\t});\n\n\t\t\tthis.queues.set(key, queue);\n\t\t}\n\n\t\treturn queue;\n\t}\n\n\tprivate onDidQueueDrain(): void {\n\t\tif (!this.isDrained()) {\n\t\t\treturn; // not done yet\n\t\t}\n\n\t\tthis.releaseDrainers();\n\t}\n\n\tprivate releaseDrainers(): void {\n\t\tfor (const drainer of this.drainers) {\n\t\t\tdrainer.complete();\n\t\t}\n\n\t\tthis.drainers.clear();\n\t}\n\n\tdispose(): void {\n\t\tfor (const [, queue] of this.queues) {\n\t\t\tqueue.dispose();\n\t\t}\n\n\t\tthis.queues.clear();\n\n\t\t// Even though we might still have pending\n\t\t// tasks queued, after the queues have been\n\t\t// disposed, we can no longer track them, so\n\t\t// we release drainers to prevent hanging\n\t\t// promises when the resource queue is being\n\t\t// disposed.\n\t\tthis.releaseDrainers();\n\t}\n}\n\nexport class TimeoutTimer implements IDisposable {\n\tprivate _token: any;\n\n\tconstructor();\n\tconstructor(runner: () => void, timeout: number);\n\tconstructor(runner?: () => void, timeout?: number) {\n\t\tthis._token = -1;\n\n\t\tif (typeof runner === 'function' && typeof timeout === 'number') {\n\t\t\tthis.setIfNotSet(runner, timeout);\n\t\t}\n\t}\n\n\tdispose(): void {\n\t\tthis.cancel();\n\t}\n\n\tcancel(): void {\n\t\tif (this._token !== -1) {\n\t\t\tclearTimeout(this._token);\n\t\t\tthis._token = -1;\n\t\t}\n\t}\n\n\tcancelAndSet(runner: () => void, timeout: number): void {\n\t\tthis.cancel();\n\t\tthis._token = setTimeout(() => {\n\t\t\tthis._token = -1;\n\t\t\trunner();\n\t\t}, timeout);\n\t}\n\n\tsetIfNotSet(runner: () => void, timeout: number): void {\n\t\tif (this._token !== -1) {\n\t\t\t// timer is already set\n\t\t\treturn;\n\t\t}\n\t\tthis._token = setTimeout(() => {\n\t\t\tthis._token = -1;\n\t\t\trunner();\n\t\t}, timeout);\n\t}\n}\n\nexport class IntervalTimer implements IDisposable {\n\n\tprivate _token: any;\n\n\tconstructor() {\n\t\tthis._token = -1;\n\t}\n\n\tdispose(): void {\n\t\tthis.cancel();\n\t}\n\n\tcancel(): void {\n\t\tif (this._token !== -1) {\n\t\t\tclearInterval(this._token);\n\t\t\tthis._token = -1;\n\t\t}\n\t}\n\n\tcancelAndSet(runner: () => void, interval: number): void {\n\t\tthis.cancel();\n\t\tthis._token = setInterval(() => {\n\t\t\trunner();\n\t\t}, interval);\n\t}\n}\n\nexport class RunOnceScheduler {\n\n\tprotected runner: ((...args: unknown[]) => void) | null;\n\n\tprivate timeoutToken: any;\n\tprivate timeout: number;\n\tprivate timeoutHandler: () => void;\n\n\tconstructor(runner: (...args: any[]) => void, delay: number) {\n\t\tthis.timeoutToken = -1;\n\t\tthis.runner = runner;\n\t\tthis.timeout = delay;\n\t\tthis.timeoutHandler = this.onTimeout.bind(this);\n\t}\n\n\t/**\n\t * Dispose RunOnceScheduler\n\t */\n\tdispose(): void {\n\t\tthis.cancel();\n\t\tthis.runner = null;\n\t}\n\n\t/**\n\t * Cancel current scheduled runner (if any).\n\t */\n\tcancel(): void {\n\t\tif (this.isScheduled()) {\n\t\t\tclearTimeout(this.timeoutToken);\n\t\t\tthis.timeoutToken = -1;\n\t\t}\n\t}\n\n\t/**\n\t * Cancel previous runner (if any) & schedule a new runner.\n\t */\n\tschedule(delay = this.timeout): void {\n\t\tthis.cancel();\n\t\tthis.timeoutToken = setTimeout(this.timeoutHandler, delay);\n\t}\n\n\tget delay(): number {\n\t\treturn this.timeout;\n\t}\n\n\tset delay(value: number) {\n\t\tthis.timeout = value;\n\t}\n\n\t/**\n\t * Returns true if scheduled.\n\t */\n\tisScheduled(): boolean {\n\t\treturn this.timeoutToken !== -1;\n\t}\n\n\tprivate onTimeout() {\n\t\tthis.timeoutToken = -1;\n\t\tif (this.runner) {\n\t\t\tthis.doRun();\n\t\t}\n\t}\n\n\tprotected doRun(): void {\n\t\tthis.runner?.();\n\t}\n}\n\n/**\n * Same as `RunOnceScheduler`, but doesn't count the time spent in sleep mode.\n * > **NOTE**: Only offers 1s resolution.\n *\n * When calling `setTimeout` with 3hrs, and putting the computer immediately to sleep\n * for 8hrs, `setTimeout` will fire **as soon as the computer wakes from sleep**. But\n * this scheduler will execute 3hrs **after waking the computer from sleep**.\n */\nexport class ProcessTimeRunOnceScheduler {\n\n\tprivate runner: (() => void) | null;\n\tprivate timeout: number;\n\n\tprivate counter: number;\n\tprivate intervalToken: any;\n\tprivate intervalHandler: () => void;\n\n\tconstructor(runner: () => void, delay: number) {\n\t\tif (delay % 1000 !== 0) {\n\t\t\tconsole.warn(`ProcessTimeRunOnceScheduler resolution is 1s, ${delay}ms is not a multiple of 1000ms.`);\n\t\t}\n\t\tthis.runner = runner;\n\t\tthis.timeout = delay;\n\t\tthis.counter = 0;\n\t\tthis.intervalToken = -1;\n\t\tthis.intervalHandler = this.onInterval.bind(this);\n\t}\n\n\tdispose(): void {\n\t\tthis.cancel();\n\t\tthis.runner = null;\n\t}\n\n\tcancel(): void {\n\t\tif (this.isScheduled()) {\n\t\t\tclearInterval(this.intervalToken);\n\t\t\tthis.intervalToken = -1;\n\t\t}\n\t}\n\n\t/**\n\t * Cancel previous runner (if any) & schedule a new runner.\n\t */\n\tschedule(delay = this.timeout): void {\n\t\tif (delay % 1000 !== 0) {\n\t\t\tconsole.warn(`ProcessTimeRunOnceScheduler resolution is 1s, ${delay}ms is not a multiple of 1000ms.`);\n\t\t}\n\t\tthis.cancel();\n\t\tthis.counter = Math.ceil(delay / 1000);\n\t\tthis.intervalToken = setInterval(this.intervalHandler, 1000);\n\t}\n\n\t/**\n\t * Returns true if scheduled.\n\t */\n\tisScheduled(): boolean {\n\t\treturn this.intervalToken !== -1;\n\t}\n\n\tprivate onInterval() {\n\t\tthis.counter--;\n\t\tif (this.counter > 0) {\n\t\t\t// still need to wait\n\t\t\treturn;\n\t\t}\n\n\t\t// time elapsed\n\t\tclearInterval(this.intervalToken);\n\t\tthis.intervalToken = -1;\n\t\tthis.runner?.();\n\t}\n}\n\nexport class RunOnceWorker<T> extends RunOnceScheduler {\n\tprivate units: T[] = [];\n\n\tconstructor(runner: (units: T[]) => void, timeout: number) {\n\t\tsuper(runner, timeout);\n\t}\n\n\twork(unit: T): void {\n\t\tthis.units.push(unit);\n\n\t\tif (!this.isScheduled()) {\n\t\t\tthis.schedule();\n\t\t}\n\t}\n\n\tprotected override doRun(): void {\n\t\tconst units = this.units;\n\t\tthis.units = [];\n\n\t\tthis.runner?.(units);\n\t}\n\n\toverride dispose(): void {\n\t\tthis.units = [];\n\n\t\tsuper.dispose();\n\t}\n}\n\nexport interface IThrottledWorkerOptions {\n\n\t/**\n\t * maximum of units the worker will pass onto handler at once\n\t */\n\tmaxWorkChunkSize: number;\n\n\t/**\n\t * maximum of units the worker will keep in memory for processing\n\t */\n\tmaxBufferedWork: number | undefined;\n\n\t/**\n\t * delay before processing the next round of chunks when chunk size exceeds limits\n\t */\n\tthrottleDelay: number;\n}\n\n/**\n * The `ThrottledWorker` will accept units of work `T`\n * to handle. The contract is:\n * * there is a maximum of units the worker can handle at once (via `maxWorkChunkSize`)\n * * there is a maximum of units the worker will keep in memory for processing (via `maxBufferedWork`)\n * * after having handled `maxWorkChunkSize` units, the worker needs to rest (via `throttleDelay`)\n */\nexport class ThrottledWorker<T> extends Disposable {\n\n\tprivate readonly pendingWork: T[] = [];\n\n\tprivate readonly throttler = this._register(new MutableDisposable<RunOnceScheduler>());\n\tprivate disposed = false;\n\n\tconstructor(\n\t\tprivate options: IThrottledWorkerOptions,\n\t\tprivate readonly handler: (units: T[]) => void\n\t) {\n\t\tsuper();\n\t}\n\n\t/**\n\t * The number of work units that are pending to be processed.\n\t */\n\tget pending(): number { return this.pendingWork.length; }\n\n\t/**\n\t * Add units to be worked on. Use `pending` to figure out\n\t * how many units are not yet processed after this method\n\t * was called.\n\t *\n\t * @returns whether the work was accepted or not. If the\n\t * worker is disposed, it will not accept any more work.\n\t * If the number of pending units would become larger\n\t * than `maxPendingWork`, more work will also not be accepted.\n\t */\n\twork(units: readonly T[]): boolean {\n\t\tif (this.disposed) {\n\t\t\treturn false; // work not accepted: disposed\n\t\t}\n\n\t\t// Check for reaching maximum of pending work\n\t\tif (typeof this.options.maxBufferedWork === 'number') {\n\n\t\t\t// Throttled: simple check if pending + units exceeds max pending\n\t\t\tif (this.throttler.value) {\n\t\t\t\tif (this.pending + units.length > this.options.maxBufferedWork) {\n\t\t\t\t\treturn false; // work not accepted: too much pending work\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Unthrottled: same as throttled, but account for max chunk getting\n\t\t\t// worked on directly without being pending\n\t\t\telse {\n\t\t\t\tif (this.pending + units.length - this.options.maxWorkChunkSize > this.options.maxBufferedWork) {\n\t\t\t\t\treturn false; // work not accepted: too much pending work\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Add to pending units first\n\t\tthis.pendingWork.push(...units);\n\n\t\t// If not throttled, start working directly\n\t\t// Otherwise, when the throttle delay has\n\t\t// past, pending work will be worked again.\n\t\tif (!this.throttler.value) {\n\t\t\tthis.doWork();\n\t\t}\n\n\t\treturn true; // work accepted\n\t}\n\n\tprivate doWork(): void {\n\n\t\t// Extract chunk to handle and handle it\n\t\tthis.handler(this.pendingWork.splice(0, this.options.maxWorkChunkSize));\n\n\t\t// If we have remaining work, schedule it after a delay\n\t\tif (this.pendingWork.length > 0) {\n\t\t\tthis.throttler.value = new RunOnceScheduler(() => {\n\t\t\t\tthis.throttler.clear();\n\n\t\t\t\tthis.doWork();\n\t\t\t}, this.options.throttleDelay);\n\t\t\tthis.throttler.value.schedule();\n\t\t}\n\t}\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\n\t\tthis.disposed = true;\n\t}\n}\n\n//#region -- run on idle tricks ------------\n\nexport interface IdleDeadline {\n\treadonly didTimeout: boolean;\n\ttimeRemaining(): number;\n}\n\n/**\n * Execute the callback the next time the browser is idle\n */\nexport let runWhenIdle: (callback: (idle: IdleDeadline) => void, timeout?: number) => IDisposable;\n\ndeclare function requestIdleCallback(callback: (args: IdleDeadline) => void, options?: { timeout: number }): number;\ndeclare function cancelIdleCallback(handle: number): void;\n\n(function () {\n\tif (typeof requestIdleCallback !== 'function' || typeof cancelIdleCallback !== 'function') {\n\t\trunWhenIdle = (runner) => {\n\t\t\tsetTimeout0(() => {\n\t\t\t\tif (disposed) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst end = Date.now() + 15; // one frame at 64fps\n\t\t\t\trunner(Object.freeze({\n\t\t\t\t\tdidTimeout: true,\n\t\t\t\t\ttimeRemaining() {\n\t\t\t\t\t\treturn Math.max(0, end - Date.now());\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t});\n\t\t\tlet disposed = false;\n\t\t\treturn {\n\t\t\t\tdispose() {\n\t\t\t\t\tif (disposed) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tdisposed = true;\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t} else {\n\t\trunWhenIdle = (runner, timeout?) => {\n\t\t\tconst handle: number = requestIdleCallback(runner, typeof timeout === 'number' ? { timeout } : undefined);\n\t\t\tlet disposed = false;\n\t\t\treturn {\n\t\t\t\tdispose() {\n\t\t\t\t\tif (disposed) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tdisposed = true;\n\t\t\t\t\tcancelIdleCallback(handle);\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t}\n})();\n\n/**\n * An implementation of the \"idle-until-urgent\"-strategy as introduced\n * here: https://philipwalton.com/articles/idle-until-urgent/\n */\nexport class IdleValue<T> {\n\n\tprivate readonly _executor: () => void;\n\tprivate readonly _handle: IDisposable;\n\n\tprivate _didRun: boolean = false;\n\tprivate _value?: T;\n\tprivate _error: unknown;\n\n\tconstructor(executor: () => T) {\n\t\tthis._executor = () => {\n\t\t\ttry {\n\t\t\t\tthis._value = executor();\n\t\t\t} catch (err) {\n\t\t\t\tthis._error = err;\n\t\t\t} finally {\n\t\t\t\tthis._didRun = true;\n\t\t\t}\n\t\t};\n\t\tthis._handle = runWhenIdle(() => this._executor());\n\t}\n\n\tdispose(): void {\n\t\tthis._handle.dispose();\n\t}\n\n\tget value(): T {\n\t\tif (!this._didRun) {\n\t\t\tthis._handle.dispose();\n\t\t\tthis._executor();\n\t\t}\n\t\tif (this._error) {\n\t\t\tthrow this._error;\n\t\t}\n\t\treturn this._value!;\n\t}\n\n\tget isInitialized(): boolean {\n\t\treturn this._didRun;\n\t}\n}\n\n//#endregion\n\nexport async function retry<T>(task: ITask<Promise<T>>, delay: number, retries: number): Promise<T> {\n\tlet lastError: Error | undefined;\n\n\tfor (let i = 0; i < retries; i++) {\n\t\ttry {\n\t\t\treturn await task();\n\t\t} catch (error) {\n\t\t\tlastError = error;\n\n\t\t\tawait timeout(delay);\n\t\t}\n\t}\n\n\tthrow lastError;\n}\n\n//#region Task Sequentializer\n\ninterface IPendingTask {\n\ttaskId: number;\n\tcancel: () => void;\n\tpromise: Promise<void>;\n}\n\ninterface ISequentialTask {\n\tpromise: Promise<void>;\n\tpromiseResolve: () => void;\n\tpromiseReject: (error: Error) => void;\n\trun: () => Promise<void>;\n}\n\nexport interface ITaskSequentializerWithPendingTask {\n\treadonly pending: Promise<void>;\n}\n\nexport class TaskSequentializer {\n\tprivate _pending?: IPendingTask;\n\tprivate _next?: ISequentialTask;\n\n\thasPending(taskId?: number): this is ITaskSequentializerWithPendingTask {\n\t\tif (!this._pending) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (typeof taskId === 'number') {\n\t\t\treturn this._pending.taskId === taskId;\n\t\t}\n\n\t\treturn !!this._pending;\n\t}\n\n\tget pending(): Promise<void> | undefined {\n\t\treturn this._pending ? this._pending.promise : undefined;\n\t}\n\n\tcancelPending(): void {\n\t\tthis._pending?.cancel();\n\t}\n\n\tsetPending(taskId: number, promise: Promise<void>, onCancel?: () => void,): Promise<void> {\n\t\tthis._pending = { taskId, cancel: () => onCancel?.(), promise };\n\n\t\tpromise.then(() => this.donePending(taskId), () => this.donePending(taskId));\n\n\t\treturn promise;\n\t}\n\n\tprivate donePending(taskId: number): void {\n\t\tif (this._pending && taskId === this._pending.taskId) {\n\n\t\t\t// only set pending to done if the promise finished that is associated with that taskId\n\t\t\tthis._pending = undefined;\n\n\t\t\t// schedule the next task now that we are free if we have any\n\t\t\tthis.triggerNext();\n\t\t}\n\t}\n\n\tprivate triggerNext(): void {\n\t\tif (this._next) {\n\t\t\tconst next = this._next;\n\t\t\tthis._next = undefined;\n\n\t\t\t// Run next task and complete on the associated promise\n\t\t\tnext.run().then(next.promiseResolve, next.promiseReject);\n\t\t}\n\t}\n\n\tsetNext(run: () => Promise<void>): Promise<void> {\n\n\t\t// this is our first next task, so we create associated promise with it\n\t\t// so that we can return a promise that completes when the task has\n\t\t// completed.\n\t\tif (!this._next) {\n\t\t\tlet promiseResolve: () => void;\n\t\t\tlet promiseReject: (error: Error) => void;\n\t\t\tconst promise = new Promise<void>((resolve, reject) => {\n\t\t\t\tpromiseResolve = resolve;\n\t\t\t\tpromiseReject = reject;\n\t\t\t});\n\n\t\t\tthis._next = {\n\t\t\t\trun,\n\t\t\t\tpromise,\n\t\t\t\tpromiseResolve: promiseResolve!,\n\t\t\t\tpromiseReject: promiseReject!\n\t\t\t};\n\t\t}\n\n\t\t// we have a previous next task, just overwrite it\n\t\telse {\n\t\t\tthis._next.run = run;\n\t\t}\n\n\t\treturn this._next.promise;\n\t}\n}\n\n//#endregion\n\n//#region\n\n/**\n * The `IntervalCounter` allows to count the number\n * of calls to `increment()` over a duration of\n * `interval`. This utility can be used to conditionally\n * throttle a frequent task when a certain threshold\n * is reached.\n */\nexport class IntervalCounter {\n\n\tprivate lastIncrementTime = 0;\n\n\tprivate value = 0;\n\n\tconstructor(private readonly interval: number, private readonly nowFn = () => Date.now()) { }\n\n\tincrement(): number {\n\t\tconst now = this.nowFn();\n\n\t\t// We are outside of the range of `interval` and as such\n\t\t// start counting from 0 and remember the time\n\t\tif (now - this.lastIncrementTime > this.interval) {\n\t\t\tthis.lastIncrementTime = now;\n\t\t\tthis.value = 0;\n\t\t}\n\n\t\tthis.value++;\n\n\t\treturn this.value;\n\t}\n}\n\n//#endregion\n\n//#region\n\nexport type ValueCallback<T = unknown> = (value: T | Promise<T>) => void;\n\n/**\n * Creates a promise whose resolution or rejection can be controlled imperatively.\n */\nexport class DeferredPromise<T> {\n\n\tprivate completeCallback!: ValueCallback<T>;\n\tprivate errorCallback!: (err: unknown) => void;\n\tprivate rejected = false;\n\tprivate resolved = false;\n\n\tpublic get isRejected() {\n\t\treturn this.rejected;\n\t}\n\n\tpublic get isResolved() {\n\t\treturn this.resolved;\n\t}\n\n\tpublic get isSettled() {\n\t\treturn this.rejected || this.resolved;\n\t}\n\n\tpublic p: Promise<T>;\n\n\tconstructor() {\n\t\tthis.p = new Promise<T>((c, e) => {\n\t\t\tthis.completeCallback = c;\n\t\t\tthis.errorCallback = e;\n\t\t});\n\t}\n\n\tpublic complete(value: T) {\n\t\treturn new Promise<void>(resolve => {\n\t\t\tthis.completeCallback(value);\n\t\t\tthis.resolved = true;\n\t\t\tresolve();\n\t\t});\n\t}\n\n\tpublic error(err: unknown) {\n\t\treturn new Promise<void>(resolve => {\n\t\t\tthis.errorCallback(err);\n\t\t\tthis.rejected = true;\n\t\t\tresolve();\n\t\t});\n\t}\n\n\tpublic cancel() {\n\t\tnew Promise<void>(resolve => {\n\t\t\tthis.errorCallback(new CancellationError());\n\t\t\tthis.rejected = true;\n\t\t\tresolve();\n\t\t});\n\t}\n}\n\n//#endregion\n\n//#region Promises\n\nexport namespace Promises {\n\n\t/**\n\t * A drop-in replacement for `Promise.all` with the only difference\n\t * that the method awaits every promise to either fulfill or reject.\n\t *\n\t * Similar to `Promise.all`, only the first error will be returned\n\t * if any.\n\t */\n\texport async function settled<T>(promises: Promise<T>[]): Promise<T[]> {\n\t\tlet firstError: Error | undefined = undefined;\n\n\t\tconst result = await Promise.all(promises.map(promise => promise.then(value => value, error => {\n\t\t\tif (!firstError) {\n\t\t\t\tfirstError = error;\n\t\t\t}\n\n\t\t\treturn undefined; // do not rethrow so that other promises can settle\n\t\t})));\n\n\t\tif (typeof firstError !== 'undefined') {\n\t\t\tthrow firstError;\n\t\t}\n\n\t\treturn result as unknown as T[]; // cast is needed and protected by the `throw` above\n\t}\n\n\t/**\n\t * A helper to create a new `Promise<T>` with a body that is a promise\n\t * itself. By default, an error that raises from the async body will\n\t * end up as a unhandled rejection, so this utility properly awaits the\n\t * body and rejects the promise as a normal promise does without async\n\t * body.\n\t *\n\t * This method should only be used in rare cases where otherwise `async`\n\t * cannot be used (e.g. when callbacks are involved that require this).\n\t */\n\texport function withAsyncBody<T, E = Error>(bodyFn: (resolve: (value: T) => unknown, reject: (error: E) => unknown) => Promise<unknown>): Promise<T> {\n\t\t// eslint-disable-next-line no-async-promise-executor\n\t\treturn new Promise<T>(async (resolve, reject) => {\n\t\t\ttry {\n\t\t\t\tawait bodyFn(resolve, reject);\n\t\t\t} catch (error) {\n\t\t\t\treject(error);\n\t\t\t}\n\t\t});\n\t}\n}\n\n//#endregion\n\n//#region\n\nconst enum AsyncIterableSourceState {\n\tInitial,\n\tDoneOK,\n\tDoneError,\n}\n\n/**\n * An object that allows to emit async values asynchronously or bring the iterable to an error state using `reject()`.\n * This emitter is valid only for the duration of the executor (until the promise returned by the executor settles).\n */\nexport interface AsyncIterableEmitter<T> {\n\t/**\n\t * The value will be appended at the end.\n\t *\n\t * **NOTE** If `reject()` has already been called, this method has no effect.\n\t */\n\temitOne(value: T): void;\n\t/**\n\t * The values will be appended at the end.\n\t *\n\t * **NOTE** If `reject()` has already been called, this method has no effect.\n\t */\n\temitMany(values: T[]): void;\n\t/**\n\t * Writing an error will permanently invalidate this iterable.\n\t * The current users will receive an error thrown, as will all future users.\n\t *\n\t * **NOTE** If `reject()` have already been called, this method has no effect.\n\t */\n\treject(error: Error): void;\n}\n\n/**\n * An executor for the `AsyncIterableObject` that has access to an emitter.\n */\nexport interface AyncIterableExecutor<T> {\n\t/**\n\t * @param emitter An object that allows to emit async values valid only for the duration of the executor.\n\t */\n\t(emitter: AsyncIterableEmitter<T>): void | Promise<void>;\n}\n\n/**\n * A rich implementation for an `AsyncIterable<T>`.\n */\nexport class AsyncIterableObject<T> implements AsyncIterable<T> {\n\n\tpublic static fromArray<T>(items: T[]): AsyncIterableObject<T> {\n\t\treturn new AsyncIterableObject<T>((writer) => {\n\t\t\twriter.emitMany(items);\n\t\t});\n\t}\n\n\tpublic static fromPromise<T>(promise: Promise<T[]>): AsyncIterableObject<T> {\n\t\treturn new AsyncIterableObject<T>(async (emitter) => {\n\t\t\temitter.emitMany(await promise);\n\t\t});\n\t}\n\n\tpublic static fromPromises<T>(promises: Promise<T>[]): AsyncIterableObject<T> {\n\t\treturn new AsyncIterableObject<T>(async (emitter) => {\n\t\t\tawait Promise.all(promises.map(async (p) => emitter.emitOne(await p)));\n\t\t});\n\t}\n\n\tpublic static merge<T>(iterables: AsyncIterable<T>[]): AsyncIterableObject<T> {\n\t\treturn new AsyncIterableObject(async (emitter) => {\n\t\t\tawait Promise.all(iterables.map(async (iterable) => {\n\t\t\t\tfor await (const item of iterable) {\n\t\t\t\t\temitter.emitOne(item);\n\t\t\t\t}\n\t\t\t}));\n\t\t});\n\t}\n\n\tpublic static EMPTY = AsyncIterableObject.fromArray<any>([]);\n\n\tprivate _state: AsyncIterableSourceState;\n\tprivate _results: T[];\n\tprivate _error: Error | null;\n\tprivate readonly _onStateChanged: Emitter<void>;\n\n\tconstructor(executor: AyncIterableExecutor<T>) {\n\t\tthis._state = AsyncIterableSourceState.Initial;\n\t\tthis._results = [];\n\t\tthis._error = null;\n\t\tthis._onStateChanged = new Emitter<void>();\n\n\t\tqueueMicrotask(async () => {\n\t\t\tconst writer: AsyncIterableEmitter<T> = {\n\t\t\t\temitOne: (item) => this.emitOne(item),\n\t\t\t\temitMany: (items) => this.emitMany(items),\n\t\t\t\treject: (error) => this.reject(error)\n\t\t\t};\n\t\t\ttry {\n\t\t\t\tawait Promise.resolve(executor(writer));\n\t\t\t\tthis.resolve();\n\t\t\t} catch (err) {\n\t\t\t\tthis.reject(err);\n\t\t\t} finally {\n\t\t\t\twriter.emitOne = undefined!;\n\t\t\t\twriter.emitMany = undefined!;\n\t\t\t\twriter.reject = undefined!;\n\t\t\t}\n\t\t});\n\t}\n\n\t[Symbol.asyncIterator](): AsyncIterator<T, undefined, undefined> {\n\t\tlet i = 0;\n\t\treturn {\n\t\t\tnext: async () => {\n\t\t\t\tdo {\n\t\t\t\t\tif (this._state === AsyncIterableSourceState.DoneError) {\n\t\t\t\t\t\tthrow this._error;\n\t\t\t\t\t}\n\t\t\t\t\tif (i < this._results.length) {\n\t\t\t\t\t\treturn { done: false, value: this._results[i++] };\n\t\t\t\t\t}\n\t\t\t\t\tif (this._state === AsyncIterableSourceState.DoneOK) {\n\t\t\t\t\t\treturn { done: true, value: undefined };\n\t\t\t\t\t}\n\t\t\t\t\tawait Event.toPromise(this._onStateChanged.event);\n\t\t\t\t} while (true);\n\t\t\t}\n\t\t};\n\t}\n\n\tpublic static map<T, R>(iterable: AsyncIterable<T>, mapFn: (item: T) => R): AsyncIterableObject<R> {\n\t\treturn new AsyncIterableObject<R>(async (emitter) => {\n\t\t\tfor await (const item of iterable) {\n\t\t\t\temitter.emitOne(mapFn(item));\n\t\t\t}\n\t\t});\n\t}\n\n\tpublic map<R>(mapFn: (item: T) => R): AsyncIterableObject<R> {\n\t\treturn AsyncIterableObject.map(this, mapFn);\n\t}\n\n\tpublic static filter<T>(iterable: AsyncIterable<T>, filterFn: (item: T) => boolean): AsyncIterableObject<T> {\n\t\treturn new AsyncIterableObject<T>(async (emitter) => {\n\t\t\tfor await (const item of iterable) {\n\t\t\t\tif (filterFn(item)) {\n\t\t\t\t\temitter.emitOne(item);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tpublic filter(filterFn: (item: T) => boolean): AsyncIterableObject<T> {\n\t\treturn AsyncIterableObject.filter(this, filterFn);\n\t}\n\n\tpublic static coalesce<T>(iterable: AsyncIterable<T | undefined | null>): AsyncIterableObject<T> {\n\t\treturn <AsyncIterableObject<T>>AsyncIterableObject.filter(iterable, item => !!item);\n\t}\n\n\tpublic coalesce(): AsyncIterableObject<NonNullable<T>> {\n\t\treturn AsyncIterableObject.coalesce(this) as AsyncIterableObject<NonNullable<T>>;\n\t}\n\n\tpublic static async toPromise<T>(iterable: AsyncIterable<T>): Promise<T[]> {\n\t\tconst result: T[] = [];\n\t\tfor await (const item of iterable) {\n\t\t\tresult.push(item);\n\t\t}\n\t\treturn result;\n\t}\n\n\tpublic toPromise(): Promise<T[]> {\n\t\treturn AsyncIterableObject.toPromise(this);\n\t}\n\n\t/**\n\t * The value will be appended at the end.\n\t *\n\t * **NOTE** If `resolve()` or `reject()` have already been called, this method has no effect.\n\t */\n\tprivate emitOne(value: T): void {\n\t\tif (this._state !== AsyncIterableSourceState.Initial) {\n\t\t\treturn;\n\t\t}\n\t\t// it is important to add new values at the end,\n\t\t// as we may have iterators already running on the array\n\t\tthis._results.push(value);\n\t\tthis._onStateChanged.fire();\n\t}\n\n\t/**\n\t * The values will be appended at the end.\n\t *\n\t * **NOTE** If `resolve()` or `reject()` have already been called, this method has no effect.\n\t */\n\tprivate emitMany(values: T[]): void {\n\t\tif (this._state !== AsyncIterableSourceState.Initial) {\n\t\t\treturn;\n\t\t}\n\t\t// it is important to add new values at the end,\n\t\t// as we may have iterators already running on the array\n\t\tthis._results = this._results.concat(values);\n\t\tthis._onStateChanged.fire();\n\t}\n\n\t/**\n\t * Calling `resolve()` will mark the result array as complete.\n\t *\n\t * **NOTE** `resolve()` must be called, otherwise all consumers of this iterable will hang indefinitely, similar to a non-resolved promise.\n\t * **NOTE** If `resolve()` or `reject()` have already been called, this method has no effect.\n\t */\n\tprivate resolve(): void {\n\t\tif (this._state !== AsyncIterableSourceState.Initial) {\n\t\t\treturn;\n\t\t}\n\t\tthis._state = AsyncIterableSourceState.DoneOK;\n\t\tthis._onStateChanged.fire();\n\t}\n\n\t/**\n\t * Writing an error will permanently invalidate this iterable.\n\t * The current users will receive an error thrown, as will all future users.\n\t *\n\t * **NOTE** If `resolve()` or `reject()` have already been called, this method has no effect.\n\t */\n\tprivate reject(error: Error) {\n\t\tif (this._state !== AsyncIterableSourceState.Initial) {\n\t\t\treturn;\n\t\t}\n\t\tthis._state = AsyncIterableSourceState.DoneError;\n\t\tthis._error = error;\n\t\tthis._onStateChanged.fire();\n\t}\n}\n\nexport class CancelableAsyncIterableObject<T> extends AsyncIterableObject<T> {\n\tconstructor(\n\t\tprivate readonly _source: CancellationTokenSource,\n\t\texecutor: AyncIterableExecutor<T>\n\t) {\n\t\tsuper(executor);\n\t}\n\n\tcancel(): void {\n\t\tthis._source.cancel();\n\t}\n}\n\nexport function createCancelableAsyncIterable<T>(callback: (token: CancellationToken) => AsyncIterable<T>): CancelableAsyncIterableObject<T> {\n\tconst source = new CancellationTokenSource();\n\tconst innerIterable = callback(source.token);\n\n\treturn new CancelableAsyncIterableObject<T>(source, async (emitter) => {\n\t\tconst subscription = source.token.onCancellationRequested(() => {\n\t\t\tsubscription.dispose();\n\t\t\tsource.dispose();\n\t\t\temitter.reject(new CancellationError());\n\t\t});\n\t\ttry {\n\t\t\tfor await (const item of innerIterable) {\n\t\t\t\tif (source.token.isCancellationRequested) {\n\t\t\t\t\t// canceled in the meantime\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\temitter.emitOne(item);\n\t\t\t}\n\t\t\tsubscription.dispose();\n\t\t\tsource.dispose();\n\t\t} catch (err) {\n\t\t\tsubscription.dispose();\n\t\t\tsource.dispose();\n\t\t\temitter.reject(err);\n\t\t}\n\t});\n}\n\n//#endregion\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IdleValue } from 'vs/base/common/async';\nimport { sep } from 'vs/base/common/path';\n\n// When comparing large numbers of strings it's better for performance to create an\n// Intl.Collator object and use the function provided by its compare property\n// than it is to use String.prototype.localeCompare()\n\n// A collator with numeric sorting enabled, and no sensitivity to case, accents or diacritics.\nconst intlFileNameCollatorBaseNumeric: IdleValue<{ collator: Intl.Collator; collatorIsNumeric: boolean }> = new IdleValue(() => {\n\tconst collator = new Intl.Collator(undefined, { numeric: true, sensitivity: 'base' });\n\treturn {\n\t\tcollator: collator,\n\t\tcollatorIsNumeric: collator.resolvedOptions().numeric\n\t};\n});\n\n// A collator with numeric sorting enabled.\nconst intlFileNameCollatorNumeric: IdleValue<{ collator: Intl.Collator }> = new IdleValue(() => {\n\tconst collator = new Intl.Collator(undefined, { numeric: true });\n\treturn {\n\t\tcollator: collator\n\t};\n});\n\n// A collator with numeric sorting enabled, and sensitivity to accents and diacritics but not case.\nconst intlFileNameCollatorNumericCaseInsensitive: IdleValue<{ collator: Intl.Collator }> = new IdleValue(() => {\n\tconst collator = new Intl.Collator(undefined, { numeric: true, sensitivity: 'accent' });\n\treturn {\n\t\tcollator: collator\n\t};\n});\n\n/** Compares filenames without distinguishing the name from the extension. Disambiguates by unicode comparison. */\nexport function compareFileNames(one: string | null, other: string | null, caseSensitive = false): number {\n\tconst a = one || '';\n\tconst b = other || '';\n\tconst result = intlFileNameCollatorBaseNumeric.value.collator.compare(a, b);\n\n\t// Using the numeric option will make compare(`foo1`, `foo01`) === 0. Disambiguate.\n\tif (intlFileNameCollatorBaseNumeric.value.collatorIsNumeric && result === 0 && a !== b) {\n\t\treturn a < b ? -1 : 1;\n\t}\n\n\treturn result;\n}\n\n/** Compares full filenames without grouping by case. */\nexport function compareFileNamesDefault(one: string | null, other: string | null): number {\n\tconst collatorNumeric = intlFileNameCollatorNumeric.value.collator;\n\tone = one || '';\n\tother = other || '';\n\n\treturn compareAndDisambiguateByLength(collatorNumeric, one, other);\n}\n\n/** Compares full filenames grouping uppercase names before lowercase. */\nexport function compareFileNamesUpper(one: string | null, other: string | null) {\n\tconst collatorNumeric = intlFileNameCollatorNumeric.value.collator;\n\tone = one || '';\n\tother = other || '';\n\n\treturn compareCaseUpperFirst(one, other) || compareAndDisambiguateByLength(collatorNumeric, one, other);\n}\n\n/** Compares full filenames grouping lowercase names before uppercase. */\nexport function compareFileNamesLower(one: string | null, other: string | null) {\n\tconst collatorNumeric = intlFileNameCollatorNumeric.value.collator;\n\tone = one || '';\n\tother = other || '';\n\n\treturn compareCaseLowerFirst(one, other) || compareAndDisambiguateByLength(collatorNumeric, one, other);\n}\n\n/** Compares full filenames by unicode value. */\nexport function compareFileNamesUnicode(one: string | null, other: string | null) {\n\tone = one || '';\n\tother = other || '';\n\n\tif (one === other) {\n\t\treturn 0;\n\t}\n\n\treturn one < other ? -1 : 1;\n}\n\nexport function noIntlCompareFileNames(one: string | null, other: string | null, caseSensitive = false): number {\n\tif (!caseSensitive) {\n\t\tone = one && one.toLowerCase();\n\t\tother = other && other.toLowerCase();\n\t}\n\n\tconst [oneName, oneExtension] = extractNameAndExtension(one);\n\tconst [otherName, otherExtension] = extractNameAndExtension(other);\n\n\tif (oneName !== otherName) {\n\t\treturn oneName < otherName ? -1 : 1;\n\t}\n\n\tif (oneExtension === otherExtension) {\n\t\treturn 0;\n\t}\n\n\treturn oneExtension < otherExtension ? -1 : 1;\n}\n\n/** Compares filenames by extension, then by name. Disambiguates by unicode comparison. */\nexport function compareFileExtensions(one: string | null, other: string | null): number {\n\tconst [oneName, oneExtension] = extractNameAndExtension(one);\n\tconst [otherName, otherExtension] = extractNameAndExtension(other);\n\n\tlet result = intlFileNameCollatorBaseNumeric.value.collator.compare(oneExtension, otherExtension);\n\n\tif (result === 0) {\n\t\t// Using the numeric option will  make compare(`foo1`, `foo01`) === 0. Disambiguate.\n\t\tif (intlFileNameCollatorBaseNumeric.value.collatorIsNumeric && oneExtension !== otherExtension) {\n\t\t\treturn oneExtension < otherExtension ? -1 : 1;\n\t\t}\n\n\t\t// Extensions are equal, compare filenames\n\t\tresult = intlFileNameCollatorBaseNumeric.value.collator.compare(oneName, otherName);\n\n\t\tif (intlFileNameCollatorBaseNumeric.value.collatorIsNumeric && result === 0 && oneName !== otherName) {\n\t\t\treturn oneName < otherName ? -1 : 1;\n\t\t}\n\t}\n\n\treturn result;\n}\n\n/** Compares filenames by extension, then by full filename. Mixes uppercase and lowercase names together. */\nexport function compareFileExtensionsDefault(one: string | null, other: string | null): number {\n\tone = one || '';\n\tother = other || '';\n\tconst oneExtension = extractExtension(one);\n\tconst otherExtension = extractExtension(other);\n\tconst collatorNumeric = intlFileNameCollatorNumeric.value.collator;\n\tconst collatorNumericCaseInsensitive = intlFileNameCollatorNumericCaseInsensitive.value.collator;\n\n\treturn compareAndDisambiguateByLength(collatorNumericCaseInsensitive, oneExtension, otherExtension) ||\n\t\tcompareAndDisambiguateByLength(collatorNumeric, one, other);\n}\n\n/** Compares filenames by extension, then case, then full filename. Groups uppercase names before lowercase. */\nexport function compareFileExtensionsUpper(one: string | null, other: string | null): number {\n\tone = one || '';\n\tother = other || '';\n\tconst oneExtension = extractExtension(one);\n\tconst otherExtension = extractExtension(other);\n\tconst collatorNumeric = intlFileNameCollatorNumeric.value.collator;\n\tconst collatorNumericCaseInsensitive = intlFileNameCollatorNumericCaseInsensitive.value.collator;\n\n\treturn compareAndDisambiguateByLength(collatorNumericCaseInsensitive, oneExtension, otherExtension) ||\n\t\tcompareCaseUpperFirst(one, other) ||\n\t\tcompareAndDisambiguateByLength(collatorNumeric, one, other);\n}\n\n/** Compares filenames by extension, then case, then full filename. Groups lowercase names before uppercase. */\nexport function compareFileExtensionsLower(one: string | null, other: string | null): number {\n\tone = one || '';\n\tother = other || '';\n\tconst oneExtension = extractExtension(one);\n\tconst otherExtension = extractExtension(other);\n\tconst collatorNumeric = intlFileNameCollatorNumeric.value.collator;\n\tconst collatorNumericCaseInsensitive = intlFileNameCollatorNumericCaseInsensitive.value.collator;\n\n\treturn compareAndDisambiguateByLength(collatorNumericCaseInsensitive, oneExtension, otherExtension) ||\n\t\tcompareCaseLowerFirst(one, other) ||\n\t\tcompareAndDisambiguateByLength(collatorNumeric, one, other);\n}\n\n/** Compares filenames by case-insensitive extension unicode value, then by full filename unicode value. */\nexport function compareFileExtensionsUnicode(one: string | null, other: string | null) {\n\tone = one || '';\n\tother = other || '';\n\tconst oneExtension = extractExtension(one).toLowerCase();\n\tconst otherExtension = extractExtension(other).toLowerCase();\n\n\t// Check for extension differences\n\tif (oneExtension !== otherExtension) {\n\t\treturn oneExtension < otherExtension ? -1 : 1;\n\t}\n\n\t// Check for full filename differences.\n\tif (one !== other) {\n\t\treturn one < other ? -1 : 1;\n\t}\n\n\treturn 0;\n}\n\nconst FileNameMatch = /^(.*?)(\\.([^.]*))?$/;\n\n/** Extracts the name and extension from a full filename, with optional special handling for dotfiles */\nfunction extractNameAndExtension(str?: string | null, dotfilesAsNames = false): [string, string] {\n\tconst match = str ? FileNameMatch.exec(str) as Array<string> : ([] as Array<string>);\n\n\tlet result: [string, string] = [(match && match[1]) || '', (match && match[3]) || ''];\n\n\t// if the dotfilesAsNames option is selected, treat an empty filename with an extension\n\t// or a filename that starts with a dot, as a dotfile name\n\tif (dotfilesAsNames && (!result[0] && result[1] || result[0] && result[0].charAt(0) === '.')) {\n\t\tresult = [result[0] + '.' + result[1], ''];\n\t}\n\n\treturn result;\n}\n\n/** Extracts the extension from a full filename. Treats dotfiles as names, not extensions. */\nfunction extractExtension(str?: string | null): string {\n\tconst match = str ? FileNameMatch.exec(str) as Array<string> : ([] as Array<string>);\n\n\treturn (match && match[1] && match[1].charAt(0) !== '.' && match[3]) || '';\n}\n\nfunction compareAndDisambiguateByLength(collator: Intl.Collator, one: string, other: string) {\n\t// Check for differences\n\tconst result = collator.compare(one, other);\n\tif (result !== 0) {\n\t\treturn result;\n\t}\n\n\t// In a numeric comparison, `foo1` and `foo01` will compare as equivalent.\n\t// Disambiguate by sorting the shorter string first.\n\tif (one.length !== other.length) {\n\t\treturn one.length < other.length ? -1 : 1;\n\t}\n\n\treturn 0;\n}\n\n/** @returns `true` if the string is starts with a lowercase letter. Otherwise, `false`. */\nfunction startsWithLower(string: string) {\n\tconst character = string.charAt(0);\n\n\treturn (character.toLocaleUpperCase() !== character) ? true : false;\n}\n\n/** @returns `true` if the string starts with an uppercase letter. Otherwise, `false`. */\nfunction startsWithUpper(string: string) {\n\tconst character = string.charAt(0);\n\n\treturn (character.toLocaleLowerCase() !== character) ? true : false;\n}\n\n/**\n * Compares the case of the provided strings - lowercase before uppercase\n *\n * @returns\n * ```text\n *   -1 if one is lowercase and other is uppercase\n *    1 if one is uppercase and other is lowercase\n *    0 otherwise\n * ```\n */\nfunction compareCaseLowerFirst(one: string, other: string): number {\n\tif (startsWithLower(one) && startsWithUpper(other)) {\n\t\treturn -1;\n\t}\n\treturn (startsWithUpper(one) && startsWithLower(other)) ? 1 : 0;\n}\n\n/**\n * Compares the case of the provided strings - uppercase before lowercase\n *\n * @returns\n * ```text\n *   -1 if one is uppercase and other is lowercase\n *    1 if one is lowercase and other is uppercase\n *    0 otherwise\n * ```\n */\nfunction compareCaseUpperFirst(one: string, other: string): number {\n\tif (startsWithUpper(one) && startsWithLower(other)) {\n\t\treturn -1;\n\t}\n\treturn (startsWithLower(one) && startsWithUpper(other)) ? 1 : 0;\n}\n\nfunction comparePathComponents(one: string, other: string, caseSensitive = false): number {\n\tif (!caseSensitive) {\n\t\tone = one && one.toLowerCase();\n\t\tother = other && other.toLowerCase();\n\t}\n\n\tif (one === other) {\n\t\treturn 0;\n\t}\n\n\treturn one < other ? -1 : 1;\n}\n\nexport function comparePaths(one: string, other: string, caseSensitive = false): number {\n\tconst oneParts = one.split(sep);\n\tconst otherParts = other.split(sep);\n\n\tconst lastOne = oneParts.length - 1;\n\tconst lastOther = otherParts.length - 1;\n\tlet endOne: boolean, endOther: boolean;\n\n\tfor (let i = 0; ; i++) {\n\t\tendOne = lastOne === i;\n\t\tendOther = lastOther === i;\n\n\t\tif (endOne && endOther) {\n\t\t\treturn compareFileNames(oneParts[i], otherParts[i], caseSensitive);\n\t\t} else if (endOne) {\n\t\t\treturn -1;\n\t\t} else if (endOther) {\n\t\t\treturn 1;\n\t\t}\n\n\t\tconst result = comparePathComponents(oneParts[i], otherParts[i], caseSensitive);\n\n\t\tif (result !== 0) {\n\t\t\treturn result;\n\t\t}\n\t}\n}\n\nexport function compareAnything(one: string, other: string, lookFor: string): number {\n\tconst elementAName = one.toLowerCase();\n\tconst elementBName = other.toLowerCase();\n\n\t// Sort prefix matches over non prefix matches\n\tconst prefixCompare = compareByPrefix(one, other, lookFor);\n\tif (prefixCompare) {\n\t\treturn prefixCompare;\n\t}\n\n\t// Sort suffix matches over non suffix matches\n\tconst elementASuffixMatch = elementAName.endsWith(lookFor);\n\tconst elementBSuffixMatch = elementBName.endsWith(lookFor);\n\tif (elementASuffixMatch !== elementBSuffixMatch) {\n\t\treturn elementASuffixMatch ? -1 : 1;\n\t}\n\n\t// Understand file names\n\tconst r = compareFileNames(elementAName, elementBName);\n\tif (r !== 0) {\n\t\treturn r;\n\t}\n\n\t// Compare by name\n\treturn elementAName.localeCompare(elementBName);\n}\n\nexport function compareByPrefix(one: string, other: string, lookFor: string): number {\n\tconst elementAName = one.toLowerCase();\n\tconst elementBName = other.toLowerCase();\n\n\t// Sort prefix matches over non prefix matches\n\tconst elementAPrefixMatch = elementAName.startsWith(lookFor);\n\tconst elementBPrefixMatch = elementBName.startsWith(lookFor);\n\tif (elementAPrefixMatch !== elementBPrefixMatch) {\n\t\treturn elementAPrefixMatch ? -1 : 1;\n\t}\n\n\t// Same prefix: Sort shorter matches to the top to have those on top that match more precisely\n\telse if (elementAPrefixMatch && elementBPrefixMatch) {\n\t\tif (elementAName.length < elementBName.length) {\n\t\t\treturn -1;\n\t\t}\n\n\t\tif (elementAName.length > elementBName.length) {\n\t\t\treturn 1;\n\t\t}\n\t}\n\n\treturn 0;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { equals } from 'vs/base/common/arrays';\nimport { isThenable } from 'vs/base/common/async';\nimport { CharCode } from 'vs/base/common/charCode';\nimport { isEqualOrParent } from 'vs/base/common/extpath';\nimport { LRUCache } from 'vs/base/common/map';\nimport { basename, extname, posix, sep } from 'vs/base/common/path';\nimport { isLinux } from 'vs/base/common/platform';\nimport { escapeRegExpCharacters } from 'vs/base/common/strings';\n\nexport interface IRelativePattern {\n\n\t/**\n\t * A base file path to which this pattern will be matched against relatively.\n\t */\n\treadonly base: string;\n\n\t/**\n\t * A file glob pattern like `*.{ts,js}` that will be matched on file paths\n\t * relative to the base path.\n\t *\n\t * Example: Given a base of `/home/work/folder` and a file path of `/home/work/folder/index.js`,\n\t * the file glob pattern will match on `index.js`.\n\t */\n\treadonly pattern: string;\n}\n\nexport interface IExpression {\n\t[pattern: string]: boolean | SiblingClause;\n}\n\nexport function getEmptyExpression(): IExpression {\n\treturn Object.create(null);\n}\n\ninterface SiblingClause {\n\twhen: string;\n}\n\nexport const GLOBSTAR = '**';\nexport const GLOB_SPLIT = '/';\n\nconst PATH_REGEX = '[/\\\\\\\\]';\t\t// any slash or backslash\nconst NO_PATH_REGEX = '[^/\\\\\\\\]';\t// any non-slash and non-backslash\nconst ALL_FORWARD_SLASHES = /\\//g;\n\nfunction starsToRegExp(starCount: number, isLastPattern?: boolean): string {\n\tswitch (starCount) {\n\t\tcase 0:\n\t\t\treturn '';\n\t\tcase 1:\n\t\t\treturn `${NO_PATH_REGEX}*?`; // 1 star matches any number of characters except path separator (/ and \\) - non greedy (?)\n\t\tdefault:\n\t\t\t// Matches:  (Path Sep OR Path Val followed by Path Sep) 0-many times except when it's the last pattern\n\t\t\t//           in which case also matches (Path Sep followed by Path Val)\n\t\t\t// Group is non capturing because we don't need to capture at all (?:...)\n\t\t\t// Overall we use non-greedy matching because it could be that we match too much\n\t\t\treturn `(?:${PATH_REGEX}|${NO_PATH_REGEX}+${PATH_REGEX}${isLastPattern ? `|${PATH_REGEX}${NO_PATH_REGEX}+` : ''})*?`;\n\t}\n}\n\nexport function splitGlobAware(pattern: string, splitChar: string): string[] {\n\tif (!pattern) {\n\t\treturn [];\n\t}\n\n\tconst segments: string[] = [];\n\n\tlet inBraces = false;\n\tlet inBrackets = false;\n\n\tlet curVal = '';\n\tfor (const char of pattern) {\n\t\tswitch (char) {\n\t\t\tcase splitChar:\n\t\t\t\tif (!inBraces && !inBrackets) {\n\t\t\t\t\tsegments.push(curVal);\n\t\t\t\t\tcurVal = '';\n\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase '{':\n\t\t\t\tinBraces = true;\n\t\t\t\tbreak;\n\t\t\tcase '}':\n\t\t\t\tinBraces = false;\n\t\t\t\tbreak;\n\t\t\tcase '[':\n\t\t\t\tinBrackets = true;\n\t\t\t\tbreak;\n\t\t\tcase ']':\n\t\t\t\tinBrackets = false;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tcurVal += char;\n\t}\n\n\t// Tail\n\tif (curVal) {\n\t\tsegments.push(curVal);\n\t}\n\n\treturn segments;\n}\n\nfunction parseRegExp(pattern: string): string {\n\tif (!pattern) {\n\t\treturn '';\n\t}\n\n\tlet regEx = '';\n\n\t// Split up into segments for each slash found\n\tconst segments = splitGlobAware(pattern, GLOB_SPLIT);\n\n\t// Special case where we only have globstars\n\tif (segments.every(segment => segment === GLOBSTAR)) {\n\t\tregEx = '.*';\n\t}\n\n\t// Build regex over segments\n\telse {\n\t\tlet previousSegmentWasGlobStar = false;\n\t\tsegments.forEach((segment, index) => {\n\n\t\t\t// Treat globstar specially\n\t\t\tif (segment === GLOBSTAR) {\n\n\t\t\t\t// if we have more than one globstar after another, just ignore it\n\t\t\t\tif (previousSegmentWasGlobStar) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tregEx += starsToRegExp(2, index === segments.length - 1);\n\t\t\t}\n\n\t\t\t// Anything else, not globstar\n\t\t\telse {\n\n\t\t\t\t// States\n\t\t\t\tlet inBraces = false;\n\t\t\t\tlet braceVal = '';\n\n\t\t\t\tlet inBrackets = false;\n\t\t\t\tlet bracketVal = '';\n\n\t\t\t\tfor (const char of segment) {\n\n\t\t\t\t\t// Support brace expansion\n\t\t\t\t\tif (char !== '}' && inBraces) {\n\t\t\t\t\t\tbraceVal += char;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Support brackets\n\t\t\t\t\tif (inBrackets && (char !== ']' || !bracketVal) /* ] is literally only allowed as first character in brackets to match it */) {\n\t\t\t\t\t\tlet res: string;\n\n\t\t\t\t\t\t// range operator\n\t\t\t\t\t\tif (char === '-') {\n\t\t\t\t\t\t\tres = char;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// negation operator (only valid on first index in bracket)\n\t\t\t\t\t\telse if ((char === '^' || char === '!') && !bracketVal) {\n\t\t\t\t\t\t\tres = '^';\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// glob split matching is not allowed within character ranges\n\t\t\t\t\t\t// see http://man7.org/linux/man-pages/man7/glob.7.html\n\t\t\t\t\t\telse if (char === GLOB_SPLIT) {\n\t\t\t\t\t\t\tres = '';\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// anything else gets escaped\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tres = escapeRegExpCharacters(char);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbracketVal += res;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tswitch (char) {\n\t\t\t\t\t\tcase '{':\n\t\t\t\t\t\t\tinBraces = true;\n\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\tcase '[':\n\t\t\t\t\t\t\tinBrackets = true;\n\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\tcase '}': {\n\t\t\t\t\t\t\tconst choices = splitGlobAware(braceVal, ',');\n\n\t\t\t\t\t\t\t// Converts {foo,bar} => [foo|bar]\n\t\t\t\t\t\t\tconst braceRegExp = `(?:${choices.map(choice => parseRegExp(choice)).join('|')})`;\n\n\t\t\t\t\t\t\tregEx += braceRegExp;\n\n\t\t\t\t\t\t\tinBraces = false;\n\t\t\t\t\t\t\tbraceVal = '';\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcase ']': {\n\t\t\t\t\t\t\tregEx += ('[' + bracketVal + ']');\n\n\t\t\t\t\t\t\tinBrackets = false;\n\t\t\t\t\t\t\tbracketVal = '';\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcase '?':\n\t\t\t\t\t\t\tregEx += NO_PATH_REGEX; // 1 ? matches any single character except path separator (/ and \\)\n\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\tcase '*':\n\t\t\t\t\t\t\tregEx += starsToRegExp(1);\n\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tregEx += escapeRegExpCharacters(char);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Tail: Add the slash we had split on if there is more to\n\t\t\t\t// come and the remaining pattern is not a globstar\n\t\t\t\t// For example if pattern: some/**/*.js we want the \"/\" after\n\t\t\t\t// some to be included in the RegEx to prevent a folder called\n\t\t\t\t// \"something\" to match as well.\n\t\t\t\tif (\n\t\t\t\t\tindex < segments.length - 1 &&\t\t\t// more segments to come after this\n\t\t\t\t\t(\n\t\t\t\t\t\tsegments[index + 1] !== GLOBSTAR ||\t// next segment is not **, or...\n\t\t\t\t\t\tindex + 2 < segments.length\t\t\t// ...next segment is ** but there is more segments after that\n\t\t\t\t\t)\n\t\t\t\t) {\n\t\t\t\t\tregEx += PATH_REGEX;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// update globstar state\n\t\t\tpreviousSegmentWasGlobStar = (segment === GLOBSTAR);\n\t\t});\n\t}\n\n\treturn regEx;\n}\n\n// regexes to check for trivial glob patterns that just check for String#endsWith\nconst T1 = /^\\*\\*\\/\\*\\.[\\w\\.-]+$/; \t\t\t\t\t\t\t\t\t\t\t\t\t// **/*.something\nconst T2 = /^\\*\\*\\/([\\w\\.-]+)\\/?$/; \t\t\t\t\t\t\t\t\t\t\t\t// **/something\nconst T3 = /^{\\*\\*\\/\\*?[\\w\\.-]+\\/?(,\\*\\*\\/\\*?[\\w\\.-]+\\/?)*}$/; \t\t\t\t\t\t// {**/*.something,**/*.else} or {**/package.json,**/project.json}\nconst T3_2 = /^{\\*\\*\\/\\*?[\\w\\.-]+(\\/(\\*\\*)?)?(,\\*\\*\\/\\*?[\\w\\.-]+(\\/(\\*\\*)?)?)*}$/; \t// Like T3, with optional trailing /**\nconst T4 = /^\\*\\*((\\/[\\w\\.-]+)+)\\/?$/; \t\t\t\t\t\t\t\t\t\t\t\t// **/something/else\nconst T5 = /^([\\w\\.-]+(\\/[\\w\\.-]+)*)\\/?$/; \t\t\t\t\t\t\t\t\t\t\t// something/else\n\nexport type ParsedPattern = (path: string, basename?: string) => boolean;\n\n// The `ParsedExpression` returns a `Promise`\n// iff `hasSibling` returns a `Promise`.\nexport type ParsedExpression = (path: string, basename?: string, hasSibling?: (name: string) => boolean | Promise<boolean>) => string | null | Promise<string | null> /* the matching pattern */;\n\ninterface IGlobOptions {\n\n\t/**\n\t * Simplify patterns for use as exclusion filters during\n\t * tree traversal to skip entire subtrees. Cannot be used\n\t * outside of a tree traversal.\n\t */\n\ttrimForExclusions?: boolean;\n}\n\ninterface ParsedStringPattern {\n\t(path: string, basename?: string): string | null | Promise<string | null> /* the matching pattern */;\n\tbasenames?: string[];\n\tpatterns?: string[];\n\tallBasenames?: string[];\n\tallPaths?: string[];\n}\n\ninterface ParsedExpressionPattern {\n\t(path: string, basename?: string, name?: string, hasSibling?: (name: string) => boolean | Promise<boolean>): string | null | Promise<string | null> /* the matching pattern */;\n\trequiresSiblings?: boolean;\n\tallBasenames?: string[];\n\tallPaths?: string[];\n}\n\nconst CACHE = new LRUCache<string, ParsedStringPattern>(10000); // bounded to 10000 elements\n\nconst FALSE = function () {\n\treturn false;\n};\n\nconst NULL = function (): string | null {\n\treturn null;\n};\n\nfunction parsePattern(arg1: string | IRelativePattern, options: IGlobOptions): ParsedStringPattern {\n\tif (!arg1) {\n\t\treturn NULL;\n\t}\n\n\t// Handle relative patterns\n\tlet pattern: string;\n\tif (typeof arg1 !== 'string') {\n\t\tpattern = arg1.pattern;\n\t} else {\n\t\tpattern = arg1;\n\t}\n\n\t// Whitespace trimming\n\tpattern = pattern.trim();\n\n\t// Check cache\n\tconst patternKey = `${pattern}_${!!options.trimForExclusions}`;\n\tlet parsedPattern = CACHE.get(patternKey);\n\tif (parsedPattern) {\n\t\treturn wrapRelativePattern(parsedPattern, arg1);\n\t}\n\n\t// Check for Trivials\n\tlet match: RegExpExecArray | null;\n\tif (T1.test(pattern)) {\n\t\tparsedPattern = trivia1(pattern.substr(4), pattern); \t\t\t// common pattern: **/*.txt just need endsWith check\n\t} else if (match = T2.exec(trimForExclusions(pattern, options))) { \t// common pattern: **/some.txt just need basename check\n\t\tparsedPattern = trivia2(match[1], pattern);\n\t} else if ((options.trimForExclusions ? T3_2 : T3).test(pattern)) { // repetition of common patterns (see above) {**/*.txt,**/*.png}\n\t\tparsedPattern = trivia3(pattern, options);\n\t} else if (match = T4.exec(trimForExclusions(pattern, options))) { \t// common pattern: **/something/else just need endsWith check\n\t\tparsedPattern = trivia4and5(match[1].substr(1), pattern, true);\n\t} else if (match = T5.exec(trimForExclusions(pattern, options))) { \t// common pattern: something/else just need equals check\n\t\tparsedPattern = trivia4and5(match[1], pattern, false);\n\t}\n\n\t// Otherwise convert to pattern\n\telse {\n\t\tparsedPattern = toRegExp(pattern);\n\t}\n\n\t// Cache\n\tCACHE.set(patternKey, parsedPattern);\n\n\treturn wrapRelativePattern(parsedPattern, arg1);\n}\n\nfunction wrapRelativePattern(parsedPattern: ParsedStringPattern, arg2: string | IRelativePattern): ParsedStringPattern {\n\tif (typeof arg2 === 'string') {\n\t\treturn parsedPattern;\n\t}\n\n\tconst wrappedPattern: ParsedStringPattern = function (path, basename) {\n\t\tif (!isEqualOrParent(path, arg2.base, !isLinux)) {\n\t\t\t// skip glob matching if `base` is not a parent of `path`\n\t\t\treturn null;\n\t\t}\n\n\t\t// Given we have checked `base` being a parent of `path`,\n\t\t// we can now remove the `base` portion of the `path`\n\t\t// and only match on the remaining path components\n\t\treturn parsedPattern(path.substr(arg2.base.length + 1), basename);\n\t};\n\n\t// Make sure to preserve associated metadata\n\twrappedPattern.allBasenames = parsedPattern.allBasenames;\n\twrappedPattern.allPaths = parsedPattern.allPaths;\n\twrappedPattern.basenames = parsedPattern.basenames;\n\twrappedPattern.patterns = parsedPattern.patterns;\n\n\treturn wrappedPattern;\n}\n\nfunction trimForExclusions(pattern: string, options: IGlobOptions): string {\n\treturn options.trimForExclusions && pattern.endsWith('/**') ? pattern.substr(0, pattern.length - 2) : pattern; // dropping **, tailing / is dropped later\n}\n\n// common pattern: **/*.txt just need endsWith check\nfunction trivia1(base: string, pattern: string): ParsedStringPattern {\n\treturn function (path: string, basename?: string) {\n\t\treturn typeof path === 'string' && path.endsWith(base) ? pattern : null;\n\t};\n}\n\n// common pattern: **/some.txt just need basename check\nfunction trivia2(base: string, pattern: string): ParsedStringPattern {\n\tconst slashBase = `/${base}`;\n\tconst backslashBase = `\\\\${base}`;\n\n\tconst parsedPattern: ParsedStringPattern = function (path: string, basename?: string) {\n\t\tif (typeof path !== 'string') {\n\t\t\treturn null;\n\t\t}\n\n\t\tif (basename) {\n\t\t\treturn basename === base ? pattern : null;\n\t\t}\n\n\t\treturn path === base || path.endsWith(slashBase) || path.endsWith(backslashBase) ? pattern : null;\n\t};\n\n\tconst basenames = [base];\n\tparsedPattern.basenames = basenames;\n\tparsedPattern.patterns = [pattern];\n\tparsedPattern.allBasenames = basenames;\n\n\treturn parsedPattern;\n}\n\n// repetition of common patterns (see above) {**/*.txt,**/*.png}\nfunction trivia3(pattern: string, options: IGlobOptions): ParsedStringPattern {\n\tconst parsedPatterns = aggregateBasenameMatches(pattern.slice(1, -1)\n\t\t.split(',')\n\t\t.map(pattern => parsePattern(pattern, options))\n\t\t.filter(pattern => pattern !== NULL), pattern);\n\n\tconst patternsLength = parsedPatterns.length;\n\tif (!patternsLength) {\n\t\treturn NULL;\n\t}\n\n\tif (patternsLength === 1) {\n\t\treturn parsedPatterns[0];\n\t}\n\n\tconst parsedPattern: ParsedStringPattern = function (path: string, basename?: string) {\n\t\tfor (let i = 0, n = parsedPatterns.length; i < n; i++) {\n\t\t\tif (parsedPatterns[i](path, basename)) {\n\t\t\t\treturn pattern;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t};\n\n\tconst withBasenames = parsedPatterns.find(pattern => !!pattern.allBasenames);\n\tif (withBasenames) {\n\t\tparsedPattern.allBasenames = withBasenames.allBasenames;\n\t}\n\n\tconst allPaths = parsedPatterns.reduce((all, current) => current.allPaths ? all.concat(current.allPaths) : all, [] as string[]);\n\tif (allPaths.length) {\n\t\tparsedPattern.allPaths = allPaths;\n\t}\n\n\treturn parsedPattern;\n}\n\n// common patterns: **/something/else just need endsWith check, something/else just needs and equals check\nfunction trivia4and5(targetPath: string, pattern: string, matchPathEnds: boolean): ParsedStringPattern {\n\tconst usingPosixSep = sep === posix.sep;\n\tconst nativePath = usingPosixSep ? targetPath : targetPath.replace(ALL_FORWARD_SLASHES, sep);\n\tconst nativePathEnd = sep + nativePath;\n\tconst targetPathEnd = posix.sep + targetPath;\n\n\tlet parsedPattern: ParsedStringPattern;\n\tif (matchPathEnds) {\n\t\tparsedPattern = function (path: string, basename?: string) {\n\t\t\treturn typeof path === 'string' && ((path === nativePath || path.endsWith(nativePathEnd)) || !usingPosixSep && (path === targetPath || path.endsWith(targetPathEnd))) ? pattern : null;\n\t\t};\n\t} else {\n\t\tparsedPattern = function (path: string, basename?: string) {\n\t\t\treturn typeof path === 'string' && (path === nativePath || (!usingPosixSep && path === targetPath)) ? pattern : null;\n\t\t};\n\t}\n\n\tparsedPattern.allPaths = [(matchPathEnds ? '*/' : './') + targetPath];\n\n\treturn parsedPattern;\n}\n\nfunction toRegExp(pattern: string): ParsedStringPattern {\n\ttry {\n\t\tconst regExp = new RegExp(`^${parseRegExp(pattern)}$`);\n\t\treturn function (path: string) {\n\t\t\tregExp.lastIndex = 0; // reset RegExp to its initial state to reuse it!\n\n\t\t\treturn typeof path === 'string' && regExp.test(path) ? pattern : null;\n\t\t};\n\t} catch (error) {\n\t\treturn NULL;\n\t}\n}\n\n/**\n * Simplified glob matching. Supports a subset of glob patterns:\n * * `*` to match zero or more characters in a path segment\n * * `?` to match on one character in a path segment\n * * `**` to match any number of path segments, including none\n * * `{}` to group conditions (e.g. *.{ts,js} matches all TypeScript and JavaScript files)\n * * `[]` to declare a range of characters to match in a path segment (e.g., `example.[0-9]` to match on `example.0`, `example.1`, )\n * * `[!...]` to negate a range of characters to match in a path segment (e.g., `example.[!0-9]` to match on `example.a`, `example.b`, but not `example.0`)\n */\nexport function match(pattern: string | IRelativePattern, path: string): boolean;\nexport function match(expression: IExpression, path: string, hasSibling?: (name: string) => boolean): string /* the matching pattern */;\nexport function match(arg1: string | IExpression | IRelativePattern, path: string, hasSibling?: (name: string) => boolean): boolean | string | null | Promise<string | null> {\n\tif (!arg1 || typeof path !== 'string') {\n\t\treturn false;\n\t}\n\n\treturn parse(arg1)(path, undefined, hasSibling);\n}\n\n/**\n * Simplified glob matching. Supports a subset of glob patterns:\n * * `*` to match zero or more characters in a path segment\n * * `?` to match on one character in a path segment\n * * `**` to match any number of path segments, including none\n * * `{}` to group conditions (e.g. *.{ts,js} matches all TypeScript and JavaScript files)\n * * `[]` to declare a range of characters to match in a path segment (e.g., `example.[0-9]` to match on `example.0`, `example.1`, )\n * * `[!...]` to negate a range of characters to match in a path segment (e.g., `example.[!0-9]` to match on `example.a`, `example.b`, but not `example.0`)\n */\nexport function parse(pattern: string | IRelativePattern, options?: IGlobOptions): ParsedPattern;\nexport function parse(expression: IExpression, options?: IGlobOptions): ParsedExpression;\nexport function parse(arg1: string | IExpression | IRelativePattern, options?: IGlobOptions): ParsedPattern | ParsedExpression;\nexport function parse(arg1: string | IExpression | IRelativePattern, options: IGlobOptions = {}): ParsedPattern | ParsedExpression {\n\tif (!arg1) {\n\t\treturn FALSE;\n\t}\n\n\t// Glob with String\n\tif (typeof arg1 === 'string' || isRelativePattern(arg1)) {\n\t\tconst parsedPattern = parsePattern(arg1, options);\n\t\tif (parsedPattern === NULL) {\n\t\t\treturn FALSE;\n\t\t}\n\n\t\tconst resultPattern: ParsedPattern & { allBasenames?: string[]; allPaths?: string[] } = function (path: string, basename?: string) {\n\t\t\treturn !!parsedPattern(path, basename);\n\t\t};\n\n\t\tif (parsedPattern.allBasenames) {\n\t\t\tresultPattern.allBasenames = parsedPattern.allBasenames;\n\t\t}\n\n\t\tif (parsedPattern.allPaths) {\n\t\t\tresultPattern.allPaths = parsedPattern.allPaths;\n\t\t}\n\n\t\treturn resultPattern;\n\t}\n\n\t// Glob with Expression\n\treturn parsedExpression(<IExpression>arg1, options);\n}\n\nexport function isRelativePattern(obj: unknown): obj is IRelativePattern {\n\tconst rp = obj as IRelativePattern | undefined | null;\n\tif (!rp) {\n\t\treturn false;\n\t}\n\n\treturn typeof rp.base === 'string' && typeof rp.pattern === 'string';\n}\n\nexport function getBasenameTerms(patternOrExpression: ParsedPattern | ParsedExpression): string[] {\n\treturn (<ParsedStringPattern>patternOrExpression).allBasenames || [];\n}\n\nexport function getPathTerms(patternOrExpression: ParsedPattern | ParsedExpression): string[] {\n\treturn (<ParsedStringPattern>patternOrExpression).allPaths || [];\n}\n\nfunction parsedExpression(expression: IExpression, options: IGlobOptions): ParsedExpression {\n\tconst parsedPatterns = aggregateBasenameMatches(Object.getOwnPropertyNames(expression)\n\t\t.map(pattern => parseExpressionPattern(pattern, expression[pattern], options))\n\t\t.filter(pattern => pattern !== NULL));\n\n\tconst patternsLength = parsedPatterns.length;\n\tif (!patternsLength) {\n\t\treturn NULL;\n\t}\n\n\tif (!parsedPatterns.some(parsedPattern => !!(<ParsedExpressionPattern>parsedPattern).requiresSiblings)) {\n\t\tif (patternsLength === 1) {\n\t\t\treturn parsedPatterns[0] as ParsedStringPattern;\n\t\t}\n\n\t\tconst resultExpression: ParsedStringPattern = function (path: string, basename?: string) {\n\t\t\tlet resultPromises: Promise<string | null>[] | undefined = undefined;\n\n\t\t\tfor (let i = 0, n = parsedPatterns.length; i < n; i++) {\n\t\t\t\tconst result = parsedPatterns[i](path, basename);\n\t\t\t\tif (typeof result === 'string') {\n\t\t\t\t\treturn result; // immediately return as soon as the first expression matches\n\t\t\t\t}\n\n\t\t\t\t// If the result is a promise, we have to keep it for\n\t\t\t\t// later processing and await the result properly.\n\t\t\t\tif (isThenable(result)) {\n\t\t\t\t\tif (!resultPromises) {\n\t\t\t\t\t\tresultPromises = [];\n\t\t\t\t\t}\n\n\t\t\t\t\tresultPromises.push(result);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// With result promises, we have to loop over each and\n\t\t\t// await the result before we can return any result.\n\t\t\tif (resultPromises) {\n\t\t\t\treturn (async () => {\n\t\t\t\t\tfor (const resultPromise of resultPromises) {\n\t\t\t\t\t\tconst result = await resultPromise;\n\t\t\t\t\t\tif (typeof result === 'string') {\n\t\t\t\t\t\t\treturn result;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn null;\n\t\t\t\t})();\n\t\t\t}\n\n\t\t\treturn null;\n\t\t};\n\n\t\tconst withBasenames = parsedPatterns.find(pattern => !!pattern.allBasenames);\n\t\tif (withBasenames) {\n\t\t\tresultExpression.allBasenames = withBasenames.allBasenames;\n\t\t}\n\n\t\tconst allPaths = parsedPatterns.reduce((all, current) => current.allPaths ? all.concat(current.allPaths) : all, [] as string[]);\n\t\tif (allPaths.length) {\n\t\t\tresultExpression.allPaths = allPaths;\n\t\t}\n\n\t\treturn resultExpression;\n\t}\n\n\tconst resultExpression: ParsedStringPattern = function (path: string, base?: string, hasSibling?: (name: string) => boolean | Promise<boolean>) {\n\t\tlet name: string | undefined = undefined;\n\t\tlet resultPromises: Promise<string | null>[] | undefined = undefined;\n\n\t\tfor (let i = 0, n = parsedPatterns.length; i < n; i++) {\n\n\t\t\t// Pattern matches path\n\t\t\tconst parsedPattern = (<ParsedExpressionPattern>parsedPatterns[i]);\n\t\t\tif (parsedPattern.requiresSiblings && hasSibling) {\n\t\t\t\tif (!base) {\n\t\t\t\t\tbase = basename(path);\n\t\t\t\t}\n\n\t\t\t\tif (!name) {\n\t\t\t\t\tname = base.substr(0, base.length - extname(path).length);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst result = parsedPattern(path, base, name, hasSibling);\n\t\t\tif (typeof result === 'string') {\n\t\t\t\treturn result; // immediately return as soon as the first expression matches\n\t\t\t}\n\n\t\t\t// If the result is a promise, we have to keep it for\n\t\t\t// later processing and await the result properly.\n\t\t\tif (isThenable(result)) {\n\t\t\t\tif (!resultPromises) {\n\t\t\t\t\tresultPromises = [];\n\t\t\t\t}\n\n\t\t\t\tresultPromises.push(result);\n\t\t\t}\n\t\t}\n\n\t\t// With result promises, we have to loop over each and\n\t\t// await the result before we can return any result.\n\t\tif (resultPromises) {\n\t\t\treturn (async () => {\n\t\t\t\tfor (const resultPromise of resultPromises) {\n\t\t\t\t\tconst result = await resultPromise;\n\t\t\t\t\tif (typeof result === 'string') {\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t})();\n\t\t}\n\n\t\treturn null;\n\t};\n\n\tconst withBasenames = parsedPatterns.find(pattern => !!pattern.allBasenames);\n\tif (withBasenames) {\n\t\tresultExpression.allBasenames = withBasenames.allBasenames;\n\t}\n\n\tconst allPaths = parsedPatterns.reduce((all, current) => current.allPaths ? all.concat(current.allPaths) : all, [] as string[]);\n\tif (allPaths.length) {\n\t\tresultExpression.allPaths = allPaths;\n\t}\n\n\treturn resultExpression;\n}\n\nfunction parseExpressionPattern(pattern: string, value: boolean | SiblingClause, options: IGlobOptions): (ParsedStringPattern | ParsedExpressionPattern) {\n\tif (value === false) {\n\t\treturn NULL; // pattern is disabled\n\t}\n\n\tconst parsedPattern = parsePattern(pattern, options);\n\tif (parsedPattern === NULL) {\n\t\treturn NULL;\n\t}\n\n\t// Expression Pattern is <boolean>\n\tif (typeof value === 'boolean') {\n\t\treturn parsedPattern;\n\t}\n\n\t// Expression Pattern is <SiblingClause>\n\tif (value) {\n\t\tconst when = value.when;\n\t\tif (typeof when === 'string') {\n\t\t\tconst result: ParsedExpressionPattern = (path: string, basename?: string, name?: string, hasSibling?: (name: string) => boolean | Promise<boolean>) => {\n\t\t\t\tif (!hasSibling || !parsedPattern(path, basename)) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tconst clausePattern = when.replace('$(basename)', name!);\n\t\t\t\tconst matched = hasSibling(clausePattern);\n\t\t\t\treturn isThenable(matched) ?\n\t\t\t\t\tmatched.then(match => match ? pattern : null) :\n\t\t\t\t\tmatched ? pattern : null;\n\t\t\t};\n\n\t\t\tresult.requiresSiblings = true;\n\n\t\t\treturn result;\n\t\t}\n\t}\n\n\t// Expression is anything\n\treturn parsedPattern;\n}\n\nfunction aggregateBasenameMatches(parsedPatterns: Array<ParsedStringPattern | ParsedExpressionPattern>, result?: string): Array<ParsedStringPattern | ParsedExpressionPattern> {\n\tconst basenamePatterns = parsedPatterns.filter(parsedPattern => !!(<ParsedStringPattern>parsedPattern).basenames);\n\tif (basenamePatterns.length < 2) {\n\t\treturn parsedPatterns;\n\t}\n\n\tconst basenames = basenamePatterns.reduce<string[]>((all, current) => {\n\t\tconst basenames = (<ParsedStringPattern>current).basenames;\n\n\t\treturn basenames ? all.concat(basenames) : all;\n\t}, [] as string[]);\n\n\tlet patterns: string[];\n\tif (result) {\n\t\tpatterns = [];\n\n\t\tfor (let i = 0, n = basenames.length; i < n; i++) {\n\t\t\tpatterns.push(result);\n\t\t}\n\t} else {\n\t\tpatterns = basenamePatterns.reduce((all, current) => {\n\t\t\tconst patterns = (<ParsedStringPattern>current).patterns;\n\n\t\t\treturn patterns ? all.concat(patterns) : all;\n\t\t}, [] as string[]);\n\t}\n\n\tconst aggregate: ParsedStringPattern = function (path: string, basename?: string) {\n\t\tif (typeof path !== 'string') {\n\t\t\treturn null;\n\t\t}\n\n\t\tif (!basename) {\n\t\t\tlet i: number;\n\t\t\tfor (i = path.length; i > 0; i--) {\n\t\t\t\tconst ch = path.charCodeAt(i - 1);\n\t\t\t\tif (ch === CharCode.Slash || ch === CharCode.Backslash) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tbasename = path.substr(i);\n\t\t}\n\n\t\tconst index = basenames.indexOf(basename);\n\t\treturn index !== -1 ? patterns[index] : null;\n\t};\n\n\taggregate.basenames = basenames;\n\taggregate.patterns = patterns;\n\taggregate.allBasenames = basenames;\n\n\tconst aggregatedPatterns = parsedPatterns.filter(parsedPattern => !(<ParsedStringPattern>parsedPattern).basenames);\n\taggregatedPatterns.push(aggregate);\n\n\treturn aggregatedPatterns;\n}\n\nexport function patternsEquals(patternsA: Array<string | IRelativePattern> | undefined, patternsB: Array<string | IRelativePattern> | undefined): boolean {\n\treturn equals(patternsA, patternsB, (a, b) => {\n\t\tif (typeof a === 'string' && typeof b === 'string') {\n\t\t\treturn a === b;\n\t\t}\n\n\t\tif (typeof a !== 'string' && typeof b !== 'string') {\n\t\t\treturn a.base === b.base && a.pattern === b.pattern;\n\t\t}\n\n\t\treturn false;\n\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { illegalArgument } from 'vs/base/common/errors';\nimport { escapeIcons } from 'vs/base/common/iconLabels';\nimport { isEqual } from 'vs/base/common/resources';\nimport { escapeRegExpCharacters } from 'vs/base/common/strings';\nimport { URI, UriComponents } from 'vs/base/common/uri';\n\nexport interface IMarkdownString {\n\treadonly value: string;\n\treadonly isTrusted?: boolean;\n\treadonly supportThemeIcons?: boolean;\n\treadonly supportHtml?: boolean;\n\treadonly baseUri?: UriComponents;\n\turis?: { [href: string]: UriComponents };\n}\n\nexport const enum MarkdownStringTextNewlineStyle {\n\tParagraph = 0,\n\tBreak = 1,\n}\n\nexport class MarkdownString implements IMarkdownString {\n\n\tpublic value: string;\n\tpublic isTrusted?: boolean;\n\tpublic supportThemeIcons?: boolean;\n\tpublic supportHtml?: boolean;\n\tpublic baseUri?: URI;\n\n\tconstructor(\n\t\tvalue: string = '',\n\t\tisTrustedOrOptions: boolean | { isTrusted?: boolean; supportThemeIcons?: boolean; supportHtml?: boolean } = false,\n\t) {\n\t\tthis.value = value;\n\t\tif (typeof this.value !== 'string') {\n\t\t\tthrow illegalArgument('value');\n\t\t}\n\n\t\tif (typeof isTrustedOrOptions === 'boolean') {\n\t\t\tthis.isTrusted = isTrustedOrOptions;\n\t\t\tthis.supportThemeIcons = false;\n\t\t\tthis.supportHtml = false;\n\t\t}\n\t\telse {\n\t\t\tthis.isTrusted = isTrustedOrOptions.isTrusted ?? undefined;\n\t\t\tthis.supportThemeIcons = isTrustedOrOptions.supportThemeIcons ?? false;\n\t\t\tthis.supportHtml = isTrustedOrOptions.supportHtml ?? false;\n\t\t}\n\t}\n\n\tappendText(value: string, newlineStyle: MarkdownStringTextNewlineStyle = MarkdownStringTextNewlineStyle.Paragraph): MarkdownString {\n\t\tthis.value += escapeMarkdownSyntaxTokens(this.supportThemeIcons ? escapeIcons(value) : value)\n\t\t\t.replace(/([ \\t]+)/g, (_match, g1) => '&nbsp;'.repeat(g1.length))\n\t\t\t.replace(/\\>/gm, '\\\\>')\n\t\t\t.replace(/\\n/g, newlineStyle === MarkdownStringTextNewlineStyle.Break ? '\\\\\\n' : '\\n\\n');\n\n\t\treturn this;\n\t}\n\n\tappendMarkdown(value: string): MarkdownString {\n\t\tthis.value += value;\n\t\treturn this;\n\t}\n\n\tappendCodeblock(langId: string, code: string): MarkdownString {\n\t\tthis.value += '\\n```';\n\t\tthis.value += langId;\n\t\tthis.value += '\\n';\n\t\tthis.value += code;\n\t\tthis.value += '\\n```\\n';\n\t\treturn this;\n\t}\n\n\tappendLink(target: URI | string, label: string, title?: string): MarkdownString {\n\t\tthis.value += '[';\n\t\tthis.value += this._escape(label, ']');\n\t\tthis.value += '](';\n\t\tthis.value += this._escape(String(target), ')');\n\t\tif (title) {\n\t\t\tthis.value += ` \"${this._escape(this._escape(title, '\"'), ')')}\"`;\n\t\t}\n\t\tthis.value += ')';\n\t\treturn this;\n\t}\n\n\tprivate _escape(value: string, ch: string): string {\n\t\tconst r = new RegExp(escapeRegExpCharacters(ch), 'g');\n\t\treturn value.replace(r, (match, offset) => {\n\t\t\tif (value.charAt(offset - 1) !== '\\\\') {\n\t\t\t\treturn `\\\\${match}`;\n\t\t\t} else {\n\t\t\t\treturn match;\n\t\t\t}\n\t\t});\n\t}\n}\n\nexport function isEmptyMarkdownString(oneOrMany: IMarkdownString | IMarkdownString[] | null | undefined): boolean {\n\tif (isMarkdownString(oneOrMany)) {\n\t\treturn !oneOrMany.value;\n\t} else if (Array.isArray(oneOrMany)) {\n\t\treturn oneOrMany.every(isEmptyMarkdownString);\n\t} else {\n\t\treturn true;\n\t}\n}\n\nexport function isMarkdownString(thing: any): thing is IMarkdownString {\n\tif (thing instanceof MarkdownString) {\n\t\treturn true;\n\t} else if (thing && typeof thing === 'object') {\n\t\treturn typeof (<IMarkdownString>thing).value === 'string'\n\t\t\t&& (typeof (<IMarkdownString>thing).isTrusted === 'boolean' || (<IMarkdownString>thing).isTrusted === undefined)\n\t\t\t&& (typeof (<IMarkdownString>thing).supportThemeIcons === 'boolean' || (<IMarkdownString>thing).supportThemeIcons === undefined);\n\t}\n\treturn false;\n}\n\nexport function markdownStringEqual(a: IMarkdownString, b: IMarkdownString): boolean {\n\tif (a === b) {\n\t\treturn true;\n\t} else if (!a || !b) {\n\t\treturn false;\n\t} else {\n\t\treturn a.value === b.value\n\t\t\t&& a.isTrusted === b.isTrusted\n\t\t\t&& a.supportThemeIcons === b.supportThemeIcons\n\t\t\t&& a.supportHtml === b.supportHtml\n\t\t\t&& (a.baseUri === b.baseUri || !!a.baseUri && !!b.baseUri && isEqual(URI.from(a.baseUri), URI.from(b.baseUri)));\n\t}\n}\n\nexport function escapeMarkdownSyntaxTokens(text: string): string {\n\t// escape markdown syntax tokens: http://daringfireball.net/projects/markdown/syntax#backslash\n\treturn text.replace(/[\\\\`*_{}[\\]()#+\\-!]/g, '\\\\$&');\n}\n\nexport function escapeDoubleQuotes(input: string) {\n\treturn input.replace(/\"/g, '&quot;');\n}\n\nexport function removeMarkdownEscapes(text: string): string {\n\tif (!text) {\n\t\treturn text;\n\t}\n\treturn text.replace(/\\\\([\\\\`*_{}[\\]()#+\\-.!])/g, '$1');\n}\n\nexport function parseHrefAndDimensions(href: string): { href: string; dimensions: string[] } {\n\tconst dimensions: string[] = [];\n\tconst splitted = href.split('|').map(s => s.trim());\n\thref = splitted[0];\n\tconst parameters = splitted[1];\n\tif (parameters) {\n\t\tconst heightFromParams = /height=(\\d+)/.exec(parameters);\n\t\tconst widthFromParams = /width=(\\d+)/.exec(parameters);\n\t\tconst height = heightFromParams ? heightFromParams[1] : '';\n\t\tconst width = widthFromParams ? widthFromParams[1] : '';\n\t\tconst widthIsFinite = isFinite(parseInt(width));\n\t\tconst heightIsFinite = isFinite(parseInt(height));\n\t\tif (widthIsFinite) {\n\t\t\tdimensions.push(`width=\"${width}\"`);\n\t\t}\n\t\tif (heightIsFinite) {\n\t\t\tdimensions.push(`height=\"${height}\"`);\n\t\t}\n\t}\n\treturn { href, dimensions };\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { firstOrDefault } from 'vs/base/common/arrays';\nimport { hasDriveLetter, toSlashes } from 'vs/base/common/extpath';\nimport { posix, sep, win32 } from 'vs/base/common/path';\nimport { isMacintosh, isWindows, OperatingSystem, OS } from 'vs/base/common/platform';\nimport { extUri, extUriIgnorePathCase } from 'vs/base/common/resources';\nimport { rtrim, startsWithIgnoreCase } from 'vs/base/common/strings';\nimport { URI } from 'vs/base/common/uri';\n\nexport interface IPathLabelFormatting {\n\n\t/**\n\t * The OS the path label is from to produce a label\n\t * that matches OS expectations.\n\t */\n\treadonly os: OperatingSystem;\n\n\t/**\n\t * Whether to add a `~` when the path is in the\n\t * user home directory.\n\t *\n\t * Note: this only applies to Linux, macOS but not\n\t * Windows.\n\t */\n\treadonly tildify?: IUserHomeProvider;\n\n\t/**\n\t * Whether to convert to a relative path if the path\n\t * is within any of the opened workspace folders.\n\t */\n\treadonly relative?: IRelativePathProvider;\n}\n\nexport interface IRelativePathProvider {\n\n\t/**\n\t * Whether to not add a prefix when in multi-root workspace.\n\t */\n\treadonly noPrefix?: boolean;\n\n\tgetWorkspace(): { folders: { uri: URI; name?: string }[] };\n\tgetWorkspaceFolder(resource: URI): { uri: URI; name?: string } | null;\n}\n\nexport interface IUserHomeProvider {\n\tuserHome: URI;\n}\n\nexport function getPathLabel(resource: URI, formatting: IPathLabelFormatting): string {\n\tconst { os, tildify: tildifier, relative: relatifier } = formatting;\n\n\t// return early with a relative path if we can resolve one\n\tif (relatifier) {\n\t\tconst relativePath = getRelativePathLabel(resource, relatifier, os);\n\t\tif (typeof relativePath === 'string') {\n\t\t\treturn relativePath;\n\t\t}\n\t}\n\n\t// otherwise try to resolve a absolute path label and\n\t// apply target OS standard path separators if target\n\t// OS differs from actual OS we are running in\n\tlet absolutePath = resource.fsPath;\n\tif (os === OperatingSystem.Windows && !isWindows) {\n\t\tabsolutePath = absolutePath.replace(/\\//g, '\\\\');\n\t} else if (os !== OperatingSystem.Windows && isWindows) {\n\t\tabsolutePath = absolutePath.replace(/\\\\/g, '/');\n\t}\n\n\t// macOS/Linux: tildify with provided user home directory\n\tif (os !== OperatingSystem.Windows && tildifier?.userHome) {\n\t\tconst userHome = tildifier.userHome.fsPath;\n\n\t\t// This is a bit of a hack, but in order to figure out if the\n\t\t// resource is in the user home, we need to make sure to convert it\n\t\t// to a user home resource. We cannot assume that the resource is\n\t\t// already a user home resource.\n\t\tlet userHomeCandidate: string;\n\t\tif (resource.scheme !== tildifier.userHome.scheme && resource.path.startsWith(posix.sep)) {\n\t\t\tuserHomeCandidate = tildifier.userHome.with({ path: resource.path }).fsPath;\n\t\t} else {\n\t\t\tuserHomeCandidate = resource.fsPath;\n\t\t}\n\n\t\tabsolutePath = tildify(userHomeCandidate, userHome, os);\n\t}\n\n\t// normalize\n\tconst pathLib = os === OperatingSystem.Windows ? win32 : posix;\n\treturn pathLib.normalize(normalizeDriveLetter(absolutePath, os === OperatingSystem.Windows));\n}\n\nfunction getRelativePathLabel(resource: URI, relativePathProvider: IRelativePathProvider, os: OperatingSystem): string | undefined {\n\tconst pathLib = os === OperatingSystem.Windows ? win32 : posix;\n\tconst extUriLib = os === OperatingSystem.Linux ? extUri : extUriIgnorePathCase;\n\n\tconst workspace = relativePathProvider.getWorkspace();\n\tconst firstFolder = firstOrDefault(workspace.folders);\n\tif (!firstFolder) {\n\t\treturn undefined;\n\t}\n\n\t// This is a bit of a hack, but in order to figure out the folder\n\t// the resource belongs to, we need to make sure to convert it\n\t// to a workspace resource. We cannot assume that the resource is\n\t// already matching the workspace.\n\tif (resource.scheme !== firstFolder.uri.scheme && resource.path.startsWith(posix.sep)) {\n\t\tresource = firstFolder.uri.with({ path: resource.path });\n\t}\n\n\tconst folder = relativePathProvider.getWorkspaceFolder(resource);\n\tif (!folder) {\n\t\treturn undefined;\n\t}\n\n\tlet relativePathLabel: string | undefined = undefined;\n\tif (extUriLib.isEqual(folder.uri, resource)) {\n\t\trelativePathLabel = ''; // no label if paths are identical\n\t} else {\n\t\trelativePathLabel = extUriLib.relativePath(folder.uri, resource) ?? '';\n\t}\n\n\t// normalize\n\tif (relativePathLabel) {\n\t\trelativePathLabel = pathLib.normalize(relativePathLabel);\n\t}\n\n\t// always show root basename if there are multiple folders\n\tif (workspace.folders.length > 1 && !relativePathProvider.noPrefix) {\n\t\tconst rootName = folder.name ? folder.name : extUriLib.basenameOrAuthority(folder.uri);\n\t\trelativePathLabel = relativePathLabel ? `${rootName}  ${relativePathLabel}` : rootName;\n\t}\n\n\treturn relativePathLabel;\n}\n\nexport function normalizeDriveLetter(path: string, isWindowsOS: boolean = isWindows): string {\n\tif (hasDriveLetter(path, isWindowsOS)) {\n\t\treturn path.charAt(0).toUpperCase() + path.slice(1);\n\t}\n\n\treturn path;\n}\n\nlet normalizedUserHomeCached: { original: string; normalized: string } = Object.create(null);\nexport function tildify(path: string, userHome: string, os = OS): string {\n\tif (os === OperatingSystem.Windows || !path || !userHome) {\n\t\treturn path; // unsupported on Windows\n\t}\n\n\tlet normalizedUserHome = normalizedUserHomeCached.original === userHome ? normalizedUserHomeCached.normalized : undefined;\n\tif (!normalizedUserHome) {\n\t\tnormalizedUserHome = userHome;\n\t\tif (isWindows) {\n\t\t\tnormalizedUserHome = toSlashes(normalizedUserHome); // make sure that the path is POSIX normalized on Windows\n\t\t}\n\t\tnormalizedUserHome = `${rtrim(normalizedUserHome, posix.sep)}${posix.sep}`;\n\t\tnormalizedUserHomeCached = { original: userHome, normalized: normalizedUserHome };\n\t}\n\n\tlet normalizedPath = path;\n\tif (isWindows) {\n\t\tnormalizedPath = toSlashes(normalizedPath); // make sure that the path is POSIX normalized on Windows\n\t}\n\n\t// Linux: case sensitive, macOS: case insensitive\n\tif (os === OperatingSystem.Linux ? normalizedPath.startsWith(normalizedUserHome) : startsWithIgnoreCase(normalizedPath, normalizedUserHome)) {\n\t\treturn `~/${normalizedPath.substr(normalizedUserHome.length)}`;\n\t}\n\n\treturn path;\n}\n\nexport function untildify(path: string, userHome: string): string {\n\treturn path.replace(/^~($|\\/|\\\\)/, `${userHome}$1`);\n}\n\n/**\n * Shortens the paths but keeps them easy to distinguish.\n * Replaces not important parts with ellipsis.\n * Every shorten path matches only one original path and vice versa.\n *\n * Algorithm for shortening paths is as follows:\n * 1. For every path in list, find unique substring of that path.\n * 2. Unique substring along with ellipsis is shortened path of that path.\n * 3. To find unique substring of path, consider every segment of length from 1 to path.length of path from end of string\n *    and if present segment is not substring to any other paths then present segment is unique path,\n *    else check if it is not present as suffix of any other path and present segment is suffix of path itself,\n *    if it is true take present segment as unique path.\n * 4. Apply ellipsis to unique segment according to whether segment is present at start/in-between/end of path.\n *\n * Example 1\n * 1. consider 2 paths i.e. ['a\\\\b\\\\c\\\\d', 'a\\\\f\\\\b\\\\c\\\\d']\n * 2. find unique path of first path,\n * \ta. 'd' is present in path2 and is suffix of path2, hence not unique of present path.\n * \tb. 'c' is present in path2 and 'c' is not suffix of present path, similarly for 'b' and 'a' also.\n * \tc. 'd\\\\c' is suffix of path2.\n *  d. 'b\\\\c' is not suffix of present path.\n *  e. 'a\\\\b' is not present in path2, hence unique path is 'a\\\\b...'.\n * 3. for path2, 'f' is not present in path1 hence unique is '...\\\\f\\\\...'.\n *\n * Example 2\n * 1. consider 2 paths i.e. ['a\\\\b', 'a\\\\b\\\\c'].\n * \ta. Even if 'b' is present in path2, as 'b' is suffix of path1 and is not suffix of path2, unique path will be '...\\\\b'.\n * 2. for path2, 'c' is not present in path1 hence unique path is '..\\\\c'.\n */\nconst ellipsis = '\\u2026';\nconst unc = '\\\\\\\\';\nconst home = '~';\nexport function shorten(paths: string[], pathSeparator: string = sep): string[] {\n\tconst shortenedPaths: string[] = new Array(paths.length);\n\n\t// for every path\n\tlet match = false;\n\tfor (let pathIndex = 0; pathIndex < paths.length; pathIndex++) {\n\t\tconst originalPath = paths[pathIndex];\n\n\t\tif (originalPath === '') {\n\t\t\tshortenedPaths[pathIndex] = `.${pathSeparator}`;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!originalPath) {\n\t\t\tshortenedPaths[pathIndex] = originalPath;\n\t\t\tcontinue;\n\t\t}\n\n\t\tmatch = true;\n\n\t\t// trim for now and concatenate unc path (e.g. \\\\network) or root path (/etc, ~/etc) later\n\t\tlet prefix = '';\n\t\tlet trimmedPath = originalPath;\n\t\tif (trimmedPath.indexOf(unc) === 0) {\n\t\t\tprefix = trimmedPath.substr(0, trimmedPath.indexOf(unc) + unc.length);\n\t\t\ttrimmedPath = trimmedPath.substr(trimmedPath.indexOf(unc) + unc.length);\n\t\t} else if (trimmedPath.indexOf(pathSeparator) === 0) {\n\t\t\tprefix = trimmedPath.substr(0, trimmedPath.indexOf(pathSeparator) + pathSeparator.length);\n\t\t\ttrimmedPath = trimmedPath.substr(trimmedPath.indexOf(pathSeparator) + pathSeparator.length);\n\t\t} else if (trimmedPath.indexOf(home) === 0) {\n\t\t\tprefix = trimmedPath.substr(0, trimmedPath.indexOf(home) + home.length);\n\t\t\ttrimmedPath = trimmedPath.substr(trimmedPath.indexOf(home) + home.length);\n\t\t}\n\n\t\t// pick the first shortest subpath found\n\t\tconst segments: string[] = trimmedPath.split(pathSeparator);\n\t\tfor (let subpathLength = 1; match && subpathLength <= segments.length; subpathLength++) {\n\t\t\tfor (let start = segments.length - subpathLength; match && start >= 0; start--) {\n\t\t\t\tmatch = false;\n\t\t\t\tlet subpath = segments.slice(start, start + subpathLength).join(pathSeparator);\n\n\t\t\t\t// that is unique to any other path\n\t\t\t\tfor (let otherPathIndex = 0; !match && otherPathIndex < paths.length; otherPathIndex++) {\n\n\t\t\t\t\t// suffix subpath treated specially as we consider no match 'x' and 'x/...'\n\t\t\t\t\tif (otherPathIndex !== pathIndex && paths[otherPathIndex] && paths[otherPathIndex].indexOf(subpath) > -1) {\n\t\t\t\t\t\tconst isSubpathEnding: boolean = (start + subpathLength === segments.length);\n\n\t\t\t\t\t\t// Adding separator as prefix for subpath, such that 'endsWith(src, trgt)' considers subpath as directory name instead of plain string.\n\t\t\t\t\t\t// prefix is not added when either subpath is root directory or path[otherPathIndex] does not have multiple directories.\n\t\t\t\t\t\tconst subpathWithSep: string = (start > 0 && paths[otherPathIndex].indexOf(pathSeparator) > -1) ? pathSeparator + subpath : subpath;\n\t\t\t\t\t\tconst isOtherPathEnding: boolean = paths[otherPathIndex].endsWith(subpathWithSep);\n\n\t\t\t\t\t\tmatch = !isSubpathEnding || isOtherPathEnding;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// found unique subpath\n\t\t\t\tif (!match) {\n\t\t\t\t\tlet result = '';\n\n\t\t\t\t\t// preserve disk drive or root prefix\n\t\t\t\t\tif (segments[0].endsWith(':') || prefix !== '') {\n\t\t\t\t\t\tif (start === 1) {\n\t\t\t\t\t\t\t// extend subpath to include disk drive prefix\n\t\t\t\t\t\t\tstart = 0;\n\t\t\t\t\t\t\tsubpathLength++;\n\t\t\t\t\t\t\tsubpath = segments[0] + pathSeparator + subpath;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (start > 0) {\n\t\t\t\t\t\t\tresult = segments[0] + pathSeparator;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tresult = prefix + result;\n\t\t\t\t\t}\n\n\t\t\t\t\t// add ellipsis at the beginning if needed\n\t\t\t\t\tif (start > 0) {\n\t\t\t\t\t\tresult = result + ellipsis + pathSeparator;\n\t\t\t\t\t}\n\n\t\t\t\t\tresult = result + subpath;\n\n\t\t\t\t\t// add ellipsis at the end if needed\n\t\t\t\t\tif (start + subpathLength < segments.length) {\n\t\t\t\t\t\tresult = result + pathSeparator + ellipsis;\n\t\t\t\t\t}\n\n\t\t\t\t\tshortenedPaths[pathIndex] = result;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (match) {\n\t\t\tshortenedPaths[pathIndex] = originalPath; // use original path if no unique subpaths found\n\t\t}\n\t}\n\n\treturn shortenedPaths;\n}\n\nexport interface ISeparator {\n\tlabel: string;\n}\n\nenum Type {\n\tTEXT,\n\tVARIABLE,\n\tSEPARATOR\n}\n\ninterface ISegment {\n\tvalue: string;\n\ttype: Type;\n}\n\n/**\n * Helper to insert values for specific template variables into the string. E.g. \"this $(is) a $(template)\" can be\n * passed to this function together with an object that maps \"is\" and \"template\" to strings to have them replaced.\n * @param value string to which template is applied\n * @param values the values of the templates to use\n */\nexport function template(template: string, values: { [key: string]: string | ISeparator | undefined | null } = Object.create(null)): string {\n\tconst segments: ISegment[] = [];\n\n\tlet inVariable = false;\n\tlet curVal = '';\n\tfor (const char of template) {\n\t\t// Beginning of variable\n\t\tif (char === '$' || (inVariable && char === '{')) {\n\t\t\tif (curVal) {\n\t\t\t\tsegments.push({ value: curVal, type: Type.TEXT });\n\t\t\t}\n\n\t\t\tcurVal = '';\n\t\t\tinVariable = true;\n\t\t}\n\n\t\t// End of variable\n\t\telse if (char === '}' && inVariable) {\n\t\t\tconst resolved = values[curVal];\n\n\t\t\t// Variable\n\t\t\tif (typeof resolved === 'string') {\n\t\t\t\tif (resolved.length) {\n\t\t\t\t\tsegments.push({ value: resolved, type: Type.VARIABLE });\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Separator\n\t\t\telse if (resolved) {\n\t\t\t\tconst prevSegment = segments[segments.length - 1];\n\t\t\t\tif (!prevSegment || prevSegment.type !== Type.SEPARATOR) {\n\t\t\t\t\tsegments.push({ value: resolved.label, type: Type.SEPARATOR }); // prevent duplicate separators\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcurVal = '';\n\t\t\tinVariable = false;\n\t\t}\n\n\t\t// Text or Variable Name\n\t\telse {\n\t\t\tcurVal += char;\n\t\t}\n\t}\n\n\t// Tail\n\tif (curVal && !inVariable) {\n\t\tsegments.push({ value: curVal, type: Type.TEXT });\n\t}\n\n\treturn segments.filter((segment, index) => {\n\n\t\t// Only keep separator if we have values to the left and right\n\t\tif (segment.type === Type.SEPARATOR) {\n\t\t\tconst left = segments[index - 1];\n\t\t\tconst right = segments[index + 1];\n\n\t\t\treturn [left, right].every(segment => segment && (segment.type === Type.VARIABLE || segment.type === Type.TEXT) && segment.value.length > 0);\n\t\t}\n\n\t\t// accept any TEXT and VARIABLE\n\t\treturn true;\n\t}).map(segment => segment.value).join('');\n}\n\n/**\n * Handles mnemonics for menu items. Depending on OS:\n * - Windows: Supported via & character (replace && with &)\n * -   Linux: Supported via & character (replace && with &)\n * -   macOS: Unsupported (replace && with empty string)\n */\nexport function mnemonicMenuLabel(label: string, forceDisableMnemonics?: boolean): string {\n\tif (isMacintosh || forceDisableMnemonics) {\n\t\treturn label.replace(/\\(&&\\w\\)|&&/g, '').replace(/&/g, isMacintosh ? '&' : '&&');\n\t}\n\n\treturn label.replace(/&&|&/g, m => m === '&' ? '&&' : '&');\n}\n\n/**\n * Handles mnemonics for buttons. Depending on OS:\n * - Windows: Supported via & character (replace && with & and & with && for escaping)\n * -   Linux: Supported via _ character (replace && with _)\n * -   macOS: Unsupported (replace && with empty string)\n */\nexport function mnemonicButtonLabel(label: string, forceDisableMnemonics?: boolean): string {\n\tif (isMacintosh || forceDisableMnemonics) {\n\t\treturn label.replace(/\\(&&\\w\\)|&&/g, '');\n\t}\n\n\tif (isWindows) {\n\t\treturn label.replace(/&&|&/g, m => m === '&' ? '&&' : '&');\n\t}\n\n\treturn label.replace(/&&/g, '_');\n}\n\nexport function unmnemonicLabel(label: string): string {\n\treturn label.replace(/&/g, '&&');\n}\n\n/**\n * Splits a path in name and parent path, supporting both '/' and '\\'\n */\nexport function splitName(fullPath: string): { name: string; parentPath: string } {\n\tconst p = fullPath.indexOf('/') !== -1 ? posix : win32;\n\tconst name = p.basename(fullPath);\n\tconst parentPath = p.dirname(fullPath);\n\tif (name.length) {\n\t\treturn { name, parentPath };\n\t}\n\t// only the root segment\n\treturn { name: parentPath, parentPath: '' };\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { MarshalledObject } from 'vs/base/common/marshalling';\nimport { MarshalledId } from 'vs/base/common/marshallingIds';\nimport { URI, UriComponents } from 'vs/base/common/uri';\n\nexport interface IURITransformer {\n\ttransformIncoming(uri: UriComponents): UriComponents;\n\ttransformOutgoing(uri: UriComponents): UriComponents;\n\ttransformOutgoingURI(uri: URI): URI;\n\ttransformOutgoingScheme(scheme: string): string;\n}\n\nexport interface UriParts {\n\tscheme: string;\n\tauthority?: string;\n\tpath?: string;\n\tquery?: string;\n\tfragment?: string;\n}\n\nexport interface IRawURITransformer {\n\ttransformIncoming(uri: UriParts): UriParts;\n\ttransformOutgoing(uri: UriParts): UriParts;\n\ttransformOutgoingScheme(scheme: string): string;\n}\n\nfunction toJSON(uri: URI): UriComponents {\n\treturn <UriComponents><any>uri.toJSON();\n}\n\nexport class URITransformer implements IURITransformer {\n\n\tprivate readonly _uriTransformer: IRawURITransformer;\n\n\tconstructor(uriTransformer: IRawURITransformer) {\n\t\tthis._uriTransformer = uriTransformer;\n\t}\n\n\tpublic transformIncoming(uri: UriComponents): UriComponents {\n\t\tconst result = this._uriTransformer.transformIncoming(uri);\n\t\treturn (result === uri ? uri : toJSON(URI.from(result)));\n\t}\n\n\tpublic transformOutgoing(uri: UriComponents): UriComponents {\n\t\tconst result = this._uriTransformer.transformOutgoing(uri);\n\t\treturn (result === uri ? uri : toJSON(URI.from(result)));\n\t}\n\n\tpublic transformOutgoingURI(uri: URI): URI {\n\t\tconst result = this._uriTransformer.transformOutgoing(uri);\n\t\treturn (result === uri ? uri : URI.from(result));\n\t}\n\n\tpublic transformOutgoingScheme(scheme: string): string {\n\t\treturn this._uriTransformer.transformOutgoingScheme(scheme);\n\t}\n}\n\nexport const DefaultURITransformer: IURITransformer = new class {\n\ttransformIncoming(uri: UriComponents) {\n\t\treturn uri;\n\t}\n\n\ttransformOutgoing(uri: UriComponents): UriComponents {\n\t\treturn uri;\n\t}\n\n\ttransformOutgoingURI(uri: URI): URI {\n\t\treturn uri;\n\t}\n\n\ttransformOutgoingScheme(scheme: string): string {\n\t\treturn scheme;\n\t}\n};\n\nfunction _transformOutgoingURIs(obj: any, transformer: IURITransformer, depth: number): any {\n\n\tif (!obj || depth > 200) {\n\t\treturn null;\n\t}\n\n\tif (typeof obj === 'object') {\n\t\tif (obj instanceof URI) {\n\t\t\treturn transformer.transformOutgoing(obj);\n\t\t}\n\n\t\t// walk object (or array)\n\t\tfor (const key in obj) {\n\t\t\tif (Object.hasOwnProperty.call(obj, key)) {\n\t\t\t\tconst r = _transformOutgoingURIs(obj[key], transformer, depth + 1);\n\t\t\t\tif (r !== null) {\n\t\t\t\t\tobj[key] = r;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn null;\n}\n\nexport function transformOutgoingURIs<T>(obj: T, transformer: IURITransformer): T {\n\tconst result = _transformOutgoingURIs(obj, transformer, 0);\n\tif (result === null) {\n\t\t// no change\n\t\treturn obj;\n\t}\n\treturn result;\n}\n\n\nfunction _transformIncomingURIs(obj: any, transformer: IURITransformer, revive: boolean, depth: number): any {\n\n\tif (!obj || depth > 200) {\n\t\treturn null;\n\t}\n\n\tif (typeof obj === 'object') {\n\n\t\tif ((<MarshalledObject>obj).$mid === MarshalledId.Uri) {\n\t\t\treturn revive ? URI.revive(transformer.transformIncoming(obj)) : transformer.transformIncoming(obj);\n\t\t}\n\n\t\t// walk object (or array)\n\t\tfor (const key in obj) {\n\t\t\tif (Object.hasOwnProperty.call(obj, key)) {\n\t\t\t\tconst r = _transformIncomingURIs(obj[key], transformer, revive, depth + 1);\n\t\t\t\tif (r !== null) {\n\t\t\t\t\tobj[key] = r;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn null;\n}\n\nexport function transformIncomingURIs<T>(obj: T, transformer: IURITransformer): T {\n\tconst result = _transformIncomingURIs(obj, transformer, false, 0);\n\tif (result === null) {\n\t\t// no change\n\t\treturn obj;\n\t}\n\treturn result;\n}\n\nexport function transformAndReviveIncomingURIs<T>(obj: T, transformer: IURITransformer): T {\n\tconst result = _transformIncomingURIs(obj, transformer, true, 0);\n\tif (result === null) {\n\t\t// no change\n\t\treturn obj;\n\t}\n\treturn result;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IRelativePattern, match as matchGlobPattern } from 'vs/base/common/glob';\nimport { URI } from 'vs/base/common/uri';\nimport { normalize } from 'vs/base/common/path';\n\nexport interface LanguageFilter {\n\treadonly language?: string;\n\treadonly scheme?: string;\n\treadonly pattern?: string | IRelativePattern;\n\treadonly notebookType?: string;\n\t/**\n\t * This provider is implemented in the UI thread.\n\t */\n\treadonly hasAccessToAllModels?: boolean;\n\treadonly exclusive?: boolean;\n}\n\nexport type LanguageSelector = string | LanguageFilter | ReadonlyArray<string | LanguageFilter>;\n\nexport function score(selector: LanguageSelector | undefined, candidateUri: URI, candidateLanguage: string, candidateIsSynchronized: boolean, candidateNotebookUri: URI | undefined, candidateNotebookType: string | undefined): number {\n\n\tif (Array.isArray(selector)) {\n\t\t// array -> take max individual value\n\t\tlet ret = 0;\n\t\tfor (const filter of selector) {\n\t\t\tconst value = score(filter, candidateUri, candidateLanguage, candidateIsSynchronized, candidateNotebookUri, candidateNotebookType);\n\t\t\tif (value === 10) {\n\t\t\t\treturn value; // already at the highest\n\t\t\t}\n\t\t\tif (value > ret) {\n\t\t\t\tret = value;\n\t\t\t}\n\t\t}\n\t\treturn ret;\n\n\t} else if (typeof selector === 'string') {\n\n\t\tif (!candidateIsSynchronized) {\n\t\t\treturn 0;\n\t\t}\n\n\t\t// short-hand notion, desugars to\n\t\t// 'fooLang' -> { language: 'fooLang'}\n\t\t// '*' -> { language: '*' }\n\t\tif (selector === '*') {\n\t\t\treturn 5;\n\t\t} else if (selector === candidateLanguage) {\n\t\t\treturn 10;\n\t\t} else {\n\t\t\treturn 0;\n\t\t}\n\n\t} else if (selector) {\n\t\t// filter -> select accordingly, use defaults for scheme\n\t\tconst { language, pattern, scheme, hasAccessToAllModels, notebookType } = selector as LanguageFilter; // TODO: microsoft/TypeScript#42768\n\n\t\tif (!candidateIsSynchronized && !hasAccessToAllModels) {\n\t\t\treturn 0;\n\t\t}\n\n\t\t// selector targets a notebook -> use the notebook uri instead\n\t\t// of the \"normal\" document uri.\n\t\tif (notebookType && candidateNotebookUri) {\n\t\t\tcandidateUri = candidateNotebookUri;\n\t\t}\n\n\t\tlet ret = 0;\n\n\t\tif (scheme) {\n\t\t\tif (scheme === candidateUri.scheme) {\n\t\t\t\tret = 10;\n\t\t\t} else if (scheme === '*') {\n\t\t\t\tret = 5;\n\t\t\t} else {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\n\t\tif (language) {\n\t\t\tif (language === candidateLanguage) {\n\t\t\t\tret = 10;\n\t\t\t} else if (language === '*') {\n\t\t\t\tret = Math.max(ret, 5);\n\t\t\t} else {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\n\t\tif (notebookType) {\n\t\t\tif (notebookType === candidateNotebookType) {\n\t\t\t\tret = 10;\n\t\t\t} else if (notebookType === '*' && candidateNotebookType !== undefined) {\n\t\t\t\tret = Math.max(ret, 5);\n\t\t\t} else {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\n\t\tif (pattern) {\n\t\t\tlet normalizedPattern: string | IRelativePattern;\n\t\t\tif (typeof pattern === 'string') {\n\t\t\t\tnormalizedPattern = pattern;\n\t\t\t} else {\n\t\t\t\t// Since this pattern has a `base` property, we need\n\t\t\t\t// to normalize this path first before passing it on\n\t\t\t\t// because we will compare it against `Uri.fsPath`\n\t\t\t\t// which uses platform specific separators.\n\t\t\t\t// Refs: https://github.com/microsoft/vscode/issues/99938\n\t\t\t\tnormalizedPattern = { ...pattern, base: normalize(pattern.base) };\n\t\t\t}\n\n\t\t\tif (normalizedPattern === candidateUri.fsPath || matchGlobPattern(normalizedPattern, candidateUri.fsPath)) {\n\t\t\t\tret = 10;\n\t\t\t} else {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\n\t\treturn ret;\n\n\t} else {\n\t\treturn 0;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { VSBuffer } from 'vs/base/common/buffer';\nimport * as platform from 'vs/base/common/platform';\n\nexport interface IFullSemanticTokensDto {\n\tid: number;\n\ttype: 'full';\n\tdata: Uint32Array;\n}\n\nexport interface IDeltaSemanticTokensDto {\n\tid: number;\n\ttype: 'delta';\n\tdeltas: { start: number; deleteCount: number; data?: Uint32Array }[];\n}\n\nexport type ISemanticTokensDto = IFullSemanticTokensDto | IDeltaSemanticTokensDto;\n\nconst enum EncodedSemanticTokensType {\n\tFull = 1,\n\tDelta = 2\n}\n\nfunction reverseEndianness(arr: Uint8Array): void {\n\tfor (let i = 0, len = arr.length; i < len; i += 4) {\n\t\t// flip bytes 0<->3 and 1<->2\n\t\tconst b0 = arr[i + 0];\n\t\tconst b1 = arr[i + 1];\n\t\tconst b2 = arr[i + 2];\n\t\tconst b3 = arr[i + 3];\n\t\tarr[i + 0] = b3;\n\t\tarr[i + 1] = b2;\n\t\tarr[i + 2] = b1;\n\t\tarr[i + 3] = b0;\n\t}\n}\n\nfunction toLittleEndianBuffer(arr: Uint32Array): VSBuffer {\n\tconst uint8Arr = new Uint8Array(arr.buffer, arr.byteOffset, arr.length * 4);\n\tif (!platform.isLittleEndian()) {\n\t\t// the byte order must be changed\n\t\treverseEndianness(uint8Arr);\n\t}\n\treturn VSBuffer.wrap(uint8Arr);\n}\n\nfunction fromLittleEndianBuffer(buff: VSBuffer): Uint32Array {\n\tconst uint8Arr = buff.buffer;\n\tif (!platform.isLittleEndian()) {\n\t\t// the byte order must be changed\n\t\treverseEndianness(uint8Arr);\n\t}\n\tif (uint8Arr.byteOffset % 4 === 0) {\n\t\treturn new Uint32Array(uint8Arr.buffer, uint8Arr.byteOffset, uint8Arr.length / 4);\n\t} else {\n\t\t// unaligned memory access doesn't work on all platforms\n\t\tconst data = new Uint8Array(uint8Arr.byteLength);\n\t\tdata.set(uint8Arr);\n\t\treturn new Uint32Array(data.buffer, data.byteOffset, data.length / 4);\n\t}\n}\n\nexport function encodeSemanticTokensDto(semanticTokens: ISemanticTokensDto): VSBuffer {\n\tconst dest = new Uint32Array(encodeSemanticTokensDtoSize(semanticTokens));\n\tlet offset = 0;\n\tdest[offset++] = semanticTokens.id;\n\tif (semanticTokens.type === 'full') {\n\t\tdest[offset++] = EncodedSemanticTokensType.Full;\n\t\tdest[offset++] = semanticTokens.data.length;\n\t\tdest.set(semanticTokens.data, offset); offset += semanticTokens.data.length;\n\t} else {\n\t\tdest[offset++] = EncodedSemanticTokensType.Delta;\n\t\tdest[offset++] = semanticTokens.deltas.length;\n\t\tfor (const delta of semanticTokens.deltas) {\n\t\t\tdest[offset++] = delta.start;\n\t\t\tdest[offset++] = delta.deleteCount;\n\t\t\tif (delta.data) {\n\t\t\t\tdest[offset++] = delta.data.length;\n\t\t\t\tdest.set(delta.data, offset); offset += delta.data.length;\n\t\t\t} else {\n\t\t\t\tdest[offset++] = 0;\n\t\t\t}\n\t\t}\n\t}\n\treturn toLittleEndianBuffer(dest);\n}\n\nfunction encodeSemanticTokensDtoSize(semanticTokens: ISemanticTokensDto): number {\n\tlet result = 0;\n\tresult += (\n\t\t+ 1 // id\n\t\t+ 1 // type\n\t);\n\tif (semanticTokens.type === 'full') {\n\t\tresult += (\n\t\t\t+ 1 // data length\n\t\t\t+ semanticTokens.data.length\n\t\t);\n\t} else {\n\t\tresult += (\n\t\t\t+ 1 // delta count\n\t\t);\n\t\tresult += (\n\t\t\t+ 1 // start\n\t\t\t+ 1 // deleteCount\n\t\t\t+ 1 // data length\n\t\t) * semanticTokens.deltas.length;\n\t\tfor (const delta of semanticTokens.deltas) {\n\t\t\tif (delta.data) {\n\t\t\t\tresult += delta.data.length;\n\t\t\t}\n\t\t}\n\t}\n\treturn result;\n}\n\nexport function decodeSemanticTokensDto(_buff: VSBuffer): ISemanticTokensDto {\n\tconst src = fromLittleEndianBuffer(_buff);\n\tlet offset = 0;\n\tconst id = src[offset++];\n\tconst type: EncodedSemanticTokensType = src[offset++];\n\tif (type === EncodedSemanticTokensType.Full) {\n\t\tconst length = src[offset++];\n\t\tconst data = src.subarray(offset, offset + length); offset += length;\n\t\treturn {\n\t\t\tid: id,\n\t\t\ttype: 'full',\n\t\t\tdata: data\n\t\t};\n\t}\n\tconst deltaCount = src[offset++];\n\tconst deltas: { start: number; deleteCount: number; data?: Uint32Array }[] = [];\n\tfor (let i = 0; i < deltaCount; i++) {\n\t\tconst start = src[offset++];\n\t\tconst deleteCount = src[offset++];\n\t\tconst length = src[offset++];\n\t\tlet data: Uint32Array | undefined;\n\t\tif (length > 0) {\n\t\t\tdata = src.subarray(offset, offset + length); offset += length;\n\t\t}\n\t\tdeltas[i] = { start, deleteCount, data };\n\t}\n\treturn {\n\t\tid: id,\n\t\ttype: 'delta',\n\t\tdeltas: deltas\n\t};\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from 'vs/nls';\nimport * as platform from 'vs/base/common/platform';\nimport { ScrollbarVisibility } from 'vs/base/common/scrollable';\nimport { FontInfo } from 'vs/editor/common/config/fontInfo';\nimport { Constants } from 'vs/base/common/uint';\nimport { USUAL_WORD_SEPARATORS } from 'vs/editor/common/core/wordHelper';\nimport { AccessibilitySupport } from 'vs/platform/accessibility/common/accessibility';\nimport { IConfigurationPropertySchema } from 'vs/platform/configuration/common/configurationRegistry';\nimport { IJSONSchema } from 'vs/base/common/jsonSchema';\nimport * as arrays from 'vs/base/common/arrays';\nimport * as objects from 'vs/base/common/objects';\nimport { EDITOR_MODEL_DEFAULTS } from 'vs/editor/common/core/textModelDefaults';\n\n//#region typed options\n\n/**\n * Configuration options for auto closing quotes and brackets\n */\nexport type EditorAutoClosingStrategy = 'always' | 'languageDefined' | 'beforeWhitespace' | 'never';\n\n/**\n * Configuration options for auto wrapping quotes and brackets\n */\nexport type EditorAutoSurroundStrategy = 'languageDefined' | 'quotes' | 'brackets' | 'never';\n\n/**\n * Configuration options for typing over closing quotes or brackets\n */\nexport type EditorAutoClosingEditStrategy = 'always' | 'auto' | 'never';\n\n/**\n * Configuration options for auto indentation in the editor\n */\nexport const enum EditorAutoIndentStrategy {\n\tNone = 0,\n\tKeep = 1,\n\tBrackets = 2,\n\tAdvanced = 3,\n\tFull = 4\n}\n\n/**\n * Configuration options for the editor.\n */\nexport interface IEditorOptions {\n\t/**\n\t * This editor is used inside a diff editor.\n\t */\n\tinDiffEditor?: boolean;\n\t/**\n\t * The aria label for the editor's textarea (when it is focused).\n\t */\n\tariaLabel?: string;\n\t/**\n\t * The `tabindex` property of the editor's textarea\n\t */\n\ttabIndex?: number;\n\t/**\n\t * Render vertical lines at the specified columns.\n\t * Defaults to empty array.\n\t */\n\trulers?: (number | IRulerOption)[];\n\t/**\n\t * A string containing the word separators used when doing word navigation.\n\t * Defaults to `~!@#$%^&*()-=+[{]}\\\\|;:\\'\",.<>/?\n\t */\n\twordSeparators?: string;\n\t/**\n\t * Enable Linux primary clipboard.\n\t * Defaults to true.\n\t */\n\tselectionClipboard?: boolean;\n\t/**\n\t * Control the rendering of line numbers.\n\t * If it is a function, it will be invoked when rendering a line number and the return value will be rendered.\n\t * Otherwise, if it is a truthy, line numbers will be rendered normally (equivalent of using an identity function).\n\t * Otherwise, line numbers will not be rendered.\n\t * Defaults to `on`.\n\t */\n\tlineNumbers?: LineNumbersType;\n\t/**\n\t * Controls the minimal number of visible leading and trailing lines surrounding the cursor.\n\t * Defaults to 0.\n\t*/\n\tcursorSurroundingLines?: number;\n\t/**\n\t * Controls when `cursorSurroundingLines` should be enforced\n\t * Defaults to `default`, `cursorSurroundingLines` is not enforced when cursor position is changed\n\t * by mouse.\n\t*/\n\tcursorSurroundingLinesStyle?: 'default' | 'all';\n\t/**\n\t * Render last line number when the file ends with a newline.\n\t * Defaults to true.\n\t*/\n\trenderFinalNewline?: boolean;\n\t/**\n\t * Remove unusual line terminators like LINE SEPARATOR (LS), PARAGRAPH SEPARATOR (PS).\n\t * Defaults to 'prompt'.\n\t */\n\tunusualLineTerminators?: 'auto' | 'off' | 'prompt';\n\t/**\n\t * Should the corresponding line be selected when clicking on the line number?\n\t * Defaults to true.\n\t */\n\tselectOnLineNumbers?: boolean;\n\t/**\n\t * Control the width of line numbers, by reserving horizontal space for rendering at least an amount of digits.\n\t * Defaults to 5.\n\t */\n\tlineNumbersMinChars?: number;\n\t/**\n\t * Enable the rendering of the glyph margin.\n\t * Defaults to true in vscode and to false in monaco-editor.\n\t */\n\tglyphMargin?: boolean;\n\t/**\n\t * The width reserved for line decorations (in px).\n\t * Line decorations are placed between line numbers and the editor content.\n\t * You can pass in a string in the format floating point followed by \"ch\". e.g. 1.3ch.\n\t * Defaults to 10.\n\t */\n\tlineDecorationsWidth?: number | string;\n\t/**\n\t * When revealing the cursor, a virtual padding (px) is added to the cursor, turning it into a rectangle.\n\t * This virtual padding ensures that the cursor gets revealed before hitting the edge of the viewport.\n\t * Defaults to 30 (px).\n\t */\n\trevealHorizontalRightPadding?: number;\n\t/**\n\t * Render the editor selection with rounded borders.\n\t * Defaults to true.\n\t */\n\troundedSelection?: boolean;\n\t/**\n\t * Class name to be added to the editor.\n\t */\n\textraEditorClassName?: string;\n\t/**\n\t * Should the editor be read only. See also `domReadOnly`.\n\t * Defaults to false.\n\t */\n\treadOnly?: boolean;\n\t/**\n\t * Should the textarea used for input use the DOM `readonly` attribute.\n\t * Defaults to false.\n\t */\n\tdomReadOnly?: boolean;\n\t/**\n\t * Enable linked editing.\n\t * Defaults to false.\n\t */\n\tlinkedEditing?: boolean;\n\t/**\n\t * deprecated, use linkedEditing instead\n\t */\n\trenameOnType?: boolean;\n\t/**\n\t * Should the editor render validation decorations.\n\t * Defaults to editable.\n\t */\n\trenderValidationDecorations?: 'editable' | 'on' | 'off';\n\t/**\n\t * Control the behavior and rendering of the scrollbars.\n\t */\n\tscrollbar?: IEditorScrollbarOptions;\n\t/**\n\t * Control the behavior of experimental options\n\t */\n\texperimental?: IEditorExperimentalOptions;\n\t/**\n\t * Control the behavior and rendering of the minimap.\n\t */\n\tminimap?: IEditorMinimapOptions;\n\t/**\n\t * Control the behavior of the find widget.\n\t */\n\tfind?: IEditorFindOptions;\n\t/**\n\t * Display overflow widgets as `fixed`.\n\t * Defaults to `false`.\n\t */\n\tfixedOverflowWidgets?: boolean;\n\t/**\n\t * The number of vertical lanes the overview ruler should render.\n\t * Defaults to 3.\n\t */\n\toverviewRulerLanes?: number;\n\t/**\n\t * Controls if a border should be drawn around the overview ruler.\n\t * Defaults to `true`.\n\t */\n\toverviewRulerBorder?: boolean;\n\t/**\n\t * Control the cursor animation style, possible values are 'blink', 'smooth', 'phase', 'expand' and 'solid'.\n\t * Defaults to 'blink'.\n\t */\n\tcursorBlinking?: 'blink' | 'smooth' | 'phase' | 'expand' | 'solid';\n\t/**\n\t * Zoom the font in the editor when using the mouse wheel in combination with holding Ctrl.\n\t * Defaults to false.\n\t */\n\tmouseWheelZoom?: boolean;\n\t/**\n\t * Control the mouse pointer style, either 'text' or 'default' or 'copy'\n\t * Defaults to 'text'\n\t */\n\tmouseStyle?: 'text' | 'default' | 'copy';\n\t/**\n\t * Enable smooth caret animation.\n\t * Defaults to false.\n\t */\n\tcursorSmoothCaretAnimation?: boolean;\n\t/**\n\t * Control the cursor style, either 'block' or 'line'.\n\t * Defaults to 'line'.\n\t */\n\tcursorStyle?: 'line' | 'block' | 'underline' | 'line-thin' | 'block-outline' | 'underline-thin';\n\t/**\n\t * Control the width of the cursor when cursorStyle is set to 'line'\n\t */\n\tcursorWidth?: number;\n\t/**\n\t * Enable font ligatures.\n\t * Defaults to false.\n\t */\n\tfontLigatures?: boolean | string;\n\t/**\n\t * Disable the use of `transform: translate3d(0px, 0px, 0px)` for the editor margin and lines layers.\n\t * The usage of `transform: translate3d(0px, 0px, 0px)` acts as a hint for browsers to create an extra layer.\n\t * Defaults to false.\n\t */\n\tdisableLayerHinting?: boolean;\n\t/**\n\t * Disable the optimizations for monospace fonts.\n\t * Defaults to false.\n\t */\n\tdisableMonospaceOptimizations?: boolean;\n\t/**\n\t * Should the cursor be hidden in the overview ruler.\n\t * Defaults to false.\n\t */\n\thideCursorInOverviewRuler?: boolean;\n\t/**\n\t * Enable that scrolling can go one screen size after the last line.\n\t * Defaults to true.\n\t */\n\tscrollBeyondLastLine?: boolean;\n\t/**\n\t * Enable that scrolling can go beyond the last column by a number of columns.\n\t * Defaults to 5.\n\t */\n\tscrollBeyondLastColumn?: number;\n\t/**\n\t * Enable that the editor animates scrolling to a position.\n\t * Defaults to false.\n\t */\n\tsmoothScrolling?: boolean;\n\t/**\n\t * Enable that the editor will install an interval to check if its container dom node size has changed.\n\t * Enabling this might have a severe performance impact.\n\t * Defaults to false.\n\t */\n\tautomaticLayout?: boolean;\n\t/**\n\t * Control the wrapping of the editor.\n\t * When `wordWrap` = \"off\", the lines will never wrap.\n\t * When `wordWrap` = \"on\", the lines will wrap at the viewport width.\n\t * When `wordWrap` = \"wordWrapColumn\", the lines will wrap at `wordWrapColumn`.\n\t * When `wordWrap` = \"bounded\", the lines will wrap at min(viewport width, wordWrapColumn).\n\t * Defaults to \"off\".\n\t */\n\twordWrap?: 'off' | 'on' | 'wordWrapColumn' | 'bounded';\n\t/**\n\t * Override the `wordWrap` setting.\n\t */\n\twordWrapOverride1?: 'off' | 'on' | 'inherit';\n\t/**\n\t * Override the `wordWrapOverride1` setting.\n\t */\n\twordWrapOverride2?: 'off' | 'on' | 'inherit';\n\t/**\n\t * Control the wrapping of the editor.\n\t * When `wordWrap` = \"off\", the lines will never wrap.\n\t * When `wordWrap` = \"on\", the lines will wrap at the viewport width.\n\t * When `wordWrap` = \"wordWrapColumn\", the lines will wrap at `wordWrapColumn`.\n\t * When `wordWrap` = \"bounded\", the lines will wrap at min(viewport width, wordWrapColumn).\n\t * Defaults to 80.\n\t */\n\twordWrapColumn?: number;\n\t/**\n\t * Control indentation of wrapped lines. Can be: 'none', 'same', 'indent' or 'deepIndent'.\n\t * Defaults to 'same' in vscode and to 'none' in monaco-editor.\n\t */\n\twrappingIndent?: 'none' | 'same' | 'indent' | 'deepIndent';\n\t/**\n\t * Controls the wrapping strategy to use.\n\t * Defaults to 'simple'.\n\t */\n\twrappingStrategy?: 'simple' | 'advanced';\n\t/**\n\t * Configure word wrapping characters. A break will be introduced before these characters.\n\t */\n\twordWrapBreakBeforeCharacters?: string;\n\t/**\n\t * Configure word wrapping characters. A break will be introduced after these characters.\n\t */\n\twordWrapBreakAfterCharacters?: string;\n\t/**\n\t * Performance guard: Stop rendering a line after x characters.\n\t * Defaults to 10000.\n\t * Use -1 to never stop rendering\n\t */\n\tstopRenderingLineAfter?: number;\n\t/**\n\t * Configure the editor's hover.\n\t */\n\thover?: IEditorHoverOptions;\n\t/**\n\t * Enable detecting links and making them clickable.\n\t * Defaults to true.\n\t */\n\tlinks?: boolean;\n\t/**\n\t * Enable inline color decorators and color picker rendering.\n\t */\n\tcolorDecorators?: boolean;\n\t/**\n\t * Control the behaviour of comments in the editor.\n\t */\n\tcomments?: IEditorCommentsOptions;\n\t/**\n\t * Enable custom contextmenu.\n\t * Defaults to true.\n\t */\n\tcontextmenu?: boolean;\n\t/**\n\t * A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.\n\t * Defaults to 1.\n\t */\n\tmouseWheelScrollSensitivity?: number;\n\t/**\n\t * FastScrolling mulitplier speed when pressing `Alt`\n\t * Defaults to 5.\n\t */\n\tfastScrollSensitivity?: number;\n\t/**\n\t * Enable that the editor scrolls only the predominant axis. Prevents horizontal drift when scrolling vertically on a trackpad.\n\t * Defaults to true.\n\t */\n\tscrollPredominantAxis?: boolean;\n\t/**\n\t * Enable that the selection with the mouse and keys is doing column selection.\n\t * Defaults to false.\n\t */\n\tcolumnSelection?: boolean;\n\t/**\n\t * The modifier to be used to add multiple cursors with the mouse.\n\t * Defaults to 'alt'\n\t */\n\tmultiCursorModifier?: 'ctrlCmd' | 'alt';\n\t/**\n\t * Merge overlapping selections.\n\t * Defaults to true\n\t */\n\tmultiCursorMergeOverlapping?: boolean;\n\t/**\n\t * Configure the behaviour when pasting a text with the line count equal to the cursor count.\n\t * Defaults to 'spread'.\n\t */\n\tmultiCursorPaste?: 'spread' | 'full';\n\t/**\n\t * Configure the editor's accessibility support.\n\t * Defaults to 'auto'. It is best to leave this to 'auto'.\n\t */\n\taccessibilitySupport?: 'auto' | 'off' | 'on';\n\t/**\n\t * Controls the number of lines in the editor that can be read out by a screen reader\n\t */\n\taccessibilityPageSize?: number;\n\t/**\n\t * Suggest options.\n\t */\n\tsuggest?: ISuggestOptions;\n\tinlineSuggest?: IInlineSuggestOptions;\n\t/**\n\t * Smart select options.\n\t */\n\tsmartSelect?: ISmartSelectOptions;\n\t/**\n\t *\n\t */\n\tgotoLocation?: IGotoLocationOptions;\n\t/**\n\t * Enable quick suggestions (shadow suggestions)\n\t * Defaults to true.\n\t */\n\tquickSuggestions?: boolean | IQuickSuggestionsOptions;\n\t/**\n\t * Quick suggestions show delay (in ms)\n\t * Defaults to 10 (ms)\n\t */\n\tquickSuggestionsDelay?: number;\n\t/**\n\t * Controls the spacing around the editor.\n\t */\n\tpadding?: IEditorPaddingOptions;\n\t/**\n\t * Parameter hint options.\n\t */\n\tparameterHints?: IEditorParameterHintOptions;\n\t/**\n\t * Options for auto closing brackets.\n\t * Defaults to language defined behavior.\n\t */\n\tautoClosingBrackets?: EditorAutoClosingStrategy;\n\t/**\n\t * Options for auto closing quotes.\n\t * Defaults to language defined behavior.\n\t */\n\tautoClosingQuotes?: EditorAutoClosingStrategy;\n\t/**\n\t * Options for pressing backspace near quotes or bracket pairs.\n\t */\n\tautoClosingDelete?: EditorAutoClosingEditStrategy;\n\t/**\n\t * Options for typing over closing quotes or brackets.\n\t */\n\tautoClosingOvertype?: EditorAutoClosingEditStrategy;\n\t/**\n\t * Options for auto surrounding.\n\t * Defaults to always allowing auto surrounding.\n\t */\n\tautoSurround?: EditorAutoSurroundStrategy;\n\t/**\n\t * Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.\n\t * Defaults to advanced.\n\t */\n\tautoIndent?: 'none' | 'keep' | 'brackets' | 'advanced' | 'full';\n\t/**\n\t * Emulate selection behaviour of tab characters when using spaces for indentation.\n\t * This means selection will stick to tab stops.\n\t */\n\tstickyTabStops?: boolean;\n\t/**\n\t * Enable format on type.\n\t * Defaults to false.\n\t */\n\tformatOnType?: boolean;\n\t/**\n\t * Enable format on paste.\n\t * Defaults to false.\n\t */\n\tformatOnPaste?: boolean;\n\t/**\n\t * Controls if the editor should allow to move selections via drag and drop.\n\t * Defaults to false.\n\t */\n\tdragAndDrop?: boolean;\n\t/**\n\t * Enable the suggestion box to pop-up on trigger characters.\n\t * Defaults to true.\n\t */\n\tsuggestOnTriggerCharacters?: boolean;\n\t/**\n\t * Accept suggestions on ENTER.\n\t * Defaults to 'on'.\n\t */\n\tacceptSuggestionOnEnter?: 'on' | 'smart' | 'off';\n\t/**\n\t * Accept suggestions on provider defined characters.\n\t * Defaults to true.\n\t */\n\tacceptSuggestionOnCommitCharacter?: boolean;\n\t/**\n\t * Enable snippet suggestions. Default to 'true'.\n\t */\n\tsnippetSuggestions?: 'top' | 'bottom' | 'inline' | 'none';\n\t/**\n\t * Copying without a selection copies the current line.\n\t */\n\temptySelectionClipboard?: boolean;\n\t/**\n\t * Syntax highlighting is copied.\n\t */\n\tcopyWithSyntaxHighlighting?: boolean;\n\t/**\n\t * The history mode for suggestions.\n\t */\n\tsuggestSelection?: 'first' | 'recentlyUsed' | 'recentlyUsedByPrefix';\n\t/**\n\t * The font size for the suggest widget.\n\t * Defaults to the editor font size.\n\t */\n\tsuggestFontSize?: number;\n\t/**\n\t * The line height for the suggest widget.\n\t * Defaults to the editor line height.\n\t */\n\tsuggestLineHeight?: number;\n\t/**\n\t * Enable tab completion.\n\t */\n\ttabCompletion?: 'on' | 'off' | 'onlySnippets';\n\t/**\n\t * Enable selection highlight.\n\t * Defaults to true.\n\t */\n\tselectionHighlight?: boolean;\n\t/**\n\t * Enable semantic occurrences highlight.\n\t * Defaults to true.\n\t */\n\toccurrencesHighlight?: boolean;\n\t/**\n\t * Show code lens\n\t * Defaults to true.\n\t */\n\tcodeLens?: boolean;\n\t/**\n\t * Code lens font family. Defaults to editor font family.\n\t */\n\tcodeLensFontFamily?: string;\n\t/**\n\t * Code lens font size. Default to 90% of the editor font size\n\t */\n\tcodeLensFontSize?: number;\n\t/**\n\t * Control the behavior and rendering of the code action lightbulb.\n\t */\n\tlightbulb?: IEditorLightbulbOptions;\n\t/**\n\t * Timeout for running code actions on save.\n\t */\n\tcodeActionsOnSaveTimeout?: number;\n\t/**\n\t * Enable code folding.\n\t * Defaults to true.\n\t */\n\tfolding?: boolean;\n\t/**\n\t * Selects the folding strategy. 'auto' uses the strategies contributed for the current document, 'indentation' uses the indentation based folding strategy.\n\t * Defaults to 'auto'.\n\t */\n\tfoldingStrategy?: 'auto' | 'indentation';\n\t/**\n\t * Enable highlight for folded regions.\n\t * Defaults to true.\n\t */\n\tfoldingHighlight?: boolean;\n\t/**\n\t * Auto fold imports folding regions.\n\t * Defaults to true.\n\t */\n\tfoldingImportsByDefault?: boolean;\n\t/**\n\t * Maximum number of foldable regions.\n\t * Defaults to 5000.\n\t */\n\tfoldingMaximumRegions?: number;\n\t/**\n\t * Controls whether the fold actions in the gutter stay always visible or hide unless the mouse is over the gutter.\n\t * Defaults to 'mouseover'.\n\t */\n\tshowFoldingControls?: 'always' | 'never' | 'mouseover';\n\t/**\n\t * Controls whether clicking on the empty content after a folded line will unfold the line.\n\t * Defaults to false.\n\t */\n\tunfoldOnClickAfterEndOfLine?: boolean;\n\t/**\n\t * Enable highlighting of matching brackets.\n\t * Defaults to 'always'.\n\t */\n\tmatchBrackets?: 'never' | 'near' | 'always';\n\t/**\n\t * Enable rendering of whitespace.\n\t * Defaults to 'selection'.\n\t */\n\trenderWhitespace?: 'none' | 'boundary' | 'selection' | 'trailing' | 'all';\n\t/**\n\t * Enable rendering of control characters.\n\t * Defaults to true.\n\t */\n\trenderControlCharacters?: boolean;\n\t/**\n\t * Enable rendering of current line highlight.\n\t * Defaults to all.\n\t */\n\trenderLineHighlight?: 'none' | 'gutter' | 'line' | 'all';\n\t/**\n\t * Control if the current line highlight should be rendered only the editor is focused.\n\t * Defaults to false.\n\t */\n\trenderLineHighlightOnlyWhenFocus?: boolean;\n\t/**\n\t * Inserting and deleting whitespace follows tab stops.\n\t */\n\tuseTabStops?: boolean;\n\t/**\n\t * The font family\n\t */\n\tfontFamily?: string;\n\t/**\n\t * The font weight\n\t */\n\tfontWeight?: string;\n\t/**\n\t * The font size\n\t */\n\tfontSize?: number;\n\t/**\n\t * The line height\n\t */\n\tlineHeight?: number;\n\t/**\n\t * The letter spacing\n\t */\n\tletterSpacing?: number;\n\t/**\n\t * Controls fading out of unused variables.\n\t */\n\tshowUnused?: boolean;\n\t/**\n\t * Controls whether to focus the inline editor in the peek widget by default.\n\t * Defaults to false.\n\t */\n\tpeekWidgetDefaultFocus?: 'tree' | 'editor';\n\t/**\n\t * Controls whether the definition link opens element in the peek widget.\n\t * Defaults to false.\n\t */\n\tdefinitionLinkOpensInPeek?: boolean;\n\t/**\n\t * Controls strikethrough deprecated variables.\n\t */\n\tshowDeprecated?: boolean;\n\t/**\n\t * Control the behavior and rendering of the inline hints.\n\t */\n\tinlayHints?: IEditorInlayHintsOptions;\n\t/**\n\t * Control if the editor should use shadow DOM.\n\t */\n\tuseShadowDOM?: boolean;\n\t/**\n\t * Controls the behavior of editor guides.\n\t*/\n\tguides?: IGuidesOptions;\n\n\t/**\n\t * Controls the behavior of the unicode highlight feature\n\t * (by default, ambiguous and invisible characters are highlighted).\n\t */\n\tunicodeHighlight?: IUnicodeHighlightOptions;\n\n\t/**\n\t * Configures bracket pair colorization (disabled by default).\n\t*/\n\tbracketPairColorization?: IBracketPairColorizationOptions;\n\n\t/**\n\t * Controls dropping into the editor from an external source.\n\t *\n\t * When enabled, this shows a preview of the drop location and triggers an `onDropIntoEditor` event.\n\t */\n\tdropIntoEditor?: IDropIntoEditorOptions;\n}\n\n/**\n * @internal\n * The width of the minimap gutter, in pixels.\n */\nexport const MINIMAP_GUTTER_WIDTH = 8;\n\nexport interface IDiffEditorBaseOptions {\n\t/**\n\t * Allow the user to resize the diff editor split view.\n\t * Defaults to true.\n\t */\n\tenableSplitViewResizing?: boolean;\n\t/**\n\t * Render the differences in two side-by-side editors.\n\t * Defaults to true.\n\t */\n\trenderSideBySide?: boolean;\n\t/**\n\t * Timeout in milliseconds after which diff computation is cancelled.\n\t * Defaults to 5000.\n\t */\n\tmaxComputationTime?: number;\n\t/**\n\t * Maximum supported file size in MB.\n\t * Defaults to 50.\n\t */\n\tmaxFileSize?: number;\n\t/**\n\t * Compute the diff by ignoring leading/trailing whitespace\n\t * Defaults to true.\n\t */\n\tignoreTrimWhitespace?: boolean;\n\t/**\n\t * Render +/- indicators for added/deleted changes.\n\t * Defaults to true.\n\t */\n\trenderIndicators?: boolean;\n\t/**\n\t * Shows icons in the glyph margin to revert changes.\n\t * Default to true.\n\t */\n\trenderMarginRevertIcon?: boolean;\n\t/**\n\t * Original model should be editable?\n\t * Defaults to false.\n\t */\n\toriginalEditable?: boolean;\n\t/**\n\t * Should the diff editor enable code lens?\n\t * Defaults to false.\n\t */\n\tdiffCodeLens?: boolean;\n\t/**\n\t * Is the diff editor should render overview ruler\n\t * Defaults to true\n\t */\n\trenderOverviewRuler?: boolean;\n\t/**\n\t * Control the wrapping of the diff editor.\n\t */\n\tdiffWordWrap?: 'off' | 'on' | 'inherit';\n}\n\n/**\n * Configuration options for the diff editor.\n */\nexport interface IDiffEditorOptions extends IEditorOptions, IDiffEditorBaseOptions {\n}\n\n/**\n * @internal\n */\nexport type ValidDiffEditorBaseOptions = Readonly<Required<IDiffEditorBaseOptions>>;\n\n//#endregion\n\n/**\n * An event describing that the configuration of the editor has changed.\n */\nexport class ConfigurationChangedEvent {\n\tprivate readonly _values: boolean[];\n\t/**\n\t * @internal\n\t */\n\tconstructor(values: boolean[]) {\n\t\tthis._values = values;\n\t}\n\tpublic hasChanged(id: EditorOption): boolean {\n\t\treturn this._values[id];\n\t}\n}\n\n/**\n * All computed editor options.\n */\nexport interface IComputedEditorOptions {\n\tget<T extends EditorOption>(id: T): FindComputedEditorOptionValueById<T>;\n}\n\n//#region IEditorOption\n\n/**\n * @internal\n */\nexport interface IEnvironmentalOptions {\n\treadonly memory: ComputeOptionsMemory | null;\n\treadonly outerWidth: number;\n\treadonly outerHeight: number;\n\treadonly fontInfo: FontInfo;\n\treadonly extraEditorClassName: string;\n\treadonly isDominatedByLongLines: boolean;\n\treadonly viewLineCount: number;\n\treadonly lineNumbersDigitCount: number;\n\treadonly emptySelectionClipboard: boolean;\n\treadonly pixelRatio: number;\n\treadonly tabFocusMode: boolean;\n\treadonly accessibilitySupport: AccessibilitySupport;\n}\n\n/**\n * @internal\n */\nexport class ComputeOptionsMemory {\n\n\tpublic stableMinimapLayoutInput: IMinimapLayoutInput | null;\n\tpublic stableFitMaxMinimapScale: number;\n\tpublic stableFitRemainingWidth: number;\n\n\tconstructor() {\n\t\tthis.stableMinimapLayoutInput = null;\n\t\tthis.stableFitMaxMinimapScale = 0;\n\t\tthis.stableFitRemainingWidth = 0;\n\t}\n}\n\nexport interface IEditorOption<K extends EditorOption, V> {\n\treadonly id: K;\n\treadonly name: string;\n\tdefaultValue: V;\n\t/**\n\t * @internal\n\t */\n\treadonly schema: IConfigurationPropertySchema | { [path: string]: IConfigurationPropertySchema } | undefined;\n\t/**\n\t * @internal\n\t */\n\tvalidate(input: any): V;\n\t/**\n\t * @internal\n\t */\n\tcompute(env: IEnvironmentalOptions, options: IComputedEditorOptions, value: V): V;\n\n\t/**\n\t * Might modify `value`.\n\t*/\n\tapplyUpdate(value: V | undefined, update: V): ApplyUpdateResult<V>;\n}\n\n/**\n * @internal\n */\ntype PossibleKeyName0<V> = { [K in keyof IEditorOptions]: IEditorOptions[K] extends V | undefined ? K : never }[keyof IEditorOptions];\n/**\n * @internal\n */\ntype PossibleKeyName<V> = NonNullable<PossibleKeyName0<V>>;\n\n/**\n * @internal\n */\nabstract class BaseEditorOption<K extends EditorOption, T, V> implements IEditorOption<K, V> {\n\n\tpublic readonly id: K;\n\tpublic readonly name: string;\n\tpublic readonly defaultValue: V;\n\tpublic readonly schema: IConfigurationPropertySchema | { [path: string]: IConfigurationPropertySchema } | undefined;\n\n\tconstructor(id: K, name: PossibleKeyName<T>, defaultValue: V, schema?: IConfigurationPropertySchema | { [path: string]: IConfigurationPropertySchema }) {\n\t\tthis.id = id;\n\t\tthis.name = name;\n\t\tthis.defaultValue = defaultValue;\n\t\tthis.schema = schema;\n\t}\n\n\tpublic applyUpdate(value: V | undefined, update: V): ApplyUpdateResult<V> {\n\t\treturn applyUpdate(value, update);\n\t}\n\n\tpublic abstract validate(input: any): V;\n\n\tpublic compute(env: IEnvironmentalOptions, options: IComputedEditorOptions, value: V): V {\n\t\treturn value;\n\t}\n}\n\nexport class ApplyUpdateResult<T> {\n\tconstructor(\n\t\tpublic readonly newValue: T,\n\t\tpublic readonly didChange: boolean\n\t) { }\n}\n\nfunction applyUpdate<T>(value: T | undefined, update: T): ApplyUpdateResult<T> {\n\tif (typeof value !== 'object' || typeof update !== 'object' || !value || !update) {\n\t\treturn new ApplyUpdateResult(update, value !== update);\n\t}\n\tif (Array.isArray(value) || Array.isArray(update)) {\n\t\tconst arrayEquals = Array.isArray(value) && Array.isArray(update) && arrays.equals(value, update);\n\t\treturn new ApplyUpdateResult(update, !arrayEquals);\n\t}\n\tlet didChange = false;\n\tfor (const key in update) {\n\t\tif ((update as T & object).hasOwnProperty(key)) {\n\t\t\tconst result = applyUpdate(value[key], update[key]);\n\t\t\tif (result.didChange) {\n\t\t\t\tvalue[key] = result.newValue;\n\t\t\t\tdidChange = true;\n\t\t\t}\n\t\t}\n\t}\n\treturn new ApplyUpdateResult(value, didChange);\n}\n\n/**\n * @internal\n */\nabstract class ComputedEditorOption<K extends EditorOption, V> implements IEditorOption<K, V> {\n\n\tpublic readonly id: K;\n\tpublic readonly name: '_never_';\n\tpublic readonly defaultValue: V;\n\tpublic readonly schema: IConfigurationPropertySchema | undefined = undefined;\n\n\tconstructor(id: K) {\n\t\tthis.id = id;\n\t\tthis.name = '_never_';\n\t\tthis.defaultValue = <any>undefined;\n\t}\n\n\tpublic applyUpdate(value: V | undefined, update: V): ApplyUpdateResult<V> {\n\t\treturn applyUpdate(value, update);\n\t}\n\n\tpublic validate(input: any): V {\n\t\treturn this.defaultValue;\n\t}\n\n\tpublic abstract compute(env: IEnvironmentalOptions, options: IComputedEditorOptions, value: V): V;\n}\n\nclass SimpleEditorOption<K extends EditorOption, V> implements IEditorOption<K, V> {\n\n\tpublic readonly id: K;\n\tpublic readonly name: PossibleKeyName<V>;\n\tpublic readonly defaultValue: V;\n\tpublic readonly schema: IConfigurationPropertySchema | undefined;\n\n\tconstructor(id: K, name: PossibleKeyName<V>, defaultValue: V, schema?: IConfigurationPropertySchema) {\n\t\tthis.id = id;\n\t\tthis.name = name;\n\t\tthis.defaultValue = defaultValue;\n\t\tthis.schema = schema;\n\t}\n\n\tpublic applyUpdate(value: V | undefined, update: V): ApplyUpdateResult<V> {\n\t\treturn applyUpdate(value, update);\n\t}\n\n\tpublic validate(input: any): V {\n\t\tif (typeof input === 'undefined') {\n\t\t\treturn this.defaultValue;\n\t\t}\n\t\treturn input as any;\n\t}\n\n\tpublic compute(env: IEnvironmentalOptions, options: IComputedEditorOptions, value: V): V {\n\t\treturn value;\n\t}\n}\n\n/**\n * @internal\n */\nexport function boolean(value: any, defaultValue: boolean): boolean {\n\tif (typeof value === 'undefined') {\n\t\treturn defaultValue;\n\t}\n\tif (value === 'false') {\n\t\t// treat the string 'false' as false\n\t\treturn false;\n\t}\n\treturn Boolean(value);\n}\n\nclass EditorBooleanOption<K extends EditorOption> extends SimpleEditorOption<K, boolean> {\n\n\tconstructor(id: K, name: PossibleKeyName<boolean>, defaultValue: boolean, schema: IConfigurationPropertySchema | undefined = undefined) {\n\t\tif (typeof schema !== 'undefined') {\n\t\t\tschema.type = 'boolean';\n\t\t\tschema.default = defaultValue;\n\t\t}\n\t\tsuper(id, name, defaultValue, schema);\n\t}\n\n\tpublic override validate(input: any): boolean {\n\t\treturn boolean(input, this.defaultValue);\n\t}\n}\n\n/**\n * @internal\n */\nexport function clampedInt<T>(value: any, defaultValue: T, minimum: number, maximum: number): number | T {\n\tif (typeof value === 'undefined') {\n\t\treturn defaultValue;\n\t}\n\tlet r = parseInt(value, 10);\n\tif (isNaN(r)) {\n\t\treturn defaultValue;\n\t}\n\tr = Math.max(minimum, r);\n\tr = Math.min(maximum, r);\n\treturn r | 0;\n}\n\nclass EditorIntOption<K extends EditorOption> extends SimpleEditorOption<K, number> {\n\n\tpublic static clampedInt<T>(value: any, defaultValue: T, minimum: number, maximum: number): number | T {\n\t\treturn clampedInt(value, defaultValue, minimum, maximum);\n\t}\n\n\tpublic readonly minimum: number;\n\tpublic readonly maximum: number;\n\n\tconstructor(id: K, name: PossibleKeyName<number>, defaultValue: number, minimum: number, maximum: number, schema: IConfigurationPropertySchema | undefined = undefined) {\n\t\tif (typeof schema !== 'undefined') {\n\t\t\tschema.type = 'integer';\n\t\t\tschema.default = defaultValue;\n\t\t\tschema.minimum = minimum;\n\t\t\tschema.maximum = maximum;\n\t\t}\n\t\tsuper(id, name, defaultValue, schema);\n\t\tthis.minimum = minimum;\n\t\tthis.maximum = maximum;\n\t}\n\n\tpublic override validate(input: any): number {\n\t\treturn EditorIntOption.clampedInt(input, this.defaultValue, this.minimum, this.maximum);\n\t}\n}\n\nclass EditorFloatOption<K extends EditorOption> extends SimpleEditorOption<K, number> {\n\n\tpublic static clamp(n: number, min: number, max: number): number {\n\t\tif (n < min) {\n\t\t\treturn min;\n\t\t}\n\t\tif (n > max) {\n\t\t\treturn max;\n\t\t}\n\t\treturn n;\n\t}\n\n\tpublic static float(value: any, defaultValue: number): number {\n\t\tif (typeof value === 'number') {\n\t\t\treturn value;\n\t\t}\n\t\tif (typeof value === 'undefined') {\n\t\t\treturn defaultValue;\n\t\t}\n\t\tconst r = parseFloat(value);\n\t\treturn (isNaN(r) ? defaultValue : r);\n\t}\n\n\tpublic readonly validationFn: (value: number) => number;\n\n\tconstructor(id: K, name: PossibleKeyName<number>, defaultValue: number, validationFn: (value: number) => number, schema?: IConfigurationPropertySchema) {\n\t\tif (typeof schema !== 'undefined') {\n\t\t\tschema.type = 'number';\n\t\t\tschema.default = defaultValue;\n\t\t}\n\t\tsuper(id, name, defaultValue, schema);\n\t\tthis.validationFn = validationFn;\n\t}\n\n\tpublic override validate(input: any): number {\n\t\treturn this.validationFn(EditorFloatOption.float(input, this.defaultValue));\n\t}\n}\n\nclass EditorStringOption<K extends EditorOption> extends SimpleEditorOption<K, string> {\n\n\tpublic static string(value: any, defaultValue: string): string {\n\t\tif (typeof value !== 'string') {\n\t\t\treturn defaultValue;\n\t\t}\n\t\treturn value;\n\t}\n\n\tconstructor(id: K, name: PossibleKeyName<string>, defaultValue: string, schema: IConfigurationPropertySchema | undefined = undefined) {\n\t\tif (typeof schema !== 'undefined') {\n\t\t\tschema.type = 'string';\n\t\t\tschema.default = defaultValue;\n\t\t}\n\t\tsuper(id, name, defaultValue, schema);\n\t}\n\n\tpublic override validate(input: any): string {\n\t\treturn EditorStringOption.string(input, this.defaultValue);\n\t}\n}\n\n/**\n * @internal\n */\nexport function stringSet<T>(value: T | undefined, defaultValue: T, allowedValues: ReadonlyArray<T>): T {\n\tif (typeof value !== 'string') {\n\t\treturn defaultValue;\n\t}\n\tif (allowedValues.indexOf(value) === -1) {\n\t\treturn defaultValue;\n\t}\n\treturn value;\n}\n\nclass EditorStringEnumOption<K extends EditorOption, V extends string> extends SimpleEditorOption<K, V> {\n\n\tprivate readonly _allowedValues: ReadonlyArray<V>;\n\n\tconstructor(id: K, name: PossibleKeyName<V>, defaultValue: V, allowedValues: ReadonlyArray<V>, schema: IConfigurationPropertySchema | undefined = undefined) {\n\t\tif (typeof schema !== 'undefined') {\n\t\t\tschema.type = 'string';\n\t\t\tschema.enum = <any>allowedValues;\n\t\t\tschema.default = defaultValue;\n\t\t}\n\t\tsuper(id, name, defaultValue, schema);\n\t\tthis._allowedValues = allowedValues;\n\t}\n\n\tpublic override validate(input: any): V {\n\t\treturn stringSet<V>(input, this.defaultValue, this._allowedValues);\n\t}\n}\n\nclass EditorEnumOption<K extends EditorOption, T extends string, V> extends BaseEditorOption<K, T, V> {\n\n\tprivate readonly _allowedValues: T[];\n\tprivate readonly _convert: (value: T) => V;\n\n\tconstructor(id: K, name: PossibleKeyName<T>, defaultValue: V, defaultStringValue: string, allowedValues: T[], convert: (value: T) => V, schema: IConfigurationPropertySchema | undefined = undefined) {\n\t\tif (typeof schema !== 'undefined') {\n\t\t\tschema.type = 'string';\n\t\t\tschema.enum = allowedValues;\n\t\t\tschema.default = defaultStringValue;\n\t\t}\n\t\tsuper(id, name, defaultValue, schema);\n\t\tthis._allowedValues = allowedValues;\n\t\tthis._convert = convert;\n\t}\n\n\tpublic validate(input: any): V {\n\t\tif (typeof input !== 'string') {\n\t\t\treturn this.defaultValue;\n\t\t}\n\t\tif (this._allowedValues.indexOf(<T>input) === -1) {\n\t\t\treturn this.defaultValue;\n\t\t}\n\t\treturn this._convert(<any>input);\n\t}\n}\n\n//#endregion\n\n//#region autoIndent\n\nfunction _autoIndentFromString(autoIndent: 'none' | 'keep' | 'brackets' | 'advanced' | 'full'): EditorAutoIndentStrategy {\n\tswitch (autoIndent) {\n\t\tcase 'none': return EditorAutoIndentStrategy.None;\n\t\tcase 'keep': return EditorAutoIndentStrategy.Keep;\n\t\tcase 'brackets': return EditorAutoIndentStrategy.Brackets;\n\t\tcase 'advanced': return EditorAutoIndentStrategy.Advanced;\n\t\tcase 'full': return EditorAutoIndentStrategy.Full;\n\t}\n}\n\n//#endregion\n\n//#region accessibilitySupport\n\nclass EditorAccessibilitySupport extends BaseEditorOption<EditorOption.accessibilitySupport, 'auto' | 'off' | 'on', AccessibilitySupport> {\n\n\tconstructor() {\n\t\tsuper(\n\t\t\tEditorOption.accessibilitySupport, 'accessibilitySupport', AccessibilitySupport.Unknown,\n\t\t\t{\n\t\t\t\ttype: 'string',\n\t\t\t\tenum: ['auto', 'on', 'off'],\n\t\t\t\tenumDescriptions: [\n\t\t\t\t\tnls.localize('accessibilitySupport.auto', \"The editor will use platform APIs to detect when a Screen Reader is attached.\"),\n\t\t\t\t\tnls.localize('accessibilitySupport.on', \"The editor will be permanently optimized for usage with a Screen Reader. Word wrapping will be disabled.\"),\n\t\t\t\t\tnls.localize('accessibilitySupport.off', \"The editor will never be optimized for usage with a Screen Reader.\"),\n\t\t\t\t],\n\t\t\t\tdefault: 'auto',\n\t\t\t\tdescription: nls.localize('accessibilitySupport', \"Controls whether the editor should run in a mode where it is optimized for screen readers. Setting to on will disable word wrapping.\")\n\t\t\t}\n\t\t);\n\t}\n\n\tpublic validate(input: any): AccessibilitySupport {\n\t\tswitch (input) {\n\t\t\tcase 'auto': return AccessibilitySupport.Unknown;\n\t\t\tcase 'off': return AccessibilitySupport.Disabled;\n\t\t\tcase 'on': return AccessibilitySupport.Enabled;\n\t\t}\n\t\treturn this.defaultValue;\n\t}\n\n\tpublic override compute(env: IEnvironmentalOptions, options: IComputedEditorOptions, value: AccessibilitySupport): AccessibilitySupport {\n\t\tif (value === AccessibilitySupport.Unknown) {\n\t\t\t// The editor reads the `accessibilitySupport` from the environment\n\t\t\treturn env.accessibilitySupport;\n\t\t}\n\t\treturn value;\n\t}\n}\n\n//#endregion\n\n//#region comments\n\n/**\n * Configuration options for editor comments\n */\nexport interface IEditorCommentsOptions {\n\t/**\n\t * Insert a space after the line comment token and inside the block comments tokens.\n\t * Defaults to true.\n\t */\n\tinsertSpace?: boolean;\n\t/**\n\t * Ignore empty lines when inserting line comments.\n\t * Defaults to true.\n\t */\n\tignoreEmptyLines?: boolean;\n}\n\n/**\n * @internal\n */\nexport type EditorCommentsOptions = Readonly<Required<IEditorCommentsOptions>>;\n\nclass EditorComments extends BaseEditorOption<EditorOption.comments, IEditorCommentsOptions, EditorCommentsOptions> {\n\n\tconstructor() {\n\t\tconst defaults: EditorCommentsOptions = {\n\t\t\tinsertSpace: true,\n\t\t\tignoreEmptyLines: true,\n\t\t};\n\t\tsuper(\n\t\t\tEditorOption.comments, 'comments', defaults,\n\t\t\t{\n\t\t\t\t'editor.comments.insertSpace': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.insertSpace,\n\t\t\t\t\tdescription: nls.localize('comments.insertSpace', \"Controls whether a space character is inserted when commenting.\")\n\t\t\t\t},\n\t\t\t\t'editor.comments.ignoreEmptyLines': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.ignoreEmptyLines,\n\t\t\t\t\tdescription: nls.localize('comments.ignoreEmptyLines', 'Controls if empty lines should be ignored with toggle, add or remove actions for line comments.')\n\t\t\t\t},\n\t\t\t}\n\t\t);\n\t}\n\n\tpublic validate(_input: any): EditorCommentsOptions {\n\t\tif (!_input || typeof _input !== 'object') {\n\t\t\treturn this.defaultValue;\n\t\t}\n\t\tconst input = _input as IEditorCommentsOptions;\n\t\treturn {\n\t\t\tinsertSpace: boolean(input.insertSpace, this.defaultValue.insertSpace),\n\t\t\tignoreEmptyLines: boolean(input.ignoreEmptyLines, this.defaultValue.ignoreEmptyLines),\n\t\t};\n\t}\n}\n\n//#endregion\n\n//#region cursorBlinking\n\n/**\n * The kind of animation in which the editor's cursor should be rendered.\n */\nexport const enum TextEditorCursorBlinkingStyle {\n\t/**\n\t * Hidden\n\t */\n\tHidden = 0,\n\t/**\n\t * Blinking\n\t */\n\tBlink = 1,\n\t/**\n\t * Blinking with smooth fading\n\t */\n\tSmooth = 2,\n\t/**\n\t * Blinking with prolonged filled state and smooth fading\n\t */\n\tPhase = 3,\n\t/**\n\t * Expand collapse animation on the y axis\n\t */\n\tExpand = 4,\n\t/**\n\t * No-Blinking\n\t */\n\tSolid = 5\n}\n\nfunction _cursorBlinkingStyleFromString(cursorBlinkingStyle: 'blink' | 'smooth' | 'phase' | 'expand' | 'solid'): TextEditorCursorBlinkingStyle {\n\tswitch (cursorBlinkingStyle) {\n\t\tcase 'blink': return TextEditorCursorBlinkingStyle.Blink;\n\t\tcase 'smooth': return TextEditorCursorBlinkingStyle.Smooth;\n\t\tcase 'phase': return TextEditorCursorBlinkingStyle.Phase;\n\t\tcase 'expand': return TextEditorCursorBlinkingStyle.Expand;\n\t\tcase 'solid': return TextEditorCursorBlinkingStyle.Solid;\n\t}\n}\n\n//#endregion\n\n//#region cursorStyle\n\n/**\n * The style in which the editor's cursor should be rendered.\n */\nexport enum TextEditorCursorStyle {\n\t/**\n\t * As a vertical line (sitting between two characters).\n\t */\n\tLine = 1,\n\t/**\n\t * As a block (sitting on top of a character).\n\t */\n\tBlock = 2,\n\t/**\n\t * As a horizontal line (sitting under a character).\n\t */\n\tUnderline = 3,\n\t/**\n\t * As a thin vertical line (sitting between two characters).\n\t */\n\tLineThin = 4,\n\t/**\n\t * As an outlined block (sitting on top of a character).\n\t */\n\tBlockOutline = 5,\n\t/**\n\t * As a thin horizontal line (sitting under a character).\n\t */\n\tUnderlineThin = 6\n}\n\n/**\n * @internal\n */\nexport function cursorStyleToString(cursorStyle: TextEditorCursorStyle): 'line' | 'block' | 'underline' | 'line-thin' | 'block-outline' | 'underline-thin' {\n\tswitch (cursorStyle) {\n\t\tcase TextEditorCursorStyle.Line: return 'line';\n\t\tcase TextEditorCursorStyle.Block: return 'block';\n\t\tcase TextEditorCursorStyle.Underline: return 'underline';\n\t\tcase TextEditorCursorStyle.LineThin: return 'line-thin';\n\t\tcase TextEditorCursorStyle.BlockOutline: return 'block-outline';\n\t\tcase TextEditorCursorStyle.UnderlineThin: return 'underline-thin';\n\t}\n}\n\nfunction _cursorStyleFromString(cursorStyle: 'line' | 'block' | 'underline' | 'line-thin' | 'block-outline' | 'underline-thin'): TextEditorCursorStyle {\n\tswitch (cursorStyle) {\n\t\tcase 'line': return TextEditorCursorStyle.Line;\n\t\tcase 'block': return TextEditorCursorStyle.Block;\n\t\tcase 'underline': return TextEditorCursorStyle.Underline;\n\t\tcase 'line-thin': return TextEditorCursorStyle.LineThin;\n\t\tcase 'block-outline': return TextEditorCursorStyle.BlockOutline;\n\t\tcase 'underline-thin': return TextEditorCursorStyle.UnderlineThin;\n\t}\n}\n\n//#endregion\n\n//#region editorClassName\n\nclass EditorClassName extends ComputedEditorOption<EditorOption.editorClassName, string> {\n\n\tconstructor() {\n\t\tsuper(EditorOption.editorClassName);\n\t}\n\n\tpublic compute(env: IEnvironmentalOptions, options: IComputedEditorOptions, _: string): string {\n\t\tconst classNames = ['monaco-editor'];\n\t\tif (options.get(EditorOption.extraEditorClassName)) {\n\t\t\tclassNames.push(options.get(EditorOption.extraEditorClassName));\n\t\t}\n\t\tif (env.extraEditorClassName) {\n\t\t\tclassNames.push(env.extraEditorClassName);\n\t\t}\n\t\tif (options.get(EditorOption.mouseStyle) === 'default') {\n\t\t\tclassNames.push('mouse-default');\n\t\t} else if (options.get(EditorOption.mouseStyle) === 'copy') {\n\t\t\tclassNames.push('mouse-copy');\n\t\t}\n\n\t\tif (options.get(EditorOption.showUnused)) {\n\t\t\tclassNames.push('showUnused');\n\t\t}\n\n\t\tif (options.get(EditorOption.showDeprecated)) {\n\t\t\tclassNames.push('showDeprecated');\n\t\t}\n\n\t\treturn classNames.join(' ');\n\t}\n}\n\n//#endregion\n\n//#region emptySelectionClipboard\n\nclass EditorEmptySelectionClipboard extends EditorBooleanOption<EditorOption.emptySelectionClipboard> {\n\n\tconstructor() {\n\t\tsuper(\n\t\t\tEditorOption.emptySelectionClipboard, 'emptySelectionClipboard', true,\n\t\t\t{ description: nls.localize('emptySelectionClipboard', \"Controls whether copying without a selection copies the current line.\") }\n\t\t);\n\t}\n\n\tpublic override compute(env: IEnvironmentalOptions, options: IComputedEditorOptions, value: boolean): boolean {\n\t\treturn value && env.emptySelectionClipboard;\n\t}\n}\n\n//#endregion\n\n//#region find\n\n/**\n * Configuration options for editor find widget\n */\nexport interface IEditorFindOptions {\n\t/**\n\t* Controls whether the cursor should move to find matches while typing.\n\t*/\n\tcursorMoveOnType?: boolean;\n\t/**\n\t * Controls if we seed search string in the Find Widget with editor selection.\n\t */\n\tseedSearchStringFromSelection?: 'never' | 'always' | 'selection';\n\t/**\n\t * Controls if Find in Selection flag is turned on in the editor.\n\t */\n\tautoFindInSelection?: 'never' | 'always' | 'multiline';\n\t/*\n\t * Controls whether the Find Widget should add extra lines on top of the editor.\n\t */\n\taddExtraSpaceOnTop?: boolean;\n\t/**\n\t * @internal\n\t * Controls if the Find Widget should read or modify the shared find clipboard on macOS\n\t */\n\tglobalFindClipboard?: boolean;\n\t/**\n\t * Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found\n\t */\n\tloop?: boolean;\n}\n\n/**\n * @internal\n */\nexport type EditorFindOptions = Readonly<Required<IEditorFindOptions>>;\n\nclass EditorFind extends BaseEditorOption<EditorOption.find, IEditorFindOptions, EditorFindOptions> {\n\n\tconstructor() {\n\t\tconst defaults: EditorFindOptions = {\n\t\t\tcursorMoveOnType: true,\n\t\t\tseedSearchStringFromSelection: 'always',\n\t\t\tautoFindInSelection: 'never',\n\t\t\tglobalFindClipboard: false,\n\t\t\taddExtraSpaceOnTop: true,\n\t\t\tloop: true\n\t\t};\n\t\tsuper(\n\t\t\tEditorOption.find, 'find', defaults,\n\t\t\t{\n\t\t\t\t'editor.find.cursorMoveOnType': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.cursorMoveOnType,\n\t\t\t\t\tdescription: nls.localize('find.cursorMoveOnType', \"Controls whether the cursor should jump to find matches while typing.\")\n\t\t\t\t},\n\t\t\t\t'editor.find.seedSearchStringFromSelection': {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tenum: ['never', 'always', 'selection'],\n\t\t\t\t\tdefault: defaults.seedSearchStringFromSelection,\n\t\t\t\t\tenumDescriptions: [\n\t\t\t\t\t\tnls.localize('editor.find.seedSearchStringFromSelection.never', 'Never seed search string from the editor selection.'),\n\t\t\t\t\t\tnls.localize('editor.find.seedSearchStringFromSelection.always', 'Always seed search string from the editor selection, including word at cursor position.'),\n\t\t\t\t\t\tnls.localize('editor.find.seedSearchStringFromSelection.selection', 'Only seed search string from the editor selection.')\n\t\t\t\t\t],\n\t\t\t\t\tdescription: nls.localize('find.seedSearchStringFromSelection', \"Controls whether the search string in the Find Widget is seeded from the editor selection.\")\n\t\t\t\t},\n\t\t\t\t'editor.find.autoFindInSelection': {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tenum: ['never', 'always', 'multiline'],\n\t\t\t\t\tdefault: defaults.autoFindInSelection,\n\t\t\t\t\tenumDescriptions: [\n\t\t\t\t\t\tnls.localize('editor.find.autoFindInSelection.never', 'Never turn on Find in Selection automatically (default).'),\n\t\t\t\t\t\tnls.localize('editor.find.autoFindInSelection.always', 'Always turn on Find in Selection automatically.'),\n\t\t\t\t\t\tnls.localize('editor.find.autoFindInSelection.multiline', 'Turn on Find in Selection automatically when multiple lines of content are selected.')\n\t\t\t\t\t],\n\t\t\t\t\tdescription: nls.localize('find.autoFindInSelection', \"Controls the condition for turning on Find in Selection automatically.\")\n\t\t\t\t},\n\t\t\t\t'editor.find.globalFindClipboard': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.globalFindClipboard,\n\t\t\t\t\tdescription: nls.localize('find.globalFindClipboard', \"Controls whether the Find Widget should read or modify the shared find clipboard on macOS.\"),\n\t\t\t\t\tincluded: platform.isMacintosh\n\t\t\t\t},\n\t\t\t\t'editor.find.addExtraSpaceOnTop': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.addExtraSpaceOnTop,\n\t\t\t\t\tdescription: nls.localize('find.addExtraSpaceOnTop', \"Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.\")\n\t\t\t\t},\n\t\t\t\t'editor.find.loop': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.loop,\n\t\t\t\t\tdescription: nls.localize('find.loop', \"Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.\")\n\t\t\t\t},\n\n\t\t\t}\n\t\t);\n\t}\n\n\tpublic validate(_input: any): EditorFindOptions {\n\t\tif (!_input || typeof _input !== 'object') {\n\t\t\treturn this.defaultValue;\n\t\t}\n\t\tconst input = _input as IEditorFindOptions;\n\t\treturn {\n\t\t\tcursorMoveOnType: boolean(input.cursorMoveOnType, this.defaultValue.cursorMoveOnType),\n\t\t\tseedSearchStringFromSelection: typeof _input.seedSearchStringFromSelection === 'boolean'\n\t\t\t\t? (_input.seedSearchStringFromSelection ? 'always' : 'never')\n\t\t\t\t: stringSet<'never' | 'always' | 'selection'>(input.seedSearchStringFromSelection, this.defaultValue.seedSearchStringFromSelection, ['never', 'always', 'selection']),\n\t\t\tautoFindInSelection: typeof _input.autoFindInSelection === 'boolean'\n\t\t\t\t? (_input.autoFindInSelection ? 'always' : 'never')\n\t\t\t\t: stringSet<'never' | 'always' | 'multiline'>(input.autoFindInSelection, this.defaultValue.autoFindInSelection, ['never', 'always', 'multiline']),\n\t\t\tglobalFindClipboard: boolean(input.globalFindClipboard, this.defaultValue.globalFindClipboard),\n\t\t\taddExtraSpaceOnTop: boolean(input.addExtraSpaceOnTop, this.defaultValue.addExtraSpaceOnTop),\n\t\t\tloop: boolean(input.loop, this.defaultValue.loop),\n\t\t};\n\t}\n}\n\n//#endregion\n\n//#region fontLigatures\n\n/**\n * @internal\n */\nexport class EditorFontLigatures extends BaseEditorOption<EditorOption.fontLigatures, boolean | string, string> {\n\n\tpublic static OFF = '\"liga\" off, \"calt\" off';\n\tpublic static ON = '\"liga\" on, \"calt\" on';\n\n\tconstructor() {\n\t\tsuper(\n\t\t\tEditorOption.fontLigatures, 'fontLigatures', EditorFontLigatures.OFF,\n\t\t\t{\n\t\t\t\tanyOf: [\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\t\tdescription: nls.localize('fontLigatures', \"Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.\"),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\tdescription: nls.localize('fontFeatureSettings', \"Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.\")\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tdescription: nls.localize('fontLigaturesGeneral', \"Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property.\"),\n\t\t\t\tdefault: false\n\t\t\t}\n\t\t);\n\t}\n\n\tpublic validate(input: any): string {\n\t\tif (typeof input === 'undefined') {\n\t\t\treturn this.defaultValue;\n\t\t}\n\t\tif (typeof input === 'string') {\n\t\t\tif (input === 'false') {\n\t\t\t\treturn EditorFontLigatures.OFF;\n\t\t\t}\n\t\t\tif (input === 'true') {\n\t\t\t\treturn EditorFontLigatures.ON;\n\t\t\t}\n\t\t\treturn input;\n\t\t}\n\t\tif (Boolean(input)) {\n\t\t\treturn EditorFontLigatures.ON;\n\t\t}\n\t\treturn EditorFontLigatures.OFF;\n\t}\n}\n\n//#endregion\n\n//#region fontInfo\n\nclass EditorFontInfo extends ComputedEditorOption<EditorOption.fontInfo, FontInfo> {\n\n\tconstructor() {\n\t\tsuper(EditorOption.fontInfo);\n\t}\n\n\tpublic compute(env: IEnvironmentalOptions, options: IComputedEditorOptions, _: FontInfo): FontInfo {\n\t\treturn env.fontInfo;\n\t}\n}\n\n//#endregion\n\n//#region fontSize\n\nclass EditorFontSize extends SimpleEditorOption<EditorOption.fontSize, number> {\n\n\tconstructor() {\n\t\tsuper(\n\t\t\tEditorOption.fontSize, 'fontSize', EDITOR_FONT_DEFAULTS.fontSize,\n\t\t\t{\n\t\t\t\ttype: 'number',\n\t\t\t\tminimum: 6,\n\t\t\t\tmaximum: 100,\n\t\t\t\tdefault: EDITOR_FONT_DEFAULTS.fontSize,\n\t\t\t\tdescription: nls.localize('fontSize', \"Controls the font size in pixels.\")\n\t\t\t}\n\t\t);\n\t}\n\n\tpublic override validate(input: any): number {\n\t\tconst r = EditorFloatOption.float(input, this.defaultValue);\n\t\tif (r === 0) {\n\t\t\treturn EDITOR_FONT_DEFAULTS.fontSize;\n\t\t}\n\t\treturn EditorFloatOption.clamp(r, 6, 100);\n\t}\n\tpublic override compute(env: IEnvironmentalOptions, options: IComputedEditorOptions, value: number): number {\n\t\t// The final fontSize respects the editor zoom level.\n\t\t// So take the result from env.fontInfo\n\t\treturn env.fontInfo.fontSize;\n\t}\n}\n\n//#endregion\n\n//#region fontWeight\n\nclass EditorFontWeight extends BaseEditorOption<EditorOption.fontWeight, string, string> {\n\tprivate static SUGGESTION_VALUES = ['normal', 'bold', '100', '200', '300', '400', '500', '600', '700', '800', '900'];\n\tprivate static MINIMUM_VALUE = 1;\n\tprivate static MAXIMUM_VALUE = 1000;\n\n\tconstructor() {\n\t\tsuper(\n\t\t\tEditorOption.fontWeight, 'fontWeight', EDITOR_FONT_DEFAULTS.fontWeight,\n\t\t\t{\n\t\t\t\tanyOf: [\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: 'number',\n\t\t\t\t\t\tminimum: EditorFontWeight.MINIMUM_VALUE,\n\t\t\t\t\t\tmaximum: EditorFontWeight.MAXIMUM_VALUE,\n\t\t\t\t\t\terrorMessage: nls.localize('fontWeightErrorMessage', \"Only \\\"normal\\\" and \\\"bold\\\" keywords or numbers between 1 and 1000 are allowed.\")\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\tpattern: '^(normal|bold|1000|[1-9][0-9]{0,2})$'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tenum: EditorFontWeight.SUGGESTION_VALUES\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tdefault: EDITOR_FONT_DEFAULTS.fontWeight,\n\t\t\t\tdescription: nls.localize('fontWeight', \"Controls the font weight. Accepts \\\"normal\\\" and \\\"bold\\\" keywords or numbers between 1 and 1000.\")\n\t\t\t}\n\t\t);\n\t}\n\n\tpublic validate(input: any): string {\n\t\tif (input === 'normal' || input === 'bold') {\n\t\t\treturn input;\n\t\t}\n\t\treturn String(EditorIntOption.clampedInt(input, EDITOR_FONT_DEFAULTS.fontWeight, EditorFontWeight.MINIMUM_VALUE, EditorFontWeight.MAXIMUM_VALUE));\n\t}\n}\n\n//#endregion\n\n//#region gotoLocation\n\nexport type GoToLocationValues = 'peek' | 'gotoAndPeek' | 'goto';\n\n/**\n * Configuration options for go to location\n */\nexport interface IGotoLocationOptions {\n\n\tmultiple?: GoToLocationValues;\n\n\tmultipleDefinitions?: GoToLocationValues;\n\tmultipleTypeDefinitions?: GoToLocationValues;\n\tmultipleDeclarations?: GoToLocationValues;\n\tmultipleImplementations?: GoToLocationValues;\n\tmultipleReferences?: GoToLocationValues;\n\n\talternativeDefinitionCommand?: string;\n\talternativeTypeDefinitionCommand?: string;\n\talternativeDeclarationCommand?: string;\n\talternativeImplementationCommand?: string;\n\talternativeReferenceCommand?: string;\n}\n\n/**\n * @internal\n */\nexport type GoToLocationOptions = Readonly<Required<IGotoLocationOptions>>;\n\nclass EditorGoToLocation extends BaseEditorOption<EditorOption.gotoLocation, IGotoLocationOptions, GoToLocationOptions> {\n\n\tconstructor() {\n\t\tconst defaults: GoToLocationOptions = {\n\t\t\tmultiple: 'peek',\n\t\t\tmultipleDefinitions: 'peek',\n\t\t\tmultipleTypeDefinitions: 'peek',\n\t\t\tmultipleDeclarations: 'peek',\n\t\t\tmultipleImplementations: 'peek',\n\t\t\tmultipleReferences: 'peek',\n\t\t\talternativeDefinitionCommand: 'editor.action.goToReferences',\n\t\t\talternativeTypeDefinitionCommand: 'editor.action.goToReferences',\n\t\t\talternativeDeclarationCommand: 'editor.action.goToReferences',\n\t\t\talternativeImplementationCommand: '',\n\t\t\talternativeReferenceCommand: '',\n\t\t};\n\t\tconst jsonSubset: IJSONSchema = {\n\t\t\ttype: 'string',\n\t\t\tenum: ['peek', 'gotoAndPeek', 'goto'],\n\t\t\tdefault: defaults.multiple,\n\t\t\tenumDescriptions: [\n\t\t\t\tnls.localize('editor.gotoLocation.multiple.peek', 'Show peek view of the results (default)'),\n\t\t\t\tnls.localize('editor.gotoLocation.multiple.gotoAndPeek', 'Go to the primary result and show a peek view'),\n\t\t\t\tnls.localize('editor.gotoLocation.multiple.goto', 'Go to the primary result and enable peek-less navigation to others')\n\t\t\t]\n\t\t};\n\t\tconst alternativeCommandOptions = ['', 'editor.action.referenceSearch.trigger', 'editor.action.goToReferences', 'editor.action.peekImplementation', 'editor.action.goToImplementation', 'editor.action.peekTypeDefinition', 'editor.action.goToTypeDefinition', 'editor.action.peekDeclaration', 'editor.action.revealDeclaration', 'editor.action.peekDefinition', 'editor.action.revealDefinitionAside', 'editor.action.revealDefinition'];\n\t\tsuper(\n\t\t\tEditorOption.gotoLocation, 'gotoLocation', defaults,\n\t\t\t{\n\t\t\t\t'editor.gotoLocation.multiple': {\n\t\t\t\t\tdeprecationMessage: nls.localize('editor.gotoLocation.multiple.deprecated', \"This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.\"),\n\t\t\t\t},\n\t\t\t\t'editor.gotoLocation.multipleDefinitions': {\n\t\t\t\t\tdescription: nls.localize('editor.editor.gotoLocation.multipleDefinitions', \"Controls the behavior the 'Go to Definition'-command when multiple target locations exist.\"),\n\t\t\t\t\t...jsonSubset,\n\t\t\t\t},\n\t\t\t\t'editor.gotoLocation.multipleTypeDefinitions': {\n\t\t\t\t\tdescription: nls.localize('editor.editor.gotoLocation.multipleTypeDefinitions', \"Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist.\"),\n\t\t\t\t\t...jsonSubset,\n\t\t\t\t},\n\t\t\t\t'editor.gotoLocation.multipleDeclarations': {\n\t\t\t\t\tdescription: nls.localize('editor.editor.gotoLocation.multipleDeclarations', \"Controls the behavior the 'Go to Declaration'-command when multiple target locations exist.\"),\n\t\t\t\t\t...jsonSubset,\n\t\t\t\t},\n\t\t\t\t'editor.gotoLocation.multipleImplementations': {\n\t\t\t\t\tdescription: nls.localize('editor.editor.gotoLocation.multipleImplemenattions', \"Controls the behavior the 'Go to Implementations'-command when multiple target locations exist.\"),\n\t\t\t\t\t...jsonSubset,\n\t\t\t\t},\n\t\t\t\t'editor.gotoLocation.multipleReferences': {\n\t\t\t\t\tdescription: nls.localize('editor.editor.gotoLocation.multipleReferences', \"Controls the behavior the 'Go to References'-command when multiple target locations exist.\"),\n\t\t\t\t\t...jsonSubset,\n\t\t\t\t},\n\t\t\t\t'editor.gotoLocation.alternativeDefinitionCommand': {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tdefault: defaults.alternativeDefinitionCommand,\n\t\t\t\t\tenum: alternativeCommandOptions,\n\t\t\t\t\tdescription: nls.localize('alternativeDefinitionCommand', \"Alternative command id that is being executed when the result of 'Go to Definition' is the current location.\")\n\t\t\t\t},\n\t\t\t\t'editor.gotoLocation.alternativeTypeDefinitionCommand': {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tdefault: defaults.alternativeTypeDefinitionCommand,\n\t\t\t\t\tenum: alternativeCommandOptions,\n\t\t\t\t\tdescription: nls.localize('alternativeTypeDefinitionCommand', \"Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.\")\n\t\t\t\t},\n\t\t\t\t'editor.gotoLocation.alternativeDeclarationCommand': {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tdefault: defaults.alternativeDeclarationCommand,\n\t\t\t\t\tenum: alternativeCommandOptions,\n\t\t\t\t\tdescription: nls.localize('alternativeDeclarationCommand', \"Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.\")\n\t\t\t\t},\n\t\t\t\t'editor.gotoLocation.alternativeImplementationCommand': {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tdefault: defaults.alternativeImplementationCommand,\n\t\t\t\t\tenum: alternativeCommandOptions,\n\t\t\t\t\tdescription: nls.localize('alternativeImplementationCommand', \"Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.\")\n\t\t\t\t},\n\t\t\t\t'editor.gotoLocation.alternativeReferenceCommand': {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tdefault: defaults.alternativeReferenceCommand,\n\t\t\t\t\tenum: alternativeCommandOptions,\n\t\t\t\t\tdescription: nls.localize('alternativeReferenceCommand', \"Alternative command id that is being executed when the result of 'Go to Reference' is the current location.\")\n\t\t\t\t},\n\t\t\t}\n\t\t);\n\t}\n\n\tpublic validate(_input: any): GoToLocationOptions {\n\t\tif (!_input || typeof _input !== 'object') {\n\t\t\treturn this.defaultValue;\n\t\t}\n\t\tconst input = _input as IGotoLocationOptions;\n\t\treturn {\n\t\t\tmultiple: stringSet<GoToLocationValues>(input.multiple, this.defaultValue.multiple!, ['peek', 'gotoAndPeek', 'goto']),\n\t\t\tmultipleDefinitions: input.multipleDefinitions ?? stringSet<GoToLocationValues>(input.multipleDefinitions, 'peek', ['peek', 'gotoAndPeek', 'goto']),\n\t\t\tmultipleTypeDefinitions: input.multipleTypeDefinitions ?? stringSet<GoToLocationValues>(input.multipleTypeDefinitions, 'peek', ['peek', 'gotoAndPeek', 'goto']),\n\t\t\tmultipleDeclarations: input.multipleDeclarations ?? stringSet<GoToLocationValues>(input.multipleDeclarations, 'peek', ['peek', 'gotoAndPeek', 'goto']),\n\t\t\tmultipleImplementations: input.multipleImplementations ?? stringSet<GoToLocationValues>(input.multipleImplementations, 'peek', ['peek', 'gotoAndPeek', 'goto']),\n\t\t\tmultipleReferences: input.multipleReferences ?? stringSet<GoToLocationValues>(input.multipleReferences, 'peek', ['peek', 'gotoAndPeek', 'goto']),\n\t\t\talternativeDefinitionCommand: EditorStringOption.string(input.alternativeDefinitionCommand, this.defaultValue.alternativeDefinitionCommand),\n\t\t\talternativeTypeDefinitionCommand: EditorStringOption.string(input.alternativeTypeDefinitionCommand, this.defaultValue.alternativeTypeDefinitionCommand),\n\t\t\talternativeDeclarationCommand: EditorStringOption.string(input.alternativeDeclarationCommand, this.defaultValue.alternativeDeclarationCommand),\n\t\t\talternativeImplementationCommand: EditorStringOption.string(input.alternativeImplementationCommand, this.defaultValue.alternativeImplementationCommand),\n\t\t\talternativeReferenceCommand: EditorStringOption.string(input.alternativeReferenceCommand, this.defaultValue.alternativeReferenceCommand),\n\t\t};\n\t}\n}\n\n//#endregion\n\n//#region hover\n\n/**\n * Configuration options for editor hover\n */\nexport interface IEditorHoverOptions {\n\t/**\n\t * Enable the hover.\n\t * Defaults to true.\n\t */\n\tenabled?: boolean;\n\t/**\n\t * Delay for showing the hover.\n\t * Defaults to 300.\n\t */\n\tdelay?: number;\n\t/**\n\t * Is the hover sticky such that it can be clicked and its contents selected?\n\t * Defaults to true.\n\t */\n\tsticky?: boolean;\n\t/**\n\t * Should the hover be shown above the line if possible?\n\t * Defaults to false.\n\t */\n\tabove?: boolean;\n}\n\n/**\n * @internal\n */\nexport type EditorHoverOptions = Readonly<Required<IEditorHoverOptions>>;\n\nclass EditorHover extends BaseEditorOption<EditorOption.hover, IEditorHoverOptions, EditorHoverOptions> {\n\n\tconstructor() {\n\t\tconst defaults: EditorHoverOptions = {\n\t\t\tenabled: true,\n\t\t\tdelay: 300,\n\t\t\tsticky: true,\n\t\t\tabove: true,\n\t\t};\n\t\tsuper(\n\t\t\tEditorOption.hover, 'hover', defaults,\n\t\t\t{\n\t\t\t\t'editor.hover.enabled': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.enabled,\n\t\t\t\t\tdescription: nls.localize('hover.enabled', \"Controls whether the hover is shown.\")\n\t\t\t\t},\n\t\t\t\t'editor.hover.delay': {\n\t\t\t\t\ttype: 'number',\n\t\t\t\t\tdefault: defaults.delay,\n\t\t\t\t\tminimum: 0,\n\t\t\t\t\tmaximum: 10000,\n\t\t\t\t\tdescription: nls.localize('hover.delay', \"Controls the delay in milliseconds after which the hover is shown.\")\n\t\t\t\t},\n\t\t\t\t'editor.hover.sticky': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.sticky,\n\t\t\t\t\tdescription: nls.localize('hover.sticky', \"Controls whether the hover should remain visible when mouse is moved over it.\")\n\t\t\t\t},\n\t\t\t\t'editor.hover.above': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.above,\n\t\t\t\t\tdescription: nls.localize('hover.above', \"Prefer showing hovers above the line, if there's space.\")\n\t\t\t\t},\n\t\t\t}\n\t\t);\n\t}\n\n\tpublic validate(_input: any): EditorHoverOptions {\n\t\tif (!_input || typeof _input !== 'object') {\n\t\t\treturn this.defaultValue;\n\t\t}\n\t\tconst input = _input as IEditorHoverOptions;\n\t\treturn {\n\t\t\tenabled: boolean(input.enabled, this.defaultValue.enabled),\n\t\t\tdelay: EditorIntOption.clampedInt(input.delay, this.defaultValue.delay, 0, 10000),\n\t\t\tsticky: boolean(input.sticky, this.defaultValue.sticky),\n\t\t\tabove: boolean(input.above, this.defaultValue.above),\n\t\t};\n\t}\n}\n\n//#endregion\n\n//#region layoutInfo\n\n/**\n * A description for the overview ruler position.\n */\nexport interface OverviewRulerPosition {\n\t/**\n\t * Width of the overview ruler\n\t */\n\treadonly width: number;\n\t/**\n\t * Height of the overview ruler\n\t */\n\treadonly height: number;\n\t/**\n\t * Top position for the overview ruler\n\t */\n\treadonly top: number;\n\t/**\n\t * Right position for the overview ruler\n\t */\n\treadonly right: number;\n}\n\nexport const enum RenderMinimap {\n\tNone = 0,\n\tText = 1,\n\tBlocks = 2,\n}\n\n/**\n * The internal layout details of the editor.\n */\nexport interface EditorLayoutInfo {\n\n\t/**\n\t * Full editor width.\n\t */\n\treadonly width: number;\n\t/**\n\t * Full editor height.\n\t */\n\treadonly height: number;\n\n\t/**\n\t * Left position for the glyph margin.\n\t */\n\treadonly glyphMarginLeft: number;\n\t/**\n\t * The width of the glyph margin.\n\t */\n\treadonly glyphMarginWidth: number;\n\n\t/**\n\t * Left position for the line numbers.\n\t */\n\treadonly lineNumbersLeft: number;\n\t/**\n\t * The width of the line numbers.\n\t */\n\treadonly lineNumbersWidth: number;\n\n\t/**\n\t * Left position for the line decorations.\n\t */\n\treadonly decorationsLeft: number;\n\t/**\n\t * The width of the line decorations.\n\t */\n\treadonly decorationsWidth: number;\n\n\t/**\n\t * Left position for the content (actual text)\n\t */\n\treadonly contentLeft: number;\n\t/**\n\t * The width of the content (actual text)\n\t */\n\treadonly contentWidth: number;\n\n\t/**\n\t * Layout information for the minimap\n\t */\n\treadonly minimap: EditorMinimapLayoutInfo;\n\n\t/**\n\t * The number of columns (of typical characters) fitting on a viewport line.\n\t */\n\treadonly viewportColumn: number;\n\n\treadonly isWordWrapMinified: boolean;\n\treadonly isViewportWrapping: boolean;\n\treadonly wrappingColumn: number;\n\n\t/**\n\t * The width of the vertical scrollbar.\n\t */\n\treadonly verticalScrollbarWidth: number;\n\t/**\n\t * The height of the horizontal scrollbar.\n\t */\n\treadonly horizontalScrollbarHeight: number;\n\n\t/**\n\t * The position of the overview ruler.\n\t */\n\treadonly overviewRuler: OverviewRulerPosition;\n}\n\n/**\n * The internal layout details of the editor.\n */\nexport interface EditorMinimapLayoutInfo {\n\treadonly renderMinimap: RenderMinimap;\n\treadonly minimapLeft: number;\n\treadonly minimapWidth: number;\n\treadonly minimapHeightIsEditorHeight: boolean;\n\treadonly minimapIsSampling: boolean;\n\treadonly minimapScale: number;\n\treadonly minimapLineHeight: number;\n\treadonly minimapCanvasInnerWidth: number;\n\treadonly minimapCanvasInnerHeight: number;\n\treadonly minimapCanvasOuterWidth: number;\n\treadonly minimapCanvasOuterHeight: number;\n}\n\n/**\n * @internal\n */\nexport interface EditorLayoutInfoComputerEnv {\n\treadonly memory: ComputeOptionsMemory | null;\n\treadonly outerWidth: number;\n\treadonly outerHeight: number;\n\treadonly isDominatedByLongLines: boolean;\n\treadonly lineHeight: number;\n\treadonly viewLineCount: number;\n\treadonly lineNumbersDigitCount: number;\n\treadonly typicalHalfwidthCharacterWidth: number;\n\treadonly maxDigitWidth: number;\n\treadonly pixelRatio: number;\n}\n\n/**\n * @internal\n */\nexport interface IEditorLayoutComputerInput {\n\treadonly outerWidth: number;\n\treadonly outerHeight: number;\n\treadonly isDominatedByLongLines: boolean;\n\treadonly lineHeight: number;\n\treadonly lineNumbersDigitCount: number;\n\treadonly typicalHalfwidthCharacterWidth: number;\n\treadonly maxDigitWidth: number;\n\treadonly pixelRatio: number;\n\treadonly glyphMargin: boolean;\n\treadonly lineDecorationsWidth: string | number;\n\treadonly folding: boolean;\n\treadonly minimap: Readonly<Required<IEditorMinimapOptions>>;\n\treadonly scrollbar: InternalEditorScrollbarOptions;\n\treadonly lineNumbers: InternalEditorRenderLineNumbersOptions;\n\treadonly lineNumbersMinChars: number;\n\treadonly scrollBeyondLastLine: boolean;\n\treadonly wordWrap: 'wordWrapColumn' | 'on' | 'off' | 'bounded';\n\treadonly wordWrapColumn: number;\n\treadonly wordWrapMinified: boolean;\n\treadonly accessibilitySupport: AccessibilitySupport;\n}\n\n/**\n * @internal\n */\nexport interface IMinimapLayoutInput {\n\treadonly outerWidth: number;\n\treadonly outerHeight: number;\n\treadonly lineHeight: number;\n\treadonly typicalHalfwidthCharacterWidth: number;\n\treadonly pixelRatio: number;\n\treadonly scrollBeyondLastLine: boolean;\n\treadonly minimap: Readonly<Required<IEditorMinimapOptions>>;\n\treadonly verticalScrollbarWidth: number;\n\treadonly viewLineCount: number;\n\treadonly remainingWidth: number;\n\treadonly isViewportWrapping: boolean;\n}\n\n/**\n * @internal\n */\nexport class EditorLayoutInfoComputer extends ComputedEditorOption<EditorOption.layoutInfo, EditorLayoutInfo> {\n\n\tconstructor() {\n\t\tsuper(EditorOption.layoutInfo);\n\t}\n\n\tpublic compute(env: IEnvironmentalOptions, options: IComputedEditorOptions, _: EditorLayoutInfo): EditorLayoutInfo {\n\t\treturn EditorLayoutInfoComputer.computeLayout(options, {\n\t\t\tmemory: env.memory,\n\t\t\touterWidth: env.outerWidth,\n\t\t\touterHeight: env.outerHeight,\n\t\t\tisDominatedByLongLines: env.isDominatedByLongLines,\n\t\t\tlineHeight: env.fontInfo.lineHeight,\n\t\t\tviewLineCount: env.viewLineCount,\n\t\t\tlineNumbersDigitCount: env.lineNumbersDigitCount,\n\t\t\ttypicalHalfwidthCharacterWidth: env.fontInfo.typicalHalfwidthCharacterWidth,\n\t\t\tmaxDigitWidth: env.fontInfo.maxDigitWidth,\n\t\t\tpixelRatio: env.pixelRatio\n\t\t});\n\t}\n\n\tpublic static computeContainedMinimapLineCount(input: {\n\t\tviewLineCount: number;\n\t\tscrollBeyondLastLine: boolean;\n\t\theight: number;\n\t\tlineHeight: number;\n\t\tpixelRatio: number;\n\t}): { typicalViewportLineCount: number; extraLinesBeyondLastLine: number; desiredRatio: number; minimapLineCount: number } {\n\t\tconst typicalViewportLineCount = input.height / input.lineHeight;\n\t\tconst extraLinesBeyondLastLine = input.scrollBeyondLastLine ? (typicalViewportLineCount - 1) : 0;\n\t\tconst desiredRatio = (input.viewLineCount + extraLinesBeyondLastLine) / (input.pixelRatio * input.height);\n\t\tconst minimapLineCount = Math.floor(input.viewLineCount / desiredRatio);\n\t\treturn { typicalViewportLineCount, extraLinesBeyondLastLine, desiredRatio, minimapLineCount };\n\t}\n\n\tprivate static _computeMinimapLayout(input: IMinimapLayoutInput, memory: ComputeOptionsMemory): EditorMinimapLayoutInfo {\n\t\tconst outerWidth = input.outerWidth;\n\t\tconst outerHeight = input.outerHeight;\n\t\tconst pixelRatio = input.pixelRatio;\n\n\t\tif (!input.minimap.enabled) {\n\t\t\treturn {\n\t\t\t\trenderMinimap: RenderMinimap.None,\n\t\t\t\tminimapLeft: 0,\n\t\t\t\tminimapWidth: 0,\n\t\t\t\tminimapHeightIsEditorHeight: false,\n\t\t\t\tminimapIsSampling: false,\n\t\t\t\tminimapScale: 1,\n\t\t\t\tminimapLineHeight: 1,\n\t\t\t\tminimapCanvasInnerWidth: 0,\n\t\t\t\tminimapCanvasInnerHeight: Math.floor(pixelRatio * outerHeight),\n\t\t\t\tminimapCanvasOuterWidth: 0,\n\t\t\t\tminimapCanvasOuterHeight: outerHeight,\n\t\t\t};\n\t\t}\n\n\t\t// Can use memory if only the `viewLineCount` and `remainingWidth` have changed\n\t\tconst stableMinimapLayoutInput = memory.stableMinimapLayoutInput;\n\t\tconst couldUseMemory = (\n\t\t\tstableMinimapLayoutInput\n\t\t\t// && input.outerWidth === lastMinimapLayoutInput.outerWidth !!! INTENTIONAL OMITTED\n\t\t\t&& input.outerHeight === stableMinimapLayoutInput.outerHeight\n\t\t\t&& input.lineHeight === stableMinimapLayoutInput.lineHeight\n\t\t\t&& input.typicalHalfwidthCharacterWidth === stableMinimapLayoutInput.typicalHalfwidthCharacterWidth\n\t\t\t&& input.pixelRatio === stableMinimapLayoutInput.pixelRatio\n\t\t\t&& input.scrollBeyondLastLine === stableMinimapLayoutInput.scrollBeyondLastLine\n\t\t\t&& input.minimap.enabled === stableMinimapLayoutInput.minimap.enabled\n\t\t\t&& input.minimap.side === stableMinimapLayoutInput.minimap.side\n\t\t\t&& input.minimap.size === stableMinimapLayoutInput.minimap.size\n\t\t\t&& input.minimap.showSlider === stableMinimapLayoutInput.minimap.showSlider\n\t\t\t&& input.minimap.renderCharacters === stableMinimapLayoutInput.minimap.renderCharacters\n\t\t\t&& input.minimap.maxColumn === stableMinimapLayoutInput.minimap.maxColumn\n\t\t\t&& input.minimap.scale === stableMinimapLayoutInput.minimap.scale\n\t\t\t&& input.verticalScrollbarWidth === stableMinimapLayoutInput.verticalScrollbarWidth\n\t\t\t// && input.viewLineCount === lastMinimapLayoutInput.viewLineCount !!! INTENTIONAL OMITTED\n\t\t\t// && input.remainingWidth === lastMinimapLayoutInput.remainingWidth !!! INTENTIONAL OMITTED\n\t\t\t&& input.isViewportWrapping === stableMinimapLayoutInput.isViewportWrapping\n\t\t);\n\n\t\tconst lineHeight = input.lineHeight;\n\t\tconst typicalHalfwidthCharacterWidth = input.typicalHalfwidthCharacterWidth;\n\t\tconst scrollBeyondLastLine = input.scrollBeyondLastLine;\n\t\tconst minimapRenderCharacters = input.minimap.renderCharacters;\n\t\tlet minimapScale = (pixelRatio >= 2 ? Math.round(input.minimap.scale * 2) : input.minimap.scale);\n\t\tconst minimapMaxColumn = input.minimap.maxColumn;\n\t\tconst minimapSize = input.minimap.size;\n\t\tconst minimapSide = input.minimap.side;\n\t\tconst verticalScrollbarWidth = input.verticalScrollbarWidth;\n\t\tconst viewLineCount = input.viewLineCount;\n\t\tconst remainingWidth = input.remainingWidth;\n\t\tconst isViewportWrapping = input.isViewportWrapping;\n\n\t\tconst baseCharHeight = minimapRenderCharacters ? 2 : 3;\n\t\tlet minimapCanvasInnerHeight = Math.floor(pixelRatio * outerHeight);\n\t\tconst minimapCanvasOuterHeight = minimapCanvasInnerHeight / pixelRatio;\n\t\tlet minimapHeightIsEditorHeight = false;\n\t\tlet minimapIsSampling = false;\n\t\tlet minimapLineHeight = baseCharHeight * minimapScale;\n\t\tlet minimapCharWidth = minimapScale / pixelRatio;\n\t\tlet minimapWidthMultiplier: number = 1;\n\n\t\tif (minimapSize === 'fill' || minimapSize === 'fit') {\n\t\t\tconst { typicalViewportLineCount, extraLinesBeyondLastLine, desiredRatio, minimapLineCount } = EditorLayoutInfoComputer.computeContainedMinimapLineCount({\n\t\t\t\tviewLineCount: viewLineCount,\n\t\t\t\tscrollBeyondLastLine: scrollBeyondLastLine,\n\t\t\t\theight: outerHeight,\n\t\t\t\tlineHeight: lineHeight,\n\t\t\t\tpixelRatio: pixelRatio\n\t\t\t});\n\t\t\t// ratio is intentionally not part of the layout to avoid the layout changing all the time\n\t\t\t// when doing sampling\n\t\t\tconst ratio = viewLineCount / minimapLineCount;\n\n\t\t\tif (ratio > 1) {\n\t\t\t\tminimapHeightIsEditorHeight = true;\n\t\t\t\tminimapIsSampling = true;\n\t\t\t\tminimapScale = 1;\n\t\t\t\tminimapLineHeight = 1;\n\t\t\t\tminimapCharWidth = minimapScale / pixelRatio;\n\t\t\t} else {\n\t\t\t\tlet fitBecomesFill = false;\n\t\t\t\tlet maxMinimapScale = minimapScale + 1;\n\n\t\t\t\tif (minimapSize === 'fit') {\n\t\t\t\t\tconst effectiveMinimapHeight = Math.ceil((viewLineCount + extraLinesBeyondLastLine) * minimapLineHeight);\n\t\t\t\t\tif (isViewportWrapping && couldUseMemory && remainingWidth <= memory.stableFitRemainingWidth) {\n\t\t\t\t\t\t// There is a loop when using `fit` and viewport wrapping:\n\t\t\t\t\t\t// - view line count impacts minimap layout\n\t\t\t\t\t\t// - minimap layout impacts viewport width\n\t\t\t\t\t\t// - viewport width impacts view line count\n\t\t\t\t\t\t// To break the loop, once we go to a smaller minimap scale, we try to stick with it.\n\t\t\t\t\t\tfitBecomesFill = true;\n\t\t\t\t\t\tmaxMinimapScale = memory.stableFitMaxMinimapScale;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfitBecomesFill = (effectiveMinimapHeight > minimapCanvasInnerHeight);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (minimapSize === 'fill' || fitBecomesFill) {\n\t\t\t\t\tminimapHeightIsEditorHeight = true;\n\t\t\t\t\tconst configuredMinimapScale = minimapScale;\n\t\t\t\t\tminimapLineHeight = Math.min(lineHeight * pixelRatio, Math.max(1, Math.floor(1 / desiredRatio)));\n\t\t\t\t\tif (isViewportWrapping && couldUseMemory && remainingWidth <= memory.stableFitRemainingWidth) {\n\t\t\t\t\t\t// There is a loop when using `fill` and viewport wrapping:\n\t\t\t\t\t\t// - view line count impacts minimap layout\n\t\t\t\t\t\t// - minimap layout impacts viewport width\n\t\t\t\t\t\t// - viewport width impacts view line count\n\t\t\t\t\t\t// To break the loop, once we go to a smaller minimap scale, we try to stick with it.\n\t\t\t\t\t\tmaxMinimapScale = memory.stableFitMaxMinimapScale;\n\t\t\t\t\t}\n\t\t\t\t\tminimapScale = Math.min(maxMinimapScale, Math.max(1, Math.floor(minimapLineHeight / baseCharHeight)));\n\t\t\t\t\tif (minimapScale > configuredMinimapScale) {\n\t\t\t\t\t\tminimapWidthMultiplier = Math.min(2, minimapScale / configuredMinimapScale);\n\t\t\t\t\t}\n\t\t\t\t\tminimapCharWidth = minimapScale / pixelRatio / minimapWidthMultiplier;\n\t\t\t\t\tminimapCanvasInnerHeight = Math.ceil((Math.max(typicalViewportLineCount, viewLineCount + extraLinesBeyondLastLine)) * minimapLineHeight);\n\t\t\t\t\tif (isViewportWrapping) {\n\t\t\t\t\t\t// remember for next time\n\t\t\t\t\t\tmemory.stableMinimapLayoutInput = input;\n\t\t\t\t\t\tmemory.stableFitRemainingWidth = remainingWidth;\n\t\t\t\t\t\tmemory.stableFitMaxMinimapScale = minimapScale;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmemory.stableMinimapLayoutInput = null;\n\t\t\t\t\t\tmemory.stableFitRemainingWidth = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Given:\n\t\t// (leaving 2px for the cursor to have space after the last character)\n\t\t// viewportColumn = (contentWidth - verticalScrollbarWidth - 2) / typicalHalfwidthCharacterWidth\n\t\t// minimapWidth = viewportColumn * minimapCharWidth\n\t\t// contentWidth = remainingWidth - minimapWidth\n\t\t// What are good values for contentWidth and minimapWidth ?\n\n\t\t// minimapWidth = ((contentWidth - verticalScrollbarWidth - 2) / typicalHalfwidthCharacterWidth) * minimapCharWidth\n\t\t// typicalHalfwidthCharacterWidth * minimapWidth = (contentWidth - verticalScrollbarWidth - 2) * minimapCharWidth\n\t\t// typicalHalfwidthCharacterWidth * minimapWidth = (remainingWidth - minimapWidth - verticalScrollbarWidth - 2) * minimapCharWidth\n\t\t// (typicalHalfwidthCharacterWidth + minimapCharWidth) * minimapWidth = (remainingWidth - verticalScrollbarWidth - 2) * minimapCharWidth\n\t\t// minimapWidth = ((remainingWidth - verticalScrollbarWidth - 2) * minimapCharWidth) / (typicalHalfwidthCharacterWidth + minimapCharWidth)\n\n\t\tconst minimapMaxWidth = Math.floor(minimapMaxColumn * minimapCharWidth);\n\t\tconst minimapWidth = Math.min(minimapMaxWidth, Math.max(0, Math.floor(((remainingWidth - verticalScrollbarWidth - 2) * minimapCharWidth) / (typicalHalfwidthCharacterWidth + minimapCharWidth))) + MINIMAP_GUTTER_WIDTH);\n\n\t\tlet minimapCanvasInnerWidth = Math.floor(pixelRatio * minimapWidth);\n\t\tconst minimapCanvasOuterWidth = minimapCanvasInnerWidth / pixelRatio;\n\t\tminimapCanvasInnerWidth = Math.floor(minimapCanvasInnerWidth * minimapWidthMultiplier);\n\n\t\tconst renderMinimap = (minimapRenderCharacters ? RenderMinimap.Text : RenderMinimap.Blocks);\n\t\tconst minimapLeft = (minimapSide === 'left' ? 0 : (outerWidth - minimapWidth - verticalScrollbarWidth));\n\n\t\treturn {\n\t\t\trenderMinimap,\n\t\t\tminimapLeft,\n\t\t\tminimapWidth,\n\t\t\tminimapHeightIsEditorHeight,\n\t\t\tminimapIsSampling,\n\t\t\tminimapScale,\n\t\t\tminimapLineHeight,\n\t\t\tminimapCanvasInnerWidth,\n\t\t\tminimapCanvasInnerHeight,\n\t\t\tminimapCanvasOuterWidth,\n\t\t\tminimapCanvasOuterHeight,\n\t\t};\n\t}\n\n\tpublic static computeLayout(options: IComputedEditorOptions, env: EditorLayoutInfoComputerEnv): EditorLayoutInfo {\n\t\tconst outerWidth = env.outerWidth | 0;\n\t\tconst outerHeight = env.outerHeight | 0;\n\t\tconst lineHeight = env.lineHeight | 0;\n\t\tconst lineNumbersDigitCount = env.lineNumbersDigitCount | 0;\n\t\tconst typicalHalfwidthCharacterWidth = env.typicalHalfwidthCharacterWidth;\n\t\tconst maxDigitWidth = env.maxDigitWidth;\n\t\tconst pixelRatio = env.pixelRatio;\n\t\tconst viewLineCount = env.viewLineCount;\n\n\t\tconst wordWrapOverride2 = options.get(EditorOption.wordWrapOverride2);\n\t\tconst wordWrapOverride1 = (wordWrapOverride2 === 'inherit' ? options.get(EditorOption.wordWrapOverride1) : wordWrapOverride2);\n\t\tconst wordWrap = (wordWrapOverride1 === 'inherit' ? options.get(EditorOption.wordWrap) : wordWrapOverride1);\n\n\t\tconst wordWrapColumn = options.get(EditorOption.wordWrapColumn);\n\t\tconst accessibilitySupport = options.get(EditorOption.accessibilitySupport);\n\t\tconst isDominatedByLongLines = env.isDominatedByLongLines;\n\n\t\tconst showGlyphMargin = options.get(EditorOption.glyphMargin);\n\t\tconst showLineNumbers = (options.get(EditorOption.lineNumbers).renderType !== RenderLineNumbersType.Off);\n\t\tconst lineNumbersMinChars = options.get(EditorOption.lineNumbersMinChars);\n\t\tconst scrollBeyondLastLine = options.get(EditorOption.scrollBeyondLastLine);\n\t\tconst minimap = options.get(EditorOption.minimap);\n\n\t\tconst scrollbar = options.get(EditorOption.scrollbar);\n\t\tconst verticalScrollbarWidth = scrollbar.verticalScrollbarSize;\n\t\tconst verticalScrollbarHasArrows = scrollbar.verticalHasArrows;\n\t\tconst scrollbarArrowSize = scrollbar.arrowSize;\n\t\tconst horizontalScrollbarHeight = scrollbar.horizontalScrollbarSize;\n\n\t\tconst rawLineDecorationsWidth = options.get(EditorOption.lineDecorationsWidth);\n\t\tconst folding = options.get(EditorOption.folding);\n\t\tconst showFoldingDecoration = options.get(EditorOption.showFoldingControls) !== 'never';\n\n\t\tlet lineDecorationsWidth: number;\n\t\tif (typeof rawLineDecorationsWidth === 'string' && /^\\d+(\\.\\d+)?ch$/.test(rawLineDecorationsWidth)) {\n\t\t\tconst multiple = parseFloat(rawLineDecorationsWidth.substr(0, rawLineDecorationsWidth.length - 2));\n\t\t\tlineDecorationsWidth = EditorIntOption.clampedInt(multiple * typicalHalfwidthCharacterWidth, 0, 0, 1000);\n\t\t} else {\n\t\t\tlineDecorationsWidth = EditorIntOption.clampedInt(rawLineDecorationsWidth, 0, 0, 1000);\n\t\t}\n\t\tif (folding && showFoldingDecoration) {\n\t\t\tlineDecorationsWidth += 16;\n\t\t}\n\n\t\tlet lineNumbersWidth = 0;\n\t\tif (showLineNumbers) {\n\t\t\tconst digitCount = Math.max(lineNumbersDigitCount, lineNumbersMinChars);\n\t\t\tlineNumbersWidth = Math.round(digitCount * maxDigitWidth);\n\t\t}\n\n\t\tlet glyphMarginWidth = 0;\n\t\tif (showGlyphMargin) {\n\t\t\tglyphMarginWidth = lineHeight;\n\t\t}\n\n\t\tlet glyphMarginLeft = 0;\n\t\tlet lineNumbersLeft = glyphMarginLeft + glyphMarginWidth;\n\t\tlet decorationsLeft = lineNumbersLeft + lineNumbersWidth;\n\t\tlet contentLeft = decorationsLeft + lineDecorationsWidth;\n\n\t\tconst remainingWidth = outerWidth - glyphMarginWidth - lineNumbersWidth - lineDecorationsWidth;\n\n\t\tlet isWordWrapMinified = false;\n\t\tlet isViewportWrapping = false;\n\t\tlet wrappingColumn = -1;\n\n\t\tif (accessibilitySupport !== AccessibilitySupport.Enabled) {\n\t\t\t// See https://github.com/microsoft/vscode/issues/27766\n\t\t\t// Never enable wrapping when a screen reader is attached\n\t\t\t// because arrow down etc. will not move the cursor in the way\n\t\t\t// a screen reader expects.\n\t\t\tif (wordWrapOverride1 === 'inherit' && isDominatedByLongLines) {\n\t\t\t\t// Force viewport width wrapping if model is dominated by long lines\n\t\t\t\tisWordWrapMinified = true;\n\t\t\t\tisViewportWrapping = true;\n\t\t\t} else if (wordWrap === 'on' || wordWrap === 'bounded') {\n\t\t\t\tisViewportWrapping = true;\n\t\t\t} else if (wordWrap === 'wordWrapColumn') {\n\t\t\t\twrappingColumn = wordWrapColumn;\n\t\t\t}\n\t\t}\n\n\t\tconst minimapLayout = EditorLayoutInfoComputer._computeMinimapLayout({\n\t\t\touterWidth: outerWidth,\n\t\t\touterHeight: outerHeight,\n\t\t\tlineHeight: lineHeight,\n\t\t\ttypicalHalfwidthCharacterWidth: typicalHalfwidthCharacterWidth,\n\t\t\tpixelRatio: pixelRatio,\n\t\t\tscrollBeyondLastLine: scrollBeyondLastLine,\n\t\t\tminimap: minimap,\n\t\t\tverticalScrollbarWidth: verticalScrollbarWidth,\n\t\t\tviewLineCount: viewLineCount,\n\t\t\tremainingWidth: remainingWidth,\n\t\t\tisViewportWrapping: isViewportWrapping,\n\t\t}, env.memory || new ComputeOptionsMemory());\n\n\t\tif (minimapLayout.renderMinimap !== RenderMinimap.None && minimapLayout.minimapLeft === 0) {\n\t\t\t// the minimap is rendered to the left, so move everything to the right\n\t\t\tglyphMarginLeft += minimapLayout.minimapWidth;\n\t\t\tlineNumbersLeft += minimapLayout.minimapWidth;\n\t\t\tdecorationsLeft += minimapLayout.minimapWidth;\n\t\t\tcontentLeft += minimapLayout.minimapWidth;\n\t\t}\n\t\tconst contentWidth = remainingWidth - minimapLayout.minimapWidth;\n\n\t\t// (leaving 2px for the cursor to have space after the last character)\n\t\tconst viewportColumn = Math.max(1, Math.floor((contentWidth - verticalScrollbarWidth - 2) / typicalHalfwidthCharacterWidth));\n\n\t\tconst verticalArrowSize = (verticalScrollbarHasArrows ? scrollbarArrowSize : 0);\n\n\t\tif (isViewportWrapping) {\n\t\t\t// compute the actual wrappingColumn\n\t\t\twrappingColumn = Math.max(1, viewportColumn);\n\t\t\tif (wordWrap === 'bounded') {\n\t\t\t\twrappingColumn = Math.min(wrappingColumn, wordWrapColumn);\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\twidth: outerWidth,\n\t\t\theight: outerHeight,\n\n\t\t\tglyphMarginLeft: glyphMarginLeft,\n\t\t\tglyphMarginWidth: glyphMarginWidth,\n\n\t\t\tlineNumbersLeft: lineNumbersLeft,\n\t\t\tlineNumbersWidth: lineNumbersWidth,\n\n\t\t\tdecorationsLeft: decorationsLeft,\n\t\t\tdecorationsWidth: lineDecorationsWidth,\n\n\t\t\tcontentLeft: contentLeft,\n\t\t\tcontentWidth: contentWidth,\n\n\t\t\tminimap: minimapLayout,\n\n\t\t\tviewportColumn: viewportColumn,\n\n\t\t\tisWordWrapMinified: isWordWrapMinified,\n\t\t\tisViewportWrapping: isViewportWrapping,\n\t\t\twrappingColumn: wrappingColumn,\n\n\t\t\tverticalScrollbarWidth: verticalScrollbarWidth,\n\t\t\thorizontalScrollbarHeight: horizontalScrollbarHeight,\n\n\t\t\toverviewRuler: {\n\t\t\t\ttop: verticalArrowSize,\n\t\t\t\twidth: verticalScrollbarWidth,\n\t\t\t\theight: (outerHeight - 2 * verticalArrowSize),\n\t\t\t\tright: 0\n\t\t\t}\n\t\t};\n\t}\n}\n\n//#endregion\n\n//#region lightbulb\n\n/**\n * Configuration options for editor lightbulb\n */\nexport interface IEditorLightbulbOptions {\n\t/**\n\t * Enable the lightbulb code action.\n\t * Defaults to true.\n\t */\n\tenabled?: boolean;\n}\n\n/**\n * @internal\n */\nexport type EditorLightbulbOptions = Readonly<Required<IEditorLightbulbOptions>>;\n\nclass EditorLightbulb extends BaseEditorOption<EditorOption.lightbulb, IEditorLightbulbOptions, EditorLightbulbOptions> {\n\n\tconstructor() {\n\t\tconst defaults: EditorLightbulbOptions = { enabled: true };\n\t\tsuper(\n\t\t\tEditorOption.lightbulb, 'lightbulb', defaults,\n\t\t\t{\n\t\t\t\t'editor.lightbulb.enabled': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.enabled,\n\t\t\t\t\tdescription: nls.localize('codeActions', \"Enables the code action lightbulb in the editor.\")\n\t\t\t\t},\n\t\t\t}\n\t\t);\n\t}\n\n\tpublic validate(_input: any): EditorLightbulbOptions {\n\t\tif (!_input || typeof _input !== 'object') {\n\t\t\treturn this.defaultValue;\n\t\t}\n\t\tconst input = _input as IEditorLightbulbOptions;\n\t\treturn {\n\t\t\tenabled: boolean(input.enabled, this.defaultValue.enabled)\n\t\t};\n\t}\n}\n\n//#endregion\n\n//#region experimental\n\nexport interface IEditorExperimentalOptions {\n\t/**\n\t * Configuration options for editor sticky scroll\n\t */\n\tstickyScroll?: {\n\t\t/**\n\t\t * Enable the sticky scroll\n\t\t */\n\t\tenabled?: boolean;\n\t};\n}\n\nexport interface EditorExperimentalOptions {\n\tstickyScroll: {\n\t\tenabled: boolean;\n\t};\n}\n\nclass EditorExperimental extends BaseEditorOption<EditorOption.experimental, IEditorExperimentalOptions, EditorExperimentalOptions> {\n\n\tconstructor() {\n\t\tconst defaults: EditorExperimentalOptions = { stickyScroll: { enabled: false } };\n\t\tsuper(\n\t\t\tEditorOption.experimental, 'experimental', defaults,\n\t\t\t{\n\t\t\t\t'editor.experimental.stickyScroll.enabled': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.stickyScroll.enabled,\n\t\t\t\t\tdescription: nls.localize('editor.experimental.stickyScroll', \"Shows the nested current scopes during the scroll at the top of the editor.\")\n\t\t\t\t},\n\t\t\t}\n\t\t);\n\t}\n\n\tpublic validate(_input: any): EditorExperimentalOptions {\n\t\tif (!_input || typeof _input !== 'object') {\n\t\t\treturn this.defaultValue;\n\t\t}\n\t\tconst input = _input as IEditorExperimentalOptions;\n\t\treturn {\n\t\t\tstickyScroll: {\n\t\t\t\tenabled: boolean(input.stickyScroll?.enabled, this.defaultValue.stickyScroll.enabled)\n\t\t\t}\n\t\t};\n\t}\n}\n\n//#endregion\n\n//#region inlayHints\n\n/**\n * Configuration options for editor inlayHints\n */\nexport interface IEditorInlayHintsOptions {\n\t/**\n\t * Enable the inline hints.\n\t * Defaults to true.\n\t */\n\tenabled?: 'on' | 'off' | 'offUnlessPressed' | 'onUnlessPressed';\n\n\t/**\n\t * Font size of inline hints.\n\t * Default to 90% of the editor font size.\n\t */\n\tfontSize?: number;\n\n\t/**\n\t * Font family of inline hints.\n\t * Defaults to editor font family.\n\t */\n\tfontFamily?: string;\n\n\t/**\n\t * Enables the padding around the inlay hint.\n\t * Defaults to false.\n\t */\n\tpadding?: boolean;\n}\n\n/**\n * @internal\n */\nexport type EditorInlayHintsOptions = Readonly<Required<IEditorInlayHintsOptions>>;\n\nclass EditorInlayHints extends BaseEditorOption<EditorOption.inlayHints, IEditorInlayHintsOptions, EditorInlayHintsOptions> {\n\n\tconstructor() {\n\t\tconst defaults: EditorInlayHintsOptions = { enabled: 'on', fontSize: 0, fontFamily: '', padding: false };\n\t\tsuper(\n\t\t\tEditorOption.inlayHints, 'inlayHints', defaults,\n\t\t\t{\n\t\t\t\t'editor.inlayHints.enabled': {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tdefault: defaults.enabled,\n\t\t\t\t\tdescription: nls.localize('inlayHints.enable', \"Enables the inlay hints in the editor.\"),\n\t\t\t\t\tenum: ['on', 'onUnlessPressed', 'offUnlessPressed', 'off'],\n\t\t\t\t\tmarkdownEnumDescriptions: [\n\t\t\t\t\t\tnls.localize('editor.inlayHints.on', \"Inlay hints are enabled\"),\n\t\t\t\t\t\tnls.localize('editor.inlayHints.onUnlessPressed', \"Inlay hints are showing by default and hide when holding `Ctrl+Alt`\"),\n\t\t\t\t\t\tnls.localize('editor.inlayHints.offUnlessPressed', \"Inlay hints are hidden by default and show when holding `Ctrl+Alt`\"),\n\t\t\t\t\t\tnls.localize('editor.inlayHints.off', \"Inlay hints are disabled\"),\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t'editor.inlayHints.fontSize': {\n\t\t\t\t\ttype: 'number',\n\t\t\t\t\tdefault: defaults.fontSize,\n\t\t\t\t\tmarkdownDescription: nls.localize('inlayHints.fontSize', \"Controls font size of inlay hints in the editor. As default the {0} is used when the configured value is less than {1} or greater than the editor font size.\", '`#editor.fontSize#`', '`5`')\n\t\t\t\t},\n\t\t\t\t'editor.inlayHints.fontFamily': {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tdefault: defaults.fontFamily,\n\t\t\t\t\tmarkdownDescription: nls.localize('inlayHints.fontFamily', \"Controls font family of inlay hints in the editor. When set to empty, the {0} is used.\", '`#editor.fontFamily#`')\n\t\t\t\t},\n\t\t\t\t'editor.inlayHints.padding': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.padding,\n\t\t\t\t\tdescription: nls.localize('inlayHints.padding', \"Enables the padding around the inlay hints in the editor.\")\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tpublic validate(_input: any): EditorInlayHintsOptions {\n\t\tif (!_input || typeof _input !== 'object') {\n\t\t\treturn this.defaultValue;\n\t\t}\n\t\tconst input = _input as IEditorInlayHintsOptions;\n\t\tif (typeof input.enabled === 'boolean') {\n\t\t\tinput.enabled = input.enabled ? 'on' : 'off';\n\t\t}\n\t\treturn {\n\t\t\tenabled: stringSet<'on' | 'off' | 'offUnlessPressed' | 'onUnlessPressed'>(input.enabled, this.defaultValue.enabled, ['on', 'off', 'offUnlessPressed', 'onUnlessPressed']),\n\t\t\tfontSize: EditorIntOption.clampedInt(input.fontSize, this.defaultValue.fontSize, 0, 100),\n\t\t\tfontFamily: EditorStringOption.string(input.fontFamily, this.defaultValue.fontFamily),\n\t\t\tpadding: boolean(input.padding, this.defaultValue.padding)\n\t\t};\n\t}\n}\n\n//#endregion\n\n//#region lineHeight\n\nclass EditorLineHeight extends EditorFloatOption<EditorOption.lineHeight> {\n\n\tconstructor() {\n\t\tsuper(\n\t\t\tEditorOption.lineHeight, 'lineHeight',\n\t\t\tEDITOR_FONT_DEFAULTS.lineHeight,\n\t\t\tx => EditorFloatOption.clamp(x, 0, 150),\n\t\t\t{ markdownDescription: nls.localize('lineHeight', \"Controls the line height. \\n - Use 0 to automatically compute the line height from the font size.\\n - Values between 0 and 8 will be used as a multiplier with the font size.\\n - Values greater than or equal to 8 will be used as effective values.\") }\n\t\t);\n\t}\n\n\tpublic override compute(env: IEnvironmentalOptions, options: IComputedEditorOptions, value: number): number {\n\t\t// The lineHeight is computed from the fontSize if it is 0.\n\t\t// Moreover, the final lineHeight respects the editor zoom level.\n\t\t// So take the result from env.fontInfo\n\t\treturn env.fontInfo.lineHeight;\n\t}\n}\n\n//#endregion\n\n//#region minimap\n\n/**\n * Configuration options for editor minimap\n */\nexport interface IEditorMinimapOptions {\n\t/**\n\t * Enable the rendering of the minimap.\n\t * Defaults to true.\n\t */\n\tenabled?: boolean;\n\t/**\n\t * Control the rendering of minimap.\n\t */\n\tautohide?: boolean;\n\t/**\n\t * Control the side of the minimap in editor.\n\t * Defaults to 'right'.\n\t */\n\tside?: 'right' | 'left';\n\t/**\n\t * Control the minimap rendering mode.\n\t * Defaults to 'actual'.\n\t */\n\tsize?: 'proportional' | 'fill' | 'fit';\n\t/**\n\t * Control the rendering of the minimap slider.\n\t * Defaults to 'mouseover'.\n\t */\n\tshowSlider?: 'always' | 'mouseover';\n\t/**\n\t * Render the actual text on a line (as opposed to color blocks).\n\t * Defaults to true.\n\t */\n\trenderCharacters?: boolean;\n\t/**\n\t * Limit the width of the minimap to render at most a certain number of columns.\n\t * Defaults to 120.\n\t */\n\tmaxColumn?: number;\n\t/**\n\t * Relative size of the font in the minimap. Defaults to 1.\n\t */\n\tscale?: number;\n}\n\n/**\n * @internal\n */\nexport type EditorMinimapOptions = Readonly<Required<IEditorMinimapOptions>>;\n\nclass EditorMinimap extends BaseEditorOption<EditorOption.minimap, IEditorMinimapOptions, EditorMinimapOptions> {\n\n\tconstructor() {\n\t\tconst defaults: EditorMinimapOptions = {\n\t\t\tenabled: true,\n\t\t\tsize: 'proportional',\n\t\t\tside: 'right',\n\t\t\tshowSlider: 'mouseover',\n\t\t\tautohide: false,\n\t\t\trenderCharacters: true,\n\t\t\tmaxColumn: 120,\n\t\t\tscale: 1,\n\t\t};\n\t\tsuper(\n\t\t\tEditorOption.minimap, 'minimap', defaults,\n\t\t\t{\n\t\t\t\t'editor.minimap.enabled': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.enabled,\n\t\t\t\t\tdescription: nls.localize('minimap.enabled', \"Controls whether the minimap is shown.\")\n\t\t\t\t},\n\t\t\t\t'editor.minimap.autohide': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.autohide,\n\t\t\t\t\tdescription: nls.localize('minimap.autohide', \"Controls whether the minimap is hidden automatically.\")\n\t\t\t\t},\n\t\t\t\t'editor.minimap.size': {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tenum: ['proportional', 'fill', 'fit'],\n\t\t\t\t\tenumDescriptions: [\n\t\t\t\t\t\tnls.localize('minimap.size.proportional', \"The minimap has the same size as the editor contents (and might scroll).\"),\n\t\t\t\t\t\tnls.localize('minimap.size.fill', \"The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling).\"),\n\t\t\t\t\t\tnls.localize('minimap.size.fit', \"The minimap will shrink as necessary to never be larger than the editor (no scrolling).\"),\n\t\t\t\t\t],\n\t\t\t\t\tdefault: defaults.size,\n\t\t\t\t\tdescription: nls.localize('minimap.size', \"Controls the size of the minimap.\")\n\t\t\t\t},\n\t\t\t\t'editor.minimap.side': {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tenum: ['left', 'right'],\n\t\t\t\t\tdefault: defaults.side,\n\t\t\t\t\tdescription: nls.localize('minimap.side', \"Controls the side where to render the minimap.\")\n\t\t\t\t},\n\t\t\t\t'editor.minimap.showSlider': {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tenum: ['always', 'mouseover'],\n\t\t\t\t\tdefault: defaults.showSlider,\n\t\t\t\t\tdescription: nls.localize('minimap.showSlider', \"Controls when the minimap slider is shown.\")\n\t\t\t\t},\n\t\t\t\t'editor.minimap.scale': {\n\t\t\t\t\ttype: 'number',\n\t\t\t\t\tdefault: defaults.scale,\n\t\t\t\t\tminimum: 1,\n\t\t\t\t\tmaximum: 3,\n\t\t\t\t\tenum: [1, 2, 3],\n\t\t\t\t\tdescription: nls.localize('minimap.scale', \"Scale of content drawn in the minimap: 1, 2 or 3.\")\n\t\t\t\t},\n\t\t\t\t'editor.minimap.renderCharacters': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.renderCharacters,\n\t\t\t\t\tdescription: nls.localize('minimap.renderCharacters', \"Render the actual characters on a line as opposed to color blocks.\")\n\t\t\t\t},\n\t\t\t\t'editor.minimap.maxColumn': {\n\t\t\t\t\ttype: 'number',\n\t\t\t\t\tdefault: defaults.maxColumn,\n\t\t\t\t\tdescription: nls.localize('minimap.maxColumn', \"Limit the width of the minimap to render at most a certain number of columns.\")\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tpublic validate(_input: any): EditorMinimapOptions {\n\t\tif (!_input || typeof _input !== 'object') {\n\t\t\treturn this.defaultValue;\n\t\t}\n\t\tconst input = _input as IEditorMinimapOptions;\n\t\treturn {\n\t\t\tenabled: boolean(input.enabled, this.defaultValue.enabled),\n\t\t\tautohide: boolean(input.autohide, this.defaultValue.autohide),\n\t\t\tsize: stringSet<'proportional' | 'fill' | 'fit'>(input.size, this.defaultValue.size, ['proportional', 'fill', 'fit']),\n\t\t\tside: stringSet<'right' | 'left'>(input.side, this.defaultValue.side, ['right', 'left']),\n\t\t\tshowSlider: stringSet<'always' | 'mouseover'>(input.showSlider, this.defaultValue.showSlider, ['always', 'mouseover']),\n\t\t\trenderCharacters: boolean(input.renderCharacters, this.defaultValue.renderCharacters),\n\t\t\tscale: EditorIntOption.clampedInt(input.scale, 1, 1, 3),\n\t\t\tmaxColumn: EditorIntOption.clampedInt(input.maxColumn, this.defaultValue.maxColumn, 1, 10000),\n\t\t};\n\t}\n}\n\n//#endregion\n\n//#region multiCursorModifier\n\nfunction _multiCursorModifierFromString(multiCursorModifier: 'ctrlCmd' | 'alt'): 'altKey' | 'metaKey' | 'ctrlKey' {\n\tif (multiCursorModifier === 'ctrlCmd') {\n\t\treturn (platform.isMacintosh ? 'metaKey' : 'ctrlKey');\n\t}\n\treturn 'altKey';\n}\n\n//#endregion\n\n//#region padding\n\n/**\n * Configuration options for editor padding\n */\nexport interface IEditorPaddingOptions {\n\t/**\n\t * Spacing between top edge of editor and first line.\n\t */\n\ttop?: number;\n\t/**\n\t * Spacing between bottom edge of editor and last line.\n\t */\n\tbottom?: number;\n}\n\n/**\n * @internal\n */\nexport type InternalEditorPaddingOptions = Readonly<Required<IEditorPaddingOptions>>;\n\nclass EditorPadding extends BaseEditorOption<EditorOption.padding, IEditorPaddingOptions, InternalEditorPaddingOptions> {\n\n\tconstructor() {\n\t\tsuper(\n\t\t\tEditorOption.padding, 'padding', { top: 0, bottom: 0 },\n\t\t\t{\n\t\t\t\t'editor.padding.top': {\n\t\t\t\t\ttype: 'number',\n\t\t\t\t\tdefault: 0,\n\t\t\t\t\tminimum: 0,\n\t\t\t\t\tmaximum: 1000,\n\t\t\t\t\tdescription: nls.localize('padding.top', \"Controls the amount of space between the top edge of the editor and the first line.\")\n\t\t\t\t},\n\t\t\t\t'editor.padding.bottom': {\n\t\t\t\t\ttype: 'number',\n\t\t\t\t\tdefault: 0,\n\t\t\t\t\tminimum: 0,\n\t\t\t\t\tmaximum: 1000,\n\t\t\t\t\tdescription: nls.localize('padding.bottom', \"Controls the amount of space between the bottom edge of the editor and the last line.\")\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tpublic validate(_input: any): InternalEditorPaddingOptions {\n\t\tif (!_input || typeof _input !== 'object') {\n\t\t\treturn this.defaultValue;\n\t\t}\n\t\tconst input = _input as IEditorPaddingOptions;\n\n\t\treturn {\n\t\t\ttop: EditorIntOption.clampedInt(input.top, 0, 0, 1000),\n\t\t\tbottom: EditorIntOption.clampedInt(input.bottom, 0, 0, 1000)\n\t\t};\n\t}\n}\n//#endregion\n\n//#region parameterHints\n\n/**\n * Configuration options for parameter hints\n */\nexport interface IEditorParameterHintOptions {\n\t/**\n\t * Enable parameter hints.\n\t * Defaults to true.\n\t */\n\tenabled?: boolean;\n\t/**\n\t * Enable cycling of parameter hints.\n\t * Defaults to false.\n\t */\n\tcycle?: boolean;\n}\n\n/**\n * @internal\n */\nexport type InternalParameterHintOptions = Readonly<Required<IEditorParameterHintOptions>>;\n\nclass EditorParameterHints extends BaseEditorOption<EditorOption.parameterHints, IEditorParameterHintOptions, InternalParameterHintOptions> {\n\n\tconstructor() {\n\t\tconst defaults: InternalParameterHintOptions = {\n\t\t\tenabled: true,\n\t\t\tcycle: false\n\t\t};\n\t\tsuper(\n\t\t\tEditorOption.parameterHints, 'parameterHints', defaults,\n\t\t\t{\n\t\t\t\t'editor.parameterHints.enabled': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.enabled,\n\t\t\t\t\tdescription: nls.localize('parameterHints.enabled', \"Enables a pop-up that shows parameter documentation and type information as you type.\")\n\t\t\t\t},\n\t\t\t\t'editor.parameterHints.cycle': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.cycle,\n\t\t\t\t\tdescription: nls.localize('parameterHints.cycle', \"Controls whether the parameter hints menu cycles or closes when reaching the end of the list.\")\n\t\t\t\t},\n\t\t\t}\n\t\t);\n\t}\n\n\tpublic validate(_input: any): InternalParameterHintOptions {\n\t\tif (!_input || typeof _input !== 'object') {\n\t\t\treturn this.defaultValue;\n\t\t}\n\t\tconst input = _input as IEditorParameterHintOptions;\n\t\treturn {\n\t\t\tenabled: boolean(input.enabled, this.defaultValue.enabled),\n\t\t\tcycle: boolean(input.cycle, this.defaultValue.cycle)\n\t\t};\n\t}\n}\n\n//#endregion\n\n//#region pixelRatio\n\nclass EditorPixelRatio extends ComputedEditorOption<EditorOption.pixelRatio, number> {\n\n\tconstructor() {\n\t\tsuper(EditorOption.pixelRatio);\n\t}\n\n\tpublic compute(env: IEnvironmentalOptions, options: IComputedEditorOptions, _: number): number {\n\t\treturn env.pixelRatio;\n\t}\n}\n\n//#endregion\n\n//#region quickSuggestions\n\nexport type QuickSuggestionsValue = 'on' | 'inline' | 'off';\n\n/**\n * Configuration options for quick suggestions\n */\nexport interface IQuickSuggestionsOptions {\n\tother?: boolean | QuickSuggestionsValue;\n\tcomments?: boolean | QuickSuggestionsValue;\n\tstrings?: boolean | QuickSuggestionsValue;\n}\n\nexport interface InternalQuickSuggestionsOptions {\n\treadonly other: QuickSuggestionsValue;\n\treadonly comments: QuickSuggestionsValue;\n\treadonly strings: QuickSuggestionsValue;\n}\n\nclass EditorQuickSuggestions extends BaseEditorOption<EditorOption.quickSuggestions, boolean | IQuickSuggestionsOptions, InternalQuickSuggestionsOptions> {\n\n\tpublic override readonly defaultValue: InternalQuickSuggestionsOptions;\n\n\tconstructor() {\n\t\tconst defaults: InternalQuickSuggestionsOptions = {\n\t\t\tother: 'on',\n\t\t\tcomments: 'off',\n\t\t\tstrings: 'off'\n\t\t};\n\t\tconst types: IJSONSchema[] = [\n\t\t\t{ type: 'boolean' },\n\t\t\t{\n\t\t\t\ttype: 'string',\n\t\t\t\tenum: ['on', 'inline', 'off'],\n\t\t\t\tenumDescriptions: [nls.localize('on', \"Quick suggestions show inside the suggest widget\"), nls.localize('inline', \"Quick suggestions show as ghost text\"), nls.localize('off', \"Quick suggestions are disabled\")]\n\t\t\t}\n\t\t];\n\t\tsuper(EditorOption.quickSuggestions, 'quickSuggestions', defaults, {\n\t\t\ttype: 'object',\n\t\t\tadditionalProperties: false,\n\t\t\tproperties: {\n\t\t\t\tstrings: {\n\t\t\t\t\tanyOf: types,\n\t\t\t\t\tdefault: defaults.strings,\n\t\t\t\t\tdescription: nls.localize('quickSuggestions.strings', \"Enable quick suggestions inside strings.\")\n\t\t\t\t},\n\t\t\t\tcomments: {\n\t\t\t\t\tanyOf: types,\n\t\t\t\t\tdefault: defaults.comments,\n\t\t\t\t\tdescription: nls.localize('quickSuggestions.comments', \"Enable quick suggestions inside comments.\")\n\t\t\t\t},\n\t\t\t\tother: {\n\t\t\t\t\tanyOf: types,\n\t\t\t\t\tdefault: defaults.other,\n\t\t\t\t\tdescription: nls.localize('quickSuggestions.other', \"Enable quick suggestions outside of strings and comments.\")\n\t\t\t\t},\n\t\t\t},\n\t\t\tdefault: defaults,\n\t\t\tmarkdownDescription: nls.localize('quickSuggestions', \"Controls whether suggestions should automatically show up while typing. This can be controlled for typing in comments, strings, and other code. Quick suggestion can be configured to show as ghost text or with the suggest widget. Also be aware of the '{0}'-setting which controls if suggestions are triggered by special characters.\", `#editor.suggestOnTriggerCharacters#`)\n\t\t});\n\t\tthis.defaultValue = defaults;\n\t}\n\n\tpublic validate(input: any): InternalQuickSuggestionsOptions {\n\t\tif (typeof input === 'boolean') {\n\t\t\t// boolean -> all on/off\n\t\t\tconst value = input ? 'on' : 'off';\n\t\t\treturn { comments: value, strings: value, other: value };\n\t\t}\n\t\tif (!input || typeof input !== 'object') {\n\t\t\t// invalid object\n\t\t\treturn this.defaultValue;\n\t\t}\n\n\t\tconst { other, comments, strings } = (<IQuickSuggestionsOptions>input);\n\t\tconst allowedValues: QuickSuggestionsValue[] = ['on', 'inline', 'off'];\n\t\tlet validatedOther: QuickSuggestionsValue;\n\t\tlet validatedComments: QuickSuggestionsValue;\n\t\tlet validatedStrings: QuickSuggestionsValue;\n\n\t\tif (typeof other === 'boolean') {\n\t\t\tvalidatedOther = other ? 'on' : 'off';\n\t\t} else {\n\t\t\tvalidatedOther = stringSet(other, this.defaultValue.other, allowedValues);\n\t\t}\n\t\tif (typeof comments === 'boolean') {\n\t\t\tvalidatedComments = comments ? 'on' : 'off';\n\t\t} else {\n\t\t\tvalidatedComments = stringSet(comments, this.defaultValue.comments, allowedValues);\n\t\t}\n\t\tif (typeof strings === 'boolean') {\n\t\t\tvalidatedStrings = strings ? 'on' : 'off';\n\t\t} else {\n\t\t\tvalidatedStrings = stringSet(strings, this.defaultValue.strings, allowedValues);\n\t\t}\n\t\treturn {\n\t\t\tother: validatedOther,\n\t\t\tcomments: validatedComments,\n\t\t\tstrings: validatedStrings\n\t\t};\n\t}\n}\n\n//#endregion\n\n//#region renderLineNumbers\n\nexport type LineNumbersType = 'on' | 'off' | 'relative' | 'interval' | ((lineNumber: number) => string);\n\nexport const enum RenderLineNumbersType {\n\tOff = 0,\n\tOn = 1,\n\tRelative = 2,\n\tInterval = 3,\n\tCustom = 4\n}\n\nexport interface InternalEditorRenderLineNumbersOptions {\n\treadonly renderType: RenderLineNumbersType;\n\treadonly renderFn: ((lineNumber: number) => string) | null;\n}\n\nclass EditorRenderLineNumbersOption extends BaseEditorOption<EditorOption.lineNumbers, LineNumbersType, InternalEditorRenderLineNumbersOptions> {\n\n\tconstructor() {\n\t\tsuper(\n\t\t\tEditorOption.lineNumbers, 'lineNumbers', { renderType: RenderLineNumbersType.On, renderFn: null },\n\t\t\t{\n\t\t\t\ttype: 'string',\n\t\t\t\tenum: ['off', 'on', 'relative', 'interval'],\n\t\t\t\tenumDescriptions: [\n\t\t\t\t\tnls.localize('lineNumbers.off', \"Line numbers are not rendered.\"),\n\t\t\t\t\tnls.localize('lineNumbers.on', \"Line numbers are rendered as absolute number.\"),\n\t\t\t\t\tnls.localize('lineNumbers.relative', \"Line numbers are rendered as distance in lines to cursor position.\"),\n\t\t\t\t\tnls.localize('lineNumbers.interval', \"Line numbers are rendered every 10 lines.\")\n\t\t\t\t],\n\t\t\t\tdefault: 'on',\n\t\t\t\tdescription: nls.localize('lineNumbers', \"Controls the display of line numbers.\")\n\t\t\t}\n\t\t);\n\t}\n\n\tpublic validate(lineNumbers: any): InternalEditorRenderLineNumbersOptions {\n\t\tlet renderType: RenderLineNumbersType = this.defaultValue.renderType;\n\t\tlet renderFn: ((lineNumber: number) => string) | null = this.defaultValue.renderFn;\n\n\t\tif (typeof lineNumbers !== 'undefined') {\n\t\t\tif (typeof lineNumbers === 'function') {\n\t\t\t\trenderType = RenderLineNumbersType.Custom;\n\t\t\t\trenderFn = lineNumbers;\n\t\t\t} else if (lineNumbers === 'interval') {\n\t\t\t\trenderType = RenderLineNumbersType.Interval;\n\t\t\t} else if (lineNumbers === 'relative') {\n\t\t\t\trenderType = RenderLineNumbersType.Relative;\n\t\t\t} else if (lineNumbers === 'on') {\n\t\t\t\trenderType = RenderLineNumbersType.On;\n\t\t\t} else {\n\t\t\t\trenderType = RenderLineNumbersType.Off;\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\trenderType,\n\t\t\trenderFn\n\t\t};\n\t}\n}\n\n//#endregion\n\n//#region renderValidationDecorations\n\n/**\n * @internal\n */\nexport function filterValidationDecorations(options: IComputedEditorOptions): boolean {\n\tconst renderValidationDecorations = options.get(EditorOption.renderValidationDecorations);\n\tif (renderValidationDecorations === 'editable') {\n\t\treturn options.get(EditorOption.readOnly);\n\t}\n\treturn renderValidationDecorations === 'on' ? false : true;\n}\n\n//#endregion\n\n//#region rulers\n\nexport interface IRulerOption {\n\treadonly column: number;\n\treadonly color: string | null;\n}\n\nclass EditorRulers extends BaseEditorOption<EditorOption.rulers, (number | IRulerOption)[], IRulerOption[]> {\n\n\tconstructor() {\n\t\tconst defaults: IRulerOption[] = [];\n\t\tconst columnSchema: IJSONSchema = { type: 'number', description: nls.localize('rulers.size', \"Number of monospace characters at which this editor ruler will render.\") };\n\t\tsuper(\n\t\t\tEditorOption.rulers, 'rulers', defaults,\n\t\t\t{\n\t\t\t\ttype: 'array',\n\t\t\t\titems: {\n\t\t\t\t\tanyOf: [\n\t\t\t\t\t\tcolumnSchema,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: [\n\t\t\t\t\t\t\t\t'object'\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\tcolumn: columnSchema,\n\t\t\t\t\t\t\t\tcolor: {\n\t\t\t\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\t\t\t\tdescription: nls.localize('rulers.color', \"Color of this editor ruler.\"),\n\t\t\t\t\t\t\t\t\tformat: 'color-hex'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\tdefault: defaults,\n\t\t\t\tdescription: nls.localize('rulers', \"Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.\")\n\t\t\t}\n\t\t);\n\t}\n\n\tpublic validate(input: any): IRulerOption[] {\n\t\tif (Array.isArray(input)) {\n\t\t\tconst rulers: IRulerOption[] = [];\n\t\t\tfor (const _element of input) {\n\t\t\t\tif (typeof _element === 'number') {\n\t\t\t\t\trulers.push({\n\t\t\t\t\t\tcolumn: EditorIntOption.clampedInt(_element, 0, 0, 10000),\n\t\t\t\t\t\tcolor: null\n\t\t\t\t\t});\n\t\t\t\t} else if (_element && typeof _element === 'object') {\n\t\t\t\t\tconst element = _element as IRulerOption;\n\t\t\t\t\trulers.push({\n\t\t\t\t\t\tcolumn: EditorIntOption.clampedInt(element.column, 0, 0, 10000),\n\t\t\t\t\t\tcolor: element.color\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\trulers.sort((a, b) => a.column - b.column);\n\t\t\treturn rulers;\n\t\t}\n\t\treturn this.defaultValue;\n\t}\n}\n\n//#endregion\n\n//#region scrollbar\n\n/**\n * Configuration options for editor scrollbars\n */\nexport interface IEditorScrollbarOptions {\n\t/**\n\t * The size of arrows (if displayed).\n\t * Defaults to 11.\n\t * **NOTE**: This option cannot be updated using `updateOptions()`\n\t */\n\tarrowSize?: number;\n\t/**\n\t * Render vertical scrollbar.\n\t * Defaults to 'auto'.\n\t */\n\tvertical?: 'auto' | 'visible' | 'hidden';\n\t/**\n\t * Render horizontal scrollbar.\n\t * Defaults to 'auto'.\n\t */\n\thorizontal?: 'auto' | 'visible' | 'hidden';\n\t/**\n\t * Cast horizontal and vertical shadows when the content is scrolled.\n\t * Defaults to true.\n\t * **NOTE**: This option cannot be updated using `updateOptions()`\n\t */\n\tuseShadows?: boolean;\n\t/**\n\t * Render arrows at the top and bottom of the vertical scrollbar.\n\t * Defaults to false.\n\t * **NOTE**: This option cannot be updated using `updateOptions()`\n\t */\n\tverticalHasArrows?: boolean;\n\t/**\n\t * Render arrows at the left and right of the horizontal scrollbar.\n\t * Defaults to false.\n\t * **NOTE**: This option cannot be updated using `updateOptions()`\n\t */\n\thorizontalHasArrows?: boolean;\n\t/**\n\t * Listen to mouse wheel events and react to them by scrolling.\n\t * Defaults to true.\n\t */\n\thandleMouseWheel?: boolean;\n\t/**\n\t * Always consume mouse wheel events (always call preventDefault() and stopPropagation() on the browser events).\n\t * Defaults to true.\n\t * **NOTE**: This option cannot be updated using `updateOptions()`\n\t */\n\talwaysConsumeMouseWheel?: boolean;\n\t/**\n\t * Height in pixels for the horizontal scrollbar.\n\t * Defaults to 10 (px).\n\t */\n\thorizontalScrollbarSize?: number;\n\t/**\n\t * Width in pixels for the vertical scrollbar.\n\t * Defaults to 10 (px).\n\t */\n\tverticalScrollbarSize?: number;\n\t/**\n\t * Width in pixels for the vertical slider.\n\t * Defaults to `verticalScrollbarSize`.\n\t * **NOTE**: This option cannot be updated using `updateOptions()`\n\t */\n\tverticalSliderSize?: number;\n\t/**\n\t * Height in pixels for the horizontal slider.\n\t * Defaults to `horizontalScrollbarSize`.\n\t * **NOTE**: This option cannot be updated using `updateOptions()`\n\t */\n\thorizontalSliderSize?: number;\n\t/**\n\t * Scroll gutter clicks move by page vs jump to position.\n\t * Defaults to false.\n\t */\n\tscrollByPage?: boolean;\n}\n\nexport interface InternalEditorScrollbarOptions {\n\treadonly arrowSize: number;\n\treadonly vertical: ScrollbarVisibility;\n\treadonly horizontal: ScrollbarVisibility;\n\treadonly useShadows: boolean;\n\treadonly verticalHasArrows: boolean;\n\treadonly horizontalHasArrows: boolean;\n\treadonly handleMouseWheel: boolean;\n\treadonly alwaysConsumeMouseWheel: boolean;\n\treadonly horizontalScrollbarSize: number;\n\treadonly horizontalSliderSize: number;\n\treadonly verticalScrollbarSize: number;\n\treadonly verticalSliderSize: number;\n\treadonly scrollByPage: boolean;\n}\n\nfunction _scrollbarVisibilityFromString(visibility: string | undefined, defaultValue: ScrollbarVisibility): ScrollbarVisibility {\n\tif (typeof visibility !== 'string') {\n\t\treturn defaultValue;\n\t}\n\tswitch (visibility) {\n\t\tcase 'hidden': return ScrollbarVisibility.Hidden;\n\t\tcase 'visible': return ScrollbarVisibility.Visible;\n\t\tdefault: return ScrollbarVisibility.Auto;\n\t}\n}\n\nclass EditorScrollbar extends BaseEditorOption<EditorOption.scrollbar, IEditorScrollbarOptions, InternalEditorScrollbarOptions> {\n\n\tconstructor() {\n\t\tconst defaults: InternalEditorScrollbarOptions = {\n\t\t\tvertical: ScrollbarVisibility.Auto,\n\t\t\thorizontal: ScrollbarVisibility.Auto,\n\t\t\tarrowSize: 11,\n\t\t\tuseShadows: true,\n\t\t\tverticalHasArrows: false,\n\t\t\thorizontalHasArrows: false,\n\t\t\thorizontalScrollbarSize: 12,\n\t\t\thorizontalSliderSize: 12,\n\t\t\tverticalScrollbarSize: 14,\n\t\t\tverticalSliderSize: 14,\n\t\t\thandleMouseWheel: true,\n\t\t\talwaysConsumeMouseWheel: true,\n\t\t\tscrollByPage: false\n\t\t};\n\t\tsuper(\n\t\t\tEditorOption.scrollbar, 'scrollbar', defaults,\n\t\t\t{\n\t\t\t\t'editor.scrollbar.vertical': {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tenum: ['auto', 'visible', 'hidden'],\n\t\t\t\t\tenumDescriptions: [\n\t\t\t\t\t\tnls.localize('scrollbar.vertical.auto', \"The vertical scrollbar will be visible only when necessary.\"),\n\t\t\t\t\t\tnls.localize('scrollbar.vertical.visible', \"The vertical scrollbar will always be visible.\"),\n\t\t\t\t\t\tnls.localize('scrollbar.vertical.fit', \"The vertical scrollbar will always be hidden.\"),\n\t\t\t\t\t],\n\t\t\t\t\tdefault: 'auto',\n\t\t\t\t\tdescription: nls.localize('scrollbar.vertical', \"Controls the visibility of the vertical scrollbar.\")\n\t\t\t\t},\n\t\t\t\t'editor.scrollbar.horizontal': {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tenum: ['auto', 'visible', 'hidden'],\n\t\t\t\t\tenumDescriptions: [\n\t\t\t\t\t\tnls.localize('scrollbar.horizontal.auto', \"The horizontal scrollbar will be visible only when necessary.\"),\n\t\t\t\t\t\tnls.localize('scrollbar.horizontal.visible', \"The horizontal scrollbar will always be visible.\"),\n\t\t\t\t\t\tnls.localize('scrollbar.horizontal.fit', \"The horizontal scrollbar will always be hidden.\"),\n\t\t\t\t\t],\n\t\t\t\t\tdefault: 'auto',\n\t\t\t\t\tdescription: nls.localize('scrollbar.horizontal', \"Controls the visibility of the horizontal scrollbar.\")\n\t\t\t\t},\n\t\t\t\t'editor.scrollbar.verticalScrollbarSize': {\n\t\t\t\t\ttype: 'number',\n\t\t\t\t\tdefault: defaults.verticalScrollbarSize,\n\t\t\t\t\tdescription: nls.localize('scrollbar.verticalScrollbarSize', \"The width of the vertical scrollbar.\")\n\t\t\t\t},\n\t\t\t\t'editor.scrollbar.horizontalScrollbarSize': {\n\t\t\t\t\ttype: 'number',\n\t\t\t\t\tdefault: defaults.horizontalScrollbarSize,\n\t\t\t\t\tdescription: nls.localize('scrollbar.horizontalScrollbarSize', \"The height of the horizontal scrollbar.\")\n\t\t\t\t},\n\t\t\t\t'editor.scrollbar.scrollByPage': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.scrollByPage,\n\t\t\t\t\tdescription: nls.localize('scrollbar.scrollByPage', \"Controls whether clicks scroll by page or jump to click position.\")\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tpublic validate(_input: any): InternalEditorScrollbarOptions {\n\t\tif (!_input || typeof _input !== 'object') {\n\t\t\treturn this.defaultValue;\n\t\t}\n\t\tconst input = _input as IEditorScrollbarOptions;\n\t\tconst horizontalScrollbarSize = EditorIntOption.clampedInt(input.horizontalScrollbarSize, this.defaultValue.horizontalScrollbarSize, 0, 1000);\n\t\tconst verticalScrollbarSize = EditorIntOption.clampedInt(input.verticalScrollbarSize, this.defaultValue.verticalScrollbarSize, 0, 1000);\n\t\treturn {\n\t\t\tarrowSize: EditorIntOption.clampedInt(input.arrowSize, this.defaultValue.arrowSize, 0, 1000),\n\t\t\tvertical: _scrollbarVisibilityFromString(input.vertical, this.defaultValue.vertical),\n\t\t\thorizontal: _scrollbarVisibilityFromString(input.horizontal, this.defaultValue.horizontal),\n\t\t\tuseShadows: boolean(input.useShadows, this.defaultValue.useShadows),\n\t\t\tverticalHasArrows: boolean(input.verticalHasArrows, this.defaultValue.verticalHasArrows),\n\t\t\thorizontalHasArrows: boolean(input.horizontalHasArrows, this.defaultValue.horizontalHasArrows),\n\t\t\thandleMouseWheel: boolean(input.handleMouseWheel, this.defaultValue.handleMouseWheel),\n\t\t\talwaysConsumeMouseWheel: boolean(input.alwaysConsumeMouseWheel, this.defaultValue.alwaysConsumeMouseWheel),\n\t\t\thorizontalScrollbarSize: horizontalScrollbarSize,\n\t\t\thorizontalSliderSize: EditorIntOption.clampedInt(input.horizontalSliderSize, horizontalScrollbarSize, 0, 1000),\n\t\t\tverticalScrollbarSize: verticalScrollbarSize,\n\t\t\tverticalSliderSize: EditorIntOption.clampedInt(input.verticalSliderSize, verticalScrollbarSize, 0, 1000),\n\t\t\tscrollByPage: boolean(input.scrollByPage, this.defaultValue.scrollByPage),\n\t\t};\n\t}\n}\n\n//#endregion\n\n//#region UnicodeHighlight\n\nexport type InUntrustedWorkspace = 'inUntrustedWorkspace';\n\n/**\n * @internal\n*/\nexport const inUntrustedWorkspace: InUntrustedWorkspace = 'inUntrustedWorkspace';\n\n/**\n * Configuration options for unicode highlighting.\n */\nexport interface IUnicodeHighlightOptions {\n\n\t/**\n\t * Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.\n\t */\n\tnonBasicASCII?: boolean | InUntrustedWorkspace;\n\n\t/**\n\t * Controls whether characters that just reserve space or have no width at all are highlighted.\n\t */\n\tinvisibleCharacters?: boolean;\n\n\t/**\n\t * Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.\n\t */\n\tambiguousCharacters?: boolean;\n\n\t/**\n\t * Controls whether characters in comments should also be subject to unicode highlighting.\n\t */\n\tincludeComments?: boolean | InUntrustedWorkspace;\n\n\t/**\n\t * Controls whether characters in strings should also be subject to unicode highlighting.\n\t */\n\tincludeStrings?: boolean | InUntrustedWorkspace;\n\n\t/**\n\t * Defines allowed characters that are not being highlighted.\n\t */\n\tallowedCharacters?: Record<string, true>;\n\n\t/**\n\t * Unicode characters that are common in allowed locales are not being highlighted.\n\t */\n\tallowedLocales?: Record<string | '_os' | '_vscode', true>;\n}\n\n/**\n * @internal\n */\nexport type InternalUnicodeHighlightOptions = Required<Readonly<IUnicodeHighlightOptions>>;\n\n/**\n * @internal\n */\nexport const unicodeHighlightConfigKeys = {\n\tallowedCharacters: 'editor.unicodeHighlight.allowedCharacters',\n\tinvisibleCharacters: 'editor.unicodeHighlight.invisibleCharacters',\n\tnonBasicASCII: 'editor.unicodeHighlight.nonBasicASCII',\n\tambiguousCharacters: 'editor.unicodeHighlight.ambiguousCharacters',\n\tincludeComments: 'editor.unicodeHighlight.includeComments',\n\tincludeStrings: 'editor.unicodeHighlight.includeStrings',\n\tallowedLocales: 'editor.unicodeHighlight.allowedLocales',\n};\n\nclass UnicodeHighlight extends BaseEditorOption<EditorOption.unicodeHighlighting, IUnicodeHighlightOptions, InternalUnicodeHighlightOptions> {\n\tconstructor() {\n\t\tconst defaults: InternalUnicodeHighlightOptions = {\n\t\t\tnonBasicASCII: inUntrustedWorkspace,\n\t\t\tinvisibleCharacters: true,\n\t\t\tambiguousCharacters: true,\n\t\t\tincludeComments: inUntrustedWorkspace,\n\t\t\tincludeStrings: true,\n\t\t\tallowedCharacters: {},\n\t\t\tallowedLocales: { _os: true, _vscode: true },\n\t\t};\n\n\t\tsuper(\n\t\t\tEditorOption.unicodeHighlighting, 'unicodeHighlight', defaults,\n\t\t\t{\n\t\t\t\t[unicodeHighlightConfigKeys.nonBasicASCII]: {\n\t\t\t\t\trestricted: true,\n\t\t\t\t\ttype: ['boolean', 'string'],\n\t\t\t\t\tenum: [true, false, inUntrustedWorkspace],\n\t\t\t\t\tdefault: defaults.nonBasicASCII,\n\t\t\t\t\tdescription: nls.localize('unicodeHighlight.nonBasicASCII', \"Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.\")\n\t\t\t\t},\n\t\t\t\t[unicodeHighlightConfigKeys.invisibleCharacters]: {\n\t\t\t\t\trestricted: true,\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.invisibleCharacters,\n\t\t\t\t\tdescription: nls.localize('unicodeHighlight.invisibleCharacters', \"Controls whether characters that just reserve space or have no width at all are highlighted.\")\n\t\t\t\t},\n\t\t\t\t[unicodeHighlightConfigKeys.ambiguousCharacters]: {\n\t\t\t\t\trestricted: true,\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.ambiguousCharacters,\n\t\t\t\t\tdescription: nls.localize('unicodeHighlight.ambiguousCharacters', \"Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.\")\n\t\t\t\t},\n\t\t\t\t[unicodeHighlightConfigKeys.includeComments]: {\n\t\t\t\t\trestricted: true,\n\t\t\t\t\ttype: ['boolean', 'string'],\n\t\t\t\t\tenum: [true, false, inUntrustedWorkspace],\n\t\t\t\t\tdefault: defaults.includeComments,\n\t\t\t\t\tdescription: nls.localize('unicodeHighlight.includeComments', \"Controls whether characters in comments should also be subject to unicode highlighting.\")\n\t\t\t\t},\n\t\t\t\t[unicodeHighlightConfigKeys.includeStrings]: {\n\t\t\t\t\trestricted: true,\n\t\t\t\t\ttype: ['boolean', 'string'],\n\t\t\t\t\tenum: [true, false, inUntrustedWorkspace],\n\t\t\t\t\tdefault: defaults.includeStrings,\n\t\t\t\t\tdescription: nls.localize('unicodeHighlight.includeStrings', \"Controls whether characters in strings should also be subject to unicode highlighting.\")\n\t\t\t\t},\n\t\t\t\t[unicodeHighlightConfigKeys.allowedCharacters]: {\n\t\t\t\t\trestricted: true,\n\t\t\t\t\ttype: 'object',\n\t\t\t\t\tdefault: defaults.allowedCharacters,\n\t\t\t\t\tdescription: nls.localize('unicodeHighlight.allowedCharacters', \"Defines allowed characters that are not being highlighted.\"),\n\t\t\t\t\tadditionalProperties: {\n\t\t\t\t\t\ttype: 'boolean'\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t[unicodeHighlightConfigKeys.allowedLocales]: {\n\t\t\t\t\trestricted: true,\n\t\t\t\t\ttype: 'object',\n\t\t\t\t\tadditionalProperties: {\n\t\t\t\t\t\ttype: 'boolean'\n\t\t\t\t\t},\n\t\t\t\t\tdefault: defaults.allowedLocales,\n\t\t\t\t\tdescription: nls.localize('unicodeHighlight.allowedLocales', \"Unicode characters that are common in allowed locales are not being highlighted.\")\n\t\t\t\t},\n\t\t\t}\n\t\t);\n\t}\n\n\tpublic override applyUpdate(value: Required<Readonly<IUnicodeHighlightOptions>> | undefined, update: Required<Readonly<IUnicodeHighlightOptions>>): ApplyUpdateResult<Required<Readonly<IUnicodeHighlightOptions>>> {\n\t\tlet didChange = false;\n\t\tif (update.allowedCharacters && value) {\n\t\t\t// Treat allowedCharacters atomically\n\t\t\tif (!objects.equals(value.allowedCharacters, update.allowedCharacters)) {\n\t\t\t\tvalue = { ...value, allowedCharacters: update.allowedCharacters };\n\t\t\t\tdidChange = true;\n\t\t\t}\n\t\t}\n\t\tif (update.allowedLocales && value) {\n\t\t\t// Treat allowedLocales atomically\n\t\t\tif (!objects.equals(value.allowedLocales, update.allowedLocales)) {\n\t\t\t\tvalue = { ...value, allowedLocales: update.allowedLocales };\n\t\t\t\tdidChange = true;\n\t\t\t}\n\t\t}\n\n\t\tconst result = super.applyUpdate(value, update);\n\t\tif (didChange) {\n\t\t\treturn new ApplyUpdateResult(result.newValue, true);\n\t\t}\n\t\treturn result;\n\t}\n\n\tpublic validate(_input: any): InternalUnicodeHighlightOptions {\n\t\tif (!_input || typeof _input !== 'object') {\n\t\t\treturn this.defaultValue;\n\t\t}\n\t\tconst input = _input as IUnicodeHighlightOptions;\n\t\treturn {\n\t\t\tnonBasicASCII: primitiveSet<boolean | InUntrustedWorkspace>(input.nonBasicASCII, inUntrustedWorkspace, [true, false, inUntrustedWorkspace]),\n\t\t\tinvisibleCharacters: boolean(input.invisibleCharacters, this.defaultValue.invisibleCharacters),\n\t\t\tambiguousCharacters: boolean(input.ambiguousCharacters, this.defaultValue.ambiguousCharacters),\n\t\t\tincludeComments: primitiveSet<boolean | InUntrustedWorkspace>(input.includeComments, inUntrustedWorkspace, [true, false, inUntrustedWorkspace]),\n\t\t\tincludeStrings: primitiveSet<boolean | InUntrustedWorkspace>(input.includeStrings, inUntrustedWorkspace, [true, false, inUntrustedWorkspace]),\n\t\t\tallowedCharacters: this.validateBooleanMap(_input.allowedCharacters, this.defaultValue.allowedCharacters),\n\t\t\tallowedLocales: this.validateBooleanMap(_input.allowedLocales, this.defaultValue.allowedLocales),\n\t\t};\n\t}\n\n\tprivate validateBooleanMap(map: unknown, defaultValue: Record<string, true>): Record<string, true> {\n\t\tif ((typeof map !== 'object') || !map) {\n\t\t\treturn defaultValue;\n\t\t}\n\t\tconst result: Record<string, true> = {};\n\t\tfor (const [key, value] of Object.entries(map)) {\n\t\t\tif (value === true) {\n\t\t\t\tresult[key] = true;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n}\n\n//#endregion\n\n//#region inlineSuggest\n\nexport interface IInlineSuggestOptions {\n\t/**\n\t * Enable or disable the rendering of automatic inline completions.\n\t*/\n\tenabled?: boolean;\n\n\t/**\n\t * Configures the mode.\n\t * Use `prefix` to only show ghost text if the text to replace is a prefix of the suggestion text.\n\t * Use `subword` to only show ghost text if the replace text is a subword of the suggestion text.\n\t * Use `subwordSmart` to only show ghost text if the replace text is a subword of the suggestion text, but the subword must start after the cursor position.\n\t * Defaults to `prefix`.\n\t*/\n\tmode?: 'prefix' | 'subword' | 'subwordSmart';\n}\n\n/**\n * @internal\n */\nexport type InternalInlineSuggestOptions = Readonly<Required<IInlineSuggestOptions>>;\n\n/**\n * Configuration options for inline suggestions\n */\nclass InlineEditorSuggest extends BaseEditorOption<EditorOption.inlineSuggest, IInlineSuggestOptions, InternalInlineSuggestOptions> {\n\tconstructor() {\n\t\tconst defaults: InternalInlineSuggestOptions = {\n\t\t\tenabled: true,\n\t\t\tmode: 'subwordSmart'\n\t\t};\n\n\t\tsuper(\n\t\t\tEditorOption.inlineSuggest, 'inlineSuggest', defaults,\n\t\t\t{\n\t\t\t\t'editor.inlineSuggest.enabled': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.enabled,\n\t\t\t\t\tdescription: nls.localize('inlineSuggest.enabled', \"Controls whether to automatically show inline suggestions in the editor.\")\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tpublic validate(_input: any): InternalInlineSuggestOptions {\n\t\tif (!_input || typeof _input !== 'object') {\n\t\t\treturn this.defaultValue;\n\t\t}\n\t\tconst input = _input as IInlineSuggestOptions;\n\t\treturn {\n\t\t\tenabled: boolean(input.enabled, this.defaultValue.enabled),\n\t\t\tmode: stringSet(input.mode, this.defaultValue.mode, ['prefix', 'subword', 'subwordSmart']),\n\t\t};\n\t}\n}\n\n//#endregion\n\n//#region bracketPairColorization\n\nexport interface IBracketPairColorizationOptions {\n\t/**\n\t * Enable or disable bracket pair colorization.\n\t*/\n\tenabled?: boolean;\n\n\t/**\n\t * Use independent color pool per bracket type.\n\t*/\n\tindependentColorPoolPerBracketType?: boolean;\n}\n\n/**\n * @internal\n */\nexport type InternalBracketPairColorizationOptions = Readonly<Required<IBracketPairColorizationOptions>>;\n\n/**\n * Configuration options for inline suggestions\n */\nclass BracketPairColorization extends BaseEditorOption<EditorOption.bracketPairColorization, IBracketPairColorizationOptions, InternalBracketPairColorizationOptions> {\n\tconstructor() {\n\t\tconst defaults: InternalBracketPairColorizationOptions = {\n\t\t\tenabled: EDITOR_MODEL_DEFAULTS.bracketPairColorizationOptions.enabled,\n\t\t\tindependentColorPoolPerBracketType: EDITOR_MODEL_DEFAULTS.bracketPairColorizationOptions.independentColorPoolPerBracketType,\n\t\t};\n\n\t\tsuper(\n\t\t\tEditorOption.bracketPairColorization, 'bracketPairColorization', defaults,\n\t\t\t{\n\t\t\t\t'editor.bracketPairColorization.enabled': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.enabled,\n\t\t\t\t\tmarkdownDescription: nls.localize('bracketPairColorization.enabled', \"Controls whether bracket pair colorization is enabled or not. Use {0} to override the bracket highlight colors.\", '`#workbench.colorCustomizations#`')\n\t\t\t\t},\n\t\t\t\t'editor.bracketPairColorization.independentColorPoolPerBracketType': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.independentColorPoolPerBracketType,\n\t\t\t\t\tdescription: nls.localize('bracketPairColorization.independentColorPoolPerBracketType', \"Controls whether each bracket type has its own independent color pool.\")\n\t\t\t\t},\n\t\t\t}\n\t\t);\n\t}\n\n\tpublic validate(_input: any): InternalBracketPairColorizationOptions {\n\t\tif (!_input || typeof _input !== 'object') {\n\t\t\treturn this.defaultValue;\n\t\t}\n\t\tconst input = _input as IBracketPairColorizationOptions;\n\t\treturn {\n\t\t\tenabled: boolean(input.enabled, this.defaultValue.enabled),\n\t\t\tindependentColorPoolPerBracketType: boolean(input.independentColorPoolPerBracketType, this.defaultValue.independentColorPoolPerBracketType),\n\t\t};\n\t}\n}\n\n//#endregion\n\n//#region guides\n\nexport interface IGuidesOptions {\n\t/**\n\t * Enable rendering of bracket pair guides.\n\t * Defaults to false.\n\t*/\n\tbracketPairs?: boolean | 'active';\n\n\t/**\n\t * Enable rendering of vertical bracket pair guides.\n\t * Defaults to 'active'.\n\t */\n\tbracketPairsHorizontal?: boolean | 'active';\n\n\t/**\n\t * Enable highlighting of the active bracket pair.\n\t * Defaults to true.\n\t*/\n\thighlightActiveBracketPair?: boolean;\n\n\t/**\n\t * Enable rendering of indent guides.\n\t * Defaults to true.\n\t */\n\tindentation?: boolean;\n\n\t/**\n\t * Enable highlighting of the active indent guide.\n\t * Defaults to true.\n\t */\n\thighlightActiveIndentation?: boolean | 'always';\n}\n\n/**\n * @internal\n */\nexport type InternalGuidesOptions = Readonly<Required<IGuidesOptions>>;\n\n/**\n * Configuration options for inline suggestions\n */\nclass GuideOptions extends BaseEditorOption<EditorOption.guides, IGuidesOptions, InternalGuidesOptions> {\n\tconstructor() {\n\t\tconst defaults: InternalGuidesOptions = {\n\t\t\tbracketPairs: false,\n\t\t\tbracketPairsHorizontal: 'active',\n\t\t\thighlightActiveBracketPair: true,\n\n\t\t\tindentation: true,\n\t\t\thighlightActiveIndentation: true\n\t\t};\n\n\t\tsuper(\n\t\t\tEditorOption.guides, 'guides', defaults,\n\t\t\t{\n\t\t\t\t'editor.guides.bracketPairs': {\n\t\t\t\t\ttype: ['boolean', 'string'],\n\t\t\t\t\tenum: [true, 'active', false],\n\t\t\t\t\tenumDescriptions: [\n\t\t\t\t\t\tnls.localize('editor.guides.bracketPairs.true', \"Enables bracket pair guides.\"),\n\t\t\t\t\t\tnls.localize('editor.guides.bracketPairs.active', \"Enables bracket pair guides only for the active bracket pair.\"),\n\t\t\t\t\t\tnls.localize('editor.guides.bracketPairs.false', \"Disables bracket pair guides.\"),\n\t\t\t\t\t],\n\t\t\t\t\tdefault: defaults.bracketPairs,\n\t\t\t\t\tdescription: nls.localize('editor.guides.bracketPairs', \"Controls whether bracket pair guides are enabled or not.\")\n\t\t\t\t},\n\t\t\t\t'editor.guides.bracketPairsHorizontal': {\n\t\t\t\t\ttype: ['boolean', 'string'],\n\t\t\t\t\tenum: [true, 'active', false],\n\t\t\t\t\tenumDescriptions: [\n\t\t\t\t\t\tnls.localize('editor.guides.bracketPairsHorizontal.true', \"Enables horizontal guides as addition to vertical bracket pair guides.\"),\n\t\t\t\t\t\tnls.localize('editor.guides.bracketPairsHorizontal.active', \"Enables horizontal guides only for the active bracket pair.\"),\n\t\t\t\t\t\tnls.localize('editor.guides.bracketPairsHorizontal.false', \"Disables horizontal bracket pair guides.\"),\n\t\t\t\t\t],\n\t\t\t\t\tdefault: defaults.bracketPairsHorizontal,\n\t\t\t\t\tdescription: nls.localize('editor.guides.bracketPairsHorizontal', \"Controls whether horizontal bracket pair guides are enabled or not.\")\n\t\t\t\t},\n\t\t\t\t'editor.guides.highlightActiveBracketPair': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.highlightActiveBracketPair,\n\t\t\t\t\tdescription: nls.localize('editor.guides.highlightActiveBracketPair', \"Controls whether the editor should highlight the active bracket pair.\")\n\t\t\t\t},\n\t\t\t\t'editor.guides.indentation': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.indentation,\n\t\t\t\t\tdescription: nls.localize('editor.guides.indentation', \"Controls whether the editor should render indent guides.\")\n\t\t\t\t},\n\t\t\t\t'editor.guides.highlightActiveIndentation': {\n\t\t\t\t\ttype: ['boolean', 'string'],\n\t\t\t\t\tenum: [true, 'always', false],\n\t\t\t\t\tenumDescriptions: [\n\t\t\t\t\t\tnls.localize('editor.guides.highlightActiveIndentation.true', \"Highlights the active indent guide.\"),\n\t\t\t\t\t\tnls.localize('editor.guides.highlightActiveIndentation.always', \"Highlights the active indent guide even if bracket guides are highlighted.\"),\n\t\t\t\t\t\tnls.localize('editor.guides.highlightActiveIndentation.false', \"Do not highlight the active indent guide.\"),\n\t\t\t\t\t],\n\t\t\t\t\tdefault: defaults.highlightActiveIndentation,\n\n\t\t\t\t\tdescription: nls.localize('editor.guides.highlightActiveIndentation', \"Controls whether the editor should highlight the active indent guide.\")\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tpublic validate(_input: any): InternalGuidesOptions {\n\t\tif (!_input || typeof _input !== 'object') {\n\t\t\treturn this.defaultValue;\n\t\t}\n\t\tconst input = _input as IGuidesOptions;\n\t\treturn {\n\t\t\tbracketPairs: primitiveSet(input.bracketPairs, this.defaultValue.bracketPairs, [true, false, 'active']),\n\t\t\tbracketPairsHorizontal: primitiveSet(input.bracketPairsHorizontal, this.defaultValue.bracketPairsHorizontal, [true, false, 'active']),\n\t\t\thighlightActiveBracketPair: boolean(input.highlightActiveBracketPair, this.defaultValue.highlightActiveBracketPair),\n\n\t\t\tindentation: boolean(input.indentation, this.defaultValue.indentation),\n\t\t\thighlightActiveIndentation: primitiveSet(input.highlightActiveIndentation, this.defaultValue.highlightActiveIndentation, [true, false, 'always']),\n\t\t};\n\t}\n}\n\nfunction primitiveSet<T extends string | boolean>(value: unknown, defaultValue: T, allowedValues: T[]): T {\n\tconst idx = allowedValues.indexOf(value as any);\n\tif (idx === -1) {\n\t\treturn defaultValue;\n\t}\n\treturn allowedValues[idx];\n}\n\n//#endregion\n\n//#region suggest\n\n/**\n * Configuration options for editor suggest widget\n */\nexport interface ISuggestOptions {\n\t/**\n\t * Overwrite word ends on accept. Default to false.\n\t */\n\tinsertMode?: 'insert' | 'replace';\n\t/**\n\t * Enable graceful matching. Defaults to true.\n\t */\n\tfilterGraceful?: boolean;\n\t/**\n\t * Prevent quick suggestions when a snippet is active. Defaults to true.\n\t */\n\tsnippetsPreventQuickSuggestions?: boolean;\n\t/**\n\t * Favors words that appear close to the cursor.\n\t */\n\tlocalityBonus?: boolean;\n\t/**\n\t * Enable using global storage for remembering suggestions.\n\t */\n\tshareSuggestSelections?: boolean;\n\t/**\n\t * Enable or disable icons in suggestions. Defaults to true.\n\t */\n\tshowIcons?: boolean;\n\t/**\n\t * Enable or disable the suggest status bar.\n\t */\n\tshowStatusBar?: boolean;\n\t/**\n\t * Enable or disable the rendering of the suggestion preview.\n\t */\n\tpreview?: boolean;\n\t/**\n\t * Configures the mode of the preview.\n\t*/\n\tpreviewMode?: 'prefix' | 'subword' | 'subwordSmart';\n\t/**\n\t * Show details inline with the label. Defaults to true.\n\t */\n\tshowInlineDetails?: boolean;\n\t/**\n\t * Show method-suggestions.\n\t */\n\tshowMethods?: boolean;\n\t/**\n\t * Show function-suggestions.\n\t */\n\tshowFunctions?: boolean;\n\t/**\n\t * Show constructor-suggestions.\n\t */\n\tshowConstructors?: boolean;\n\t/**\n\t * Show deprecated-suggestions.\n\t */\n\tshowDeprecated?: boolean;\n\t/**\n\t * Show field-suggestions.\n\t */\n\tshowFields?: boolean;\n\t/**\n\t * Show variable-suggestions.\n\t */\n\tshowVariables?: boolean;\n\t/**\n\t * Show class-suggestions.\n\t */\n\tshowClasses?: boolean;\n\t/**\n\t * Show struct-suggestions.\n\t */\n\tshowStructs?: boolean;\n\t/**\n\t * Show interface-suggestions.\n\t */\n\tshowInterfaces?: boolean;\n\t/**\n\t * Show module-suggestions.\n\t */\n\tshowModules?: boolean;\n\t/**\n\t * Show property-suggestions.\n\t */\n\tshowProperties?: boolean;\n\t/**\n\t * Show event-suggestions.\n\t */\n\tshowEvents?: boolean;\n\t/**\n\t * Show operator-suggestions.\n\t */\n\tshowOperators?: boolean;\n\t/**\n\t * Show unit-suggestions.\n\t */\n\tshowUnits?: boolean;\n\t/**\n\t * Show value-suggestions.\n\t */\n\tshowValues?: boolean;\n\t/**\n\t * Show constant-suggestions.\n\t */\n\tshowConstants?: boolean;\n\t/**\n\t * Show enum-suggestions.\n\t */\n\tshowEnums?: boolean;\n\t/**\n\t * Show enumMember-suggestions.\n\t */\n\tshowEnumMembers?: boolean;\n\t/**\n\t * Show keyword-suggestions.\n\t */\n\tshowKeywords?: boolean;\n\t/**\n\t * Show text-suggestions.\n\t */\n\tshowWords?: boolean;\n\t/**\n\t * Show color-suggestions.\n\t */\n\tshowColors?: boolean;\n\t/**\n\t * Show file-suggestions.\n\t */\n\tshowFiles?: boolean;\n\t/**\n\t * Show reference-suggestions.\n\t */\n\tshowReferences?: boolean;\n\t/**\n\t * Show folder-suggestions.\n\t */\n\tshowFolders?: boolean;\n\t/**\n\t * Show typeParameter-suggestions.\n\t */\n\tshowTypeParameters?: boolean;\n\t/**\n\t * Show issue-suggestions.\n\t */\n\tshowIssues?: boolean;\n\t/**\n\t * Show user-suggestions.\n\t */\n\tshowUsers?: boolean;\n\t/**\n\t * Show snippet-suggestions.\n\t */\n\tshowSnippets?: boolean;\n}\n\n/**\n * @internal\n */\nexport type InternalSuggestOptions = Readonly<Required<ISuggestOptions>>;\n\nclass EditorSuggest extends BaseEditorOption<EditorOption.suggest, ISuggestOptions, InternalSuggestOptions> {\n\n\tconstructor() {\n\t\tconst defaults: InternalSuggestOptions = {\n\t\t\tinsertMode: 'insert',\n\t\t\tfilterGraceful: true,\n\t\t\tsnippetsPreventQuickSuggestions: true,\n\t\t\tlocalityBonus: false,\n\t\t\tshareSuggestSelections: false,\n\t\t\tshowIcons: true,\n\t\t\tshowStatusBar: false,\n\t\t\tpreview: false,\n\t\t\tpreviewMode: 'subwordSmart',\n\t\t\tshowInlineDetails: true,\n\t\t\tshowMethods: true,\n\t\t\tshowFunctions: true,\n\t\t\tshowConstructors: true,\n\t\t\tshowDeprecated: true,\n\t\t\tshowFields: true,\n\t\t\tshowVariables: true,\n\t\t\tshowClasses: true,\n\t\t\tshowStructs: true,\n\t\t\tshowInterfaces: true,\n\t\t\tshowModules: true,\n\t\t\tshowProperties: true,\n\t\t\tshowEvents: true,\n\t\t\tshowOperators: true,\n\t\t\tshowUnits: true,\n\t\t\tshowValues: true,\n\t\t\tshowConstants: true,\n\t\t\tshowEnums: true,\n\t\t\tshowEnumMembers: true,\n\t\t\tshowKeywords: true,\n\t\t\tshowWords: true,\n\t\t\tshowColors: true,\n\t\t\tshowFiles: true,\n\t\t\tshowReferences: true,\n\t\t\tshowFolders: true,\n\t\t\tshowTypeParameters: true,\n\t\t\tshowSnippets: true,\n\t\t\tshowUsers: true,\n\t\t\tshowIssues: true,\n\t\t};\n\t\tsuper(\n\t\t\tEditorOption.suggest, 'suggest', defaults,\n\t\t\t{\n\t\t\t\t'editor.suggest.insertMode': {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tenum: ['insert', 'replace'],\n\t\t\t\t\tenumDescriptions: [\n\t\t\t\t\t\tnls.localize('suggest.insertMode.insert', \"Insert suggestion without overwriting text right of the cursor.\"),\n\t\t\t\t\t\tnls.localize('suggest.insertMode.replace', \"Insert suggestion and overwrite text right of the cursor.\"),\n\t\t\t\t\t],\n\t\t\t\t\tdefault: defaults.insertMode,\n\t\t\t\t\tdescription: nls.localize('suggest.insertMode', \"Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.filterGraceful': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.filterGraceful,\n\t\t\t\t\tdescription: nls.localize('suggest.filterGraceful', \"Controls whether filtering and sorting suggestions accounts for small typos.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.localityBonus': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.localityBonus,\n\t\t\t\t\tdescription: nls.localize('suggest.localityBonus', \"Controls whether sorting favors words that appear close to the cursor.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.shareSuggestSelections': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.shareSuggestSelections,\n\t\t\t\t\tmarkdownDescription: nls.localize('suggest.shareSuggestSelections', \"Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.snippetsPreventQuickSuggestions': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.snippetsPreventQuickSuggestions,\n\t\t\t\t\tdescription: nls.localize('suggest.snippetsPreventQuickSuggestions', \"Controls whether an active snippet prevents quick suggestions.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showIcons': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.showIcons,\n\t\t\t\t\tdescription: nls.localize('suggest.showIcons', \"Controls whether to show or hide icons in suggestions.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showStatusBar': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.showStatusBar,\n\t\t\t\t\tdescription: nls.localize('suggest.showStatusBar', \"Controls the visibility of the status bar at the bottom of the suggest widget.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.preview': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.preview,\n\t\t\t\t\tdescription: nls.localize('suggest.preview', \"Controls whether to preview the suggestion outcome in the editor.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showInlineDetails': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.showInlineDetails,\n\t\t\t\t\tdescription: nls.localize('suggest.showInlineDetails', \"Controls whether suggest details show inline with the label or only in the details widget\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.maxVisibleSuggestions': {\n\t\t\t\t\ttype: 'number',\n\t\t\t\t\tdeprecationMessage: nls.localize('suggest.maxVisibleSuggestions.dep', \"This setting is deprecated. The suggest widget can now be resized.\"),\n\t\t\t\t},\n\t\t\t\t'editor.suggest.filteredTypes': {\n\t\t\t\t\ttype: 'object',\n\t\t\t\t\tdeprecationMessage: nls.localize('deprecated', \"This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showMethods': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: true,\n\t\t\t\t\tmarkdownDescription: nls.localize('editor.suggest.showMethods', \"When enabled IntelliSense shows `method`-suggestions.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showFunctions': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: true,\n\t\t\t\t\tmarkdownDescription: nls.localize('editor.suggest.showFunctions', \"When enabled IntelliSense shows `function`-suggestions.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showConstructors': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: true,\n\t\t\t\t\tmarkdownDescription: nls.localize('editor.suggest.showConstructors', \"When enabled IntelliSense shows `constructor`-suggestions.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showDeprecated': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: true,\n\t\t\t\t\tmarkdownDescription: nls.localize('editor.suggest.showDeprecated', \"When enabled IntelliSense shows `deprecated`-suggestions.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showFields': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: true,\n\t\t\t\t\tmarkdownDescription: nls.localize('editor.suggest.showFields', \"When enabled IntelliSense shows `field`-suggestions.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showVariables': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: true,\n\t\t\t\t\tmarkdownDescription: nls.localize('editor.suggest.showVariables', \"When enabled IntelliSense shows `variable`-suggestions.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showClasses': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: true,\n\t\t\t\t\tmarkdownDescription: nls.localize('editor.suggest.showClasss', \"When enabled IntelliSense shows `class`-suggestions.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showStructs': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: true,\n\t\t\t\t\tmarkdownDescription: nls.localize('editor.suggest.showStructs', \"When enabled IntelliSense shows `struct`-suggestions.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showInterfaces': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: true,\n\t\t\t\t\tmarkdownDescription: nls.localize('editor.suggest.showInterfaces', \"When enabled IntelliSense shows `interface`-suggestions.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showModules': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: true,\n\t\t\t\t\tmarkdownDescription: nls.localize('editor.suggest.showModules', \"When enabled IntelliSense shows `module`-suggestions.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showProperties': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: true,\n\t\t\t\t\tmarkdownDescription: nls.localize('editor.suggest.showPropertys', \"When enabled IntelliSense shows `property`-suggestions.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showEvents': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: true,\n\t\t\t\t\tmarkdownDescription: nls.localize('editor.suggest.showEvents', \"When enabled IntelliSense shows `event`-suggestions.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showOperators': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: true,\n\t\t\t\t\tmarkdownDescription: nls.localize('editor.suggest.showOperators', \"When enabled IntelliSense shows `operator`-suggestions.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showUnits': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: true,\n\t\t\t\t\tmarkdownDescription: nls.localize('editor.suggest.showUnits', \"When enabled IntelliSense shows `unit`-suggestions.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showValues': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: true,\n\t\t\t\t\tmarkdownDescription: nls.localize('editor.suggest.showValues', \"When enabled IntelliSense shows `value`-suggestions.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showConstants': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: true,\n\t\t\t\t\tmarkdownDescription: nls.localize('editor.suggest.showConstants', \"When enabled IntelliSense shows `constant`-suggestions.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showEnums': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: true,\n\t\t\t\t\tmarkdownDescription: nls.localize('editor.suggest.showEnums', \"When enabled IntelliSense shows `enum`-suggestions.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showEnumMembers': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: true,\n\t\t\t\t\tmarkdownDescription: nls.localize('editor.suggest.showEnumMembers', \"When enabled IntelliSense shows `enumMember`-suggestions.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showKeywords': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: true,\n\t\t\t\t\tmarkdownDescription: nls.localize('editor.suggest.showKeywords', \"When enabled IntelliSense shows `keyword`-suggestions.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showWords': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: true,\n\t\t\t\t\tmarkdownDescription: nls.localize('editor.suggest.showTexts', \"When enabled IntelliSense shows `text`-suggestions.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showColors': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: true,\n\t\t\t\t\tmarkdownDescription: nls.localize('editor.suggest.showColors', \"When enabled IntelliSense shows `color`-suggestions.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showFiles': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: true,\n\t\t\t\t\tmarkdownDescription: nls.localize('editor.suggest.showFiles', \"When enabled IntelliSense shows `file`-suggestions.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showReferences': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: true,\n\t\t\t\t\tmarkdownDescription: nls.localize('editor.suggest.showReferences', \"When enabled IntelliSense shows `reference`-suggestions.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showCustomcolors': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: true,\n\t\t\t\t\tmarkdownDescription: nls.localize('editor.suggest.showCustomcolors', \"When enabled IntelliSense shows `customcolor`-suggestions.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showFolders': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: true,\n\t\t\t\t\tmarkdownDescription: nls.localize('editor.suggest.showFolders', \"When enabled IntelliSense shows `folder`-suggestions.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showTypeParameters': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: true,\n\t\t\t\t\tmarkdownDescription: nls.localize('editor.suggest.showTypeParameters', \"When enabled IntelliSense shows `typeParameter`-suggestions.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showSnippets': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: true,\n\t\t\t\t\tmarkdownDescription: nls.localize('editor.suggest.showSnippets', \"When enabled IntelliSense shows `snippet`-suggestions.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showUsers': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: true,\n\t\t\t\t\tmarkdownDescription: nls.localize('editor.suggest.showUsers', \"When enabled IntelliSense shows `user`-suggestions.\")\n\t\t\t\t},\n\t\t\t\t'editor.suggest.showIssues': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: true,\n\t\t\t\t\tmarkdownDescription: nls.localize('editor.suggest.showIssues', \"When enabled IntelliSense shows `issues`-suggestions.\")\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tpublic validate(_input: any): InternalSuggestOptions {\n\t\tif (!_input || typeof _input !== 'object') {\n\t\t\treturn this.defaultValue;\n\t\t}\n\t\tconst input = _input as ISuggestOptions;\n\t\treturn {\n\t\t\tinsertMode: stringSet(input.insertMode, this.defaultValue.insertMode, ['insert', 'replace']),\n\t\t\tfilterGraceful: boolean(input.filterGraceful, this.defaultValue.filterGraceful),\n\t\t\tsnippetsPreventQuickSuggestions: boolean(input.snippetsPreventQuickSuggestions, this.defaultValue.filterGraceful),\n\t\t\tlocalityBonus: boolean(input.localityBonus, this.defaultValue.localityBonus),\n\t\t\tshareSuggestSelections: boolean(input.shareSuggestSelections, this.defaultValue.shareSuggestSelections),\n\t\t\tshowIcons: boolean(input.showIcons, this.defaultValue.showIcons),\n\t\t\tshowStatusBar: boolean(input.showStatusBar, this.defaultValue.showStatusBar),\n\t\t\tpreview: boolean(input.preview, this.defaultValue.preview),\n\t\t\tpreviewMode: stringSet(input.previewMode, this.defaultValue.previewMode, ['prefix', 'subword', 'subwordSmart']),\n\t\t\tshowInlineDetails: boolean(input.showInlineDetails, this.defaultValue.showInlineDetails),\n\t\t\tshowMethods: boolean(input.showMethods, this.defaultValue.showMethods),\n\t\t\tshowFunctions: boolean(input.showFunctions, this.defaultValue.showFunctions),\n\t\t\tshowConstructors: boolean(input.showConstructors, this.defaultValue.showConstructors),\n\t\t\tshowDeprecated: boolean(input.showDeprecated, this.defaultValue.showDeprecated),\n\t\t\tshowFields: boolean(input.showFields, this.defaultValue.showFields),\n\t\t\tshowVariables: boolean(input.showVariables, this.defaultValue.showVariables),\n\t\t\tshowClasses: boolean(input.showClasses, this.defaultValue.showClasses),\n\t\t\tshowStructs: boolean(input.showStructs, this.defaultValue.showStructs),\n\t\t\tshowInterfaces: boolean(input.showInterfaces, this.defaultValue.showInterfaces),\n\t\t\tshowModules: boolean(input.showModules, this.defaultValue.showModules),\n\t\t\tshowProperties: boolean(input.showProperties, this.defaultValue.showProperties),\n\t\t\tshowEvents: boolean(input.showEvents, this.defaultValue.showEvents),\n\t\t\tshowOperators: boolean(input.showOperators, this.defaultValue.showOperators),\n\t\t\tshowUnits: boolean(input.showUnits, this.defaultValue.showUnits),\n\t\t\tshowValues: boolean(input.showValues, this.defaultValue.showValues),\n\t\t\tshowConstants: boolean(input.showConstants, this.defaultValue.showConstants),\n\t\t\tshowEnums: boolean(input.showEnums, this.defaultValue.showEnums),\n\t\t\tshowEnumMembers: boolean(input.showEnumMembers, this.defaultValue.showEnumMembers),\n\t\t\tshowKeywords: boolean(input.showKeywords, this.defaultValue.showKeywords),\n\t\t\tshowWords: boolean(input.showWords, this.defaultValue.showWords),\n\t\t\tshowColors: boolean(input.showColors, this.defaultValue.showColors),\n\t\t\tshowFiles: boolean(input.showFiles, this.defaultValue.showFiles),\n\t\t\tshowReferences: boolean(input.showReferences, this.defaultValue.showReferences),\n\t\t\tshowFolders: boolean(input.showFolders, this.defaultValue.showFolders),\n\t\t\tshowTypeParameters: boolean(input.showTypeParameters, this.defaultValue.showTypeParameters),\n\t\t\tshowSnippets: boolean(input.showSnippets, this.defaultValue.showSnippets),\n\t\t\tshowUsers: boolean(input.showUsers, this.defaultValue.showUsers),\n\t\t\tshowIssues: boolean(input.showIssues, this.defaultValue.showIssues),\n\t\t};\n\t}\n}\n\n//#endregion\n\n//#region smart select\n\nexport interface ISmartSelectOptions {\n\tselectLeadingAndTrailingWhitespace?: boolean;\n}\n\n/**\n * @internal\n */\nexport type SmartSelectOptions = Readonly<Required<ISmartSelectOptions>>;\n\nclass SmartSelect extends BaseEditorOption<EditorOption.smartSelect, ISmartSelectOptions, SmartSelectOptions> {\n\n\tconstructor() {\n\t\tsuper(\n\t\t\tEditorOption.smartSelect, 'smartSelect',\n\t\t\t{\n\t\t\t\tselectLeadingAndTrailingWhitespace: true\n\t\t\t},\n\t\t\t{\n\t\t\t\t'editor.smartSelect.selectLeadingAndTrailingWhitespace': {\n\t\t\t\t\tdescription: nls.localize('selectLeadingAndTrailingWhitespace', \"Whether leading and trailing whitespace should always be selected.\"),\n\t\t\t\t\tdefault: true,\n\t\t\t\t\ttype: 'boolean'\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t}\n\n\tpublic validate(input: any): Readonly<Required<ISmartSelectOptions>> {\n\t\tif (!input || typeof input !== 'object') {\n\t\t\treturn this.defaultValue;\n\t\t}\n\t\treturn {\n\t\t\tselectLeadingAndTrailingWhitespace: boolean((input as ISmartSelectOptions).selectLeadingAndTrailingWhitespace, this.defaultValue.selectLeadingAndTrailingWhitespace)\n\t\t};\n\t}\n}\n\n//#endregion\n\n//#region tabFocusMode\n\nclass EditorTabFocusMode extends ComputedEditorOption<EditorOption.tabFocusMode, boolean> {\n\n\tconstructor() {\n\t\tsuper(EditorOption.tabFocusMode);\n\t}\n\n\tpublic compute(env: IEnvironmentalOptions, options: IComputedEditorOptions, _: boolean): boolean {\n\t\tconst readOnly = options.get(EditorOption.readOnly);\n\t\treturn (readOnly ? true : env.tabFocusMode);\n\t}\n}\n\n//#endregion\n\n//#region wrappingIndent\n\n/**\n * Describes how to indent wrapped lines.\n */\nexport const enum WrappingIndent {\n\t/**\n\t * No indentation => wrapped lines begin at column 1.\n\t */\n\tNone = 0,\n\t/**\n\t * Same => wrapped lines get the same indentation as the parent.\n\t */\n\tSame = 1,\n\t/**\n\t * Indent => wrapped lines get +1 indentation toward the parent.\n\t */\n\tIndent = 2,\n\t/**\n\t * DeepIndent => wrapped lines get +2 indentation toward the parent.\n\t */\n\tDeepIndent = 3\n}\n\nfunction _wrappingIndentFromString(wrappingIndent: 'none' | 'same' | 'indent' | 'deepIndent'): WrappingIndent {\n\tswitch (wrappingIndent) {\n\t\tcase 'none': return WrappingIndent.None;\n\t\tcase 'same': return WrappingIndent.Same;\n\t\tcase 'indent': return WrappingIndent.Indent;\n\t\tcase 'deepIndent': return WrappingIndent.DeepIndent;\n\t}\n}\n\n//#endregion\n\n//#region wrappingInfo\n\nexport interface EditorWrappingInfo {\n\treadonly isDominatedByLongLines: boolean;\n\treadonly isWordWrapMinified: boolean;\n\treadonly isViewportWrapping: boolean;\n\treadonly wrappingColumn: number;\n}\n\nclass EditorWrappingInfoComputer extends ComputedEditorOption<EditorOption.wrappingInfo, EditorWrappingInfo> {\n\n\tconstructor() {\n\t\tsuper(EditorOption.wrappingInfo);\n\t}\n\n\tpublic compute(env: IEnvironmentalOptions, options: IComputedEditorOptions, _: EditorWrappingInfo): EditorWrappingInfo {\n\t\tconst layoutInfo = options.get(EditorOption.layoutInfo);\n\n\t\treturn {\n\t\t\tisDominatedByLongLines: env.isDominatedByLongLines,\n\t\t\tisWordWrapMinified: layoutInfo.isWordWrapMinified,\n\t\t\tisViewportWrapping: layoutInfo.isViewportWrapping,\n\t\t\twrappingColumn: layoutInfo.wrappingColumn,\n\t\t};\n\t}\n}\n\n//#endregion\n\n//#region dropIntoEditor\n\n/**\n * Configuration options for editor drop into behavior\n */\nexport interface IDropIntoEditorOptions {\n\t/**\n\t * Enable the dropping into editor.\n\t * Defaults to true.\n\t */\n\tenabled?: boolean;\n}\n\n/**\n * @internal\n */\nexport type EditorDropIntoEditorOptions = Readonly<Required<IDropIntoEditorOptions>>;\n\nclass EditorDropIntoEditor extends BaseEditorOption<EditorOption.dropIntoEditor, IDropIntoEditorOptions, EditorDropIntoEditorOptions> {\n\n\tconstructor() {\n\t\tconst defaults: EditorDropIntoEditorOptions = { enabled: true };\n\t\tsuper(\n\t\t\tEditorOption.dropIntoEditor, 'dropIntoEditor', defaults,\n\t\t\t{\n\t\t\t\t'editor.dropIntoEditor.enabled': {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: defaults.enabled,\n\t\t\t\t\tmarkdownDescription: nls.localize('dropIntoEditor.enabled', \"Controls whether you can drag and drop a file into a text editor by holding down `shift` (instead of opening the file in an editor).\"),\n\t\t\t\t},\n\t\t\t}\n\t\t);\n\t}\n\n\tpublic validate(_input: any): EditorDropIntoEditorOptions {\n\t\tif (!_input || typeof _input !== 'object') {\n\t\t\treturn this.defaultValue;\n\t\t}\n\t\tconst input = _input as IDropIntoEditorOptions;\n\t\treturn {\n\t\t\tenabled: boolean(input.enabled, this.defaultValue.enabled)\n\t\t};\n\t}\n}\n\n//#endregion\n\nconst DEFAULT_WINDOWS_FONT_FAMILY = 'Consolas, \\'Courier New\\', monospace';\nconst DEFAULT_MAC_FONT_FAMILY = 'Menlo, Monaco, \\'Courier New\\', monospace';\nconst DEFAULT_LINUX_FONT_FAMILY = '\\'Droid Sans Mono\\', \\'monospace\\', monospace';\n\n/**\n * @internal\n */\nexport const EDITOR_FONT_DEFAULTS = {\n\tfontFamily: (\n\t\tplatform.isMacintosh ? DEFAULT_MAC_FONT_FAMILY : (platform.isLinux ? DEFAULT_LINUX_FONT_FAMILY : DEFAULT_WINDOWS_FONT_FAMILY)\n\t),\n\tfontWeight: 'normal',\n\tfontSize: (\n\t\tplatform.isMacintosh ? 12 : 14\n\t),\n\tlineHeight: 0,\n\tletterSpacing: 0,\n};\n\n/**\n * @internal\n */\nexport const editorOptionsRegistry: IEditorOption<EditorOption, any>[] = [];\n\nfunction register<K extends EditorOption, V>(option: IEditorOption<K, V>): IEditorOption<K, V> {\n\teditorOptionsRegistry[option.id] = option;\n\treturn option;\n}\n\nexport const enum EditorOption {\n\tacceptSuggestionOnCommitCharacter,\n\tacceptSuggestionOnEnter,\n\taccessibilitySupport,\n\taccessibilityPageSize,\n\tariaLabel,\n\tautoClosingBrackets,\n\tautoClosingDelete,\n\tautoClosingOvertype,\n\tautoClosingQuotes,\n\tautoIndent,\n\tautomaticLayout,\n\tautoSurround,\n\tbracketPairColorization,\n\tguides,\n\tcodeLens,\n\tcodeLensFontFamily,\n\tcodeLensFontSize,\n\tcolorDecorators,\n\tcolumnSelection,\n\tcomments,\n\tcontextmenu,\n\tcopyWithSyntaxHighlighting,\n\tcursorBlinking,\n\tcursorSmoothCaretAnimation,\n\tcursorStyle,\n\tcursorSurroundingLines,\n\tcursorSurroundingLinesStyle,\n\tcursorWidth,\n\tdisableLayerHinting,\n\tdisableMonospaceOptimizations,\n\tdomReadOnly,\n\tdragAndDrop,\n\tdropIntoEditor,\n\temptySelectionClipboard,\n\texperimental,\n\textraEditorClassName,\n\tfastScrollSensitivity,\n\tfind,\n\tfixedOverflowWidgets,\n\tfolding,\n\tfoldingStrategy,\n\tfoldingHighlight,\n\tfoldingImportsByDefault,\n\tfoldingMaximumRegions,\n\tunfoldOnClickAfterEndOfLine,\n\tfontFamily,\n\tfontInfo,\n\tfontLigatures,\n\tfontSize,\n\tfontWeight,\n\tformatOnPaste,\n\tformatOnType,\n\tglyphMargin,\n\tgotoLocation,\n\thideCursorInOverviewRuler,\n\thover,\n\tinDiffEditor,\n\tinlineSuggest,\n\tletterSpacing,\n\tlightbulb,\n\tlineDecorationsWidth,\n\tlineHeight,\n\tlineNumbers,\n\tlineNumbersMinChars,\n\tlinkedEditing,\n\tlinks,\n\tmatchBrackets,\n\tminimap,\n\tmouseStyle,\n\tmouseWheelScrollSensitivity,\n\tmouseWheelZoom,\n\tmultiCursorMergeOverlapping,\n\tmultiCursorModifier,\n\tmultiCursorPaste,\n\toccurrencesHighlight,\n\toverviewRulerBorder,\n\toverviewRulerLanes,\n\tpadding,\n\tparameterHints,\n\tpeekWidgetDefaultFocus,\n\tdefinitionLinkOpensInPeek,\n\tquickSuggestions,\n\tquickSuggestionsDelay,\n\treadOnly,\n\trenameOnType,\n\trenderControlCharacters,\n\trenderFinalNewline,\n\trenderLineHighlight,\n\trenderLineHighlightOnlyWhenFocus,\n\trenderValidationDecorations,\n\trenderWhitespace,\n\trevealHorizontalRightPadding,\n\troundedSelection,\n\trulers,\n\tscrollbar,\n\tscrollBeyondLastColumn,\n\tscrollBeyondLastLine,\n\tscrollPredominantAxis,\n\tselectionClipboard,\n\tselectionHighlight,\n\tselectOnLineNumbers,\n\tshowFoldingControls,\n\tshowUnused,\n\tsnippetSuggestions,\n\tsmartSelect,\n\tsmoothScrolling,\n\tstickyTabStops,\n\tstopRenderingLineAfter,\n\tsuggest,\n\tsuggestFontSize,\n\tsuggestLineHeight,\n\tsuggestOnTriggerCharacters,\n\tsuggestSelection,\n\ttabCompletion,\n\ttabIndex,\n\tunicodeHighlighting,\n\tunusualLineTerminators,\n\tuseShadowDOM,\n\tuseTabStops,\n\twordSeparators,\n\twordWrap,\n\twordWrapBreakAfterCharacters,\n\twordWrapBreakBeforeCharacters,\n\twordWrapColumn,\n\twordWrapOverride1,\n\twordWrapOverride2,\n\twrappingIndent,\n\twrappingStrategy,\n\tshowDeprecated,\n\tinlayHints,\n\t// Leave these at the end (because they have dependencies!)\n\teditorClassName,\n\tpixelRatio,\n\ttabFocusMode,\n\tlayoutInfo,\n\twrappingInfo,\n}\n\nexport const EditorOptions = {\n\tacceptSuggestionOnCommitCharacter: register(new EditorBooleanOption(\n\t\tEditorOption.acceptSuggestionOnCommitCharacter, 'acceptSuggestionOnCommitCharacter', true,\n\t\t{ markdownDescription: nls.localize('acceptSuggestionOnCommitCharacter', \"Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`; `) can be a commit character that accepts a suggestion and types that character.\") }\n\t)),\n\tacceptSuggestionOnEnter: register(new EditorStringEnumOption(\n\t\tEditorOption.acceptSuggestionOnEnter, 'acceptSuggestionOnEnter',\n\t\t'on' as 'on' | 'smart' | 'off',\n\t\t['on', 'smart', 'off'] as const,\n\t\t{\n\t\t\tmarkdownEnumDescriptions: [\n\t\t\t\t'',\n\t\t\t\tnls.localize('acceptSuggestionOnEnterSmart', \"Only accept a suggestion with `Enter` when it makes a textual change.\"),\n\t\t\t\t''\n\t\t\t],\n\t\t\tmarkdownDescription: nls.localize('acceptSuggestionOnEnter', \"Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.\")\n\t\t}\n\t)),\n\taccessibilitySupport: register(new EditorAccessibilitySupport()),\n\taccessibilityPageSize: register(new EditorIntOption(EditorOption.accessibilityPageSize, 'accessibilityPageSize', 10, 1, Constants.MAX_SAFE_SMALL_INTEGER,\n\t\t{\n\t\t\tdescription: nls.localize('accessibilityPageSize', \"Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default.\")\n\t\t})),\n\tariaLabel: register(new EditorStringOption(\n\t\tEditorOption.ariaLabel, 'ariaLabel', nls.localize('editorViewAccessibleLabel', \"Editor content\")\n\t)),\n\tautoClosingBrackets: register(new EditorStringEnumOption(\n\t\tEditorOption.autoClosingBrackets, 'autoClosingBrackets',\n\t\t'languageDefined' as 'always' | 'languageDefined' | 'beforeWhitespace' | 'never',\n\t\t['always', 'languageDefined', 'beforeWhitespace', 'never'] as const,\n\t\t{\n\t\t\tenumDescriptions: [\n\t\t\t\t'',\n\t\t\t\tnls.localize('editor.autoClosingBrackets.languageDefined', \"Use language configurations to determine when to autoclose brackets.\"),\n\t\t\t\tnls.localize('editor.autoClosingBrackets.beforeWhitespace', \"Autoclose brackets only when the cursor is to the left of whitespace.\"),\n\t\t\t\t'',\n\t\t\t],\n\t\t\tdescription: nls.localize('autoClosingBrackets', \"Controls whether the editor should automatically close brackets after the user adds an opening bracket.\")\n\t\t}\n\t)),\n\tautoClosingDelete: register(new EditorStringEnumOption(\n\t\tEditorOption.autoClosingDelete, 'autoClosingDelete',\n\t\t'auto' as 'always' | 'auto' | 'never',\n\t\t['always', 'auto', 'never'] as const,\n\t\t{\n\t\t\tenumDescriptions: [\n\t\t\t\t'',\n\t\t\t\tnls.localize('editor.autoClosingDelete.auto', \"Remove adjacent closing quotes or brackets only if they were automatically inserted.\"),\n\t\t\t\t'',\n\t\t\t],\n\t\t\tdescription: nls.localize('autoClosingDelete', \"Controls whether the editor should remove adjacent closing quotes or brackets when deleting.\")\n\t\t}\n\t)),\n\tautoClosingOvertype: register(new EditorStringEnumOption(\n\t\tEditorOption.autoClosingOvertype, 'autoClosingOvertype',\n\t\t'auto' as 'always' | 'auto' | 'never',\n\t\t['always', 'auto', 'never'] as const,\n\t\t{\n\t\t\tenumDescriptions: [\n\t\t\t\t'',\n\t\t\t\tnls.localize('editor.autoClosingOvertype.auto', \"Type over closing quotes or brackets only if they were automatically inserted.\"),\n\t\t\t\t'',\n\t\t\t],\n\t\t\tdescription: nls.localize('autoClosingOvertype', \"Controls whether the editor should type over closing quotes or brackets.\")\n\t\t}\n\t)),\n\tautoClosingQuotes: register(new EditorStringEnumOption(\n\t\tEditorOption.autoClosingQuotes, 'autoClosingQuotes',\n\t\t'languageDefined' as 'always' | 'languageDefined' | 'beforeWhitespace' | 'never',\n\t\t['always', 'languageDefined', 'beforeWhitespace', 'never'] as const,\n\t\t{\n\t\t\tenumDescriptions: [\n\t\t\t\t'',\n\t\t\t\tnls.localize('editor.autoClosingQuotes.languageDefined', \"Use language configurations to determine when to autoclose quotes.\"),\n\t\t\t\tnls.localize('editor.autoClosingQuotes.beforeWhitespace', \"Autoclose quotes only when the cursor is to the left of whitespace.\"),\n\t\t\t\t'',\n\t\t\t],\n\t\t\tdescription: nls.localize('autoClosingQuotes', \"Controls whether the editor should automatically close quotes after the user adds an opening quote.\")\n\t\t}\n\t)),\n\tautoIndent: register(new EditorEnumOption(\n\t\tEditorOption.autoIndent, 'autoIndent',\n\t\tEditorAutoIndentStrategy.Full, 'full',\n\t\t['none', 'keep', 'brackets', 'advanced', 'full'],\n\t\t_autoIndentFromString,\n\t\t{\n\t\t\tenumDescriptions: [\n\t\t\t\tnls.localize('editor.autoIndent.none', \"The editor will not insert indentation automatically.\"),\n\t\t\t\tnls.localize('editor.autoIndent.keep', \"The editor will keep the current line's indentation.\"),\n\t\t\t\tnls.localize('editor.autoIndent.brackets', \"The editor will keep the current line's indentation and honor language defined brackets.\"),\n\t\t\t\tnls.localize('editor.autoIndent.advanced', \"The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages.\"),\n\t\t\t\tnls.localize('editor.autoIndent.full', \"The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.\"),\n\t\t\t],\n\t\t\tdescription: nls.localize('autoIndent', \"Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.\")\n\t\t}\n\t)),\n\tautomaticLayout: register(new EditorBooleanOption(\n\t\tEditorOption.automaticLayout, 'automaticLayout', false,\n\t)),\n\tautoSurround: register(new EditorStringEnumOption(\n\t\tEditorOption.autoSurround, 'autoSurround',\n\t\t'languageDefined' as 'languageDefined' | 'quotes' | 'brackets' | 'never',\n\t\t['languageDefined', 'quotes', 'brackets', 'never'] as const,\n\t\t{\n\t\t\tenumDescriptions: [\n\t\t\t\tnls.localize('editor.autoSurround.languageDefined', \"Use language configurations to determine when to automatically surround selections.\"),\n\t\t\t\tnls.localize('editor.autoSurround.quotes', \"Surround with quotes but not brackets.\"),\n\t\t\t\tnls.localize('editor.autoSurround.brackets', \"Surround with brackets but not quotes.\"),\n\t\t\t\t''\n\t\t\t],\n\t\t\tdescription: nls.localize('autoSurround', \"Controls whether the editor should automatically surround selections when typing quotes or brackets.\")\n\t\t}\n\t)),\n\tbracketPairColorization: register(new BracketPairColorization()),\n\tbracketPairGuides: register(new GuideOptions()),\n\tstickyTabStops: register(new EditorBooleanOption(\n\t\tEditorOption.stickyTabStops, 'stickyTabStops', false,\n\t\t{ description: nls.localize('stickyTabStops', \"Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.\") }\n\t)),\n\tcodeLens: register(new EditorBooleanOption(\n\t\tEditorOption.codeLens, 'codeLens', true,\n\t\t{ description: nls.localize('codeLens', \"Controls whether the editor shows CodeLens.\") }\n\t)),\n\tcodeLensFontFamily: register(new EditorStringOption(\n\t\tEditorOption.codeLensFontFamily, 'codeLensFontFamily', '',\n\t\t{ description: nls.localize('codeLensFontFamily', \"Controls the font family for CodeLens.\") }\n\t)),\n\tcodeLensFontSize: register(new EditorIntOption(EditorOption.codeLensFontSize, 'codeLensFontSize', 0, 0, 100, {\n\t\ttype: 'number',\n\t\tdefault: 0,\n\t\tminimum: 0,\n\t\tmaximum: 100,\n\t\tmarkdownDescription: nls.localize('codeLensFontSize', \"Controls the font size in pixels for CodeLens. When set to `0`, 90% of `#editor.fontSize#` is used.\")\n\t})),\n\tcolorDecorators: register(new EditorBooleanOption(\n\t\tEditorOption.colorDecorators, 'colorDecorators', true,\n\t\t{ description: nls.localize('colorDecorators', \"Controls whether the editor should render the inline color decorators and color picker.\") }\n\t)),\n\tcolumnSelection: register(new EditorBooleanOption(\n\t\tEditorOption.columnSelection, 'columnSelection', false,\n\t\t{ description: nls.localize('columnSelection', \"Enable that the selection with the mouse and keys is doing column selection.\") }\n\t)),\n\tcomments: register(new EditorComments()),\n\tcontextmenu: register(new EditorBooleanOption(\n\t\tEditorOption.contextmenu, 'contextmenu', true,\n\t)),\n\tcopyWithSyntaxHighlighting: register(new EditorBooleanOption(\n\t\tEditorOption.copyWithSyntaxHighlighting, 'copyWithSyntaxHighlighting', true,\n\t\t{ description: nls.localize('copyWithSyntaxHighlighting', \"Controls whether syntax highlighting should be copied into the clipboard.\") }\n\t)),\n\tcursorBlinking: register(new EditorEnumOption(\n\t\tEditorOption.cursorBlinking, 'cursorBlinking',\n\t\tTextEditorCursorBlinkingStyle.Blink, 'blink',\n\t\t['blink', 'smooth', 'phase', 'expand', 'solid'],\n\t\t_cursorBlinkingStyleFromString,\n\t\t{ description: nls.localize('cursorBlinking', \"Control the cursor animation style.\") }\n\t)),\n\tcursorSmoothCaretAnimation: register(new EditorBooleanOption(\n\t\tEditorOption.cursorSmoothCaretAnimation, 'cursorSmoothCaretAnimation', false,\n\t\t{ description: nls.localize('cursorSmoothCaretAnimation', \"Controls whether the smooth caret animation should be enabled.\") }\n\t)),\n\tcursorStyle: register(new EditorEnumOption(\n\t\tEditorOption.cursorStyle, 'cursorStyle',\n\t\tTextEditorCursorStyle.Line, 'line',\n\t\t['line', 'block', 'underline', 'line-thin', 'block-outline', 'underline-thin'],\n\t\t_cursorStyleFromString,\n\t\t{ description: nls.localize('cursorStyle', \"Controls the cursor style.\") }\n\t)),\n\tcursorSurroundingLines: register(new EditorIntOption(\n\t\tEditorOption.cursorSurroundingLines, 'cursorSurroundingLines',\n\t\t0, 0, Constants.MAX_SAFE_SMALL_INTEGER,\n\t\t{ description: nls.localize('cursorSurroundingLines', \"Controls the minimal number of visible leading and trailing lines surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.\") }\n\t)),\n\tcursorSurroundingLinesStyle: register(new EditorStringEnumOption(\n\t\tEditorOption.cursorSurroundingLinesStyle, 'cursorSurroundingLinesStyle',\n\t\t'default' as 'default' | 'all',\n\t\t['default', 'all'] as const,\n\t\t{\n\t\t\tenumDescriptions: [\n\t\t\t\tnls.localize('cursorSurroundingLinesStyle.default', \"`cursorSurroundingLines` is enforced only when triggered via the keyboard or API.\"),\n\t\t\t\tnls.localize('cursorSurroundingLinesStyle.all', \"`cursorSurroundingLines` is enforced always.\")\n\t\t\t],\n\t\t\tdescription: nls.localize('cursorSurroundingLinesStyle', \"Controls when `cursorSurroundingLines` should be enforced.\")\n\t\t}\n\t)),\n\tcursorWidth: register(new EditorIntOption(\n\t\tEditorOption.cursorWidth, 'cursorWidth',\n\t\t0, 0, Constants.MAX_SAFE_SMALL_INTEGER,\n\t\t{ markdownDescription: nls.localize('cursorWidth', \"Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.\") }\n\t)),\n\tdisableLayerHinting: register(new EditorBooleanOption(\n\t\tEditorOption.disableLayerHinting, 'disableLayerHinting', false,\n\t)),\n\tdisableMonospaceOptimizations: register(new EditorBooleanOption(\n\t\tEditorOption.disableMonospaceOptimizations, 'disableMonospaceOptimizations', false\n\t)),\n\tdomReadOnly: register(new EditorBooleanOption(\n\t\t// below codes are changed by github1s\n\t\tEditorOption.domReadOnly, 'domReadOnly', !!platform.isMobile,\n\t\t// above codes are changed by github1s\n\t)),\n\tdragAndDrop: register(new EditorBooleanOption(\n\t\tEditorOption.dragAndDrop, 'dragAndDrop', true,\n\t\t{ description: nls.localize('dragAndDrop', \"Controls whether the editor should allow moving selections via drag and drop.\") }\n\t)),\n\temptySelectionClipboard: register(new EditorEmptySelectionClipboard()),\n\tdropIntoEditor: register(new EditorDropIntoEditor()),\n\texperimental: register(new EditorExperimental()),\n\textraEditorClassName: register(new EditorStringOption(\n\t\tEditorOption.extraEditorClassName, 'extraEditorClassName', '',\n\t)),\n\tfastScrollSensitivity: register(new EditorFloatOption(\n\t\tEditorOption.fastScrollSensitivity, 'fastScrollSensitivity',\n\t\t5, x => (x <= 0 ? 5 : x),\n\t\t{ markdownDescription: nls.localize('fastScrollSensitivity', \"Scrolling speed multiplier when pressing `Alt`.\") }\n\t)),\n\tfind: register(new EditorFind()),\n\tfixedOverflowWidgets: register(new EditorBooleanOption(\n\t\tEditorOption.fixedOverflowWidgets, 'fixedOverflowWidgets', false,\n\t)),\n\tfolding: register(new EditorBooleanOption(\n\t\tEditorOption.folding, 'folding', true,\n\t\t{ description: nls.localize('folding', \"Controls whether the editor has code folding enabled.\") }\n\t)),\n\tfoldingStrategy: register(new EditorStringEnumOption(\n\t\tEditorOption.foldingStrategy, 'foldingStrategy',\n\t\t'auto' as 'auto' | 'indentation',\n\t\t['auto', 'indentation'] as const,\n\t\t{\n\t\t\tenumDescriptions: [\n\t\t\t\tnls.localize('foldingStrategy.auto', \"Use a language-specific folding strategy if available, else the indentation-based one.\"),\n\t\t\t\tnls.localize('foldingStrategy.indentation', \"Use the indentation-based folding strategy.\"),\n\t\t\t],\n\t\t\tdescription: nls.localize('foldingStrategy', \"Controls the strategy for computing folding ranges.\")\n\t\t}\n\t)),\n\tfoldingHighlight: register(new EditorBooleanOption(\n\t\tEditorOption.foldingHighlight, 'foldingHighlight', true,\n\t\t{ description: nls.localize('foldingHighlight', \"Controls whether the editor should highlight folded ranges.\") }\n\t)),\n\tfoldingImportsByDefault: register(new EditorBooleanOption(\n\t\tEditorOption.foldingImportsByDefault, 'foldingImportsByDefault', false,\n\t\t{ description: nls.localize('foldingImportsByDefault', \"Controls whether the editor automatically collapses import ranges.\") }\n\t)),\n\tfoldingMaximumRegions: register(new EditorIntOption(\n\t\tEditorOption.foldingMaximumRegions, 'foldingMaximumRegions',\n\t\t5000, 10, 65000, // limit must be less than foldingRanges MAX_FOLDING_REGIONS\n\t\t{ description: nls.localize('foldingMaximumRegions', \"The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.\") }\n\t)),\n\tunfoldOnClickAfterEndOfLine: register(new EditorBooleanOption(\n\t\tEditorOption.unfoldOnClickAfterEndOfLine, 'unfoldOnClickAfterEndOfLine', false,\n\t\t{ description: nls.localize('unfoldOnClickAfterEndOfLine', \"Controls whether clicking on the empty content after a folded line will unfold the line.\") }\n\t)),\n\tfontFamily: register(new EditorStringOption(\n\t\tEditorOption.fontFamily, 'fontFamily', EDITOR_FONT_DEFAULTS.fontFamily,\n\t\t{ description: nls.localize('fontFamily', \"Controls the font family.\") }\n\t)),\n\tfontInfo: register(new EditorFontInfo()),\n\tfontLigatures2: register(new EditorFontLigatures()),\n\tfontSize: register(new EditorFontSize()),\n\tfontWeight: register(new EditorFontWeight()),\n\tformatOnPaste: register(new EditorBooleanOption(\n\t\tEditorOption.formatOnPaste, 'formatOnPaste', false,\n\t\t{ description: nls.localize('formatOnPaste', \"Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.\") }\n\t)),\n\tformatOnType: register(new EditorBooleanOption(\n\t\tEditorOption.formatOnType, 'formatOnType', false,\n\t\t{ description: nls.localize('formatOnType', \"Controls whether the editor should automatically format the line after typing.\") }\n\t)),\n\tglyphMargin: register(new EditorBooleanOption(\n\t\tEditorOption.glyphMargin, 'glyphMargin', true,\n\t\t{ description: nls.localize('glyphMargin', \"Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.\") }\n\t)),\n\tgotoLocation: register(new EditorGoToLocation()),\n\thideCursorInOverviewRuler: register(new EditorBooleanOption(\n\t\tEditorOption.hideCursorInOverviewRuler, 'hideCursorInOverviewRuler', false,\n\t\t{ description: nls.localize('hideCursorInOverviewRuler', \"Controls whether the cursor should be hidden in the overview ruler.\") }\n\t)),\n\thover: register(new EditorHover()),\n\tinDiffEditor: register(new EditorBooleanOption(\n\t\tEditorOption.inDiffEditor, 'inDiffEditor', false\n\t)),\n\tletterSpacing: register(new EditorFloatOption(\n\t\tEditorOption.letterSpacing, 'letterSpacing',\n\t\tEDITOR_FONT_DEFAULTS.letterSpacing, x => EditorFloatOption.clamp(x, -5, 20),\n\t\t{ description: nls.localize('letterSpacing', \"Controls the letter spacing in pixels.\") }\n\t)),\n\tlightbulb: register(new EditorLightbulb()),\n\tlineDecorationsWidth: register(new SimpleEditorOption(EditorOption.lineDecorationsWidth, 'lineDecorationsWidth', 10 as number | string)),\n\tlineHeight: register(new EditorLineHeight()),\n\tlineNumbers: register(new EditorRenderLineNumbersOption()),\n\tlineNumbersMinChars: register(new EditorIntOption(\n\t\tEditorOption.lineNumbersMinChars, 'lineNumbersMinChars',\n\t\t5, 1, 300\n\t)),\n\tlinkedEditing: register(new EditorBooleanOption(\n\t\tEditorOption.linkedEditing, 'linkedEditing', false,\n\t\t{ description: nls.localize('linkedEditing', \"Controls whether the editor has linked editing enabled. Depending on the language, related symbols, e.g. HTML tags, are updated while editing.\") }\n\t)),\n\tlinks: register(new EditorBooleanOption(\n\t\tEditorOption.links, 'links', true,\n\t\t{ description: nls.localize('links', \"Controls whether the editor should detect links and make them clickable.\") }\n\t)),\n\tmatchBrackets: register(new EditorStringEnumOption(\n\t\tEditorOption.matchBrackets, 'matchBrackets',\n\t\t'always' as 'never' | 'near' | 'always',\n\t\t['always', 'near', 'never'] as const,\n\t\t{ description: nls.localize('matchBrackets', \"Highlight matching brackets.\") }\n\t)),\n\tminimap: register(new EditorMinimap()),\n\tmouseStyle: register(new EditorStringEnumOption(\n\t\tEditorOption.mouseStyle, 'mouseStyle',\n\t\t'text' as 'text' | 'default' | 'copy',\n\t\t['text', 'default', 'copy'] as const,\n\t)),\n\tmouseWheelScrollSensitivity: register(new EditorFloatOption(\n\t\tEditorOption.mouseWheelScrollSensitivity, 'mouseWheelScrollSensitivity',\n\t\t1, x => (x === 0 ? 1 : x),\n\t\t{ markdownDescription: nls.localize('mouseWheelScrollSensitivity', \"A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.\") }\n\t)),\n\tmouseWheelZoom: register(new EditorBooleanOption(\n\t\tEditorOption.mouseWheelZoom, 'mouseWheelZoom', false,\n\t\t{ markdownDescription: nls.localize('mouseWheelZoom', \"Zoom the font of the editor when using mouse wheel and holding `Ctrl`.\") }\n\t)),\n\tmultiCursorMergeOverlapping: register(new EditorBooleanOption(\n\t\tEditorOption.multiCursorMergeOverlapping, 'multiCursorMergeOverlapping', true,\n\t\t{ description: nls.localize('multiCursorMergeOverlapping', \"Merge multiple cursors when they are overlapping.\") }\n\t)),\n\tmultiCursorModifier: register(new EditorEnumOption(\n\t\tEditorOption.multiCursorModifier, 'multiCursorModifier',\n\t\t'altKey', 'alt',\n\t\t['ctrlCmd', 'alt'],\n\t\t_multiCursorModifierFromString,\n\t\t{\n\t\t\tmarkdownEnumDescriptions: [\n\t\t\t\tnls.localize('multiCursorModifier.ctrlCmd', \"Maps to `Control` on Windows and Linux and to `Command` on macOS.\"),\n\t\t\t\tnls.localize('multiCursorModifier.alt', \"Maps to `Alt` on Windows and Linux and to `Option` on macOS.\")\n\t\t\t],\n\t\t\tmarkdownDescription: nls.localize({\n\t\t\t\tkey: 'multiCursorModifier',\n\t\t\t\tcomment: [\n\t\t\t\t\t'- `ctrlCmd` refers to a value the setting can take and should not be localized.',\n\t\t\t\t\t'- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized.'\n\t\t\t\t]\n\t\t\t}, \"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the [multicursor modifier](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).\")\n\t\t}\n\t)),\n\tmultiCursorPaste: register(new EditorStringEnumOption(\n\t\tEditorOption.multiCursorPaste, 'multiCursorPaste',\n\t\t'spread' as 'spread' | 'full',\n\t\t['spread', 'full'] as const,\n\t\t{\n\t\t\tmarkdownEnumDescriptions: [\n\t\t\t\tnls.localize('multiCursorPaste.spread', \"Each cursor pastes a single line of the text.\"),\n\t\t\t\tnls.localize('multiCursorPaste.full', \"Each cursor pastes the full text.\")\n\t\t\t],\n\t\t\tmarkdownDescription: nls.localize('multiCursorPaste', \"Controls pasting when the line count of the pasted text matches the cursor count.\")\n\t\t}\n\t)),\n\toccurrencesHighlight: register(new EditorBooleanOption(\n\t\tEditorOption.occurrencesHighlight, 'occurrencesHighlight', true,\n\t\t{ description: nls.localize('occurrencesHighlight', \"Controls whether the editor should highlight semantic symbol occurrences.\") }\n\t)),\n\toverviewRulerBorder: register(new EditorBooleanOption(\n\t\tEditorOption.overviewRulerBorder, 'overviewRulerBorder', true,\n\t\t{ description: nls.localize('overviewRulerBorder', \"Controls whether a border should be drawn around the overview ruler.\") }\n\t)),\n\toverviewRulerLanes: register(new EditorIntOption(\n\t\tEditorOption.overviewRulerLanes, 'overviewRulerLanes',\n\t\t3, 0, 3\n\t)),\n\tpadding: register(new EditorPadding()),\n\tparameterHints: register(new EditorParameterHints()),\n\tpeekWidgetDefaultFocus: register(new EditorStringEnumOption(\n\t\tEditorOption.peekWidgetDefaultFocus, 'peekWidgetDefaultFocus',\n\t\t'tree' as 'tree' | 'editor',\n\t\t['tree', 'editor'] as const,\n\t\t{\n\t\t\tenumDescriptions: [\n\t\t\t\tnls.localize('peekWidgetDefaultFocus.tree', \"Focus the tree when opening peek\"),\n\t\t\t\tnls.localize('peekWidgetDefaultFocus.editor', \"Focus the editor when opening peek\")\n\t\t\t],\n\t\t\tdescription: nls.localize('peekWidgetDefaultFocus', \"Controls whether to focus the inline editor or the tree in the peek widget.\")\n\t\t}\n\t)),\n\tdefinitionLinkOpensInPeek: register(new EditorBooleanOption(\n\t\tEditorOption.definitionLinkOpensInPeek, 'definitionLinkOpensInPeek', false,\n\t\t{ description: nls.localize('definitionLinkOpensInPeek', \"Controls whether the Go to Definition mouse gesture always opens the peek widget.\") }\n\t)),\n\tquickSuggestions: register(new EditorQuickSuggestions()),\n\tquickSuggestionsDelay: register(new EditorIntOption(\n\t\tEditorOption.quickSuggestionsDelay, 'quickSuggestionsDelay',\n\t\t10, 0, Constants.MAX_SAFE_SMALL_INTEGER,\n\t\t{ description: nls.localize('quickSuggestionsDelay', \"Controls the delay in milliseconds after which quick suggestions will show up.\") }\n\t)),\n\treadOnly: register(new EditorBooleanOption(\n\t\tEditorOption.readOnly, 'readOnly', false,\n\t)),\n\trenameOnType: register(new EditorBooleanOption(\n\t\tEditorOption.renameOnType, 'renameOnType', false,\n\t\t{ description: nls.localize('renameOnType', \"Controls whether the editor auto renames on type.\"), markdownDeprecationMessage: nls.localize('renameOnTypeDeprecate', \"Deprecated, use `editor.linkedEditing` instead.\") }\n\t)),\n\trenderControlCharacters: register(new EditorBooleanOption(\n\t\tEditorOption.renderControlCharacters, 'renderControlCharacters', true,\n\t\t{ description: nls.localize('renderControlCharacters', \"Controls whether the editor should render control characters.\"), restricted: true }\n\t)),\n\trenderFinalNewline: register(new EditorBooleanOption(\n\t\tEditorOption.renderFinalNewline, 'renderFinalNewline', true,\n\t\t{ description: nls.localize('renderFinalNewline', \"Render last line number when the file ends with a newline.\") }\n\t)),\n\trenderLineHighlight: register(new EditorStringEnumOption(\n\t\tEditorOption.renderLineHighlight, 'renderLineHighlight',\n\t\t'line' as 'none' | 'gutter' | 'line' | 'all',\n\t\t['none', 'gutter', 'line', 'all'] as const,\n\t\t{\n\t\t\tenumDescriptions: [\n\t\t\t\t'',\n\t\t\t\t'',\n\t\t\t\t'',\n\t\t\t\tnls.localize('renderLineHighlight.all', \"Highlights both the gutter and the current line.\"),\n\t\t\t],\n\t\t\tdescription: nls.localize('renderLineHighlight', \"Controls how the editor should render the current line highlight.\")\n\t\t}\n\t)),\n\trenderLineHighlightOnlyWhenFocus: register(new EditorBooleanOption(\n\t\tEditorOption.renderLineHighlightOnlyWhenFocus, 'renderLineHighlightOnlyWhenFocus', false,\n\t\t{ description: nls.localize('renderLineHighlightOnlyWhenFocus', \"Controls if the editor should render the current line highlight only when the editor is focused.\") }\n\t)),\n\trenderValidationDecorations: register(new EditorStringEnumOption(\n\t\tEditorOption.renderValidationDecorations, 'renderValidationDecorations',\n\t\t'editable' as 'editable' | 'on' | 'off',\n\t\t['editable', 'on', 'off'] as const\n\t)),\n\trenderWhitespace: register(new EditorStringEnumOption(\n\t\tEditorOption.renderWhitespace, 'renderWhitespace',\n\t\t'selection' as 'selection' | 'none' | 'boundary' | 'trailing' | 'all',\n\t\t['none', 'boundary', 'selection', 'trailing', 'all'] as const,\n\t\t{\n\t\t\tenumDescriptions: [\n\t\t\t\t'',\n\t\t\t\tnls.localize('renderWhitespace.boundary', \"Render whitespace characters except for single spaces between words.\"),\n\t\t\t\tnls.localize('renderWhitespace.selection', \"Render whitespace characters only on selected text.\"),\n\t\t\t\tnls.localize('renderWhitespace.trailing', \"Render only trailing whitespace characters.\"),\n\t\t\t\t''\n\t\t\t],\n\t\t\tdescription: nls.localize('renderWhitespace', \"Controls how the editor should render whitespace characters.\")\n\t\t}\n\t)),\n\trevealHorizontalRightPadding: register(new EditorIntOption(\n\t\tEditorOption.revealHorizontalRightPadding, 'revealHorizontalRightPadding',\n\t\t30, 0, 1000,\n\t)),\n\troundedSelection: register(new EditorBooleanOption(\n\t\tEditorOption.roundedSelection, 'roundedSelection', true,\n\t\t{ description: nls.localize('roundedSelection', \"Controls whether selections should have rounded corners.\") }\n\t)),\n\trulers: register(new EditorRulers()),\n\tscrollbar: register(new EditorScrollbar()),\n\tscrollBeyondLastColumn: register(new EditorIntOption(\n\t\tEditorOption.scrollBeyondLastColumn, 'scrollBeyondLastColumn',\n\t\t4, 0, Constants.MAX_SAFE_SMALL_INTEGER,\n\t\t{ description: nls.localize('scrollBeyondLastColumn', \"Controls the number of extra characters beyond which the editor will scroll horizontally.\") }\n\t)),\n\tscrollBeyondLastLine: register(new EditorBooleanOption(\n\t\tEditorOption.scrollBeyondLastLine, 'scrollBeyondLastLine', true,\n\t\t{ description: nls.localize('scrollBeyondLastLine', \"Controls whether the editor will scroll beyond the last line.\") }\n\t)),\n\tscrollPredominantAxis: register(new EditorBooleanOption(\n\t\tEditorOption.scrollPredominantAxis, 'scrollPredominantAxis', true,\n\t\t{ description: nls.localize('scrollPredominantAxis', \"Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.\") }\n\t)),\n\tselectionClipboard: register(new EditorBooleanOption(\n\t\tEditorOption.selectionClipboard, 'selectionClipboard', true,\n\t\t{\n\t\t\tdescription: nls.localize('selectionClipboard', \"Controls whether the Linux primary clipboard should be supported.\"),\n\t\t\tincluded: platform.isLinux\n\t\t}\n\t)),\n\tselectionHighlight: register(new EditorBooleanOption(\n\t\tEditorOption.selectionHighlight, 'selectionHighlight', true,\n\t\t{ description: nls.localize('selectionHighlight', \"Controls whether the editor should highlight matches similar to the selection.\") }\n\t)),\n\tselectOnLineNumbers: register(new EditorBooleanOption(\n\t\tEditorOption.selectOnLineNumbers, 'selectOnLineNumbers', true,\n\t)),\n\tshowFoldingControls: register(new EditorStringEnumOption(\n\t\tEditorOption.showFoldingControls, 'showFoldingControls',\n\t\t'mouseover' as 'always' | 'never' | 'mouseover',\n\t\t['always', 'never', 'mouseover'] as const,\n\t\t{\n\t\t\tenumDescriptions: [\n\t\t\t\tnls.localize('showFoldingControls.always', \"Always show the folding controls.\"),\n\t\t\t\tnls.localize('showFoldingControls.never', \"Never show the folding controls and reduce the gutter size.\"),\n\t\t\t\tnls.localize('showFoldingControls.mouseover', \"Only show the folding controls when the mouse is over the gutter.\"),\n\t\t\t],\n\t\t\tdescription: nls.localize('showFoldingControls', \"Controls when the folding controls on the gutter are shown.\")\n\t\t}\n\t)),\n\tshowUnused: register(new EditorBooleanOption(\n\t\tEditorOption.showUnused, 'showUnused', true,\n\t\t{ description: nls.localize('showUnused', \"Controls fading out of unused code.\") }\n\t)),\n\tshowDeprecated: register(new EditorBooleanOption(\n\t\tEditorOption.showDeprecated, 'showDeprecated', true,\n\t\t{ description: nls.localize('showDeprecated', \"Controls strikethrough deprecated variables.\") }\n\t)),\n\tinlayHints: register(new EditorInlayHints()),\n\tsnippetSuggestions: register(new EditorStringEnumOption(\n\t\tEditorOption.snippetSuggestions, 'snippetSuggestions',\n\t\t'inline' as 'top' | 'bottom' | 'inline' | 'none',\n\t\t['top', 'bottom', 'inline', 'none'] as const,\n\t\t{\n\t\t\tenumDescriptions: [\n\t\t\t\tnls.localize('snippetSuggestions.top', \"Show snippet suggestions on top of other suggestions.\"),\n\t\t\t\tnls.localize('snippetSuggestions.bottom', \"Show snippet suggestions below other suggestions.\"),\n\t\t\t\tnls.localize('snippetSuggestions.inline', \"Show snippets suggestions with other suggestions.\"),\n\t\t\t\tnls.localize('snippetSuggestions.none', \"Do not show snippet suggestions.\"),\n\t\t\t],\n\t\t\tdescription: nls.localize('snippetSuggestions', \"Controls whether snippets are shown with other suggestions and how they are sorted.\")\n\t\t}\n\t)),\n\tsmartSelect: register(new SmartSelect()),\n\tsmoothScrolling: register(new EditorBooleanOption(\n\t\tEditorOption.smoothScrolling, 'smoothScrolling', false,\n\t\t{ description: nls.localize('smoothScrolling', \"Controls whether the editor will scroll using an animation.\") }\n\t)),\n\tstopRenderingLineAfter: register(new EditorIntOption(\n\t\tEditorOption.stopRenderingLineAfter, 'stopRenderingLineAfter',\n\t\t10000, -1, Constants.MAX_SAFE_SMALL_INTEGER,\n\t)),\n\tsuggest: register(new EditorSuggest()),\n\tinlineSuggest: register(new InlineEditorSuggest()),\n\tsuggestFontSize: register(new EditorIntOption(\n\t\tEditorOption.suggestFontSize, 'suggestFontSize',\n\t\t0, 0, 1000,\n\t\t{ markdownDescription: nls.localize('suggestFontSize', \"Font size for the suggest widget. When set to {0}, the value of {1} is used.\", '`0`', '`#editor.fontSize#`') }\n\t)),\n\tsuggestLineHeight: register(new EditorIntOption(\n\t\tEditorOption.suggestLineHeight, 'suggestLineHeight',\n\t\t0, 0, 1000,\n\t\t{ markdownDescription: nls.localize('suggestLineHeight', \"Line height for the suggest widget. When set to {0}, the value of {1} is used. The minimum value is 8.\", '`0`', '`#editor.lineHeight#`') }\n\t)),\n\tsuggestOnTriggerCharacters: register(new EditorBooleanOption(\n\t\tEditorOption.suggestOnTriggerCharacters, 'suggestOnTriggerCharacters', true,\n\t\t{ description: nls.localize('suggestOnTriggerCharacters', \"Controls whether suggestions should automatically show up when typing trigger characters.\") }\n\t)),\n\tsuggestSelection: register(new EditorStringEnumOption(\n\t\tEditorOption.suggestSelection, 'suggestSelection',\n\t\t'first' as 'first' | 'recentlyUsed' | 'recentlyUsedByPrefix',\n\t\t['first', 'recentlyUsed', 'recentlyUsedByPrefix'] as const,\n\t\t{\n\t\t\tmarkdownEnumDescriptions: [\n\t\t\t\tnls.localize('suggestSelection.first', \"Always select the first suggestion.\"),\n\t\t\t\tnls.localize('suggestSelection.recentlyUsed', \"Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently.\"),\n\t\t\t\tnls.localize('suggestSelection.recentlyUsedByPrefix', \"Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.\"),\n\t\t\t],\n\t\t\tdescription: nls.localize('suggestSelection', \"Controls how suggestions are pre-selected when showing the suggest list.\")\n\t\t}\n\t)),\n\ttabCompletion: register(new EditorStringEnumOption(\n\t\tEditorOption.tabCompletion, 'tabCompletion',\n\t\t'off' as 'on' | 'off' | 'onlySnippets',\n\t\t['on', 'off', 'onlySnippets'] as const,\n\t\t{\n\t\t\tenumDescriptions: [\n\t\t\t\tnls.localize('tabCompletion.on', \"Tab complete will insert the best matching suggestion when pressing tab.\"),\n\t\t\t\tnls.localize('tabCompletion.off', \"Disable tab completions.\"),\n\t\t\t\tnls.localize('tabCompletion.onlySnippets', \"Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.\"),\n\t\t\t],\n\t\t\tdescription: nls.localize('tabCompletion', \"Enables tab completions.\")\n\t\t}\n\t)),\n\ttabIndex: register(new EditorIntOption(\n\t\tEditorOption.tabIndex, 'tabIndex',\n\t\t0, -1, Constants.MAX_SAFE_SMALL_INTEGER\n\t)),\n\tunicodeHighlight: register(new UnicodeHighlight()),\n\tunusualLineTerminators: register(new EditorStringEnumOption(\n\t\tEditorOption.unusualLineTerminators, 'unusualLineTerminators',\n\t\t'prompt' as 'auto' | 'off' | 'prompt',\n\t\t['auto', 'off', 'prompt'] as const,\n\t\t{\n\t\t\tenumDescriptions: [\n\t\t\t\tnls.localize('unusualLineTerminators.auto', \"Unusual line terminators are automatically removed.\"),\n\t\t\t\tnls.localize('unusualLineTerminators.off', \"Unusual line terminators are ignored.\"),\n\t\t\t\tnls.localize('unusualLineTerminators.prompt', \"Unusual line terminators prompt to be removed.\"),\n\t\t\t],\n\t\t\tdescription: nls.localize('unusualLineTerminators', \"Remove unusual line terminators that might cause problems.\")\n\t\t}\n\t)),\n\tuseShadowDOM: register(new EditorBooleanOption(\n\t\tEditorOption.useShadowDOM, 'useShadowDOM', true\n\t)),\n\tuseTabStops: register(new EditorBooleanOption(\n\t\tEditorOption.useTabStops, 'useTabStops', true,\n\t\t{ description: nls.localize('useTabStops', \"Inserting and deleting whitespace follows tab stops.\") }\n\t)),\n\twordSeparators: register(new EditorStringOption(\n\t\tEditorOption.wordSeparators, 'wordSeparators', USUAL_WORD_SEPARATORS,\n\t\t{ description: nls.localize('wordSeparators', \"Characters that will be used as word separators when doing word related navigations or operations.\") }\n\t)),\n\twordWrap: register(new EditorStringEnumOption(\n\t\tEditorOption.wordWrap, 'wordWrap',\n\t\t'off' as 'off' | 'on' | 'wordWrapColumn' | 'bounded',\n\t\t['off', 'on', 'wordWrapColumn', 'bounded'] as const,\n\t\t{\n\t\t\tmarkdownEnumDescriptions: [\n\t\t\t\tnls.localize('wordWrap.off', \"Lines will never wrap.\"),\n\t\t\t\tnls.localize('wordWrap.on', \"Lines will wrap at the viewport width.\"),\n\t\t\t\tnls.localize({\n\t\t\t\t\tkey: 'wordWrap.wordWrapColumn',\n\t\t\t\t\tcomment: [\n\t\t\t\t\t\t'- `editor.wordWrapColumn` refers to a different setting and should not be localized.'\n\t\t\t\t\t]\n\t\t\t\t}, \"Lines will wrap at `#editor.wordWrapColumn#`.\"),\n\t\t\t\tnls.localize({\n\t\t\t\t\tkey: 'wordWrap.bounded',\n\t\t\t\t\tcomment: [\n\t\t\t\t\t\t'- viewport means the edge of the visible window size.',\n\t\t\t\t\t\t'- `editor.wordWrapColumn` refers to a different setting and should not be localized.'\n\t\t\t\t\t]\n\t\t\t\t}, \"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.\"),\n\t\t\t],\n\t\t\tdescription: nls.localize({\n\t\t\t\tkey: 'wordWrap',\n\t\t\t\tcomment: [\n\t\t\t\t\t'- \\'off\\', \\'on\\', \\'wordWrapColumn\\' and \\'bounded\\' refer to values the setting can take and should not be localized.',\n\t\t\t\t\t'- `editor.wordWrapColumn` refers to a different setting and should not be localized.'\n\t\t\t\t]\n\t\t\t}, \"Controls how lines should wrap.\")\n\t\t}\n\t)),\n\twordWrapBreakAfterCharacters: register(new EditorStringOption(\n\t\tEditorOption.wordWrapBreakAfterCharacters, 'wordWrapBreakAfterCharacters',\n\t\t// allow-any-unicode-next-line\n\t\t' \\t})]?|/&.,;',\n\t)),\n\twordWrapBreakBeforeCharacters: register(new EditorStringOption(\n\t\tEditorOption.wordWrapBreakBeforeCharacters, 'wordWrapBreakBeforeCharacters',\n\t\t// allow-any-unicode-next-line\n\t\t'([{+'\n\t)),\n\twordWrapColumn: register(new EditorIntOption(\n\t\tEditorOption.wordWrapColumn, 'wordWrapColumn',\n\t\t80, 1, Constants.MAX_SAFE_SMALL_INTEGER,\n\t\t{\n\t\t\tmarkdownDescription: nls.localize({\n\t\t\t\tkey: 'wordWrapColumn',\n\t\t\t\tcomment: [\n\t\t\t\t\t'- `editor.wordWrap` refers to a different setting and should not be localized.',\n\t\t\t\t\t'- \\'wordWrapColumn\\' and \\'bounded\\' refer to values the different setting can take and should not be localized.'\n\t\t\t\t]\n\t\t\t}, \"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.\")\n\t\t}\n\t)),\n\twordWrapOverride1: register(new EditorStringEnumOption(\n\t\tEditorOption.wordWrapOverride1, 'wordWrapOverride1',\n\t\t'inherit' as 'off' | 'on' | 'inherit',\n\t\t['off', 'on', 'inherit'] as const\n\t)),\n\twordWrapOverride2: register(new EditorStringEnumOption(\n\t\tEditorOption.wordWrapOverride2, 'wordWrapOverride2',\n\t\t'inherit' as 'off' | 'on' | 'inherit',\n\t\t['off', 'on', 'inherit'] as const\n\t)),\n\twrappingIndent: register(new EditorEnumOption(\n\t\tEditorOption.wrappingIndent, 'wrappingIndent',\n\t\tWrappingIndent.Same, 'same',\n\t\t['none', 'same', 'indent', 'deepIndent'],\n\t\t_wrappingIndentFromString,\n\t\t{\n\t\t\tenumDescriptions: [\n\t\t\t\tnls.localize('wrappingIndent.none', \"No indentation. Wrapped lines begin at column 1.\"),\n\t\t\t\tnls.localize('wrappingIndent.same', \"Wrapped lines get the same indentation as the parent.\"),\n\t\t\t\tnls.localize('wrappingIndent.indent', \"Wrapped lines get +1 indentation toward the parent.\"),\n\t\t\t\tnls.localize('wrappingIndent.deepIndent', \"Wrapped lines get +2 indentation toward the parent.\"),\n\t\t\t],\n\t\t\tdescription: nls.localize('wrappingIndent', \"Controls the indentation of wrapped lines.\"),\n\t\t}\n\t)),\n\twrappingStrategy: register(new EditorStringEnumOption(\n\t\tEditorOption.wrappingStrategy, 'wrappingStrategy',\n\t\t'simple' as 'simple' | 'advanced',\n\t\t['simple', 'advanced'] as const,\n\t\t{\n\t\t\tenumDescriptions: [\n\t\t\t\tnls.localize('wrappingStrategy.simple', \"Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width.\"),\n\t\t\t\tnls.localize('wrappingStrategy.advanced', \"Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.\")\n\t\t\t],\n\t\t\tdescription: nls.localize('wrappingStrategy', \"Controls the algorithm that computes wrapping points.\")\n\t\t}\n\t)),\n\n\t// Leave these at the end (because they have dependencies!)\n\teditorClassName: register(new EditorClassName()),\n\tpixelRatio: register(new EditorPixelRatio()),\n\ttabFocusMode: register(new EditorTabFocusMode()),\n\tlayoutInfo: register(new EditorLayoutInfoComputer()),\n\twrappingInfo: register(new EditorWrappingInfoComputer())\n};\n\ntype EditorOptionsType = typeof EditorOptions;\ntype FindEditorOptionsKeyById<T extends EditorOption> = { [K in keyof EditorOptionsType]: EditorOptionsType[K]['id'] extends T ? K : never }[keyof EditorOptionsType];\ntype ComputedEditorOptionValue<T extends IEditorOption<any, any>> = T extends IEditorOption<any, infer R> ? R : never;\nexport type FindComputedEditorOptionValueById<T extends EditorOption> = NonNullable<ComputedEditorOptionValue<EditorOptionsType[FindEditorOptionsKeyById<T>]>>;\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Event } from 'vs/base/common/event';\nimport { URI } from 'vs/base/common/uri';\n\nexport interface IEditorModel {\n\n\t/**\n\t * Emitted when the model is about to be disposed.\n\t */\n\treadonly onWillDispose: Event<void>;\n\n\t/**\n\t * Resolves the model.\n\t */\n\tresolve(): Promise<void>;\n\n\t/**\n\t * Find out if the editor model was resolved or not.\n\t */\n\tisResolved(): boolean;\n\n\t/**\n\t * Find out if this model has been disposed.\n\t */\n\tisDisposed(): boolean;\n\n\t/**\n\t * Dispose associated resources\n\t */\n\tdispose(): void;\n}\n\nexport interface IBaseUntypedEditorInput {\n\n\t/**\n\t * Optional options to use when opening the input.\n\t */\n\toptions?: IEditorOptions;\n\n\t/**\n\t * Label to show for the input.\n\t */\n\treadonly label?: string;\n\n\t/**\n\t * Description to show for the input.\n\t */\n\treadonly description?: string;\n}\n\nexport interface IBaseResourceEditorInput extends IBaseUntypedEditorInput {\n\n\t/**\n\t * Hint to indicate that this input should be treated as a\n\t * untitled file.\n\t *\n\t * Without this hint, the editor service will make a guess by\n\t * looking at the scheme of the resource(s).\n\t *\n\t * Use `forceUntitled: true` when you pass in a `resource` that\n\t * does not use the `untitled` scheme. The `resource` will then\n\t * be used as associated path when saving the untitled file.\n\t */\n\treadonly forceUntitled?: boolean;\n}\n\nexport interface IBaseTextResourceEditorInput extends IBaseResourceEditorInput {\n\n\t/**\n\t * Optional options to use when opening the text input.\n\t */\n\toptions?: ITextEditorOptions;\n\n\t/**\n\t * The contents of the text input if known. If provided,\n\t * the input will not attempt to load the contents from\n\t * disk and may appear dirty.\n\t */\n\tcontents?: string;\n\n\t/**\n\t * The encoding of the text input if known.\n\t */\n\tencoding?: string;\n\n\t/**\n\t * The identifier of the language id of the text input\n\t * if known to use when displaying the contents.\n\t */\n\tlanguageId?: string;\n}\n\nexport interface IResourceEditorInput extends IBaseResourceEditorInput {\n\n\t/**\n\t * The resource URI of the resource to open.\n\t */\n\treadonly resource: URI;\n}\n\nexport interface ITextResourceEditorInput extends IResourceEditorInput, IBaseTextResourceEditorInput {\n\n\t/**\n\t * Optional options to use when opening the text input.\n\t */\n\toptions?: ITextEditorOptions;\n}\n\n/**\n * This identifier allows to uniquely identify an editor with a\n * resource, type and editor identifier.\n */\nexport interface IResourceEditorInputIdentifier {\n\n\t/**\n\t * The type of the editor.\n\t */\n\treadonly typeId: string;\n\n\t/**\n\t * The identifier of the editor if provided.\n\t */\n\treadonly editorId: string | undefined;\n\n\t/**\n\t * The resource URI of the editor.\n\t */\n\treadonly resource: URI;\n}\n\nexport enum EditorActivation {\n\n\t/**\n\t * Activate the editor after it opened. This will automatically restore\n\t * the editor if it is minimized.\n\t */\n\tACTIVATE = 1,\n\n\t/**\n\t * Only restore the editor if it is minimized but do not activate it.\n\t *\n\t * Note: will only work in combination with the `preserveFocus: true` option.\n\t * Otherwise, if focus moves into the editor, it will activate and restore\n\t * automatically.\n\t */\n\tRESTORE,\n\n\t/**\n\t * Preserve the current active editor.\n\t *\n\t * Note: will only work in combination with the `preserveFocus: true` option.\n\t * Otherwise, if focus moves into the editor, it will activate and restore\n\t * automatically.\n\t */\n\tPRESERVE\n}\n\nexport enum EditorResolution {\n\n\t/**\n\t * Displays a picker and allows the user to decide which editor to use.\n\t */\n\tPICK,\n\n\t/**\n\t * Disables editor resolving.\n\t */\n\tDISABLED,\n\n\t/**\n\t * Only exclusive editors are considered.\n\t */\n\tEXCLUSIVE_ONLY\n}\n\nexport enum EditorOpenSource {\n\n\t/**\n\t * Default: the editor is opening via a programmatic call\n\t * to the editor service API.\n\t */\n\tAPI,\n\n\t/**\n\t * Indicates that a user action triggered the opening, e.g.\n\t * via mouse or keyboard use.\n\t */\n\tUSER\n}\n\nexport interface IEditorOptions {\n\n\t/**\n\t * Tells the editor to not receive keyboard focus when the editor is being opened.\n\t *\n\t * Will also not activate the group the editor opens in unless the group is already\n\t * the active one. This behaviour can be overridden via the `activation` option.\n\t */\n\tpreserveFocus?: boolean;\n\n\t/**\n\t * This option is only relevant if an editor is opened into a group that is not active\n\t * already and allows to control if the inactive group should become active, restored\n\t * or preserved.\n\t *\n\t * By default, the editor group will become active unless `preserveFocus` or `inactive`\n\t * is specified.\n\t */\n\tactivation?: EditorActivation;\n\n\t/**\n\t * Tells the editor to reload the editor input in the editor even if it is identical to the one\n\t * already showing. By default, the editor will not reload the input if it is identical to the\n\t * one showing.\n\t */\n\tforceReload?: boolean;\n\n\t/**\n\t * Will reveal the editor if it is already opened and visible in any of the opened editor groups.\n\t *\n\t * Note that this option is just a hint that might be ignored if the user wants to open an editor explicitly\n\t * to the side of another one or into a specific editor group.\n\t */\n\trevealIfVisible?: boolean;\n\n\t/**\n\t * Will reveal the editor if it is already opened (even when not visible) in any of the opened editor groups.\n\t *\n\t * Note that this option is just a hint that might be ignored if the user wants to open an editor explicitly\n\t * to the side of another one or into a specific editor group.\n\t */\n\trevealIfOpened?: boolean;\n\n\t/**\n\t * An editor that is pinned remains in the editor stack even when another editor is being opened.\n\t * An editor that is not pinned will always get replaced by another editor that is not pinned.\n\t */\n\tpinned?: boolean;\n\n\t/**\n\t * An editor that is sticky moves to the beginning of the editors list within the group and will remain\n\t * there unless explicitly closed. Operations such as \"Close All\" will not close sticky editors.\n\t */\n\tsticky?: boolean;\n\n\t/**\n\t * The index in the document stack where to insert the editor into when opening.\n\t */\n\tindex?: number;\n\n\t/**\n\t * An active editor that is opened will show its contents directly. Set to true to open an editor\n\t * in the background without loading its contents.\n\t *\n\t * Will also not activate the group the editor opens in unless the group is already\n\t * the active one. This behaviour can be overridden via the `activation` option.\n\t */\n\tinactive?: boolean;\n\n\t/**\n\t * Will not show an error in case opening the editor fails and thus allows to show a custom error\n\t * message as needed. By default, an error will be presented as notification if opening was not possible.\n\t */\n\n\t/**\n\t * In case of an error opening the editor, will not present this error to the user (e.g. by showing\n\t * a generic placeholder in the editor area). So it is up to the caller to provide error information\n\t * in that case.\n\t *\n\t * By default, an error when opening an editor will result in a placeholder editor that shows the error.\n\t * In certain cases a modal dialog may be presented to ask the user for further action.\n\t */\n\tignoreError?: boolean;\n\n\t/**\n\t * Allows to override the editor that should be used to display the input:\n\t * - `undefined`: let the editor decide for itself\n\t * - `string`: specific override by id\n\t * - `EditorResolution`: specific override handling\n\t */\n\toverride?: string | EditorResolution;\n\n\t/**\n\t * A optional hint to signal in which context the editor opens.\n\t *\n\t * If configured to be `EditorOpenSource.USER`, this hint can be\n\t * used in various places to control the experience. For example,\n\t * if the editor to open fails with an error, a notification could\n\t * inform about this in a modal dialog. If the editor opened through\n\t * some background task, the notification would show in the background,\n\t * not as a modal dialog.\n\t */\n\tsource?: EditorOpenSource;\n\n\t/**\n\t * An optional property to signal that certain view state should be\n\t * applied when opening the editor.\n\t */\n\tviewState?: object;\n}\n\nexport interface ITextEditorSelection {\n\treadonly startLineNumber: number;\n\treadonly startColumn: number;\n\treadonly endLineNumber?: number;\n\treadonly endColumn?: number;\n}\n\nexport const enum TextEditorSelectionRevealType {\n\t/**\n\t * Option to scroll vertically or horizontally as necessary and reveal a range centered vertically.\n\t */\n\tCenter = 0,\n\n\t/**\n\t * Option to scroll vertically or horizontally as necessary and reveal a range centered vertically only if it lies outside the viewport.\n\t */\n\tCenterIfOutsideViewport = 1,\n\n\t/**\n\t * Option to scroll vertically or horizontally as necessary and reveal a range close to the top of the viewport, but not quite at the top.\n\t */\n\tNearTop = 2,\n\n\t/**\n\t * Option to scroll vertically or horizontally as necessary and reveal a range close to the top of the viewport, but not quite at the top.\n\t * Only if it lies outside the viewport\n\t */\n\tNearTopIfOutsideViewport = 3,\n}\n\nexport const enum TextEditorSelectionSource {\n\n\t/**\n\t * Programmatic source indicates a selection change that\n\t * was not triggered by the user via keyboard or mouse\n\t * but through text editor APIs.\n\t */\n\tPROGRAMMATIC = 'api',\n\n\t/**\n\t * Navigation source indicates a selection change that\n\t * was caused via some command or UI component such as\n\t * an outline tree.\n\t */\n\tNAVIGATION = 'code.navigation',\n\n\t/**\n\t * Jump source indicates a selection change that\n\t * was caused from within the text editor to another\n\t * location in the same or different text editor such\n\t * as \"Go to definition\".\n\t */\n\tJUMP = 'code.jump'\n}\n\nexport interface ITextEditorOptions extends IEditorOptions {\n\n\t/**\n\t * Text editor selection.\n\t */\n\tselection?: ITextEditorSelection;\n\n\t/**\n\t * Option to control the text editor selection reveal type.\n\t * Defaults to TextEditorSelectionRevealType.Center\n\t */\n\tselectionRevealType?: TextEditorSelectionRevealType;\n\n\t/**\n\t * Source of the call that caused the selection.\n\t */\n\tselectionSource?: TextEditorSelectionSource | string;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { isEqualOrParent, joinPath } from 'vs/base/common/resources';\nimport Severity from 'vs/base/common/severity';\nimport { URI } from 'vs/base/common/uri';\nimport * as nls from 'vs/nls';\nimport * as semver from 'vs/base/common/semver/semver';\nimport { IExtensionManifest } from 'vs/platform/extensions/common/extensions';\n\nexport interface IParsedVersion {\n\thasCaret: boolean;\n\thasGreaterEquals: boolean;\n\tmajorBase: number;\n\tmajorMustEqual: boolean;\n\tminorBase: number;\n\tminorMustEqual: boolean;\n\tpatchBase: number;\n\tpatchMustEqual: boolean;\n\tpreRelease: string | null;\n}\n\nexport interface INormalizedVersion {\n\tmajorBase: number;\n\tmajorMustEqual: boolean;\n\tminorBase: number;\n\tminorMustEqual: boolean;\n\tpatchBase: number;\n\tpatchMustEqual: boolean;\n\tnotBefore: number; /* milliseconds timestamp, or 0 */\n\tisMinimum: boolean;\n}\n\nconst VERSION_REGEXP = /^(\\^|>=)?((\\d+)|x)\\.((\\d+)|x)\\.((\\d+)|x)(\\-.*)?$/;\nconst NOT_BEFORE_REGEXP = /^-(\\d{4})(\\d{2})(\\d{2})$/;\n\nexport function isValidVersionStr(version: string): boolean {\n\tversion = version.trim();\n\treturn (version === '*' || VERSION_REGEXP.test(version));\n}\n\nexport function parseVersion(version: string): IParsedVersion | null {\n\tif (!isValidVersionStr(version)) {\n\t\treturn null;\n\t}\n\n\tversion = version.trim();\n\n\tif (version === '*') {\n\t\treturn {\n\t\t\thasCaret: false,\n\t\t\thasGreaterEquals: false,\n\t\t\tmajorBase: 0,\n\t\t\tmajorMustEqual: false,\n\t\t\tminorBase: 0,\n\t\t\tminorMustEqual: false,\n\t\t\tpatchBase: 0,\n\t\t\tpatchMustEqual: false,\n\t\t\tpreRelease: null\n\t\t};\n\t}\n\n\tconst m = version.match(VERSION_REGEXP);\n\tif (!m) {\n\t\treturn null;\n\t}\n\treturn {\n\t\thasCaret: m[1] === '^',\n\t\thasGreaterEquals: m[1] === '>=',\n\t\tmajorBase: m[2] === 'x' ? 0 : parseInt(m[2], 10),\n\t\tmajorMustEqual: (m[2] === 'x' ? false : true),\n\t\tminorBase: m[4] === 'x' ? 0 : parseInt(m[4], 10),\n\t\tminorMustEqual: (m[4] === 'x' ? false : true),\n\t\tpatchBase: m[6] === 'x' ? 0 : parseInt(m[6], 10),\n\t\tpatchMustEqual: (m[6] === 'x' ? false : true),\n\t\tpreRelease: m[8] || null\n\t};\n}\n\nexport function normalizeVersion(version: IParsedVersion | null): INormalizedVersion | null {\n\tif (!version) {\n\t\treturn null;\n\t}\n\n\tconst majorBase = version.majorBase;\n\tconst majorMustEqual = version.majorMustEqual;\n\tconst minorBase = version.minorBase;\n\tlet minorMustEqual = version.minorMustEqual;\n\tconst patchBase = version.patchBase;\n\tlet patchMustEqual = version.patchMustEqual;\n\n\tif (version.hasCaret) {\n\t\tif (majorBase === 0) {\n\t\t\tpatchMustEqual = false;\n\t\t} else {\n\t\t\tminorMustEqual = false;\n\t\t\tpatchMustEqual = false;\n\t\t}\n\t}\n\n\tlet notBefore = 0;\n\tif (version.preRelease) {\n\t\tconst match = NOT_BEFORE_REGEXP.exec(version.preRelease);\n\t\tif (match) {\n\t\t\tconst [, year, month, day] = match;\n\t\t\tnotBefore = Date.UTC(Number(year), Number(month) - 1, Number(day));\n\t\t}\n\t}\n\n\treturn {\n\t\tmajorBase: majorBase,\n\t\tmajorMustEqual: majorMustEqual,\n\t\tminorBase: minorBase,\n\t\tminorMustEqual: minorMustEqual,\n\t\tpatchBase: patchBase,\n\t\tpatchMustEqual: patchMustEqual,\n\t\tisMinimum: version.hasGreaterEquals,\n\t\tnotBefore,\n\t};\n}\n\nexport function isValidVersion(_inputVersion: string | INormalizedVersion, _inputDate: ProductDate, _desiredVersion: string | INormalizedVersion): boolean {\n\tlet version: INormalizedVersion | null;\n\tif (typeof _inputVersion === 'string') {\n\t\tversion = normalizeVersion(parseVersion(_inputVersion));\n\t} else {\n\t\tversion = _inputVersion;\n\t}\n\n\tlet productTs: number | undefined;\n\tif (_inputDate instanceof Date) {\n\t\tproductTs = _inputDate.getTime();\n\t} else if (typeof _inputDate === 'string') {\n\t\tproductTs = new Date(_inputDate).getTime();\n\t}\n\n\tlet desiredVersion: INormalizedVersion | null;\n\tif (typeof _desiredVersion === 'string') {\n\t\tdesiredVersion = normalizeVersion(parseVersion(_desiredVersion));\n\t} else {\n\t\tdesiredVersion = _desiredVersion;\n\t}\n\n\tif (!version || !desiredVersion) {\n\t\treturn false;\n\t}\n\n\tconst majorBase = version.majorBase;\n\tconst minorBase = version.minorBase;\n\tconst patchBase = version.patchBase;\n\n\tlet desiredMajorBase = desiredVersion.majorBase;\n\tlet desiredMinorBase = desiredVersion.minorBase;\n\tlet desiredPatchBase = desiredVersion.patchBase;\n\tconst desiredNotBefore = desiredVersion.notBefore;\n\n\tlet majorMustEqual = desiredVersion.majorMustEqual;\n\tlet minorMustEqual = desiredVersion.minorMustEqual;\n\tlet patchMustEqual = desiredVersion.patchMustEqual;\n\n\tif (desiredVersion.isMinimum) {\n\t\tif (majorBase > desiredMajorBase) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (majorBase < desiredMajorBase) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (minorBase > desiredMinorBase) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (minorBase < desiredMinorBase) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (productTs && productTs < desiredNotBefore) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn patchBase >= desiredPatchBase;\n\t}\n\n\t// Anything < 1.0.0 is compatible with >= 1.0.0, except exact matches\n\tif (majorBase === 1 && desiredMajorBase === 0 && (!majorMustEqual || !minorMustEqual || !patchMustEqual)) {\n\t\tdesiredMajorBase = 1;\n\t\tdesiredMinorBase = 0;\n\t\tdesiredPatchBase = 0;\n\t\tmajorMustEqual = true;\n\t\tminorMustEqual = false;\n\t\tpatchMustEqual = false;\n\t}\n\n\tif (majorBase < desiredMajorBase) {\n\t\t// smaller major version\n\t\treturn false;\n\t}\n\n\tif (majorBase > desiredMajorBase) {\n\t\t// higher major version\n\t\treturn (!majorMustEqual);\n\t}\n\n\t// at this point, majorBase are equal\n\n\tif (minorBase < desiredMinorBase) {\n\t\t// smaller minor version\n\t\treturn false;\n\t}\n\n\tif (minorBase > desiredMinorBase) {\n\t\t// higher minor version\n\t\treturn (!minorMustEqual);\n\t}\n\n\t// at this point, minorBase are equal\n\n\tif (patchBase < desiredPatchBase) {\n\t\t// smaller patch version\n\t\treturn false;\n\t}\n\n\tif (patchBase > desiredPatchBase) {\n\t\t// higher patch version\n\t\treturn (!patchMustEqual);\n\t}\n\n\t// at this point, patchBase are equal\n\n\tif (productTs && productTs < desiredNotBefore) {\n\t\treturn false;\n\t}\n\n\treturn true;\n}\n\ntype ProductDate = string | Date | undefined;\n\nexport function validateExtensionManifest(productVersion: string, productDate: ProductDate, extensionLocation: URI, extensionManifest: IExtensionManifest, extensionIsBuiltin: boolean): readonly [Severity, string][] {\n\tconst validations: [Severity, string][] = [];\n\tif (typeof extensionManifest.publisher !== 'undefined' && typeof extensionManifest.publisher !== 'string') {\n\t\tvalidations.push([Severity.Error, nls.localize('extensionDescription.publisher', \"property publisher must be of type `string`.\")]);\n\t\treturn validations;\n\t}\n\tif (typeof extensionManifest.name !== 'string') {\n\t\tvalidations.push([Severity.Error, nls.localize('extensionDescription.name', \"property `{0}` is mandatory and must be of type `string`\", 'name')]);\n\t\treturn validations;\n\t}\n\tif (typeof extensionManifest.version !== 'string') {\n\t\tvalidations.push([Severity.Error, nls.localize('extensionDescription.version', \"property `{0}` is mandatory and must be of type `string`\", 'version')]);\n\t\treturn validations;\n\t}\n\tif (!extensionManifest.engines) {\n\t\tvalidations.push([Severity.Error, nls.localize('extensionDescription.engines', \"property `{0}` is mandatory and must be of type `object`\", 'engines')]);\n\t\treturn validations;\n\t}\n\tif (typeof extensionManifest.engines.vscode !== 'string') {\n\t\tvalidations.push([Severity.Error, nls.localize('extensionDescription.engines.vscode', \"property `{0}` is mandatory and must be of type `string`\", 'engines.vscode')]);\n\t\treturn validations;\n\t}\n\tif (typeof extensionManifest.extensionDependencies !== 'undefined') {\n\t\tif (!isStringArray(extensionManifest.extensionDependencies)) {\n\t\t\tvalidations.push([Severity.Error, nls.localize('extensionDescription.extensionDependencies', \"property `{0}` can be omitted or must be of type `string[]`\", 'extensionDependencies')]);\n\t\t\treturn validations;\n\t\t}\n\t}\n\tif (typeof extensionManifest.activationEvents !== 'undefined') {\n\t\tif (!isStringArray(extensionManifest.activationEvents)) {\n\t\t\tvalidations.push([Severity.Error, nls.localize('extensionDescription.activationEvents1', \"property `{0}` can be omitted or must be of type `string[]`\", 'activationEvents')]);\n\t\t\treturn validations;\n\t\t}\n\t\tif (typeof extensionManifest.main === 'undefined' && typeof extensionManifest.browser === 'undefined') {\n\t\t\tvalidations.push([Severity.Error, nls.localize('extensionDescription.activationEvents2', \"properties `{0}` and `{1}` must both be specified or must both be omitted\", 'activationEvents', 'main')]);\n\t\t\treturn validations;\n\t\t}\n\t}\n\tif (typeof extensionManifest.extensionKind !== 'undefined') {\n\t\tif (typeof extensionManifest.main === 'undefined') {\n\t\t\tvalidations.push([Severity.Warning, nls.localize('extensionDescription.extensionKind', \"property `{0}` can be defined only if property `main` is also defined.\", 'extensionKind')]);\n\t\t\t// not a failure case\n\t\t}\n\t}\n\tif (typeof extensionManifest.main !== 'undefined') {\n\t\tif (typeof extensionManifest.main !== 'string') {\n\t\t\tvalidations.push([Severity.Error, nls.localize('extensionDescription.main1', \"property `{0}` can be omitted or must be of type `string`\", 'main')]);\n\t\t\treturn validations;\n\t\t} else {\n\t\t\tconst mainLocation = joinPath(extensionLocation, extensionManifest.main);\n\t\t\tif (!isEqualOrParent(mainLocation, extensionLocation)) {\n\t\t\t\tvalidations.push([Severity.Warning, nls.localize('extensionDescription.main2', \"Expected `main` ({0}) to be included inside extension's folder ({1}). This might make the extension non-portable.\", mainLocation.path, extensionLocation.path)]);\n\t\t\t\t// not a failure case\n\t\t\t}\n\t\t}\n\t\tif (typeof extensionManifest.activationEvents === 'undefined') {\n\t\t\tvalidations.push([Severity.Error, nls.localize('extensionDescription.main3', \"properties `{0}` and `{1}` must both be specified or must both be omitted\", 'activationEvents', 'main')]);\n\t\t\treturn validations;\n\t\t}\n\t}\n\tif (typeof extensionManifest.browser !== 'undefined') {\n\t\tif (typeof extensionManifest.browser !== 'string') {\n\t\t\tvalidations.push([Severity.Error, nls.localize('extensionDescription.browser1', \"property `{0}` can be omitted or must be of type `string`\", 'browser')]);\n\t\t\treturn validations;\n\t\t} else {\n\t\t\tconst browserLocation = joinPath(extensionLocation, extensionManifest.browser);\n\t\t\tif (!isEqualOrParent(browserLocation, extensionLocation)) {\n\t\t\t\tvalidations.push([Severity.Warning, nls.localize('extensionDescription.browser2', \"Expected `browser` ({0}) to be included inside extension's folder ({1}). This might make the extension non-portable.\", browserLocation.path, extensionLocation.path)]);\n\t\t\t\t// not a failure case\n\t\t\t}\n\t\t}\n\t\tif (typeof extensionManifest.activationEvents === 'undefined') {\n\t\t\tvalidations.push([Severity.Error, nls.localize('extensionDescription.browser3', \"properties `{0}` and `{1}` must both be specified or must both be omitted\", 'activationEvents', 'browser')]);\n\t\t\treturn validations;\n\t\t}\n\t}\n\n\tif (!semver.valid(extensionManifest.version)) {\n\t\tvalidations.push([Severity.Error, nls.localize('notSemver', \"Extension version is not semver compatible.\")]);\n\t\treturn validations;\n\t}\n\n\tconst notices: string[] = [];\n\tconst isValid = isValidExtensionVersion(productVersion, productDate, extensionManifest, extensionIsBuiltin, notices);\n\tif (!isValid) {\n\t\tfor (const notice of notices) {\n\t\t\tvalidations.push([Severity.Error, notice]);\n\t\t}\n\t}\n\treturn validations;\n}\n\nexport function isValidExtensionVersion(productVersion: string, productDate: ProductDate, extensionManifest: IExtensionManifest, extensionIsBuiltin: boolean, notices: string[]): boolean {\n\n\tif (extensionIsBuiltin || (typeof extensionManifest.main === 'undefined' && typeof extensionManifest.browser === 'undefined')) {\n\t\t// No version check for builtin or declarative extensions\n\t\treturn true;\n\t}\n\n\treturn isVersionValid(productVersion, productDate, extensionManifest.engines.vscode, notices);\n}\n\nexport function isEngineValid(engine: string, version: string, date: ProductDate): boolean {\n\t// TODO@joao: discuss with alex '*' doesn't seem to be a valid engine version\n\treturn engine === '*' || isVersionValid(version, date, engine);\n}\n\nfunction isVersionValid(currentVersion: string, date: ProductDate, requestedVersion: string, notices: string[] = []): boolean {\n\n\tconst desiredVersion = normalizeVersion(parseVersion(requestedVersion));\n\tif (!desiredVersion) {\n\t\tnotices.push(nls.localize('versionSyntax', \"Could not parse `engines.vscode` value {0}. Please use, for example: ^1.22.0, ^1.22.x, etc.\", requestedVersion));\n\t\treturn false;\n\t}\n\n\t// enforce that a breaking API version is specified.\n\t// for 0.X.Y, that means up to 0.X must be specified\n\t// otherwise for Z.X.Y, that means Z must be specified\n\tif (desiredVersion.majorBase === 0) {\n\t\t// force that major and minor must be specific\n\t\tif (!desiredVersion.majorMustEqual || !desiredVersion.minorMustEqual) {\n\t\t\tnotices.push(nls.localize('versionSpecificity1', \"Version specified in `engines.vscode` ({0}) is not specific enough. For vscode versions before 1.0.0, please define at a minimum the major and minor desired version. E.g. ^0.10.0, 0.10.x, 0.11.0, etc.\", requestedVersion));\n\t\t\treturn false;\n\t\t}\n\t} else {\n\t\t// force that major must be specific\n\t\tif (!desiredVersion.majorMustEqual) {\n\t\t\tnotices.push(nls.localize('versionSpecificity2', \"Version specified in `engines.vscode` ({0}) is not specific enough. For vscode versions after 1.0.0, please define at a minimum the major desired version. E.g. ^1.10.0, 1.10.x, 1.x.x, 2.x.x, etc.\", requestedVersion));\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tif (!isValidVersion(currentVersion, date, desiredVersion)) {\n\t\tnotices.push(nls.localize('versionMismatch', \"Extension is not compatible with Code {0}. Extension requires: {1}.\", currentVersion, requestedVersion));\n\t\treturn false;\n\t}\n\n\treturn true;\n}\n\nfunction isStringArray(arr: string[]): boolean {\n\tif (!Array.isArray(arr)) {\n\t\treturn false;\n\t}\n\tfor (let i = 0, len = arr.length; i < len; i++) {\n\t\tif (typeof arr[i] !== 'string') {\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn true;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport class SyncDescriptor<T> {\n\n\treadonly ctor: any;\n\treadonly staticArguments: any[];\n\treadonly supportsDelayedInstantiation: boolean;\n\n\tconstructor(ctor: new (...args: any[]) => T, staticArguments: any[] = [], supportsDelayedInstantiation: boolean = false) {\n\t\tthis.ctor = ctor;\n\t\tthis.staticArguments = staticArguments;\n\t\tthis.supportsDelayedInstantiation = supportsDelayedInstantiation;\n\t}\n}\n\nexport interface SyncDescriptor0<T> {\n\treadonly ctor: new () => T;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { SyncDescriptor } from './descriptors';\nimport { BrandedService, ServiceIdentifier } from './instantiation';\n\nconst _registry: [ServiceIdentifier<any>, SyncDescriptor<any>][] = [];\n\nexport function registerSingleton<T, Services extends BrandedService[]>(id: ServiceIdentifier<T>, ctor: new (...services: Services) => T, supportsDelayedInstantiation?: boolean): void;\nexport function registerSingleton<T, Services extends BrandedService[]>(id: ServiceIdentifier<T>, descriptor: SyncDescriptor<any>): void;\nexport function registerSingleton<T, Services extends BrandedService[]>(id: ServiceIdentifier<T>, ctorOrDescriptor: { new(...services: Services): T } | SyncDescriptor<any>, supportsDelayedInstantiation?: boolean): void {\n\tif (!(ctorOrDescriptor instanceof SyncDescriptor)) {\n\t\tctorOrDescriptor = new SyncDescriptor<T>(ctorOrDescriptor as new (...args: any[]) => T, [], supportsDelayedInstantiation);\n\t}\n\n\t_registry.push([id, ctorOrDescriptor]);\n}\n\nexport function getSingletonServiceDescriptors(): [ServiceIdentifier<any>, SyncDescriptor<any>][] {\n\treturn _registry;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport class Node<T> {\n\n\treadonly data: T;\n\treadonly incoming = new Map<string, Node<T>>();\n\treadonly outgoing = new Map<string, Node<T>>();\n\n\tconstructor(data: T) {\n\t\tthis.data = data;\n\t}\n}\n\nexport class Graph<T> {\n\n\tprivate readonly _nodes = new Map<string, Node<T>>();\n\n\tconstructor(private readonly _hashFn: (element: T) => string) {\n\t\t// empty\n\t}\n\n\troots(): Node<T>[] {\n\t\tconst ret: Node<T>[] = [];\n\t\tfor (const node of this._nodes.values()) {\n\t\t\tif (node.outgoing.size === 0) {\n\t\t\t\tret.push(node);\n\t\t\t}\n\t\t}\n\t\treturn ret;\n\t}\n\n\tinsertEdge(from: T, to: T): void {\n\t\tconst fromNode = this.lookupOrInsertNode(from);\n\t\tconst toNode = this.lookupOrInsertNode(to);\n\n\t\tfromNode.outgoing.set(this._hashFn(to), toNode);\n\t\ttoNode.incoming.set(this._hashFn(from), fromNode);\n\t}\n\n\tremoveNode(data: T): void {\n\t\tconst key = this._hashFn(data);\n\t\tthis._nodes.delete(key);\n\t\tfor (const node of this._nodes.values()) {\n\t\t\tnode.outgoing.delete(key);\n\t\t\tnode.incoming.delete(key);\n\t\t}\n\t}\n\n\tlookupOrInsertNode(data: T): Node<T> {\n\t\tconst key = this._hashFn(data);\n\t\tlet node = this._nodes.get(key);\n\n\t\tif (!node) {\n\t\t\tnode = new Node(data);\n\t\t\tthis._nodes.set(key, node);\n\t\t}\n\n\t\treturn node;\n\t}\n\n\tlookup(data: T): Node<T> | undefined {\n\t\treturn this._nodes.get(this._hashFn(data));\n\t}\n\n\tisEmpty(): boolean {\n\t\treturn this._nodes.size === 0;\n\t}\n\n\ttoString(): string {\n\t\tconst data: string[] = [];\n\t\tfor (const [key, value] of this._nodes) {\n\t\t\tdata.push(`${key}, (incoming)[${[...value.incoming.keys()].join(', ')}], (outgoing)[${[...value.outgoing.keys()].join(',')}]`);\n\n\t\t}\n\t\treturn data.join('\\n');\n\t}\n\n\t/**\n\t * This is brute force and slow and **only** be used\n\t * to trouble shoot.\n\t */\n\tfindCycleSlow() {\n\t\tfor (const [id, node] of this._nodes) {\n\t\t\tconst seen = new Set<string>([id]);\n\t\t\tconst res = this._findCycle(node, seen);\n\t\t\tif (res) {\n\t\t\t\treturn res;\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprivate _findCycle(node: Node<T>, seen: Set<string>): string | undefined {\n\t\tfor (const [id, outgoing] of node.outgoing) {\n\t\t\tif (seen.has(id)) {\n\t\t\t\treturn [...seen, id].join(' -> ');\n\t\t\t}\n\t\t\tseen.add(id);\n\t\t\tconst value = this._findCycle(outgoing, seen);\n\t\t\tif (value) {\n\t\t\t\treturn value;\n\t\t\t}\n\t\t\tseen.delete(id);\n\t\t}\n\t\treturn undefined;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as descriptors from './descriptors';\nimport { ServiceCollection } from './serviceCollection';\n\n// ------ internal util\n\nexport namespace _util {\n\n\texport const serviceIds = new Map<string, ServiceIdentifier<any>>();\n\n\texport const DI_TARGET = '$di$target';\n\texport const DI_DEPENDENCIES = '$di$dependencies';\n\n\texport function getServiceDependencies(ctor: any): { id: ServiceIdentifier<any>; index: number }[] {\n\t\treturn ctor[DI_DEPENDENCIES] || [];\n\t}\n}\n\n// --- interfaces ------\n\nexport type BrandedService = { _serviceBrand: undefined };\n\nexport interface IConstructorSignature<T, Args extends any[] = []> {\n\tnew <Services extends BrandedService[]>(...args: [...Args, ...Services]): T;\n}\n\nexport interface ServicesAccessor {\n\tget<T>(id: ServiceIdentifier<T>): T;\n}\n\nexport const IInstantiationService = createDecorator<IInstantiationService>('instantiationService');\n\n/**\n * Given a list of arguments as a tuple, attempt to extract the leading, non-service arguments\n * to their own tuple.\n */\ntype GetLeadingNonServiceArgs<Args> =\n\tArgs extends [...BrandedService[]] ? []\n\t: Args extends [infer A, ...BrandedService[]] ? [A]\n\t: Args extends [infer A, ...infer R] ? [A, ...GetLeadingNonServiceArgs<R>]\n\t: never;\n\nexport interface IInstantiationService {\n\n\treadonly _serviceBrand: undefined;\n\n\t/**\n\t * Synchronously creates an instance that is denoted by the descriptor\n\t */\n\tcreateInstance<T>(descriptor: descriptors.SyncDescriptor0<T>): T;\n\tcreateInstance<Ctor extends new (...args: any[]) => any, R extends InstanceType<Ctor>>(ctor: Ctor, ...args: GetLeadingNonServiceArgs<ConstructorParameters<Ctor>>): R;\n\n\t/**\n\t * Calls a function with a service accessor.\n\t */\n\tinvokeFunction<R, TS extends any[] = []>(fn: (accessor: ServicesAccessor, ...args: TS) => R, ...args: TS): R;\n\n\t/**\n\t * Creates a child of this service which inherits all current services\n\t * and adds/overwrites the given services.\n\t */\n\tcreateChild(services: ServiceCollection): IInstantiationService;\n}\n\n\n/**\n * Identifies a service of type `T`.\n */\nexport interface ServiceIdentifier<T> {\n\t(...args: any[]): void;\n\ttype: T;\n}\n\nfunction storeServiceDependency(id: Function, target: Function, index: number): void {\n\tif ((target as any)[_util.DI_TARGET] === target) {\n\t\t(target as any)[_util.DI_DEPENDENCIES].push({ id, index });\n\t} else {\n\t\t(target as any)[_util.DI_DEPENDENCIES] = [{ id, index }];\n\t\t(target as any)[_util.DI_TARGET] = target;\n\t}\n}\n\n/**\n * The *only* valid way to create a {{ServiceIdentifier}}.\n */\nexport function createDecorator<T>(serviceId: string): ServiceIdentifier<T> {\n\n\tif (_util.serviceIds.has(serviceId)) {\n\t\treturn _util.serviceIds.get(serviceId)!;\n\t}\n\n\tconst id = <any>function (target: Function, key: string, index: number): any {\n\t\tif (arguments.length !== 3) {\n\t\t\tthrow new Error('@IServiceName-decorator can only be used to decorate a parameter');\n\t\t}\n\t\tstoreServiceDependency(id, target, index);\n\t};\n\n\tid.toString = () => serviceId;\n\n\t_util.serviceIds.set(serviceId, id);\n\treturn id;\n}\n\nexport function refineServiceDecorator<T1, T extends T1>(serviceIdentifier: ServiceIdentifier<T1>): ServiceIdentifier<T> {\n\treturn <ServiceIdentifier<T>>serviceIdentifier;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Event } from 'vs/base/common/event';\nimport * as types from 'vs/base/common/types';\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { IWorkspaceFolder } from 'vs/platform/workspace/common/workspace';\n\nexport const IConfigurationService = createDecorator<IConfigurationService>('configurationService');\n\nexport function isConfigurationOverrides(thing: any): thing is IConfigurationOverrides {\n\treturn thing\n\t\t&& typeof thing === 'object'\n\t\t&& (!thing.overrideIdentifier || typeof thing.overrideIdentifier === 'string')\n\t\t&& (!thing.resource || thing.resource instanceof URI);\n}\n\nexport interface IConfigurationOverrides {\n\toverrideIdentifier?: string | null;\n\tresource?: URI | null;\n}\n\nexport function isConfigurationUpdateOverrides(thing: any): thing is IConfigurationUpdateOverrides {\n\treturn thing\n\t\t&& typeof thing === 'object'\n\t\t&& (!thing.overrideIdentifiers || types.isArray(thing.overrideIdentifiers))\n\t\t&& !thing.overrideIdentifier\n\t\t&& (!thing.resource || thing.resource instanceof URI);\n}\n\nexport type IConfigurationUpdateOverrides = Omit<IConfigurationOverrides, 'overrideIdentifier'> & { overrideIdentifiers?: string[] | null };\n\nexport const enum ConfigurationTarget {\n\tAPPLICATION = 1,\n\tUSER,\n\tUSER_LOCAL,\n\tUSER_REMOTE,\n\tWORKSPACE,\n\tWORKSPACE_FOLDER,\n\tDEFAULT,\n\tMEMORY\n}\nexport function ConfigurationTargetToString(configurationTarget: ConfigurationTarget) {\n\tswitch (configurationTarget) {\n\t\tcase ConfigurationTarget.APPLICATION: return 'APPLICATION';\n\t\tcase ConfigurationTarget.USER: return 'USER';\n\t\tcase ConfigurationTarget.USER_LOCAL: return 'USER_LOCAL';\n\t\tcase ConfigurationTarget.USER_REMOTE: return 'USER_REMOTE';\n\t\tcase ConfigurationTarget.WORKSPACE: return 'WORKSPACE';\n\t\tcase ConfigurationTarget.WORKSPACE_FOLDER: return 'WORKSPACE_FOLDER';\n\t\tcase ConfigurationTarget.DEFAULT: return 'DEFAULT';\n\t\tcase ConfigurationTarget.MEMORY: return 'MEMORY';\n\t}\n}\n\nexport interface IConfigurationChange {\n\tkeys: string[];\n\toverrides: [string, string[]][];\n}\n\nexport interface IConfigurationChangeEvent {\n\n\treadonly source: ConfigurationTarget;\n\treadonly affectedKeys: string[];\n\treadonly change: IConfigurationChange;\n\n\taffectsConfiguration(configuration: string, overrides?: IConfigurationOverrides): boolean;\n\n\t// Following data is used for telemetry\n\treadonly sourceConfig: any;\n}\n\nexport interface IConfigurationValue<T> {\n\n\treadonly defaultValue?: T;\n\treadonly applicationValue?: T;\n\treadonly userValue?: T;\n\treadonly userLocalValue?: T;\n\treadonly userRemoteValue?: T;\n\treadonly workspaceValue?: T;\n\treadonly workspaceFolderValue?: T;\n\treadonly memoryValue?: T;\n\treadonly policyValue?: T;\n\treadonly value?: T;\n\n\treadonly default?: { value?: T; override?: T };\n\treadonly application?: { value?: T; override?: T };\n\treadonly user?: { value?: T; override?: T };\n\treadonly userLocal?: { value?: T; override?: T };\n\treadonly userRemote?: { value?: T; override?: T };\n\treadonly workspace?: { value?: T; override?: T };\n\treadonly workspaceFolder?: { value?: T; override?: T };\n\treadonly memory?: { value?: T; override?: T };\n\treadonly policy?: { value?: T };\n\n\treadonly overrideIdentifiers?: string[];\n}\n\nexport interface IConfigurationService {\n\treadonly _serviceBrand: undefined;\n\n\tonDidChangeConfiguration: Event<IConfigurationChangeEvent>;\n\n\tgetConfigurationData(): IConfigurationData | null;\n\n\t/**\n\t * Fetches the value of the section for the given overrides.\n\t * Value can be of native type or an object keyed off the section name.\n\t *\n\t * @param section - Section of the configuraion. Can be `null` or `undefined`.\n\t * @param overrides - Overrides that has to be applied while fetching\n\t *\n\t */\n\tgetValue<T>(): T;\n\tgetValue<T>(section: string): T;\n\tgetValue<T>(overrides: IConfigurationOverrides): T;\n\tgetValue<T>(section: string, overrides: IConfigurationOverrides): T;\n\n\t/**\n\t * Update a configuration value.\n\t *\n\t * Use `target` to update the configuration in a specific `ConfigurationTarget`.\n\t *\n\t * Use `overrides` to update the configuration for a resource or for override identifiers or both.\n\t *\n\t * Passing a resource through overrides will update the configuration in the workspace folder containing that resource.\n\t *\n\t * *Note 1:* Updating configuraiton to a default value will remove the configuration from the requested target. If not target is passed, it will be removed from all writeable targets.\n\t *\n\t * *Note 2:* Use `undefined` value to remove the configuration from the given target. If not target is passed, it will be removed from all writeable targets.\n\t *\n\t * Use `donotNotifyError` and set it to `true` to surpresss errors.\n\t *\n\t * @param key setting to be updated\n\t * @param value The new value\n\t */\n\tupdateValue(key: string, value: any): Promise<void>;\n\tupdateValue(key: string, value: any, target: ConfigurationTarget): Promise<void>;\n\tupdateValue(key: string, value: any, overrides: IConfigurationOverrides | IConfigurationUpdateOverrides): Promise<void>;\n\tupdateValue(key: string, value: any, overrides: IConfigurationOverrides | IConfigurationUpdateOverrides, target: ConfigurationTarget, donotNotifyError?: boolean): Promise<void>;\n\n\tinspect<T>(key: string, overrides?: IConfigurationOverrides): IConfigurationValue<Readonly<T>>;\n\n\treloadConfiguration(target?: ConfigurationTarget | IWorkspaceFolder): Promise<void>;\n\n\tkeys(): {\n\t\tdefault: string[];\n\t\tuser: string[];\n\t\tworkspace: string[];\n\t\tworkspaceFolder: string[];\n\t\tmemory?: string[];\n\t};\n}\n\nexport interface IConfigurationModel {\n\tcontents: any;\n\tkeys: string[];\n\toverrides: IOverrides[];\n}\n\nexport interface IOverrides {\n\tkeys: string[];\n\tcontents: any;\n\tidentifiers: string[];\n}\n\nexport interface IConfigurationData {\n\tdefaults: IConfigurationModel;\n\tpolicy: IConfigurationModel;\n\tapplication: IConfigurationModel;\n\tuser: IConfigurationModel;\n\tworkspace: IConfigurationModel;\n\tfolders: [UriComponents, IConfigurationModel][];\n}\n\nexport interface IConfigurationCompareResult {\n\tadded: string[];\n\tremoved: string[];\n\tupdated: string[];\n\toverrides: [string, string[]][];\n}\n\nexport function toValuesTree(properties: { [qualifiedKey: string]: any }, conflictReporter: (message: string) => void): any {\n\tconst root = Object.create(null);\n\n\tfor (const key in properties) {\n\t\taddToValueTree(root, key, properties[key], conflictReporter);\n\t}\n\n\treturn root;\n}\n\nexport function addToValueTree(settingsTreeRoot: any, key: string, value: any, conflictReporter: (message: string) => void): void {\n\tconst segments = key.split('.');\n\tconst last = segments.pop()!;\n\n\tlet curr = settingsTreeRoot;\n\tfor (let i = 0; i < segments.length; i++) {\n\t\tconst s = segments[i];\n\t\tlet obj = curr[s];\n\t\tswitch (typeof obj) {\n\t\t\tcase 'undefined':\n\t\t\t\tobj = curr[s] = Object.create(null);\n\t\t\t\tbreak;\n\t\t\tcase 'object':\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tconflictReporter(`Ignoring ${key} as ${segments.slice(0, i + 1).join('.')} is ${JSON.stringify(obj)}`);\n\t\t\t\treturn;\n\t\t}\n\t\tcurr = obj;\n\t}\n\n\tif (typeof curr === 'object' && curr !== null) {\n\t\ttry {\n\t\t\tcurr[last] = value; // workaround https://github.com/microsoft/vscode/issues/13606\n\t\t} catch (e) {\n\t\t\tconflictReporter(`Ignoring ${key} as ${segments.join('.')} is ${JSON.stringify(curr)}`);\n\t\t}\n\t} else {\n\t\tconflictReporter(`Ignoring ${key} as ${segments.join('.')} is ${JSON.stringify(curr)}`);\n\t}\n}\n\nexport function removeFromValueTree(valueTree: any, key: string): void {\n\tconst segments = key.split('.');\n\tdoRemoveFromValueTree(valueTree, segments);\n}\n\nfunction doRemoveFromValueTree(valueTree: any, segments: string[]): void {\n\tconst first = segments.shift()!;\n\tif (segments.length === 0) {\n\t\t// Reached last segment\n\t\tdelete valueTree[first];\n\t\treturn;\n\t}\n\n\tif (Object.keys(valueTree).indexOf(first) !== -1) {\n\t\tconst value = valueTree[first];\n\t\tif (typeof value === 'object' && !Array.isArray(value)) {\n\t\t\tdoRemoveFromValueTree(value, segments);\n\t\t\tif (Object.keys(value).length === 0) {\n\t\t\t\tdelete valueTree[first];\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * A helper function to get the configuration value with a specific settings path (e.g. config.some.setting)\n */\nexport function getConfigurationValue<T>(config: any, settingPath: string, defaultValue?: T): T {\n\tfunction accessSetting(config: any, path: string[]): any {\n\t\tlet current = config;\n\t\tfor (const component of path) {\n\t\t\tif (typeof current !== 'object' || current === null) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\tcurrent = current[component];\n\t\t}\n\t\treturn <T>current;\n\t}\n\n\tconst path = settingPath.split('.');\n\tconst result = accessSetting(config, path);\n\n\treturn typeof result === 'undefined' ? defaultValue : result;\n}\n\nexport function merge(base: any, add: any, overwrite: boolean): void {\n\tObject.keys(add).forEach(key => {\n\t\tif (key !== '__proto__') {\n\t\t\tif (key in base) {\n\t\t\t\tif (types.isObject(base[key]) && types.isObject(add[key])) {\n\t\t\t\t\tmerge(base[key], add[key], overwrite);\n\t\t\t\t} else if (overwrite) {\n\t\t\t\t\tbase[key] = add[key];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tbase[key] = add[key];\n\t\t\t}\n\t\t}\n\t});\n}\n\nexport function getMigratedSettingValue<T>(configurationService: IConfigurationService, currentSettingName: string, legacySettingName: string): T {\n\tconst setting = configurationService.inspect<T>(currentSettingName);\n\tconst legacySetting = configurationService.inspect<T>(legacySettingName);\n\n\tif (typeof setting.userValue !== 'undefined' || typeof setting.workspaceValue !== 'undefined' || typeof setting.workspaceFolderValue !== 'undefined') {\n\t\treturn setting.value!;\n\t} else if (typeof legacySetting.userValue !== 'undefined' || typeof legacySetting.workspaceValue !== 'undefined' || typeof legacySetting.workspaceFolderValue !== 'undefined') {\n\t\treturn legacySetting.value!;\n\t} else {\n\t\treturn setting.defaultValue!;\n\t}\n}\n\nexport function getLanguageTagSettingPlainKey(settingKey: string) {\n\treturn settingKey.replace(/[\\[\\]]/g, '');\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Event } from 'vs/base/common/event';\nimport { isChrome, isEdge, isFirefox, isLinux, isMacintosh, isSafari, isWeb, isWindows } from 'vs/base/common/platform';\nimport { isFalsyOrWhitespace } from 'vs/base/common/strings';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\n\nconst CONSTANT_VALUES = new Map<string, boolean>();\nCONSTANT_VALUES.set('false', false);\nCONSTANT_VALUES.set('true', true);\nCONSTANT_VALUES.set('isMac', isMacintosh);\nCONSTANT_VALUES.set('isLinux', isLinux);\nCONSTANT_VALUES.set('isWindows', isWindows);\nCONSTANT_VALUES.set('isWeb', isWeb);\nCONSTANT_VALUES.set('isMacNative', isMacintosh && !isWeb);\nCONSTANT_VALUES.set('isEdge', isEdge);\nCONSTANT_VALUES.set('isFirefox', isFirefox);\nCONSTANT_VALUES.set('isChrome', isChrome);\nCONSTANT_VALUES.set('isSafari', isSafari);\n\nconst hasOwnProperty = Object.prototype.hasOwnProperty;\n\nexport const enum ContextKeyExprType {\n\tFalse = 0,\n\tTrue = 1,\n\tDefined = 2,\n\tNot = 3,\n\tEquals = 4,\n\tNotEquals = 5,\n\tAnd = 6,\n\tRegex = 7,\n\tNotRegex = 8,\n\tOr = 9,\n\tIn = 10,\n\tNotIn = 11,\n\tGreater = 12,\n\tGreaterEquals = 13,\n\tSmaller = 14,\n\tSmallerEquals = 15,\n}\n\nexport interface IContextKeyExprMapper {\n\tmapDefined(key: string): ContextKeyExpression;\n\tmapNot(key: string): ContextKeyExpression;\n\tmapEquals(key: string, value: any): ContextKeyExpression;\n\tmapNotEquals(key: string, value: any): ContextKeyExpression;\n\tmapGreater(key: string, value: any): ContextKeyExpression;\n\tmapGreaterEquals(key: string, value: any): ContextKeyExpression;\n\tmapSmaller(key: string, value: any): ContextKeyExpression;\n\tmapSmallerEquals(key: string, value: any): ContextKeyExpression;\n\tmapRegex(key: string, regexp: RegExp | null): ContextKeyRegexExpr;\n\tmapIn(key: string, valueKey: string): ContextKeyInExpr;\n\tmapNotIn(key: string, valueKey: string): ContextKeyNotInExpr;\n}\n\nexport interface IContextKeyExpression {\n\tcmp(other: ContextKeyExpression): number;\n\tequals(other: ContextKeyExpression): boolean;\n\tsubstituteConstants(): ContextKeyExpression | undefined;\n\tevaluate(context: IContext): boolean;\n\tserialize(): string;\n\tkeys(): string[];\n\tmap(mapFnc: IContextKeyExprMapper): ContextKeyExpression;\n\tnegate(): ContextKeyExpression;\n\n}\n\nexport type ContextKeyExpression = (\n\tContextKeyFalseExpr | ContextKeyTrueExpr | ContextKeyDefinedExpr | ContextKeyNotExpr\n\t| ContextKeyEqualsExpr | ContextKeyNotEqualsExpr | ContextKeyRegexExpr\n\t| ContextKeyNotRegexExpr | ContextKeyAndExpr | ContextKeyOrExpr | ContextKeyInExpr\n\t| ContextKeyNotInExpr | ContextKeyGreaterExpr | ContextKeyGreaterEqualsExpr\n\t| ContextKeySmallerExpr | ContextKeySmallerEqualsExpr\n);\n\nexport abstract class ContextKeyExpr {\n\n\tpublic static false(): ContextKeyExpression {\n\t\treturn ContextKeyFalseExpr.INSTANCE;\n\t}\n\tpublic static true(): ContextKeyExpression {\n\t\treturn ContextKeyTrueExpr.INSTANCE;\n\t}\n\tpublic static has(key: string): ContextKeyExpression {\n\t\treturn ContextKeyDefinedExpr.create(key);\n\t}\n\tpublic static equals(key: string, value: any): ContextKeyExpression {\n\t\treturn ContextKeyEqualsExpr.create(key, value);\n\t}\n\tpublic static notEquals(key: string, value: any): ContextKeyExpression {\n\t\treturn ContextKeyNotEqualsExpr.create(key, value);\n\t}\n\tpublic static regex(key: string, value: RegExp): ContextKeyExpression {\n\t\treturn ContextKeyRegexExpr.create(key, value);\n\t}\n\tpublic static in(key: string, value: string): ContextKeyExpression {\n\t\treturn ContextKeyInExpr.create(key, value);\n\t}\n\tpublic static notIn(key: string, value: string): ContextKeyExpression {\n\t\treturn ContextKeyNotInExpr.create(key, value);\n\t}\n\tpublic static not(key: string): ContextKeyExpression {\n\t\treturn ContextKeyNotExpr.create(key);\n\t}\n\tpublic static and(...expr: Array<ContextKeyExpression | undefined | null>): ContextKeyExpression | undefined {\n\t\treturn ContextKeyAndExpr.create(expr, null);\n\t}\n\tpublic static or(...expr: Array<ContextKeyExpression | undefined | null>): ContextKeyExpression | undefined {\n\t\treturn ContextKeyOrExpr.create(expr, null, true);\n\t}\n\tpublic static greater(key: string, value: number): ContextKeyExpression {\n\t\treturn ContextKeyGreaterExpr.create(key, value);\n\t}\n\tpublic static greaterEquals(key: string, value: number): ContextKeyExpression {\n\t\treturn ContextKeyGreaterEqualsExpr.create(key, value);\n\t}\n\tpublic static smaller(key: string, value: number): ContextKeyExpression {\n\t\treturn ContextKeySmallerExpr.create(key, value);\n\t}\n\tpublic static smallerEquals(key: string, value: number): ContextKeyExpression {\n\t\treturn ContextKeySmallerEqualsExpr.create(key, value);\n\t}\n\n\tpublic static deserialize(serialized: string | null | undefined, strict: boolean = false): ContextKeyExpression | undefined {\n\t\tif (!serialized) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn this._deserializeOrExpression(serialized, strict);\n\t}\n\n\tprivate static _deserializeOrExpression(serialized: string, strict: boolean): ContextKeyExpression | undefined {\n\t\tconst pieces = serialized.split('||');\n\t\treturn ContextKeyOrExpr.create(pieces.map(p => this._deserializeAndExpression(p, strict)), null, true);\n\t}\n\n\tprivate static _deserializeAndExpression(serialized: string, strict: boolean): ContextKeyExpression | undefined {\n\t\tconst pieces = serialized.split('&&');\n\t\treturn ContextKeyAndExpr.create(pieces.map(p => this._deserializeOne(p, strict)), null);\n\t}\n\n\tprivate static _deserializeOne(serializedOne: string, strict: boolean): ContextKeyExpression {\n\t\tserializedOne = serializedOne.trim();\n\n\t\tif (serializedOne.indexOf('!=') >= 0) {\n\t\t\tconst pieces = serializedOne.split('!=');\n\t\t\treturn ContextKeyNotEqualsExpr.create(pieces[0].trim(), this._deserializeValue(pieces[1], strict));\n\t\t}\n\n\t\tif (serializedOne.indexOf('==') >= 0) {\n\t\t\tconst pieces = serializedOne.split('==');\n\t\t\treturn ContextKeyEqualsExpr.create(pieces[0].trim(), this._deserializeValue(pieces[1], strict));\n\t\t}\n\n\t\tif (serializedOne.indexOf('=~') >= 0) {\n\t\t\tconst pieces = serializedOne.split('=~');\n\t\t\treturn ContextKeyRegexExpr.create(pieces[0].trim(), this._deserializeRegexValue(pieces[1], strict));\n\t\t}\n\n\t\tif (serializedOne.indexOf(' not in ') >= 0) {\n\t\t\tconst pieces = serializedOne.split(' not in ');\n\t\t\treturn ContextKeyNotInExpr.create(pieces[0].trim(), pieces[1].trim());\n\t\t}\n\n\t\tif (serializedOne.indexOf(' in ') >= 0) {\n\t\t\tconst pieces = serializedOne.split(' in ');\n\t\t\treturn ContextKeyInExpr.create(pieces[0].trim(), pieces[1].trim());\n\t\t}\n\n\t\tif (/^[^<=>]+>=[^<=>]+$/.test(serializedOne)) {\n\t\t\tconst pieces = serializedOne.split('>=');\n\t\t\treturn ContextKeyGreaterEqualsExpr.create(pieces[0].trim(), pieces[1].trim());\n\t\t}\n\n\t\tif (/^[^<=>]+>[^<=>]+$/.test(serializedOne)) {\n\t\t\tconst pieces = serializedOne.split('>');\n\t\t\treturn ContextKeyGreaterExpr.create(pieces[0].trim(), pieces[1].trim());\n\t\t}\n\n\t\tif (/^[^<=>]+<=[^<=>]+$/.test(serializedOne)) {\n\t\t\tconst pieces = serializedOne.split('<=');\n\t\t\treturn ContextKeySmallerEqualsExpr.create(pieces[0].trim(), pieces[1].trim());\n\t\t}\n\n\t\tif (/^[^<=>]+<[^<=>]+$/.test(serializedOne)) {\n\t\t\tconst pieces = serializedOne.split('<');\n\t\t\treturn ContextKeySmallerExpr.create(pieces[0].trim(), pieces[1].trim());\n\t\t}\n\n\t\tif (/^\\!\\s*/.test(serializedOne)) {\n\t\t\treturn ContextKeyNotExpr.create(serializedOne.substr(1).trim());\n\t\t}\n\n\t\treturn ContextKeyDefinedExpr.create(serializedOne);\n\t}\n\n\tprivate static _deserializeValue(serializedValue: string, strict: boolean): any {\n\t\tserializedValue = serializedValue.trim();\n\n\t\tif (serializedValue === 'true') {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (serializedValue === 'false') {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst m = /^'([^']*)'$/.exec(serializedValue);\n\t\tif (m) {\n\t\t\treturn m[1].trim();\n\t\t}\n\n\t\treturn serializedValue;\n\t}\n\n\tprivate static _deserializeRegexValue(serializedValue: string, strict: boolean): RegExp | null {\n\n\t\tif (isFalsyOrWhitespace(serializedValue)) {\n\t\t\tif (strict) {\n\t\t\t\tthrow new Error('missing regexp-value for =~-expression');\n\t\t\t} else {\n\t\t\t\tconsole.warn('missing regexp-value for =~-expression');\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\tconst start = serializedValue.indexOf('/');\n\t\tconst end = serializedValue.lastIndexOf('/');\n\t\tif (start === end || start < 0 /* || to < 0 */) {\n\t\t\tif (strict) {\n\t\t\t\tthrow new Error(`bad regexp-value '${serializedValue}', missing /-enclosure`);\n\t\t\t} else {\n\t\t\t\tconsole.warn(`bad regexp-value '${serializedValue}', missing /-enclosure`);\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\tconst value = serializedValue.slice(start + 1, end);\n\t\tconst caseIgnoreFlag = serializedValue[end + 1] === 'i' ? 'i' : '';\n\t\ttry {\n\t\t\treturn new RegExp(value, caseIgnoreFlag);\n\t\t} catch (e) {\n\t\t\tif (strict) {\n\t\t\t\tthrow new Error(`bad regexp-value '${serializedValue}', parse error: ${e}`);\n\t\t\t} else {\n\t\t\t\tconsole.warn(`bad regexp-value '${serializedValue}', parse error: ${e}`);\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t}\n}\n\nexport function expressionsAreEqualWithConstantSubstitution(a: ContextKeyExpression | null | undefined, b: ContextKeyExpression | null | undefined): boolean {\n\tconst aExpr = a ? a.substituteConstants() : undefined;\n\tconst bExpr = b ? b.substituteConstants() : undefined;\n\tif (!aExpr && !bExpr) {\n\t\treturn true;\n\t}\n\tif (!aExpr || !bExpr) {\n\t\treturn false;\n\t}\n\treturn aExpr.equals(bExpr);\n}\n\nfunction cmp(a: ContextKeyExpression, b: ContextKeyExpression): number {\n\treturn a.cmp(b);\n}\n\nexport class ContextKeyFalseExpr implements IContextKeyExpression {\n\tpublic static INSTANCE = new ContextKeyFalseExpr();\n\n\tpublic readonly type = ContextKeyExprType.False;\n\n\tprotected constructor() {\n\t}\n\n\tpublic cmp(other: ContextKeyExpression): number {\n\t\treturn this.type - other.type;\n\t}\n\n\tpublic equals(other: ContextKeyExpression): boolean {\n\t\treturn (other.type === this.type);\n\t}\n\n\tpublic substituteConstants(): ContextKeyExpression | undefined {\n\t\treturn this;\n\t}\n\n\tpublic evaluate(context: IContext): boolean {\n\t\treturn false;\n\t}\n\n\tpublic serialize(): string {\n\t\treturn 'false';\n\t}\n\n\tpublic keys(): string[] {\n\t\treturn [];\n\t}\n\n\tpublic map(mapFnc: IContextKeyExprMapper): ContextKeyExpression {\n\t\treturn this;\n\t}\n\n\tpublic negate(): ContextKeyExpression {\n\t\treturn ContextKeyTrueExpr.INSTANCE;\n\t}\n}\n\nexport class ContextKeyTrueExpr implements IContextKeyExpression {\n\tpublic static INSTANCE = new ContextKeyTrueExpr();\n\n\tpublic readonly type = ContextKeyExprType.True;\n\n\tprotected constructor() {\n\t}\n\n\tpublic cmp(other: ContextKeyExpression): number {\n\t\treturn this.type - other.type;\n\t}\n\n\tpublic equals(other: ContextKeyExpression): boolean {\n\t\treturn (other.type === this.type);\n\t}\n\n\tpublic substituteConstants(): ContextKeyExpression | undefined {\n\t\treturn this;\n\t}\n\n\tpublic evaluate(context: IContext): boolean {\n\t\treturn true;\n\t}\n\n\tpublic serialize(): string {\n\t\treturn 'true';\n\t}\n\n\tpublic keys(): string[] {\n\t\treturn [];\n\t}\n\n\tpublic map(mapFnc: IContextKeyExprMapper): ContextKeyExpression {\n\t\treturn this;\n\t}\n\n\tpublic negate(): ContextKeyExpression {\n\t\treturn ContextKeyFalseExpr.INSTANCE;\n\t}\n}\n\nexport class ContextKeyDefinedExpr implements IContextKeyExpression {\n\tpublic static create(key: string, negated: ContextKeyExpression | null = null): ContextKeyExpression {\n\t\tconst constantValue = CONSTANT_VALUES.get(key);\n\t\tif (typeof constantValue === 'boolean') {\n\t\t\treturn constantValue ? ContextKeyTrueExpr.INSTANCE : ContextKeyFalseExpr.INSTANCE;\n\t\t}\n\t\treturn new ContextKeyDefinedExpr(key, negated);\n\t}\n\n\tpublic readonly type = ContextKeyExprType.Defined;\n\n\tprotected constructor(\n\t\treadonly key: string,\n\t\tprivate negated: ContextKeyExpression | null\n\t) {\n\t}\n\n\tpublic cmp(other: ContextKeyExpression): number {\n\t\tif (other.type !== this.type) {\n\t\t\treturn this.type - other.type;\n\t\t}\n\t\treturn cmp1(this.key, other.key);\n\t}\n\n\tpublic equals(other: ContextKeyExpression): boolean {\n\t\tif (other.type === this.type) {\n\t\t\treturn (this.key === other.key);\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic substituteConstants(): ContextKeyExpression | undefined {\n\t\tconst constantValue = CONSTANT_VALUES.get(this.key);\n\t\tif (typeof constantValue === 'boolean') {\n\t\t\treturn constantValue ? ContextKeyTrueExpr.INSTANCE : ContextKeyFalseExpr.INSTANCE;\n\t\t}\n\t\treturn this;\n\t}\n\n\tpublic evaluate(context: IContext): boolean {\n\t\treturn (!!context.getValue(this.key));\n\t}\n\n\tpublic serialize(): string {\n\t\treturn this.key;\n\t}\n\n\tpublic keys(): string[] {\n\t\treturn [this.key];\n\t}\n\n\tpublic map(mapFnc: IContextKeyExprMapper): ContextKeyExpression {\n\t\treturn mapFnc.mapDefined(this.key);\n\t}\n\n\tpublic negate(): ContextKeyExpression {\n\t\tif (!this.negated) {\n\t\t\tthis.negated = ContextKeyNotExpr.create(this.key, this);\n\t\t}\n\t\treturn this.negated;\n\t}\n}\n\nexport class ContextKeyEqualsExpr implements IContextKeyExpression {\n\n\tpublic static create(key: string, value: any, negated: ContextKeyExpression | null = null): ContextKeyExpression {\n\t\tif (typeof value === 'boolean') {\n\t\t\treturn (value ? ContextKeyDefinedExpr.create(key, negated) : ContextKeyNotExpr.create(key, negated));\n\t\t}\n\t\tconst constantValue = CONSTANT_VALUES.get(key);\n\t\tif (typeof constantValue === 'boolean') {\n\t\t\tconst trueValue = constantValue ? 'true' : 'false';\n\t\t\treturn (value === trueValue ? ContextKeyTrueExpr.INSTANCE : ContextKeyFalseExpr.INSTANCE);\n\t\t}\n\t\treturn new ContextKeyEqualsExpr(key, value, negated);\n\t}\n\n\tpublic readonly type = ContextKeyExprType.Equals;\n\n\tprivate constructor(\n\t\tprivate readonly key: string,\n\t\tprivate readonly value: any,\n\t\tprivate negated: ContextKeyExpression | null\n\t) {\n\t}\n\n\tpublic cmp(other: ContextKeyExpression): number {\n\t\tif (other.type !== this.type) {\n\t\t\treturn this.type - other.type;\n\t\t}\n\t\treturn cmp2(this.key, this.value, other.key, other.value);\n\t}\n\n\tpublic equals(other: ContextKeyExpression): boolean {\n\t\tif (other.type === this.type) {\n\t\t\treturn (this.key === other.key && this.value === other.value);\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic substituteConstants(): ContextKeyExpression | undefined {\n\t\tconst constantValue = CONSTANT_VALUES.get(this.key);\n\t\tif (typeof constantValue === 'boolean') {\n\t\t\tconst trueValue = constantValue ? 'true' : 'false';\n\t\t\treturn (this.value === trueValue ? ContextKeyTrueExpr.INSTANCE : ContextKeyFalseExpr.INSTANCE);\n\t\t}\n\t\treturn this;\n\t}\n\n\tpublic evaluate(context: IContext): boolean {\n\t\t// Intentional ==\n\t\t// eslint-disable-next-line eqeqeq\n\t\treturn (context.getValue(this.key) == this.value);\n\t}\n\n\tpublic serialize(): string {\n\t\treturn `${this.key} == '${this.value}'`;\n\t}\n\n\tpublic keys(): string[] {\n\t\treturn [this.key];\n\t}\n\n\tpublic map(mapFnc: IContextKeyExprMapper): ContextKeyExpression {\n\t\treturn mapFnc.mapEquals(this.key, this.value);\n\t}\n\n\tpublic negate(): ContextKeyExpression {\n\t\tif (!this.negated) {\n\t\t\tthis.negated = ContextKeyNotEqualsExpr.create(this.key, this.value, this);\n\t\t}\n\t\treturn this.negated;\n\t}\n}\n\nexport class ContextKeyInExpr implements IContextKeyExpression {\n\n\tpublic static create(key: string, valueKey: string): ContextKeyInExpr {\n\t\treturn new ContextKeyInExpr(key, valueKey);\n\t}\n\n\tpublic readonly type = ContextKeyExprType.In;\n\tprivate negated: ContextKeyExpression | null = null;\n\n\tprivate constructor(\n\t\tprivate readonly key: string,\n\t\tprivate readonly valueKey: string,\n\t) {\n\t}\n\n\tpublic cmp(other: ContextKeyExpression): number {\n\t\tif (other.type !== this.type) {\n\t\t\treturn this.type - other.type;\n\t\t}\n\t\treturn cmp2(this.key, this.valueKey, other.key, other.valueKey);\n\t}\n\n\tpublic equals(other: ContextKeyExpression): boolean {\n\t\tif (other.type === this.type) {\n\t\t\treturn (this.key === other.key && this.valueKey === other.valueKey);\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic substituteConstants(): ContextKeyExpression | undefined {\n\t\treturn this;\n\t}\n\n\tpublic evaluate(context: IContext): boolean {\n\t\tconst source = context.getValue(this.valueKey);\n\n\t\tconst item = context.getValue(this.key);\n\n\t\tif (Array.isArray(source)) {\n\t\t\treturn source.includes(item as any);\n\t\t}\n\n\t\tif (typeof item === 'string' && typeof source === 'object' && source !== null) {\n\t\t\treturn hasOwnProperty.call(source, item);\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic serialize(): string {\n\t\treturn `${this.key} in '${this.valueKey}'`;\n\t}\n\n\tpublic keys(): string[] {\n\t\treturn [this.key, this.valueKey];\n\t}\n\n\tpublic map(mapFnc: IContextKeyExprMapper): ContextKeyInExpr {\n\t\treturn mapFnc.mapIn(this.key, this.valueKey);\n\t}\n\n\tpublic negate(): ContextKeyExpression {\n\t\tif (!this.negated) {\n\t\t\tthis.negated = ContextKeyNotInExpr.create(this.key, this.valueKey);\n\t\t}\n\t\treturn this.negated;\n\t}\n}\n\nexport class ContextKeyNotInExpr implements IContextKeyExpression {\n\n\tpublic static create(key: string, valueKey: string): ContextKeyNotInExpr {\n\t\treturn new ContextKeyNotInExpr(key, valueKey);\n\t}\n\n\tpublic readonly type = ContextKeyExprType.NotIn;\n\n\tprivate readonly _negated: ContextKeyInExpr;\n\n\tprivate constructor(\n\t\tprivate readonly key: string,\n\t\tprivate readonly valueKey: string,\n\t) {\n\t\tthis._negated = ContextKeyInExpr.create(key, valueKey);\n\t}\n\n\tpublic cmp(other: ContextKeyExpression): number {\n\t\tif (other.type !== this.type) {\n\t\t\treturn this.type - other.type;\n\t\t}\n\t\treturn this._negated.cmp(other._negated);\n\t}\n\n\tpublic equals(other: ContextKeyExpression): boolean {\n\t\tif (other.type === this.type) {\n\t\t\treturn this._negated.equals(other._negated);\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic substituteConstants(): ContextKeyExpression | undefined {\n\t\treturn this;\n\t}\n\n\tpublic evaluate(context: IContext): boolean {\n\t\treturn !this._negated.evaluate(context);\n\t}\n\n\tpublic serialize(): string {\n\t\treturn `${this.key} not in '${this.valueKey}'`;\n\t}\n\n\tpublic keys(): string[] {\n\t\treturn this._negated.keys();\n\t}\n\n\tpublic map(mapFnc: IContextKeyExprMapper): ContextKeyExpression {\n\t\treturn mapFnc.mapNotIn(this.key, this.valueKey);\n\t}\n\n\tpublic negate(): ContextKeyExpression {\n\t\treturn this._negated;\n\t}\n}\n\nexport class ContextKeyNotEqualsExpr implements IContextKeyExpression {\n\n\tpublic static create(key: string, value: any, negated: ContextKeyExpression | null = null): ContextKeyExpression {\n\t\tif (typeof value === 'boolean') {\n\t\t\tif (value) {\n\t\t\t\treturn ContextKeyNotExpr.create(key, negated);\n\t\t\t}\n\t\t\treturn ContextKeyDefinedExpr.create(key, negated);\n\t\t}\n\t\tconst constantValue = CONSTANT_VALUES.get(key);\n\t\tif (typeof constantValue === 'boolean') {\n\t\t\tconst falseValue = constantValue ? 'true' : 'false';\n\t\t\treturn (value === falseValue ? ContextKeyFalseExpr.INSTANCE : ContextKeyTrueExpr.INSTANCE);\n\t\t}\n\t\treturn new ContextKeyNotEqualsExpr(key, value, negated);\n\t}\n\n\tpublic readonly type = ContextKeyExprType.NotEquals;\n\n\tprivate constructor(\n\t\tprivate readonly key: string,\n\t\tprivate readonly value: any,\n\t\tprivate negated: ContextKeyExpression | null\n\t) {\n\t}\n\n\tpublic cmp(other: ContextKeyExpression): number {\n\t\tif (other.type !== this.type) {\n\t\t\treturn this.type - other.type;\n\t\t}\n\t\treturn cmp2(this.key, this.value, other.key, other.value);\n\t}\n\n\tpublic equals(other: ContextKeyExpression): boolean {\n\t\tif (other.type === this.type) {\n\t\t\treturn (this.key === other.key && this.value === other.value);\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic substituteConstants(): ContextKeyExpression | undefined {\n\t\tconst constantValue = CONSTANT_VALUES.get(this.key);\n\t\tif (typeof constantValue === 'boolean') {\n\t\t\tconst falseValue = constantValue ? 'true' : 'false';\n\t\t\treturn (this.value === falseValue ? ContextKeyFalseExpr.INSTANCE : ContextKeyTrueExpr.INSTANCE);\n\t\t}\n\t\treturn this;\n\t}\n\n\tpublic evaluate(context: IContext): boolean {\n\t\t// Intentional !=\n\t\t// eslint-disable-next-line eqeqeq\n\t\treturn (context.getValue(this.key) != this.value);\n\t}\n\n\tpublic serialize(): string {\n\t\treturn `${this.key} != '${this.value}'`;\n\t}\n\n\tpublic keys(): string[] {\n\t\treturn [this.key];\n\t}\n\n\tpublic map(mapFnc: IContextKeyExprMapper): ContextKeyExpression {\n\t\treturn mapFnc.mapNotEquals(this.key, this.value);\n\t}\n\n\tpublic negate(): ContextKeyExpression {\n\t\tif (!this.negated) {\n\t\t\tthis.negated = ContextKeyEqualsExpr.create(this.key, this.value, this);\n\t\t}\n\t\treturn this.negated;\n\t}\n}\n\nexport class ContextKeyNotExpr implements IContextKeyExpression {\n\n\tpublic static create(key: string, negated: ContextKeyExpression | null = null): ContextKeyExpression {\n\t\tconst constantValue = CONSTANT_VALUES.get(key);\n\t\tif (typeof constantValue === 'boolean') {\n\t\t\treturn (constantValue ? ContextKeyFalseExpr.INSTANCE : ContextKeyTrueExpr.INSTANCE);\n\t\t}\n\t\treturn new ContextKeyNotExpr(key, negated);\n\t}\n\n\tpublic readonly type = ContextKeyExprType.Not;\n\n\tprivate constructor(\n\t\tprivate readonly key: string,\n\t\tprivate negated: ContextKeyExpression | null\n\t) {\n\t}\n\n\tpublic cmp(other: ContextKeyExpression): number {\n\t\tif (other.type !== this.type) {\n\t\t\treturn this.type - other.type;\n\t\t}\n\t\treturn cmp1(this.key, other.key);\n\t}\n\n\tpublic equals(other: ContextKeyExpression): boolean {\n\t\tif (other.type === this.type) {\n\t\t\treturn (this.key === other.key);\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic substituteConstants(): ContextKeyExpression | undefined {\n\t\tconst constantValue = CONSTANT_VALUES.get(this.key);\n\t\tif (typeof constantValue === 'boolean') {\n\t\t\treturn (constantValue ? ContextKeyFalseExpr.INSTANCE : ContextKeyTrueExpr.INSTANCE);\n\t\t}\n\t\treturn this;\n\t}\n\n\tpublic evaluate(context: IContext): boolean {\n\t\treturn (!context.getValue(this.key));\n\t}\n\n\tpublic serialize(): string {\n\t\treturn `!${this.key}`;\n\t}\n\n\tpublic keys(): string[] {\n\t\treturn [this.key];\n\t}\n\n\tpublic map(mapFnc: IContextKeyExprMapper): ContextKeyExpression {\n\t\treturn mapFnc.mapNot(this.key);\n\t}\n\n\tpublic negate(): ContextKeyExpression {\n\t\tif (!this.negated) {\n\t\t\tthis.negated = ContextKeyDefinedExpr.create(this.key, this);\n\t\t}\n\t\treturn this.negated;\n\t}\n}\n\nfunction withFloatOrStr<T extends ContextKeyExpression>(value: any, callback: (value: number | string) => T): T | ContextKeyFalseExpr {\n\tif (typeof value === 'string') {\n\t\tconst n = parseFloat(value);\n\t\tif (!isNaN(n)) {\n\t\t\tvalue = n;\n\t\t}\n\t}\n\tif (typeof value === 'string' || typeof value === 'number') {\n\t\treturn callback(value);\n\t}\n\treturn ContextKeyFalseExpr.INSTANCE;\n}\n\nexport class ContextKeyGreaterExpr implements IContextKeyExpression {\n\n\tpublic static create(key: string, _value: any, negated: ContextKeyExpression | null = null): ContextKeyExpression {\n\t\treturn withFloatOrStr(_value, (value) => new ContextKeyGreaterExpr(key, value, negated));\n\t}\n\n\tpublic readonly type = ContextKeyExprType.Greater;\n\n\tprivate constructor(\n\t\tprivate readonly key: string,\n\t\tprivate readonly value: number | string,\n\t\tprivate negated: ContextKeyExpression | null\n\t) { }\n\n\tpublic cmp(other: ContextKeyExpression): number {\n\t\tif (other.type !== this.type) {\n\t\t\treturn this.type - other.type;\n\t\t}\n\t\treturn cmp2(this.key, this.value, other.key, other.value);\n\t}\n\n\tpublic equals(other: ContextKeyExpression): boolean {\n\t\tif (other.type === this.type) {\n\t\t\treturn (this.key === other.key && this.value === other.value);\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic substituteConstants(): ContextKeyExpression | undefined {\n\t\treturn this;\n\t}\n\n\tpublic evaluate(context: IContext): boolean {\n\t\tif (typeof this.value === 'string') {\n\t\t\treturn false;\n\t\t}\n\t\treturn (parseFloat(<any>context.getValue(this.key)) > this.value);\n\t}\n\n\tpublic serialize(): string {\n\t\treturn `${this.key} > ${this.value}`;\n\t}\n\n\tpublic keys(): string[] {\n\t\treturn [this.key];\n\t}\n\n\tpublic map(mapFnc: IContextKeyExprMapper): ContextKeyExpression {\n\t\treturn mapFnc.mapGreater(this.key, this.value);\n\t}\n\n\tpublic negate(): ContextKeyExpression {\n\t\tif (!this.negated) {\n\t\t\tthis.negated = ContextKeySmallerEqualsExpr.create(this.key, this.value, this);\n\t\t}\n\t\treturn this.negated;\n\t}\n}\n\nexport class ContextKeyGreaterEqualsExpr implements IContextKeyExpression {\n\n\tpublic static create(key: string, _value: any, negated: ContextKeyExpression | null = null): ContextKeyExpression {\n\t\treturn withFloatOrStr(_value, (value) => new ContextKeyGreaterEqualsExpr(key, value, negated));\n\t}\n\n\tpublic readonly type = ContextKeyExprType.GreaterEquals;\n\n\tprivate constructor(\n\t\tprivate readonly key: string,\n\t\tprivate readonly value: number | string,\n\t\tprivate negated: ContextKeyExpression | null\n\t) { }\n\n\tpublic cmp(other: ContextKeyExpression): number {\n\t\tif (other.type !== this.type) {\n\t\t\treturn this.type - other.type;\n\t\t}\n\t\treturn cmp2(this.key, this.value, other.key, other.value);\n\t}\n\n\tpublic equals(other: ContextKeyExpression): boolean {\n\t\tif (other.type === this.type) {\n\t\t\treturn (this.key === other.key && this.value === other.value);\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic substituteConstants(): ContextKeyExpression | undefined {\n\t\treturn this;\n\t}\n\n\tpublic evaluate(context: IContext): boolean {\n\t\tif (typeof this.value === 'string') {\n\t\t\treturn false;\n\t\t}\n\t\treturn (parseFloat(<any>context.getValue(this.key)) >= this.value);\n\t}\n\n\tpublic serialize(): string {\n\t\treturn `${this.key} >= ${this.value}`;\n\t}\n\n\tpublic keys(): string[] {\n\t\treturn [this.key];\n\t}\n\n\tpublic map(mapFnc: IContextKeyExprMapper): ContextKeyExpression {\n\t\treturn mapFnc.mapGreaterEquals(this.key, this.value);\n\t}\n\n\tpublic negate(): ContextKeyExpression {\n\t\tif (!this.negated) {\n\t\t\tthis.negated = ContextKeySmallerExpr.create(this.key, this.value, this);\n\t\t}\n\t\treturn this.negated;\n\t}\n}\n\nexport class ContextKeySmallerExpr implements IContextKeyExpression {\n\n\tpublic static create(key: string, _value: any, negated: ContextKeyExpression | null = null): ContextKeyExpression {\n\t\treturn withFloatOrStr(_value, (value) => new ContextKeySmallerExpr(key, value, negated));\n\t}\n\n\tpublic readonly type = ContextKeyExprType.Smaller;\n\n\tprivate constructor(\n\t\tprivate readonly key: string,\n\t\tprivate readonly value: number | string,\n\t\tprivate negated: ContextKeyExpression | null\n\t) {\n\t}\n\n\tpublic cmp(other: ContextKeyExpression): number {\n\t\tif (other.type !== this.type) {\n\t\t\treturn this.type - other.type;\n\t\t}\n\t\treturn cmp2(this.key, this.value, other.key, other.value);\n\t}\n\n\tpublic equals(other: ContextKeyExpression): boolean {\n\t\tif (other.type === this.type) {\n\t\t\treturn (this.key === other.key && this.value === other.value);\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic substituteConstants(): ContextKeyExpression | undefined {\n\t\treturn this;\n\t}\n\n\tpublic evaluate(context: IContext): boolean {\n\t\tif (typeof this.value === 'string') {\n\t\t\treturn false;\n\t\t}\n\t\treturn (parseFloat(<any>context.getValue(this.key)) < this.value);\n\t}\n\n\tpublic serialize(): string {\n\t\treturn `${this.key} < ${this.value}`;\n\t}\n\n\tpublic keys(): string[] {\n\t\treturn [this.key];\n\t}\n\n\tpublic map(mapFnc: IContextKeyExprMapper): ContextKeyExpression {\n\t\treturn mapFnc.mapSmaller(this.key, this.value);\n\t}\n\n\tpublic negate(): ContextKeyExpression {\n\t\tif (!this.negated) {\n\t\t\tthis.negated = ContextKeyGreaterEqualsExpr.create(this.key, this.value, this);\n\t\t}\n\t\treturn this.negated;\n\t}\n}\n\nexport class ContextKeySmallerEqualsExpr implements IContextKeyExpression {\n\n\tpublic static create(key: string, _value: any, negated: ContextKeyExpression | null = null): ContextKeyExpression {\n\t\treturn withFloatOrStr(_value, (value) => new ContextKeySmallerEqualsExpr(key, value, negated));\n\t}\n\n\tpublic readonly type = ContextKeyExprType.SmallerEquals;\n\n\tprivate constructor(\n\t\tprivate readonly key: string,\n\t\tprivate readonly value: number | string,\n\t\tprivate negated: ContextKeyExpression | null\n\t) {\n\t}\n\n\tpublic cmp(other: ContextKeyExpression): number {\n\t\tif (other.type !== this.type) {\n\t\t\treturn this.type - other.type;\n\t\t}\n\t\treturn cmp2(this.key, this.value, other.key, other.value);\n\t}\n\n\tpublic equals(other: ContextKeyExpression): boolean {\n\t\tif (other.type === this.type) {\n\t\t\treturn (this.key === other.key && this.value === other.value);\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic substituteConstants(): ContextKeyExpression | undefined {\n\t\treturn this;\n\t}\n\n\tpublic evaluate(context: IContext): boolean {\n\t\tif (typeof this.value === 'string') {\n\t\t\treturn false;\n\t\t}\n\t\treturn (parseFloat(<any>context.getValue(this.key)) <= this.value);\n\t}\n\n\tpublic serialize(): string {\n\t\treturn `${this.key} <= ${this.value}`;\n\t}\n\n\tpublic keys(): string[] {\n\t\treturn [this.key];\n\t}\n\n\tpublic map(mapFnc: IContextKeyExprMapper): ContextKeyExpression {\n\t\treturn mapFnc.mapSmallerEquals(this.key, this.value);\n\t}\n\n\tpublic negate(): ContextKeyExpression {\n\t\tif (!this.negated) {\n\t\t\tthis.negated = ContextKeyGreaterExpr.create(this.key, this.value, this);\n\t\t}\n\t\treturn this.negated;\n\t}\n}\n\nexport class ContextKeyRegexExpr implements IContextKeyExpression {\n\n\tpublic static create(key: string, regexp: RegExp | null): ContextKeyRegexExpr {\n\t\treturn new ContextKeyRegexExpr(key, regexp);\n\t}\n\n\tpublic readonly type = ContextKeyExprType.Regex;\n\tprivate negated: ContextKeyExpression | null = null;\n\n\tprivate constructor(\n\t\tprivate readonly key: string,\n\t\tprivate readonly regexp: RegExp | null\n\t) {\n\t\t//\n\t}\n\n\tpublic cmp(other: ContextKeyExpression): number {\n\t\tif (other.type !== this.type) {\n\t\t\treturn this.type - other.type;\n\t\t}\n\t\tif (this.key < other.key) {\n\t\t\treturn -1;\n\t\t}\n\t\tif (this.key > other.key) {\n\t\t\treturn 1;\n\t\t}\n\t\tconst thisSource = this.regexp ? this.regexp.source : '';\n\t\tconst otherSource = other.regexp ? other.regexp.source : '';\n\t\tif (thisSource < otherSource) {\n\t\t\treturn -1;\n\t\t}\n\t\tif (thisSource > otherSource) {\n\t\t\treturn 1;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tpublic equals(other: ContextKeyExpression): boolean {\n\t\tif (other.type === this.type) {\n\t\t\tconst thisSource = this.regexp ? this.regexp.source : '';\n\t\t\tconst otherSource = other.regexp ? other.regexp.source : '';\n\t\t\treturn (this.key === other.key && thisSource === otherSource);\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic substituteConstants(): ContextKeyExpression | undefined {\n\t\treturn this;\n\t}\n\n\tpublic evaluate(context: IContext): boolean {\n\t\tconst value = context.getValue<any>(this.key);\n\t\treturn this.regexp ? this.regexp.test(value) : false;\n\t}\n\n\tpublic serialize(): string {\n\t\tconst value = this.regexp\n\t\t\t? `/${this.regexp.source}/${this.regexp.ignoreCase ? 'i' : ''}`\n\t\t\t: '/invalid/';\n\t\treturn `${this.key} =~ ${value}`;\n\t}\n\n\tpublic keys(): string[] {\n\t\treturn [this.key];\n\t}\n\n\tpublic map(mapFnc: IContextKeyExprMapper): ContextKeyRegexExpr {\n\t\treturn mapFnc.mapRegex(this.key, this.regexp);\n\t}\n\n\tpublic negate(): ContextKeyExpression {\n\t\tif (!this.negated) {\n\t\t\tthis.negated = ContextKeyNotRegexExpr.create(this);\n\t\t}\n\t\treturn this.negated;\n\t}\n}\n\nexport class ContextKeyNotRegexExpr implements IContextKeyExpression {\n\n\tpublic static create(actual: ContextKeyRegexExpr): ContextKeyExpression {\n\t\treturn new ContextKeyNotRegexExpr(actual);\n\t}\n\n\tpublic readonly type = ContextKeyExprType.NotRegex;\n\n\tprivate constructor(private readonly _actual: ContextKeyRegexExpr) {\n\t\t//\n\t}\n\n\tpublic cmp(other: ContextKeyExpression): number {\n\t\tif (other.type !== this.type) {\n\t\t\treturn this.type - other.type;\n\t\t}\n\t\treturn this._actual.cmp(other._actual);\n\t}\n\n\tpublic equals(other: ContextKeyExpression): boolean {\n\t\tif (other.type === this.type) {\n\t\t\treturn this._actual.equals(other._actual);\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic substituteConstants(): ContextKeyExpression | undefined {\n\t\treturn this;\n\t}\n\n\tpublic evaluate(context: IContext): boolean {\n\t\treturn !this._actual.evaluate(context);\n\t}\n\n\tpublic serialize(): string {\n\t\tthrow new Error('Method not implemented.');\n\t}\n\n\tpublic keys(): string[] {\n\t\treturn this._actual.keys();\n\t}\n\n\tpublic map(mapFnc: IContextKeyExprMapper): ContextKeyExpression {\n\t\treturn new ContextKeyNotRegexExpr(this._actual.map(mapFnc));\n\t}\n\n\tpublic negate(): ContextKeyExpression {\n\t\treturn this._actual;\n\t}\n}\n\n/**\n * @returns the same instance if nothing changed.\n */\nfunction eliminateConstantsInArray(arr: ContextKeyExpression[]): (ContextKeyExpression | undefined)[] {\n\t// Allocate array only if there is a difference\n\tlet newArr: (ContextKeyExpression | undefined)[] | null = null;\n\tfor (let i = 0, len = arr.length; i < len; i++) {\n\t\tconst newExpr = arr[i].substituteConstants();\n\n\t\tif (arr[i] !== newExpr) {\n\t\t\t// something has changed!\n\n\t\t\t// allocate array on first difference\n\t\t\tif (newArr === null) {\n\t\t\t\tnewArr = [];\n\t\t\t\tfor (let j = 0; j < i; j++) {\n\t\t\t\t\tnewArr[j] = arr[j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (newArr !== null) {\n\t\t\tnewArr[i] = newExpr;\n\t\t}\n\t}\n\n\tif (newArr === null) {\n\t\treturn arr;\n\t}\n\treturn newArr;\n}\n\nclass ContextKeyAndExpr implements IContextKeyExpression {\n\n\tpublic static create(_expr: ReadonlyArray<ContextKeyExpression | null | undefined>, negated: ContextKeyExpression | null): ContextKeyExpression | undefined {\n\t\treturn ContextKeyAndExpr._normalizeArr(_expr, negated);\n\t}\n\n\tpublic readonly type = ContextKeyExprType.And;\n\n\tprivate constructor(\n\t\tpublic readonly expr: ContextKeyExpression[],\n\t\tprivate negated: ContextKeyExpression | null\n\t) {\n\t}\n\n\tpublic cmp(other: ContextKeyExpression): number {\n\t\tif (other.type !== this.type) {\n\t\t\treturn this.type - other.type;\n\t\t}\n\t\tif (this.expr.length < other.expr.length) {\n\t\t\treturn -1;\n\t\t}\n\t\tif (this.expr.length > other.expr.length) {\n\t\t\treturn 1;\n\t\t}\n\t\tfor (let i = 0, len = this.expr.length; i < len; i++) {\n\t\t\tconst r = cmp(this.expr[i], other.expr[i]);\n\t\t\tif (r !== 0) {\n\t\t\t\treturn r;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tpublic equals(other: ContextKeyExpression): boolean {\n\t\tif (other.type === this.type) {\n\t\t\tif (this.expr.length !== other.expr.length) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tfor (let i = 0, len = this.expr.length; i < len; i++) {\n\t\t\t\tif (!this.expr[i].equals(other.expr[i])) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic substituteConstants(): ContextKeyExpression | undefined {\n\t\tconst exprArr = eliminateConstantsInArray(this.expr);\n\t\tif (exprArr === this.expr) {\n\t\t\t// no change\n\t\t\treturn this;\n\t\t}\n\t\treturn ContextKeyAndExpr.create(exprArr, this.negated);\n\t}\n\n\tpublic evaluate(context: IContext): boolean {\n\t\tfor (let i = 0, len = this.expr.length; i < len; i++) {\n\t\t\tif (!this.expr[i].evaluate(context)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tprivate static _normalizeArr(arr: ReadonlyArray<ContextKeyExpression | null | undefined>, negated: ContextKeyExpression | null): ContextKeyExpression | undefined {\n\t\tconst expr: ContextKeyExpression[] = [];\n\t\tlet hasTrue = false;\n\n\t\tfor (const e of arr) {\n\t\t\tif (!e) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (e.type === ContextKeyExprType.True) {\n\t\t\t\t// anything && true ==> anything\n\t\t\t\thasTrue = true;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (e.type === ContextKeyExprType.False) {\n\t\t\t\t// anything && false ==> false\n\t\t\t\treturn ContextKeyFalseExpr.INSTANCE;\n\t\t\t}\n\n\t\t\tif (e.type === ContextKeyExprType.And) {\n\t\t\t\texpr.push(...e.expr);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\texpr.push(e);\n\t\t}\n\n\t\tif (expr.length === 0 && hasTrue) {\n\t\t\treturn ContextKeyTrueExpr.INSTANCE;\n\t\t}\n\n\t\tif (expr.length === 0) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (expr.length === 1) {\n\t\t\treturn expr[0];\n\t\t}\n\n\t\texpr.sort(cmp);\n\n\t\t// eliminate duplicate terms\n\t\tfor (let i = 1; i < expr.length; i++) {\n\t\t\tif (expr[i - 1].equals(expr[i])) {\n\t\t\t\texpr.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\n\t\tif (expr.length === 1) {\n\t\t\treturn expr[0];\n\t\t}\n\n\t\t// We must distribute any OR expression because we don't support parens\n\t\t// OR extensions will be at the end (due to sorting rules)\n\t\twhile (expr.length > 1) {\n\t\t\tconst lastElement = expr[expr.length - 1];\n\t\t\tif (lastElement.type !== ContextKeyExprType.Or) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t// pop the last element\n\t\t\texpr.pop();\n\n\t\t\t// pop the second to last element\n\t\t\tconst secondToLastElement = expr.pop()!;\n\n\t\t\tconst isFinished = (expr.length === 0);\n\n\t\t\t// distribute `lastElement` over `secondToLastElement`\n\t\t\tconst resultElement = ContextKeyOrExpr.create(\n\t\t\t\tlastElement.expr.map(el => ContextKeyAndExpr.create([el, secondToLastElement], null)),\n\t\t\t\tnull,\n\t\t\t\tisFinished\n\t\t\t);\n\n\t\t\tif (resultElement) {\n\t\t\t\texpr.push(resultElement);\n\t\t\t\texpr.sort(cmp);\n\t\t\t}\n\t\t}\n\n\t\tif (expr.length === 1) {\n\t\t\treturn expr[0];\n\t\t}\n\n\t\treturn new ContextKeyAndExpr(expr, negated);\n\t}\n\n\tpublic serialize(): string {\n\t\treturn this.expr.map(e => e.serialize()).join(' && ');\n\t}\n\n\tpublic keys(): string[] {\n\t\tconst result: string[] = [];\n\t\tfor (const expr of this.expr) {\n\t\t\tresult.push(...expr.keys());\n\t\t}\n\t\treturn result;\n\t}\n\n\tpublic map(mapFnc: IContextKeyExprMapper): ContextKeyExpression {\n\t\treturn new ContextKeyAndExpr(this.expr.map(expr => expr.map(mapFnc)), null);\n\t}\n\n\tpublic negate(): ContextKeyExpression {\n\t\tif (!this.negated) {\n\t\t\tconst result: ContextKeyExpression[] = [];\n\t\t\tfor (const expr of this.expr) {\n\t\t\t\tresult.push(expr.negate());\n\t\t\t}\n\t\t\tthis.negated = ContextKeyOrExpr.create(result, this, true)!;\n\t\t}\n\t\treturn this.negated;\n\t}\n}\n\nclass ContextKeyOrExpr implements IContextKeyExpression {\n\n\tpublic static create(_expr: ReadonlyArray<ContextKeyExpression | null | undefined>, negated: ContextKeyExpression | null, extraRedundantCheck: boolean): ContextKeyExpression | undefined {\n\t\treturn ContextKeyOrExpr._normalizeArr(_expr, negated, extraRedundantCheck);\n\t}\n\n\tpublic readonly type = ContextKeyExprType.Or;\n\n\tprivate constructor(\n\t\tpublic readonly expr: ContextKeyExpression[],\n\t\tprivate negated: ContextKeyExpression | null\n\t) {\n\t}\n\n\tpublic cmp(other: ContextKeyExpression): number {\n\t\tif (other.type !== this.type) {\n\t\t\treturn this.type - other.type;\n\t\t}\n\t\tif (this.expr.length < other.expr.length) {\n\t\t\treturn -1;\n\t\t}\n\t\tif (this.expr.length > other.expr.length) {\n\t\t\treturn 1;\n\t\t}\n\t\tfor (let i = 0, len = this.expr.length; i < len; i++) {\n\t\t\tconst r = cmp(this.expr[i], other.expr[i]);\n\t\t\tif (r !== 0) {\n\t\t\t\treturn r;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tpublic equals(other: ContextKeyExpression): boolean {\n\t\tif (other.type === this.type) {\n\t\t\tif (this.expr.length !== other.expr.length) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tfor (let i = 0, len = this.expr.length; i < len; i++) {\n\t\t\t\tif (!this.expr[i].equals(other.expr[i])) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic substituteConstants(): ContextKeyExpression | undefined {\n\t\tconst exprArr = eliminateConstantsInArray(this.expr);\n\t\tif (exprArr === this.expr) {\n\t\t\t// no change\n\t\t\treturn this;\n\t\t}\n\t\treturn ContextKeyOrExpr.create(exprArr, this.negated, false);\n\t}\n\n\tpublic evaluate(context: IContext): boolean {\n\t\tfor (let i = 0, len = this.expr.length; i < len; i++) {\n\t\t\tif (this.expr[i].evaluate(context)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate static _normalizeArr(arr: ReadonlyArray<ContextKeyExpression | null | undefined>, negated: ContextKeyExpression | null, extraRedundantCheck: boolean): ContextKeyExpression | undefined {\n\t\tlet expr: ContextKeyExpression[] = [];\n\t\tlet hasFalse = false;\n\n\t\tif (arr) {\n\t\t\tfor (let i = 0, len = arr.length; i < len; i++) {\n\t\t\t\tconst e = arr[i];\n\t\t\t\tif (!e) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (e.type === ContextKeyExprType.False) {\n\t\t\t\t\t// anything || false ==> anything\n\t\t\t\t\thasFalse = true;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (e.type === ContextKeyExprType.True) {\n\t\t\t\t\t// anything || true ==> true\n\t\t\t\t\treturn ContextKeyTrueExpr.INSTANCE;\n\t\t\t\t}\n\n\t\t\t\tif (e.type === ContextKeyExprType.Or) {\n\t\t\t\t\texpr = expr.concat(e.expr);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\texpr.push(e);\n\t\t\t}\n\n\t\t\tif (expr.length === 0 && hasFalse) {\n\t\t\t\treturn ContextKeyFalseExpr.INSTANCE;\n\t\t\t}\n\n\t\t\texpr.sort(cmp);\n\t\t}\n\n\t\tif (expr.length === 0) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (expr.length === 1) {\n\t\t\treturn expr[0];\n\t\t}\n\n\t\t// eliminate duplicate terms\n\t\tfor (let i = 1; i < expr.length; i++) {\n\t\t\tif (expr[i - 1].equals(expr[i])) {\n\t\t\t\texpr.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\n\t\tif (expr.length === 1) {\n\t\t\treturn expr[0];\n\t\t}\n\n\t\t// eliminate redundant terms\n\t\tif (extraRedundantCheck) {\n\t\t\tfor (let i = 0; i < expr.length; i++) {\n\t\t\t\tfor (let j = i + 1; j < expr.length; j++) {\n\t\t\t\t\tif (implies(expr[i], expr[j])) {\n\t\t\t\t\t\texpr.splice(j, 1);\n\t\t\t\t\t\tj--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (expr.length === 1) {\n\t\t\t\treturn expr[0];\n\t\t\t}\n\t\t}\n\n\t\treturn new ContextKeyOrExpr(expr, negated);\n\t}\n\n\tpublic serialize(): string {\n\t\treturn this.expr.map(e => e.serialize()).join(' || ');\n\t}\n\n\tpublic keys(): string[] {\n\t\tconst result: string[] = [];\n\t\tfor (const expr of this.expr) {\n\t\t\tresult.push(...expr.keys());\n\t\t}\n\t\treturn result;\n\t}\n\n\tpublic map(mapFnc: IContextKeyExprMapper): ContextKeyExpression {\n\t\treturn new ContextKeyOrExpr(this.expr.map(expr => expr.map(mapFnc)), null);\n\t}\n\n\tpublic negate(): ContextKeyExpression {\n\t\tif (!this.negated) {\n\t\t\tconst result: ContextKeyExpression[] = [];\n\t\t\tfor (const expr of this.expr) {\n\t\t\t\tresult.push(expr.negate());\n\t\t\t}\n\n\t\t\t// We don't support parens, so here we distribute the AND over the OR terminals\n\t\t\t// We always take the first 2 AND pairs and distribute them\n\t\t\twhile (result.length > 1) {\n\t\t\t\tconst LEFT = result.shift()!;\n\t\t\t\tconst RIGHT = result.shift()!;\n\n\t\t\t\tconst all: ContextKeyExpression[] = [];\n\t\t\t\tfor (const left of getTerminals(LEFT)) {\n\t\t\t\t\tfor (const right of getTerminals(RIGHT)) {\n\t\t\t\t\t\tall.push(ContextKeyAndExpr.create([left, right], null)!);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst isFinished = (result.length === 0);\n\t\t\t\tresult.unshift(ContextKeyOrExpr.create(all, null, isFinished)!);\n\t\t\t}\n\n\t\t\tthis.negated = result[0];\n\t\t}\n\t\treturn this.negated;\n\t}\n}\n\nexport interface ContextKeyInfo {\n\treadonly key: string;\n\treadonly type?: string;\n\treadonly description?: string;\n}\n\nexport class RawContextKey<T extends ContextKeyValue> extends ContextKeyDefinedExpr {\n\n\tprivate static _info: ContextKeyInfo[] = [];\n\n\tstatic all(): IterableIterator<ContextKeyInfo> {\n\t\treturn RawContextKey._info.values();\n\t}\n\n\tprivate readonly _defaultValue: T | undefined;\n\n\tconstructor(key: string, defaultValue: T | undefined, metaOrHide?: string | true | { type: string; description: string }) {\n\t\tsuper(key, null);\n\t\tthis._defaultValue = defaultValue;\n\n\t\t// collect all context keys into a central place\n\t\tif (typeof metaOrHide === 'object') {\n\t\t\tRawContextKey._info.push({ ...metaOrHide, key });\n\t\t} else if (metaOrHide !== true) {\n\t\t\tRawContextKey._info.push({ key, description: metaOrHide, type: defaultValue !== null && defaultValue !== undefined ? typeof defaultValue : undefined });\n\t\t}\n\t}\n\n\tpublic bindTo(target: IContextKeyService): IContextKey<T> {\n\t\treturn target.createKey(this.key, this._defaultValue);\n\t}\n\n\tpublic getValue(target: IContextKeyService): T | undefined {\n\t\treturn target.getContextKeyValue<T>(this.key);\n\t}\n\n\tpublic toNegated(): ContextKeyExpression {\n\t\treturn this.negate();\n\t}\n\n\tpublic isEqualTo(value: any): ContextKeyExpression {\n\t\treturn ContextKeyEqualsExpr.create(this.key, value);\n\t}\n\n\tpublic notEqualsTo(value: any): ContextKeyExpression {\n\t\treturn ContextKeyNotEqualsExpr.create(this.key, value);\n\t}\n}\n\nexport type ContextKeyValue = null | undefined | boolean | number | string\n\t| Array<null | undefined | boolean | number | string>\n\t| Record<string, null | undefined | boolean | number | string>;\n\nexport interface IContext {\n\tgetValue<T extends ContextKeyValue = ContextKeyValue>(key: string): T | undefined;\n}\n\nexport interface IContextKey<T extends ContextKeyValue = ContextKeyValue> {\n\tset(value: T): void;\n\treset(): void;\n\tget(): T | undefined;\n}\n\nexport interface IContextKeyServiceTarget {\n\tparentElement: IContextKeyServiceTarget | null;\n\tsetAttribute(attr: string, value: string): void;\n\tremoveAttribute(attr: string): void;\n\thasAttribute(attr: string): boolean;\n\tgetAttribute(attr: string): string | null;\n}\n\nexport const IContextKeyService = createDecorator<IContextKeyService>('contextKeyService');\n\nexport interface IReadableSet<T> {\n\thas(value: T): boolean;\n}\n\nexport interface IContextKeyChangeEvent {\n\taffectsSome(keys: IReadableSet<string>): boolean;\n\tallKeysContainedIn(keys: IReadableSet<string>): boolean;\n}\n\nexport interface IContextKeyService {\n\treadonly _serviceBrand: undefined;\n\tdispose(): void;\n\n\tonDidChangeContext: Event<IContextKeyChangeEvent>;\n\tbufferChangeEvents(callback: Function): void;\n\n\tcreateKey<T extends ContextKeyValue>(key: string, defaultValue: T | undefined): IContextKey<T>;\n\tcontextMatchesRules(rules: ContextKeyExpression | undefined): boolean;\n\tgetContextKeyValue<T>(key: string): T | undefined;\n\n\tcreateScoped(target: IContextKeyServiceTarget): IContextKeyService;\n\tcreateOverlay(overlay: Iterable<[string, any]>): IContextKeyService;\n\tgetContext(target: IContextKeyServiceTarget | null): IContext;\n\n\tupdateParent(parentContextKeyService: IContextKeyService): void;\n}\n\nexport const SET_CONTEXT_COMMAND_ID = 'setContext';\n\nfunction cmp1(key1: string, key2: string): number {\n\tif (key1 < key2) {\n\t\treturn -1;\n\t}\n\tif (key1 > key2) {\n\t\treturn 1;\n\t}\n\treturn 0;\n}\n\nfunction cmp2(key1: string, value1: any, key2: string, value2: any): number {\n\tif (key1 < key2) {\n\t\treturn -1;\n\t}\n\tif (key1 > key2) {\n\t\treturn 1;\n\t}\n\tif (value1 < value2) {\n\t\treturn -1;\n\t}\n\tif (value1 > value2) {\n\t\treturn 1;\n\t}\n\treturn 0;\n}\n\n/**\n * Returns true if it is provable `p` implies `q`.\n */\nexport function implies(p: ContextKeyExpression, q: ContextKeyExpression): boolean {\n\n\tif (q.type === ContextKeyExprType.And && (p.type !== ContextKeyExprType.Or && p.type !== ContextKeyExprType.And)) {\n\t\t// covers the case: A implies A && B\n\t\tfor (const qTerm of q.expr) {\n\t\t\tif (p.equals(qTerm)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\n\tconst notP = p.negate();\n\tconst expr = getTerminals(notP).concat(getTerminals(q));\n\texpr.sort(cmp);\n\n\tfor (let i = 0; i < expr.length; i++) {\n\t\tconst a = expr[i];\n\t\tconst notA = a.negate();\n\t\tfor (let j = i + 1; j < expr.length; j++) {\n\t\t\tconst b = expr[j];\n\t\t\tif (notA.equals(b)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn false;\n}\n\nfunction getTerminals(node: ContextKeyExpression) {\n\tif (node.type === ContextKeyExprType.Or) {\n\t\treturn node.expr;\n\t}\n\treturn [node];\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { URI } from 'vs/base/common/uri';\nimport { NativeParsedArgs } from 'vs/platform/environment/common/argv';\nimport { createDecorator, refineServiceDecorator } from 'vs/platform/instantiation/common/instantiation';\n\nexport const IEnvironmentService = createDecorator<IEnvironmentService>('environmentService');\nexport const INativeEnvironmentService = refineServiceDecorator<IEnvironmentService, INativeEnvironmentService>(IEnvironmentService);\n\nexport interface IDebugParams {\n\tport: number | null;\n\tbreak: boolean;\n}\n\nexport interface IExtensionHostDebugParams extends IDebugParams {\n\tdebugId?: string;\n\tenv?: Record<string, string>;\n}\n\n/**\n * Type of extension.\n *\n * **NOTE**: This is defined in `platform/environment` because it can appear as a CLI argument.\n */\nexport type ExtensionKind = 'ui' | 'workspace' | 'web';\n\n/**\n * A basic environment service that can be used in various processes,\n * such as main, renderer and shared process. Use subclasses of this\n * service for specific environment.\n */\nexport interface IEnvironmentService {\n\n\treadonly _serviceBrand: undefined;\n\n\t// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n\t//\n\t// NOTE: KEEP THIS INTERFACE AS SMALL AS POSSIBLE.\n\t//\n\t// AS SUCH:\n\t//   - PUT NON-WEB PROPERTIES INTO NATIVE ENVIRONMENT SERVICE\n\t//   - PUT WORKBENCH ONLY PROPERTIES INTO WORKBENCH ENVIRONMENT SERVICE\n\t//   - PUT ELECTRON-MAIN ONLY PROPERTIES INTO MAIN ENVIRONMENT SERVICE\n\t//\n\t// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n\n\t// --- user roaming data\n\tstateResource: URI;\n\tuserRoamingDataHome: URI;\n\tkeyboardLayoutResource: URI;\n\targvResource: URI;\n\n\t// --- data paths\n\tuntitledWorkspacesHome: URI;\n\tworkspaceStorageHome: URI;\n\tlocalHistoryHome: URI;\n\tcacheHome: URI;\n\n\t// --- settings sync\n\tuserDataSyncHome: URI;\n\tuserDataSyncLogResource: URI;\n\tsync: 'on' | 'off' | undefined;\n\n\t// --- continue edit session\n\teditSessionId?: string;\n\teditSessionsLogResource: URI;\n\n\t// --- extension development\n\tdebugExtensionHost: IExtensionHostDebugParams;\n\tisExtensionDevelopment: boolean;\n\tdisableExtensions: boolean | string[];\n\tenableExtensions?: readonly string[];\n\textensionDevelopmentLocationURI?: URI[];\n\textensionDevelopmentKind?: ExtensionKind[];\n\textensionTestsLocationURI?: URI;\n\n\t// --- logging\n\tlogsPath: string;\n\tlogLevel?: string;\n\tverbose: boolean;\n\tisBuilt: boolean;\n\n\t// --- telemetry\n\tdisableTelemetry: boolean;\n\ttelemetryLogResource: URI;\n\tserviceMachineIdResource: URI;\n\n\t// --- Policy\n\tpolicyFile?: URI;\n\n\t// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n\t//\n\t// NOTE: KEEP THIS INTERFACE AS SMALL AS POSSIBLE.\n\t//\n\t// AS SUCH:\n\t//   - PUT NON-WEB PROPERTIES INTO NATIVE ENVIRONMENT SERVICE\n\t//   - PUT WORKBENCH ONLY PROPERTIES INTO WORKBENCH ENVIRONMENT SERVICE\n\t//   - PUT ELECTRON-MAIN ONLY PROPERTIES INTO MAIN ENVIRONMENT SERVICE\n\t//\n\t// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n}\n\n/**\n * A subclass of the `IEnvironmentService` to be used only in native\n * environments (Windows, Linux, macOS) but not e.g. web.\n */\nexport interface INativeEnvironmentService extends IEnvironmentService {\n\n\t// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n\t//\n\t// NOTE: KEEP THIS INTERFACE AS SMALL AS POSSIBLE.\n\t//\n\t// AS SUCH:\n\t//   - PUT WORKBENCH ONLY PROPERTIES INTO WORKBENCH ENVIRONMENT SERVICE\n\t//   - PUT ELECTRON-MAIN ONLY PROPERTIES INTO MAIN ENVIRONMENT SERVICE\n\t//\n\t// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n\n\t// --- CLI Arguments\n\targs: NativeParsedArgs;\n\n\t// --- data paths\n\tappRoot: string;\n\tuserHome: URI;\n\tappSettingsHome: URI;\n\ttmpDir: URI;\n\tuserDataPath: string;\n\tmachineSettingsResource: URI;\n\tinstallSourcePath: string;\n\n\t// --- extensions\n\textensionsPath: string;\n\textensionsDownloadPath: string;\n\tbuiltinExtensionsPath: string;\n\n\t// --- use keytar for credentials\n\tdisableKeytar?: boolean;\n\n\t// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n\t//\n\t// NOTE: KEEP THIS INTERFACE AS SMALL AS POSSIBLE.\n\t//\n\t// AS SUCH:\n\t//   - PUT NON-WEB PROPERTIES INTO NATIVE ENVIRONMENT SERVICE\n\t//   - PUT WORKBENCH ONLY PROPERTIES INTO WORKBENCH ENVIRONMENT SERVICE\n\t//   - PUT ELECTRON-MAIN ONLY PROPERTIES INTO MAIN ENVIRONMENT SERVICE\n\t//\n\t// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { IStringDictionary } from 'vs/base/common/collections';\nimport { Event } from 'vs/base/common/event';\nimport { IPager } from 'vs/base/common/paging';\nimport { Platform } from 'vs/base/common/platform';\nimport { URI } from 'vs/base/common/uri';\nimport { localize } from 'vs/nls';\nimport { ExtensionType, IExtension, IExtensionManifest, TargetPlatform } from 'vs/platform/extensions/common/extensions';\nimport { createDecorator, refineServiceDecorator } from 'vs/platform/instantiation/common/instantiation';\n\nexport const EXTENSION_IDENTIFIER_PATTERN = '^([a-z0-9A-Z][a-z0-9-A-Z]*)\\\\.([a-z0-9A-Z][a-z0-9-A-Z]*)$';\nexport const EXTENSION_IDENTIFIER_REGEX = new RegExp(EXTENSION_IDENTIFIER_PATTERN);\nexport const WEB_EXTENSION_TAG = '__web_extension';\n\nexport function TargetPlatformToString(targetPlatform: TargetPlatform) {\n\tswitch (targetPlatform) {\n\t\tcase TargetPlatform.WIN32_X64: return 'Windows 64 bit';\n\t\tcase TargetPlatform.WIN32_IA32: return 'Windows 32 bit';\n\t\tcase TargetPlatform.WIN32_ARM64: return 'Windows ARM';\n\n\t\tcase TargetPlatform.LINUX_X64: return 'Linux 64 bit';\n\t\tcase TargetPlatform.LINUX_ARM64: return 'Linux ARM 64';\n\t\tcase TargetPlatform.LINUX_ARMHF: return 'Linux ARM';\n\n\t\tcase TargetPlatform.ALPINE_X64: return 'Alpine Linux 64 bit';\n\t\tcase TargetPlatform.ALPINE_ARM64: return 'Alpine ARM 64';\n\n\t\tcase TargetPlatform.DARWIN_X64: return 'Mac';\n\t\tcase TargetPlatform.DARWIN_ARM64: return 'Mac Silicon';\n\n\t\tcase TargetPlatform.WEB: return 'Web';\n\n\t\tcase TargetPlatform.UNIVERSAL: return TargetPlatform.UNIVERSAL;\n\t\tcase TargetPlatform.UNKNOWN: return TargetPlatform.UNKNOWN;\n\t\tcase TargetPlatform.UNDEFINED: return TargetPlatform.UNDEFINED;\n\t}\n}\n\nexport function toTargetPlatform(targetPlatform: string): TargetPlatform {\n\tswitch (targetPlatform) {\n\t\tcase TargetPlatform.WIN32_X64: return TargetPlatform.WIN32_X64;\n\t\tcase TargetPlatform.WIN32_IA32: return TargetPlatform.WIN32_IA32;\n\t\tcase TargetPlatform.WIN32_ARM64: return TargetPlatform.WIN32_ARM64;\n\n\t\tcase TargetPlatform.LINUX_X64: return TargetPlatform.LINUX_X64;\n\t\tcase TargetPlatform.LINUX_ARM64: return TargetPlatform.LINUX_ARM64;\n\t\tcase TargetPlatform.LINUX_ARMHF: return TargetPlatform.LINUX_ARMHF;\n\n\t\tcase TargetPlatform.ALPINE_X64: return TargetPlatform.ALPINE_X64;\n\t\tcase TargetPlatform.ALPINE_ARM64: return TargetPlatform.ALPINE_ARM64;\n\n\t\tcase TargetPlatform.DARWIN_X64: return TargetPlatform.DARWIN_X64;\n\t\tcase TargetPlatform.DARWIN_ARM64: return TargetPlatform.DARWIN_ARM64;\n\n\t\tcase TargetPlatform.WEB: return TargetPlatform.WEB;\n\n\t\tcase TargetPlatform.UNIVERSAL: return TargetPlatform.UNIVERSAL;\n\t\tdefault: return TargetPlatform.UNKNOWN;\n\t}\n}\n\nexport function getTargetPlatform(platform: Platform | 'alpine', arch: string | undefined): TargetPlatform {\n\tswitch (platform) {\n\t\tcase Platform.Windows:\n\t\t\tif (arch === 'x64') {\n\t\t\t\treturn TargetPlatform.WIN32_X64;\n\t\t\t}\n\t\t\tif (arch === 'ia32') {\n\t\t\t\treturn TargetPlatform.WIN32_IA32;\n\t\t\t}\n\t\t\tif (arch === 'arm64') {\n\t\t\t\treturn TargetPlatform.WIN32_ARM64;\n\t\t\t}\n\t\t\treturn TargetPlatform.UNKNOWN;\n\n\t\tcase Platform.Linux:\n\t\t\tif (arch === 'x64') {\n\t\t\t\treturn TargetPlatform.LINUX_X64;\n\t\t\t}\n\t\t\tif (arch === 'arm64') {\n\t\t\t\treturn TargetPlatform.LINUX_ARM64;\n\t\t\t}\n\t\t\tif (arch === 'arm') {\n\t\t\t\treturn TargetPlatform.LINUX_ARMHF;\n\t\t\t}\n\t\t\treturn TargetPlatform.UNKNOWN;\n\n\t\tcase 'alpine':\n\t\t\tif (arch === 'x64') {\n\t\t\t\treturn TargetPlatform.ALPINE_X64;\n\t\t\t}\n\t\t\tif (arch === 'arm64') {\n\t\t\t\treturn TargetPlatform.ALPINE_ARM64;\n\t\t\t}\n\t\t\treturn TargetPlatform.UNKNOWN;\n\n\t\tcase Platform.Mac:\n\t\t\tif (arch === 'x64') {\n\t\t\t\treturn TargetPlatform.DARWIN_X64;\n\t\t\t}\n\t\t\tif (arch === 'arm64') {\n\t\t\t\treturn TargetPlatform.DARWIN_ARM64;\n\t\t\t}\n\t\t\treturn TargetPlatform.UNKNOWN;\n\n\t\tcase Platform.Web: return TargetPlatform.WEB;\n\t}\n}\n\nexport function isNotWebExtensionInWebTargetPlatform(allTargetPlatforms: TargetPlatform[], productTargetPlatform: TargetPlatform): boolean {\n\t// Not a web extension in web target platform\n\treturn productTargetPlatform === TargetPlatform.WEB && !allTargetPlatforms.includes(TargetPlatform.WEB);\n}\n\nexport function isTargetPlatformCompatible(extensionTargetPlatform: TargetPlatform, allTargetPlatforms: TargetPlatform[], productTargetPlatform: TargetPlatform): boolean {\n\t// Not compatible when extension is not a web extension in web target platform\n\tif (isNotWebExtensionInWebTargetPlatform(allTargetPlatforms, productTargetPlatform)) {\n\t\treturn false;\n\t}\n\n\t// Compatible when extension target platform is not defined\n\tif (extensionTargetPlatform === TargetPlatform.UNDEFINED) {\n\t\treturn true;\n\t}\n\n\t// Compatible when extension target platform is universal\n\tif (extensionTargetPlatform === TargetPlatform.UNIVERSAL) {\n\t\treturn true;\n\t}\n\n\t// Not compatible when extension target platform is unknown\n\tif (extensionTargetPlatform === TargetPlatform.UNKNOWN) {\n\t\treturn false;\n\t}\n\n\t// Compatible when extension and product target platforms matches\n\tif (extensionTargetPlatform === productTargetPlatform) {\n\t\treturn true;\n\t}\n\n\t// Fallback\n\tconst fallbackTargetPlatforms = getFallbackTargetPlarforms(productTargetPlatform);\n\treturn fallbackTargetPlatforms.includes(extensionTargetPlatform);\n}\n\nexport function getFallbackTargetPlarforms(targetPlatform: TargetPlatform): TargetPlatform[] {\n\tswitch (targetPlatform) {\n\t\tcase TargetPlatform.WIN32_X64: return [TargetPlatform.WIN32_IA32];\n\t\tcase TargetPlatform.WIN32_ARM64: return [TargetPlatform.WIN32_IA32];\n\t}\n\treturn [];\n}\n\nexport interface IGalleryExtensionProperties {\n\tdependencies?: string[];\n\textensionPack?: string[];\n\tengine?: string;\n\tlocalizedLanguages?: string[];\n\ttargetPlatform: TargetPlatform;\n\tisPreReleaseVersion: boolean;\n}\n\nexport interface IGalleryExtensionAsset {\n\turi: string;\n\tfallbackUri: string;\n}\n\nexport interface IGalleryExtensionAssets {\n\tmanifest: IGalleryExtensionAsset | null;\n\treadme: IGalleryExtensionAsset | null;\n\tchangelog: IGalleryExtensionAsset | null;\n\tlicense: IGalleryExtensionAsset | null;\n\trepository: IGalleryExtensionAsset | null;\n\tdownload: IGalleryExtensionAsset;\n\ticon: IGalleryExtensionAsset | null;\n\tcoreTranslations: [string, IGalleryExtensionAsset][];\n}\n\nexport function isIExtensionIdentifier(thing: any): thing is IExtensionIdentifier {\n\treturn thing\n\t\t&& typeof thing === 'object'\n\t\t&& typeof thing.id === 'string'\n\t\t&& (!thing.uuid || typeof thing.uuid === 'string');\n}\n\nexport interface IExtensionIdentifier {\n\tid: string;\n\tuuid?: string;\n}\n\nexport interface IGalleryExtensionIdentifier extends IExtensionIdentifier {\n\tuuid: string;\n}\n\nexport interface IGalleryExtensionVersion {\n\tversion: string;\n\tdate: string;\n\tisPreReleaseVersion: boolean;\n}\n\nexport interface IGalleryExtension {\n\tname: string;\n\tidentifier: IGalleryExtensionIdentifier;\n\tversion: string;\n\tdisplayName: string;\n\tpublisherId: string;\n\tpublisher: string;\n\tpublisherDisplayName: string;\n\tpublisherDomain?: { link: string; verified: boolean };\n\tpublisherSponsorLink?: string;\n\tdescription: string;\n\tinstallCount: number;\n\trating: number;\n\tratingCount: number;\n\tcategories: readonly string[];\n\ttags: readonly string[];\n\treleaseDate: number;\n\tlastUpdated: number;\n\tpreview: boolean;\n\thasPreReleaseVersion: boolean;\n\thasReleaseVersion: boolean;\n\tallTargetPlatforms: TargetPlatform[];\n\tassets: IGalleryExtensionAssets;\n\tproperties: IGalleryExtensionProperties;\n\ttelemetryData?: any;\n}\n\nexport interface IGalleryMetadata {\n\tid: string;\n\tpublisherId: string;\n\tpublisherDisplayName: string;\n\tisPreReleaseVersion: boolean;\n\ttargetPlatform?: TargetPlatform;\n}\n\nexport type Metadata = Partial<IGalleryMetadata & { isApplicationScoped: boolean; isMachineScoped: boolean; isBuiltin: boolean; isSystem: boolean; updated: boolean; preRelease: boolean; installedTimestamp: number }>;\n\nexport interface ILocalExtension extends IExtension {\n\tisMachineScoped: boolean;\n\tisApplicationScoped: boolean;\n\tpublisherId: string | null;\n\tpublisherDisplayName: string | null;\n\tinstalledTimestamp?: number;\n\tisPreReleaseVersion: boolean;\n\tpreRelease: boolean;\n\tupdated: boolean;\n}\n\nexport const enum SortBy {\n\tNoneOrRelevance = 0,\n\tLastUpdatedDate = 1,\n\tTitle = 2,\n\tPublisherName = 3,\n\tInstallCount = 4,\n\tPublishedDate = 10,\n\tAverageRating = 6,\n\tWeightedRating = 12\n}\n\nexport const enum SortOrder {\n\tDefault = 0,\n\tAscending = 1,\n\tDescending = 2\n}\n\nexport interface IQueryOptions {\n\ttext?: string;\n\tids?: string[];\n\tnames?: string[];\n\tpageSize?: number;\n\tsortBy?: SortBy;\n\tsortOrder?: SortOrder;\n\tsource?: string;\n\tincludePreRelease?: boolean;\n}\n\nexport const enum StatisticType {\n\tInstall = 'install',\n\tUninstall = 'uninstall'\n}\n\nexport interface IDeprecationInfo {\n\treadonly disallowInstall?: boolean;\n\treadonly extension?: {\n\t\treadonly id: string;\n\t\treadonly displayName: string;\n\t\treadonly autoMigrate?: { readonly storage: boolean };\n\t\treadonly preRelease?: boolean;\n\t};\n\treadonly settings?: readonly string[];\n}\n\nexport interface IExtensionsControlManifest {\n\treadonly malicious: IExtensionIdentifier[];\n\treadonly deprecated: IStringDictionary<IDeprecationInfo>;\n}\n\nexport const enum InstallOperation {\n\tNone = 1,\n\tInstall,\n\tUpdate,\n\tMigrate,\n}\n\nexport interface ITranslation {\n\tcontents: { [key: string]: {} };\n}\n\nexport interface IExtensionInfo extends IExtensionIdentifier {\n\tversion?: string;\n\tpreRelease?: boolean;\n\thasPreRelease?: boolean;\n}\n\nexport interface IExtensionQueryOptions {\n\ttargetPlatform?: TargetPlatform;\n\tcompatible?: boolean;\n\tqueryAllVersions?: boolean;\n\tsource?: string;\n}\n\nexport const IExtensionGalleryService = createDecorator<IExtensionGalleryService>('extensionGalleryService');\nexport interface IExtensionGalleryService {\n\treadonly _serviceBrand: undefined;\n\tisEnabled(): boolean;\n\tquery(options: IQueryOptions, token: CancellationToken): Promise<IPager<IGalleryExtension>>;\n\tgetExtensions(extensionInfos: ReadonlyArray<IExtensionInfo>, token: CancellationToken): Promise<IGalleryExtension[]>;\n\tgetExtensions(extensionInfos: ReadonlyArray<IExtensionInfo>, options: IExtensionQueryOptions, token: CancellationToken): Promise<IGalleryExtension[]>;\n\tisExtensionCompatible(extension: IGalleryExtension, includePreRelease: boolean, targetPlatform: TargetPlatform): Promise<boolean>;\n\tgetCompatibleExtension(extension: IGalleryExtension, includePreRelease: boolean, targetPlatform: TargetPlatform): Promise<IGalleryExtension | null>;\n\tgetAllCompatibleVersions(extension: IGalleryExtension, includePreRelease: boolean, targetPlatform: TargetPlatform): Promise<IGalleryExtensionVersion[]>;\n\tdownload(extension: IGalleryExtension, location: URI, operation: InstallOperation): Promise<void>;\n\treportStatistic(publisher: string, name: string, version: string, type: StatisticType): Promise<void>;\n\tgetReadme(extension: IGalleryExtension, token: CancellationToken): Promise<string>;\n\tgetManifest(extension: IGalleryExtension, token: CancellationToken): Promise<IExtensionManifest | null>;\n\tgetChangelog(extension: IGalleryExtension, token: CancellationToken): Promise<string>;\n\tgetCoreTranslation(extension: IGalleryExtension, languageId: string): Promise<ITranslation | null>;\n\tgetExtensionsControlManifest(): Promise<IExtensionsControlManifest>;\n}\n\nexport interface InstallExtensionEvent {\n\tidentifier: IExtensionIdentifier;\n\tsource: URI | IGalleryExtension;\n}\n\nexport interface InstallExtensionResult {\n\treadonly identifier: IExtensionIdentifier;\n\treadonly operation: InstallOperation;\n\treadonly source?: URI | IGalleryExtension;\n\treadonly local?: ILocalExtension;\n\treadonly context?: IStringDictionary<any>;\n}\n\nexport interface UninstallExtensionEvent {\n\tidentifier: IExtensionIdentifier;\n}\n\nexport interface DidUninstallExtensionEvent {\n\treadonly identifier: IExtensionIdentifier;\n\treadonly version?: string;\n\treadonly error?: string;\n}\n\nexport enum ExtensionManagementErrorCode {\n\tUnsupported = 'Unsupported',\n\tDeprecated = 'Deprecated',\n\tMalicious = 'Malicious',\n\tIncompatible = 'Incompatible',\n\tIncompatiblePreRelease = 'IncompatiblePreRelease',\n\tIncompatibleTargetPlatform = 'IncompatibleTargetPlatform',\n\tReleaseVersionNotFound = 'ReleaseVersionNotFound',\n\tInvalid = 'Invalid',\n\tDownload = 'Download',\n\tExtract = 'Extract',\n\tDelete = 'Delete',\n\tRename = 'Rename',\n\tCorruptZip = 'CorruptZip',\n\tIncompleteZip = 'IncompleteZip',\n\tInternal = 'Internal',\n}\n\nexport class ExtensionManagementError extends Error {\n\tconstructor(message: string, readonly code: ExtensionManagementErrorCode) {\n\t\tsuper(message);\n\t\tthis.name = code;\n\t}\n}\n\nexport type InstallOptions = {\n\tisBuiltin?: boolean;\n\tisMachineScoped?: boolean;\n\tdonotIncludePackAndDependencies?: boolean;\n\tinstallGivenVersion?: boolean;\n\tinstallPreReleaseVersion?: boolean;\n\toperation?: InstallOperation;\n\t/**\n\t * Context passed through to InstallExtensionResult\n\t */\n\tcontext?: IStringDictionary<any>;\n};\nexport type InstallVSIXOptions = Omit<InstallOptions, 'installGivenVersion'> & { installOnlyNewlyAddedFromExtensionPack?: boolean };\nexport type UninstallOptions = { readonly donotIncludePack?: boolean; readonly donotCheckDependents?: boolean; readonly versionOnly?: boolean; readonly remove?: boolean };\n\nexport interface IExtensionManagementParticipant {\n\tpostInstall(local: ILocalExtension, source: URI | IGalleryExtension, options: InstallOptions | InstallVSIXOptions, token: CancellationToken): Promise<void>;\n\tpostUninstall(local: ILocalExtension, options: UninstallOptions, token: CancellationToken): Promise<void>;\n}\n\nexport const IExtensionManagementService = createDecorator<IExtensionManagementService>('extensionManagementService');\nexport interface IExtensionManagementService {\n\treadonly _serviceBrand: undefined;\n\n\tonInstallExtension: Event<InstallExtensionEvent>;\n\tonDidInstallExtensions: Event<readonly InstallExtensionResult[]>;\n\tonUninstallExtension: Event<UninstallExtensionEvent>;\n\tonDidUninstallExtension: Event<DidUninstallExtensionEvent>;\n\n\tzip(extension: ILocalExtension): Promise<URI>;\n\tunzip(zipLocation: URI): Promise<IExtensionIdentifier>;\n\tgetManifest(vsix: URI): Promise<IExtensionManifest>;\n\tinstall(vsix: URI, options?: InstallVSIXOptions): Promise<ILocalExtension>;\n\tcanInstall(extension: IGalleryExtension): Promise<boolean>;\n\tinstallFromGallery(extension: IGalleryExtension, options?: InstallOptions): Promise<ILocalExtension>;\n\tuninstall(extension: ILocalExtension, options?: UninstallOptions): Promise<void>;\n\treinstallFromGallery(extension: ILocalExtension): Promise<void>;\n\tgetInstalled(type?: ExtensionType): Promise<ILocalExtension[]>;\n\tgetExtensionsControlManifest(): Promise<IExtensionsControlManifest>;\n\n\tgetMetadata(extension: ILocalExtension): Promise<Metadata | undefined>;\n\tupdateMetadata(local: ILocalExtension, metadata: IGalleryMetadata): Promise<ILocalExtension>;\n\tupdateExtensionScope(local: ILocalExtension, isMachineScoped: boolean): Promise<ILocalExtension>;\n\n\tregisterParticipant(pariticipant: IExtensionManagementParticipant): void;\n\tgetTargetPlatform(): Promise<TargetPlatform>;\n}\n\nexport type ServerInstallExtensionEvent = InstallExtensionEvent & { profileLocation?: URI; applicationScoped?: boolean };\nexport type ServerInstallExtensionResult = InstallExtensionResult & { profileLocation?: URI; applicationScoped?: boolean };\nexport type ServerUninstallExtensionEvent = UninstallExtensionEvent & { profileLocation?: URI; applicationScoped?: boolean };\nexport type ServerDidUninstallExtensionEvent = DidUninstallExtensionEvent & { profileLocation?: URI; applicationScoped?: boolean };\n\nexport type ServerInstallOptions = InstallOptions & { profileLocation?: URI };\nexport type ServerInstallVSIXOptions = InstallVSIXOptions & { profileLocation?: URI };\nexport type ServerUninstallOptions = UninstallOptions & { profileLocation?: URI };\n\nexport const IServerExtensionManagementService = refineServiceDecorator<IExtensionManagementService, IServerExtensionManagementService>(IExtensionManagementService);\nexport interface IServerExtensionManagementService extends IExtensionManagementService {\n\treadonly _serviceBrand: undefined;\n\tonInstallExtension: Event<ServerInstallExtensionEvent>;\n\tonDidInstallExtensions: Event<readonly ServerInstallExtensionResult[]>;\n\tonUninstallExtension: Event<ServerUninstallExtensionEvent>;\n\tonDidUninstallExtension: Event<ServerDidUninstallExtensionEvent>;\n\tgetInstalled(type?: ExtensionType, profileLocation?: URI): Promise<ILocalExtension[]>;\n\tinstall(vsix: URI, options?: ServerInstallVSIXOptions): Promise<ILocalExtension>;\n\tinstallFromGallery(extension: IGalleryExtension, options?: ServerInstallOptions): Promise<ILocalExtension>;\n\tuninstall(extension: ILocalExtension, options?: ServerUninstallOptions): Promise<void>;\n}\n\nexport const DISABLED_EXTENSIONS_STORAGE_PATH = 'extensionsIdentifiers/disabled';\nexport const ENABLED_EXTENSIONS_STORAGE_PATH = 'extensionsIdentifiers/enabled';\nexport const IGlobalExtensionEnablementService = createDecorator<IGlobalExtensionEnablementService>('IGlobalExtensionEnablementService');\n\nexport interface IGlobalExtensionEnablementService {\n\treadonly _serviceBrand: undefined;\n\treadonly onDidChangeEnablement: Event<{ readonly extensions: IExtensionIdentifier[]; readonly source?: string }>;\n\n\tgetDisabledExtensions(): IExtensionIdentifier[];\n\tenableExtension(extension: IExtensionIdentifier, source?: string): Promise<boolean>;\n\tdisableExtension(extension: IExtensionIdentifier, source?: string): Promise<boolean>;\n\n}\n\nexport type IConfigBasedExtensionTip = {\n\treadonly extensionId: string;\n\treadonly extensionName: string;\n\treadonly isExtensionPack: boolean;\n\treadonly configName: string;\n\treadonly important: boolean;\n\treadonly whenNotInstalled?: string[];\n};\n\nexport type IExecutableBasedExtensionTip = {\n\treadonly extensionId: string;\n\treadonly extensionName: string;\n\treadonly isExtensionPack: boolean;\n\treadonly exeName: string;\n\treadonly exeFriendlyName: string;\n\treadonly windowsPath?: string;\n\treadonly whenNotInstalled?: string[];\n};\n\nexport type IWorkspaceTips = { readonly remoteSet: string[]; readonly recommendations: string[] };\n\nexport const IExtensionTipsService = createDecorator<IExtensionTipsService>('IExtensionTipsService');\nexport interface IExtensionTipsService {\n\treadonly _serviceBrand: undefined;\n\n\tgetConfigBasedTips(folder: URI): Promise<IConfigBasedExtensionTip[]>;\n\tgetImportantExecutableBasedTips(): Promise<IExecutableBasedExtensionTip[]>;\n\tgetOtherExecutableBasedTips(): Promise<IExecutableBasedExtensionTip[]>;\n\tgetAllWorkspacesTips(): Promise<IWorkspaceTips[]>;\n}\n\n\nexport const ExtensionsLabel = localize('extensions', \"Extensions\");\nexport const ExtensionsLocalizedLabel = { value: ExtensionsLabel, original: 'Extensions' };\nexport const ExtensionsChannelId = 'extensions';\nexport const PreferencesLabel = localize('preferences', \"Preferences\");\nexport const PreferencesLocalizedLabel = { value: PreferencesLabel, original: 'Preferences' };\n\n\nexport interface CLIOutput {\n\tlog(s: string): void;\n\terror(s: string): void;\n}\n\nexport const IExtensionManagementCLIService = createDecorator<IExtensionManagementCLIService>('IExtensionManagementCLIService');\nexport interface IExtensionManagementCLIService {\n\treadonly _serviceBrand: undefined;\n\n\tlistExtensions(showVersions: boolean, category?: string, output?: CLIOutput): Promise<void>;\n\tinstallExtensions(extensions: (string | URI)[], builtinExtensionIds: string[], installOptions: InstallOptions, force: boolean, output?: CLIOutput): Promise<void>;\n\tuninstallExtensions(extensions: (string | URI)[], force: boolean, output?: CLIOutput): Promise<void>;\n\tlocateExtension(extensions: string[], output?: CLIOutput): Promise<void>;\n}\n\nexport const IDefaultExtensionsProfileInitService = createDecorator<IDefaultExtensionsProfileInitService>('IDefaultExtensionsProfileInitService');\nexport interface IDefaultExtensionsProfileInitService {\n\treadonly _serviceBrand: undefined;\n\tinitialize(): Promise<void>;\n\tuninitialize(): Promise<void>;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { VSBuffer, VSBufferReadable, VSBufferReadableStream } from 'vs/base/common/buffer';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { Event } from 'vs/base/common/event';\nimport { IExpression, IRelativePattern } from 'vs/base/common/glob';\nimport { IDisposable } from 'vs/base/common/lifecycle';\nimport { TernarySearchTree } from 'vs/base/common/map';\nimport { sep } from 'vs/base/common/path';\nimport { ReadableStreamEvents } from 'vs/base/common/stream';\nimport { startsWithIgnoreCase } from 'vs/base/common/strings';\nimport { isNumber } from 'vs/base/common/types';\nimport { URI } from 'vs/base/common/uri';\nimport { localize } from 'vs/nls';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\n\n//#region file service & providers\n\nexport const IFileService = createDecorator<IFileService>('fileService');\n\nexport interface IFileService {\n\n\treadonly _serviceBrand: undefined;\n\n\t/**\n\t * An event that is fired when a file system provider is added or removed\n\t */\n\treadonly onDidChangeFileSystemProviderRegistrations: Event<IFileSystemProviderRegistrationEvent>;\n\n\t/**\n\t * An event that is fired when a registered file system provider changes it's capabilities.\n\t */\n\treadonly onDidChangeFileSystemProviderCapabilities: Event<IFileSystemProviderCapabilitiesChangeEvent>;\n\n\t/**\n\t * An event that is fired when a file system provider is about to be activated. Listeners\n\t * can join this event with a long running promise to help in the activation process.\n\t */\n\treadonly onWillActivateFileSystemProvider: Event<IFileSystemProviderActivationEvent>;\n\n\t/**\n\t * Registers a file system provider for a certain scheme.\n\t */\n\tregisterProvider(scheme: string, provider: IFileSystemProvider): IDisposable;\n\n\t/**\n\t * Returns a file system provider for a certain scheme.\n\t */\n\tgetProvider(scheme: string): IFileSystemProvider | undefined;\n\n\t/**\n\t * Tries to activate a provider with the given scheme.\n\t */\n\tactivateProvider(scheme: string): Promise<void>;\n\n\t/**\n\t * Checks if this file service can handle the given resource by\n\t * first activating any extension that wants to be activated\n\t * on the provided resource scheme to include extensions that\n\t * contribute file system providers for the given resource.\n\t */\n\tcanHandleResource(resource: URI): Promise<boolean>;\n\n\t/**\n\t * Checks if the file service has a registered provider for the\n\t * provided resource.\n\t *\n\t * Note: this does NOT account for contributed providers from\n\t * extensions that have not been activated yet. To include those,\n\t * consider to call `await fileService.canHandleResource(resource)`.\n\t */\n\thasProvider(resource: URI): boolean;\n\n\t/**\n\t * Checks if the provider for the provided resource has the provided file system capability.\n\t */\n\thasCapability(resource: URI, capability: FileSystemProviderCapabilities): boolean;\n\n\t/**\n\t * List the schemes and capabilies for registered file system providers\n\t */\n\tlistCapabilities(): Iterable<{ scheme: string; capabilities: FileSystemProviderCapabilities }>;\n\n\t/**\n\t * Allows to listen for file changes. The event will fire for every file within the opened workspace\n\t * (if any) as well as all files that have been watched explicitly using the #watch() API.\n\t */\n\treadonly onDidFilesChange: Event<FileChangesEvent>;\n\n\t/**\n\t * An event that is fired upon successful completion of a certain file operation.\n\t */\n\treadonly onDidRunOperation: Event<FileOperationEvent>;\n\n\t/**\n\t * Resolve the properties of a file/folder identified by the resource. For a folder, children\n\t * information is resolved as well depending on the provided options. Use `stat()` method if\n\t * you do not need children information.\n\t *\n\t * If the optional parameter \"resolveTo\" is specified in options, the stat service is asked\n\t * to provide a stat object that should contain the full graph of folders up to all of the\n\t * target resources.\n\t *\n\t * If the optional parameter \"resolveSingleChildDescendants\" is specified in options,\n\t * the stat service is asked to automatically resolve child folders that only\n\t * contain a single element.\n\t *\n\t * If the optional parameter \"resolveMetadata\" is specified in options,\n\t * the stat will contain metadata information such as size, mtime and etag.\n\t */\n\tresolve(resource: URI, options: IResolveMetadataFileOptions): Promise<IFileStatWithMetadata>;\n\tresolve(resource: URI, options?: IResolveFileOptions): Promise<IFileStat>;\n\n\t/**\n\t * Same as `resolve()` but supports resolving multiple resources in parallel.\n\t *\n\t * If one of the resolve targets fails to resolve returns a fake `IFileStat` instead of\n\t * making the whole call fail.\n\t */\n\tresolveAll(toResolve: { resource: URI; options: IResolveMetadataFileOptions }[]): Promise<IFileStatResult[]>;\n\tresolveAll(toResolve: { resource: URI; options?: IResolveFileOptions }[]): Promise<IFileStatResult[]>;\n\n\t/**\n\t * Same as `resolve()` but without resolving the children of a folder if the\n\t * resource is pointing to a folder.\n\t */\n\tstat(resource: URI): Promise<IFileStatWithPartialMetadata>;\n\n\t/**\n\t * Finds out if a file/folder identified by the resource exists.\n\t */\n\texists(resource: URI): Promise<boolean>;\n\n\t/**\n\t * Read the contents of the provided resource unbuffered.\n\t */\n\treadFile(resource: URI, options?: IReadFileOptions, token?: CancellationToken): Promise<IFileContent>;\n\n\t/**\n\t * Read the contents of the provided resource buffered as stream.\n\t */\n\treadFileStream(resource: URI, options?: IReadFileStreamOptions, token?: CancellationToken): Promise<IFileStreamContent>;\n\n\t/**\n\t * Updates the content replacing its previous value.\n\t *\n\t * Emits a `FileOperation.WRITE` file operation event when successful.\n\t */\n\twriteFile(resource: URI, bufferOrReadableOrStream: VSBuffer | VSBufferReadable | VSBufferReadableStream, options?: IWriteFileOptions): Promise<IFileStatWithMetadata>;\n\n\t/**\n\t * Moves the file/folder to a new path identified by the resource.\n\t *\n\t * The optional parameter overwrite can be set to replace an existing file at the location.\n\t *\n\t * Emits a `FileOperation.MOVE` file operation event when successful.\n\t */\n\tmove(source: URI, target: URI, overwrite?: boolean): Promise<IFileStatWithMetadata>;\n\n\t/**\n\t * Find out if a move operation is possible given the arguments. No changes on disk will\n\t * be performed. Returns an Error if the operation cannot be done.\n\t */\n\tcanMove(source: URI, target: URI, overwrite?: boolean): Promise<Error | true>;\n\n\t/**\n\t * Copies the file/folder to a path identified by the resource. A folder is copied\n\t * recursively.\n\t *\n\t * Emits a `FileOperation.COPY` file operation event when successful.\n\t */\n\tcopy(source: URI, target: URI, overwrite?: boolean): Promise<IFileStatWithMetadata>;\n\n\t/**\n\t * Find out if a copy operation is possible given the arguments. No changes on disk will\n\t * be performed. Returns an Error if the operation cannot be done.\n\t */\n\tcanCopy(source: URI, target: URI, overwrite?: boolean): Promise<Error | true>;\n\n\t/**\n\t * Clones a file to a path identified by the resource. Folders are not supported.\n\t *\n\t * If the target path exists, it will be overwritten.\n\t */\n\tcloneFile(source: URI, target: URI): Promise<void>;\n\n\t/**\n\t * Creates a new file with the given path and optional contents. The returned promise\n\t * will have the stat model object as a result.\n\t *\n\t * The optional parameter content can be used as value to fill into the new file.\n\t *\n\t * Emits a `FileOperation.CREATE` file operation event when successful.\n\t */\n\tcreateFile(resource: URI, bufferOrReadableOrStream?: VSBuffer | VSBufferReadable | VSBufferReadableStream, options?: ICreateFileOptions): Promise<IFileStatWithMetadata>;\n\n\t/**\n\t * Find out if a file create operation is possible given the arguments. No changes on disk will\n\t * be performed. Returns an Error if the operation cannot be done.\n\t */\n\tcanCreateFile(resource: URI, options?: ICreateFileOptions): Promise<Error | true>;\n\n\t/**\n\t * Creates a new folder with the given path. The returned promise\n\t * will have the stat model object as a result.\n\t *\n\t * Emits a `FileOperation.CREATE` file operation event when successful.\n\t */\n\tcreateFolder(resource: URI): Promise<IFileStatWithMetadata>;\n\n\t/**\n\t * Deletes the provided file. The optional useTrash parameter allows to\n\t * move the file to trash. The optional recursive parameter allows to delete\n\t * non-empty folders recursively.\n\t *\n\t * Emits a `FileOperation.DELETE` file operation event when successful.\n\t */\n\tdel(resource: URI, options?: Partial<IFileDeleteOptions>): Promise<void>;\n\n\t/**\n\t * Find out if a delete operation is possible given the arguments. No changes on disk will\n\t * be performed. Returns an Error if the operation cannot be done.\n\t */\n\tcanDelete(resource: URI, options?: Partial<IFileDeleteOptions>): Promise<Error | true>;\n\n\t/**\n\t * An event that signals an error when watching for file changes.\n\t */\n\treadonly onDidWatchError: Event<Error>;\n\n\t/**\n\t * Allows to start a watcher that reports file/folder change events on the provided resource.\n\t *\n\t * Note: recursive file watching is not supported from this method. Only events from files\n\t * that are direct children of the provided resource will be reported.\n\t */\n\twatch(resource: URI, options?: IWatchOptions): IDisposable;\n\n\t/**\n\t * Frees up any resources occupied by this service.\n\t */\n\tdispose(): void;\n}\n\nexport interface IFileOverwriteOptions {\n\n\t/**\n\t * Set to `true` to overwrite a file if it exists. Will\n\t * throw an error otherwise if the file does exist.\n\t */\n\treadonly overwrite: boolean;\n}\n\nexport interface IFileUnlockOptions {\n\n\t/**\n\t * Set to `true` to try to remove any write locks the file might\n\t * have. A file that is write locked will throw an error for any\n\t * attempt to write to unless `unlock: true` is provided.\n\t */\n\treadonly unlock: boolean;\n}\n\nexport interface IFileAtomicReadOptions {\n\n\t/**\n\t * The optional `atomic` flag can be used to make sure\n\t * the `readFile` method is not running in parallel with\n\t * any `write` operations in the same process.\n\t *\n\t * Typically you should not need to use this flag but if\n\t * for example you are quickly reading a file right after\n\t * a file event occurred and the file changes a lot, there\n\t * is a chance that a read returns an empty or partial file\n\t * because a pending write has not finished yet.\n\t *\n\t * Note: this does not prevent the file from being written\n\t * to from a different process. If you need such atomic\n\t * operations, you better use a real database as storage.\n\t */\n\treadonly atomic: true;\n}\n\nexport interface IFileReadStreamOptions {\n\n\t/**\n\t * Is an integer specifying where to begin reading from in the file. If position is undefined,\n\t * data will be read from the current file position.\n\t */\n\treadonly position?: number;\n\n\t/**\n\t * Is an integer specifying how many bytes to read from the file. By default, all bytes\n\t * will be read.\n\t */\n\treadonly length?: number;\n\n\t/**\n\t * If provided, the size of the file will be checked against the limits.\n\t */\n\tlimits?: {\n\t\treadonly size?: number;\n\t\treadonly memory?: number;\n\t};\n}\n\nexport interface IFileWriteOptions extends IFileOverwriteOptions, IFileUnlockOptions {\n\n\t/**\n\t * Set to `true` to create a file when it does not exist. Will\n\t * throw an error otherwise if the file does not exist.\n\t */\n\treadonly create: boolean;\n}\n\nexport type IFileOpenOptions = IFileOpenForReadOptions | IFileOpenForWriteOptions;\n\nexport function isFileOpenForWriteOptions(options: IFileOpenOptions): options is IFileOpenForWriteOptions {\n\treturn options.create === true;\n}\n\nexport interface IFileOpenForReadOptions {\n\n\t/**\n\t * A hint that the file should be opened for reading only.\n\t */\n\treadonly create: false;\n}\n\nexport interface IFileOpenForWriteOptions extends IFileUnlockOptions {\n\n\t/**\n\t * A hint that the file should be opened for reading and writing.\n\t */\n\treadonly create: true;\n}\n\nexport interface IFileDeleteOptions {\n\n\t/**\n\t * Set to `true` to recursively delete any children of the file. This\n\t * only applies to folders and can lead to an error unless provided\n\t * if the folder is not empty.\n\t */\n\treadonly recursive: boolean;\n\n\t/**\n\t * Set to `true` to attempt to move the file to trash\n\t * instead of deleting it permanently from disk. This\n\t * option maybe not be supported on all providers.\n\t */\n\treadonly useTrash: boolean;\n}\n\nexport enum FileType {\n\n\t/**\n\t * File is unknown (neither file, directory nor symbolic link).\n\t */\n\tUnknown = 0,\n\n\t/**\n\t * File is a normal file.\n\t */\n\tFile = 1,\n\n\t/**\n\t * File is a directory.\n\t */\n\tDirectory = 2,\n\n\t/**\n\t * File is a symbolic link.\n\t *\n\t * Note: even when the file is a symbolic link, you can test for\n\t * `FileType.File` and `FileType.Directory` to know the type of\n\t * the target the link points to.\n\t */\n\tSymbolicLink = 64\n}\n\nexport enum FilePermission {\n\n\t/**\n\t * File is readonly.\n\t */\n\tReadonly = 1\n}\n\nexport interface IStat {\n\n\t/**\n\t * The file type.\n\t */\n\treadonly type: FileType;\n\n\t/**\n\t * The last modification date represented as millis from unix epoch.\n\t */\n\treadonly mtime: number;\n\n\t/**\n\t * The creation date represented as millis from unix epoch.\n\t */\n\treadonly ctime: number;\n\n\t/**\n\t * The size of the file in bytes.\n\t */\n\treadonly size: number;\n\n\t/**\n\t * The file permissions.\n\t */\n\treadonly permissions?: FilePermission;\n}\n\nexport interface IWatchOptions {\n\n\t/**\n\t * Set to `true` to watch for changes recursively in a folder\n\t * and all of its children.\n\t */\n\treadonly recursive: boolean;\n\n\t/**\n\t * A set of glob patterns or paths to exclude from watching.\n\t */\n\texcludes: string[];\n\n\t/**\n\t * An optional set of glob patterns or paths to include for\n\t * watching. If not provided, all paths are considered for\n\t * events.\n\t */\n\tincludes?: Array<string | IRelativePattern>;\n}\n\nexport const enum FileSystemProviderCapabilities {\n\n\t/**\n\t * Provider supports unbuffered read/write.\n\t */\n\tFileReadWrite = 1 << 1,\n\n\t/**\n\t * Provider supports open/read/write/close low level file operations.\n\t */\n\tFileOpenReadWriteClose = 1 << 2,\n\n\t/**\n\t * Provider supports stream based reading.\n\t */\n\tFileReadStream = 1 << 4,\n\n\t/**\n\t * Provider supports copy operation.\n\t */\n\tFileFolderCopy = 1 << 3,\n\n\t/**\n\t * Provider is path case sensitive.\n\t */\n\tPathCaseSensitive = 1 << 10,\n\n\t/**\n\t * All files of the provider are readonly.\n\t */\n\tReadonly = 1 << 11,\n\n\t/**\n\t * Provider supports to delete via trash.\n\t */\n\tTrash = 1 << 12,\n\n\t/**\n\t * Provider support to unlock files for writing.\n\t */\n\tFileWriteUnlock = 1 << 13,\n\n\t/**\n\t * Provider support to read files atomically. This implies the\n\t * provider provides the `FileReadWrite` capability too.\n\t */\n\tFileAtomicRead = 1 << 14,\n\n\t/**\n\t * Provider support to clone files atomically.\n\t */\n\tFileClone = 1 << 15\n}\n\nexport interface IFileSystemProvider {\n\n\treadonly capabilities: FileSystemProviderCapabilities;\n\treadonly onDidChangeCapabilities: Event<void>;\n\n\treadonly onDidChangeFile: Event<readonly IFileChange[]>;\n\treadonly onDidWatchError?: Event<string>;\n\twatch(resource: URI, opts: IWatchOptions): IDisposable;\n\n\tstat(resource: URI): Promise<IStat>;\n\tmkdir(resource: URI): Promise<void>;\n\treaddir(resource: URI): Promise<[string, FileType][]>;\n\tdelete(resource: URI, opts: IFileDeleteOptions): Promise<void>;\n\n\trename(from: URI, to: URI, opts: IFileOverwriteOptions): Promise<void>;\n\tcopy?(from: URI, to: URI, opts: IFileOverwriteOptions): Promise<void>;\n\n\treadFile?(resource: URI): Promise<Uint8Array>;\n\twriteFile?(resource: URI, content: Uint8Array, opts: IFileWriteOptions): Promise<void>;\n\n\treadFileStream?(resource: URI, opts: IFileReadStreamOptions, token: CancellationToken): ReadableStreamEvents<Uint8Array>;\n\n\topen?(resource: URI, opts: IFileOpenOptions): Promise<number>;\n\tclose?(fd: number): Promise<void>;\n\tread?(fd: number, pos: number, data: Uint8Array, offset: number, length: number): Promise<number>;\n\twrite?(fd: number, pos: number, data: Uint8Array, offset: number, length: number): Promise<number>;\n\n\tcloneFile?(from: URI, to: URI): Promise<void>;\n}\n\nexport interface IFileSystemProviderWithFileReadWriteCapability extends IFileSystemProvider {\n\treadFile(resource: URI): Promise<Uint8Array>;\n\twriteFile(resource: URI, content: Uint8Array, opts: IFileWriteOptions): Promise<void>;\n}\n\nexport function hasReadWriteCapability(provider: IFileSystemProvider): provider is IFileSystemProviderWithFileReadWriteCapability {\n\treturn !!(provider.capabilities & FileSystemProviderCapabilities.FileReadWrite);\n}\n\nexport interface IFileSystemProviderWithFileFolderCopyCapability extends IFileSystemProvider {\n\tcopy(from: URI, to: URI, opts: IFileOverwriteOptions): Promise<void>;\n}\n\nexport function hasFileFolderCopyCapability(provider: IFileSystemProvider): provider is IFileSystemProviderWithFileFolderCopyCapability {\n\treturn !!(provider.capabilities & FileSystemProviderCapabilities.FileFolderCopy);\n}\n\nexport interface IFileSystemProviderWithFileCloneCapability extends IFileSystemProvider {\n\tcloneFile(from: URI, to: URI): Promise<void>;\n}\n\nexport function hasFileCloneCapability(provider: IFileSystemProvider): provider is IFileSystemProviderWithFileCloneCapability {\n\treturn !!(provider.capabilities & FileSystemProviderCapabilities.FileClone);\n}\n\nexport interface IFileSystemProviderWithOpenReadWriteCloseCapability extends IFileSystemProvider {\n\topen(resource: URI, opts: IFileOpenOptions): Promise<number>;\n\tclose(fd: number): Promise<void>;\n\tread(fd: number, pos: number, data: Uint8Array, offset: number, length: number): Promise<number>;\n\twrite(fd: number, pos: number, data: Uint8Array, offset: number, length: number): Promise<number>;\n}\n\nexport function hasOpenReadWriteCloseCapability(provider: IFileSystemProvider): provider is IFileSystemProviderWithOpenReadWriteCloseCapability {\n\treturn !!(provider.capabilities & FileSystemProviderCapabilities.FileOpenReadWriteClose);\n}\n\nexport interface IFileSystemProviderWithFileReadStreamCapability extends IFileSystemProvider {\n\treadFileStream(resource: URI, opts: IFileReadStreamOptions, token: CancellationToken): ReadableStreamEvents<Uint8Array>;\n}\n\nexport function hasFileReadStreamCapability(provider: IFileSystemProvider): provider is IFileSystemProviderWithFileReadStreamCapability {\n\treturn !!(provider.capabilities & FileSystemProviderCapabilities.FileReadStream);\n}\n\nexport interface IFileSystemProviderWithFileAtomicReadCapability extends IFileSystemProvider {\n\treadFile(resource: URI, opts?: IFileAtomicReadOptions): Promise<Uint8Array>;\n}\n\nexport function hasFileAtomicReadCapability(provider: IFileSystemProvider): provider is IFileSystemProviderWithFileAtomicReadCapability {\n\tif (!hasReadWriteCapability(provider)) {\n\t\treturn false; // we require the `FileReadWrite` capability too\n\t}\n\n\treturn !!(provider.capabilities & FileSystemProviderCapabilities.FileAtomicRead);\n}\n\nexport enum FileSystemProviderErrorCode {\n\tFileExists = 'EntryExists',\n\tFileNotFound = 'EntryNotFound',\n\tFileNotADirectory = 'EntryNotADirectory',\n\tFileIsADirectory = 'EntryIsADirectory',\n\tFileExceedsMemoryLimit = 'EntryExceedsMemoryLimit',\n\tFileTooLarge = 'EntryTooLarge',\n\tFileWriteLocked = 'EntryWriteLocked',\n\tNoPermissions = 'NoPermissions',\n\tUnavailable = 'Unavailable',\n\tUnknown = 'Unknown'\n}\n\nexport class FileSystemProviderError extends Error {\n\n\tconstructor(message: string, readonly code: FileSystemProviderErrorCode) {\n\t\tsuper(message);\n\t}\n}\n\nexport function createFileSystemProviderError(error: Error | string, code: FileSystemProviderErrorCode): FileSystemProviderError {\n\tconst providerError = new FileSystemProviderError(error.toString(), code);\n\tmarkAsFileSystemProviderError(providerError, code);\n\n\treturn providerError;\n}\n\nexport function ensureFileSystemProviderError(error?: Error): Error {\n\tif (!error) {\n\t\treturn createFileSystemProviderError(localize('unknownError', \"Unknown Error\"), FileSystemProviderErrorCode.Unknown); // https://github.com/microsoft/vscode/issues/72798\n\t}\n\n\treturn error;\n}\n\nexport function markAsFileSystemProviderError(error: Error, code: FileSystemProviderErrorCode): Error {\n\terror.name = code ? `${code} (FileSystemError)` : `FileSystemError`;\n\n\treturn error;\n}\n\nexport function toFileSystemProviderErrorCode(error: Error | undefined | null): FileSystemProviderErrorCode {\n\n\t// Guard against abuse\n\tif (!error) {\n\t\treturn FileSystemProviderErrorCode.Unknown;\n\t}\n\n\t// FileSystemProviderError comes with the code\n\tif (error instanceof FileSystemProviderError) {\n\t\treturn error.code;\n\t}\n\n\t// Any other error, check for name match by assuming that the error\n\t// went through the markAsFileSystemProviderError() method\n\tconst match = /^(.+) \\(FileSystemError\\)$/.exec(error.name);\n\tif (!match) {\n\t\treturn FileSystemProviderErrorCode.Unknown;\n\t}\n\n\tswitch (match[1]) {\n\t\tcase FileSystemProviderErrorCode.FileExists: return FileSystemProviderErrorCode.FileExists;\n\t\tcase FileSystemProviderErrorCode.FileIsADirectory: return FileSystemProviderErrorCode.FileIsADirectory;\n\t\tcase FileSystemProviderErrorCode.FileNotADirectory: return FileSystemProviderErrorCode.FileNotADirectory;\n\t\tcase FileSystemProviderErrorCode.FileNotFound: return FileSystemProviderErrorCode.FileNotFound;\n\t\tcase FileSystemProviderErrorCode.FileExceedsMemoryLimit: return FileSystemProviderErrorCode.FileExceedsMemoryLimit;\n\t\tcase FileSystemProviderErrorCode.FileTooLarge: return FileSystemProviderErrorCode.FileTooLarge;\n\t\tcase FileSystemProviderErrorCode.FileWriteLocked: return FileSystemProviderErrorCode.FileWriteLocked;\n\t\tcase FileSystemProviderErrorCode.NoPermissions: return FileSystemProviderErrorCode.NoPermissions;\n\t\tcase FileSystemProviderErrorCode.Unavailable: return FileSystemProviderErrorCode.Unavailable;\n\t}\n\n\treturn FileSystemProviderErrorCode.Unknown;\n}\n\nexport function toFileOperationResult(error: Error): FileOperationResult {\n\n\t// FileSystemProviderError comes with the result already\n\tif (error instanceof FileOperationError) {\n\t\treturn error.fileOperationResult;\n\t}\n\n\t// Otherwise try to find from code\n\tswitch (toFileSystemProviderErrorCode(error)) {\n\t\tcase FileSystemProviderErrorCode.FileNotFound:\n\t\t\treturn FileOperationResult.FILE_NOT_FOUND;\n\t\tcase FileSystemProviderErrorCode.FileIsADirectory:\n\t\t\treturn FileOperationResult.FILE_IS_DIRECTORY;\n\t\tcase FileSystemProviderErrorCode.FileNotADirectory:\n\t\t\treturn FileOperationResult.FILE_NOT_DIRECTORY;\n\t\tcase FileSystemProviderErrorCode.FileWriteLocked:\n\t\t\treturn FileOperationResult.FILE_WRITE_LOCKED;\n\t\tcase FileSystemProviderErrorCode.NoPermissions:\n\t\t\treturn FileOperationResult.FILE_PERMISSION_DENIED;\n\t\tcase FileSystemProviderErrorCode.FileExists:\n\t\t\treturn FileOperationResult.FILE_MOVE_CONFLICT;\n\t\tcase FileSystemProviderErrorCode.FileExceedsMemoryLimit:\n\t\t\treturn FileOperationResult.FILE_EXCEEDS_MEMORY_LIMIT;\n\t\tcase FileSystemProviderErrorCode.FileTooLarge:\n\t\t\treturn FileOperationResult.FILE_TOO_LARGE;\n\t\tdefault:\n\t\t\treturn FileOperationResult.FILE_OTHER_ERROR;\n\t}\n}\n\nexport interface IFileSystemProviderRegistrationEvent {\n\treadonly added: boolean;\n\treadonly scheme: string;\n\treadonly provider?: IFileSystemProvider;\n}\n\nexport interface IFileSystemProviderCapabilitiesChangeEvent {\n\treadonly provider: IFileSystemProvider;\n\treadonly scheme: string;\n}\n\nexport interface IFileSystemProviderActivationEvent {\n\treadonly scheme: string;\n\tjoin(promise: Promise<void>): void;\n}\n\nexport const enum FileOperation {\n\tCREATE,\n\tDELETE,\n\tMOVE,\n\tCOPY,\n\tWRITE\n}\n\nexport interface IFileOperationEvent {\n\n\treadonly resource: URI;\n\treadonly operation: FileOperation;\n\n\tisOperation(operation: FileOperation.DELETE | FileOperation.WRITE): boolean;\n\tisOperation(operation: FileOperation.CREATE | FileOperation.MOVE | FileOperation.COPY): this is IFileOperationEventWithMetadata;\n}\n\nexport interface IFileOperationEventWithMetadata extends IFileOperationEvent {\n\treadonly target: IFileStatWithMetadata;\n}\n\nexport class FileOperationEvent implements IFileOperationEvent {\n\n\tconstructor(resource: URI, operation: FileOperation.DELETE | FileOperation.WRITE);\n\tconstructor(resource: URI, operation: FileOperation.CREATE | FileOperation.MOVE | FileOperation.COPY, target: IFileStatWithMetadata);\n\tconstructor(readonly resource: URI, readonly operation: FileOperation, readonly target?: IFileStatWithMetadata) { }\n\n\tisOperation(operation: FileOperation.DELETE | FileOperation.WRITE): boolean;\n\tisOperation(operation: FileOperation.CREATE | FileOperation.MOVE | FileOperation.COPY): this is IFileOperationEventWithMetadata;\n\tisOperation(operation: FileOperation): boolean {\n\t\treturn this.operation === operation;\n\t}\n}\n\n/**\n * Possible changes that can occur to a file.\n */\nexport const enum FileChangeType {\n\tUPDATED,\n\tADDED,\n\tDELETED\n}\n\n/**\n * Identifies a single change in a file.\n */\nexport interface IFileChange {\n\n\t/**\n\t * The type of change that occurred to the file.\n\t */\n\treadonly type: FileChangeType;\n\n\t/**\n\t * The unified resource identifier of the file that changed.\n\t */\n\treadonly resource: URI;\n}\n\nexport class FileChangesEvent {\n\n\tprivate readonly added: TernarySearchTree<URI, IFileChange> | undefined = undefined;\n\tprivate readonly updated: TernarySearchTree<URI, IFileChange> | undefined = undefined;\n\tprivate readonly deleted: TernarySearchTree<URI, IFileChange> | undefined = undefined;\n\n\tconstructor(changes: readonly IFileChange[], ignorePathCasing: boolean) {\n\t\tthis.rawChanges = changes;\n\n\t\tconst entriesByType = new Map<FileChangeType, [URI, IFileChange][]>();\n\n\t\tfor (const change of changes) {\n\t\t\tconst array = entriesByType.get(change.type);\n\t\t\tif (array) {\n\t\t\t\tarray.push([change.resource, change]);\n\t\t\t} else {\n\t\t\t\tentriesByType.set(change.type, [[change.resource, change]]);\n\t\t\t}\n\n\t\t\tswitch (change.type) {\n\t\t\t\tcase FileChangeType.ADDED:\n\t\t\t\t\tthis.rawAdded.push(change.resource);\n\t\t\t\t\tbreak;\n\t\t\t\tcase FileChangeType.UPDATED:\n\t\t\t\t\tthis.rawUpdated.push(change.resource);\n\t\t\t\t\tbreak;\n\t\t\t\tcase FileChangeType.DELETED:\n\t\t\t\t\tthis.rawDeleted.push(change.resource);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tfor (const [key, value] of entriesByType) {\n\t\t\tswitch (key) {\n\t\t\t\tcase FileChangeType.ADDED:\n\t\t\t\t\tthis.added = TernarySearchTree.forUris<IFileChange>(() => ignorePathCasing);\n\t\t\t\t\tthis.added.fill(value);\n\t\t\t\t\tbreak;\n\t\t\t\tcase FileChangeType.UPDATED:\n\t\t\t\t\tthis.updated = TernarySearchTree.forUris<IFileChange>(() => ignorePathCasing);\n\t\t\t\t\tthis.updated.fill(value);\n\t\t\t\t\tbreak;\n\t\t\t\tcase FileChangeType.DELETED:\n\t\t\t\t\tthis.deleted = TernarySearchTree.forUris<IFileChange>(() => ignorePathCasing);\n\t\t\t\t\tthis.deleted.fill(value);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Find out if the file change events match the provided resource.\n\t *\n\t * Note: when passing `FileChangeType.DELETED`, we consider a match\n\t * also when the parent of the resource got deleted.\n\t */\n\tcontains(resource: URI, ...types: FileChangeType[]): boolean {\n\t\treturn this.doContains(resource, { includeChildren: false }, ...types);\n\t}\n\n\t/**\n\t * Find out if the file change events either match the provided\n\t * resource, or contain a child of this resource.\n\t */\n\taffects(resource: URI, ...types: FileChangeType[]): boolean {\n\t\treturn this.doContains(resource, { includeChildren: true }, ...types);\n\t}\n\n\tprivate doContains(resource: URI, options: { includeChildren: boolean }, ...types: FileChangeType[]): boolean {\n\t\tif (!resource) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst hasTypesFilter = types.length > 0;\n\n\t\t// Added\n\t\tif (!hasTypesFilter || types.includes(FileChangeType.ADDED)) {\n\t\t\tif (this.added?.get(resource)) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (options.includeChildren && this.added?.findSuperstr(resource)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\t// Updated\n\t\tif (!hasTypesFilter || types.includes(FileChangeType.UPDATED)) {\n\t\t\tif (this.updated?.get(resource)) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (options.includeChildren && this.updated?.findSuperstr(resource)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\t// Deleted\n\t\tif (!hasTypesFilter || types.includes(FileChangeType.DELETED)) {\n\t\t\tif (this.deleted?.findSubstr(resource) /* deleted also considers parent folders */) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (options.includeChildren && this.deleted?.findSuperstr(resource)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t/**\n\t * Returns if this event contains added files.\n\t */\n\tgotAdded(): boolean {\n\t\treturn !!this.added;\n\t}\n\n\t/**\n\t * Returns if this event contains deleted files.\n\t */\n\tgotDeleted(): boolean {\n\t\treturn !!this.deleted;\n\t}\n\n\t/**\n\t * Returns if this event contains updated files.\n\t */\n\tgotUpdated(): boolean {\n\t\treturn !!this.updated;\n\t}\n\n\t/**\n\t * @deprecated use the `contains` or `affects` method to efficiently find\n\t * out if the event relates to a given resource. these methods ensure:\n\t * - that there is no expensive lookup needed (by using a `TernarySearchTree`)\n\t * - correctly handles `FileChangeType.DELETED` events\n\t */\n\treadonly rawChanges: readonly IFileChange[] = [];\n\n\t/**\n\t * @deprecated use the `contains` or `affects` method to efficiently find\n\t * out if the event relates to a given resource. these methods ensure:\n\t * - that there is no expensive lookup needed (by using a `TernarySearchTree`)\n\t * - correctly handles `FileChangeType.DELETED` events\n\t */\n\treadonly rawAdded: URI[] = [];\n\n\t/**\n\t* @deprecated use the `contains` or `affects` method to efficiently find\n\t* out if the event relates to a given resource. these methods ensure:\n\t* - that there is no expensive lookup needed (by using a `TernarySearchTree`)\n\t* - correctly handles `FileChangeType.DELETED` events\n\t*/\n\treadonly rawUpdated: URI[] = [];\n\n\t/**\n\t* @deprecated use the `contains` or `affects` method to efficiently find\n\t* out if the event relates to a given resource. these methods ensure:\n\t* - that there is no expensive lookup needed (by using a `TernarySearchTree`)\n\t* - correctly handles `FileChangeType.DELETED` events\n\t*/\n\treadonly rawDeleted: URI[] = [];\n}\n\nexport function isParent(path: string, candidate: string, ignoreCase?: boolean): boolean {\n\tif (!path || !candidate || path === candidate) {\n\t\treturn false;\n\t}\n\n\tif (candidate.length > path.length) {\n\t\treturn false;\n\t}\n\n\tif (candidate.charAt(candidate.length - 1) !== sep) {\n\t\tcandidate += sep;\n\t}\n\n\tif (ignoreCase) {\n\t\treturn startsWithIgnoreCase(path, candidate);\n\t}\n\n\treturn path.indexOf(candidate) === 0;\n}\n\ninterface IBaseFileStat {\n\n\t/**\n\t * The unified resource identifier of this file or folder.\n\t */\n\treadonly resource: URI;\n\n\t/**\n\t * The name which is the last segment\n\t * of the {{path}}.\n\t */\n\treadonly name: string;\n\n\t/**\n\t * The size of the file.\n\t *\n\t * The value may or may not be resolved as\n\t * it is optional.\n\t */\n\treadonly size?: number;\n\n\t/**\n\t * The last modification date represented as millis from unix epoch.\n\t *\n\t * The value may or may not be resolved as\n\t * it is optional.\n\t */\n\treadonly mtime?: number;\n\n\t/**\n\t * The creation date represented as millis from unix epoch.\n\t *\n\t * The value may or may not be resolved as\n\t * it is optional.\n\t */\n\treadonly ctime?: number;\n\n\t/**\n\t * A unique identifier thet represents the\n\t * current state of the file or directory.\n\t *\n\t * The value may or may not be resolved as\n\t * it is optional.\n\t */\n\treadonly etag?: string;\n\n\t/**\n\t * The file is read-only.\n\t */\n\treadonly readonly?: boolean;\n}\n\nexport interface IBaseFileStatWithMetadata extends Required<IBaseFileStat> { }\n\n/**\n * A file resource with meta information and resolved children if any.\n */\nexport interface IFileStat extends IBaseFileStat {\n\n\t/**\n\t * The resource is a file.\n\t */\n\treadonly isFile: boolean;\n\n\t/**\n\t * The resource is a directory.\n\t */\n\treadonly isDirectory: boolean;\n\n\t/**\n\t * The resource is a symbolic link. Note: even when the\n\t * file is a symbolic link, you can test for `FileType.File`\n\t * and `FileType.Directory` to know the type of the target\n\t * the link points to.\n\t */\n\treadonly isSymbolicLink: boolean;\n\n\t/**\n\t * The children of the file stat or undefined if none.\n\t */\n\tchildren: IFileStat[] | undefined;\n}\n\nexport interface IFileStatWithMetadata extends IFileStat, IBaseFileStatWithMetadata {\n\treadonly mtime: number;\n\treadonly ctime: number;\n\treadonly etag: string;\n\treadonly size: number;\n\treadonly readonly: boolean;\n\treadonly children: IFileStatWithMetadata[] | undefined;\n}\n\nexport interface IFileStatResult {\n\treadonly stat?: IFileStat;\n\treadonly success: boolean;\n}\n\nexport interface IFileStatResultWithMetadata extends IFileStatResult {\n\treadonly stat?: IFileStatWithMetadata;\n}\n\nexport interface IFileStatWithPartialMetadata extends Omit<IFileStatWithMetadata, 'children'> { }\n\nexport interface IFileContent extends IBaseFileStatWithMetadata {\n\n\t/**\n\t * The content of a file as buffer.\n\t */\n\treadonly value: VSBuffer;\n}\n\nexport interface IFileStreamContent extends IBaseFileStatWithMetadata {\n\n\t/**\n\t * The content of a file as stream.\n\t */\n\treadonly value: VSBufferReadableStream;\n}\n\nexport interface IBaseReadFileOptions extends IFileReadStreamOptions {\n\n\t/**\n\t * The optional etag parameter allows to return early from resolving the resource if\n\t * the contents on disk match the etag. This prevents accumulated reading of resources\n\t * that have been read already with the same etag.\n\t * It is the task of the caller to makes sure to handle this error case from the promise.\n\t */\n\treadonly etag?: string;\n}\n\nexport interface IReadFileStreamOptions extends IBaseReadFileOptions { }\n\nexport interface IReadFileOptions extends IBaseReadFileOptions {\n\n\t/**\n\t * The optional `atomic` flag can be used to make sure\n\t * the `readFile` method is not running in parallel with\n\t * any `write` operations in the same process.\n\t *\n\t * Typically you should not need to use this flag but if\n\t * for example you are quickly reading a file right after\n\t * a file event occurred and the file changes a lot, there\n\t * is a chance that a read returns an empty or partial file\n\t * because a pending write has not finished yet.\n\t *\n\t * Note: this does not prevent the file from being written\n\t * to from a different process. If you need such atomic\n\t * operations, you better use a real database as storage.\n\t */\n\treadonly atomic?: boolean;\n}\n\nexport interface IWriteFileOptions {\n\n\t/**\n\t * The last known modification time of the file. This can be used to prevent dirty writes.\n\t */\n\treadonly mtime?: number;\n\n\t/**\n\t * The etag of the file. This can be used to prevent dirty writes.\n\t */\n\treadonly etag?: string;\n\n\t/**\n\t * Whether to attempt to unlock a file before writing.\n\t */\n\treadonly unlock?: boolean;\n}\n\nexport interface IResolveFileOptions {\n\n\t/**\n\t * Automatically continue resolving children of a directory until the provided resources\n\t * are found.\n\t */\n\treadonly resolveTo?: readonly URI[];\n\n\t/**\n\t * Automatically continue resolving children of a directory if the number of children is 1.\n\t */\n\treadonly resolveSingleChildDescendants?: boolean;\n\n\t/**\n\t * Will resolve mtime, ctime, size and etag of files if enabled. This can have a negative impact\n\t * on performance and thus should only be used when these values are required.\n\t */\n\treadonly resolveMetadata?: boolean;\n}\n\nexport interface IResolveMetadataFileOptions extends IResolveFileOptions {\n\treadonly resolveMetadata: true;\n}\n\nexport interface ICreateFileOptions {\n\n\t/**\n\t * Overwrite the file to create if it already exists on disk. Otherwise\n\t * an error will be thrown (FILE_MODIFIED_SINCE).\n\t */\n\treadonly overwrite?: boolean;\n}\n\nexport class FileOperationError extends Error {\n\tconstructor(\n\t\tmessage: string,\n\t\treadonly fileOperationResult: FileOperationResult,\n\t\treadonly options?: IReadFileOptions & IWriteFileOptions & ICreateFileOptions\n\t) {\n\t\tsuper(message);\n\t}\n}\n\nexport class NotModifiedSinceFileOperationError extends FileOperationError {\n\n\tconstructor(\n\t\tmessage: string,\n\t\treadonly stat: IFileStatWithMetadata,\n\t\toptions?: IReadFileOptions\n\t) {\n\t\tsuper(message, FileOperationResult.FILE_NOT_MODIFIED_SINCE, options);\n\t}\n}\n\nexport const enum FileOperationResult {\n\tFILE_IS_DIRECTORY,\n\tFILE_NOT_FOUND,\n\tFILE_NOT_MODIFIED_SINCE,\n\tFILE_MODIFIED_SINCE,\n\tFILE_MOVE_CONFLICT,\n\tFILE_WRITE_LOCKED,\n\tFILE_PERMISSION_DENIED,\n\tFILE_TOO_LARGE,\n\tFILE_INVALID_PATH,\n\tFILE_EXCEEDS_MEMORY_LIMIT,\n\tFILE_NOT_DIRECTORY,\n\tFILE_OTHER_ERROR\n}\n\n//#endregion\n\n//#region Settings\n\nexport const AutoSaveConfiguration = {\n\tOFF: 'off',\n\tAFTER_DELAY: 'afterDelay',\n\tON_FOCUS_CHANGE: 'onFocusChange',\n\tON_WINDOW_CHANGE: 'onWindowChange'\n};\n\nexport const HotExitConfiguration = {\n\tOFF: 'off',\n\tON_EXIT: 'onExit',\n\tON_EXIT_AND_WINDOW_CLOSE: 'onExitAndWindowClose'\n};\n\nexport const FILES_ASSOCIATIONS_CONFIG = 'files.associations';\nexport const FILES_EXCLUDE_CONFIG = 'files.exclude';\n\nexport interface IFilesConfiguration {\n\tfiles: {\n\t\tassociations: { [filepattern: string]: string };\n\t\texclude: IExpression;\n\t\twatcherExclude: { [filepattern: string]: boolean };\n\t\twatcherInclude: string[];\n\t\tencoding: string;\n\t\tautoGuessEncoding: boolean;\n\t\tdefaultLanguage: string;\n\t\ttrimTrailingWhitespace: boolean;\n\t\tautoSave: string;\n\t\tautoSaveDelay: number;\n\t\teol: string;\n\t\tenableTrash: boolean;\n\t\thotExit: string;\n\t\tsaveConflictResolution: 'askUser' | 'overwriteFileOnDisk';\n\t};\n}\n\n//#endregion\n\n//#region Utilities\n\nexport enum FileKind {\n\tFILE,\n\tFOLDER,\n\tROOT_FOLDER\n}\n\n/**\n * A hint to disable etag checking for reading/writing.\n */\nexport const ETAG_DISABLED = '';\n\nexport function etag(stat: { mtime: number; size: number }): string;\nexport function etag(stat: { mtime: number | undefined; size: number | undefined }): string | undefined;\nexport function etag(stat: { mtime: number | undefined; size: number | undefined }): string | undefined {\n\tif (typeof stat.size !== 'number' || typeof stat.mtime !== 'number') {\n\t\treturn undefined;\n\t}\n\n\treturn stat.mtime.toString(29) + stat.size.toString(31);\n}\n\nexport async function whenProviderRegistered(file: URI, fileService: IFileService): Promise<void> {\n\tif (fileService.hasProvider(URI.from({ scheme: file.scheme }))) {\n\t\treturn;\n\t}\n\n\treturn new Promise(resolve => {\n\t\tconst disposable = fileService.onDidChangeFileSystemProviderRegistrations(e => {\n\t\t\tif (e.scheme === file.scheme && e.added) {\n\t\t\t\tdisposable.dispose();\n\t\t\t\tresolve();\n\t\t\t}\n\t\t});\n\t});\n}\n\n/**\n * Native only: limits for memory sizes\n */\nexport const MIN_MAX_MEMORY_SIZE_MB = 2048;\nexport const FALLBACK_MAX_MEMORY_SIZE_MB = 4096;\n\n/**\n * Helper to format a raw byte size into a human readable label.\n */\nexport class ByteSize {\n\n\tstatic readonly KB = 1024;\n\tstatic readonly MB = ByteSize.KB * ByteSize.KB;\n\tstatic readonly GB = ByteSize.MB * ByteSize.KB;\n\tstatic readonly TB = ByteSize.GB * ByteSize.KB;\n\n\tstatic formatSize(size: number): string {\n\t\tif (!isNumber(size)) {\n\t\t\tsize = 0;\n\t\t}\n\n\t\tif (size < ByteSize.KB) {\n\t\t\treturn localize('sizeB', \"{0}B\", size.toFixed(0));\n\t\t}\n\n\t\tif (size < ByteSize.MB) {\n\t\t\treturn localize('sizeKB', \"{0}KB\", (size / ByteSize.KB).toFixed(2));\n\t\t}\n\n\t\tif (size < ByteSize.GB) {\n\t\t\treturn localize('sizeMB', \"{0}MB\", (size / ByteSize.MB).toFixed(2));\n\t\t}\n\n\t\tif (size < ByteSize.TB) {\n\t\t\treturn localize('sizeGB', \"{0}GB\", (size / ByteSize.GB).toFixed(2));\n\t\t}\n\n\t\treturn localize('sizeTB', \"{0}TB\", (size / ByteSize.TB).toFixed(2));\n\t}\n}\n\n// Native only: Arch limits\n\nexport interface IArchLimits {\n\treadonly maxFileSize: number;\n\treadonly maxHeapSize: number;\n}\n\nexport const enum Arch {\n\tIA32,\n\tOTHER\n}\n\nexport function getPlatformLimits(arch: Arch): IArchLimits {\n\treturn {\n\t\tmaxFileSize: arch === Arch.IA32 ? 300 * ByteSize.MB : 16 * ByteSize.GB,  // https://github.com/microsoft/vscode/issues/30180\n\t\tmaxHeapSize: arch === Arch.IA32 ? 700 * ByteSize.MB : 2 * 700 * ByteSize.MB, // https://github.com/v8/v8/blob/5918a23a3d571b9625e5cce246bdd5b46ff7cd8b/src/heap/heap.cc#L149\n\t};\n}\n\n//#endregion\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ServiceIdentifier } from 'vs/platform/instantiation/common/instantiation';\nimport { SyncDescriptor } from './descriptors';\n\nexport class ServiceCollection {\n\n\tprivate _entries = new Map<ServiceIdentifier<any>, any>();\n\n\tconstructor(...entries: [ServiceIdentifier<any>, any][]) {\n\t\tfor (const [id, service] of entries) {\n\t\t\tthis.set(id, service);\n\t\t}\n\t}\n\n\tset<T>(id: ServiceIdentifier<T>, instanceOrDescriptor: T | SyncDescriptor<T>): T | SyncDescriptor<T> {\n\t\tconst result = this._entries.get(id);\n\t\tthis._entries.set(id, instanceOrDescriptor);\n\t\treturn result;\n\t}\n\n\thas(id: ServiceIdentifier<any>): boolean {\n\t\treturn this._entries.has(id);\n\t}\n\n\tget<T>(id: ServiceIdentifier<T>): T | SyncDescriptor<T> {\n\t\treturn this._entries.get(id);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IdleValue } from 'vs/base/common/async';\nimport { illegalState } from 'vs/base/common/errors';\nimport { SyncDescriptor } from 'vs/platform/instantiation/common/descriptors';\nimport { Graph } from 'vs/platform/instantiation/common/graph';\nimport { IInstantiationService, ServiceIdentifier, ServicesAccessor, _util } from 'vs/platform/instantiation/common/instantiation';\nimport { ServiceCollection } from 'vs/platform/instantiation/common/serviceCollection';\n\n// TRACING\nconst _enableTracing = false;\n\nclass CyclicDependencyError extends Error {\n\tconstructor(graph: Graph<any>) {\n\t\tsuper('cyclic dependency between services');\n\t\tthis.message = graph.findCycleSlow() ?? `UNABLE to detect cycle, dumping graph: \\n${graph.toString()}`;\n\t}\n}\n\nexport class InstantiationService implements IInstantiationService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate readonly _services: ServiceCollection;\n\tprivate readonly _strict: boolean;\n\tprivate readonly _parent?: InstantiationService;\n\n\tconstructor(services: ServiceCollection = new ServiceCollection(), strict: boolean = false, parent?: InstantiationService) {\n\t\tthis._services = services;\n\t\tthis._strict = strict;\n\t\tthis._parent = parent;\n\n\t\tthis._services.set(IInstantiationService, this);\n\t}\n\n\tcreateChild(services: ServiceCollection): IInstantiationService {\n\t\treturn new InstantiationService(services, this._strict, this);\n\t}\n\n\tinvokeFunction<R, TS extends any[] = []>(fn: (accessor: ServicesAccessor, ...args: TS) => R, ...args: TS): R {\n\t\tconst _trace = Trace.traceInvocation(fn);\n\t\tlet _done = false;\n\t\ttry {\n\t\t\tconst accessor: ServicesAccessor = {\n\t\t\t\tget: <T>(id: ServiceIdentifier<T>) => {\n\n\t\t\t\t\tif (_done) {\n\t\t\t\t\t\tthrow illegalState('service accessor is only valid during the invocation of its target method');\n\t\t\t\t\t}\n\n\t\t\t\t\tconst result = this._getOrCreateServiceInstance(id, _trace);\n\t\t\t\t\tif (!result) {\n\t\t\t\t\t\tthrow new Error(`[invokeFunction] unknown service '${id}'`);\n\t\t\t\t\t}\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn fn(accessor, ...args);\n\t\t} finally {\n\t\t\t_done = true;\n\t\t\t_trace.stop();\n\t\t}\n\t}\n\n\tcreateInstance(ctorOrDescriptor: any | SyncDescriptor<any>, ...rest: any[]): any {\n\t\tlet _trace: Trace;\n\t\tlet result: any;\n\t\tif (ctorOrDescriptor instanceof SyncDescriptor) {\n\t\t\t_trace = Trace.traceCreation(ctorOrDescriptor.ctor);\n\t\t\tresult = this._createInstance(ctorOrDescriptor.ctor, ctorOrDescriptor.staticArguments.concat(rest), _trace);\n\t\t} else {\n\t\t\t_trace = Trace.traceCreation(ctorOrDescriptor);\n\t\t\tresult = this._createInstance(ctorOrDescriptor, rest, _trace);\n\t\t}\n\t\t_trace.stop();\n\t\treturn result;\n\t}\n\n\tprivate _createInstance<T>(ctor: any, args: any[] = [], _trace: Trace): T {\n\n\t\t// arguments defined by service decorators\n\t\tconst serviceDependencies = _util.getServiceDependencies(ctor).sort((a, b) => a.index - b.index);\n\t\tconst serviceArgs: any[] = [];\n\t\tfor (const dependency of serviceDependencies) {\n\t\t\tconst service = this._getOrCreateServiceInstance(dependency.id, _trace);\n\t\t\tif (!service) {\n\t\t\t\tthis._throwIfStrict(`[createInstance] ${ctor.name} depends on UNKNOWN service ${dependency.id}.`, false);\n\t\t\t}\n\t\t\tserviceArgs.push(service);\n\t\t}\n\n\t\tconst firstServiceArgPos = serviceDependencies.length > 0 ? serviceDependencies[0].index : args.length;\n\n\t\t// check for argument mismatches, adjust static args if needed\n\t\tif (args.length !== firstServiceArgPos) {\n\t\t\tconsole.trace(`[createInstance] First service dependency of ${ctor.name} at position ${firstServiceArgPos + 1} conflicts with ${args.length} static arguments`);\n\n\t\t\tconst delta = firstServiceArgPos - args.length;\n\t\t\tif (delta > 0) {\n\t\t\t\targs = args.concat(new Array(delta));\n\t\t\t} else {\n\t\t\t\targs = args.slice(0, firstServiceArgPos);\n\t\t\t}\n\t\t}\n\n\t\t// now create the instance\n\t\treturn <T>new ctor(...[...args, ...serviceArgs]);\n\t}\n\n\tprivate _setServiceInstance<T>(id: ServiceIdentifier<T>, instance: T): void {\n\t\tif (this._services.get(id) instanceof SyncDescriptor) {\n\t\t\tthis._services.set(id, instance);\n\t\t} else if (this._parent) {\n\t\t\tthis._parent._setServiceInstance(id, instance);\n\t\t} else {\n\t\t\tthrow new Error('illegalState - setting UNKNOWN service instance');\n\t\t}\n\t}\n\n\tprivate _getServiceInstanceOrDescriptor<T>(id: ServiceIdentifier<T>): T | SyncDescriptor<T> {\n\t\tconst instanceOrDesc = this._services.get(id);\n\t\tif (!instanceOrDesc && this._parent) {\n\t\t\treturn this._parent._getServiceInstanceOrDescriptor(id);\n\t\t} else {\n\t\t\treturn instanceOrDesc;\n\t\t}\n\t}\n\n\tprotected _getOrCreateServiceInstance<T>(id: ServiceIdentifier<T>, _trace: Trace): T {\n\t\tconst thing = this._getServiceInstanceOrDescriptor(id);\n\t\tif (thing instanceof SyncDescriptor) {\n\t\t\treturn this._safeCreateAndCacheServiceInstance(id, thing, _trace.branch(id, true));\n\t\t} else {\n\t\t\t_trace.branch(id, false);\n\t\t\treturn thing;\n\t\t}\n\t}\n\n\tprivate readonly _activeInstantiations = new Set<ServiceIdentifier<any>>();\n\n\n\tprivate _safeCreateAndCacheServiceInstance<T>(id: ServiceIdentifier<T>, desc: SyncDescriptor<T>, _trace: Trace): T {\n\t\tif (this._activeInstantiations.has(id)) {\n\t\t\tthrow new Error(`illegal state - RECURSIVELY instantiating service '${id}'`);\n\t\t}\n\t\tthis._activeInstantiations.add(id);\n\t\ttry {\n\t\t\treturn this._createAndCacheServiceInstance(id, desc, _trace);\n\t\t} finally {\n\t\t\tthis._activeInstantiations.delete(id);\n\t\t}\n\t}\n\n\tprivate _createAndCacheServiceInstance<T>(id: ServiceIdentifier<T>, desc: SyncDescriptor<T>, _trace: Trace): T {\n\n\t\ttype Triple = { id: ServiceIdentifier<any>; desc: SyncDescriptor<any>; _trace: Trace };\n\t\tconst graph = new Graph<Triple>(data => data.id.toString());\n\n\t\tlet cycleCount = 0;\n\t\tconst stack = [{ id, desc, _trace }];\n\t\twhile (stack.length) {\n\t\t\tconst item = stack.pop()!;\n\t\t\tgraph.lookupOrInsertNode(item);\n\n\t\t\t// a weak but working heuristic for cycle checks\n\t\t\tif (cycleCount++ > 1000) {\n\t\t\t\tthrow new CyclicDependencyError(graph);\n\t\t\t}\n\n\t\t\t// check all dependencies for existence and if they need to be created first\n\t\t\tfor (const dependency of _util.getServiceDependencies(item.desc.ctor)) {\n\n\t\t\t\tconst instanceOrDesc = this._getServiceInstanceOrDescriptor(dependency.id);\n\t\t\t\tif (!instanceOrDesc) {\n\t\t\t\t\tthis._throwIfStrict(`[createInstance] ${id} depends on ${dependency.id} which is NOT registered.`, true);\n\t\t\t\t}\n\n\t\t\t\tif (instanceOrDesc instanceof SyncDescriptor) {\n\t\t\t\t\tconst d = { id: dependency.id, desc: instanceOrDesc, _trace: item._trace.branch(dependency.id, true) };\n\t\t\t\t\tgraph.insertEdge(item, d);\n\t\t\t\t\tstack.push(d);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\twhile (true) {\n\t\t\tconst roots = graph.roots();\n\n\t\t\t// if there is no more roots but still\n\t\t\t// nodes in the graph we have a cycle\n\t\t\tif (roots.length === 0) {\n\t\t\t\tif (!graph.isEmpty()) {\n\t\t\t\t\tthrow new CyclicDependencyError(graph);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tfor (const { data } of roots) {\n\t\t\t\t// Repeat the check for this still being a service sync descriptor. That's because\n\t\t\t\t// instantiating a dependency might have side-effect and recursively trigger instantiation\n\t\t\t\t// so that some dependencies are now fullfilled already.\n\t\t\t\tconst instanceOrDesc = this._getServiceInstanceOrDescriptor(data.id);\n\t\t\t\tif (instanceOrDesc instanceof SyncDescriptor) {\n\t\t\t\t\t// create instance and overwrite the service collections\n\t\t\t\t\tconst instance = this._createServiceInstanceWithOwner(data.id, data.desc.ctor, data.desc.staticArguments, data.desc.supportsDelayedInstantiation, data._trace);\n\t\t\t\t\tthis._setServiceInstance(data.id, instance);\n\t\t\t\t}\n\t\t\t\tgraph.removeNode(data);\n\t\t\t}\n\t\t}\n\t\treturn <T>this._getServiceInstanceOrDescriptor(id);\n\t}\n\n\tprivate _createServiceInstanceWithOwner<T>(id: ServiceIdentifier<T>, ctor: any, args: any[] = [], supportsDelayedInstantiation: boolean, _trace: Trace): T {\n\t\tif (this._services.get(id) instanceof SyncDescriptor) {\n\t\t\treturn this._createServiceInstance(ctor, args, supportsDelayedInstantiation, _trace);\n\t\t} else if (this._parent) {\n\t\t\treturn this._parent._createServiceInstanceWithOwner(id, ctor, args, supportsDelayedInstantiation, _trace);\n\t\t} else {\n\t\t\tthrow new Error(`illegalState - creating UNKNOWN service instance ${ctor.name}`);\n\t\t}\n\t}\n\n\tprivate _createServiceInstance<T>(ctor: any, args: any[] = [], _supportsDelayedInstantiation: boolean, _trace: Trace): T {\n\t\tif (!_supportsDelayedInstantiation) {\n\t\t\t// eager instantiation\n\t\t\treturn this._createInstance(ctor, args, _trace);\n\n\t\t} else {\n\t\t\t// Return a proxy object that's backed by an idle value. That\n\t\t\t// strategy is to instantiate services in our idle time or when actually\n\t\t\t// needed but not when injected into a consumer\n\t\t\tconst idle = new IdleValue<any>(() => this._createInstance<T>(ctor, args, _trace));\n\t\t\treturn <T>new Proxy(Object.create(null), {\n\t\t\t\tget(target: any, key: PropertyKey): any {\n\t\t\t\t\tif (key in target) {\n\t\t\t\t\t\treturn target[key];\n\t\t\t\t\t}\n\t\t\t\t\tconst obj = idle.value;\n\t\t\t\t\tlet prop = obj[key];\n\t\t\t\t\tif (typeof prop !== 'function') {\n\t\t\t\t\t\treturn prop;\n\t\t\t\t\t}\n\t\t\t\t\tprop = prop.bind(obj);\n\t\t\t\t\ttarget[key] = prop;\n\t\t\t\t\treturn prop;\n\t\t\t\t},\n\t\t\t\tset(_target: T, p: PropertyKey, value: any): boolean {\n\t\t\t\t\tidle.value[p] = value;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate _throwIfStrict(msg: string, printWarning: boolean): void {\n\t\tif (printWarning) {\n\t\t\tconsole.warn(msg);\n\t\t}\n\t\tif (this._strict) {\n\t\t\tthrow new Error(msg);\n\t\t}\n\t}\n}\n\n//#region -- tracing ---\n\nconst enum TraceType {\n\tCreation, Invocation, Branch\n}\n\nexport class Trace {\n\n\tprivate static readonly _None = new class extends Trace {\n\t\tconstructor() { super(-1, null); }\n\t\toverride stop() { }\n\t\toverride branch() { return this; }\n\t};\n\n\tstatic traceInvocation(ctor: any): Trace {\n\t\treturn !_enableTracing ? Trace._None : new Trace(TraceType.Invocation, ctor.name || (ctor.toString() as string).substring(0, 42).replace(/\\n/g, ''));\n\t}\n\n\tstatic traceCreation(ctor: any): Trace {\n\t\treturn !_enableTracing ? Trace._None : new Trace(TraceType.Creation, ctor.name);\n\t}\n\n\tprivate static _totals: number = 0;\n\tprivate readonly _start: number = Date.now();\n\tprivate readonly _dep: [ServiceIdentifier<any>, boolean, Trace?][] = [];\n\n\tprivate constructor(\n\t\treadonly type: TraceType,\n\t\treadonly name: string | null\n\t) { }\n\n\tbranch(id: ServiceIdentifier<any>, first: boolean): Trace {\n\t\tconst child = new Trace(TraceType.Branch, id.toString());\n\t\tthis._dep.push([id, first, child]);\n\t\treturn child;\n\t}\n\n\tstop() {\n\t\tconst dur = Date.now() - this._start;\n\t\tTrace._totals += dur;\n\n\t\tlet causedCreation = false;\n\n\t\tfunction printChild(n: number, trace: Trace) {\n\t\t\tconst res: string[] = [];\n\t\t\tconst prefix = new Array(n + 1).join('\\t');\n\t\t\tfor (const [id, first, child] of trace._dep) {\n\t\t\t\tif (first && child) {\n\t\t\t\t\tcausedCreation = true;\n\t\t\t\t\tres.push(`${prefix}CREATES -> ${id}`);\n\t\t\t\t\tconst nested = printChild(n + 1, child);\n\t\t\t\t\tif (nested) {\n\t\t\t\t\t\tres.push(nested);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tres.push(`${prefix}uses -> ${id}`);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn res.join('\\n');\n\t\t}\n\n\t\tconst lines = [\n\t\t\t`${this.type === TraceType.Creation ? 'CREATE' : 'CALL'} ${this.name}`,\n\t\t\t`${printChild(1, this)}`,\n\t\t\t`DONE, took ${dur.toFixed(2)}ms (grand total ${Trace._totals.toFixed(2)}ms)`\n\t\t];\n\n\t\tif (dur > 2 || causedCreation) {\n\t\t\tconsole.log(lines.join('\\n'));\n\t\t}\n\t}\n}\n\n//#endregion\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { toErrorMessage } from 'vs/base/common/errorMessage';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { Disposable, IDisposable } from 'vs/base/common/lifecycle';\nimport { isWindows } from 'vs/base/common/platform';\nimport { URI } from 'vs/base/common/uri';\nimport { IEnvironmentService } from 'vs/platform/environment/common/environment';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\n\nexport const ILogService = createDecorator<ILogService>('logService');\nexport const ILoggerService = createDecorator<ILoggerService>('loggerService');\n\nfunction now(): string {\n\treturn new Date().toISOString();\n}\n\nexport enum LogLevel {\n\tTrace,\n\tDebug,\n\tInfo,\n\tWarning,\n\tError,\n\tCritical,\n\tOff\n}\n\nexport const DEFAULT_LOG_LEVEL: LogLevel = LogLevel.Info;\n\nexport interface ILogger extends IDisposable {\n\tonDidChangeLogLevel: Event<LogLevel>;\n\tgetLevel(): LogLevel;\n\tsetLevel(level: LogLevel): void;\n\n\ttrace(message: string, ...args: any[]): void;\n\tdebug(message: string, ...args: any[]): void;\n\tinfo(message: string, ...args: any[]): void;\n\twarn(message: string, ...args: any[]): void;\n\terror(message: string | Error, ...args: any[]): void;\n\tcritical(message: string | Error, ...args: any[]): void;\n\n\t/**\n\t * An operation to flush the contents. Can be synchronous.\n\t */\n\tflush(): void;\n}\n\nexport function log(logger: ILogger, level: LogLevel, message: string): void {\n\tswitch (level) {\n\t\tcase LogLevel.Trace: logger.trace(message); break;\n\t\tcase LogLevel.Debug: logger.debug(message); break;\n\t\tcase LogLevel.Info: logger.info(message); break;\n\t\tcase LogLevel.Warning: logger.warn(message); break;\n\t\tcase LogLevel.Error: logger.error(message); break;\n\t\tcase LogLevel.Critical: logger.critical(message); break;\n\t\tdefault: throw new Error('Invalid log level');\n\t}\n}\n\nexport function format(args: any): string {\n\tlet result = '';\n\n\tfor (let i = 0; i < args.length; i++) {\n\t\tlet a = args[i];\n\n\t\tif (typeof a === 'object') {\n\t\t\ttry {\n\t\t\t\ta = JSON.stringify(a);\n\t\t\t} catch (e) { }\n\t\t}\n\n\t\tresult += (i > 0 ? ' ' : '') + a;\n\t}\n\n\treturn result;\n}\n\nexport interface ILogService extends ILogger {\n\treadonly _serviceBrand: undefined;\n}\n\nexport interface ILoggerOptions {\n\n\t/**\n\t * Name of the logger.\n\t */\n\tname?: string;\n\n\t/**\n\t * Do not create rotating files if max size exceeds.\n\t */\n\tdonotRotate?: boolean;\n\n\t/**\n\t * Do not use formatters.\n\t */\n\tdonotUseFormatters?: boolean;\n\n\t/**\n\t * If set, logger logs the message always.\n\t */\n\talways?: boolean;\n}\n\nexport interface ILoggerService {\n\treadonly _serviceBrand: undefined;\n\n\t/**\n\t * Creates a logger, or gets one if it already exists.\n\t */\n\tcreateLogger(file: URI, options?: ILoggerOptions): ILogger;\n\n\t/**\n\t * Gets an existing logger, if any.\n\t */\n\tgetLogger(file: URI): ILogger | undefined;\n}\n\nexport abstract class AbstractLogger extends Disposable {\n\n\tprivate level: LogLevel = DEFAULT_LOG_LEVEL;\n\tprivate readonly _onDidChangeLogLevel: Emitter<LogLevel> = this._register(new Emitter<LogLevel>());\n\treadonly onDidChangeLogLevel: Event<LogLevel> = this._onDidChangeLogLevel.event;\n\n\tsetLevel(level: LogLevel): void {\n\t\tif (this.level !== level) {\n\t\t\tthis.level = level;\n\t\t\tthis._onDidChangeLogLevel.fire(this.level);\n\t\t}\n\t}\n\n\tgetLevel(): LogLevel {\n\t\treturn this.level;\n\t}\n\n}\n\nexport abstract class AbstractMessageLogger extends AbstractLogger implements ILogger {\n\n\tprotected abstract log(level: LogLevel, message: string): void;\n\n\tconstructor(private readonly logAlways?: boolean) {\n\t\tsuper();\n\t}\n\n\tprivate checkLogLevel(level: LogLevel): boolean {\n\t\treturn this.logAlways || this.getLevel() <= level;\n\t}\n\n\ttrace(message: string, ...args: any[]): void {\n\t\tif (this.checkLogLevel(LogLevel.Trace)) {\n\t\t\tthis.log(LogLevel.Trace, format([message, ...args]));\n\t\t}\n\t}\n\n\tdebug(message: string, ...args: any[]): void {\n\t\tif (this.checkLogLevel(LogLevel.Debug)) {\n\t\t\tthis.log(LogLevel.Debug, format([message, ...args]));\n\t\t}\n\t}\n\n\tinfo(message: string, ...args: any[]): void {\n\t\tif (this.checkLogLevel(LogLevel.Info)) {\n\t\t\tthis.log(LogLevel.Info, format([message, ...args]));\n\t\t}\n\t}\n\n\twarn(message: string, ...args: any[]): void {\n\t\tif (this.checkLogLevel(LogLevel.Warning)) {\n\t\t\tthis.log(LogLevel.Warning, format([message, ...args]));\n\t\t}\n\t}\n\n\terror(message: string | Error, ...args: any[]): void {\n\t\tif (this.checkLogLevel(LogLevel.Error)) {\n\n\t\t\tif (message instanceof Error) {\n\t\t\t\tconst array = Array.prototype.slice.call(arguments) as any[];\n\t\t\t\tarray[0] = message.stack;\n\t\t\t\tthis.log(LogLevel.Error, format(array));\n\t\t\t} else {\n\t\t\t\tthis.log(LogLevel.Error, format([message, ...args]));\n\t\t\t}\n\t\t}\n\t}\n\n\tcritical(message: string | Error, ...args: any[]): void {\n\t\tif (this.checkLogLevel(LogLevel.Critical)) {\n\t\t\tthis.log(LogLevel.Critical, format([message, ...args]));\n\t\t}\n\t}\n\n\tflush(): void { }\n}\n\n\nexport class ConsoleMainLogger extends AbstractLogger implements ILogger {\n\n\tprivate useColors: boolean;\n\n\tconstructor(logLevel: LogLevel = DEFAULT_LOG_LEVEL) {\n\t\tsuper();\n\t\tthis.setLevel(logLevel);\n\t\tthis.useColors = !isWindows;\n\t}\n\n\ttrace(message: string, ...args: any[]): void {\n\t\tif (this.getLevel() <= LogLevel.Trace) {\n\t\t\tif (this.useColors) {\n\t\t\t\tconsole.log(`\\x1b[90m[main ${now()}]\\x1b[0m`, message, ...args);\n\t\t\t} else {\n\t\t\t\tconsole.log(`[main ${now()}]`, message, ...args);\n\t\t\t}\n\t\t}\n\t}\n\n\tdebug(message: string, ...args: any[]): void {\n\t\tif (this.getLevel() <= LogLevel.Debug) {\n\t\t\tif (this.useColors) {\n\t\t\t\tconsole.log(`\\x1b[90m[main ${now()}]\\x1b[0m`, message, ...args);\n\t\t\t} else {\n\t\t\t\tconsole.log(`[main ${now()}]`, message, ...args);\n\t\t\t}\n\t\t}\n\t}\n\n\tinfo(message: string, ...args: any[]): void {\n\t\tif (this.getLevel() <= LogLevel.Info) {\n\t\t\tif (this.useColors) {\n\t\t\t\tconsole.log(`\\x1b[90m[main ${now()}]\\x1b[0m`, message, ...args);\n\t\t\t} else {\n\t\t\t\tconsole.log(`[main ${now()}]`, message, ...args);\n\t\t\t}\n\t\t}\n\t}\n\n\twarn(message: string | Error, ...args: any[]): void {\n\t\tif (this.getLevel() <= LogLevel.Warning) {\n\t\t\tif (this.useColors) {\n\t\t\t\tconsole.warn(`\\x1b[93m[main ${now()}]\\x1b[0m`, message, ...args);\n\t\t\t} else {\n\t\t\t\tconsole.warn(`[main ${now()}]`, message, ...args);\n\t\t\t}\n\t\t}\n\t}\n\n\terror(message: string, ...args: any[]): void {\n\t\tif (this.getLevel() <= LogLevel.Error) {\n\t\t\tif (this.useColors) {\n\t\t\t\tconsole.error(`\\x1b[91m[main ${now()}]\\x1b[0m`, message, ...args);\n\t\t\t} else {\n\t\t\t\tconsole.error(`[main ${now()}]`, message, ...args);\n\t\t\t}\n\t\t}\n\t}\n\n\tcritical(message: string, ...args: any[]): void {\n\t\tif (this.getLevel() <= LogLevel.Critical) {\n\t\t\tif (this.useColors) {\n\t\t\t\tconsole.error(`\\x1b[90m[main ${now()}]\\x1b[0m`, message, ...args);\n\t\t\t} else {\n\t\t\t\tconsole.error(`[main ${now()}]`, message, ...args);\n\t\t\t}\n\t\t}\n\t}\n\n\toverride dispose(): void {\n\t\t// noop\n\t}\n\n\tflush(): void {\n\t\t// noop\n\t}\n\n}\n\nexport class ConsoleLogger extends AbstractLogger implements ILogger {\n\n\tconstructor(logLevel: LogLevel = DEFAULT_LOG_LEVEL) {\n\t\tsuper();\n\t\tthis.setLevel(logLevel);\n\t}\n\n\ttrace(message: string, ...args: any[]): void {\n\t\tif (this.getLevel() <= LogLevel.Trace) {\n\t\t\tconsole.log('%cTRACE', 'color: #888', message, ...args);\n\t\t}\n\t}\n\n\tdebug(message: string, ...args: any[]): void {\n\t\tif (this.getLevel() <= LogLevel.Debug) {\n\t\t\tconsole.log('%cDEBUG', 'background: #eee; color: #888', message, ...args);\n\t\t}\n\t}\n\n\tinfo(message: string, ...args: any[]): void {\n\t\tif (this.getLevel() <= LogLevel.Info) {\n\t\t\tconsole.log('%c INFO', 'color: #33f', message, ...args);\n\t\t}\n\t}\n\n\twarn(message: string | Error, ...args: any[]): void {\n\t\tif (this.getLevel() <= LogLevel.Warning) {\n\t\t\tconsole.log('%c WARN', 'color: #993', message, ...args);\n\t\t}\n\t}\n\n\terror(message: string, ...args: any[]): void {\n\t\tif (this.getLevel() <= LogLevel.Error) {\n\t\t\tconsole.log('%c  ERR', 'color: #f33', message, ...args);\n\t\t}\n\t}\n\n\tcritical(message: string, ...args: any[]): void {\n\t\tif (this.getLevel() <= LogLevel.Critical) {\n\t\t\tconsole.log('%cCRITI', 'background: #f33; color: white', message, ...args);\n\t\t}\n\t}\n\n\toverride dispose(): void {\n\t\t// noop\n\t}\n\n\tflush(): void {\n\t\t// noop\n\t}\n}\n\nexport class AdapterLogger extends AbstractLogger implements ILogger {\n\n\tconstructor(private readonly adapter: { log: (logLevel: LogLevel, args: any[]) => void }, logLevel: LogLevel = DEFAULT_LOG_LEVEL) {\n\t\tsuper();\n\t\tthis.setLevel(logLevel);\n\t}\n\n\ttrace(message: string, ...args: any[]): void {\n\t\tif (this.getLevel() <= LogLevel.Trace) {\n\t\t\tthis.adapter.log(LogLevel.Trace, [this.extractMessage(message), ...args]);\n\t\t}\n\t}\n\n\tdebug(message: string, ...args: any[]): void {\n\t\tif (this.getLevel() <= LogLevel.Debug) {\n\t\t\tthis.adapter.log(LogLevel.Debug, [this.extractMessage(message), ...args]);\n\t\t}\n\t}\n\n\tinfo(message: string, ...args: any[]): void {\n\t\tif (this.getLevel() <= LogLevel.Info) {\n\t\t\tthis.adapter.log(LogLevel.Info, [this.extractMessage(message), ...args]);\n\t\t}\n\t}\n\n\twarn(message: string | Error, ...args: any[]): void {\n\t\tif (this.getLevel() <= LogLevel.Warning) {\n\t\t\tthis.adapter.log(LogLevel.Warning, [this.extractMessage(message), ...args]);\n\t\t}\n\t}\n\n\terror(message: string | Error, ...args: any[]): void {\n\t\tif (this.getLevel() <= LogLevel.Error) {\n\t\t\tthis.adapter.log(LogLevel.Error, [this.extractMessage(message), ...args]);\n\t\t}\n\t}\n\n\tcritical(message: string | Error, ...args: any[]): void {\n\t\tif (this.getLevel() <= LogLevel.Critical) {\n\t\t\tthis.adapter.log(LogLevel.Critical, [this.extractMessage(message), ...args]);\n\t\t}\n\t}\n\n\tprivate extractMessage(msg: string | Error): string {\n\t\tif (typeof msg === 'string') {\n\t\t\treturn msg;\n\t\t}\n\n\t\treturn toErrorMessage(msg, this.getLevel() <= LogLevel.Trace);\n\t}\n\n\toverride dispose(): void {\n\t\t// noop\n\t}\n\n\tflush(): void {\n\t\t// noop\n\t}\n}\n\nexport class MultiplexLogService extends AbstractLogger implements ILogService {\n\tdeclare readonly _serviceBrand: undefined;\n\n\tconstructor(private readonly logServices: ReadonlyArray<ILogger>) {\n\t\tsuper();\n\t\tif (logServices.length) {\n\t\t\tthis.setLevel(logServices[0].getLevel());\n\t\t}\n\t}\n\n\toverride setLevel(level: LogLevel): void {\n\t\tfor (const logService of this.logServices) {\n\t\t\tlogService.setLevel(level);\n\t\t}\n\t\tsuper.setLevel(level);\n\t}\n\n\ttrace(message: string, ...args: any[]): void {\n\t\tfor (const logService of this.logServices) {\n\t\t\tlogService.trace(message, ...args);\n\t\t}\n\t}\n\n\tdebug(message: string, ...args: any[]): void {\n\t\tfor (const logService of this.logServices) {\n\t\t\tlogService.debug(message, ...args);\n\t\t}\n\t}\n\n\tinfo(message: string, ...args: any[]): void {\n\t\tfor (const logService of this.logServices) {\n\t\t\tlogService.info(message, ...args);\n\t\t}\n\t}\n\n\twarn(message: string, ...args: any[]): void {\n\t\tfor (const logService of this.logServices) {\n\t\t\tlogService.warn(message, ...args);\n\t\t}\n\t}\n\n\terror(message: string | Error, ...args: any[]): void {\n\t\tfor (const logService of this.logServices) {\n\t\t\tlogService.error(message, ...args);\n\t\t}\n\t}\n\n\tcritical(message: string | Error, ...args: any[]): void {\n\t\tfor (const logService of this.logServices) {\n\t\t\tlogService.critical(message, ...args);\n\t\t}\n\t}\n\n\tflush(): void {\n\t\tfor (const logService of this.logServices) {\n\t\t\tlogService.flush();\n\t\t}\n\t}\n\n\toverride dispose(): void {\n\t\tfor (const logService of this.logServices) {\n\t\t\tlogService.dispose();\n\t\t}\n\t}\n}\n\nexport class LogService extends Disposable implements ILogService {\n\tdeclare readonly _serviceBrand: undefined;\n\n\tconstructor(private logger: ILogger) {\n\t\tsuper();\n\t\tthis._register(logger);\n\t}\n\n\tget onDidChangeLogLevel(): Event<LogLevel> {\n\t\treturn this.logger.onDidChangeLogLevel;\n\t}\n\n\tsetLevel(level: LogLevel): void {\n\t\tthis.logger.setLevel(level);\n\t}\n\n\tgetLevel(): LogLevel {\n\t\treturn this.logger.getLevel();\n\t}\n\n\ttrace(message: string, ...args: any[]): void {\n\t\tthis.logger.trace(message, ...args);\n\t}\n\n\tdebug(message: string, ...args: any[]): void {\n\t\tthis.logger.debug(message, ...args);\n\t}\n\n\tinfo(message: string, ...args: any[]): void {\n\t\tthis.logger.info(message, ...args);\n\t}\n\n\twarn(message: string, ...args: any[]): void {\n\t\tthis.logger.warn(message, ...args);\n\t}\n\n\terror(message: string | Error, ...args: any[]): void {\n\t\tthis.logger.error(message, ...args);\n\t}\n\n\tcritical(message: string | Error, ...args: any[]): void {\n\t\tthis.logger.critical(message, ...args);\n\t}\n\n\tflush(): void {\n\t\tthis.logger.flush();\n\t}\n}\n\nexport abstract class AbstractLoggerService extends Disposable implements ILoggerService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate readonly loggers = new Map<string, ILogger>();\n\tprivate readonly logLevelChangeableLoggers: ILogger[] = [];\n\n\tconstructor(\n\t\tprivate logLevel: LogLevel,\n\t\tonDidChangeLogLevel: Event<LogLevel>,\n\t) {\n\t\tsuper();\n\t\tthis._register(onDidChangeLogLevel(logLevel => {\n\t\t\tthis.logLevel = logLevel;\n\t\t\tthis.logLevelChangeableLoggers.forEach(logger => logger.setLevel(logLevel));\n\t\t}));\n\t}\n\n\tgetLogger(resource: URI) {\n\t\treturn this.loggers.get(resource.toString());\n\t}\n\n\tcreateLogger(resource: URI, options?: ILoggerOptions): ILogger {\n\t\tlet logger = this.loggers.get(resource.toString());\n\t\tif (!logger) {\n\t\t\tlogger = this.doCreateLogger(resource, options?.always ? LogLevel.Trace : this.logLevel, options);\n\t\t\tthis.loggers.set(resource.toString(), logger);\n\t\t\tif (!options?.always) {\n\t\t\t\tthis.logLevelChangeableLoggers.push(logger);\n\t\t\t}\n\t\t}\n\t\treturn logger;\n\t}\n\n\toverride dispose(): void {\n\t\tthis.logLevelChangeableLoggers.splice(0, this.logLevelChangeableLoggers.length);\n\t\tthis.loggers.forEach(logger => logger.dispose());\n\t\tthis.loggers.clear();\n\t\tsuper.dispose();\n\t}\n\n\tprotected abstract doCreateLogger(resource: URI, logLevel: LogLevel, options?: ILoggerOptions): ILogger;\n}\n\nexport class NullLogService implements ILogService {\n\tdeclare readonly _serviceBrand: undefined;\n\treadonly onDidChangeLogLevel: Event<LogLevel> = new Emitter<LogLevel>().event;\n\tsetLevel(level: LogLevel): void { }\n\tgetLevel(): LogLevel { return LogLevel.Info; }\n\ttrace(message: string, ...args: any[]): void { }\n\tdebug(message: string, ...args: any[]): void { }\n\tinfo(message: string, ...args: any[]): void { }\n\twarn(message: string, ...args: any[]): void { }\n\terror(message: string | Error, ...args: any[]): void { }\n\tcritical(message: string | Error, ...args: any[]): void { }\n\tdispose(): void { }\n\tflush(): void { }\n}\n\nexport function getLogLevel(environmentService: IEnvironmentService): LogLevel {\n\tif (environmentService.verbose) {\n\t\treturn LogLevel.Trace;\n\t}\n\tif (typeof environmentService.logLevel === 'string') {\n\t\tconst logLevel = parseLogLevel(environmentService.logLevel.toLowerCase());\n\t\tif (logLevel !== undefined) {\n\t\t\treturn logLevel;\n\t\t}\n\t}\n\treturn DEFAULT_LOG_LEVEL;\n}\n\nexport function parseLogLevel(logLevel: string): LogLevel | undefined {\n\tswitch (logLevel) {\n\t\tcase 'trace':\n\t\t\treturn LogLevel.Trace;\n\t\tcase 'debug':\n\t\t\treturn LogLevel.Debug;\n\t\tcase 'info':\n\t\t\treturn LogLevel.Info;\n\t\tcase 'warn':\n\t\t\treturn LogLevel.Warning;\n\t\tcase 'error':\n\t\t\treturn LogLevel.Error;\n\t\tcase 'critical':\n\t\t\treturn LogLevel.Critical;\n\t\tcase 'off':\n\t\t\treturn LogLevel.Off;\n\t}\n\treturn undefined;\n}\n\nexport function LogLevelToString(logLevel: LogLevel): string {\n\tswitch (logLevel) {\n\t\tcase LogLevel.Trace: return 'trace';\n\t\tcase LogLevel.Debug: return 'debug';\n\t\tcase LogLevel.Info: return 'info';\n\t\tcase LogLevel.Warning: return 'warn';\n\t\tcase LogLevel.Error: return 'error';\n\t\tcase LogLevel.Critical: return 'critical';\n\t\tcase LogLevel.Off: return 'off';\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Event } from 'vs/base/common/event';\nimport Severity from 'vs/base/common/severity';\nimport { URI } from 'vs/base/common/uri';\nimport { localize } from 'vs/nls';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\n\nexport interface IMarkerService {\n\treadonly _serviceBrand: undefined;\n\n\tgetStatistics(): MarkerStatistics;\n\n\tchangeOne(owner: string, resource: URI, markers: IMarkerData[]): void;\n\n\tchangeAll(owner: string, data: IResourceMarker[]): void;\n\n\tremove(owner: string, resources: URI[]): void;\n\n\tread(filter?: { owner?: string; resource?: URI; severities?: number; take?: number }): IMarker[];\n\n\treadonly onMarkerChanged: Event<readonly URI[]>;\n}\n\n/**\n *\n */\nexport interface IRelatedInformation {\n\tresource: URI;\n\tmessage: string;\n\tstartLineNumber: number;\n\tstartColumn: number;\n\tendLineNumber: number;\n\tendColumn: number;\n}\n\nexport const enum MarkerTag {\n\tUnnecessary = 1,\n\tDeprecated = 2\n}\n\nexport enum MarkerSeverity {\n\tHint = 1,\n\tInfo = 2,\n\tWarning = 4,\n\tError = 8,\n}\n\nexport namespace MarkerSeverity {\n\n\texport function compare(a: MarkerSeverity, b: MarkerSeverity): number {\n\t\treturn b - a;\n\t}\n\n\tconst _displayStrings: { [value: number]: string } = Object.create(null);\n\t_displayStrings[MarkerSeverity.Error] = localize('sev.error', \"Error\");\n\t_displayStrings[MarkerSeverity.Warning] = localize('sev.warning', \"Warning\");\n\t_displayStrings[MarkerSeverity.Info] = localize('sev.info', \"Info\");\n\n\texport function toString(a: MarkerSeverity): string {\n\t\treturn _displayStrings[a] || '';\n\t}\n\n\texport function fromSeverity(severity: Severity): MarkerSeverity {\n\t\tswitch (severity) {\n\t\t\tcase Severity.Error: return MarkerSeverity.Error;\n\t\t\tcase Severity.Warning: return MarkerSeverity.Warning;\n\t\t\tcase Severity.Info: return MarkerSeverity.Info;\n\t\t\tcase Severity.Ignore: return MarkerSeverity.Hint;\n\t\t}\n\t}\n\n\texport function toSeverity(severity: MarkerSeverity): Severity {\n\t\tswitch (severity) {\n\t\t\tcase MarkerSeverity.Error: return Severity.Error;\n\t\t\tcase MarkerSeverity.Warning: return Severity.Warning;\n\t\t\tcase MarkerSeverity.Info: return Severity.Info;\n\t\t\tcase MarkerSeverity.Hint: return Severity.Ignore;\n\t\t}\n\t}\n}\n\n/**\n * A structure defining a problem/warning/etc.\n */\nexport interface IMarkerData {\n\tcode?: string | { value: string; target: URI };\n\tseverity: MarkerSeverity;\n\tmessage: string;\n\tsource?: string;\n\tstartLineNumber: number;\n\tstartColumn: number;\n\tendLineNumber: number;\n\tendColumn: number;\n\trelatedInformation?: IRelatedInformation[];\n\ttags?: MarkerTag[];\n}\n\nexport interface IResourceMarker {\n\tresource: URI;\n\tmarker: IMarkerData;\n}\n\nexport interface IMarker {\n\towner: string;\n\tresource: URI;\n\tseverity: MarkerSeverity;\n\tcode?: string | { value: string; target: URI };\n\tmessage: string;\n\tsource?: string;\n\tstartLineNumber: number;\n\tstartColumn: number;\n\tendLineNumber: number;\n\tendColumn: number;\n\trelatedInformation?: IRelatedInformation[];\n\ttags?: MarkerTag[];\n}\n\nexport interface MarkerStatistics {\n\terrors: number;\n\twarnings: number;\n\tinfos: number;\n\tunknowns: number;\n}\n\nexport namespace IMarkerData {\n\tconst emptyString = '';\n\texport function makeKey(markerData: IMarkerData): string {\n\t\treturn makeKeyOptionalMessage(markerData, true);\n\t}\n\n\texport function makeKeyOptionalMessage(markerData: IMarkerData, useMessage: boolean): string {\n\t\tconst result: string[] = [emptyString];\n\t\tif (markerData.source) {\n\t\t\tresult.push(markerData.source.replace('', '\\\\'));\n\t\t} else {\n\t\t\tresult.push(emptyString);\n\t\t}\n\t\tif (markerData.code) {\n\t\t\tif (typeof markerData.code === 'string') {\n\t\t\t\tresult.push(markerData.code.replace('', '\\\\'));\n\t\t\t} else {\n\t\t\t\tresult.push(markerData.code.value.replace('', '\\\\'));\n\t\t\t}\n\t\t} else {\n\t\t\tresult.push(emptyString);\n\t\t}\n\t\tif (markerData.severity !== undefined && markerData.severity !== null) {\n\t\t\tresult.push(MarkerSeverity.toString(markerData.severity));\n\t\t} else {\n\t\t\tresult.push(emptyString);\n\t\t}\n\n\t\t// Modifed to not include the message as part of the marker key to work around\n\t\t// https://github.com/microsoft/vscode/issues/77475\n\t\tif (markerData.message && useMessage) {\n\t\t\tresult.push(markerData.message.replace('', '\\\\'));\n\t\t} else {\n\t\t\tresult.push(emptyString);\n\t\t}\n\t\tif (markerData.startLineNumber !== undefined && markerData.startLineNumber !== null) {\n\t\t\tresult.push(markerData.startLineNumber.toString());\n\t\t} else {\n\t\t\tresult.push(emptyString);\n\t\t}\n\t\tif (markerData.startColumn !== undefined && markerData.startColumn !== null) {\n\t\t\tresult.push(markerData.startColumn.toString());\n\t\t} else {\n\t\t\tresult.push(emptyString);\n\t\t}\n\t\tif (markerData.endLineNumber !== undefined && markerData.endLineNumber !== null) {\n\t\t\tresult.push(markerData.endLineNumber.toString());\n\t\t} else {\n\t\t\tresult.push(emptyString);\n\t\t}\n\t\tif (markerData.endColumn !== undefined && markerData.endColumn !== null) {\n\t\t\tresult.push(markerData.endColumn.toString());\n\t\t} else {\n\t\t\tresult.push(emptyString);\n\t\t}\n\t\tresult.push(emptyString);\n\t\treturn result.join('');\n\t}\n}\n\nexport const IMarkerService = createDecorator<IMarkerService>('markerService');\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IAction } from 'vs/base/common/actions';\nimport { Event } from 'vs/base/common/event';\nimport { IDisposable } from 'vs/base/common/lifecycle';\nimport BaseSeverity from 'vs/base/common/severity';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\n\nexport import Severity = BaseSeverity;\n\nexport const INotificationService = createDecorator<INotificationService>('notificationService');\n\nexport type NotificationMessage = string | Error;\n\nexport interface INotificationProperties {\n\n\t/**\n\t * Sticky notifications are not automatically removed after a certain timeout. By\n\t * default, notifications with primary actions and severity error are always sticky.\n\t */\n\treadonly sticky?: boolean;\n\n\t/**\n\t * Silent notifications are not shown to the user unless the notification center\n\t * is opened. The status bar will still indicate all number of notifications to\n\t * catch some attention.\n\t */\n\treadonly silent?: boolean;\n\n\t/**\n\t * Adds an action to never show the notification again. The choice will be persisted\n\t * such as future requests will not cause the notification to show again.\n\t */\n\treadonly neverShowAgain?: INeverShowAgainOptions;\n}\n\nexport enum NeverShowAgainScope {\n\n\t/**\n\t * Will never show this notification on the current workspace again.\n\t */\n\tWORKSPACE,\n\n\t/**\n\t * Will never show this notification on any workspace of the same\n\t * profile again.\n\t */\n\tPROFILE,\n\n\t/**\n\t * Will never show this notification on any workspace across all\n\t * profiles again.\n\t */\n\tAPPLICATION\n}\n\nexport interface INeverShowAgainOptions {\n\n\t/**\n\t * The id is used to persist the selection of not showing the notification again.\n\t */\n\treadonly id: string;\n\n\t/**\n\t * By default the action will show up as primary action. Setting this to true will\n\t * make it a secondary action instead.\n\t */\n\treadonly isSecondary?: boolean;\n\n\t/**\n\t * Whether to persist the choice in the current workspace or for all workspaces. By\n\t * default it will be persisted for all workspaces across all profiles\n\t * (= `NeverShowAgainScope.APPLICATION`).\n\t */\n\treadonly scope?: NeverShowAgainScope;\n}\n\nexport interface INotification extends INotificationProperties {\n\n\t/**\n\t * The id of the notification. If provided, will be used to compare\n\t * notifications with others to decide whether a notification is\n\t * duplicate or not.\n\t */\n\treadonly id?: string;\n\n\t/**\n\t * The severity of the notification. Either `Info`, `Warning` or `Error`.\n\t */\n\treadonly severity: Severity;\n\n\t/**\n\t * The message of the notification. This can either be a `string` or `Error`. Messages\n\t * can optionally include links in the format: `[text](link)`\n\t */\n\treadonly message: NotificationMessage;\n\n\t/**\n\t * The source of the notification appears as additional information.\n\t */\n\treadonly source?: string | { label: string; id: string };\n\n\t/**\n\t * Actions to show as part of the notification. Primary actions show up as\n\t * buttons as part of the message and will close the notification once clicked.\n\t *\n\t * Secondary actions are meant to provide additional configuration or context\n\t * for the notification and will show up less prominent. A notification does not\n\t * close automatically when invoking a secondary action.\n\t *\n\t * **Note:** If your intent is to show a message with actions to the user, consider\n\t * the `INotificationService.prompt()` method instead which are optimized for\n\t * this usecase and much easier to use!\n\t */\n\tactions?: INotificationActions;\n\n\t/**\n\t * The initial set of progress properties for the notification. To update progress\n\t * later on, access the `INotificationHandle.progress` property.\n\t */\n\treadonly progress?: INotificationProgressProperties;\n}\n\nexport interface INotificationActions {\n\n\t/**\n\t * Primary actions show up as buttons as part of the message and will close\n\t * the notification once clicked.\n\t *\n\t * Pass `ActionWithMenuAction` for an action that has additional menu actions.\n\t */\n\treadonly primary?: readonly IAction[];\n\n\t/**\n\t * Secondary actions are meant to provide additional configuration or context\n\t * for the notification and will show up less prominent. A notification does not\n\t * close automatically when invoking a secondary action.\n\t */\n\treadonly secondary?: readonly IAction[];\n}\n\nexport interface INotificationProgressProperties {\n\n\t/**\n\t * Causes the progress bar to spin infinitley.\n\t */\n\treadonly infinite?: boolean;\n\n\t/**\n\t * Indicate the total amount of work.\n\t */\n\treadonly total?: number;\n\n\t/**\n\t * Indicate that a specific chunk of work is done.\n\t */\n\treadonly worked?: number;\n}\n\nexport interface INotificationProgress {\n\n\t/**\n\t * Causes the progress bar to spin infinitley.\n\t */\n\tinfinite(): void;\n\n\t/**\n\t * Indicate the total amount of work.\n\t */\n\ttotal(value: number): void;\n\n\t/**\n\t * Indicate that a specific chunk of work is done.\n\t */\n\tworked(value: number): void;\n\n\t/**\n\t * Indicate that the long running operation is done.\n\t */\n\tdone(): void;\n}\n\nexport interface INotificationHandle {\n\n\t/**\n\t * Will be fired once the notification is closed.\n\t */\n\treadonly onDidClose: Event<void>;\n\n\t/**\n\t * Will be fired whenever the visibility of the notification changes.\n\t * A notification can either be visible as toast or inside the notification\n\t * center if it is visible.\n\t */\n\treadonly onDidChangeVisibility: Event<boolean>;\n\n\t/**\n\t * Allows to indicate progress on the notification even after the\n\t * notification is already visible.\n\t */\n\treadonly progress: INotificationProgress;\n\n\t/**\n\t * Allows to update the severity of the notification.\n\t */\n\tupdateSeverity(severity: Severity): void;\n\n\t/**\n\t * Allows to update the message of the notification even after the\n\t * notification is already visible.\n\t */\n\tupdateMessage(message: NotificationMessage): void;\n\n\t/**\n\t * Allows to update the actions of the notification even after the\n\t * notification is already visible.\n\t */\n\tupdateActions(actions?: INotificationActions): void;\n\n\t/**\n\t * Hide the notification and remove it from the notification center.\n\t */\n\tclose(): void;\n}\n\ninterface IBasePromptChoice {\n\n\t/**\n\t * Label to show for the choice to the user.\n\t */\n\treadonly label: string;\n\n\t/**\n\t * Whether to keep the notification open after the choice was selected\n\t * by the user. By default, will close the notification upon click.\n\t */\n\treadonly keepOpen?: boolean;\n\n\t/**\n\t * Triggered when the user selects the choice.\n\t */\n\trun: () => void;\n}\n\nexport interface IPromptChoice extends IBasePromptChoice {\n\n\t/**\n\t * Primary choices show up as buttons in the notification below the message.\n\t * Secondary choices show up under the gear icon in the header of the notification.\n\t */\n\treadonly isSecondary?: boolean;\n}\n\nexport interface IPromptChoiceWithMenu extends IPromptChoice {\n\n\t/**\n\t * Additional choices those will be shown in the dropdown menu for this choice.\n\t */\n\treadonly menu: IBasePromptChoice[];\n\n\t/**\n\t * Menu is not supported on secondary choices\n\t */\n\treadonly isSecondary: false | undefined;\n}\n\nexport interface IPromptOptions extends INotificationProperties {\n\n\t/**\n\t * Will be called if the user closed the notification without picking\n\t * any of the provided choices.\n\t */\n\tonCancel?: () => void;\n}\n\nexport interface IStatusMessageOptions {\n\n\t/**\n\t * An optional timeout after which the status message should show. By default\n\t * the status message will show immediately.\n\t */\n\treadonly showAfter?: number;\n\n\t/**\n\t * An optional timeout after which the status message is to be hidden. By default\n\t * the status message will not hide until another status message is displayed.\n\t */\n\treadonly hideAfter?: number;\n}\n\nexport enum NotificationsFilter {\n\n\t/**\n\t * No filter is enabled.\n\t */\n\tOFF,\n\n\t/**\n\t * All notifications are configured as silent. See\n\t * `INotificationProperties.silent` for more info.\n\t */\n\tSILENT,\n\n\t/**\n\t * All notifications are silent except error notifications.\n\t*/\n\tERROR\n}\n\n/**\n * A service to bring up notifications and non-modal prompts.\n *\n * Note: use the `IDialogService` for a modal way to ask the user for input.\n */\nexport interface INotificationService {\n\n\treadonly _serviceBrand: undefined;\n\n\t/**\n\t * The DND mode can be enabled or disabled\n\t * and will result in all info and warning\n\t * notifications to be silent.\n\t */\n\tdoNotDisturbMode: boolean;\n\n\t/**\n\t * Emitted when a new notification is added.\n\t */\n\treadonly onDidAddNotification: Event<INotification>;\n\n\t/**\n\t * Emitted when a notification is removed.\n\t */\n\treadonly onDidRemoveNotification: Event<INotification>;\n\n\t/**\n\t * Emitted when a do not disturb mode has changed.\n\t */\n\treadonly onDidChangeDoNotDisturbMode: Event<void>;\n\n\t/**\n\t * Show the provided notification to the user. The returned `INotificationHandle`\n\t * can be used to control the notification afterwards.\n\t *\n\t * **Note:** If your intent is to show a message with actions to the user, consider\n\t * the `INotificationService.prompt()` method instead which are optimized for\n\t * this usecase and much easier to use!\n\t *\n\t * @returns a handle on the notification to e.g. hide it or update message, buttons, etc.\n\t */\n\tnotify(notification: INotification): INotificationHandle;\n\n\t/**\n\t * A convenient way of reporting infos. Use the `INotificationService.notify`\n\t * method if you need more control over the notification.\n\t */\n\tinfo(message: NotificationMessage | NotificationMessage[]): void;\n\n\t/**\n\t * A convenient way of reporting warnings. Use the `INotificationService.notify`\n\t * method if you need more control over the notification.\n\t */\n\twarn(message: NotificationMessage | NotificationMessage[]): void;\n\n\t/**\n\t * A convenient way of reporting errors. Use the `INotificationService.notify`\n\t * method if you need more control over the notification.\n\t */\n\terror(message: NotificationMessage | NotificationMessage[]): void;\n\n\t/**\n\t * Shows a prompt in the notification area with the provided choices. The prompt\n\t * is non-modal. If you want to show a modal dialog instead, use `IDialogService`.\n\t *\n\t * @param severity the severity of the notification. Either `Info`, `Warning` or `Error`.\n\t * @param message the message to show as status.\n\t * @param choices options to be chosen from.\n\t * @param options provides some optional configuration options.\n\t *\n\t * @returns a handle on the notification to e.g. hide it or update message, buttons, etc.\n\t */\n\tprompt(severity: Severity, message: string, choices: (IPromptChoice | IPromptChoiceWithMenu)[], options?: IPromptOptions): INotificationHandle;\n\n\t/**\n\t * Shows a status message in the status area with the provided text.\n\t *\n\t * @param message the message to show as status\n\t * @param options provides some optional configuration options\n\t *\n\t * @returns a disposable to hide the status message\n\t */\n\tstatus(message: NotificationMessage, options?: IStatusMessageOptions): IDisposable;\n}\n\nexport class NoOpNotification implements INotificationHandle {\n\n\treadonly progress = new NoOpProgress();\n\n\treadonly onDidClose = Event.None;\n\treadonly onDidChangeVisibility = Event.None;\n\n\tupdateSeverity(severity: Severity): void { }\n\tupdateMessage(message: NotificationMessage): void { }\n\tupdateActions(actions?: INotificationActions): void { }\n\n\tclose(): void { }\n}\n\nexport class NoOpProgress implements INotificationProgress {\n\tinfinite(): void { }\n\tdone(): void { }\n\ttotal(value: number): void { }\n\tworked(value: number): void { }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { Disposable, IDisposable } from 'vs/base/common/lifecycle';\nimport { equalsIgnoreCase, startsWithIgnoreCase } from 'vs/base/common/strings';\nimport { URI } from 'vs/base/common/uri';\nimport { IEditorOptions, ITextEditorSelection } from 'vs/platform/editor/common/editor';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\n\nexport const IOpenerService = createDecorator<IOpenerService>('openerService');\n\nexport type OpenInternalOptions = {\n\n\t/**\n\t * Signals that the intent is to open an editor to the side\n\t * of the currently active editor.\n\t */\n\treadonly openToSide?: boolean;\n\n\t/**\n\t * Extra editor options to apply in case an editor is used to open.\n\t */\n\treadonly editorOptions?: IEditorOptions;\n\n\t/**\n\t * Signals that the editor to open was triggered through a user\n\t * action, such as keyboard or mouse usage.\n\t */\n\treadonly fromUserGesture?: boolean;\n\n\t/**\n\t * Allow command links to be handled.\n\t */\n\treadonly allowCommands?: boolean;\n};\n\nexport type OpenExternalOptions = {\n\treadonly openExternal?: boolean;\n\treadonly allowTunneling?: boolean;\n\treadonly allowContributedOpeners?: boolean | string;\n\treadonly fromWorkspace?: boolean;\n};\n\nexport type OpenOptions = OpenInternalOptions & OpenExternalOptions;\n\nexport type ResolveExternalUriOptions = { readonly allowTunneling?: boolean };\n\nexport interface IResolvedExternalUri extends IDisposable {\n\tresolved: URI;\n}\n\nexport interface IOpener {\n\topen(resource: URI | string, options?: OpenInternalOptions | OpenExternalOptions): Promise<boolean>;\n}\n\nexport interface IExternalOpener {\n\topenExternal(href: string, ctx: { sourceUri: URI; preferredOpenerId?: string }, token: CancellationToken): Promise<boolean>;\n\tdispose?(): void;\n}\n\nexport interface IValidator {\n\tshouldOpen(resource: URI | string, openOptions?: OpenOptions): Promise<boolean>;\n}\n\nexport interface IExternalUriResolver {\n\tresolveExternalUri(resource: URI, options?: OpenOptions): Promise<{ resolved: URI; dispose(): void } | undefined>;\n}\n\nexport interface IOpenerService {\n\n\treadonly _serviceBrand: undefined;\n\n\t/**\n\t * Register a participant that can handle the open() call.\n\t */\n\tregisterOpener(opener: IOpener): IDisposable;\n\n\t/**\n\t * Register a participant that can validate if the URI resource be opened.\n\t * Validators are run before openers.\n\t */\n\tregisterValidator(validator: IValidator): IDisposable;\n\n\t/**\n\t * Register a participant that can resolve an external URI resource to be opened.\n\t */\n\tregisterExternalUriResolver(resolver: IExternalUriResolver): IDisposable;\n\n\t/**\n\t * Sets the handler for opening externally. If not provided,\n\t * a default handler will be used.\n\t */\n\tsetDefaultExternalOpener(opener: IExternalOpener): void;\n\n\t/**\n\t * Registers a new opener external resources openers.\n\t */\n\tregisterExternalOpener(opener: IExternalOpener): IDisposable;\n\n\t/**\n\t * Opens a resource, like a webaddress, a document uri, or executes command.\n\t *\n\t * @param resource A resource\n\t * @return A promise that resolves when the opening is done.\n\t */\n\topen(resource: URI | string, options?: OpenInternalOptions | OpenExternalOptions): Promise<boolean>;\n\n\t/**\n\t * Resolve a resource to its external form.\n\t * @throws whenever resolvers couldn't resolve this resource externally.\n\t */\n\tresolveExternalUri(resource: URI, options?: ResolveExternalUriOptions): Promise<IResolvedExternalUri>;\n}\n\nexport const NullOpenerService = Object.freeze({\n\t_serviceBrand: undefined,\n\tregisterOpener() { return Disposable.None; },\n\tregisterValidator() { return Disposable.None; },\n\tregisterExternalUriResolver() { return Disposable.None; },\n\tsetDefaultExternalOpener() { },\n\tregisterExternalOpener() { return Disposable.None; },\n\tasync open() { return false; },\n\tasync resolveExternalUri(uri: URI) { return { resolved: uri, dispose() { } }; },\n} as IOpenerService);\n\nexport function matchesScheme(target: URI | string, scheme: string): boolean {\n\tif (URI.isUri(target)) {\n\t\treturn equalsIgnoreCase(target.scheme, scheme);\n\t} else {\n\t\treturn startsWithIgnoreCase(target, scheme + ':');\n\t}\n}\n\nexport function matchesSomeScheme(target: URI | string, ...schemes: string[]): boolean {\n\treturn schemes.some(scheme => matchesScheme(target, scheme));\n}\n\n/**\n * Encodes selection into the `URI`.\n *\n * IMPORTANT: you MUST use `extractSelection` to separate the selection\n * again from the original `URI` before passing the `URI` into any\n * component that is not aware of selections.\n */\nexport function withSelection(uri: URI, selection: ITextEditorSelection): URI {\n\treturn uri.with({ fragment: `${selection.startLineNumber},${selection.startColumn}${selection.endLineNumber ? `-${selection.endLineNumber}${selection.endColumn ? `,${selection.endColumn}` : ''}` : ''}` });\n}\n\n/**\n * file:///some/file.js#73\n * file:///some/file.js#L73\n * file:///some/file.js#73,84\n * file:///some/file.js#L73,84\n * file:///some/file.js#73-83\n * file:///some/file.js#L73-L83\n * file:///some/file.js#73,84-83,52\n * file:///some/file.js#L73,84-L83,52\n */\nexport function extractSelection(uri: URI): { selection: ITextEditorSelection | undefined; uri: URI } {\n\tlet selection: ITextEditorSelection | undefined = undefined;\n\tconst match = /^L?(\\d+)(?:,(\\d+))?(-L?(\\d+)(?:,(\\d+))?)?/.exec(uri.fragment);\n\tif (match) {\n\t\tselection = {\n\t\t\tstartLineNumber: parseInt(match[1]),\n\t\t\tstartColumn: match[2] ? parseInt(match[2]) : 1,\n\t\t\tendLineNumber: match[4] ? parseInt(match[4]) : undefined,\n\t\t\tendColumn: match[4] ? (match[5] ? parseInt(match[5]) : 1) : undefined\n\t\t};\n\t\turi = uri.with({ fragment: '' });\n\t}\n\treturn { selection, uri };\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IProductConfiguration } from 'vs/base/common/product';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\n\nexport const IProductService = createDecorator<IProductService>('productService');\n\nexport interface IProductService extends Readonly<IProductConfiguration> {\n\n\treadonly _serviceBrand: undefined;\n\n}\n\nexport const productSchemaId = 'vscode://schemas/vscode-product';\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IAction } from 'vs/base/common/actions';\nimport { DeferredPromise } from 'vs/base/common/async';\nimport { CancellationToken, CancellationTokenSource } from 'vs/base/common/cancellation';\nimport { Disposable, DisposableStore, toDisposable } from 'vs/base/common/lifecycle';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\n\nexport const IProgressService = createDecorator<IProgressService>('progressService');\n\n/**\n * A progress service that can be used to report progress to various locations of the UI.\n */\nexport interface IProgressService {\n\n\treadonly _serviceBrand: undefined;\n\n\twithProgress<R>(\n\t\toptions: IProgressOptions | IProgressDialogOptions | IProgressNotificationOptions | IProgressWindowOptions | IProgressCompositeOptions,\n\t\ttask: (progress: IProgress<IProgressStep>) => Promise<R>,\n\t\tonDidCancel?: (choice?: number) => void\n\t): Promise<R>;\n}\n\nexport interface IProgressIndicator {\n\n\t/**\n\t * Show progress customized with the provided flags.\n\t */\n\tshow(infinite: true, delay?: number): IProgressRunner;\n\tshow(total: number, delay?: number): IProgressRunner;\n\n\t/**\n\t * Indicate progress for the duration of the provided promise. Progress will stop in\n\t * any case of promise completion, error or cancellation.\n\t */\n\tshowWhile(promise: Promise<unknown>, delay?: number): Promise<void>;\n}\n\nexport const enum ProgressLocation {\n\tExplorer = 1,\n\tScm = 3,\n\tExtensions = 5,\n\tWindow = 10,\n\tNotification = 15,\n\tDialog = 20\n}\n\nexport interface IProgressOptions {\n\treadonly location: ProgressLocation | string;\n\treadonly title?: string;\n\treadonly source?: string | { label: string; id: string };\n\treadonly total?: number;\n\treadonly cancellable?: boolean;\n\treadonly buttons?: string[];\n}\n\nexport interface IProgressNotificationOptions extends IProgressOptions {\n\treadonly location: ProgressLocation.Notification;\n\treadonly primaryActions?: readonly IAction[];\n\treadonly secondaryActions?: readonly IAction[];\n\treadonly delay?: number;\n\treadonly silent?: boolean;\n}\n\nexport interface IProgressDialogOptions extends IProgressOptions {\n\treadonly delay?: number;\n\treadonly detail?: string;\n\treadonly sticky?: boolean;\n}\n\nexport interface IProgressWindowOptions extends IProgressOptions {\n\treadonly location: ProgressLocation.Window;\n\treadonly command?: string;\n\treadonly type?: 'syncing' | 'loading';\n}\n\nexport interface IProgressCompositeOptions extends IProgressOptions {\n\treadonly location: ProgressLocation.Explorer | ProgressLocation.Extensions | ProgressLocation.Scm | string;\n\treadonly delay?: number;\n}\n\nexport interface IProgressStep {\n\tmessage?: string;\n\tincrement?: number;\n\ttotal?: number;\n}\n\nexport interface IProgressRunner {\n\ttotal(value: number): void;\n\tworked(value: number): void;\n\tdone(): void;\n}\n\nexport const emptyProgressRunner = Object.freeze<IProgressRunner>({\n\ttotal() { },\n\tworked() { },\n\tdone() { }\n});\n\nexport interface IProgress<T> {\n\treport(item: T): void;\n}\n\nexport class Progress<T> implements IProgress<T> {\n\n\tstatic readonly None = Object.freeze<IProgress<unknown>>({ report() { } });\n\n\tprivate _value?: T;\n\tget value(): T | undefined { return this._value; }\n\n\tconstructor(private callback: (data: T) => void) { }\n\n\treport(item: T) {\n\t\tthis._value = item;\n\t\tthis.callback(this._value);\n\t}\n}\n\n/**\n * A helper to show progress during a long running operation. If the operation\n * is started multiple times, only the last invocation will drive the progress.\n */\nexport interface IOperation {\n\tid: number;\n\tisCurrent: () => boolean;\n\ttoken: CancellationToken;\n\tstop(): void;\n}\n\n/**\n * RAII-style progress instance that allows imperative reporting and hides\n * once `dispose()` is called.\n */\nexport class UnmanagedProgress extends Disposable {\n\tprivate readonly deferred = new DeferredPromise<void>();\n\tprivate reporter?: IProgress<IProgressStep>;\n\tprivate lastStep?: IProgressStep;\n\n\tconstructor(\n\t\toptions: IProgressOptions | IProgressDialogOptions | IProgressNotificationOptions | IProgressWindowOptions | IProgressCompositeOptions,\n\t\t@IProgressService progressService: IProgressService,\n\t) {\n\t\tsuper();\n\t\tprogressService.withProgress(options, reporter => {\n\t\t\tthis.reporter = reporter;\n\t\t\tif (this.lastStep) {\n\t\t\t\treporter.report(this.lastStep);\n\t\t\t}\n\n\t\t\treturn this.deferred.p;\n\t\t});\n\n\t\tthis._register(toDisposable(() => this.deferred.complete()));\n\t}\n\n\treport(step: IProgressStep) {\n\t\tif (this.reporter) {\n\t\t\tthis.reporter.report(step);\n\t\t} else {\n\t\t\tthis.lastStep = step;\n\t\t}\n\t}\n}\n\nexport class LongRunningOperation extends Disposable {\n\tprivate currentOperationId = 0;\n\tprivate readonly currentOperationDisposables = this._register(new DisposableStore());\n\tprivate currentProgressRunner: IProgressRunner | undefined;\n\tprivate currentProgressTimeout: any;\n\n\tconstructor(\n\t\tprivate progressIndicator: IProgressIndicator\n\t) {\n\t\tsuper();\n\t}\n\n\tstart(progressDelay: number): IOperation {\n\n\t\t// Stop any previous operation\n\t\tthis.stop();\n\n\t\t// Start new\n\t\tconst newOperationId = ++this.currentOperationId;\n\t\tconst newOperationToken = new CancellationTokenSource();\n\t\tthis.currentProgressTimeout = setTimeout(() => {\n\t\t\tif (newOperationId === this.currentOperationId) {\n\t\t\t\tthis.currentProgressRunner = this.progressIndicator.show(true);\n\t\t\t}\n\t\t}, progressDelay);\n\n\t\tthis.currentOperationDisposables.add(toDisposable(() => clearTimeout(this.currentProgressTimeout)));\n\t\tthis.currentOperationDisposables.add(toDisposable(() => newOperationToken.cancel()));\n\t\tthis.currentOperationDisposables.add(toDisposable(() => this.currentProgressRunner ? this.currentProgressRunner.done() : undefined));\n\n\t\treturn {\n\t\t\tid: newOperationId,\n\t\t\ttoken: newOperationToken.token,\n\t\t\tstop: () => this.doStop(newOperationId),\n\t\t\tisCurrent: () => this.currentOperationId === newOperationId\n\t\t};\n\t}\n\n\tstop(): void {\n\t\tthis.doStop(this.currentOperationId);\n\t}\n\n\tprivate doStop(operationId: number): void {\n\t\tif (this.currentOperationId === operationId) {\n\t\t\tthis.currentOperationDisposables.clear();\n\t\t}\n\t}\n}\n\nexport const IEditorProgressService = createDecorator<IEditorProgressService>('editorProgressService');\n\n/**\n * A progress service that will report progress local to the editor triggered from.\n */\nexport interface IEditorProgressService extends IProgressIndicator {\n\n\treadonly _serviceBrand: undefined;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as Assert from 'vs/base/common/assert';\nimport * as Types from 'vs/base/common/types';\n\nexport interface IRegistry {\n\n\t/**\n\t * Adds the extension functions and properties defined by data to the\n\t * platform. The provided id must be unique.\n\t * @param id a unique identifier\n\t * @param data a contribution\n\t */\n\tadd(id: string, data: any): void;\n\n\t/**\n\t * Returns true iff there is an extension with the provided id.\n\t * @param id an extension identifier\n\t */\n\tknows(id: string): boolean;\n\n\t/**\n\t * Returns the extension functions and properties defined by the specified key or null.\n\t * @param id an extension identifier\n\t */\n\tas<T>(id: string): T;\n}\n\nclass RegistryImpl implements IRegistry {\n\n\tprivate readonly data = new Map<string, any>();\n\n\tpublic add(id: string, data: any): void {\n\t\tAssert.ok(Types.isString(id));\n\t\tAssert.ok(Types.isObject(data));\n\t\tAssert.ok(!this.data.has(id), 'There is already an extension with this id');\n\n\t\tthis.data.set(id, data);\n\t}\n\n\tpublic knows(id: string): boolean {\n\t\treturn this.data.has(id);\n\t}\n\n\tpublic as(id: string): any {\n\t\treturn this.data.get(id) || null;\n\t}\n}\n\nexport const Registry: IRegistry = new RegistryImpl();\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { IJSONSchema } from 'vs/base/common/jsonSchema';\nimport * as platform from 'vs/platform/registry/common/platform';\n\nexport const Extensions = {\n\tJSONContribution: 'base.contributions.json'\n};\n\nexport interface ISchemaContributions {\n\tschemas: { [id: string]: IJSONSchema };\n}\n\nexport interface IJSONContributionRegistry {\n\n\treadonly onDidChangeSchema: Event<string>;\n\n\t/**\n\t * Register a schema to the registry.\n\t */\n\tregisterSchema(uri: string, unresolvedSchemaContent: IJSONSchema): void;\n\n\n\t/**\n\t * Notifies all listeners that the content of the given schema has changed.\n\t * @param uri The id of the schema\n\t */\n\tnotifySchemaChanged(uri: string): void;\n\n\t/**\n\t * Get all schemas\n\t */\n\tgetSchemaContributions(): ISchemaContributions;\n}\n\n\n\nfunction normalizeId(id: string) {\n\tif (id.length > 0 && id.charAt(id.length - 1) === '#') {\n\t\treturn id.substring(0, id.length - 1);\n\t}\n\treturn id;\n}\n\n\n\nclass JSONContributionRegistry implements IJSONContributionRegistry {\n\n\tprivate schemasById: { [id: string]: IJSONSchema };\n\n\tprivate readonly _onDidChangeSchema = new Emitter<string>();\n\treadonly onDidChangeSchema: Event<string> = this._onDidChangeSchema.event;\n\n\tconstructor() {\n\t\tthis.schemasById = {};\n\t}\n\n\tpublic registerSchema(uri: string, unresolvedSchemaContent: IJSONSchema): void {\n\t\tthis.schemasById[normalizeId(uri)] = unresolvedSchemaContent;\n\t\tthis._onDidChangeSchema.fire(uri);\n\t}\n\n\tpublic notifySchemaChanged(uri: string): void {\n\t\tthis._onDidChangeSchema.fire(uri);\n\t}\n\n\tpublic getSchemaContributions(): ISchemaContributions {\n\t\treturn {\n\t\t\tschemas: this.schemasById,\n\t\t};\n\t}\n\n}\n\nconst jsonContributionRegistry = new JSONContributionRegistry();\nplatform.Registry.add(Extensions.JSONContribution, jsonContributionRegistry);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { distinct } from 'vs/base/common/arrays';\nimport { IStringDictionary } from 'vs/base/common/collections';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { IJSONSchema } from 'vs/base/common/jsonSchema';\nimport * as types from 'vs/base/common/types';\nimport * as nls from 'vs/nls';\nimport { getLanguageTagSettingPlainKey } from 'vs/platform/configuration/common/configuration';\nimport { Extensions as JSONExtensions, IJSONContributionRegistry } from 'vs/platform/jsonschemas/common/jsonContributionRegistry';\nimport { PolicyName } from 'vs/platform/policy/common/policy';\nimport { Registry } from 'vs/platform/registry/common/platform';\n\nexport enum EditPresentationTypes {\n\tMultiline = 'multilineText',\n\tSingleline = 'singlelineText'\n}\n\nexport const Extensions = {\n\tConfiguration: 'base.contributions.configuration'\n};\n\nexport interface IConfigurationRegistry {\n\n\t/**\n\t * Register a configuration to the registry.\n\t */\n\tregisterConfiguration(configuration: IConfigurationNode): void;\n\n\t/**\n\t * Register multiple configurations to the registry.\n\t */\n\tregisterConfigurations(configurations: IConfigurationNode[], validate?: boolean): void;\n\n\t/**\n\t * Deregister multiple configurations from the registry.\n\t */\n\tderegisterConfigurations(configurations: IConfigurationNode[]): void;\n\n\t/**\n\t * update the configuration registry by\n\t * \t- registering the configurations to add\n\t * \t- dereigstering the configurations to remove\n\t */\n\tupdateConfigurations(configurations: { add: IConfigurationNode[]; remove: IConfigurationNode[] }): void;\n\n\t/**\n\t * Register multiple default configurations to the registry.\n\t */\n\tregisterDefaultConfigurations(defaultConfigurations: IConfigurationDefaults[]): void;\n\n\t/**\n\t * Deregister multiple default configurations from the registry.\n\t */\n\tderegisterDefaultConfigurations(defaultConfigurations: IConfigurationDefaults[]): void;\n\n\t/**\n\t * Return the registered configuration defaults overrides\n\t */\n\tgetConfigurationDefaultsOverrides(): Map<string, IConfigurationDefaultOverride>;\n\n\t/**\n\t * Signal that the schema of a configuration setting has changes. It is currently only supported to change enumeration values.\n\t * Property or default value changes are not allowed.\n\t */\n\tnotifyConfigurationSchemaUpdated(...configurations: IConfigurationNode[]): void;\n\n\t/**\n\t * Event that fires whenever a configuration has been\n\t * registered.\n\t */\n\treadonly onDidSchemaChange: Event<void>;\n\n\t/**\n\t * Event that fires whenever a configuration has been\n\t * registered.\n\t */\n\treadonly onDidUpdateConfiguration: Event<{ properties: string[]; defaultsOverrides?: boolean }>;\n\n\t/**\n\t * Returns all configuration nodes contributed to this registry.\n\t */\n\tgetConfigurations(): IConfigurationNode[];\n\n\t/**\n\t * Returns all configurations settings of all configuration nodes contributed to this registry.\n\t */\n\tgetConfigurationProperties(): IStringDictionary<IRegisteredConfigurationPropertySchema>;\n\n\t/**\n\t * Return all configurations by policy name\n\t */\n\tgetPolicyConfigurations(): Map<PolicyName, string>;\n\n\t/**\n\t * Returns all excluded configurations settings of all configuration nodes contributed to this registry.\n\t */\n\tgetExcludedConfigurationProperties(): IStringDictionary<IRegisteredConfigurationPropertySchema>;\n\n\t/**\n\t * Register the identifiers for editor configurations\n\t */\n\tregisterOverrideIdentifiers(identifiers: string[]): void;\n}\n\nexport const enum ConfigurationScope {\n\t/**\n\t * Application specific configuration, which can be configured only in local user settings.\n\t */\n\tAPPLICATION = 1,\n\t/**\n\t * Machine specific configuration, which can be configured only in local and remote user settings.\n\t */\n\tMACHINE,\n\t/**\n\t * Window specific configuration, which can be configured in the user or workspace settings.\n\t */\n\tWINDOW,\n\t/**\n\t * Resource specific configuration, which can be configured in the user, workspace or folder settings.\n\t */\n\tRESOURCE,\n\t/**\n\t * Resource specific configuration that can be configured in language specific settings\n\t */\n\tLANGUAGE_OVERRIDABLE,\n\t/**\n\t * Machine specific configuration that can also be configured in workspace or folder settings.\n\t */\n\tMACHINE_OVERRIDABLE,\n}\n\nexport interface IPolicy {\n\n\t/**\n\t * The policy name.\n\t */\n\treadonly name: PolicyName;\n\n\t/**\n\t * The Code version in which this policy was introduced.\n\t */\n\treadonly minimumVersion: `${number}.${number}`;\n}\n\nexport interface IConfigurationPropertySchema extends IJSONSchema {\n\n\tscope?: ConfigurationScope;\n\n\t/**\n\t * When restricted, value of this configuration will be read only from trusted sources.\n\t * For eg., If the workspace is not trusted, then the value of this configuration is not read from workspace settings file.\n\t */\n\trestricted?: boolean;\n\n\t/**\n\t * When `false` this property is excluded from the registry. Default is to include.\n\t */\n\tincluded?: boolean;\n\n\t/**\n\t * List of tags associated to the property.\n\t *  - A tag can be used for filtering\n\t *  - Use `experimental` tag for marking the setting as experimental. **Note:** Defaults of experimental settings can be changed by the running experiments.\n\t */\n\ttags?: string[];\n\n\t/**\n\t * When enabled this setting is ignored during sync and user can override this.\n\t */\n\tignoreSync?: boolean;\n\n\t/**\n\t * When enabled this setting is ignored during sync and user cannot override this.\n\t */\n\tdisallowSyncIgnore?: boolean;\n\n\t/**\n\t * Labels for enumeration items\n\t */\n\tenumItemLabels?: string[];\n\n\t/**\n\t * When specified, controls the presentation format of string settings.\n\t * Otherwise, the presentation format defaults to `singleline`.\n\t */\n\teditPresentation?: EditPresentationTypes;\n\n\t/**\n\t * When specified, gives an order number for the setting\n\t * within the settings editor. Otherwise, the setting is placed at the end.\n\t */\n\torder?: number;\n\n\t/**\n\t * When specified, this setting's value can always be overwritten by\n\t * a system-wide policy.\n\t */\n\tpolicy?: IPolicy;\n}\n\nexport interface IExtensionInfo {\n\tid: string;\n\tdisplayName?: string;\n}\n\nexport interface IConfigurationNode {\n\tid?: string;\n\torder?: number;\n\ttype?: string | string[];\n\ttitle?: string;\n\tdescription?: string;\n\tproperties?: IStringDictionary<IConfigurationPropertySchema>;\n\tallOf?: IConfigurationNode[];\n\tscope?: ConfigurationScope;\n\textensionInfo?: IExtensionInfo;\n\trestrictedProperties?: string[];\n}\n\nexport interface IConfigurationDefaults {\n\toverrides: IStringDictionary<any>;\n\tsource?: IExtensionInfo | string;\n}\n\nexport type IRegisteredConfigurationPropertySchema = IConfigurationPropertySchema & {\n\tdefaultDefaultValue?: any;\n\tsource?: IExtensionInfo; // Source of the Property\n\tdefaultValueSource?: IExtensionInfo | string; // Source of the Default Value\n};\n\nexport type IConfigurationDefaultOverride = {\n\treadonly value: any;\n\treadonly source?: IExtensionInfo | string;  // Source of the default override\n\treadonly valuesSources?: Map<string, IExtensionInfo | string>; // Source of each value in default language overrides\n};\n\nexport const allSettings: { properties: IStringDictionary<IConfigurationPropertySchema>; patternProperties: IStringDictionary<IConfigurationPropertySchema> } = { properties: {}, patternProperties: {} };\nexport const applicationSettings: { properties: IStringDictionary<IConfigurationPropertySchema>; patternProperties: IStringDictionary<IConfigurationPropertySchema> } = { properties: {}, patternProperties: {} };\nexport const machineSettings: { properties: IStringDictionary<IConfigurationPropertySchema>; patternProperties: IStringDictionary<IConfigurationPropertySchema> } = { properties: {}, patternProperties: {} };\nexport const machineOverridableSettings: { properties: IStringDictionary<IConfigurationPropertySchema>; patternProperties: IStringDictionary<IConfigurationPropertySchema> } = { properties: {}, patternProperties: {} };\nexport const windowSettings: { properties: IStringDictionary<IConfigurationPropertySchema>; patternProperties: IStringDictionary<IConfigurationPropertySchema> } = { properties: {}, patternProperties: {} };\nexport const resourceSettings: { properties: IStringDictionary<IConfigurationPropertySchema>; patternProperties: IStringDictionary<IConfigurationPropertySchema> } = { properties: {}, patternProperties: {} };\n\nexport const resourceLanguageSettingsSchemaId = 'vscode://schemas/settings/resourceLanguage';\nexport const configurationDefaultsSchemaId = 'vscode://schemas/settings/configurationDefaults';\n\nconst contributionRegistry = Registry.as<IJSONContributionRegistry>(JSONExtensions.JSONContribution);\n\nclass ConfigurationRegistry implements IConfigurationRegistry {\n\n\tprivate readonly configurationDefaultsOverrides: Map<string, IConfigurationDefaultOverride>;\n\tprivate readonly defaultLanguageConfigurationOverridesNode: IConfigurationNode;\n\tprivate readonly configurationContributors: IConfigurationNode[];\n\tprivate readonly configurationProperties: IStringDictionary<IRegisteredConfigurationPropertySchema>;\n\tprivate readonly policyConfigurations: Map<PolicyName, string>;\n\tprivate readonly excludedConfigurationProperties: IStringDictionary<IRegisteredConfigurationPropertySchema>;\n\tprivate readonly resourceLanguageSettingsSchema: IJSONSchema;\n\tprivate readonly overrideIdentifiers = new Set<string>();\n\n\tprivate readonly _onDidSchemaChange = new Emitter<void>();\n\treadonly onDidSchemaChange: Event<void> = this._onDidSchemaChange.event;\n\n\tprivate readonly _onDidUpdateConfiguration = new Emitter<{ properties: string[]; defaultsOverrides?: boolean }>();\n\treadonly onDidUpdateConfiguration = this._onDidUpdateConfiguration.event;\n\n\tconstructor() {\n\t\tthis.configurationDefaultsOverrides = new Map<string, IConfigurationDefaultOverride>();\n\t\tthis.defaultLanguageConfigurationOverridesNode = {\n\t\t\tid: 'defaultOverrides',\n\t\t\ttitle: nls.localize('defaultLanguageConfigurationOverrides.title', \"Default Language Configuration Overrides\"),\n\t\t\tproperties: {}\n\t\t};\n\t\tthis.configurationContributors = [this.defaultLanguageConfigurationOverridesNode];\n\t\tthis.resourceLanguageSettingsSchema = { properties: {}, patternProperties: {}, additionalProperties: false, errorMessage: 'Unknown editor configuration setting', allowTrailingCommas: true, allowComments: true };\n\t\tthis.configurationProperties = {};\n\t\tthis.policyConfigurations = new Map<PolicyName, string>();\n\t\tthis.excludedConfigurationProperties = {};\n\n\t\tcontributionRegistry.registerSchema(resourceLanguageSettingsSchemaId, this.resourceLanguageSettingsSchema);\n\t\tthis.registerOverridePropertyPatternKey();\n\t}\n\n\tpublic registerConfiguration(configuration: IConfigurationNode, validate: boolean = true): void {\n\t\tthis.registerConfigurations([configuration], validate);\n\t}\n\n\tpublic registerConfigurations(configurations: IConfigurationNode[], validate: boolean = true): void {\n\t\tconst properties = this.doRegisterConfigurations(configurations, validate);\n\n\t\tcontributionRegistry.registerSchema(resourceLanguageSettingsSchemaId, this.resourceLanguageSettingsSchema);\n\t\tthis._onDidSchemaChange.fire();\n\t\tthis._onDidUpdateConfiguration.fire({ properties });\n\t}\n\n\tpublic deregisterConfigurations(configurations: IConfigurationNode[]): void {\n\t\tconst properties = this.doDeregisterConfigurations(configurations);\n\n\t\tcontributionRegistry.registerSchema(resourceLanguageSettingsSchemaId, this.resourceLanguageSettingsSchema);\n\t\tthis._onDidSchemaChange.fire();\n\t\tthis._onDidUpdateConfiguration.fire({ properties });\n\t}\n\n\tpublic updateConfigurations({ add, remove }: { add: IConfigurationNode[]; remove: IConfigurationNode[] }): void {\n\t\tconst properties = [];\n\t\tproperties.push(...this.doDeregisterConfigurations(remove));\n\t\tproperties.push(...this.doRegisterConfigurations(add, false));\n\n\t\tcontributionRegistry.registerSchema(resourceLanguageSettingsSchemaId, this.resourceLanguageSettingsSchema);\n\t\tthis._onDidSchemaChange.fire();\n\t\tthis._onDidUpdateConfiguration.fire({ properties: distinct(properties) });\n\t}\n\n\tpublic registerDefaultConfigurations(configurationDefaults: IConfigurationDefaults[]): void {\n\t\tconst properties: string[] = [];\n\t\tconst overrideIdentifiers: string[] = [];\n\n\t\tfor (const { overrides, source } of configurationDefaults) {\n\t\t\tfor (const key in overrides) {\n\t\t\t\tproperties.push(key);\n\n\t\t\t\tif (OVERRIDE_PROPERTY_REGEX.test(key)) {\n\t\t\t\t\tconst configurationDefaultOverride = this.configurationDefaultsOverrides.get(key);\n\t\t\t\t\tconst valuesSources = configurationDefaultOverride?.valuesSources ?? new Map<string, IExtensionInfo | string>();\n\t\t\t\t\tif (source) {\n\t\t\t\t\t\tfor (const configuration of Object.keys(overrides[key])) {\n\t\t\t\t\t\t\tvaluesSources.set(configuration, source);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tconst defaultValue = { ...(configurationDefaultOverride?.value || {}), ...overrides[key] };\n\t\t\t\t\tthis.configurationDefaultsOverrides.set(key, { source, value: defaultValue, valuesSources });\n\t\t\t\t\tconst plainKey = getLanguageTagSettingPlainKey(key);\n\t\t\t\t\tconst property: IRegisteredConfigurationPropertySchema = {\n\t\t\t\t\t\ttype: 'object',\n\t\t\t\t\t\tdefault: defaultValue,\n\t\t\t\t\t\tdescription: nls.localize('defaultLanguageConfiguration.description', \"Configure settings to be overridden for the {0} language.\", plainKey),\n\t\t\t\t\t\t$ref: resourceLanguageSettingsSchemaId,\n\t\t\t\t\t\tdefaultDefaultValue: defaultValue,\n\t\t\t\t\t\tsource: types.isString(source) ? undefined : source,\n\t\t\t\t\t\tdefaultValueSource: source\n\t\t\t\t\t};\n\t\t\t\t\toverrideIdentifiers.push(...overrideIdentifiersFromKey(key));\n\t\t\t\t\tthis.configurationProperties[key] = property;\n\t\t\t\t\tthis.defaultLanguageConfigurationOverridesNode.properties![key] = property;\n\t\t\t\t} else {\n\t\t\t\t\tthis.configurationDefaultsOverrides.set(key, { value: overrides[key], source });\n\t\t\t\t\tconst property = this.configurationProperties[key];\n\t\t\t\t\tif (property) {\n\t\t\t\t\t\tthis.updatePropertyDefaultValue(key, property);\n\t\t\t\t\t\tthis.updateSchema(key, property);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.registerOverrideIdentifiers(overrideIdentifiers);\n\t\tthis._onDidSchemaChange.fire();\n\t\tthis._onDidUpdateConfiguration.fire({ properties, defaultsOverrides: true });\n\t}\n\n\tpublic deregisterDefaultConfigurations(defaultConfigurations: IConfigurationDefaults[]): void {\n\t\tconst properties: string[] = [];\n\t\tfor (const { overrides, source } of defaultConfigurations) {\n\t\t\tfor (const key in overrides) {\n\t\t\t\tconst configurationDefaultsOverride = this.configurationDefaultsOverrides.get(key);\n\t\t\t\tconst id = types.isString(source) ? source : source?.id;\n\t\t\t\tconst configurationDefaultsOverrideSourceId = types.isString(configurationDefaultsOverride?.source) ? configurationDefaultsOverride?.source : configurationDefaultsOverride?.source?.id;\n\t\t\t\tif (id !== configurationDefaultsOverrideSourceId) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tproperties.push(key);\n\t\t\t\tthis.configurationDefaultsOverrides.delete(key);\n\t\t\t\tif (OVERRIDE_PROPERTY_REGEX.test(key)) {\n\t\t\t\t\tdelete this.configurationProperties[key];\n\t\t\t\t\tdelete this.defaultLanguageConfigurationOverridesNode.properties![key];\n\t\t\t\t} else {\n\t\t\t\t\tconst property = this.configurationProperties[key];\n\t\t\t\t\tif (property) {\n\t\t\t\t\t\tthis.updatePropertyDefaultValue(key, property);\n\t\t\t\t\t\tthis.updateSchema(key, property);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.updateOverridePropertyPatternKey();\n\t\tthis._onDidSchemaChange.fire();\n\t\tthis._onDidUpdateConfiguration.fire({ properties, defaultsOverrides: true });\n\t}\n\n\tpublic notifyConfigurationSchemaUpdated(...configurations: IConfigurationNode[]) {\n\t\tthis._onDidSchemaChange.fire();\n\t}\n\n\tpublic registerOverrideIdentifiers(overrideIdentifiers: string[]): void {\n\t\tfor (const overrideIdentifier of overrideIdentifiers) {\n\t\t\tthis.overrideIdentifiers.add(overrideIdentifier);\n\t\t}\n\t\tthis.updateOverridePropertyPatternKey();\n\t}\n\n\tprivate doRegisterConfigurations(configurations: IConfigurationNode[], validate: boolean): string[] {\n\t\tconst properties: string[] = [];\n\t\tconfigurations.forEach(configuration => {\n\t\t\tproperties.push(...this.validateAndRegisterProperties(configuration, validate, configuration.extensionInfo, configuration.restrictedProperties)); // fills in defaults\n\t\t\tthis.configurationContributors.push(configuration);\n\t\t\tthis.registerJSONConfiguration(configuration);\n\t\t});\n\t\treturn properties;\n\t}\n\n\tprivate doDeregisterConfigurations(configurations: IConfigurationNode[]): string[] {\n\t\tconst properties: string[] = [];\n\t\tconst deregisterConfiguration = (configuration: IConfigurationNode) => {\n\t\t\tif (configuration.properties) {\n\t\t\t\tfor (const key in configuration.properties) {\n\t\t\t\t\tproperties.push(key);\n\t\t\t\t\tconst property = this.configurationProperties[key];\n\t\t\t\t\tif (property?.policy?.name) {\n\t\t\t\t\t\tthis.policyConfigurations.delete(property.policy.name);\n\t\t\t\t\t}\n\t\t\t\t\tdelete this.configurationProperties[key];\n\t\t\t\t\tthis.removeFromSchema(key, configuration.properties[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tconfiguration.allOf?.forEach(node => deregisterConfiguration(node));\n\t\t};\n\t\tfor (const configuration of configurations) {\n\t\t\tderegisterConfiguration(configuration);\n\t\t\tconst index = this.configurationContributors.indexOf(configuration);\n\t\t\tif (index !== -1) {\n\t\t\t\tthis.configurationContributors.splice(index, 1);\n\t\t\t}\n\t\t}\n\t\treturn properties;\n\t}\n\n\tprivate validateAndRegisterProperties(configuration: IConfigurationNode, validate: boolean = true, extensionInfo: IExtensionInfo | undefined, restrictedProperties: string[] | undefined, scope: ConfigurationScope = ConfigurationScope.WINDOW): string[] {\n\t\tscope = types.isUndefinedOrNull(configuration.scope) ? scope : configuration.scope;\n\t\tconst propertyKeys: string[] = [];\n\t\tconst properties = configuration.properties;\n\t\tif (properties) {\n\t\t\tfor (const key in properties) {\n\t\t\t\tconst property: IRegisteredConfigurationPropertySchema = properties[key];\n\t\t\t\tif (validate && validateProperty(key, property)) {\n\t\t\t\t\tdelete properties[key];\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tproperty.source = extensionInfo;\n\n\t\t\t\t// update default value\n\t\t\t\tproperty.defaultDefaultValue = properties[key].default;\n\t\t\t\tthis.updatePropertyDefaultValue(key, property);\n\n\t\t\t\t// update scope\n\t\t\t\tif (OVERRIDE_PROPERTY_REGEX.test(key)) {\n\t\t\t\t\tproperty.scope = undefined; // No scope for overridable properties `[${identifier}]`\n\t\t\t\t} else {\n\t\t\t\t\tproperty.scope = types.isUndefinedOrNull(property.scope) ? scope : property.scope;\n\t\t\t\t\tproperty.restricted = types.isUndefinedOrNull(property.restricted) ? !!restrictedProperties?.includes(key) : property.restricted;\n\t\t\t\t}\n\n\t\t\t\t// Add to properties maps\n\t\t\t\t// Property is included by default if 'included' is unspecified\n\t\t\t\tif (properties[key].hasOwnProperty('included') && !properties[key].included) {\n\t\t\t\t\tthis.excludedConfigurationProperties[key] = properties[key];\n\t\t\t\t\tdelete properties[key];\n\t\t\t\t\tcontinue;\n\t\t\t\t} else {\n\t\t\t\t\tthis.configurationProperties[key] = properties[key];\n\t\t\t\t\tif (properties[key].policy?.name) {\n\t\t\t\t\t\tthis.policyConfigurations.set(properties[key].policy!.name, key);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!properties[key].deprecationMessage && properties[key].markdownDeprecationMessage) {\n\t\t\t\t\t// If not set, default deprecationMessage to the markdown source\n\t\t\t\t\tproperties[key].deprecationMessage = properties[key].markdownDeprecationMessage;\n\t\t\t\t}\n\n\t\t\t\tpropertyKeys.push(key);\n\t\t\t}\n\t\t}\n\t\tconst subNodes = configuration.allOf;\n\t\tif (subNodes) {\n\t\t\tfor (const node of subNodes) {\n\t\t\t\tpropertyKeys.push(...this.validateAndRegisterProperties(node, validate, extensionInfo, restrictedProperties, scope));\n\t\t\t}\n\t\t}\n\t\treturn propertyKeys;\n\t}\n\n\t// TODO: @sandy081 - Remove this method and include required info in getConfigurationProperties\n\tgetConfigurations(): IConfigurationNode[] {\n\t\treturn this.configurationContributors;\n\t}\n\n\tgetConfigurationProperties(): IStringDictionary<IRegisteredConfigurationPropertySchema> {\n\t\treturn this.configurationProperties;\n\t}\n\n\tgetPolicyConfigurations(): Map<PolicyName, string> {\n\t\treturn this.policyConfigurations;\n\t}\n\n\tgetExcludedConfigurationProperties(): IStringDictionary<IRegisteredConfigurationPropertySchema> {\n\t\treturn this.excludedConfigurationProperties;\n\t}\n\n\tgetConfigurationDefaultsOverrides(): Map<string, IConfigurationDefaultOverride> {\n\t\treturn this.configurationDefaultsOverrides;\n\t}\n\n\tprivate registerJSONConfiguration(configuration: IConfigurationNode) {\n\t\tconst register = (configuration: IConfigurationNode) => {\n\t\t\tconst properties = configuration.properties;\n\t\t\tif (properties) {\n\t\t\t\tfor (const key in properties) {\n\t\t\t\t\tthis.updateSchema(key, properties[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst subNodes = configuration.allOf;\n\t\t\tsubNodes?.forEach(register);\n\t\t};\n\t\tregister(configuration);\n\t}\n\n\tprivate updateSchema(key: string, property: IConfigurationPropertySchema): void {\n\t\tallSettings.properties[key] = property;\n\t\tswitch (property.scope) {\n\t\t\tcase ConfigurationScope.APPLICATION:\n\t\t\t\tapplicationSettings.properties[key] = property;\n\t\t\t\tbreak;\n\t\t\tcase ConfigurationScope.MACHINE:\n\t\t\t\tmachineSettings.properties[key] = property;\n\t\t\t\tbreak;\n\t\t\tcase ConfigurationScope.MACHINE_OVERRIDABLE:\n\t\t\t\tmachineOverridableSettings.properties[key] = property;\n\t\t\t\tbreak;\n\t\t\tcase ConfigurationScope.WINDOW:\n\t\t\t\twindowSettings.properties[key] = property;\n\t\t\t\tbreak;\n\t\t\tcase ConfigurationScope.RESOURCE:\n\t\t\t\tresourceSettings.properties[key] = property;\n\t\t\t\tbreak;\n\t\t\tcase ConfigurationScope.LANGUAGE_OVERRIDABLE:\n\t\t\t\tresourceSettings.properties[key] = property;\n\t\t\t\tthis.resourceLanguageSettingsSchema.properties![key] = property;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tprivate removeFromSchema(key: string, property: IConfigurationPropertySchema): void {\n\t\tdelete allSettings.properties[key];\n\t\tswitch (property.scope) {\n\t\t\tcase ConfigurationScope.APPLICATION:\n\t\t\t\tdelete applicationSettings.properties[key];\n\t\t\t\tbreak;\n\t\t\tcase ConfigurationScope.MACHINE:\n\t\t\t\tdelete machineSettings.properties[key];\n\t\t\t\tbreak;\n\t\t\tcase ConfigurationScope.MACHINE_OVERRIDABLE:\n\t\t\t\tdelete machineOverridableSettings.properties[key];\n\t\t\t\tbreak;\n\t\t\tcase ConfigurationScope.WINDOW:\n\t\t\t\tdelete windowSettings.properties[key];\n\t\t\t\tbreak;\n\t\t\tcase ConfigurationScope.RESOURCE:\n\t\t\tcase ConfigurationScope.LANGUAGE_OVERRIDABLE:\n\t\t\t\tdelete resourceSettings.properties[key];\n\t\t\t\tdelete this.resourceLanguageSettingsSchema.properties![key];\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tprivate updateOverridePropertyPatternKey(): void {\n\t\tfor (const overrideIdentifier of this.overrideIdentifiers.values()) {\n\t\t\tconst overrideIdentifierProperty = `[${overrideIdentifier}]`;\n\t\t\tconst resourceLanguagePropertiesSchema: IJSONSchema = {\n\t\t\t\ttype: 'object',\n\t\t\t\tdescription: nls.localize('overrideSettings.defaultDescription', \"Configure editor settings to be overridden for a language.\"),\n\t\t\t\terrorMessage: nls.localize('overrideSettings.errorMessage', \"This setting does not support per-language configuration.\"),\n\t\t\t\t$ref: resourceLanguageSettingsSchemaId,\n\t\t\t};\n\t\t\tthis.updatePropertyDefaultValue(overrideIdentifierProperty, resourceLanguagePropertiesSchema);\n\t\t\tallSettings.properties[overrideIdentifierProperty] = resourceLanguagePropertiesSchema;\n\t\t\tapplicationSettings.properties[overrideIdentifierProperty] = resourceLanguagePropertiesSchema;\n\t\t\tmachineSettings.properties[overrideIdentifierProperty] = resourceLanguagePropertiesSchema;\n\t\t\tmachineOverridableSettings.properties[overrideIdentifierProperty] = resourceLanguagePropertiesSchema;\n\t\t\twindowSettings.properties[overrideIdentifierProperty] = resourceLanguagePropertiesSchema;\n\t\t\tresourceSettings.properties[overrideIdentifierProperty] = resourceLanguagePropertiesSchema;\n\t\t}\n\t\tthis._onDidSchemaChange.fire();\n\t}\n\n\tprivate registerOverridePropertyPatternKey(): void {\n\t\tconst resourceLanguagePropertiesSchema: IJSONSchema = {\n\t\t\ttype: 'object',\n\t\t\tdescription: nls.localize('overrideSettings.defaultDescription', \"Configure editor settings to be overridden for a language.\"),\n\t\t\terrorMessage: nls.localize('overrideSettings.errorMessage', \"This setting does not support per-language configuration.\"),\n\t\t\t$ref: resourceLanguageSettingsSchemaId,\n\t\t};\n\t\tallSettings.patternProperties[OVERRIDE_PROPERTY_PATTERN] = resourceLanguagePropertiesSchema;\n\t\tapplicationSettings.patternProperties[OVERRIDE_PROPERTY_PATTERN] = resourceLanguagePropertiesSchema;\n\t\tmachineSettings.patternProperties[OVERRIDE_PROPERTY_PATTERN] = resourceLanguagePropertiesSchema;\n\t\tmachineOverridableSettings.patternProperties[OVERRIDE_PROPERTY_PATTERN] = resourceLanguagePropertiesSchema;\n\t\twindowSettings.patternProperties[OVERRIDE_PROPERTY_PATTERN] = resourceLanguagePropertiesSchema;\n\t\tresourceSettings.patternProperties[OVERRIDE_PROPERTY_PATTERN] = resourceLanguagePropertiesSchema;\n\t\tthis._onDidSchemaChange.fire();\n\t}\n\n\tprivate updatePropertyDefaultValue(key: string, property: IRegisteredConfigurationPropertySchema): void {\n\t\tconst configurationdefaultOverride = this.configurationDefaultsOverrides.get(key);\n\t\tlet defaultValue = configurationdefaultOverride?.value;\n\t\tlet defaultSource = configurationdefaultOverride?.source;\n\t\tif (types.isUndefined(defaultValue)) {\n\t\t\tdefaultValue = property.defaultDefaultValue;\n\t\t\tdefaultSource = undefined;\n\t\t}\n\t\tif (types.isUndefined(defaultValue)) {\n\t\t\tdefaultValue = getDefaultValue(property.type);\n\t\t}\n\t\tproperty.default = defaultValue;\n\t\tproperty.defaultValueSource = defaultSource;\n\t}\n}\n\nconst OVERRIDE_IDENTIFIER_PATTERN = `\\\\[([^\\\\]]+)\\\\]`;\nconst OVERRIDE_IDENTIFIER_REGEX = new RegExp(OVERRIDE_IDENTIFIER_PATTERN, 'g');\nexport const OVERRIDE_PROPERTY_PATTERN = `^(${OVERRIDE_IDENTIFIER_PATTERN})+$`;\nexport const OVERRIDE_PROPERTY_REGEX = new RegExp(OVERRIDE_PROPERTY_PATTERN);\n\nexport function overrideIdentifiersFromKey(key: string): string[] {\n\tconst identifiers: string[] = [];\n\tif (OVERRIDE_PROPERTY_REGEX.test(key)) {\n\t\tlet matches = OVERRIDE_IDENTIFIER_REGEX.exec(key);\n\t\twhile (matches?.length) {\n\t\t\tconst identifier = matches[1].trim();\n\t\t\tif (identifier) {\n\t\t\t\tidentifiers.push(identifier);\n\t\t\t}\n\t\t\tmatches = OVERRIDE_IDENTIFIER_REGEX.exec(key);\n\t\t}\n\t}\n\treturn distinct(identifiers);\n}\n\nexport function keyFromOverrideIdentifiers(overrideIdentifiers: string[]): string {\n\treturn overrideIdentifiers.reduce((result, overrideIdentifier) => `${result}[${overrideIdentifier}]`, '');\n}\n\nexport function getDefaultValue(type: string | string[] | undefined): any {\n\tconst t = Array.isArray(type) ? (<string[]>type)[0] : <string>type;\n\tswitch (t) {\n\t\tcase 'boolean':\n\t\t\treturn false;\n\t\tcase 'integer':\n\t\tcase 'number':\n\t\t\treturn 0;\n\t\tcase 'string':\n\t\t\treturn '';\n\t\tcase 'array':\n\t\t\treturn [];\n\t\tcase 'object':\n\t\t\treturn {};\n\t\tdefault:\n\t\t\treturn null;\n\t}\n}\n\nconst configurationRegistry = new ConfigurationRegistry();\nRegistry.add(Extensions.Configuration, configurationRegistry);\n\nexport function validateProperty(property: string, schema: IRegisteredConfigurationPropertySchema): string | null {\n\tif (!property.trim()) {\n\t\treturn nls.localize('config.property.empty', \"Cannot register an empty property\");\n\t}\n\tif (OVERRIDE_PROPERTY_REGEX.test(property)) {\n\t\treturn nls.localize('config.property.languageDefault', \"Cannot register '{0}'. This matches property pattern '\\\\\\\\[.*\\\\\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.\", property);\n\t}\n\tif (configurationRegistry.getConfigurationProperties()[property] !== undefined) {\n\t\treturn nls.localize('config.property.duplicate', \"Cannot register '{0}'. This property is already registered.\", property);\n\t}\n\tif (schema.policy?.name && configurationRegistry.getPolicyConfigurations().get(schema.policy?.name) !== undefined) {\n\t\treturn nls.localize('config.policy.duplicate', \"Cannot register '{0}'. The associated policy {1} is already registered with {2}.\", property, schema.policy?.name, configurationRegistry.getPolicyConfigurations().get(schema.policy?.name));\n\t}\n\treturn null;\n}\n\nexport function getScopes(): [string, ConfigurationScope | undefined][] {\n\tconst scopes: [string, ConfigurationScope | undefined][] = [];\n\tconst configurationProperties = configurationRegistry.getConfigurationProperties();\n\tfor (const key of Object.keys(configurationProperties)) {\n\t\tscopes.push([key, configurationProperties[key].scope]);\n\t}\n\tscopes.push(['launch', ConfigurationScope.RESOURCE]);\n\tscopes.push(['task', ConfigurationScope.RESOURCE]);\n\treturn scopes;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as arrays from 'vs/base/common/arrays';\nimport { IStringDictionary } from 'vs/base/common/collections';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport * as json from 'vs/base/common/json';\nimport { Disposable } from 'vs/base/common/lifecycle';\nimport { getOrSet, ResourceMap } from 'vs/base/common/map';\nimport * as objects from 'vs/base/common/objects';\nimport { IExtUri } from 'vs/base/common/resources';\nimport * as types from 'vs/base/common/types';\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { addToValueTree, ConfigurationTarget, getConfigurationValue, IConfigurationChange, IConfigurationChangeEvent, IConfigurationCompareResult, IConfigurationData, IConfigurationModel, IConfigurationOverrides, IConfigurationUpdateOverrides, IConfigurationValue, IOverrides, removeFromValueTree, toValuesTree } from 'vs/platform/configuration/common/configuration';\nimport { ConfigurationScope, Extensions, IConfigurationPropertySchema, IConfigurationRegistry, overrideIdentifiersFromKey, OVERRIDE_PROPERTY_REGEX } from 'vs/platform/configuration/common/configurationRegistry';\nimport { FileOperation, IFileService } from 'vs/platform/files/common/files';\nimport { Registry } from 'vs/platform/registry/common/platform';\nimport { Workspace } from 'vs/platform/workspace/common/workspace';\n\nexport class ConfigurationModel implements IConfigurationModel {\n\n\tprivate frozen: boolean = false;\n\tprivate readonly overrideConfigurations = new Map<string, ConfigurationModel>();\n\n\tconstructor(\n\t\tprivate readonly _contents: any = {},\n\t\tprivate readonly _keys: string[] = [],\n\t\tprivate readonly _overrides: IOverrides[] = []\n\t) {\n\t}\n\n\tget contents(): any {\n\t\treturn this.checkAndFreeze(this._contents);\n\t}\n\n\tget overrides(): IOverrides[] {\n\t\treturn this.checkAndFreeze(this._overrides);\n\t}\n\n\tget keys(): string[] {\n\t\treturn this.checkAndFreeze(this._keys);\n\t}\n\n\tisEmpty(): boolean {\n\t\treturn this._keys.length === 0 && Object.keys(this._contents).length === 0 && this._overrides.length === 0;\n\t}\n\n\tisFrozen(): boolean {\n\t\treturn this.frozen;\n\t}\n\n\tgetValue<V>(section: string | undefined): V {\n\t\treturn section ? getConfigurationValue<any>(this.contents, section) : this.contents;\n\t}\n\n\tgetOverrideValue<V>(section: string | undefined, overrideIdentifier: string): V | undefined {\n\t\tconst overrideContents = this.getContentsForOverrideIdentifer(overrideIdentifier);\n\t\treturn overrideContents\n\t\t\t? section ? getConfigurationValue<any>(overrideContents, section) : overrideContents\n\t\t\t: undefined;\n\t}\n\n\tgetKeysForOverrideIdentifier(identifier: string): string[] {\n\t\tconst keys: string[] = [];\n\t\tfor (const override of this.overrides) {\n\t\t\tif (override.identifiers.includes(identifier)) {\n\t\t\t\tkeys.push(...override.keys);\n\t\t\t}\n\t\t}\n\t\treturn arrays.distinct(keys);\n\t}\n\n\tgetAllOverrideIdentifiers(): string[] {\n\t\tconst result: string[] = [];\n\t\tfor (const override of this.overrides) {\n\t\t\tresult.push(...override.identifiers);\n\t\t}\n\t\treturn arrays.distinct(result);\n\t}\n\n\toverride(identifier: string): ConfigurationModel {\n\t\tlet overrideConfigurationModel = this.overrideConfigurations.get(identifier);\n\t\tif (!overrideConfigurationModel) {\n\t\t\toverrideConfigurationModel = this.createOverrideConfigurationModel(identifier);\n\t\t\tthis.overrideConfigurations.set(identifier, overrideConfigurationModel);\n\t\t}\n\t\treturn overrideConfigurationModel;\n\t}\n\n\tmerge(...others: ConfigurationModel[]): ConfigurationModel {\n\t\tconst contents = objects.deepClone(this.contents);\n\t\tconst overrides = objects.deepClone(this.overrides);\n\t\tconst keys = [...this.keys];\n\n\t\tfor (const other of others) {\n\t\t\tif (other.isEmpty()) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tthis.mergeContents(contents, other.contents);\n\n\t\t\tfor (const otherOverride of other.overrides) {\n\t\t\t\tconst [override] = overrides.filter(o => arrays.equals(o.identifiers, otherOverride.identifiers));\n\t\t\t\tif (override) {\n\t\t\t\t\tthis.mergeContents(override.contents, otherOverride.contents);\n\t\t\t\t\toverride.keys.push(...otherOverride.keys);\n\t\t\t\t\toverride.keys = arrays.distinct(override.keys);\n\t\t\t\t} else {\n\t\t\t\t\toverrides.push(objects.deepClone(otherOverride));\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (const key of other.keys) {\n\t\t\t\tif (keys.indexOf(key) === -1) {\n\t\t\t\t\tkeys.push(key);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn new ConfigurationModel(contents, keys, overrides);\n\t}\n\n\tfreeze(): ConfigurationModel {\n\t\tthis.frozen = true;\n\t\treturn this;\n\t}\n\n\tclone(): ConfigurationModel {\n\t\treturn new ConfigurationModel(objects.deepClone(this.contents), [...this.keys], objects.deepClone(this.overrides));\n\t}\n\n\tprivate createOverrideConfigurationModel(identifier: string): ConfigurationModel {\n\t\tconst overrideContents = this.getContentsForOverrideIdentifer(identifier);\n\n\t\tif (!overrideContents || typeof overrideContents !== 'object' || !Object.keys(overrideContents).length) {\n\t\t\t// If there are no valid overrides, return self\n\t\t\treturn this;\n\t\t}\n\n\t\tconst contents: any = {};\n\t\tfor (const key of arrays.distinct([...Object.keys(this.contents), ...Object.keys(overrideContents)])) {\n\n\t\t\tlet contentsForKey = this.contents[key];\n\t\t\tconst overrideContentsForKey = overrideContents[key];\n\n\t\t\t// If there are override contents for the key, clone and merge otherwise use base contents\n\t\t\tif (overrideContentsForKey) {\n\t\t\t\t// Clone and merge only if base contents and override contents are of type object otherwise just override\n\t\t\t\tif (typeof contentsForKey === 'object' && typeof overrideContentsForKey === 'object') {\n\t\t\t\t\tcontentsForKey = objects.deepClone(contentsForKey);\n\t\t\t\t\tthis.mergeContents(contentsForKey, overrideContentsForKey);\n\t\t\t\t} else {\n\t\t\t\t\tcontentsForKey = overrideContentsForKey;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcontents[key] = contentsForKey;\n\t\t}\n\n\t\treturn new ConfigurationModel(contents, this.keys, this.overrides);\n\t}\n\n\tprivate mergeContents(source: any, target: any): void {\n\t\tfor (const key of Object.keys(target)) {\n\t\t\tif (key in source) {\n\t\t\t\tif (types.isObject(source[key]) && types.isObject(target[key])) {\n\t\t\t\t\tthis.mergeContents(source[key], target[key]);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t\tsource[key] = objects.deepClone(target[key]);\n\t\t}\n\t}\n\n\tprivate checkAndFreeze<T>(data: T): T {\n\t\tif (this.frozen && !Object.isFrozen(data)) {\n\t\t\treturn objects.deepFreeze(data);\n\t\t}\n\t\treturn data;\n\t}\n\n\tprivate getContentsForOverrideIdentifer(identifier: string): any {\n\t\tlet contentsForIdentifierOnly: IStringDictionary<any> | null = null;\n\t\tlet contents: IStringDictionary<any> | null = null;\n\t\tconst mergeContents = (contentsToMerge: any) => {\n\t\t\tif (contentsToMerge) {\n\t\t\t\tif (contents) {\n\t\t\t\t\tthis.mergeContents(contents, contentsToMerge);\n\t\t\t\t} else {\n\t\t\t\t\tcontents = objects.deepClone(contentsToMerge);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tfor (const override of this.overrides) {\n\t\t\tif (arrays.equals(override.identifiers, [identifier])) {\n\t\t\t\tcontentsForIdentifierOnly = override.contents;\n\t\t\t} else if (override.identifiers.includes(identifier)) {\n\t\t\t\tmergeContents(override.contents);\n\t\t\t}\n\t\t}\n\t\t// Merge contents of the identifier only at the end to take precedence.\n\t\tmergeContents(contentsForIdentifierOnly);\n\t\treturn contents;\n\t}\n\n\ttoJSON(): IConfigurationModel {\n\t\treturn {\n\t\t\tcontents: this.contents,\n\t\t\toverrides: this.overrides,\n\t\t\tkeys: this.keys\n\t\t};\n\t}\n\n\t// Update methods\n\n\tpublic setValue(key: string, value: any) {\n\t\tthis.addKey(key);\n\t\taddToValueTree(this.contents, key, value, e => { throw new Error(e); });\n\t}\n\n\tpublic removeValue(key: string): void {\n\t\tif (this.removeKey(key)) {\n\t\t\tremoveFromValueTree(this.contents, key);\n\t\t}\n\t}\n\n\tprivate addKey(key: string): void {\n\t\tlet index = this.keys.length;\n\t\tfor (let i = 0; i < index; i++) {\n\t\t\tif (key.indexOf(this.keys[i]) === 0) {\n\t\t\t\tindex = i;\n\t\t\t}\n\t\t}\n\t\tthis.keys.splice(index, 1, key);\n\t}\n\n\tprivate removeKey(key: string): boolean {\n\t\tconst index = this.keys.indexOf(key);\n\t\tif (index !== -1) {\n\t\t\tthis.keys.splice(index, 1);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n}\n\nexport interface ConfigurationParseOptions {\n\tscopes: ConfigurationScope[] | undefined;\n\tskipRestricted?: boolean;\n}\n\nexport class ConfigurationModelParser {\n\n\tprivate _raw: any = null;\n\tprivate _configurationModel: ConfigurationModel | null = null;\n\tprivate _restrictedConfigurations: string[] = [];\n\tprivate _parseErrors: any[] = [];\n\n\tconstructor(protected readonly _name: string) { }\n\n\tget configurationModel(): ConfigurationModel {\n\t\treturn this._configurationModel || new ConfigurationModel();\n\t}\n\n\tget restrictedConfigurations(): string[] {\n\t\treturn this._restrictedConfigurations;\n\t}\n\n\tget errors(): any[] {\n\t\treturn this._parseErrors;\n\t}\n\n\tpublic parse(content: string | null | undefined, options?: ConfigurationParseOptions): void {\n\t\tif (!types.isUndefinedOrNull(content)) {\n\t\t\tconst raw = this.doParseContent(content);\n\t\t\tthis.parseRaw(raw, options);\n\t\t}\n\t}\n\n\tpublic reparse(options: ConfigurationParseOptions): void {\n\t\tif (this._raw) {\n\t\t\tthis.parseRaw(this._raw, options);\n\t\t}\n\t}\n\n\tpublic parseRaw(raw: any, options?: ConfigurationParseOptions): void {\n\t\tthis._raw = raw;\n\t\tconst { contents, keys, overrides, restricted } = this.doParseRaw(raw, options);\n\t\tthis._configurationModel = new ConfigurationModel(contents, keys, overrides);\n\t\tthis._restrictedConfigurations = restricted || [];\n\t}\n\n\tprivate doParseContent(content: string): any {\n\t\tlet raw: any = {};\n\t\tlet currentProperty: string | null = null;\n\t\tlet currentParent: any = [];\n\t\tconst previousParents: any[] = [];\n\t\tconst parseErrors: json.ParseError[] = [];\n\n\t\tfunction onValue(value: any) {\n\t\t\tif (Array.isArray(currentParent)) {\n\t\t\t\t(<any[]>currentParent).push(value);\n\t\t\t} else if (currentProperty !== null) {\n\t\t\t\tcurrentParent[currentProperty] = value;\n\t\t\t}\n\t\t}\n\n\t\tconst visitor: json.JSONVisitor = {\n\t\t\tonObjectBegin: () => {\n\t\t\t\tconst object = {};\n\t\t\t\tonValue(object);\n\t\t\t\tpreviousParents.push(currentParent);\n\t\t\t\tcurrentParent = object;\n\t\t\t\tcurrentProperty = null;\n\t\t\t},\n\t\t\tonObjectProperty: (name: string) => {\n\t\t\t\tcurrentProperty = name;\n\t\t\t},\n\t\t\tonObjectEnd: () => {\n\t\t\t\tcurrentParent = previousParents.pop();\n\t\t\t},\n\t\t\tonArrayBegin: () => {\n\t\t\t\tconst array: any[] = [];\n\t\t\t\tonValue(array);\n\t\t\t\tpreviousParents.push(currentParent);\n\t\t\t\tcurrentParent = array;\n\t\t\t\tcurrentProperty = null;\n\t\t\t},\n\t\t\tonArrayEnd: () => {\n\t\t\t\tcurrentParent = previousParents.pop();\n\t\t\t},\n\t\t\tonLiteralValue: onValue,\n\t\t\tonError: (error: json.ParseErrorCode, offset: number, length: number) => {\n\t\t\t\tparseErrors.push({ error, offset, length });\n\t\t\t}\n\t\t};\n\t\tif (content) {\n\t\t\ttry {\n\t\t\t\tjson.visit(content, visitor);\n\t\t\t\traw = currentParent[0] || {};\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(`Error while parsing settings file ${this._name}: ${e}`);\n\t\t\t\tthis._parseErrors = [e];\n\t\t\t}\n\t\t}\n\n\t\treturn raw;\n\t}\n\n\tprotected doParseRaw(raw: any, options?: ConfigurationParseOptions): IConfigurationModel & { restricted?: string[] } {\n\t\tconst configurationProperties = Registry.as<IConfigurationRegistry>(Extensions.Configuration).getConfigurationProperties();\n\t\tconst filtered = this.filter(raw, configurationProperties, true, options);\n\t\traw = filtered.raw;\n\t\tconst contents = toValuesTree(raw, message => console.error(`Conflict in settings file ${this._name}: ${message}`));\n\t\tconst keys = Object.keys(raw);\n\t\tconst overrides = this.toOverrides(raw, message => console.error(`Conflict in settings file ${this._name}: ${message}`));\n\t\treturn { contents, keys, overrides, restricted: filtered.restricted };\n\t}\n\n\tprivate filter(properties: any, configurationProperties: { [qualifiedKey: string]: IConfigurationPropertySchema | undefined }, filterOverriddenProperties: boolean, options?: ConfigurationParseOptions): { raw: {}; restricted: string[] } {\n\t\tif (!options?.scopes && !options?.skipRestricted) {\n\t\t\treturn { raw: properties, restricted: [] };\n\t\t}\n\t\tconst raw: any = {};\n\t\tconst restricted: string[] = [];\n\t\tfor (const key in properties) {\n\t\t\tif (OVERRIDE_PROPERTY_REGEX.test(key) && filterOverriddenProperties) {\n\t\t\t\tconst result = this.filter(properties[key], configurationProperties, false, options);\n\t\t\t\traw[key] = result.raw;\n\t\t\t\trestricted.push(...result.restricted);\n\t\t\t} else {\n\t\t\t\tconst propertySchema = configurationProperties[key];\n\t\t\t\tconst scope = propertySchema ? typeof propertySchema.scope !== 'undefined' ? propertySchema.scope : ConfigurationScope.WINDOW : undefined;\n\t\t\t\tif (propertySchema?.restricted) {\n\t\t\t\t\trestricted.push(key);\n\t\t\t\t}\n\t\t\t\t// Load unregistered configurations always.\n\t\t\t\tif (scope === undefined || options.scopes === undefined || options.scopes.includes(scope)) {\n\t\t\t\t\tif (!(options.skipRestricted && propertySchema?.restricted)) {\n\t\t\t\t\t\traw[key] = properties[key];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn { raw, restricted };\n\t}\n\n\tprivate toOverrides(raw: any, conflictReporter: (message: string) => void): IOverrides[] {\n\t\tconst overrides: IOverrides[] = [];\n\t\tfor (const key of Object.keys(raw)) {\n\t\t\tif (OVERRIDE_PROPERTY_REGEX.test(key)) {\n\t\t\t\tconst overrideRaw: any = {};\n\t\t\t\tfor (const keyInOverrideRaw in raw[key]) {\n\t\t\t\t\toverrideRaw[keyInOverrideRaw] = raw[key][keyInOverrideRaw];\n\t\t\t\t}\n\t\t\t\toverrides.push({\n\t\t\t\t\tidentifiers: overrideIdentifiersFromKey(key),\n\t\t\t\t\tkeys: Object.keys(overrideRaw),\n\t\t\t\t\tcontents: toValuesTree(overrideRaw, conflictReporter)\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn overrides;\n\t}\n\n}\n\nexport class UserSettings extends Disposable {\n\n\tprivate readonly parser: ConfigurationModelParser;\n\tprivate readonly parseOptions: ConfigurationParseOptions;\n\tprotected readonly _onDidChange: Emitter<void> = this._register(new Emitter<void>());\n\treadonly onDidChange: Event<void> = this._onDidChange.event;\n\n\tconstructor(\n\t\tprivate readonly userSettingsResource: URI,\n\t\tprivate readonly scopes: ConfigurationScope[] | undefined,\n\t\textUri: IExtUri,\n\t\tprivate readonly fileService: IFileService\n\t) {\n\t\tsuper();\n\t\tthis.parser = new ConfigurationModelParser(this.userSettingsResource.toString());\n\t\tthis.parseOptions = { scopes: this.scopes };\n\t\tthis._register(this.fileService.watch(extUri.dirname(this.userSettingsResource)));\n\t\t// Also listen to the resource incase the resource is a symlink - https://github.com/microsoft/vscode/issues/118134\n\t\tthis._register(this.fileService.watch(this.userSettingsResource));\n\t\tthis._register(Event.any(\n\t\t\tEvent.filter(this.fileService.onDidFilesChange, e => e.contains(this.userSettingsResource)),\n\t\t\tEvent.filter(this.fileService.onDidRunOperation, e => (e.isOperation(FileOperation.CREATE) || e.isOperation(FileOperation.COPY) || e.isOperation(FileOperation.DELETE) || e.isOperation(FileOperation.WRITE)) && extUri.isEqual(e.resource, userSettingsResource))\n\t\t)(() => this._onDidChange.fire()));\n\t}\n\n\tasync loadConfiguration(): Promise<ConfigurationModel> {\n\t\ttry {\n\t\t\tconst content = await this.fileService.readFile(this.userSettingsResource);\n\t\t\tthis.parser.parse(content.value.toString() || '{}', this.parseOptions);\n\t\t\treturn this.parser.configurationModel;\n\t\t} catch (e) {\n\t\t\treturn new ConfigurationModel();\n\t\t}\n\t}\n\n\treparse(): ConfigurationModel {\n\t\tthis.parser.reparse(this.parseOptions);\n\t\treturn this.parser.configurationModel;\n\t}\n\n\tgetRestrictedSettings(): string[] {\n\t\treturn this.parser.restrictedConfigurations;\n\t}\n}\n\n\nexport class Configuration {\n\n\tprivate _workspaceConsolidatedConfiguration: ConfigurationModel | null = null;\n\tprivate _foldersConsolidatedConfigurations: ResourceMap<ConfigurationModel> = new ResourceMap<ConfigurationModel>();\n\n\tconstructor(\n\t\tprivate _defaultConfiguration: ConfigurationModel,\n\t\tprivate _policyConfiguration: ConfigurationModel,\n\t\tprivate _applicationConfiguration: ConfigurationModel,\n\t\tprivate _localUserConfiguration: ConfigurationModel,\n\t\tprivate _remoteUserConfiguration: ConfigurationModel = new ConfigurationModel(),\n\t\tprivate _workspaceConfiguration: ConfigurationModel = new ConfigurationModel(),\n\t\tprivate _folderConfigurations: ResourceMap<ConfigurationModel> = new ResourceMap<ConfigurationModel>(),\n\t\tprivate _memoryConfiguration: ConfigurationModel = new ConfigurationModel(),\n\t\tprivate _memoryConfigurationByResource: ResourceMap<ConfigurationModel> = new ResourceMap<ConfigurationModel>(),\n\t\tprivate _freeze: boolean = true) {\n\t}\n\n\tgetValue(section: string | undefined, overrides: IConfigurationOverrides, workspace: Workspace | undefined): any {\n\t\tconst consolidateConfigurationModel = this.getConsolidatedConfigurationModel(section, overrides, workspace);\n\t\treturn consolidateConfigurationModel.getValue(section);\n\t}\n\n\tupdateValue(key: string, value: any, overrides: IConfigurationUpdateOverrides = {}): void {\n\t\tlet memoryConfiguration: ConfigurationModel | undefined;\n\t\tif (overrides.resource) {\n\t\t\tmemoryConfiguration = this._memoryConfigurationByResource.get(overrides.resource);\n\t\t\tif (!memoryConfiguration) {\n\t\t\t\tmemoryConfiguration = new ConfigurationModel();\n\t\t\t\tthis._memoryConfigurationByResource.set(overrides.resource, memoryConfiguration);\n\t\t\t}\n\t\t} else {\n\t\t\tmemoryConfiguration = this._memoryConfiguration;\n\t\t}\n\n\t\tif (value === undefined) {\n\t\t\tmemoryConfiguration.removeValue(key);\n\t\t} else {\n\t\t\tmemoryConfiguration.setValue(key, value);\n\t\t}\n\n\t\tif (!overrides.resource) {\n\t\t\tthis._workspaceConsolidatedConfiguration = null;\n\t\t}\n\t}\n\n\tinspect<C>(key: string, overrides: IConfigurationOverrides, workspace: Workspace | undefined): IConfigurationValue<C> {\n\t\tconst consolidateConfigurationModel = this.getConsolidatedConfigurationModel(key, overrides, workspace);\n\t\tconst folderConfigurationModel = this.getFolderConfigurationModelForResource(overrides.resource, workspace);\n\t\tconst memoryConfigurationModel = overrides.resource ? this._memoryConfigurationByResource.get(overrides.resource) || this._memoryConfiguration : this._memoryConfiguration;\n\n\t\tconst defaultValue = overrides.overrideIdentifier ? this._defaultConfiguration.freeze().override(overrides.overrideIdentifier).getValue<C>(key) : this._defaultConfiguration.freeze().getValue<C>(key);\n\t\tconst policyValue = this._policyConfiguration.isEmpty() ? undefined : this._policyConfiguration.freeze().getValue<C>(key);\n\t\tconst applicationValue = this.applicationConfiguration.isEmpty() ? undefined : this.applicationConfiguration.freeze().getValue<C>(key);\n\t\tconst userValue = overrides.overrideIdentifier ? this.userConfiguration.freeze().override(overrides.overrideIdentifier).getValue<C>(key) : this.userConfiguration.freeze().getValue<C>(key);\n\t\tconst userLocalValue = overrides.overrideIdentifier ? this.localUserConfiguration.freeze().override(overrides.overrideIdentifier).getValue<C>(key) : this.localUserConfiguration.freeze().getValue<C>(key);\n\t\tconst userRemoteValue = overrides.overrideIdentifier ? this.remoteUserConfiguration.freeze().override(overrides.overrideIdentifier).getValue<C>(key) : this.remoteUserConfiguration.freeze().getValue<C>(key);\n\t\tconst workspaceValue = workspace ? overrides.overrideIdentifier ? this._workspaceConfiguration.freeze().override(overrides.overrideIdentifier).getValue<C>(key) : this._workspaceConfiguration.freeze().getValue<C>(key) : undefined; //Check on workspace exists or not because _workspaceConfiguration is never null\n\t\tconst workspaceFolderValue = folderConfigurationModel ? overrides.overrideIdentifier ? folderConfigurationModel.freeze().override(overrides.overrideIdentifier).getValue<C>(key) : folderConfigurationModel.freeze().getValue<C>(key) : undefined;\n\t\tconst memoryValue = overrides.overrideIdentifier ? memoryConfigurationModel.override(overrides.overrideIdentifier).getValue<C>(key) : memoryConfigurationModel.getValue<C>(key);\n\t\tconst value = consolidateConfigurationModel.getValue<C>(key);\n\t\tconst overrideIdentifiers: string[] = arrays.distinct(consolidateConfigurationModel.overrides.map(override => override.identifiers).flat()).filter(overrideIdentifier => consolidateConfigurationModel.getOverrideValue(key, overrideIdentifier) !== undefined);\n\n\t\treturn {\n\t\t\tdefaultValue,\n\t\t\tpolicyValue,\n\t\t\tapplicationValue,\n\t\t\tuserValue,\n\t\t\tuserLocalValue,\n\t\t\tuserRemoteValue,\n\t\t\tworkspaceValue,\n\t\t\tworkspaceFolderValue,\n\t\t\tmemoryValue,\n\t\t\tvalue,\n\n\t\t\tdefault: defaultValue !== undefined ? { value: this._defaultConfiguration.freeze().getValue(key), override: overrides.overrideIdentifier ? this._defaultConfiguration.freeze().getOverrideValue(key, overrides.overrideIdentifier) : undefined } : undefined,\n\t\t\tpolicy: policyValue !== undefined ? { value: policyValue } : undefined,\n\t\t\tapplication: applicationValue !== undefined ? { value: applicationValue, override: overrides.overrideIdentifier ? this.applicationConfiguration.freeze().getOverrideValue(key, overrides.overrideIdentifier) : undefined } : undefined,\n\t\t\tuser: userValue !== undefined ? { value: this.userConfiguration.freeze().getValue(key), override: overrides.overrideIdentifier ? this.userConfiguration.freeze().getOverrideValue(key, overrides.overrideIdentifier) : undefined } : undefined,\n\t\t\tuserLocal: userLocalValue !== undefined ? { value: this.localUserConfiguration.freeze().getValue(key), override: overrides.overrideIdentifier ? this.localUserConfiguration.freeze().getOverrideValue(key, overrides.overrideIdentifier) : undefined } : undefined,\n\t\t\tuserRemote: userRemoteValue !== undefined ? { value: this.remoteUserConfiguration.freeze().getValue(key), override: overrides.overrideIdentifier ? this.remoteUserConfiguration.freeze().getOverrideValue(key, overrides.overrideIdentifier) : undefined } : undefined,\n\t\t\tworkspace: workspaceValue !== undefined ? { value: this._workspaceConfiguration.freeze().getValue(key), override: overrides.overrideIdentifier ? this._workspaceConfiguration.freeze().getOverrideValue(key, overrides.overrideIdentifier) : undefined } : undefined,\n\t\t\tworkspaceFolder: workspaceFolderValue !== undefined ? { value: folderConfigurationModel?.freeze().getValue(key), override: overrides.overrideIdentifier ? folderConfigurationModel?.freeze().getOverrideValue(key, overrides.overrideIdentifier) : undefined } : undefined,\n\t\t\tmemory: memoryValue !== undefined ? { value: memoryConfigurationModel.getValue(key), override: overrides.overrideIdentifier ? memoryConfigurationModel.getOverrideValue(key, overrides.overrideIdentifier) : undefined } : undefined,\n\n\t\t\toverrideIdentifiers: overrideIdentifiers.length ? overrideIdentifiers : undefined\n\t\t};\n\t}\n\n\tkeys(workspace: Workspace | undefined): {\n\t\tdefault: string[];\n\t\tuser: string[];\n\t\tworkspace: string[];\n\t\tworkspaceFolder: string[];\n\t} {\n\t\tconst folderConfigurationModel = this.getFolderConfigurationModelForResource(undefined, workspace);\n\t\treturn {\n\t\t\tdefault: this._defaultConfiguration.freeze().keys,\n\t\t\tuser: this.userConfiguration.freeze().keys,\n\t\t\tworkspace: this._workspaceConfiguration.freeze().keys,\n\t\t\tworkspaceFolder: folderConfigurationModel ? folderConfigurationModel.freeze().keys : []\n\t\t};\n\t}\n\n\tupdateDefaultConfiguration(defaultConfiguration: ConfigurationModel): void {\n\t\tthis._defaultConfiguration = defaultConfiguration;\n\t\tthis._workspaceConsolidatedConfiguration = null;\n\t\tthis._foldersConsolidatedConfigurations.clear();\n\t}\n\n\tupdatePolicyConfiguration(policyConfiguration: ConfigurationModel): void {\n\t\tthis._policyConfiguration = policyConfiguration;\n\t}\n\n\tupdateApplicationConfiguration(applicationConfiguration: ConfigurationModel): void {\n\t\tthis._applicationConfiguration = applicationConfiguration;\n\t\tthis._workspaceConsolidatedConfiguration = null;\n\t\tthis._foldersConsolidatedConfigurations.clear();\n\t}\n\n\tupdateLocalUserConfiguration(localUserConfiguration: ConfigurationModel): void {\n\t\tthis._localUserConfiguration = localUserConfiguration;\n\t\tthis._userConfiguration = null;\n\t\tthis._workspaceConsolidatedConfiguration = null;\n\t\tthis._foldersConsolidatedConfigurations.clear();\n\t}\n\n\tupdateRemoteUserConfiguration(remoteUserConfiguration: ConfigurationModel): void {\n\t\tthis._remoteUserConfiguration = remoteUserConfiguration;\n\t\tthis._userConfiguration = null;\n\t\tthis._workspaceConsolidatedConfiguration = null;\n\t\tthis._foldersConsolidatedConfigurations.clear();\n\t}\n\n\tupdateWorkspaceConfiguration(workspaceConfiguration: ConfigurationModel): void {\n\t\tthis._workspaceConfiguration = workspaceConfiguration;\n\t\tthis._workspaceConsolidatedConfiguration = null;\n\t\tthis._foldersConsolidatedConfigurations.clear();\n\t}\n\n\tupdateFolderConfiguration(resource: URI, configuration: ConfigurationModel): void {\n\t\tthis._folderConfigurations.set(resource, configuration);\n\t\tthis._foldersConsolidatedConfigurations.delete(resource);\n\t}\n\n\tdeleteFolderConfiguration(resource: URI): void {\n\t\tthis.folderConfigurations.delete(resource);\n\t\tthis._foldersConsolidatedConfigurations.delete(resource);\n\t}\n\n\tcompareAndUpdateDefaultConfiguration(defaults: ConfigurationModel, keys?: string[]): IConfigurationChange {\n\t\tconst overrides: [string, string[]][] = [];\n\t\tif (!keys) {\n\t\t\tconst { added, updated, removed } = compare(this._defaultConfiguration, defaults);\n\t\t\tkeys = [...added, ...updated, ...removed];\n\t\t}\n\t\tfor (const key of keys) {\n\t\t\tfor (const overrideIdentifier of overrideIdentifiersFromKey(key)) {\n\t\t\t\tconst fromKeys = this._defaultConfiguration.getKeysForOverrideIdentifier(overrideIdentifier);\n\t\t\t\tconst toKeys = defaults.getKeysForOverrideIdentifier(overrideIdentifier);\n\t\t\t\tconst keys = [\n\t\t\t\t\t...toKeys.filter(key => fromKeys.indexOf(key) === -1),\n\t\t\t\t\t...fromKeys.filter(key => toKeys.indexOf(key) === -1),\n\t\t\t\t\t...fromKeys.filter(key => !objects.equals(this._defaultConfiguration.override(overrideIdentifier).getValue(key), defaults.override(overrideIdentifier).getValue(key)))\n\t\t\t\t];\n\t\t\t\toverrides.push([overrideIdentifier, keys]);\n\t\t\t}\n\t\t}\n\t\tthis.updateDefaultConfiguration(defaults);\n\t\treturn { keys, overrides };\n\t}\n\n\tcompareAndUpdatePolicyConfiguration(policyConfiguration: ConfigurationModel): IConfigurationChange {\n\t\tconst { added, updated, removed } = compare(this._policyConfiguration, policyConfiguration);\n\t\tconst keys = [...added, ...updated, ...removed];\n\t\tif (keys.length) {\n\t\t\tthis.updatePolicyConfiguration(policyConfiguration);\n\t\t}\n\t\treturn { keys, overrides: [] };\n\t}\n\n\tcompareAndUpdateApplicationConfiguration(application: ConfigurationModel): IConfigurationChange {\n\t\tconst { added, updated, removed, overrides } = compare(this.applicationConfiguration, application);\n\t\tconst keys = [...added, ...updated, ...removed];\n\t\tif (keys.length) {\n\t\t\tthis.updateApplicationConfiguration(application);\n\t\t}\n\t\treturn { keys, overrides };\n\t}\n\n\tcompareAndUpdateLocalUserConfiguration(user: ConfigurationModel): IConfigurationChange {\n\t\tconst { added, updated, removed, overrides } = compare(this.localUserConfiguration, user);\n\t\tconst keys = [...added, ...updated, ...removed];\n\t\tif (keys.length) {\n\t\t\tthis.updateLocalUserConfiguration(user);\n\t\t}\n\t\treturn { keys, overrides };\n\t}\n\n\tcompareAndUpdateRemoteUserConfiguration(user: ConfigurationModel): IConfigurationChange {\n\t\tconst { added, updated, removed, overrides } = compare(this.remoteUserConfiguration, user);\n\t\tconst keys = [...added, ...updated, ...removed];\n\t\tif (keys.length) {\n\t\t\tthis.updateRemoteUserConfiguration(user);\n\t\t}\n\t\treturn { keys, overrides };\n\t}\n\n\tcompareAndUpdateWorkspaceConfiguration(workspaceConfiguration: ConfigurationModel): IConfigurationChange {\n\t\tconst { added, updated, removed, overrides } = compare(this.workspaceConfiguration, workspaceConfiguration);\n\t\tconst keys = [...added, ...updated, ...removed];\n\t\tif (keys.length) {\n\t\t\tthis.updateWorkspaceConfiguration(workspaceConfiguration);\n\t\t}\n\t\treturn { keys, overrides };\n\t}\n\n\tcompareAndUpdateFolderConfiguration(resource: URI, folderConfiguration: ConfigurationModel): IConfigurationChange {\n\t\tconst currentFolderConfiguration = this.folderConfigurations.get(resource);\n\t\tconst { added, updated, removed, overrides } = compare(currentFolderConfiguration, folderConfiguration);\n\t\tconst keys = [...added, ...updated, ...removed];\n\t\tif (keys.length || !currentFolderConfiguration) {\n\t\t\tthis.updateFolderConfiguration(resource, folderConfiguration);\n\t\t}\n\t\treturn { keys, overrides };\n\t}\n\n\tcompareAndDeleteFolderConfiguration(folder: URI): IConfigurationChange {\n\t\tconst folderConfig = this.folderConfigurations.get(folder);\n\t\tif (!folderConfig) {\n\t\t\tthrow new Error('Unknown folder');\n\t\t}\n\t\tthis.deleteFolderConfiguration(folder);\n\t\tconst { added, updated, removed, overrides } = compare(folderConfig, undefined);\n\t\treturn { keys: [...added, ...updated, ...removed], overrides };\n\t}\n\n\tget defaults(): ConfigurationModel {\n\t\treturn this._defaultConfiguration;\n\t}\n\n\tget applicationConfiguration(): ConfigurationModel {\n\t\treturn this._applicationConfiguration;\n\t}\n\n\tprivate _userConfiguration: ConfigurationModel | null = null;\n\tget userConfiguration(): ConfigurationModel {\n\t\tif (!this._userConfiguration) {\n\t\t\tthis._userConfiguration = this._remoteUserConfiguration.isEmpty() ? this._localUserConfiguration : this._localUserConfiguration.merge(this._remoteUserConfiguration);\n\t\t\tif (this._freeze) {\n\t\t\t\tthis._userConfiguration.freeze();\n\t\t\t}\n\t\t}\n\t\treturn this._userConfiguration;\n\t}\n\n\tget localUserConfiguration(): ConfigurationModel {\n\t\treturn this._localUserConfiguration;\n\t}\n\n\tget remoteUserConfiguration(): ConfigurationModel {\n\t\treturn this._remoteUserConfiguration;\n\t}\n\n\tget workspaceConfiguration(): ConfigurationModel {\n\t\treturn this._workspaceConfiguration;\n\t}\n\n\tprotected get folderConfigurations(): ResourceMap<ConfigurationModel> {\n\t\treturn this._folderConfigurations;\n\t}\n\n\tprivate getConsolidatedConfigurationModel(section: string | undefined, overrides: IConfigurationOverrides, workspace: Workspace | undefined): ConfigurationModel {\n\t\tlet configurationModel = this.getConsolidatedConfigurationModelForResource(overrides, workspace);\n\t\tif (overrides.overrideIdentifier) {\n\t\t\tconfigurationModel = configurationModel.override(overrides.overrideIdentifier);\n\t\t}\n\t\tif (!this._policyConfiguration.isEmpty() && this._policyConfiguration.getValue(section) !== undefined) {\n\t\t\tconfigurationModel = configurationModel.merge(this._policyConfiguration);\n\t\t}\n\t\treturn configurationModel;\n\t}\n\n\tprivate getConsolidatedConfigurationModelForResource({ resource }: IConfigurationOverrides, workspace: Workspace | undefined): ConfigurationModel {\n\t\tlet consolidateConfiguration = this.getWorkspaceConsolidatedConfiguration();\n\n\t\tif (workspace && resource) {\n\t\t\tconst root = workspace.getFolder(resource);\n\t\t\tif (root) {\n\t\t\t\tconsolidateConfiguration = this.getFolderConsolidatedConfiguration(root.uri) || consolidateConfiguration;\n\t\t\t}\n\t\t\tconst memoryConfigurationForResource = this._memoryConfigurationByResource.get(resource);\n\t\t\tif (memoryConfigurationForResource) {\n\t\t\t\tconsolidateConfiguration = consolidateConfiguration.merge(memoryConfigurationForResource);\n\t\t\t}\n\t\t}\n\n\t\treturn consolidateConfiguration;\n\t}\n\n\tprivate getWorkspaceConsolidatedConfiguration(): ConfigurationModel {\n\t\tif (!this._workspaceConsolidatedConfiguration) {\n\t\t\tthis._workspaceConsolidatedConfiguration = this._defaultConfiguration.merge(this.applicationConfiguration, this.userConfiguration, this._workspaceConfiguration, this._memoryConfiguration);\n\t\t\tif (this._freeze) {\n\t\t\t\tthis._workspaceConfiguration = this._workspaceConfiguration.freeze();\n\t\t\t}\n\t\t}\n\t\treturn this._workspaceConsolidatedConfiguration;\n\t}\n\n\tprivate getFolderConsolidatedConfiguration(folder: URI): ConfigurationModel {\n\t\tlet folderConsolidatedConfiguration = this._foldersConsolidatedConfigurations.get(folder);\n\t\tif (!folderConsolidatedConfiguration) {\n\t\t\tconst workspaceConsolidateConfiguration = this.getWorkspaceConsolidatedConfiguration();\n\t\t\tconst folderConfiguration = this._folderConfigurations.get(folder);\n\t\t\tif (folderConfiguration) {\n\t\t\t\tfolderConsolidatedConfiguration = workspaceConsolidateConfiguration.merge(folderConfiguration);\n\t\t\t\tif (this._freeze) {\n\t\t\t\t\tfolderConsolidatedConfiguration = folderConsolidatedConfiguration.freeze();\n\t\t\t\t}\n\t\t\t\tthis._foldersConsolidatedConfigurations.set(folder, folderConsolidatedConfiguration);\n\t\t\t} else {\n\t\t\t\tfolderConsolidatedConfiguration = workspaceConsolidateConfiguration;\n\t\t\t}\n\t\t}\n\t\treturn folderConsolidatedConfiguration;\n\t}\n\n\tprivate getFolderConfigurationModelForResource(resource: URI | null | undefined, workspace: Workspace | undefined): ConfigurationModel | undefined {\n\t\tif (workspace && resource) {\n\t\t\tconst root = workspace.getFolder(resource);\n\t\t\tif (root) {\n\t\t\t\treturn this._folderConfigurations.get(root.uri);\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\ttoData(): IConfigurationData {\n\t\treturn {\n\t\t\tdefaults: {\n\t\t\t\tcontents: this._defaultConfiguration.contents,\n\t\t\t\toverrides: this._defaultConfiguration.overrides,\n\t\t\t\tkeys: this._defaultConfiguration.keys\n\t\t\t},\n\t\t\tpolicy: {\n\t\t\t\tcontents: this._policyConfiguration.contents,\n\t\t\t\toverrides: this._policyConfiguration.overrides,\n\t\t\t\tkeys: this._policyConfiguration.keys\n\t\t\t},\n\t\t\tapplication: {\n\t\t\t\tcontents: this.applicationConfiguration.contents,\n\t\t\t\toverrides: this.applicationConfiguration.overrides,\n\t\t\t\tkeys: this.applicationConfiguration.keys\n\t\t\t},\n\t\t\tuser: {\n\t\t\t\tcontents: this.userConfiguration.contents,\n\t\t\t\toverrides: this.userConfiguration.overrides,\n\t\t\t\tkeys: this.userConfiguration.keys\n\t\t\t},\n\t\t\tworkspace: {\n\t\t\t\tcontents: this._workspaceConfiguration.contents,\n\t\t\t\toverrides: this._workspaceConfiguration.overrides,\n\t\t\t\tkeys: this._workspaceConfiguration.keys\n\t\t\t},\n\t\t\tfolders: [...this._folderConfigurations.keys()].reduce<[UriComponents, IConfigurationModel][]>((result, folder) => {\n\t\t\t\tconst { contents, overrides, keys } = this._folderConfigurations.get(folder)!;\n\t\t\t\tresult.push([folder, { contents, overrides, keys }]);\n\t\t\t\treturn result;\n\t\t\t}, [])\n\t\t};\n\t}\n\n\tallKeys(): string[] {\n\t\tconst keys: Set<string> = new Set<string>();\n\t\tthis._defaultConfiguration.freeze().keys.forEach(key => keys.add(key));\n\t\tthis.userConfiguration.freeze().keys.forEach(key => keys.add(key));\n\t\tthis._workspaceConfiguration.freeze().keys.forEach(key => keys.add(key));\n\t\tthis._folderConfigurations.forEach(folderConfiguraiton => folderConfiguraiton.freeze().keys.forEach(key => keys.add(key)));\n\t\treturn [...keys.values()];\n\t}\n\n\tprotected allOverrideIdentifiers(): string[] {\n\t\tconst keys: Set<string> = new Set<string>();\n\t\tthis._defaultConfiguration.freeze().getAllOverrideIdentifiers().forEach(key => keys.add(key));\n\t\tthis.userConfiguration.freeze().getAllOverrideIdentifiers().forEach(key => keys.add(key));\n\t\tthis._workspaceConfiguration.freeze().getAllOverrideIdentifiers().forEach(key => keys.add(key));\n\t\tthis._folderConfigurations.forEach(folderConfiguraiton => folderConfiguraiton.freeze().getAllOverrideIdentifiers().forEach(key => keys.add(key)));\n\t\treturn [...keys.values()];\n\t}\n\n\tprotected getAllKeysForOverrideIdentifier(overrideIdentifier: string): string[] {\n\t\tconst keys: Set<string> = new Set<string>();\n\t\tthis._defaultConfiguration.getKeysForOverrideIdentifier(overrideIdentifier).forEach(key => keys.add(key));\n\t\tthis.userConfiguration.getKeysForOverrideIdentifier(overrideIdentifier).forEach(key => keys.add(key));\n\t\tthis._workspaceConfiguration.getKeysForOverrideIdentifier(overrideIdentifier).forEach(key => keys.add(key));\n\t\tthis._folderConfigurations.forEach(folderConfiguraiton => folderConfiguraiton.getKeysForOverrideIdentifier(overrideIdentifier).forEach(key => keys.add(key)));\n\t\treturn [...keys.values()];\n\t}\n\n\tstatic parse(data: IConfigurationData): Configuration {\n\t\tconst defaultConfiguration = this.parseConfigurationModel(data.defaults);\n\t\tconst policyConfiguration = this.parseConfigurationModel(data.policy);\n\t\tconst applicationConfiguration = this.parseConfigurationModel(data.application);\n\t\tconst userConfiguration = this.parseConfigurationModel(data.user);\n\t\tconst workspaceConfiguration = this.parseConfigurationModel(data.workspace);\n\t\tconst folders: ResourceMap<ConfigurationModel> = data.folders.reduce((result, value) => {\n\t\t\tresult.set(URI.revive(value[0]), this.parseConfigurationModel(value[1]));\n\t\t\treturn result;\n\t\t}, new ResourceMap<ConfigurationModel>());\n\t\treturn new Configuration(defaultConfiguration, policyConfiguration, applicationConfiguration, userConfiguration, new ConfigurationModel(), workspaceConfiguration, folders, new ConfigurationModel(), new ResourceMap<ConfigurationModel>(), false);\n\t}\n\n\tprivate static parseConfigurationModel(model: IConfigurationModel): ConfigurationModel {\n\t\treturn new ConfigurationModel(model.contents, model.keys, model.overrides).freeze();\n\t}\n\n}\n\nexport function mergeChanges(...changes: IConfigurationChange[]): IConfigurationChange {\n\tif (changes.length === 0) {\n\t\treturn { keys: [], overrides: [] };\n\t}\n\tif (changes.length === 1) {\n\t\treturn changes[0];\n\t}\n\tconst keysSet = new Set<string>();\n\tconst overridesMap = new Map<string, Set<string>>();\n\tfor (const change of changes) {\n\t\tchange.keys.forEach(key => keysSet.add(key));\n\t\tchange.overrides.forEach(([identifier, keys]) => {\n\t\t\tconst result = getOrSet(overridesMap, identifier, new Set<string>());\n\t\t\tkeys.forEach(key => result.add(key));\n\t\t});\n\t}\n\tconst overrides: [string, string[]][] = [];\n\toverridesMap.forEach((keys, identifier) => overrides.push([identifier, [...keys.values()]]));\n\treturn { keys: [...keysSet.values()], overrides };\n}\n\nexport class ConfigurationChangeEvent implements IConfigurationChangeEvent {\n\n\tprivate readonly affectedKeysTree: any;\n\treadonly affectedKeys: string[];\n\tsource!: ConfigurationTarget;\n\tsourceConfig: any;\n\n\tconstructor(readonly change: IConfigurationChange, private readonly previous: { workspace?: Workspace; data: IConfigurationData } | undefined, private readonly currentConfiguraiton: Configuration, private readonly currentWorkspace?: Workspace) {\n\t\tconst keysSet = new Set<string>();\n\t\tchange.keys.forEach(key => keysSet.add(key));\n\t\tchange.overrides.forEach(([, keys]) => keys.forEach(key => keysSet.add(key)));\n\t\tthis.affectedKeys = [...keysSet.values()];\n\n\t\tconst configurationModel = new ConfigurationModel();\n\t\tthis.affectedKeys.forEach(key => configurationModel.setValue(key, {}));\n\t\tthis.affectedKeysTree = configurationModel.contents;\n\t}\n\n\tprivate _previousConfiguration: Configuration | undefined = undefined;\n\tget previousConfiguration(): Configuration | undefined {\n\t\tif (!this._previousConfiguration && this.previous) {\n\t\t\tthis._previousConfiguration = Configuration.parse(this.previous.data);\n\t\t}\n\t\treturn this._previousConfiguration;\n\t}\n\n\taffectsConfiguration(section: string, overrides?: IConfigurationOverrides): boolean {\n\t\tif (this.doesAffectedKeysTreeContains(this.affectedKeysTree, section)) {\n\t\t\tif (overrides) {\n\t\t\t\tconst value1 = this.previousConfiguration ? this.previousConfiguration.getValue(section, overrides, this.previous?.workspace) : undefined;\n\t\t\t\tconst value2 = this.currentConfiguraiton.getValue(section, overrides, this.currentWorkspace);\n\t\t\t\treturn !objects.equals(value1, value2);\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate doesAffectedKeysTreeContains(affectedKeysTree: any, section: string): boolean {\n\t\tlet requestedTree = toValuesTree({ [section]: true }, () => { });\n\n\t\tlet key;\n\t\twhile (typeof requestedTree === 'object' && (key = Object.keys(requestedTree)[0])) { // Only one key should present, since we added only one property\n\t\t\taffectedKeysTree = affectedKeysTree[key];\n\t\t\tif (!affectedKeysTree) {\n\t\t\t\treturn false; // Requested tree is not found\n\t\t\t}\n\t\t\trequestedTree = requestedTree[key];\n\t\t}\n\t\treturn true;\n\t}\n}\n\nexport class AllKeysConfigurationChangeEvent extends ConfigurationChangeEvent {\n\tconstructor(configuration: Configuration, workspace: Workspace, source: ConfigurationTarget, sourceConfig: any) {\n\t\tsuper({ keys: configuration.allKeys(), overrides: [] }, undefined, configuration, workspace);\n\t\tthis.source = source;\n\t\tthis.sourceConfig = sourceConfig;\n\t}\n}\n\nfunction compare(from: ConfigurationModel | undefined, to: ConfigurationModel | undefined): IConfigurationCompareResult {\n\tconst { added, removed, updated } = compareConfigurationContents(to, from);\n\tconst overrides: [string, string[]][] = [];\n\n\tconst fromOverrideIdentifiers = from?.getAllOverrideIdentifiers() || [];\n\tconst toOverrideIdentifiers = to?.getAllOverrideIdentifiers() || [];\n\n\tif (to) {\n\t\tconst addedOverrideIdentifiers = toOverrideIdentifiers.filter(key => !fromOverrideIdentifiers.includes(key));\n\t\tfor (const identifier of addedOverrideIdentifiers) {\n\t\t\toverrides.push([identifier, to.getKeysForOverrideIdentifier(identifier)]);\n\t\t}\n\t}\n\n\tif (from) {\n\t\tconst removedOverrideIdentifiers = fromOverrideIdentifiers.filter(key => !toOverrideIdentifiers.includes(key));\n\t\tfor (const identifier of removedOverrideIdentifiers) {\n\t\t\toverrides.push([identifier, from.getKeysForOverrideIdentifier(identifier)]);\n\t\t}\n\t}\n\n\tif (to && from) {\n\t\tfor (const identifier of fromOverrideIdentifiers) {\n\t\t\tif (toOverrideIdentifiers.includes(identifier)) {\n\t\t\t\tconst result = compareConfigurationContents({ contents: from.getOverrideValue(undefined, identifier) || {}, keys: from.getKeysForOverrideIdentifier(identifier) }, { contents: to.getOverrideValue(undefined, identifier) || {}, keys: to.getKeysForOverrideIdentifier(identifier) });\n\t\t\t\toverrides.push([identifier, [...result.added, ...result.removed, ...result.updated]]);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn { added, removed, updated, overrides };\n}\n\nfunction compareConfigurationContents(to: { keys: string[]; contents: any } | undefined, from: { keys: string[]; contents: any } | undefined) {\n\tconst added = to\n\t\t? from ? to.keys.filter(key => from.keys.indexOf(key) === -1) : [...to.keys]\n\t\t: [];\n\tconst removed = from\n\t\t? to ? from.keys.filter(key => to.keys.indexOf(key) === -1) : [...from.keys]\n\t\t: [];\n\tconst updated: string[] = [];\n\n\tif (to && from) {\n\t\tfor (const key of from.keys) {\n\t\t\tif (to.keys.indexOf(key) !== -1) {\n\t\t\t\tconst value1 = getConfigurationValue(from.contents, key);\n\t\t\t\tconst value2 = getConfigurationValue(to.contents, key);\n\t\t\t\tif (!objects.equals(value1, value2)) {\n\t\t\t\t\tupdated.push(key);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn { added, removed, updated };\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ErrorNoTelemetry } from 'vs/base/common/errors';\nimport { Event } from 'vs/base/common/event';\nimport { URI } from 'vs/base/common/uri';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\n\nexport const IRemoteAuthorityResolverService = createDecorator<IRemoteAuthorityResolverService>('remoteAuthorityResolverService');\n\nexport interface ResolvedAuthority {\n\treadonly authority: string;\n\treadonly host: string;\n\treadonly port: number;\n\treadonly connectionToken: string | undefined;\n}\n\nexport interface ResolvedOptions {\n\treadonly extensionHostEnv?: { [key: string]: string | null };\n\treadonly isTrusted?: boolean;\n\treadonly authenticationSession?: { id: string; providerId: string };\n}\n\nexport interface TunnelDescription {\n\tremoteAddress: { port: number; host: string };\n\tlocalAddress: { port: number; host: string } | string;\n\tprivacy?: string;\n\tprotocol?: string;\n}\nexport interface TunnelPrivacy {\n\tthemeIcon: string;\n\tid: string;\n\tlabel: string;\n}\nexport interface TunnelInformation {\n\tenvironmentTunnels?: TunnelDescription[];\n\tfeatures?: {\n\t\televation: boolean;\n\t\tpublic?: boolean;\n\t\tprivacyOptions: TunnelPrivacy[];\n\t};\n}\n\nexport interface ResolverResult {\n\tauthority: ResolvedAuthority;\n\toptions?: ResolvedOptions;\n\ttunnelInformation?: TunnelInformation;\n}\n\nexport interface IRemoteConnectionData {\n\thost: string;\n\tport: number;\n\tconnectionToken: string | undefined;\n}\n\nexport enum RemoteAuthorityResolverErrorCode {\n\tUnknown = 'Unknown',\n\tNotAvailable = 'NotAvailable',\n\tTemporarilyNotAvailable = 'TemporarilyNotAvailable',\n\tNoResolverFound = 'NoResolverFound'\n}\n\nexport class RemoteAuthorityResolverError extends ErrorNoTelemetry {\n\n\tpublic static isTemporarilyNotAvailable(err: any): boolean {\n\t\treturn (err instanceof RemoteAuthorityResolverError) && err._code === RemoteAuthorityResolverErrorCode.TemporarilyNotAvailable;\n\t}\n\n\tpublic static isNoResolverFound(err: any): err is RemoteAuthorityResolverError {\n\t\treturn (err instanceof RemoteAuthorityResolverError) && err._code === RemoteAuthorityResolverErrorCode.NoResolverFound;\n\t}\n\n\tpublic static isHandled(err: any): boolean {\n\t\treturn (err instanceof RemoteAuthorityResolverError) && err.isHandled;\n\t}\n\n\tpublic readonly _message: string | undefined;\n\tpublic readonly _code: RemoteAuthorityResolverErrorCode;\n\tpublic readonly _detail: any;\n\n\tpublic isHandled: boolean;\n\n\tconstructor(message?: string, code: RemoteAuthorityResolverErrorCode = RemoteAuthorityResolverErrorCode.Unknown, detail?: any) {\n\t\tsuper(message);\n\n\t\tthis._message = message;\n\t\tthis._code = code;\n\t\tthis._detail = detail;\n\n\t\tthis.isHandled = (code === RemoteAuthorityResolverErrorCode.NotAvailable) && detail === true;\n\n\t\t// workaround when extending builtin objects and when compiling to ES5, see:\n\t\t// https://github.com/microsoft/TypeScript-wiki/blob/master/Breaking-Changes.md#extending-built-ins-like-error-array-and-map-may-no-longer-work\n\t\tif (typeof (<any>Object).setPrototypeOf === 'function') {\n\t\t\t(<any>Object).setPrototypeOf(this, RemoteAuthorityResolverError.prototype);\n\t\t}\n\t}\n}\n\nexport interface IRemoteAuthorityResolverService {\n\n\treadonly _serviceBrand: undefined;\n\n\treadonly onDidChangeConnectionData: Event<void>;\n\n\tresolveAuthority(authority: string): Promise<ResolverResult>;\n\tgetConnectionData(authority: string): IRemoteConnectionData | null;\n\t/**\n\t * Get the canonical URI for a `vscode-remote://` URI.\n\t *\n\t * **NOTE**: This can throw e.g. in cases where there is no resolver installed for the specific remote authority.\n\t *\n\t * @param uri The `vscode-remote://` URI\n\t */\n\tgetCanonicalURI(uri: URI): Promise<URI>;\n\n\t_clearResolvedAuthority(authority: string): void;\n\t_setResolvedAuthority(resolvedAuthority: ResolvedAuthority, resolvedOptions?: ResolvedOptions): void;\n\t_setResolvedAuthorityError(authority: string, err: any): void;\n\t_setAuthorityConnectionToken(authority: string, connectionToken: string): void;\n\t_setCanonicalURIProvider(provider: (uri: URI) => Promise<URI>): void;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Schemas } from 'vs/base/common/network';\nimport { URI } from 'vs/base/common/uri';\n\nexport function getRemoteAuthority(uri: URI): string | undefined {\n\treturn uri.scheme === Schemas.vscodeRemote ? uri.authority : undefined;\n}\n\nexport function getRemoteName(authority: string): string;\nexport function getRemoteName(authority: undefined): undefined;\nexport function getRemoteName(authority: string | undefined): string | undefined;\nexport function getRemoteName(authority: string | undefined): string | undefined {\n\tif (!authority) {\n\t\treturn undefined;\n\t}\n\tconst pos = authority.indexOf('+');\n\tif (pos < 0) {\n\t\t// e.g. localhost:8000\n\t\treturn authority;\n\t}\n\treturn authority.substr(0, pos);\n}\n\n/**\n * The root path to use when accessing the remote server. The path contains the quality and commit of the current build.\n * @param product\n * @returns\n */\nexport function getRemoteServerRootPath(product: { quality?: string; commit?: string }): string {\n\treturn `/${product.quality ?? 'oss'}-${product.commit ?? 'dev'}`;\n}\n\nexport function parseAuthorityWithPort(authority: string): { host: string; port: number } {\n\tconst { host, port } = parseAuthority(authority);\n\tif (typeof port === 'undefined') {\n\t\tthrow new Error(`Remote authority doesn't contain a port!`);\n\t}\n\treturn { host, port };\n}\n\nexport function parseAuthorityWithOptionalPort(authority: string, defaultPort: number): { host: string; port: number } {\n\tlet { host, port } = parseAuthority(authority);\n\tif (typeof port === 'undefined') {\n\t\tport = defaultPort;\n\t}\n\treturn { host, port };\n}\n\nfunction parseAuthority(authority: string): { host: string; port: number | undefined } {\n\t// check for ipv6 with port\n\tconst m1 = authority.match(/^(\\[[0-9a-z:]+\\]):(\\d+)$/);\n\tif (m1) {\n\t\treturn { host: m1[1], port: parseInt(m1[2], 10) };\n\t}\n\n\t// check for ipv6 without port\n\tconst m2 = authority.match(/^(\\[[0-9a-z:]+\\])$/);\n\tif (m2) {\n\t\treturn { host: m2[1], port: undefined };\n\t}\n\n\t// anything with a trailing port\n\tconst m3 = authority.match(/(.*):(\\d+)$/);\n\tif (m3) {\n\t\treturn { host: m3[1], port: parseInt(m3[2], 10) };\n\t}\n\n\t// doesn't contain a port\n\treturn { host: authority, port: undefined };\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport Severity from 'vs/base/common/severity';\nimport * as strings from 'vs/base/common/strings';\nimport { URI } from 'vs/base/common/uri';\nimport { ExtensionKind } from 'vs/platform/environment/common/environment';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { getRemoteName } from 'vs/platform/remote/common/remoteHosts';\n\nexport const MANIFEST_CACHE_FOLDER = 'CachedExtensions';\nexport const USER_MANIFEST_CACHE_FILE = 'user';\nexport const BUILTIN_MANIFEST_CACHE_FILE = 'builtin';\nexport const UNDEFINED_PUBLISHER = 'undefined_publisher';\n\nexport interface ICommand {\n\tcommand: string;\n\ttitle: string;\n\tcategory?: string;\n}\n\nexport interface IConfigurationProperty {\n\tdescription: string;\n\ttype: string | string[];\n\tdefault?: any;\n}\n\nexport interface IConfiguration {\n\tid?: string;\n\torder?: number;\n\ttitle?: string;\n\tproperties: { [key: string]: IConfigurationProperty };\n}\n\nexport interface IDebugger {\n\tlabel?: string;\n\ttype: string;\n\truntime?: string;\n}\n\nexport interface IGrammar {\n\tlanguage: string;\n}\n\nexport interface IJSONValidation {\n\tfileMatch: string | string[];\n\turl: string;\n}\n\nexport interface IKeyBinding {\n\tcommand: string;\n\tkey: string;\n\twhen?: string;\n\tmac?: string;\n\tlinux?: string;\n\twin?: string;\n}\n\nexport interface ILanguage {\n\tid: string;\n\textensions: string[];\n\taliases: string[];\n}\n\nexport interface IMenu {\n\tcommand: string;\n\talt?: string;\n\twhen?: string;\n\tgroup?: string;\n}\n\nexport interface ISnippet {\n\tlanguage: string;\n}\n\nexport interface ITheme {\n\tlabel: string;\n}\n\nexport interface IViewContainer {\n\tid: string;\n\ttitle: string;\n}\n\nexport interface IView {\n\tid: string;\n\tname: string;\n}\n\nexport interface IColor {\n\tid: string;\n\tdescription: string;\n\tdefaults: { light: string; dark: string; highContrast: string };\n}\n\nexport interface IWebviewEditor {\n\treadonly viewType: string;\n\treadonly priority: string;\n\treadonly selector: readonly {\n\t\treadonly filenamePattern?: string;\n\t}[];\n}\n\nexport interface ICodeActionContributionAction {\n\treadonly kind: string;\n\treadonly title: string;\n\treadonly description?: string;\n}\n\nexport interface ICodeActionContribution {\n\treadonly languages: readonly string[];\n\treadonly actions: readonly ICodeActionContributionAction[];\n}\n\nexport interface IAuthenticationContribution {\n\treadonly id: string;\n\treadonly label: string;\n}\n\nexport interface IWalkthroughStep {\n\treadonly id: string;\n\treadonly title: string;\n\treadonly description: string | undefined;\n\treadonly media:\n\t| { image: string | { dark: string; light: string; hc: string }; altText: string; markdown?: never; svg?: never }\n\t| { markdown: string; image?: never; svg?: never }\n\t| { svg: string; altText: string; markdown?: never; image?: never };\n\treadonly completionEvents?: string[];\n\t/** @deprecated use `completionEvents: 'onCommand:...'` */\n\treadonly doneOn?: { command: string };\n\treadonly when?: string;\n}\n\nexport interface IWalkthrough {\n\treadonly id: string;\n\treadonly title: string;\n\treadonly description: string;\n\treadonly steps: IWalkthroughStep[];\n\treadonly featuredFor: string[] | undefined;\n\treadonly when?: string;\n}\n\nexport interface IStartEntry {\n\treadonly title: string;\n\treadonly description: string;\n\treadonly command: string;\n\treadonly when?: string;\n\treadonly category: 'file' | 'folder' | 'notebook';\n}\n\nexport interface INotebookEntry {\n\treadonly type: string;\n\treadonly displayName: string;\n}\n\nexport interface INotebookRendererContribution {\n\treadonly id: string;\n\treadonly displayName: string;\n\treadonly mimeTypes: string[];\n}\n\nexport interface ITranslation {\n\tid: string;\n\tpath: string;\n}\n\nexport interface ILocalizationContribution {\n\tlanguageId: string;\n\tlanguageName?: string;\n\tlocalizedLanguageName?: string;\n\ttranslations: ITranslation[];\n\tminimalTranslations?: { [key: string]: string };\n}\n\nexport interface IExtensionContributions {\n\tcommands?: ICommand[];\n\tconfiguration?: IConfiguration | IConfiguration[];\n\tdebuggers?: IDebugger[];\n\tgrammars?: IGrammar[];\n\tjsonValidation?: IJSONValidation[];\n\tkeybindings?: IKeyBinding[];\n\tlanguages?: ILanguage[];\n\tmenus?: { [context: string]: IMenu[] };\n\tsnippets?: ISnippet[];\n\tthemes?: ITheme[];\n\ticonThemes?: ITheme[];\n\tproductIconThemes?: ITheme[];\n\tviewsContainers?: { [location: string]: IViewContainer[] };\n\tviews?: { [location: string]: IView[] };\n\tcolors?: IColor[];\n\tlocalizations?: ILocalizationContribution[];\n\treadonly customEditors?: readonly IWebviewEditor[];\n\treadonly codeActions?: readonly ICodeActionContribution[];\n\tauthentication?: IAuthenticationContribution[];\n\twalkthroughs?: IWalkthrough[];\n\tstartEntries?: IStartEntry[];\n\treadonly notebooks?: INotebookEntry[];\n\treadonly notebookRenderer?: INotebookRendererContribution[];\n}\n\nexport interface IExtensionCapabilities {\n\treadonly virtualWorkspaces?: ExtensionVirtualWorkspaceSupport;\n\treadonly untrustedWorkspaces?: ExtensionUntrustedWorkspaceSupport;\n}\n\n\nexport const ALL_EXTENSION_KINDS: readonly ExtensionKind[] = ['ui', 'workspace', 'web'];\n\nexport type LimitedWorkspaceSupportType = 'limited';\nexport type ExtensionUntrustedWorkspaceSupportType = boolean | LimitedWorkspaceSupportType;\nexport type ExtensionUntrustedWorkspaceSupport = { supported: true } | { supported: false; description: string } | { supported: LimitedWorkspaceSupportType; description: string; restrictedConfigurations?: string[] };\n\nexport type ExtensionVirtualWorkspaceSupportType = boolean | LimitedWorkspaceSupportType;\nexport type ExtensionVirtualWorkspaceSupport = boolean | { supported: true } | { supported: false | LimitedWorkspaceSupportType; description: string };\n\nexport function getWorkspaceSupportTypeMessage(supportType: ExtensionUntrustedWorkspaceSupport | ExtensionVirtualWorkspaceSupport | undefined): string | undefined {\n\tif (typeof supportType === 'object' && supportType !== null) {\n\t\tif (supportType.supported !== true) {\n\t\t\treturn supportType.description;\n\t\t}\n\t}\n\treturn undefined;\n}\n\n\nexport function isIExtensionIdentifier(thing: any): thing is IExtensionIdentifier {\n\treturn thing\n\t\t&& typeof thing === 'object'\n\t\t&& typeof thing.id === 'string'\n\t\t&& (!thing.uuid || typeof thing.uuid === 'string');\n}\n\nexport interface IExtensionIdentifier {\n\tid: string;\n\tuuid?: string;\n}\n\nexport const EXTENSION_CATEGORIES = [\n\t'Azure',\n\t'Data Science',\n\t'Debuggers',\n\t'Extension Packs',\n\t'Education',\n\t'Formatters',\n\t'Keymaps',\n\t'Language Packs',\n\t'Linters',\n\t'Machine Learning',\n\t'Notebooks',\n\t'Programming Languages',\n\t'SCM Providers',\n\t'Snippets',\n\t'Testing',\n\t'Themes',\n\t'Visualization',\n\t'Other',\n];\n\nexport interface IRelaxedExtensionManifest {\n\tname: string;\n\tdisplayName?: string;\n\tpublisher: string;\n\tversion: string;\n\tengines: { readonly vscode: string };\n\tdescription?: string;\n\tmain?: string;\n\tbrowser?: string;\n\ticon?: string;\n\tcategories?: string[];\n\tkeywords?: string[];\n\tactivationEvents?: string[];\n\textensionDependencies?: string[];\n\textensionPack?: string[];\n\textensionKind?: ExtensionKind | ExtensionKind[];\n\tcontributes?: IExtensionContributions;\n\trepository?: { url: string };\n\tbugs?: { url: string };\n\tenabledApiProposals?: readonly string[];\n\tapi?: string;\n\tscripts?: { [key: string]: string };\n\tcapabilities?: IExtensionCapabilities;\n}\n\nexport type IExtensionManifest = Readonly<IRelaxedExtensionManifest>;\n\nexport const enum ExtensionType {\n\tSystem,\n\tUser\n}\n\nexport const enum TargetPlatform {\n\tWIN32_X64 = 'win32-x64',\n\tWIN32_IA32 = 'win32-ia32',\n\tWIN32_ARM64 = 'win32-arm64',\n\n\tLINUX_X64 = 'linux-x64',\n\tLINUX_ARM64 = 'linux-arm64',\n\tLINUX_ARMHF = 'linux-armhf',\n\n\tALPINE_X64 = 'alpine-x64',\n\tALPINE_ARM64 = 'alpine-arm64',\n\n\tDARWIN_X64 = 'darwin-x64',\n\tDARWIN_ARM64 = 'darwin-arm64',\n\n\tWEB = 'web',\n\n\tUNIVERSAL = 'universal',\n\tUNKNOWN = 'unknown',\n\tUNDEFINED = 'undefined',\n}\n\nexport interface IExtension {\n\treadonly type: ExtensionType;\n\treadonly isBuiltin: boolean;\n\treadonly identifier: IExtensionIdentifier;\n\treadonly manifest: IExtensionManifest;\n\treadonly location: URI;\n\treadonly targetPlatform: TargetPlatform;\n\treadonly readmeUrl?: URI;\n\treadonly changelogUrl?: URI;\n\treadonly isValid: boolean;\n\treadonly validations: readonly [Severity, string][];\n}\n\n/**\n * **!Do not construct directly!**\n *\n * **!Only static methods because it gets serialized!**\n *\n * This represents the \"canonical\" version for an extension identifier. Extension ids\n * have to be case-insensitive (due to the marketplace), but we must ensure case\n * preservation because the extension API is already public at this time.\n *\n * For example, given an extension with the publisher `\"Hello\"` and the name `\"World\"`,\n * its canonical extension identifier is `\"Hello.World\"`. This extension could be\n * referenced in some other extension's dependencies using the string `\"hello.world\"`.\n *\n * To make matters more complicated, an extension can optionally have an UUID. When two\n * extensions have the same UUID, they are considered equal even if their identifier is different.\n */\nexport class ExtensionIdentifier {\n\tpublic readonly value: string;\n\tprivate readonly _lower: string;\n\n\tconstructor(value: string) {\n\t\tthis.value = value;\n\t\tthis._lower = value.toLowerCase();\n\t}\n\n\tpublic static equals(a: ExtensionIdentifier | string | null | undefined, b: ExtensionIdentifier | string | null | undefined) {\n\t\tif (typeof a === 'undefined' || a === null) {\n\t\t\treturn (typeof b === 'undefined' || b === null);\n\t\t}\n\t\tif (typeof b === 'undefined' || b === null) {\n\t\t\treturn false;\n\t\t}\n\t\tif (typeof a === 'string' || typeof b === 'string') {\n\t\t\t// At least one of the arguments is an extension id in string form,\n\t\t\t// so we have to use the string comparison which ignores case.\n\t\t\tconst aValue = (typeof a === 'string' ? a : a.value);\n\t\t\tconst bValue = (typeof b === 'string' ? b : b.value);\n\t\t\treturn strings.equalsIgnoreCase(aValue, bValue);\n\t\t}\n\n\t\t// Now we know both arguments are ExtensionIdentifier\n\t\treturn (a._lower === b._lower);\n\t}\n\n\t/**\n\t * Gives the value by which to index (for equality).\n\t */\n\tpublic static toKey(id: ExtensionIdentifier | string): string {\n\t\tif (typeof id === 'string') {\n\t\t\treturn id.toLowerCase();\n\t\t}\n\t\treturn id._lower;\n\t}\n}\n\nexport interface IRelaxedExtensionDescription extends IRelaxedExtensionManifest {\n\tid?: string;\n\tidentifier: ExtensionIdentifier;\n\tuuid?: string;\n\ttargetPlatform: TargetPlatform;\n\tisBuiltin: boolean;\n\tisUserBuiltin: boolean;\n\tisUnderDevelopment: boolean;\n\textensionLocation: URI;\n}\n\nexport type IExtensionDescription = Readonly<IRelaxedExtensionDescription>;\n\nexport function isApplicationScopedExtension(manifest: IExtensionManifest): boolean {\n\treturn isLanguagePackExtension(manifest);\n}\n\nexport function isLanguagePackExtension(manifest: IExtensionManifest): boolean {\n\treturn manifest.contributes && manifest.contributes.localizations ? manifest.contributes.localizations.length > 0 : false;\n}\n\nexport function isAuthenticationProviderExtension(manifest: IExtensionManifest): boolean {\n\treturn manifest.contributes && manifest.contributes.authentication ? manifest.contributes.authentication.length > 0 : false;\n}\n\nexport function isResolverExtension(manifest: IExtensionManifest, remoteAuthority: string | undefined): boolean {\n\tif (remoteAuthority) {\n\t\tconst activationEvent = `onResolveRemoteAuthority:${getRemoteName(remoteAuthority)}`;\n\t\treturn manifest.activationEvents?.indexOf(activationEvent) !== -1;\n\t}\n\treturn false;\n}\n\nexport const IBuiltinExtensionsScannerService = createDecorator<IBuiltinExtensionsScannerService>('IBuiltinExtensionsScannerService');\nexport interface IBuiltinExtensionsScannerService {\n\treadonly _serviceBrand: undefined;\n\tscanBuiltinExtensions(): Promise<IExtension[]>;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { compareIgnoreCase } from 'vs/base/common/strings';\nimport { IExtensionIdentifier, IGalleryExtension, ILocalExtension, getTargetPlatform } from 'vs/platform/extensionManagement/common/extensionManagement';\nimport { ExtensionIdentifier, IExtension, TargetPlatform } from 'vs/platform/extensions/common/extensions';\nimport { IFileService } from 'vs/platform/files/common/files';\nimport { isLinux, platform } from 'vs/base/common/platform';\nimport { URI } from 'vs/base/common/uri';\nimport { getErrorMessage } from 'vs/base/common/errors';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { arch } from 'vs/base/common/process';\n\nexport function areSameExtensions(a: IExtensionIdentifier, b: IExtensionIdentifier): boolean {\n\tif (a.uuid && b.uuid) {\n\t\treturn a.uuid === b.uuid;\n\t}\n\tif (a.id === b.id) {\n\t\treturn true;\n\t}\n\treturn compareIgnoreCase(a.id, b.id) === 0;\n}\n\nconst ExtensionKeyRegex = /^([^.]+\\..+)-(\\d+\\.\\d+\\.\\d+)(-(.+))?$/;\n\nexport class ExtensionKey {\n\n\tstatic create(extension: IExtension | IGalleryExtension): ExtensionKey {\n\t\tconst version = (extension as IExtension).manifest ? (extension as IExtension).manifest.version : (extension as IGalleryExtension).version;\n\t\tconst targetPlatform = (extension as IExtension).manifest ? (extension as IExtension).targetPlatform : (extension as IGalleryExtension).properties.targetPlatform;\n\t\treturn new ExtensionKey(extension.identifier, version, targetPlatform);\n\t}\n\n\tstatic parse(key: string): ExtensionKey | null {\n\t\tconst matches = ExtensionKeyRegex.exec(key);\n\t\treturn matches && matches[1] && matches[2] ? new ExtensionKey({ id: matches[1] }, matches[2], matches[4] as TargetPlatform || undefined) : null;\n\t}\n\n\treadonly id: string;\n\n\tconstructor(\n\t\tidentifier: IExtensionIdentifier,\n\t\treadonly version: string,\n\t\treadonly targetPlatform: TargetPlatform = TargetPlatform.UNDEFINED,\n\t) {\n\t\tthis.id = identifier.id;\n\t}\n\n\ttoString(): string {\n\t\treturn `${this.id}-${this.version}${this.targetPlatform !== TargetPlatform.UNDEFINED ? `-${this.targetPlatform}` : ''}`;\n\t}\n\n\tequals(o: any): boolean {\n\t\tif (!(o instanceof ExtensionKey)) {\n\t\t\treturn false;\n\t\t}\n\t\treturn areSameExtensions(this, o) && this.version === o.version && this.targetPlatform === o.targetPlatform;\n\t}\n}\n\nconst EXTENSION_IDENTIFIER_WITH_VERSION_REGEX = /^([^.]+\\..+)@((prerelease)|(\\d+\\.\\d+\\.\\d+(-.*)?))$/;\nexport function getIdAndVersion(id: string): [string, string | undefined] {\n\tconst matches = EXTENSION_IDENTIFIER_WITH_VERSION_REGEX.exec(id);\n\tif (matches && matches[1]) {\n\t\treturn [adoptToGalleryExtensionId(matches[1]), matches[2]];\n\t}\n\treturn [adoptToGalleryExtensionId(id), undefined];\n}\n\nexport function getExtensionId(publisher: string, name: string): string {\n\treturn `${publisher}.${name}`;\n}\n\nexport function adoptToGalleryExtensionId(id: string): string {\n\treturn id.toLocaleLowerCase();\n}\n\nexport function getGalleryExtensionId(publisher: string, name: string): string {\n\treturn adoptToGalleryExtensionId(getExtensionId(publisher, name));\n}\n\nexport function groupByExtension<T>(extensions: T[], getExtensionIdentifier: (t: T) => IExtensionIdentifier): T[][] {\n\tconst byExtension: T[][] = [];\n\tconst findGroup = (extension: T) => {\n\t\tfor (const group of byExtension) {\n\t\t\tif (group.some(e => areSameExtensions(getExtensionIdentifier(e), getExtensionIdentifier(extension)))) {\n\t\t\t\treturn group;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t};\n\tfor (const extension of extensions) {\n\t\tconst group = findGroup(extension);\n\t\tif (group) {\n\t\t\tgroup.push(extension);\n\t\t} else {\n\t\t\tbyExtension.push([extension]);\n\t\t}\n\t}\n\treturn byExtension;\n}\n\nexport function getLocalExtensionTelemetryData(extension: ILocalExtension): any {\n\treturn {\n\t\tid: extension.identifier.id,\n\t\tname: extension.manifest.name,\n\t\tgalleryId: null,\n\t\tpublisherId: extension.publisherId,\n\t\tpublisherName: extension.manifest.publisher,\n\t\tpublisherDisplayName: extension.publisherDisplayName,\n\t\tdependencies: extension.manifest.extensionDependencies && extension.manifest.extensionDependencies.length > 0\n\t};\n}\n\n\n/* __GDPR__FRAGMENT__\n\t\"GalleryExtensionTelemetryData\" : {\n\t\t\"id\" : { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\"name\": { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\"galleryId\": { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\"publisherId\": { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\"publisherName\": { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\"publisherDisplayName\": { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\"isPreReleaseVersion\": { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\"dependencies\": { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\"${include}\": [\n\t\t\t\"${GalleryExtensionTelemetryData2}\"\n\t\t]\n\t}\n*/\nexport function getGalleryExtensionTelemetryData(extension: IGalleryExtension): any {\n\treturn {\n\t\tid: extension.identifier.id,\n\t\tname: extension.name,\n\t\tgalleryId: extension.identifier.uuid,\n\t\tpublisherId: extension.publisherId,\n\t\tpublisherName: extension.publisher,\n\t\tpublisherDisplayName: extension.publisherDisplayName,\n\t\tisPreReleaseVersion: extension.properties.isPreReleaseVersion,\n\t\tdependencies: !!(extension.properties.dependencies && extension.properties.dependencies.length > 0),\n\t\t...extension.telemetryData\n\t};\n}\n\nexport const BetterMergeId = new ExtensionIdentifier('pprice.better-merge');\n\nexport function getExtensionDependencies(installedExtensions: ReadonlyArray<IExtension>, extension: IExtension): IExtension[] {\n\tconst dependencies: IExtension[] = [];\n\tconst extensions = extension.manifest.extensionDependencies?.slice(0) ?? [];\n\n\twhile (extensions.length) {\n\t\tconst id = extensions.shift();\n\n\t\tif (id && dependencies.every(e => !areSameExtensions(e.identifier, { id }))) {\n\t\t\tconst ext = installedExtensions.filter(e => areSameExtensions(e.identifier, { id }));\n\t\t\tif (ext.length === 1) {\n\t\t\t\tdependencies.push(ext[0]);\n\t\t\t\textensions.push(...ext[0].manifest.extensionDependencies?.slice(0) ?? []);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn dependencies;\n}\n\nexport async function isAlpineLinux(fileService: IFileService, logService: ILogService): Promise<boolean> {\n\tif (!isLinux) {\n\t\treturn false;\n\t}\n\tlet content: string | undefined;\n\ttry {\n\t\tconst fileContent = await fileService.readFile(URI.file('/etc/os-release'));\n\t\tcontent = fileContent.value.toString();\n\t} catch (error) {\n\t\ttry {\n\t\t\tconst fileContent = await fileService.readFile(URI.file('/usr/lib/os-release'));\n\t\t\tcontent = fileContent.value.toString();\n\t\t} catch (error) {\n\t\t\t/* Ignore */\n\t\t\tlogService.debug(`Error while getting the os-release file.`, getErrorMessage(error));\n\t\t}\n\t}\n\treturn !!content && (content.match(/^ID=([^\\u001b\\r\\n]*)/m) || [])[1] === 'alpine';\n}\n\nexport async function computeTargetPlatform(fileService: IFileService, logService: ILogService): Promise<TargetPlatform> {\n\tconst alpineLinux = await isAlpineLinux(fileService, logService);\n\tconst targetPlatform = getTargetPlatform(alpineLinux ? 'alpine' : platform, arch);\n\tlogService.debug('ComputeTargetPlatform:', targetPlatform);\n\treturn targetPlatform;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Event } from 'vs/base/common/event';\nimport { IDisposable } from 'vs/base/common/lifecycle';\nimport { IProcessDataEvent } from 'vs/platform/terminal/common/terminal';\n\ninterface TerminalDataBuffer extends IDisposable {\n\tdata: string[];\n\ttimeoutId: any;\n}\n\nexport class TerminalDataBufferer implements IDisposable {\n\tprivate readonly _terminalBufferMap = new Map<number, TerminalDataBuffer>();\n\n\tconstructor(private readonly _callback: (id: number, data: string) => void) {\n\t}\n\n\tdispose() {\n\t\tfor (const buffer of this._terminalBufferMap.values()) {\n\t\t\tbuffer.dispose();\n\t\t}\n\t}\n\n\tstartBuffering(id: number, event: Event<string | IProcessDataEvent>, throttleBy: number = 5): IDisposable {\n\n\t\tconst disposable = event((e: string | IProcessDataEvent) => {\n\t\t\tconst data = (typeof e === 'string' ? e : e.data);\n\t\t\tlet buffer = this._terminalBufferMap.get(id);\n\t\t\tif (buffer) {\n\t\t\t\tbuffer.data.push(data);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst timeoutId = setTimeout(() => this.flushBuffer(id), throttleBy);\n\t\t\tbuffer = {\n\t\t\t\tdata: [data],\n\t\t\t\ttimeoutId: timeoutId,\n\t\t\t\tdispose: () => {\n\t\t\t\t\tclearTimeout(timeoutId);\n\t\t\t\t\tthis.flushBuffer(id);\n\t\t\t\t\tdisposable.dispose();\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._terminalBufferMap.set(id, buffer);\n\t\t});\n\t\treturn disposable;\n\t}\n\n\tstopBuffering(id: number) {\n\t\tconst buffer = this._terminalBufferMap.get(id);\n\t\tif (buffer) {\n\t\t\tbuffer.dispose();\n\t\t}\n\t}\n\n\tflushBuffer(id: number): void {\n\t\tconst buffer = this._terminalBufferMap.get(id);\n\t\tif (buffer) {\n\t\t\tthis._terminalBufferMap.delete(id);\n\t\t\tthis._callback(id, buffer.data.join(''));\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n/**\n * Color scheme used by the OS and by color themes.\n */\nexport enum ColorScheme {\n\tDARK = 'dark',\n\tLIGHT = 'light',\n\tHIGH_CONTRAST_DARK = 'hcDark',\n\tHIGH_CONTRAST_LIGHT = 'hcLight'\n}\n\nexport function isHighContrast(scheme: ColorScheme): boolean {\n\treturn scheme === ColorScheme.HIGH_CONTRAST_DARK || scheme === ColorScheme.HIGH_CONTRAST_LIGHT;\n}\n\nexport function isDark(scheme: ColorScheme): boolean {\n\treturn scheme === ColorScheme.DARK || scheme === ColorScheme.HIGH_CONTRAST_DARK;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Codicon, CSSIcon } from 'vs/base/common/codicons';\nimport { Color } from 'vs/base/common/color';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { Disposable, IDisposable, toDisposable } from 'vs/base/common/lifecycle';\nimport { IEnvironmentService } from 'vs/platform/environment/common/environment';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport * as platform from 'vs/platform/registry/common/platform';\nimport { ColorIdentifier } from 'vs/platform/theme/common/colorRegistry';\nimport { IconContribution, IconDefinition } from 'vs/platform/theme/common/iconRegistry';\nimport { ColorScheme } from 'vs/platform/theme/common/theme';\n\nexport const IThemeService = createDecorator<IThemeService>('themeService');\n\nexport interface ThemeColor {\n\tid: string;\n}\n\nexport namespace ThemeColor {\n\texport function isThemeColor(obj: any): obj is ThemeColor {\n\t\treturn obj && typeof obj === 'object' && typeof (<ThemeColor>obj).id === 'string';\n\t}\n}\n\nexport function themeColorFromId(id: ColorIdentifier) {\n\treturn { id };\n}\n\n// theme icon\nexport interface ThemeIcon {\n\treadonly id: string;\n\treadonly color?: ThemeColor;\n}\n\nexport namespace ThemeIcon {\n\texport function isThemeIcon(obj: any): obj is ThemeIcon {\n\t\treturn obj && typeof obj === 'object' && typeof (<ThemeIcon>obj).id === 'string' && (typeof (<ThemeIcon>obj).color === 'undefined' || ThemeColor.isThemeColor((<ThemeIcon>obj).color));\n\t}\n\n\tconst _regexFromString = new RegExp(`^\\\\$\\\\((${CSSIcon.iconNameExpression}(?:${CSSIcon.iconModifierExpression})?)\\\\)$`);\n\n\texport function fromString(str: string): ThemeIcon | undefined {\n\t\tconst match = _regexFromString.exec(str);\n\t\tif (!match) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst [, name] = match;\n\t\treturn { id: name };\n\t}\n\n\texport function fromId(id: string): ThemeIcon {\n\t\treturn { id };\n\t}\n\n\texport function modify(icon: ThemeIcon, modifier: 'disabled' | 'spin' | undefined): ThemeIcon {\n\t\tlet id = icon.id;\n\t\tconst tildeIndex = id.lastIndexOf('~');\n\t\tif (tildeIndex !== -1) {\n\t\t\tid = id.substring(0, tildeIndex);\n\t\t}\n\t\tif (modifier) {\n\t\t\tid = `${id}~${modifier}`;\n\t\t}\n\t\treturn { id };\n\t}\n\n\texport function getModifier(icon: ThemeIcon): string | undefined {\n\t\tconst tildeIndex = icon.id.lastIndexOf('~');\n\t\tif (tildeIndex !== -1) {\n\t\t\treturn icon.id.substring(tildeIndex + 1);\n\t\t}\n\t\treturn undefined;\n\t}\n\n\texport function isEqual(ti1: ThemeIcon, ti2: ThemeIcon): boolean {\n\t\treturn ti1.id === ti2.id && ti1.color?.id === ti2.color?.id;\n\t}\n\n\texport function asThemeIcon(codicon: Codicon, color?: string): ThemeIcon {\n\t\treturn { id: codicon.id, color: color ? themeColorFromId(color) : undefined };\n\t}\n\n\texport const asClassNameArray: (icon: ThemeIcon) => string[] = CSSIcon.asClassNameArray;\n\texport const asClassName: (icon: ThemeIcon) => string = CSSIcon.asClassName;\n\texport const asCSSSelector: (icon: ThemeIcon) => string = CSSIcon.asCSSSelector;\n}\n\nexport const FileThemeIcon = Codicon.file;\nexport const FolderThemeIcon = Codicon.folder;\n\nexport function getThemeTypeSelector(type: ColorScheme): string {\n\tswitch (type) {\n\t\tcase ColorScheme.DARK: return 'vs-dark';\n\t\tcase ColorScheme.HIGH_CONTRAST_DARK: return 'hc-black';\n\t\tcase ColorScheme.HIGH_CONTRAST_LIGHT: return 'hc-light';\n\t\tdefault: return 'vs';\n\t}\n}\n\nexport interface ITokenStyle {\n\treadonly foreground: number | undefined;\n\treadonly bold: boolean | undefined;\n\treadonly underline: boolean | undefined;\n\treadonly strikethrough: boolean | undefined;\n\treadonly italic: boolean | undefined;\n}\n\nexport interface IColorTheme {\n\n\treadonly type: ColorScheme;\n\n\treadonly label: string;\n\n\t/**\n\t * Resolves the color of the given color identifier. If the theme does not\n\t * specify the color, the default color is returned unless <code>useDefault</code> is set to false.\n\t * @param color the id of the color\n\t * @param useDefault specifies if the default color should be used. If not set, the default is used.\n\t */\n\tgetColor(color: ColorIdentifier, useDefault?: boolean): Color | undefined;\n\n\t/**\n\t * Returns whether the theme defines a value for the color. If not, that means the\n\t * default color will be used.\n\t */\n\tdefines(color: ColorIdentifier): boolean;\n\n\t/**\n\t * Returns the token style for a given classification. The result uses the <code>MetadataConsts</code> format\n\t */\n\tgetTokenStyleMetadata(type: string, modifiers: string[], modelLanguage: string): ITokenStyle | undefined;\n\n\t/**\n\t * List of all colors used with tokens. <code>getTokenStyleMetadata</code> references the colors by index into this list.\n\t */\n\treadonly tokenColorMap: string[];\n\n\t/**\n\t * Defines whether semantic highlighting should be enabled for the theme.\n\t */\n\treadonly semanticHighlighting: boolean;\n}\n\nexport interface IFileIconTheme {\n\treadonly hasFileIcons: boolean;\n\treadonly hasFolderIcons: boolean;\n\treadonly hidesExplorerArrows: boolean;\n}\n\nexport interface IProductIconTheme {\n\t/**\n\t * Resolves the definition for the given icon as defined by the theme.\n\t *\n\t * @param iconContribution The icon\n\t */\n\tgetIcon(iconContribution: IconContribution): IconDefinition | undefined;\n}\n\n\nexport interface ICssStyleCollector {\n\taddRule(rule: string): void;\n}\n\nexport interface IThemingParticipant {\n\t(theme: IColorTheme, collector: ICssStyleCollector, environment: IEnvironmentService): void;\n}\n\nexport interface IThemeService {\n\treadonly _serviceBrand: undefined;\n\n\tgetColorTheme(): IColorTheme;\n\n\treadonly onDidColorThemeChange: Event<IColorTheme>;\n\n\tgetFileIconTheme(): IFileIconTheme;\n\n\treadonly onDidFileIconThemeChange: Event<IFileIconTheme>;\n\n\tgetProductIconTheme(): IProductIconTheme;\n\n\treadonly onDidProductIconThemeChange: Event<IProductIconTheme>;\n\n}\n\n// static theming participant\nexport const Extensions = {\n\tThemingContribution: 'base.contributions.theming'\n};\n\nexport interface IThemingRegistry {\n\n\t/**\n\t * Register a theming participant that is invoked on every theme change.\n\t */\n\tonColorThemeChange(participant: IThemingParticipant): IDisposable;\n\n\tgetThemingParticipants(): IThemingParticipant[];\n\n\treadonly onThemingParticipantAdded: Event<IThemingParticipant>;\n}\n\nclass ThemingRegistry implements IThemingRegistry {\n\tprivate themingParticipants: IThemingParticipant[] = [];\n\tprivate readonly onThemingParticipantAddedEmitter: Emitter<IThemingParticipant>;\n\n\tconstructor() {\n\t\tthis.themingParticipants = [];\n\t\tthis.onThemingParticipantAddedEmitter = new Emitter<IThemingParticipant>();\n\t}\n\n\tpublic onColorThemeChange(participant: IThemingParticipant): IDisposable {\n\t\tthis.themingParticipants.push(participant);\n\t\tthis.onThemingParticipantAddedEmitter.fire(participant);\n\t\treturn toDisposable(() => {\n\t\t\tconst idx = this.themingParticipants.indexOf(participant);\n\t\t\tthis.themingParticipants.splice(idx, 1);\n\t\t});\n\t}\n\n\tpublic get onThemingParticipantAdded(): Event<IThemingParticipant> {\n\t\treturn this.onThemingParticipantAddedEmitter.event;\n\t}\n\n\tpublic getThemingParticipants(): IThemingParticipant[] {\n\t\treturn this.themingParticipants;\n\t}\n}\n\nconst themingRegistry = new ThemingRegistry();\nplatform.Registry.add(Extensions.ThemingContribution, themingRegistry);\n\nexport function registerThemingParticipant(participant: IThemingParticipant): IDisposable {\n\treturn themingRegistry.onColorThemeChange(participant);\n}\n\n/**\n * Utility base class for all themable components.\n */\nexport class Themable extends Disposable {\n\tprotected theme: IColorTheme;\n\n\tconstructor(\n\t\tprotected themeService: IThemeService\n\t) {\n\t\tsuper();\n\n\t\tthis.theme = themeService.getColorTheme();\n\n\t\t// Hook up to theme changes\n\t\tthis._register(this.themeService.onDidColorThemeChange(theme => this.onThemeChange(theme)));\n\t}\n\n\tprotected onThemeChange(theme: IColorTheme): void {\n\t\tthis.theme = theme;\n\n\t\tthis.updateStyles();\n\t}\n\n\tprotected updateStyles(): void {\n\t\t// Subclasses to override\n\t}\n\n\tprotected getColor(id: string, modify?: (color: Color, theme: IColorTheme) => Color): string | null {\n\t\tlet color = this.theme.getColor(id);\n\n\t\tif (color && modify) {\n\t\t\tcolor = modify(color, this.theme);\n\t\t}\n\n\t\treturn color ? color.toString() : null;\n\t}\n}\n\nexport interface IPartsSplash {\n\tbaseTheme: string;\n\tcolorInfo: {\n\t\tbackground: string;\n\t\tforeground: string | undefined;\n\t\teditorBackground: string | undefined;\n\t\ttitleBarBackground: string | undefined;\n\t\tactivityBarBackground: string | undefined;\n\t\tsideBarBackground: string | undefined;\n\t\tstatusBarBackground: string | undefined;\n\t\tstatusBarNoFolderBackground: string | undefined;\n\t\twindowBorder: string | undefined;\n\t};\n\tlayoutInfo: {\n\t\tsideBarSide: string;\n\t\teditorPartMinWidth: number;\n\t\ttitleBarHeight: number;\n\t\tactivityBarWidth: number;\n\t\tsideBarWidth: number;\n\t\tstatusBarHeight: number;\n\t\twindowBorder: boolean;\n\t\twindowBorderRadius: string | undefined;\n\t} | undefined;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { IDisposable } from 'vs/base/common/lifecycle';\nimport { isWindows, OperatingSystem } from 'vs/base/common/platform';\nimport { URI } from 'vs/base/common/uri';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { IAddressProvider } from 'vs/platform/remote/common/remoteAgentConnection';\nimport { TunnelPrivacy } from 'vs/platform/remote/common/remoteAuthorityResolver';\n\nexport const ITunnelService = createDecorator<ITunnelService>('tunnelService');\nexport const ISharedTunnelsService = createDecorator<ISharedTunnelsService>('sharedTunnelsService');\n\nexport interface RemoteTunnel {\n\treadonly tunnelRemotePort: number;\n\treadonly tunnelRemoteHost: string;\n\treadonly tunnelLocalPort?: number;\n\treadonly localAddress: string;\n\treadonly privacy: string;\n\treadonly protocol?: string;\n\tdispose(silent?: boolean): Promise<void>;\n}\n\nexport interface TunnelOptions {\n\tremoteAddress: { port: number; host: string };\n\tlocalAddressPort?: number;\n\tlabel?: string;\n\tpublic?: boolean;\n\tprivacy?: string;\n\tprotocol?: string;\n}\n\nexport enum TunnelProtocol {\n\tHttp = 'http',\n\tHttps = 'https'\n}\n\nexport enum TunnelPrivacyId {\n\tConstantPrivate = 'constantPrivate', // private, and changing is unsupported\n\tPrivate = 'private',\n\tPublic = 'public'\n}\n\nexport interface TunnelCreationOptions {\n\televationRequired?: boolean;\n}\n\nexport interface TunnelProviderFeatures {\n\televation: boolean;\n\t/**\n\t * @deprecated\n\t */\n\tpublic?: boolean;\n\tprivacyOptions: TunnelPrivacy[];\n}\n\nexport interface ITunnelProvider {\n\tforwardPort(tunnelOptions: TunnelOptions, tunnelCreationOptions: TunnelCreationOptions): Promise<RemoteTunnel | undefined> | undefined;\n}\n\nexport enum ProvidedOnAutoForward {\n\tNotify = 1,\n\tOpenBrowser = 2,\n\tOpenPreview = 3,\n\tSilent = 4,\n\tIgnore = 5,\n\tOpenBrowserOnce = 6\n}\n\nexport interface ProvidedPortAttributes {\n\tport: number;\n\tautoForwardAction: ProvidedOnAutoForward;\n}\n\nexport interface PortAttributesProvider {\n\tprovidePortAttributes(ports: number[], pid: number | undefined, commandLine: string | undefined, token: CancellationToken): Promise<ProvidedPortAttributes[]>;\n}\n\nexport interface ITunnel {\n\tremoteAddress: { port: number; host: string };\n\n\t/**\n\t * The complete local address(ex. localhost:1234)\n\t */\n\tlocalAddress: string;\n\n\t/**\n\t * @deprecated Use privacy instead\n\t */\n\tpublic?: boolean;\n\n\tprivacy?: string;\n\n\tprotocol?: string;\n\n\t/**\n\t * Implementers of Tunnel should fire onDidDispose when dispose is called.\n\t */\n\tonDidDispose: Event<void>;\n\n\tdispose(): Promise<void> | void;\n}\n\nexport interface ISharedTunnelsService {\n\treadonly _serviceBrand: undefined;\n\n\topenTunnel(authority: string, addressProvider: IAddressProvider | undefined, remoteHost: string | undefined, remotePort: number, localPort?: number, elevateIfNeeded?: boolean, privacy?: string, protocol?: string): Promise<RemoteTunnel | undefined> | undefined;\n}\n\nexport interface ITunnelService {\n\treadonly _serviceBrand: undefined;\n\n\treadonly tunnels: Promise<readonly RemoteTunnel[]>;\n\treadonly canChangePrivacy: boolean;\n\treadonly privacyOptions: TunnelPrivacy[];\n\treadonly onTunnelOpened: Event<RemoteTunnel>;\n\treadonly onTunnelClosed: Event<{ host: string; port: number }>;\n\treadonly canElevate: boolean;\n\treadonly hasTunnelProvider: boolean;\n\treadonly onAddedTunnelProvider: Event<void>;\n\n\tcanTunnel(uri: URI): boolean;\n\topenTunnel(addressProvider: IAddressProvider | undefined, remoteHost: string | undefined, remotePort: number, localPort?: number, elevateIfNeeded?: boolean, privacy?: string, protocol?: string): Promise<RemoteTunnel | undefined> | undefined;\n\tcloseTunnel(remoteHost: string, remotePort: number): Promise<void>;\n\tsetTunnelProvider(provider: ITunnelProvider | undefined): IDisposable;\n\tsetTunnelFeatures(features: TunnelProviderFeatures): void;\n}\n\nexport function extractLocalHostUriMetaDataForPortMapping(uri: URI): { address: string; port: number } | undefined {\n\tif (uri.scheme !== 'http' && uri.scheme !== 'https') {\n\t\treturn undefined;\n\t}\n\tconst localhostMatch = /^(localhost|127\\.0\\.0\\.1|0\\.0\\.0\\.0):(\\d+)$/.exec(uri.authority);\n\tif (!localhostMatch) {\n\t\treturn undefined;\n\t}\n\treturn {\n\t\taddress: localhostMatch[1],\n\t\tport: +localhostMatch[2],\n\t};\n}\n\nexport const LOCALHOST_ADDRESSES = ['localhost', '127.0.0.1', '0:0:0:0:0:0:0:1', '::1'];\nexport function isLocalhost(host: string): boolean {\n\treturn LOCALHOST_ADDRESSES.indexOf(host) >= 0;\n}\n\nexport const ALL_INTERFACES_ADDRESSES = ['0.0.0.0', '0:0:0:0:0:0:0:0', '::'];\nexport function isAllInterfaces(host: string): boolean {\n\treturn ALL_INTERFACES_ADDRESSES.indexOf(host) >= 0;\n}\n\nexport function isPortPrivileged(port: number, os?: OperatingSystem): boolean {\n\tif (os) {\n\t\treturn os !== OperatingSystem.Windows && (port < 1024);\n\t} else {\n\t\treturn !isWindows && (port < 1024);\n\t}\n}\n\nexport class DisposableTunnel {\n\tprivate _onDispose: Emitter<void> = new Emitter();\n\tonDidDispose: Event<void> = this._onDispose.event;\n\n\tconstructor(\n\t\tpublic readonly remoteAddress: { port: number; host: string },\n\t\tpublic readonly localAddress: { port: number; host: string } | string,\n\t\tprivate readonly _dispose: () => Promise<void>) { }\n\n\tdispose(): Promise<void> {\n\t\tthis._onDispose.fire();\n\t\treturn this._dispose();\n\t}\n}\n\nexport abstract class AbstractTunnelService implements ITunnelService {\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate _onTunnelOpened: Emitter<RemoteTunnel> = new Emitter();\n\tpublic onTunnelOpened: Event<RemoteTunnel> = this._onTunnelOpened.event;\n\tprivate _onTunnelClosed: Emitter<{ host: string; port: number }> = new Emitter();\n\tpublic onTunnelClosed: Event<{ host: string; port: number }> = this._onTunnelClosed.event;\n\tprivate _onAddedTunnelProvider: Emitter<void> = new Emitter();\n\tpublic onAddedTunnelProvider: Event<void> = this._onAddedTunnelProvider.event;\n\tprotected readonly _tunnels = new Map</*host*/ string, Map</* port */ number, { refcount: number; readonly value: Promise<RemoteTunnel | undefined> }>>();\n\tprotected _tunnelProvider: ITunnelProvider | undefined;\n\tprotected _canElevate: boolean = false;\n\tprivate _privacyOptions: TunnelPrivacy[] = [];\n\tprivate _factoryInProgress: Set<number/*port*/> = new Set();\n\n\tpublic constructor(\n\t\t@ILogService protected readonly logService: ILogService\n\t) { }\n\n\tget hasTunnelProvider(): boolean {\n\t\treturn !!this._tunnelProvider;\n\t}\n\n\tsetTunnelProvider(provider: ITunnelProvider | undefined): IDisposable {\n\t\tthis._tunnelProvider = provider;\n\t\tif (!provider) {\n\t\t\t// clear features\n\t\t\tthis._canElevate = false;\n\t\t\tthis._privacyOptions = [];\n\t\t\tthis._onAddedTunnelProvider.fire();\n\t\t\treturn {\n\t\t\t\tdispose: () => { }\n\t\t\t};\n\t\t}\n\n\t\tthis._onAddedTunnelProvider.fire();\n\t\treturn {\n\t\t\tdispose: () => {\n\t\t\t\tthis._tunnelProvider = undefined;\n\t\t\t\tthis._canElevate = false;\n\t\t\t\tthis._privacyOptions = [];\n\t\t\t}\n\t\t};\n\t}\n\n\tsetTunnelFeatures(features: TunnelProviderFeatures): void {\n\t\tthis._canElevate = features.elevation;\n\t\tthis._privacyOptions = features.privacyOptions;\n\t}\n\n\tpublic get canElevate(): boolean {\n\t\treturn this._canElevate;\n\t}\n\n\tpublic get canChangePrivacy() {\n\t\treturn this._privacyOptions.length > 0;\n\t}\n\n\tpublic get privacyOptions() {\n\t\treturn this._privacyOptions;\n\t}\n\n\tpublic get tunnels(): Promise<readonly RemoteTunnel[]> {\n\t\treturn this.getTunnels();\n\t}\n\n\tprivate async getTunnels(): Promise<readonly RemoteTunnel[]> {\n\t\tconst tunnels: RemoteTunnel[] = [];\n\t\tconst tunnelArray = Array.from(this._tunnels.values());\n\t\tfor (const portMap of tunnelArray) {\n\t\t\tconst portArray = Array.from(portMap.values());\n\t\t\tfor (const x of portArray) {\n\t\t\t\tconst tunnelValue = await x.value;\n\t\t\t\tif (tunnelValue) {\n\t\t\t\t\ttunnels.push(tunnelValue);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn tunnels;\n\t}\n\n\tasync dispose(): Promise<void> {\n\t\tfor (const portMap of this._tunnels.values()) {\n\t\t\tfor (const { value } of portMap.values()) {\n\t\t\t\tawait value.then(tunnel => tunnel?.dispose());\n\t\t\t}\n\t\t\tportMap.clear();\n\t\t}\n\t\tthis._tunnels.clear();\n\t}\n\n\topenTunnel(addressProvider: IAddressProvider | undefined, remoteHost: string | undefined, remotePort: number, localPort?: number, elevateIfNeeded: boolean = false, privacy?: string, protocol?: string): Promise<RemoteTunnel | undefined> | undefined {\n\t\tthis.logService.trace(`ForwardedPorts: (TunnelService) openTunnel request for ${remoteHost}:${remotePort} on local port ${localPort}.`);\n\t\tif (!addressProvider) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (!remoteHost) {\n\t\t\tremoteHost = 'localhost';\n\t\t}\n\n\t\t// Prevent tunnel factories from calling openTunnel from within the factory\n\t\tif (this._tunnelProvider && this._factoryInProgress.has(remotePort)) {\n\t\t\tthis.logService.debug(`ForwardedPorts: (TunnelService) Another call to create a tunnel with the same address has occurred before the last one completed. This call will be ignored.`);\n\t\t\treturn;\n\t\t}\n\n\t\tconst resolvedTunnel = this.retainOrCreateTunnel(addressProvider, remoteHost, remotePort, localPort, elevateIfNeeded, privacy, protocol);\n\t\tif (!resolvedTunnel) {\n\t\t\tthis.logService.trace(`ForwardedPorts: (TunnelService) Tunnel was not created.`);\n\t\t\treturn resolvedTunnel;\n\t\t}\n\n\t\treturn resolvedTunnel.then(tunnel => {\n\t\t\tif (!tunnel) {\n\t\t\t\tthis.logService.trace('ForwardedPorts: (TunnelService) New tunnel is undefined.');\n\t\t\t\tthis.removeEmptyTunnelFromMap(remoteHost!, remotePort);\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\tthis.logService.trace('ForwardedPorts: (TunnelService) New tunnel established.');\n\t\t\tconst newTunnel = this.makeTunnel(tunnel);\n\t\t\tif (tunnel.tunnelRemoteHost !== remoteHost || tunnel.tunnelRemotePort !== remotePort) {\n\t\t\t\tthis.logService.warn('ForwardedPorts: (TunnelService) Created tunnel does not match requirements of requested tunnel. Host or port mismatch.');\n\t\t\t}\n\t\t\tthis._onTunnelOpened.fire(newTunnel);\n\t\t\treturn newTunnel;\n\t\t});\n\t}\n\n\tprivate makeTunnel(tunnel: RemoteTunnel): RemoteTunnel {\n\t\treturn {\n\t\t\ttunnelRemotePort: tunnel.tunnelRemotePort,\n\t\t\ttunnelRemoteHost: tunnel.tunnelRemoteHost,\n\t\t\ttunnelLocalPort: tunnel.tunnelLocalPort,\n\t\t\tlocalAddress: tunnel.localAddress,\n\t\t\tprivacy: tunnel.privacy,\n\t\t\tprotocol: tunnel.protocol,\n\t\t\tdispose: async () => {\n\t\t\t\tthis.logService.trace(`ForwardedPorts: (TunnelService) dispose request for ${tunnel.tunnelRemoteHost}:${tunnel.tunnelRemotePort} `);\n\t\t\t\tconst existingHost = this._tunnels.get(tunnel.tunnelRemoteHost);\n\t\t\t\tif (existingHost) {\n\t\t\t\t\tconst existing = existingHost.get(tunnel.tunnelRemotePort);\n\t\t\t\t\tif (existing) {\n\t\t\t\t\t\texisting.refcount--;\n\t\t\t\t\t\tawait this.tryDisposeTunnel(tunnel.tunnelRemoteHost, tunnel.tunnelRemotePort, existing);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\tprivate async tryDisposeTunnel(remoteHost: string, remotePort: number, tunnel: { refcount: number; readonly value: Promise<RemoteTunnel | undefined> }): Promise<void> {\n\t\tif (tunnel.refcount <= 0) {\n\t\t\tthis.logService.trace(`ForwardedPorts: (TunnelService) Tunnel is being disposed ${remoteHost}:${remotePort}.`);\n\t\t\tconst disposePromise: Promise<void> = tunnel.value.then(async (tunnel) => {\n\t\t\t\tif (tunnel) {\n\t\t\t\t\tawait tunnel.dispose(true);\n\t\t\t\t\tthis._onTunnelClosed.fire({ host: tunnel.tunnelRemoteHost, port: tunnel.tunnelRemotePort });\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (this._tunnels.has(remoteHost)) {\n\t\t\t\tthis._tunnels.get(remoteHost)!.delete(remotePort);\n\t\t\t}\n\t\t\treturn disposePromise;\n\t\t}\n\t}\n\n\tasync closeTunnel(remoteHost: string, remotePort: number): Promise<void> {\n\t\tthis.logService.trace(`ForwardedPorts: (TunnelService) close request for ${remoteHost}:${remotePort} `);\n\t\tconst portMap = this._tunnels.get(remoteHost);\n\t\tif (portMap && portMap.has(remotePort)) {\n\t\t\tconst value = portMap.get(remotePort)!;\n\t\t\tvalue.refcount = 0;\n\t\t\tawait this.tryDisposeTunnel(remoteHost, remotePort, value);\n\t\t}\n\t}\n\n\tprotected addTunnelToMap(remoteHost: string, remotePort: number, tunnel: Promise<RemoteTunnel | undefined>) {\n\t\tif (!this._tunnels.has(remoteHost)) {\n\t\t\tthis._tunnels.set(remoteHost, new Map());\n\t\t}\n\t\tthis._tunnels.get(remoteHost)!.set(remotePort, { refcount: 1, value: tunnel });\n\t}\n\n\tprivate async removeEmptyTunnelFromMap(remoteHost: string, remotePort: number) {\n\t\tconst hostMap = this._tunnels.get(remoteHost);\n\t\tif (hostMap) {\n\t\t\tconst tunnel = hostMap.get(remotePort);\n\t\t\tconst tunnelResult = await tunnel;\n\t\t\tif (!tunnelResult) {\n\t\t\t\thostMap.delete(remotePort);\n\t\t\t}\n\t\t\tif (hostMap.size === 0) {\n\t\t\t\tthis._tunnels.delete(remoteHost);\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected getTunnelFromMap(remoteHost: string, remotePort: number): { refcount: number; readonly value: Promise<RemoteTunnel | undefined> } | undefined {\n\t\tconst hosts = [remoteHost];\n\t\t// Order matters. We want the original host to be first.\n\t\tif (isLocalhost(remoteHost)) {\n\t\t\thosts.push(...LOCALHOST_ADDRESSES);\n\t\t\t// For localhost, we add the all interfaces hosts because if the tunnel is already available at all interfaces,\n\t\t\t// then of course it is available at localhost.\n\t\t\thosts.push(...ALL_INTERFACES_ADDRESSES);\n\t\t} else if (isAllInterfaces(remoteHost)) {\n\t\t\thosts.push(...ALL_INTERFACES_ADDRESSES);\n\t\t}\n\n\t\tconst existingPortMaps = hosts.map(host => this._tunnels.get(host));\n\t\tfor (const map of existingPortMaps) {\n\t\t\tconst existingTunnel = map?.get(remotePort);\n\t\t\tif (existingTunnel) {\n\t\t\t\treturn existingTunnel;\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tcanTunnel(uri: URI): boolean {\n\t\treturn !!extractLocalHostUriMetaDataForPortMapping(uri);\n\t}\n\n\tprotected abstract retainOrCreateTunnel(addressProvider: IAddressProvider, remoteHost: string, remotePort: number, localPort: number | undefined, elevateIfNeeded: boolean, privacy?: string, protocol?: string): Promise<RemoteTunnel | undefined> | undefined;\n\n\tprotected createWithProvider(tunnelProvider: ITunnelProvider, remoteHost: string, remotePort: number, localPort: number | undefined, elevateIfNeeded: boolean, privacy?: string, protocol?: string): Promise<RemoteTunnel | undefined> | undefined {\n\t\tthis.logService.trace(`ForwardedPorts: (TunnelService) Creating tunnel with provider ${remoteHost}:${remotePort} on local port ${localPort}.`);\n\t\tconst key = remotePort;\n\t\tthis._factoryInProgress.add(key);\n\t\tconst preferredLocalPort = localPort === undefined ? remotePort : localPort;\n\t\tconst creationInfo = { elevationRequired: elevateIfNeeded ? isPortPrivileged(preferredLocalPort) : false };\n\t\tconst tunnelOptions: TunnelOptions = { remoteAddress: { host: remoteHost, port: remotePort }, localAddressPort: localPort, privacy, public: privacy ? (privacy !== TunnelPrivacyId.Private) : undefined, protocol };\n\t\tconst tunnel = tunnelProvider.forwardPort(tunnelOptions, creationInfo);\n\t\tif (tunnel) {\n\t\t\tthis.addTunnelToMap(remoteHost, remotePort, tunnel);\n\t\t\ttunnel.finally(() => {\n\t\t\t\tthis.logService.trace('ForwardedPorts: (TunnelService) Tunnel created by provider.');\n\t\t\t\tthis._factoryInProgress.delete(key);\n\t\t\t});\n\t\t} else {\n\t\t\tthis._factoryInProgress.delete(key);\n\t\t}\n\t\treturn tunnel;\n\t}\n}\n\n\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Schemas } from 'vs/base/common/network';\nimport { URI } from 'vs/base/common/uri';\nimport { IWorkspace } from 'vs/platform/workspace/common/workspace';\n\nexport function isVirtualResource(resource: URI) {\n\treturn resource.scheme !== Schemas.file && resource.scheme !== Schemas.vscodeRemote;\n}\n\nexport function getVirtualWorkspaceLocation(workspace: IWorkspace): { scheme: string; authority: string } | undefined {\n\tif (workspace.folders.length) {\n\t\treturn workspace.folders.every(f => isVirtualResource(f.uri)) ? workspace.folders[0].uri : undefined;\n\t} else if (workspace.configuration && isVirtualResource(workspace.configuration)) {\n\t\treturn workspace.configuration;\n\t}\n\treturn undefined;\n}\n\nexport function getVirtualWorkspaceScheme(workspace: IWorkspace): string | undefined {\n\treturn getVirtualWorkspaceLocation(workspace)?.scheme;\n}\n\nexport function getVirtualWorkspaceAuthority(workspace: IWorkspace): string | undefined {\n\treturn getVirtualWorkspaceLocation(workspace)?.authority;\n}\n\nexport function isVirtualWorkspace(workspace: IWorkspace): boolean {\n\treturn getVirtualWorkspaceLocation(workspace) !== undefined;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { localize } from 'vs/nls';\nimport { Event } from 'vs/base/common/event';\nimport { extname } from 'vs/base/common/path';\nimport { TernarySearchTree } from 'vs/base/common/map';\nimport { extname as resourceExtname, basenameOrAuthority, joinPath, extUriBiasedIgnorePathCase } from 'vs/base/common/resources';\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { IEnvironmentService } from 'vs/platform/environment/common/environment';\nimport { Schemas } from 'vs/base/common/network';\n\nexport const IWorkspaceContextService = createDecorator<IWorkspaceContextService>('contextService');\n\nexport interface IWorkspaceContextService {\n\n\treadonly _serviceBrand: undefined;\n\n\t/**\n\t * An event which fires on workbench state changes.\n\t */\n\treadonly onDidChangeWorkbenchState: Event<WorkbenchState>;\n\n\t/**\n\t * An event which fires on workspace name changes.\n\t */\n\treadonly onDidChangeWorkspaceName: Event<void>;\n\n\t/**\n\t * An event which fires before workspace folders change.\n\t */\n\treadonly onWillChangeWorkspaceFolders: Event<IWorkspaceFoldersWillChangeEvent>;\n\n\t/**\n\t * An event which fires on workspace folders change.\n\t */\n\treadonly onDidChangeWorkspaceFolders: Event<IWorkspaceFoldersChangeEvent>;\n\n\t/**\n\t * Provides access to the complete workspace object.\n\t */\n\tgetCompleteWorkspace(): Promise<IWorkspace>;\n\n\t/**\n\t * Provides access to the workspace object the window is running with.\n\t * Use `getCompleteWorkspace` to get complete workspace object.\n\t */\n\tgetWorkspace(): IWorkspace;\n\n\t/**\n\t * Return the state of the workbench.\n\t *\n\t * WorkbenchState.EMPTY - if the workbench was opened with empty window or file\n\t * WorkbenchState.FOLDER - if the workbench was opened with a folder\n\t * WorkbenchState.WORKSPACE - if the workbench was opened with a workspace\n\t */\n\tgetWorkbenchState(): WorkbenchState;\n\n\t/**\n\t * Returns the folder for the given resource from the workspace.\n\t * Can be null if there is no workspace or the resource is not inside the workspace.\n\t */\n\tgetWorkspaceFolder(resource: URI): IWorkspaceFolder | null;\n\n\t/**\n\t * Return `true` if the current workspace has the given identifier or root URI otherwise `false`.\n\t */\n\tisCurrentWorkspace(workspaceIdOrFolder: IWorkspaceIdentifier | ISingleFolderWorkspaceIdentifier | URI): boolean;\n\n\t/**\n\t * Returns if the provided resource is inside the workspace or not.\n\t */\n\tisInsideWorkspace(resource: URI): boolean;\n}\n\nexport interface IResolvedWorkspace extends IWorkspaceIdentifier, IBaseWorkspace {\n\treadonly folders: IWorkspaceFolder[];\n}\n\nexport interface IBaseWorkspace {\n\n\t/**\n\t * If present, marks the window that opens the workspace\n\t * as a remote window with the given authority.\n\t */\n\treadonly remoteAuthority?: string;\n\n\t/**\n\t * Transient workspaces are meant to go away after being used\n\t * once, e.g. a window reload of a transient workspace will\n\t * open an empty window.\n\t *\n\t * See: https://github.com/microsoft/vscode/issues/119695\n\t */\n\treadonly transient?: boolean;\n}\n\nexport interface IBaseWorkspaceIdentifier {\n\n\t/**\n\t * Every workspace (multi-root, single folder or empty)\n\t * has a unique identifier. It is not possible to open\n\t * a workspace with the same `id` in multiple windows\n\t */\n\treadonly id: string;\n}\n\n/**\n * A single folder workspace identifier is a path to a folder + id.\n */\nexport interface ISingleFolderWorkspaceIdentifier extends IBaseWorkspaceIdentifier {\n\n\t/**\n\t * Folder path as `URI`.\n\t */\n\treadonly uri: URI;\n}\n\n/**\n * A multi-root workspace identifier is a path to a workspace file + id.\n */\nexport interface IWorkspaceIdentifier extends IBaseWorkspaceIdentifier {\n\n\t/**\n\t * Workspace config file path as `URI`.\n\t */\n\tconfigPath: URI;\n}\n\nexport interface IEmptyWorkspaceIdentifier extends IBaseWorkspaceIdentifier { }\n\nexport type IAnyWorkspaceIdentifier = IWorkspaceIdentifier | ISingleFolderWorkspaceIdentifier | IEmptyWorkspaceIdentifier;\n\nexport function isSingleFolderWorkspaceIdentifier(obj: unknown): obj is ISingleFolderWorkspaceIdentifier {\n\tconst singleFolderIdentifier = obj as ISingleFolderWorkspaceIdentifier | undefined;\n\n\treturn typeof singleFolderIdentifier?.id === 'string' && URI.isUri(singleFolderIdentifier.uri);\n}\n\nexport function toWorkspaceIdentifier(workspace: IWorkspace): IWorkspaceIdentifier | ISingleFolderWorkspaceIdentifier | undefined {\n\n\t// Multi root\n\tif (workspace.configuration) {\n\t\treturn {\n\t\t\tid: workspace.id,\n\t\t\tconfigPath: workspace.configuration\n\t\t};\n\t}\n\n\t// Single folder\n\tif (workspace.folders.length === 1) {\n\t\treturn {\n\t\t\tid: workspace.id,\n\t\t\turi: workspace.folders[0].uri\n\t\t};\n\t}\n\n\t// Empty workspace\n\treturn undefined;\n}\n\nexport function isWorkspaceIdentifier(obj: unknown): obj is IWorkspaceIdentifier {\n\tconst workspaceIdentifier = obj as IWorkspaceIdentifier | undefined;\n\n\treturn typeof workspaceIdentifier?.id === 'string' && URI.isUri(workspaceIdentifier.configPath);\n}\n\nexport interface ISerializedSingleFolderWorkspaceIdentifier extends IBaseWorkspaceIdentifier {\n\treadonly uri: UriComponents;\n}\n\nexport interface ISerializedWorkspaceIdentifier extends IBaseWorkspaceIdentifier {\n\treadonly configPath: UriComponents;\n}\n\nexport function reviveIdentifier(identifier: undefined): undefined;\nexport function reviveIdentifier(identifier: ISerializedWorkspaceIdentifier): IWorkspaceIdentifier;\nexport function reviveIdentifier(identifier: ISerializedSingleFolderWorkspaceIdentifier): ISingleFolderWorkspaceIdentifier;\nexport function reviveIdentifier(identifier: IEmptyWorkspaceIdentifier): IEmptyWorkspaceIdentifier;\nexport function reviveIdentifier(identifier: ISerializedWorkspaceIdentifier | ISerializedSingleFolderWorkspaceIdentifier | IEmptyWorkspaceIdentifier | undefined): IWorkspaceIdentifier | ISingleFolderWorkspaceIdentifier | IEmptyWorkspaceIdentifier | undefined;\nexport function reviveIdentifier(identifier: ISerializedWorkspaceIdentifier | ISerializedSingleFolderWorkspaceIdentifier | IEmptyWorkspaceIdentifier | undefined): IWorkspaceIdentifier | ISingleFolderWorkspaceIdentifier | IEmptyWorkspaceIdentifier | undefined {\n\n\t// Single Folder\n\tconst singleFolderIdentifierCandidate = identifier as ISerializedSingleFolderWorkspaceIdentifier | undefined;\n\tif (singleFolderIdentifierCandidate?.uri) {\n\t\treturn { id: singleFolderIdentifierCandidate.id, uri: URI.revive(singleFolderIdentifierCandidate.uri) };\n\t}\n\n\t// Multi folder\n\tconst workspaceIdentifierCandidate = identifier as ISerializedWorkspaceIdentifier | undefined;\n\tif (workspaceIdentifierCandidate?.configPath) {\n\t\treturn { id: workspaceIdentifierCandidate.id, configPath: URI.revive(workspaceIdentifierCandidate.configPath) };\n\t}\n\n\t// Empty\n\tif (identifier?.id) {\n\t\treturn { id: identifier.id };\n\t}\n\n\treturn undefined;\n}\n\nexport const enum WorkbenchState {\n\tEMPTY = 1,\n\tFOLDER,\n\tWORKSPACE\n}\n\nexport interface IWorkspaceFoldersWillChangeEvent {\n\n\treadonly changes: IWorkspaceFoldersChangeEvent;\n\treadonly fromCache: boolean;\n\n\tjoin(promise: Promise<void>): void;\n}\n\nexport interface IWorkspaceFoldersChangeEvent {\n\tadded: IWorkspaceFolder[];\n\tremoved: IWorkspaceFolder[];\n\tchanged: IWorkspaceFolder[];\n}\n\nexport interface IWorkspace {\n\n\t/**\n\t * the unique identifier of the workspace.\n\t */\n\treadonly id: string;\n\n\t/**\n\t * Folders in the workspace.\n\t */\n\treadonly folders: IWorkspaceFolder[];\n\n\t/**\n\t * Transient workspaces are meant to go away after being used\n\t * once, e.g. a window reload of a transient workspace will\n\t * open an empty window.\n\t */\n\treadonly transient?: boolean;\n\n\t/**\n\t * the location of the workspace configuration\n\t */\n\treadonly configuration?: URI | null;\n}\n\nexport function isWorkspace(thing: unknown): thing is IWorkspace {\n\tconst candidate = thing as IWorkspace | undefined;\n\n\treturn !!(candidate && typeof candidate === 'object'\n\t\t&& typeof candidate.id === 'string'\n\t\t&& Array.isArray(candidate.folders));\n}\n\nexport interface IWorkspaceFolderData {\n\n\t/**\n\t * The associated URI for this workspace folder.\n\t */\n\treadonly uri: URI;\n\n\t/**\n\t * The name of this workspace folder. Defaults to\n\t * the basename of its [uri-path](#Uri.path)\n\t */\n\treadonly name: string;\n\n\t/**\n\t * The ordinal number of this workspace folder.\n\t */\n\treadonly index: number;\n}\n\nexport interface IWorkspaceFolder extends IWorkspaceFolderData {\n\n\t/**\n\t * Given workspace folder relative path, returns the resource with the absolute path.\n\t */\n\ttoResource: (relativePath: string) => URI;\n}\n\nexport function isWorkspaceFolder(thing: unknown): thing is IWorkspaceFolder {\n\tconst candidate = thing as IWorkspaceFolder;\n\n\treturn !!(candidate && typeof candidate === 'object'\n\t\t&& URI.isUri(candidate.uri)\n\t\t&& typeof candidate.name === 'string'\n\t\t&& typeof candidate.toResource === 'function');\n}\n\nexport class Workspace implements IWorkspace {\n\n\tprivate _foldersMap: TernarySearchTree<URI, WorkspaceFolder> = TernarySearchTree.forUris<WorkspaceFolder>(this._ignorePathCasing, () => true);\n\tprivate _folders!: WorkspaceFolder[];\n\n\tconstructor(\n\t\tprivate _id: string,\n\t\tfolders: WorkspaceFolder[],\n\t\tprivate _transient: boolean,\n\t\tprivate _configuration: URI | null,\n\t\tprivate _ignorePathCasing: (key: URI) => boolean,\n\t) {\n\t\tthis.folders = folders;\n\t}\n\n\tupdate(workspace: Workspace) {\n\t\tthis._id = workspace.id;\n\t\tthis._configuration = workspace.configuration;\n\t\tthis._transient = workspace.transient;\n\t\tthis._ignorePathCasing = workspace._ignorePathCasing;\n\t\tthis.folders = workspace.folders;\n\t}\n\n\tget folders(): WorkspaceFolder[] {\n\t\treturn this._folders;\n\t}\n\n\tset folders(folders: WorkspaceFolder[]) {\n\t\tthis._folders = folders;\n\t\tthis.updateFoldersMap();\n\t}\n\n\tget id(): string {\n\t\treturn this._id;\n\t}\n\n\tget transient(): boolean {\n\t\treturn this._transient;\n\t}\n\n\tget configuration(): URI | null {\n\t\treturn this._configuration;\n\t}\n\n\tset configuration(configuration: URI | null) {\n\t\tthis._configuration = configuration;\n\t}\n\n\tgetFolder(resource: URI): IWorkspaceFolder | null {\n\t\tif (!resource) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this._foldersMap.findSubstr(resource) || null;\n\t}\n\n\tprivate updateFoldersMap(): void {\n\t\tthis._foldersMap = TernarySearchTree.forUris<WorkspaceFolder>(this._ignorePathCasing, () => true);\n\t\tfor (const folder of this.folders) {\n\t\t\tthis._foldersMap.set(folder.uri, folder);\n\t\t}\n\t}\n\n\ttoJSON(): IWorkspace {\n\t\treturn { id: this.id, folders: this.folders, transient: this.transient, configuration: this.configuration };\n\t}\n}\n\nexport interface IRawFileWorkspaceFolder {\n\treadonly path: string;\n\tname?: string;\n}\n\nexport interface IRawUriWorkspaceFolder {\n\treadonly uri: string;\n\tname?: string;\n}\n\nexport class WorkspaceFolder implements IWorkspaceFolder {\n\n\treadonly uri: URI;\n\treadonly name: string;\n\treadonly index: number;\n\n\tconstructor(\n\t\tdata: IWorkspaceFolderData,\n\t\t/**\n\t\t * Provides access to the original metadata for this workspace\n\t\t * folder. This can be different from the metadata provided in\n\t\t * this class:\n\t\t * - raw paths can be relative\n\t\t * - raw paths are not normalized\n\t\t */\n\t\treadonly raw?: IRawFileWorkspaceFolder | IRawUriWorkspaceFolder\n\t) {\n\t\tthis.uri = data.uri;\n\t\tthis.index = data.index;\n\t\tthis.name = data.name;\n\t}\n\n\ttoResource(relativePath: string): URI {\n\t\treturn joinPath(this.uri, relativePath);\n\t}\n\n\ttoJSON(): IWorkspaceFolderData {\n\t\treturn { uri: this.uri, name: this.name, index: this.index };\n\t}\n}\n\nexport function toWorkspaceFolder(resource: URI): WorkspaceFolder {\n\treturn new WorkspaceFolder({ uri: resource, index: 0, name: basenameOrAuthority(resource) }, { uri: resource.toString() });\n}\n\nexport const WORKSPACE_EXTENSION = 'code-workspace';\nconst WORKSPACE_SUFFIX = `.${WORKSPACE_EXTENSION}`;\nexport const WORKSPACE_FILTER = [{ name: localize('codeWorkspace', \"Code Workspace\"), extensions: [WORKSPACE_EXTENSION] }];\nexport const UNTITLED_WORKSPACE_NAME = 'workspace.json';\n\nexport function isUntitledWorkspace(path: URI, environmentService: IEnvironmentService): boolean {\n\treturn extUriBiasedIgnorePathCase.isEqualOrParent(path, environmentService.untitledWorkspacesHome);\n}\n\nexport function isTemporaryWorkspace(workspace: IWorkspace): boolean;\nexport function isTemporaryWorkspace(path: URI): boolean;\nexport function isTemporaryWorkspace(arg1: IWorkspace | URI): boolean {\n\tlet path: URI | null | undefined;\n\tif (URI.isUri(arg1)) {\n\t\tpath = arg1;\n\t} else {\n\t\tpath = arg1.configuration;\n\t}\n\n\treturn path?.scheme === Schemas.tmp;\n}\n\nexport function isSavedWorkspace(path: URI, environmentService: IEnvironmentService): boolean {\n\treturn !isUntitledWorkspace(path, environmentService) && !isTemporaryWorkspace(path);\n}\n\nexport function hasWorkspaceFileExtension(path: string | URI) {\n\tconst ext = (typeof path === 'string') ? extname(path) : resourceExtname(path);\n\n\treturn ext === WORKSPACE_SUFFIX;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport class Cache<T> {\n\n\tprivate static readonly enableDebugLogging = false;\n\n\tprivate readonly _data = new Map<number, readonly T[]>();\n\tprivate _idPool = 1;\n\n\tconstructor(\n\t\tprivate readonly id: string\n\t) { }\n\n\tadd(item: readonly T[]): number {\n\t\tconst id = this._idPool++;\n\t\tthis._data.set(id, item);\n\t\tthis.logDebugInfo();\n\t\treturn id;\n\t}\n\n\tget(pid: number, id: number): T | undefined {\n\t\treturn this._data.has(pid) ? this._data.get(pid)![id] : undefined;\n\t}\n\n\tdelete(id: number) {\n\t\tthis._data.delete(id);\n\t\tthis.logDebugInfo();\n\t}\n\n\tprivate logDebugInfo() {\n\t\tif (!Cache.enableDebugLogging) {\n\t\t\treturn;\n\t\t}\n\t\tconsole.log(`${this.id} cache size - ${this._data.size}`);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Schemas } from 'vs/base/common/network';\nimport { ExtUri, IExtUri } from 'vs/base/common/resources';\nimport { UriComponents } from 'vs/base/common/uri';\nimport { FileSystemProviderCapabilities } from 'vs/platform/files/common/files';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { ExtHostFileSystemInfoShape } from 'vs/workbench/api/common/extHost.protocol';\n\nexport class ExtHostFileSystemInfo implements ExtHostFileSystemInfoShape {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate readonly _systemSchemes = new Set(Object.keys(Schemas));\n\tprivate readonly _providerInfo = new Map<string, number>();\n\n\treadonly extUri: IExtUri;\n\n\tconstructor() {\n\t\tthis.extUri = new ExtUri(uri => {\n\t\t\tconst capabilities = this._providerInfo.get(uri.scheme);\n\t\t\tif (capabilities === undefined) {\n\t\t\t\t// default: not ignore\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (capabilities & FileSystemProviderCapabilities.PathCaseSensitive) {\n\t\t\t\t// configured as case sensitive\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\t}\n\n\t$acceptProviderInfos(uri: UriComponents, capabilities: number | null): void {\n\t\tif (capabilities === null) {\n\t\t\tthis._providerInfo.delete(uri.scheme);\n\t\t} else {\n\t\t\tthis._providerInfo.set(uri.scheme, capabilities);\n\t\t}\n\t}\n\n\tisFreeScheme(scheme: string): boolean {\n\t\treturn !this._providerInfo.has(scheme) && !this._systemSchemes.has(scheme);\n\t}\n\n\tgetCapabilities(scheme: string): number | undefined {\n\t\treturn this._providerInfo.get(scheme);\n\t}\n}\n\nexport interface IExtHostFileSystemInfo extends ExtHostFileSystemInfo {\n\treadonly extUri: IExtUri;\n}\nexport const IExtHostFileSystemInfo = createDecorator<IExtHostFileSystemInfo>('IExtHostFileSystemInfo');\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IExtensionHostInitData } from 'vs/workbench/services/extensions/common/extensionHostProtocol';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\n\nexport const IExtHostInitDataService = createDecorator<IExtHostInitDataService>('IExtHostInitDataService');\n\nexport interface IExtHostInitDataService extends Readonly<IExtensionHostInitData> {\n\treadonly _serviceBrand: undefined;\n}\n\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type * as vscode from 'vscode';\nimport { IDisposable } from 'vs/base/common/lifecycle';\nimport { ExtHostStorage } from 'vs/workbench/api/common/extHostStorage';\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { DeferredPromise, RunOnceScheduler } from 'vs/base/common/async';\n\nexport class ExtensionMemento implements vscode.Memento {\n\n\tprotected readonly _id: string;\n\tprivate readonly _shared: boolean;\n\tprotected readonly _storage: ExtHostStorage;\n\n\tprivate readonly _init: Promise<ExtensionMemento>;\n\tprivate _value?: { [n: string]: any };\n\tprivate readonly _storageListener: IDisposable;\n\n\tprivate _deferredPromises: Map<string, DeferredPromise<void>> = new Map();\n\tprivate _scheduler: RunOnceScheduler;\n\n\tconstructor(id: string, global: boolean, storage: ExtHostStorage) {\n\t\tthis._id = id;\n\t\tthis._shared = global;\n\t\tthis._storage = storage;\n\n\t\tthis._init = this._storage.initializeExtensionStorage(this._shared, this._id, Object.create(null)).then(value => {\n\t\t\tthis._value = value;\n\t\t\treturn this;\n\t\t});\n\n\t\tthis._storageListener = this._storage.onDidChangeStorage(e => {\n\t\t\tif (e.shared === this._shared && e.key === this._id) {\n\t\t\t\tthis._value = e.value;\n\t\t\t}\n\t\t});\n\n\t\tthis._scheduler = new RunOnceScheduler(() => {\n\t\t\tconst records = this._deferredPromises;\n\t\t\tthis._deferredPromises = new Map();\n\t\t\t(async () => {\n\t\t\t\ttry {\n\t\t\t\t\tawait this._storage.setValue(this._shared, this._id, this._value!);\n\t\t\t\t\tfor (const value of records.values()) {\n\t\t\t\t\t\tvalue.complete();\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tfor (const value of records.values()) {\n\t\t\t\t\t\tvalue.error(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})();\n\t\t}, 0);\n\t}\n\n\tkeys(): readonly string[] {\n\t\t// Filter out `undefined` values, as they can stick around in the `_value` until the `onDidChangeStorage` event runs\n\t\treturn Object.entries(this._value ?? {}).filter(([, value]) => value !== undefined).map(([key]) => key);\n\t}\n\n\tget whenReady(): Promise<ExtensionMemento> {\n\t\treturn this._init;\n\t}\n\n\tget<T>(key: string): T | undefined;\n\tget<T>(key: string, defaultValue: T): T;\n\tget<T>(key: string, defaultValue?: T): T {\n\t\tlet value = this._value![key];\n\t\tif (typeof value === 'undefined') {\n\t\t\tvalue = defaultValue;\n\t\t}\n\t\treturn value;\n\t}\n\n\tupdate(key: string, value: any): Promise<void> {\n\t\tthis._value![key] = value;\n\n\t\tconst record = this._deferredPromises.get(key);\n\t\tif (record !== undefined) {\n\t\t\treturn record.p;\n\t\t}\n\n\t\tconst promise = new DeferredPromise<void>();\n\t\tthis._deferredPromises.set(key, promise);\n\n\t\tif (!this._scheduler.isScheduled()) {\n\t\t\tthis._scheduler.schedule();\n\t\t}\n\n\t\treturn promise.p;\n\t}\n\n\tdispose(): void {\n\t\tthis._storageListener.dispose();\n\t}\n}\n\nexport class ExtensionGlobalMemento extends ExtensionMemento {\n\n\tprivate readonly _extension: IExtensionDescription;\n\n\tsetKeysForSync(keys: string[]): void {\n\t\tthis._storage.registerExtensionStorageKeysToSync({ id: this._id, version: this._extension.version }, keys);\n\t}\n\n\tconstructor(extensionDescription: IExtensionDescription, storage: ExtHostStorage) {\n\t\tsuper(extensionDescription.identifier.value, true, storage);\n\t\tthis._extension = extensionDescription;\n\t}\n\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter } from 'vs/base/common/event';\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport * as extHostProtocol from 'vs/workbench/api/common/extHost.protocol';\nimport { ExtHostNotebookController } from 'vs/workbench/api/common/extHostNotebook';\nimport { NotebookDocumentMetadata } from 'vs/workbench/contrib/notebook/common/notebookCommon';\nimport { SerializableObjectWithBuffers } from 'vs/workbench/services/extensions/common/proxyIdentifier';\nimport type * as vscode from 'vscode';\n\nexport class ExtHostNotebookDocuments implements extHostProtocol.ExtHostNotebookDocumentsShape {\n\n\tprivate readonly _onDidSaveNotebookDocument = new Emitter<vscode.NotebookDocument>();\n\treadonly onDidSaveNotebookDocument = this._onDidSaveNotebookDocument.event;\n\n\tprivate readonly _onDidChangeNotebookDocument = new Emitter<vscode.NotebookDocumentChangeEvent>();\n\treadonly onDidChangeNotebookDocument = this._onDidChangeNotebookDocument.event;\n\n\tconstructor(\n\t\tprivate readonly _notebooksAndEditors: ExtHostNotebookController,\n\t) { }\n\n\t$acceptModelChanged(uri: UriComponents, event: SerializableObjectWithBuffers<extHostProtocol.NotebookCellsChangedEventDto>, isDirty: boolean, newMetadata?: NotebookDocumentMetadata): void {\n\t\tconst document = this._notebooksAndEditors.getNotebookDocument(URI.revive(uri));\n\t\tconst e = document.acceptModelChanged(event.value, isDirty, newMetadata);\n\t\tthis._onDidChangeNotebookDocument.fire(e);\n\t}\n\n\t$acceptDirtyStateChanged(uri: UriComponents, isDirty: boolean): void {\n\t\tconst document = this._notebooksAndEditors.getNotebookDocument(URI.revive(uri));\n\t\tdocument.acceptDirty(isDirty);\n\t}\n\n\t$acceptModelSaved(uri: UriComponents): void {\n\t\tconst document = this._notebooksAndEditors.getNotebookDocument(URI.revive(uri));\n\t\tthis._onDidSaveNotebookDocument.fire(document.apiNotebook);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ProxyIdentifier, IRPCProtocol, Proxied } from 'vs/workbench/services/extensions/common/proxyIdentifier';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\n\nexport const IExtHostRpcService = createDecorator<IExtHostRpcService>('IExtHostRpcService');\n\nexport interface IExtHostRpcService extends IRPCProtocol {\n\treadonly _serviceBrand: undefined;\n}\n\nexport class ExtHostRpcService implements IExtHostRpcService {\n\treadonly _serviceBrand: undefined;\n\n\treadonly getProxy: <T>(identifier: ProxyIdentifier<T>) => Proxied<T>;\n\treadonly set: <T, R extends T> (identifier: ProxyIdentifier<T>, instance: R) => R;\n\treadonly dispose: () => void;\n\treadonly assertRegistered: (identifiers: ProxyIdentifier<any>[]) => void;\n\treadonly drain: () => Promise<void>;\n\n\tconstructor(rpcProtocol: IRPCProtocol) {\n\t\tthis.getProxy = rpcProtocol.getProxy.bind(rpcProtocol);\n\t\tthis.set = rpcProtocol.set.bind(rpcProtocol);\n\t\tthis.dispose = rpcProtocol.dispose.bind(rpcProtocol);\n\t\tthis.assertRegistered = rpcProtocol.assertRegistered.bind(rpcProtocol);\n\t\tthis.drain = rpcProtocol.drain.bind(rpcProtocol);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type * as vscode from 'vscode';\n\nimport { ExtHostSecretState } from 'vs/workbench/api/common/exHostSecretState';\nimport { ExtensionIdentifier, IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { Emitter, Event } from 'vs/base/common/event';\n\nexport class ExtensionSecrets implements vscode.SecretStorage {\n\n\tprotected readonly _id: string;\n\treadonly #secretState: ExtHostSecretState;\n\n\tprivate _onDidChange = new Emitter<vscode.SecretStorageChangeEvent>();\n\treadonly onDidChange: Event<vscode.SecretStorageChangeEvent> = this._onDidChange.event;\n\n\n\tconstructor(extensionDescription: IExtensionDescription, secretState: ExtHostSecretState) {\n\t\tthis._id = ExtensionIdentifier.toKey(extensionDescription.identifier);\n\t\tthis.#secretState = secretState;\n\n\t\tthis.#secretState.onDidChangePassword(e => {\n\t\t\tif (e.extensionId === this._id) {\n\t\t\t\tthis._onDidChange.fire({ key: e.key });\n\t\t\t}\n\t\t});\n\t}\n\n\tget(key: string): Promise<string | undefined> {\n\t\treturn this.#secretState.get(this._id, key);\n\t}\n\n\tstore(key: string, value: string): Promise<void> {\n\t\treturn this.#secretState.store(this._id, key, value);\n\t}\n\n\tdelete(key: string): Promise<void> {\n\t\treturn this.#secretState.delete(this._id, key);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { Event, Emitter } from 'vs/base/common/event';\nimport { ExtHostTelemetryShape } from 'vs/workbench/api/common/extHost.protocol';\nimport { TelemetryLevel } from 'vs/platform/telemetry/common/telemetry';\nimport type { TelemetryConfiguration } from 'vscode';\n\nexport class ExtHostTelemetry implements ExtHostTelemetryShape {\n\tprivate readonly _onDidChangeTelemetryEnabled = new Emitter<boolean>();\n\treadonly onDidChangeTelemetryEnabled: Event<boolean> = this._onDidChangeTelemetryEnabled.event;\n\n\tprivate readonly _onDidChangeTelemetryConfiguration = new Emitter<TelemetryConfiguration>();\n\treadonly onDidChangeTelemetryConfiguration: Event<TelemetryConfiguration> = this._onDidChangeTelemetryConfiguration.event;\n\n\tprivate _productConfig: { usage: boolean; error: boolean } = { usage: true, error: true };\n\tprivate _level: TelemetryLevel = TelemetryLevel.NONE;\n\tprivate _oldTelemetryEnablement: boolean | undefined;\n\n\tgetTelemetryConfiguration(): boolean {\n\t\treturn this._level === TelemetryLevel.USAGE;\n\t}\n\n\tgetTelemetryDetails(): TelemetryConfiguration {\n\t\treturn {\n\t\t\tisCrashEnabled: this._level >= TelemetryLevel.CRASH,\n\t\t\tisErrorsEnabled: this._productConfig.error ? this._level >= TelemetryLevel.ERROR : false,\n\t\t\tisUsageEnabled: this._productConfig.usage ? this._level >= TelemetryLevel.USAGE : false\n\t\t};\n\t}\n\n\t$initializeTelemetryLevel(level: TelemetryLevel, productConfig?: { usage: boolean; error: boolean }): void {\n\t\tthis._level = level;\n\t\tthis._productConfig = productConfig || { usage: true, error: true };\n\t}\n\n\t$onDidChangeTelemetryLevel(level: TelemetryLevel): void {\n\t\tthis._oldTelemetryEnablement = this.getTelemetryConfiguration();\n\t\tthis._level = level;\n\t\tif (this._oldTelemetryEnablement !== this.getTelemetryConfiguration()) {\n\t\t\tthis._onDidChangeTelemetryEnabled.fire(this.getTelemetryConfiguration());\n\t\t}\n\t\tthis._onDidChangeTelemetryConfiguration.fire(this.getTelemetryDetails());\n\t}\n}\n\nexport const IExtHostTelemetry = createDecorator<IExtHostTelemetry>('IExtHostTelemetry');\nexport interface IExtHostTelemetry extends ExtHostTelemetry, ExtHostTelemetryShape { }\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ExtHostTunnelServiceShape, TunnelDto } from 'vs/workbench/api/common/extHost.protocol';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport * as vscode from 'vscode';\nimport { ProvidedPortAttributes, RemoteTunnel, TunnelCreationOptions, TunnelOptions, TunnelPrivacyId } from 'vs/platform/tunnel/common/tunnel';\nimport { IDisposable } from 'vs/base/common/lifecycle';\nimport { Emitter } from 'vs/base/common/event';\nimport { IExtHostRpcService } from 'vs/workbench/api/common/extHostRpcService';\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { CandidatePort } from 'vs/workbench/services/remote/common/remoteExplorerService';\n\nexport namespace TunnelDtoConverter {\n\texport function fromApiTunnel(tunnel: vscode.Tunnel): TunnelDto {\n\t\treturn {\n\t\t\tremoteAddress: tunnel.remoteAddress,\n\t\t\tlocalAddress: tunnel.localAddress,\n\t\t\tpublic: !!tunnel.public,\n\t\t\tprivacy: tunnel.privacy ?? (tunnel.public ? TunnelPrivacyId.Public : TunnelPrivacyId.Private),\n\t\t\tprotocol: tunnel.protocol\n\t\t};\n\t}\n\texport function fromServiceTunnel(tunnel: RemoteTunnel): TunnelDto {\n\t\treturn {\n\t\t\tremoteAddress: {\n\t\t\t\thost: tunnel.tunnelRemoteHost,\n\t\t\t\tport: tunnel.tunnelRemotePort\n\t\t\t},\n\t\t\tlocalAddress: tunnel.localAddress,\n\t\t\tpublic: tunnel.privacy !== TunnelPrivacyId.ConstantPrivate && tunnel.privacy !== TunnelPrivacyId.ConstantPrivate,\n\t\t\tprivacy: tunnel.privacy,\n\t\t\tprotocol: tunnel.protocol\n\t\t};\n\t}\n}\n\nexport interface Tunnel extends vscode.Disposable {\n\tremote: { port: number; host: string };\n\tlocalAddress: string;\n}\n\nexport interface IExtHostTunnelService extends ExtHostTunnelServiceShape {\n\treadonly _serviceBrand: undefined;\n\topenTunnel(extension: IExtensionDescription, forward: TunnelOptions): Promise<vscode.Tunnel | undefined>;\n\tgetTunnels(): Promise<vscode.TunnelDescription[]>;\n\tonDidChangeTunnels: vscode.Event<void>;\n\tsetTunnelFactory(provider: vscode.RemoteAuthorityResolver | undefined): Promise<IDisposable>;\n\tregisterPortsAttributesProvider(portSelector: { pid?: number; portRange?: [number, number]; commandMatcher?: RegExp }, provider: vscode.PortAttributesProvider): IDisposable;\n}\n\nexport const IExtHostTunnelService = createDecorator<IExtHostTunnelService>('IExtHostTunnelService');\n\nexport class ExtHostTunnelService implements IExtHostTunnelService {\n\tdeclare readonly _serviceBrand: undefined;\n\tonDidChangeTunnels: vscode.Event<void> = (new Emitter<void>()).event;\n\n\tconstructor(\n\t\t@IExtHostRpcService extHostRpc: IExtHostRpcService,\n\t) {\n\t}\n\tasync $applyCandidateFilter(candidates: CandidatePort[]): Promise<CandidatePort[]> {\n\t\treturn candidates;\n\t}\n\n\tasync openTunnel(extension: IExtensionDescription, forward: TunnelOptions): Promise<vscode.Tunnel | undefined> {\n\t\treturn undefined;\n\t}\n\tasync getTunnels(): Promise<vscode.TunnelDescription[]> {\n\t\treturn [];\n\t}\n\tasync setTunnelFactory(provider: vscode.RemoteAuthorityResolver | undefined): Promise<IDisposable> {\n\t\treturn { dispose: () => { } };\n\t}\n\tregisterPortsAttributesProvider(portSelector: { pid?: number; portRange?: [number, number] }, provider: vscode.PortAttributesProvider) {\n\t\treturn { dispose: () => { } };\n\t}\n\n\tasync $providePortAttributes(handles: number[], ports: number[], pid: number | undefined, commandline: string | undefined, cancellationToken: vscode.CancellationToken): Promise<ProvidedPortAttributes[]> {\n\t\treturn [];\n\t}\n\n\tasync $forwardPort(tunnelOptions: TunnelOptions, tunnelCreationOptions: TunnelCreationOptions): Promise<TunnelDto | undefined> { return undefined; }\n\tasync $closeTunnel(remote: { host: string; port: number }): Promise<void> { }\n\tasync $onDidTunnelsChange(): Promise<void> { }\n\tasync $registerCandidateFinder(): Promise<void> { }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { asArray, coalesceInPlace, equals } from 'vs/base/common/arrays';\nimport { illegalArgument } from 'vs/base/common/errors';\nimport { IRelativePattern } from 'vs/base/common/glob';\nimport { MarkdownString as BaseMarkdownString } from 'vs/base/common/htmlContent';\nimport { ResourceMap } from 'vs/base/common/map';\nimport { Mimes, normalizeMimeType } from 'vs/base/common/mime';\nimport { nextCharLength } from 'vs/base/common/strings';\nimport { isArray, isString, isStringArray } from 'vs/base/common/types';\nimport { URI } from 'vs/base/common/uri';\nimport { generateUuid } from 'vs/base/common/uuid';\nimport { FileSystemProviderErrorCode, markAsFileSystemProviderError } from 'vs/platform/files/common/files';\nimport { RemoteAuthorityResolverErrorCode } from 'vs/platform/remote/common/remoteAuthorityResolver';\nimport { IRelativePatternDto } from 'vs/workbench/api/common/extHost.protocol';\nimport { CellEditType, ICellPartialMetadataEdit, IDocumentMetadataEdit } from 'vs/workbench/contrib/notebook/common/notebookCommon';\nimport type * as vscode from 'vscode';\n\n/**\n * @deprecated\n *\n * This utility ensures that old JS code that uses functions for classes still works. Existing usages cannot be removed\n * but new ones must not be added\n * */\nfunction es5ClassCompat(target: Function): any {\n\t///@ts-expect-error\n\tfunction _() { return Reflect.construct(target, arguments, this.constructor); }\n\tObject.defineProperty(_, 'name', Object.getOwnPropertyDescriptor(target, 'name')!);\n\tObject.setPrototypeOf(_, target);\n\tObject.setPrototypeOf(_.prototype, target.prototype);\n\treturn _;\n}\n\n@es5ClassCompat\nexport class Disposable {\n\n\tstatic from(...inDisposables: { dispose(): any }[]): Disposable {\n\t\tlet disposables: ReadonlyArray<{ dispose(): any }> | undefined = inDisposables;\n\t\treturn new Disposable(function () {\n\t\t\tif (disposables) {\n\t\t\t\tfor (const disposable of disposables) {\n\t\t\t\t\tif (disposable && typeof disposable.dispose === 'function') {\n\t\t\t\t\t\tdisposable.dispose();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdisposables = undefined;\n\t\t\t}\n\t\t});\n\t}\n\n\t#callOnDispose?: () => any;\n\n\tconstructor(callOnDispose: () => any) {\n\t\tthis.#callOnDispose = callOnDispose;\n\t}\n\n\tdispose(): any {\n\t\tif (typeof this.#callOnDispose === 'function') {\n\t\t\tthis.#callOnDispose();\n\t\t\tthis.#callOnDispose = undefined;\n\t\t}\n\t}\n}\n\n@es5ClassCompat\nexport class Position {\n\n\tstatic Min(...positions: Position[]): Position {\n\t\tif (positions.length === 0) {\n\t\t\tthrow new TypeError();\n\t\t}\n\t\tlet result = positions[0];\n\t\tfor (let i = 1; i < positions.length; i++) {\n\t\t\tconst p = positions[i];\n\t\t\tif (p.isBefore(result!)) {\n\t\t\t\tresult = p;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tstatic Max(...positions: Position[]): Position {\n\t\tif (positions.length === 0) {\n\t\t\tthrow new TypeError();\n\t\t}\n\t\tlet result = positions[0];\n\t\tfor (let i = 1; i < positions.length; i++) {\n\t\t\tconst p = positions[i];\n\t\t\tif (p.isAfter(result!)) {\n\t\t\t\tresult = p;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tstatic isPosition(other: any): other is Position {\n\t\tif (!other) {\n\t\t\treturn false;\n\t\t}\n\t\tif (other instanceof Position) {\n\t\t\treturn true;\n\t\t}\n\t\tconst { line, character } = <Position>other;\n\t\tif (typeof line === 'number' && typeof character === 'number') {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tstatic of(obj: vscode.Position): Position {\n\t\tif (obj instanceof Position) {\n\t\t\treturn obj;\n\t\t} else if (this.isPosition(obj)) {\n\t\t\treturn new Position(obj.line, obj.character);\n\t\t}\n\t\tthrow new Error('Invalid argument, is NOT a position-like object');\n\t}\n\n\tprivate _line: number;\n\tprivate _character: number;\n\n\tget line(): number {\n\t\treturn this._line;\n\t}\n\n\tget character(): number {\n\t\treturn this._character;\n\t}\n\n\tconstructor(line: number, character: number) {\n\t\tif (line < 0) {\n\t\t\tthrow illegalArgument('line must be non-negative');\n\t\t}\n\t\tif (character < 0) {\n\t\t\tthrow illegalArgument('character must be non-negative');\n\t\t}\n\t\tthis._line = line;\n\t\tthis._character = character;\n\t}\n\n\tisBefore(other: Position): boolean {\n\t\tif (this._line < other._line) {\n\t\t\treturn true;\n\t\t}\n\t\tif (other._line < this._line) {\n\t\t\treturn false;\n\t\t}\n\t\treturn this._character < other._character;\n\t}\n\n\tisBeforeOrEqual(other: Position): boolean {\n\t\tif (this._line < other._line) {\n\t\t\treturn true;\n\t\t}\n\t\tif (other._line < this._line) {\n\t\t\treturn false;\n\t\t}\n\t\treturn this._character <= other._character;\n\t}\n\n\tisAfter(other: Position): boolean {\n\t\treturn !this.isBeforeOrEqual(other);\n\t}\n\n\tisAfterOrEqual(other: Position): boolean {\n\t\treturn !this.isBefore(other);\n\t}\n\n\tisEqual(other: Position): boolean {\n\t\treturn this._line === other._line && this._character === other._character;\n\t}\n\n\tcompareTo(other: Position): number {\n\t\tif (this._line < other._line) {\n\t\t\treturn -1;\n\t\t} else if (this._line > other.line) {\n\t\t\treturn 1;\n\t\t} else {\n\t\t\t// equal line\n\t\t\tif (this._character < other._character) {\n\t\t\t\treturn -1;\n\t\t\t} else if (this._character > other._character) {\n\t\t\t\treturn 1;\n\t\t\t} else {\n\t\t\t\t// equal line and character\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t}\n\n\ttranslate(change: { lineDelta?: number; characterDelta?: number }): Position;\n\ttranslate(lineDelta?: number, characterDelta?: number): Position;\n\ttranslate(lineDeltaOrChange: number | undefined | { lineDelta?: number; characterDelta?: number }, characterDelta: number = 0): Position {\n\n\t\tif (lineDeltaOrChange === null || characterDelta === null) {\n\t\t\tthrow illegalArgument();\n\t\t}\n\n\t\tlet lineDelta: number;\n\t\tif (typeof lineDeltaOrChange === 'undefined') {\n\t\t\tlineDelta = 0;\n\t\t} else if (typeof lineDeltaOrChange === 'number') {\n\t\t\tlineDelta = lineDeltaOrChange;\n\t\t} else {\n\t\t\tlineDelta = typeof lineDeltaOrChange.lineDelta === 'number' ? lineDeltaOrChange.lineDelta : 0;\n\t\t\tcharacterDelta = typeof lineDeltaOrChange.characterDelta === 'number' ? lineDeltaOrChange.characterDelta : 0;\n\t\t}\n\n\t\tif (lineDelta === 0 && characterDelta === 0) {\n\t\t\treturn this;\n\t\t}\n\t\treturn new Position(this.line + lineDelta, this.character + characterDelta);\n\t}\n\n\twith(change: { line?: number; character?: number }): Position;\n\twith(line?: number, character?: number): Position;\n\twith(lineOrChange: number | undefined | { line?: number; character?: number }, character: number = this.character): Position {\n\n\t\tif (lineOrChange === null || character === null) {\n\t\t\tthrow illegalArgument();\n\t\t}\n\n\t\tlet line: number;\n\t\tif (typeof lineOrChange === 'undefined') {\n\t\t\tline = this.line;\n\n\t\t} else if (typeof lineOrChange === 'number') {\n\t\t\tline = lineOrChange;\n\n\t\t} else {\n\t\t\tline = typeof lineOrChange.line === 'number' ? lineOrChange.line : this.line;\n\t\t\tcharacter = typeof lineOrChange.character === 'number' ? lineOrChange.character : this.character;\n\t\t}\n\n\t\tif (line === this.line && character === this.character) {\n\t\t\treturn this;\n\t\t}\n\t\treturn new Position(line, character);\n\t}\n\n\ttoJSON(): any {\n\t\treturn { line: this.line, character: this.character };\n\t}\n}\n\n@es5ClassCompat\nexport class Range {\n\n\tstatic isRange(thing: any): thing is vscode.Range {\n\t\tif (thing instanceof Range) {\n\t\t\treturn true;\n\t\t}\n\t\tif (!thing) {\n\t\t\treturn false;\n\t\t}\n\t\treturn Position.isPosition((<Range>thing).start)\n\t\t\t&& Position.isPosition((<Range>thing.end));\n\t}\n\n\tstatic of(obj: vscode.Range): Range {\n\t\tif (obj instanceof Range) {\n\t\t\treturn obj;\n\t\t}\n\t\tif (this.isRange(obj)) {\n\t\t\treturn new Range(obj.start, obj.end);\n\t\t}\n\t\tthrow new Error('Invalid argument, is NOT a range-like object');\n\t}\n\n\tprotected _start: Position;\n\tprotected _end: Position;\n\n\tget start(): Position {\n\t\treturn this._start;\n\t}\n\n\tget end(): Position {\n\t\treturn this._end;\n\t}\n\n\tconstructor(start: vscode.Position, end: vscode.Position);\n\tconstructor(start: Position, end: Position);\n\tconstructor(startLine: number, startColumn: number, endLine: number, endColumn: number);\n\tconstructor(startLineOrStart: number | Position | vscode.Position, startColumnOrEnd: number | Position | vscode.Position, endLine?: number, endColumn?: number) {\n\t\tlet start: Position | undefined;\n\t\tlet end: Position | undefined;\n\n\t\tif (typeof startLineOrStart === 'number' && typeof startColumnOrEnd === 'number' && typeof endLine === 'number' && typeof endColumn === 'number') {\n\t\t\tstart = new Position(startLineOrStart, startColumnOrEnd);\n\t\t\tend = new Position(endLine, endColumn);\n\t\t} else if (Position.isPosition(startLineOrStart) && Position.isPosition(startColumnOrEnd)) {\n\t\t\tstart = Position.of(startLineOrStart);\n\t\t\tend = Position.of(startColumnOrEnd);\n\t\t}\n\n\t\tif (!start || !end) {\n\t\t\tthrow new Error('Invalid arguments');\n\t\t}\n\n\t\tif (start.isBefore(end)) {\n\t\t\tthis._start = start;\n\t\t\tthis._end = end;\n\t\t} else {\n\t\t\tthis._start = end;\n\t\t\tthis._end = start;\n\t\t}\n\t}\n\n\tcontains(positionOrRange: Position | Range): boolean {\n\t\tif (Range.isRange(positionOrRange)) {\n\t\t\treturn this.contains(positionOrRange.start)\n\t\t\t\t&& this.contains(positionOrRange.end);\n\n\t\t} else if (Position.isPosition(positionOrRange)) {\n\t\t\tif (Position.of(positionOrRange).isBefore(this._start)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (this._end.isBefore(positionOrRange)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tisEqual(other: Range): boolean {\n\t\treturn this._start.isEqual(other._start) && this._end.isEqual(other._end);\n\t}\n\n\tintersection(other: Range): Range | undefined {\n\t\tconst start = Position.Max(other.start, this._start);\n\t\tconst end = Position.Min(other.end, this._end);\n\t\tif (start.isAfter(end)) {\n\t\t\t// this happens when there is no overlap:\n\t\t\t// |-----|\n\t\t\t//          |----|\n\t\t\treturn undefined;\n\t\t}\n\t\treturn new Range(start, end);\n\t}\n\n\tunion(other: Range): Range {\n\t\tif (this.contains(other)) {\n\t\t\treturn this;\n\t\t} else if (other.contains(this)) {\n\t\t\treturn other;\n\t\t}\n\t\tconst start = Position.Min(other.start, this._start);\n\t\tconst end = Position.Max(other.end, this.end);\n\t\treturn new Range(start, end);\n\t}\n\n\tget isEmpty(): boolean {\n\t\treturn this._start.isEqual(this._end);\n\t}\n\n\tget isSingleLine(): boolean {\n\t\treturn this._start.line === this._end.line;\n\t}\n\n\twith(change: { start?: Position; end?: Position }): Range;\n\twith(start?: Position, end?: Position): Range;\n\twith(startOrChange: Position | undefined | { start?: Position; end?: Position }, end: Position = this.end): Range {\n\n\t\tif (startOrChange === null || end === null) {\n\t\t\tthrow illegalArgument();\n\t\t}\n\n\t\tlet start: Position;\n\t\tif (!startOrChange) {\n\t\t\tstart = this.start;\n\n\t\t} else if (Position.isPosition(startOrChange)) {\n\t\t\tstart = startOrChange;\n\n\t\t} else {\n\t\t\tstart = startOrChange.start || this.start;\n\t\t\tend = startOrChange.end || this.end;\n\t\t}\n\n\t\tif (start.isEqual(this._start) && end.isEqual(this.end)) {\n\t\t\treturn this;\n\t\t}\n\t\treturn new Range(start, end);\n\t}\n\n\ttoJSON(): any {\n\t\treturn [this.start, this.end];\n\t}\n}\n\n@es5ClassCompat\nexport class Selection extends Range {\n\n\tstatic isSelection(thing: any): thing is Selection {\n\t\tif (thing instanceof Selection) {\n\t\t\treturn true;\n\t\t}\n\t\tif (!thing) {\n\t\t\treturn false;\n\t\t}\n\t\treturn Range.isRange(thing)\n\t\t\t&& Position.isPosition((<Selection>thing).anchor)\n\t\t\t&& Position.isPosition((<Selection>thing).active)\n\t\t\t&& typeof (<Selection>thing).isReversed === 'boolean';\n\t}\n\n\tprivate _anchor: Position;\n\n\tpublic get anchor(): Position {\n\t\treturn this._anchor;\n\t}\n\n\tprivate _active: Position;\n\n\tpublic get active(): Position {\n\t\treturn this._active;\n\t}\n\n\tconstructor(anchor: Position, active: Position);\n\tconstructor(anchorLine: number, anchorColumn: number, activeLine: number, activeColumn: number);\n\tconstructor(anchorLineOrAnchor: number | Position, anchorColumnOrActive: number | Position, activeLine?: number, activeColumn?: number) {\n\t\tlet anchor: Position | undefined;\n\t\tlet active: Position | undefined;\n\n\t\tif (typeof anchorLineOrAnchor === 'number' && typeof anchorColumnOrActive === 'number' && typeof activeLine === 'number' && typeof activeColumn === 'number') {\n\t\t\tanchor = new Position(anchorLineOrAnchor, anchorColumnOrActive);\n\t\t\tactive = new Position(activeLine, activeColumn);\n\t\t} else if (Position.isPosition(anchorLineOrAnchor) && Position.isPosition(anchorColumnOrActive)) {\n\t\t\tanchor = Position.of(anchorLineOrAnchor);\n\t\t\tactive = Position.of(anchorColumnOrActive);\n\t\t}\n\n\t\tif (!anchor || !active) {\n\t\t\tthrow new Error('Invalid arguments');\n\t\t}\n\n\t\tsuper(anchor, active);\n\n\t\tthis._anchor = anchor;\n\t\tthis._active = active;\n\t}\n\n\tget isReversed(): boolean {\n\t\treturn this._anchor === this._end;\n\t}\n\n\toverride toJSON() {\n\t\treturn {\n\t\t\tstart: this.start,\n\t\t\tend: this.end,\n\t\t\tactive: this.active,\n\t\t\tanchor: this.anchor\n\t\t};\n\t}\n}\n\nexport class ResolvedAuthority {\n\treadonly host: string;\n\treadonly port: number;\n\treadonly connectionToken: string | undefined;\n\n\tconstructor(host: string, port: number, connectionToken?: string) {\n\t\tif (typeof host !== 'string' || host.length === 0) {\n\t\t\tthrow illegalArgument('host');\n\t\t}\n\t\tif (typeof port !== 'number' || port === 0 || Math.round(port) !== port) {\n\t\t\tthrow illegalArgument('port');\n\t\t}\n\t\tif (typeof connectionToken !== 'undefined') {\n\t\t\tif (typeof connectionToken !== 'string' || connectionToken.length === 0 || !/^[0-9A-Za-z\\-]+$/.test(connectionToken)) {\n\t\t\t\tthrow illegalArgument('connectionToken');\n\t\t\t}\n\t\t}\n\t\tthis.host = host;\n\t\tthis.port = Math.round(port);\n\t\tthis.connectionToken = connectionToken;\n\t}\n}\n\nexport class RemoteAuthorityResolverError extends Error {\n\n\tstatic NotAvailable(message?: string, handled?: boolean): RemoteAuthorityResolverError {\n\t\treturn new RemoteAuthorityResolverError(message, RemoteAuthorityResolverErrorCode.NotAvailable, handled);\n\t}\n\n\tstatic TemporarilyNotAvailable(message?: string): RemoteAuthorityResolverError {\n\t\treturn new RemoteAuthorityResolverError(message, RemoteAuthorityResolverErrorCode.TemporarilyNotAvailable);\n\t}\n\n\tpublic readonly _message: string | undefined;\n\tpublic readonly _code: RemoteAuthorityResolverErrorCode;\n\tpublic readonly _detail: any;\n\n\tconstructor(message?: string, code: RemoteAuthorityResolverErrorCode = RemoteAuthorityResolverErrorCode.Unknown, detail?: any) {\n\t\tsuper(message);\n\n\t\tthis._message = message;\n\t\tthis._code = code;\n\t\tthis._detail = detail;\n\n\t\t// workaround when extending builtin objects and when compiling to ES5, see:\n\t\t// https://github.com/microsoft/TypeScript-wiki/blob/master/Breaking-Changes.md#extending-built-ins-like-error-array-and-map-may-no-longer-work\n\t\tif (typeof (<any>Object).setPrototypeOf === 'function') {\n\t\t\t(<any>Object).setPrototypeOf(this, RemoteAuthorityResolverError.prototype);\n\t\t}\n\t}\n}\n\nexport enum EndOfLine {\n\tLF = 1,\n\tCRLF = 2\n}\n\nexport enum EnvironmentVariableMutatorType {\n\tReplace = 1,\n\tAppend = 2,\n\tPrepend = 3\n}\n\n@es5ClassCompat\nexport class TextEdit {\n\n\tstatic isTextEdit(thing: any): thing is TextEdit {\n\t\tif (thing instanceof TextEdit) {\n\t\t\treturn true;\n\t\t}\n\t\tif (!thing) {\n\t\t\treturn false;\n\t\t}\n\t\treturn Range.isRange((<TextEdit>thing))\n\t\t\t&& typeof (<TextEdit>thing).newText === 'string';\n\t}\n\n\tstatic replace(range: Range, newText: string): TextEdit {\n\t\treturn new TextEdit(range, newText);\n\t}\n\n\tstatic insert(position: Position, newText: string): TextEdit {\n\t\treturn TextEdit.replace(new Range(position, position), newText);\n\t}\n\n\tstatic delete(range: Range): TextEdit {\n\t\treturn TextEdit.replace(range, '');\n\t}\n\n\tstatic setEndOfLine(eol: EndOfLine): TextEdit {\n\t\tconst ret = new TextEdit(new Range(new Position(0, 0), new Position(0, 0)), '');\n\t\tret.newEol = eol;\n\t\treturn ret;\n\t}\n\n\tprotected _range: Range;\n\tprotected _newText: string | null;\n\tprotected _newEol?: EndOfLine;\n\n\tget range(): Range {\n\t\treturn this._range;\n\t}\n\n\tset range(value: Range) {\n\t\tif (value && !Range.isRange(value)) {\n\t\t\tthrow illegalArgument('range');\n\t\t}\n\t\tthis._range = value;\n\t}\n\n\tget newText(): string {\n\t\treturn this._newText || '';\n\t}\n\n\tset newText(value: string) {\n\t\tif (value && typeof value !== 'string') {\n\t\t\tthrow illegalArgument('newText');\n\t\t}\n\t\tthis._newText = value;\n\t}\n\n\tget newEol(): EndOfLine | undefined {\n\t\treturn this._newEol;\n\t}\n\n\tset newEol(value: EndOfLine | undefined) {\n\t\tif (value && typeof value !== 'number') {\n\t\t\tthrow illegalArgument('newEol');\n\t\t}\n\t\tthis._newEol = value;\n\t}\n\n\tconstructor(range: Range, newText: string | null) {\n\t\tthis._range = range;\n\t\tthis._newText = newText;\n\t}\n\n\ttoJSON(): any {\n\t\treturn {\n\t\t\trange: this.range,\n\t\t\tnewText: this.newText,\n\t\t\tnewEol: this._newEol\n\t\t};\n\t}\n}\n\n@es5ClassCompat\nexport class NotebookEdit implements vscode.NotebookEdit {\n\n\tstatic isNotebookCellEdit(thing: any): thing is NotebookEdit {\n\t\tif (thing instanceof NotebookEdit) {\n\t\t\treturn true;\n\t\t}\n\t\tif (!thing) {\n\t\t\treturn false;\n\t\t}\n\t\treturn NotebookRange.isNotebookRange((<NotebookEdit>thing))\n\t\t\t&& Array.isArray((<NotebookEdit>thing).newCells);\n\t}\n\n\tstatic replaceCells(range: NotebookRange, newCells: NotebookCellData[]): NotebookEdit {\n\t\treturn new NotebookEdit(range, newCells);\n\t}\n\n\tstatic insertCells(index: number, newCells: vscode.NotebookCellData[]): vscode.NotebookEdit {\n\t\treturn new NotebookEdit(new NotebookRange(index, index), newCells);\n\t}\n\n\tstatic deleteCells(range: NotebookRange): NotebookEdit {\n\t\treturn new NotebookEdit(range, []);\n\t}\n\n\tstatic updateCellMetadata(index: number, newMetadata: { [key: string]: any }): NotebookEdit {\n\t\tconst edit = new NotebookEdit(new NotebookRange(index, index), []);\n\t\tedit.newCellMetadata = newMetadata;\n\t\treturn edit;\n\t}\n\n\tstatic updateNotebookMetadata(newMetadata: { [key: string]: any }): NotebookEdit {\n\t\tconst edit = new NotebookEdit(new NotebookRange(0, 0), []);\n\t\tedit.newNotebookMetadata = newMetadata;\n\t\treturn edit;\n\t}\n\n\trange: NotebookRange;\n\tnewCells: NotebookCellData[];\n\tnewCellMetadata?: { [key: string]: any };\n\tnewNotebookMetadata?: { [key: string]: any };\n\n\tconstructor(range: NotebookRange, newCells: NotebookCellData[]) {\n\t\tthis.range = range;\n\t\tthis.newCells = newCells;\n\t}\n}\n\nexport interface IFileOperationOptions {\n\toverwrite?: boolean;\n\tignoreIfExists?: boolean;\n\tignoreIfNotExists?: boolean;\n\trecursive?: boolean;\n}\n\nexport const enum FileEditType {\n\tFile = 1,\n\tText = 2,\n\tCell = 3,\n\tCellReplace = 5,\n\tSnippet = 6,\n}\n\nexport interface IFileOperation {\n\t_type: FileEditType.File;\n\tfrom?: URI;\n\tto?: URI;\n\toptions?: IFileOperationOptions;\n\tmetadata?: vscode.WorkspaceEditEntryMetadata;\n}\n\nexport interface IFileTextEdit {\n\t_type: FileEditType.Text;\n\turi: URI;\n\tedit: TextEdit;\n\tmetadata?: vscode.WorkspaceEditEntryMetadata;\n}\n\nexport interface IFileSnippetTextEdit {\n\t_type: FileEditType.Snippet;\n\turi: URI;\n\trange: vscode.Range;\n\tedit: vscode.SnippetString;\n\tmetadata?: vscode.WorkspaceEditEntryMetadata;\n}\n\nexport interface IFileCellEdit {\n\t_type: FileEditType.Cell;\n\turi: URI;\n\tedit?: ICellPartialMetadataEdit | IDocumentMetadataEdit;\n\tnotebookMetadata?: Record<string, any>;\n\tmetadata?: vscode.WorkspaceEditEntryMetadata;\n}\n\nexport interface ICellEdit {\n\t_type: FileEditType.CellReplace;\n\tmetadata?: vscode.WorkspaceEditEntryMetadata;\n\turi: URI;\n\tindex: number;\n\tcount: number;\n\tcells: vscode.NotebookCellData[];\n}\n\n\ntype WorkspaceEditEntry = IFileOperation | IFileTextEdit | IFileSnippetTextEdit | IFileCellEdit | ICellEdit;\n\n@es5ClassCompat\nexport class WorkspaceEdit implements vscode.WorkspaceEdit {\n\n\tprivate readonly _edits: WorkspaceEditEntry[] = [];\n\n\n\t_allEntries(): ReadonlyArray<WorkspaceEditEntry> {\n\t\treturn this._edits;\n\t}\n\n\t// --- file\n\n\trenameFile(from: vscode.Uri, to: vscode.Uri, options?: { overwrite?: boolean; ignoreIfExists?: boolean }, metadata?: vscode.WorkspaceEditEntryMetadata): void {\n\t\tthis._edits.push({ _type: FileEditType.File, from, to, options, metadata });\n\t}\n\n\tcreateFile(uri: vscode.Uri, options?: { overwrite?: boolean; ignoreIfExists?: boolean }, metadata?: vscode.WorkspaceEditEntryMetadata): void {\n\t\tthis._edits.push({ _type: FileEditType.File, from: undefined, to: uri, options, metadata });\n\t}\n\n\tdeleteFile(uri: vscode.Uri, options?: { recursive?: boolean; ignoreIfNotExists?: boolean }, metadata?: vscode.WorkspaceEditEntryMetadata): void {\n\t\tthis._edits.push({ _type: FileEditType.File, from: uri, to: undefined, options, metadata });\n\t}\n\n\t// --- notebook\n\n\treplaceNotebookMetadata(uri: URI, value: Record<string, any>, metadata?: vscode.WorkspaceEditEntryMetadata): void {\n\t\tthis._edits.push({ _type: FileEditType.Cell, metadata, uri, edit: { editType: CellEditType.DocumentMetadata, metadata: value }, notebookMetadata: value });\n\t}\n\n\treplaceNotebookCells(uri: URI, range: vscode.NotebookRange, cells: vscode.NotebookCellData[], metadata?: vscode.WorkspaceEditEntryMetadata): void;\n\treplaceNotebookCells(uri: URI, start: number, end: number, cells: vscode.NotebookCellData[], metadata?: vscode.WorkspaceEditEntryMetadata): void;\n\treplaceNotebookCells(uri: URI, startOrRange: number | vscode.NotebookRange, endOrCells: number | vscode.NotebookCellData[], cellsOrMetadata?: vscode.NotebookCellData[] | vscode.WorkspaceEditEntryMetadata, metadata?: vscode.WorkspaceEditEntryMetadata): void {\n\t\tlet start: number | undefined;\n\t\tlet end: number | undefined;\n\t\tlet cellData: vscode.NotebookCellData[] = [];\n\t\tlet workspaceEditMetadata: vscode.WorkspaceEditEntryMetadata | undefined;\n\n\t\tif (NotebookRange.isNotebookRange(startOrRange) && NotebookCellData.isNotebookCellDataArray(endOrCells) && !NotebookCellData.isNotebookCellDataArray(cellsOrMetadata)) {\n\t\t\tstart = startOrRange.start;\n\t\t\tend = startOrRange.end;\n\t\t\tcellData = endOrCells;\n\t\t\tworkspaceEditMetadata = cellsOrMetadata;\n\t\t} else if (typeof startOrRange === 'number' && typeof endOrCells === 'number' && NotebookCellData.isNotebookCellDataArray(cellsOrMetadata)) {\n\t\t\tstart = startOrRange;\n\t\t\tend = endOrCells;\n\t\t\tcellData = cellsOrMetadata;\n\t\t\tworkspaceEditMetadata = metadata;\n\t\t}\n\n\t\tif (start === undefined || end === undefined) {\n\t\t\tthrow new Error('Invalid arguments');\n\t\t}\n\n\t\tif (start !== end || cellData.length > 0) {\n\t\t\tthis._edits.push({ _type: FileEditType.CellReplace, uri, index: start, count: end - start, cells: cellData, metadata: workspaceEditMetadata });\n\t\t}\n\t}\n\n\treplaceNotebookCellMetadata(uri: URI, index: number, cellMetadata: Record<string, any>, metadata?: vscode.WorkspaceEditEntryMetadata): void {\n\t\tthis._edits.push({ _type: FileEditType.Cell, metadata, uri, edit: { editType: CellEditType.PartialMetadata, index, metadata: cellMetadata } });\n\t}\n\n\t// --- text\n\n\treplace(uri: URI, range: Range, newText: string | vscode.SnippetString, metadata?: vscode.WorkspaceEditEntryMetadata): void {\n\t\tif (typeof newText === 'string') {\n\t\t\tthis._edits.push({ _type: FileEditType.Text, uri, edit: new TextEdit(range, newText), metadata });\n\t\t} else {\n\t\t\tthis._edits.push({ _type: FileEditType.Snippet, uri, range, edit: newText, metadata });\n\t\t}\n\t}\n\n\tinsert(resource: URI, position: Position, newText: string, metadata?: vscode.WorkspaceEditEntryMetadata): void {\n\t\tthis.replace(resource, new Range(position, position), newText, metadata);\n\t}\n\n\tdelete(resource: URI, range: Range, metadata?: vscode.WorkspaceEditEntryMetadata): void {\n\t\tthis.replace(resource, range, '', metadata);\n\t}\n\n\t// --- text (Maplike)\n\n\thas(uri: URI): boolean {\n\t\treturn this._edits.some(edit => edit._type === FileEditType.Text && edit.uri.toString() === uri.toString());\n\t}\n\n\tset(uri: URI, edits: TextEdit[] | unknown): void {\n\t\tif (!edits) {\n\t\t\t// remove all text edits for `uri`\n\t\t\tfor (let i = 0; i < this._edits.length; i++) {\n\t\t\t\tconst element = this._edits[i];\n\t\t\t\tif (element._type === FileEditType.Text && element.uri.toString() === uri.toString()) {\n\t\t\t\t\tthis._edits[i] = undefined!; // will be coalesced down below\n\t\t\t\t}\n\t\t\t}\n\t\t\tcoalesceInPlace(this._edits);\n\t\t} else {\n\t\t\t// append edit to the end\n\t\t\tfor (const edit of edits as TextEdit[] | NotebookEdit[]) {\n\t\t\t\tif (edit) {\n\t\t\t\t\tif (NotebookEdit.isNotebookCellEdit(edit)) {\n\t\t\t\t\t\tif (edit.newCellMetadata) {\n\t\t\t\t\t\t\tthis.replaceNotebookCellMetadata(uri, edit.range.start, edit.newCellMetadata);\n\t\t\t\t\t\t} else if (edit.newNotebookMetadata) {\n\t\t\t\t\t\t\tthis.replaceNotebookMetadata(uri, edit.newNotebookMetadata);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.replaceNotebookCells(uri, edit.range, edit.newCells);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._edits.push({ _type: FileEditType.Text, uri, edit });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tget(uri: URI): TextEdit[] {\n\t\tconst res: TextEdit[] = [];\n\t\tfor (const candidate of this._edits) {\n\t\t\tif (candidate._type === FileEditType.Text && candidate.uri.toString() === uri.toString()) {\n\t\t\t\tres.push(candidate.edit);\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t}\n\n\tentries(): [URI, TextEdit[]][] {\n\t\tconst textEdits = new ResourceMap<[URI, TextEdit[]]>();\n\t\tfor (const candidate of this._edits) {\n\t\t\tif (candidate._type === FileEditType.Text) {\n\t\t\t\tlet textEdit = textEdits.get(candidate.uri);\n\t\t\t\tif (!textEdit) {\n\t\t\t\t\ttextEdit = [candidate.uri, []];\n\t\t\t\t\ttextEdits.set(candidate.uri, textEdit);\n\t\t\t\t}\n\t\t\t\ttextEdit[1].push(candidate.edit);\n\t\t\t}\n\t\t}\n\t\treturn [...textEdits.values()];\n\t}\n\n\tget size(): number {\n\t\treturn this.entries().length;\n\t}\n\n\ttoJSON(): any {\n\t\treturn this.entries();\n\t}\n}\n\n@es5ClassCompat\nexport class SnippetString {\n\n\tstatic isSnippetString(thing: any): thing is SnippetString {\n\t\tif (thing instanceof SnippetString) {\n\t\t\treturn true;\n\t\t}\n\t\tif (!thing) {\n\t\t\treturn false;\n\t\t}\n\t\treturn typeof (<SnippetString>thing).value === 'string';\n\t}\n\n\tprivate static _escape(value: string): string {\n\t\treturn value.replace(/\\$|}|\\\\/g, '\\\\$&');\n\t}\n\n\tprivate _tabstop: number = 1;\n\n\tvalue: string;\n\n\tconstructor(value?: string) {\n\t\tthis.value = value || '';\n\t}\n\n\tappendText(string: string): SnippetString {\n\t\tthis.value += SnippetString._escape(string);\n\t\treturn this;\n\t}\n\n\tappendTabstop(number: number = this._tabstop++): SnippetString {\n\t\tthis.value += '$';\n\t\tthis.value += number;\n\t\treturn this;\n\t}\n\n\tappendPlaceholder(value: string | ((snippet: SnippetString) => any), number: number = this._tabstop++): SnippetString {\n\n\t\tif (typeof value === 'function') {\n\t\t\tconst nested = new SnippetString();\n\t\t\tnested._tabstop = this._tabstop;\n\t\t\tvalue(nested);\n\t\t\tthis._tabstop = nested._tabstop;\n\t\t\tvalue = nested.value;\n\t\t} else {\n\t\t\tvalue = SnippetString._escape(value);\n\t\t}\n\n\t\tthis.value += '${';\n\t\tthis.value += number;\n\t\tthis.value += ':';\n\t\tthis.value += value;\n\t\tthis.value += '}';\n\n\t\treturn this;\n\t}\n\n\tappendChoice(values: string[], number: number = this._tabstop++): SnippetString {\n\t\tconst value = values.map(s => s.replace(/\\$|}|\\\\|,/g, '\\\\$&')).join(',');\n\n\t\tthis.value += '${';\n\t\tthis.value += number;\n\t\tthis.value += '|';\n\t\tthis.value += value;\n\t\tthis.value += '|}';\n\n\t\treturn this;\n\t}\n\n\tappendVariable(name: string, defaultValue?: string | ((snippet: SnippetString) => any)): SnippetString {\n\n\t\tif (typeof defaultValue === 'function') {\n\t\t\tconst nested = new SnippetString();\n\t\t\tnested._tabstop = this._tabstop;\n\t\t\tdefaultValue(nested);\n\t\t\tthis._tabstop = nested._tabstop;\n\t\t\tdefaultValue = nested.value;\n\n\t\t} else if (typeof defaultValue === 'string') {\n\t\t\tdefaultValue = defaultValue.replace(/\\$|}/g, '\\\\$&');\n\t\t}\n\n\t\tthis.value += '${';\n\t\tthis.value += name;\n\t\tif (defaultValue) {\n\t\t\tthis.value += ':';\n\t\t\tthis.value += defaultValue;\n\t\t}\n\t\tthis.value += '}';\n\n\n\t\treturn this;\n\t}\n}\n\nexport enum DiagnosticTag {\n\tUnnecessary = 1,\n\tDeprecated = 2\n}\n\nexport enum DiagnosticSeverity {\n\tHint = 3,\n\tInformation = 2,\n\tWarning = 1,\n\tError = 0\n}\n\n@es5ClassCompat\nexport class Location {\n\n\tstatic isLocation(thing: any): thing is vscode.Location {\n\t\tif (thing instanceof Location) {\n\t\t\treturn true;\n\t\t}\n\t\tif (!thing) {\n\t\t\treturn false;\n\t\t}\n\t\treturn Range.isRange((<Location>thing).range)\n\t\t\t&& URI.isUri((<Location>thing).uri);\n\t}\n\n\turi: URI;\n\trange!: Range;\n\n\tconstructor(uri: URI, rangeOrPosition: Range | Position) {\n\t\tthis.uri = uri;\n\n\t\tif (!rangeOrPosition) {\n\t\t\t//that's OK\n\t\t} else if (Range.isRange(rangeOrPosition)) {\n\t\t\tthis.range = Range.of(rangeOrPosition);\n\t\t} else if (Position.isPosition(rangeOrPosition)) {\n\t\t\tthis.range = new Range(rangeOrPosition, rangeOrPosition);\n\t\t} else {\n\t\t\tthrow new Error('Illegal argument');\n\t\t}\n\t}\n\n\ttoJSON(): any {\n\t\treturn {\n\t\t\turi: this.uri,\n\t\t\trange: this.range\n\t\t};\n\t}\n}\n\n@es5ClassCompat\nexport class DiagnosticRelatedInformation {\n\n\tstatic is(thing: any): thing is DiagnosticRelatedInformation {\n\t\tif (!thing) {\n\t\t\treturn false;\n\t\t}\n\t\treturn typeof (<DiagnosticRelatedInformation>thing).message === 'string'\n\t\t\t&& (<DiagnosticRelatedInformation>thing).location\n\t\t\t&& Range.isRange((<DiagnosticRelatedInformation>thing).location.range)\n\t\t\t&& URI.isUri((<DiagnosticRelatedInformation>thing).location.uri);\n\t}\n\n\tlocation: Location;\n\tmessage: string;\n\n\tconstructor(location: Location, message: string) {\n\t\tthis.location = location;\n\t\tthis.message = message;\n\t}\n\n\tstatic isEqual(a: DiagnosticRelatedInformation, b: DiagnosticRelatedInformation): boolean {\n\t\tif (a === b) {\n\t\t\treturn true;\n\t\t}\n\t\tif (!a || !b) {\n\t\t\treturn false;\n\t\t}\n\t\treturn a.message === b.message\n\t\t\t&& a.location.range.isEqual(b.location.range)\n\t\t\t&& a.location.uri.toString() === b.location.uri.toString();\n\t}\n}\n\n@es5ClassCompat\nexport class Diagnostic {\n\n\trange: Range;\n\tmessage: string;\n\tseverity: DiagnosticSeverity;\n\tsource?: string;\n\tcode?: string | number;\n\trelatedInformation?: DiagnosticRelatedInformation[];\n\ttags?: DiagnosticTag[];\n\n\tconstructor(range: Range, message: string, severity: DiagnosticSeverity = DiagnosticSeverity.Error) {\n\t\tif (!Range.isRange(range)) {\n\t\t\tthrow new TypeError('range must be set');\n\t\t}\n\t\tif (!message) {\n\t\t\tthrow new TypeError('message must be set');\n\t\t}\n\t\tthis.range = range;\n\t\tthis.message = message;\n\t\tthis.severity = severity;\n\t}\n\n\ttoJSON(): any {\n\t\treturn {\n\t\t\tseverity: DiagnosticSeverity[this.severity],\n\t\t\tmessage: this.message,\n\t\t\trange: this.range,\n\t\t\tsource: this.source,\n\t\t\tcode: this.code,\n\t\t};\n\t}\n\n\tstatic isEqual(a: Diagnostic | undefined, b: Diagnostic | undefined): boolean {\n\t\tif (a === b) {\n\t\t\treturn true;\n\t\t}\n\t\tif (!a || !b) {\n\t\t\treturn false;\n\t\t}\n\t\treturn a.message === b.message\n\t\t\t&& a.severity === b.severity\n\t\t\t&& a.code === b.code\n\t\t\t&& a.severity === b.severity\n\t\t\t&& a.source === b.source\n\t\t\t&& a.range.isEqual(b.range)\n\t\t\t&& equals(a.tags, b.tags)\n\t\t\t&& equals(a.relatedInformation, b.relatedInformation, DiagnosticRelatedInformation.isEqual);\n\t}\n}\n\n@es5ClassCompat\nexport class Hover {\n\n\tpublic contents: (vscode.MarkdownString | vscode.MarkedString)[];\n\tpublic range: Range | undefined;\n\n\tconstructor(\n\t\tcontents: vscode.MarkdownString | vscode.MarkedString | (vscode.MarkdownString | vscode.MarkedString)[],\n\t\trange?: Range\n\t) {\n\t\tif (!contents) {\n\t\t\tthrow new Error('Illegal argument, contents must be defined');\n\t\t}\n\t\tif (Array.isArray(contents)) {\n\t\t\tthis.contents = contents;\n\t\t} else {\n\t\t\tthis.contents = [contents];\n\t\t}\n\t\tthis.range = range;\n\t}\n}\n\nexport enum DocumentHighlightKind {\n\tText = 0,\n\tRead = 1,\n\tWrite = 2\n}\n\n@es5ClassCompat\nexport class DocumentHighlight {\n\n\trange: Range;\n\tkind: DocumentHighlightKind;\n\n\tconstructor(range: Range, kind: DocumentHighlightKind = DocumentHighlightKind.Text) {\n\t\tthis.range = range;\n\t\tthis.kind = kind;\n\t}\n\n\ttoJSON(): any {\n\t\treturn {\n\t\t\trange: this.range,\n\t\t\tkind: DocumentHighlightKind[this.kind]\n\t\t};\n\t}\n}\n\nexport enum SymbolKind {\n\tFile = 0,\n\tModule = 1,\n\tNamespace = 2,\n\tPackage = 3,\n\tClass = 4,\n\tMethod = 5,\n\tProperty = 6,\n\tField = 7,\n\tConstructor = 8,\n\tEnum = 9,\n\tInterface = 10,\n\tFunction = 11,\n\tVariable = 12,\n\tConstant = 13,\n\tString = 14,\n\tNumber = 15,\n\tBoolean = 16,\n\tArray = 17,\n\tObject = 18,\n\tKey = 19,\n\tNull = 20,\n\tEnumMember = 21,\n\tStruct = 22,\n\tEvent = 23,\n\tOperator = 24,\n\tTypeParameter = 25\n}\n\nexport enum SymbolTag {\n\tDeprecated = 1,\n}\n\n@es5ClassCompat\nexport class SymbolInformation {\n\n\tstatic validate(candidate: SymbolInformation): void {\n\t\tif (!candidate.name) {\n\t\t\tthrow new Error('name must not be falsy');\n\t\t}\n\t}\n\n\tname: string;\n\tlocation!: Location;\n\tkind: SymbolKind;\n\ttags?: SymbolTag[];\n\tcontainerName: string | undefined;\n\n\tconstructor(name: string, kind: SymbolKind, containerName: string | undefined, location: Location);\n\tconstructor(name: string, kind: SymbolKind, range: Range, uri?: URI, containerName?: string);\n\tconstructor(name: string, kind: SymbolKind, rangeOrContainer: string | undefined | Range, locationOrUri?: Location | URI, containerName?: string) {\n\t\tthis.name = name;\n\t\tthis.kind = kind;\n\t\tthis.containerName = containerName;\n\n\t\tif (typeof rangeOrContainer === 'string') {\n\t\t\tthis.containerName = rangeOrContainer;\n\t\t}\n\n\t\tif (locationOrUri instanceof Location) {\n\t\t\tthis.location = locationOrUri;\n\t\t} else if (rangeOrContainer instanceof Range) {\n\t\t\tthis.location = new Location(locationOrUri!, rangeOrContainer);\n\t\t}\n\n\t\tSymbolInformation.validate(this);\n\t}\n\n\ttoJSON(): any {\n\t\treturn {\n\t\t\tname: this.name,\n\t\t\tkind: SymbolKind[this.kind],\n\t\t\tlocation: this.location,\n\t\t\tcontainerName: this.containerName\n\t\t};\n\t}\n}\n\n@es5ClassCompat\nexport class DocumentSymbol {\n\n\tstatic validate(candidate: DocumentSymbol): void {\n\t\tif (!candidate.name) {\n\t\t\tthrow new Error('name must not be falsy');\n\t\t}\n\t\tif (!candidate.range.contains(candidate.selectionRange)) {\n\t\t\tthrow new Error('selectionRange must be contained in fullRange');\n\t\t}\n\t\tcandidate.children?.forEach(DocumentSymbol.validate);\n\t}\n\n\tname: string;\n\tdetail: string;\n\tkind: SymbolKind;\n\ttags?: SymbolTag[];\n\trange: Range;\n\tselectionRange: Range;\n\tchildren: DocumentSymbol[];\n\n\tconstructor(name: string, detail: string, kind: SymbolKind, range: Range, selectionRange: Range) {\n\t\tthis.name = name;\n\t\tthis.detail = detail;\n\t\tthis.kind = kind;\n\t\tthis.range = range;\n\t\tthis.selectionRange = selectionRange;\n\t\tthis.children = [];\n\n\t\tDocumentSymbol.validate(this);\n\t}\n}\n\n\nexport enum CodeActionTriggerKind {\n\tInvoke = 1,\n\tAutomatic = 2,\n}\n\n@es5ClassCompat\nexport class CodeAction {\n\ttitle: string;\n\n\tcommand?: vscode.Command;\n\n\tedit?: WorkspaceEdit;\n\n\tdiagnostics?: Diagnostic[];\n\n\tkind?: CodeActionKind;\n\n\tisPreferred?: boolean;\n\n\tconstructor(title: string, kind?: CodeActionKind) {\n\t\tthis.title = title;\n\t\tthis.kind = kind;\n\t}\n}\n\n\n@es5ClassCompat\nexport class CodeActionKind {\n\tprivate static readonly sep = '.';\n\n\tpublic static Empty: CodeActionKind;\n\tpublic static QuickFix: CodeActionKind;\n\tpublic static Refactor: CodeActionKind;\n\tpublic static RefactorExtract: CodeActionKind;\n\tpublic static RefactorInline: CodeActionKind;\n\tpublic static RefactorRewrite: CodeActionKind;\n\tpublic static Source: CodeActionKind;\n\tpublic static SourceOrganizeImports: CodeActionKind;\n\tpublic static SourceFixAll: CodeActionKind;\n\n\tconstructor(\n\t\tpublic readonly value: string\n\t) { }\n\n\tpublic append(parts: string): CodeActionKind {\n\t\treturn new CodeActionKind(this.value ? this.value + CodeActionKind.sep + parts : parts);\n\t}\n\n\tpublic intersects(other: CodeActionKind): boolean {\n\t\treturn this.contains(other) || other.contains(this);\n\t}\n\n\tpublic contains(other: CodeActionKind): boolean {\n\t\treturn this.value === other.value || other.value.startsWith(this.value + CodeActionKind.sep);\n\t}\n}\nCodeActionKind.Empty = new CodeActionKind('');\nCodeActionKind.QuickFix = CodeActionKind.Empty.append('quickfix');\nCodeActionKind.Refactor = CodeActionKind.Empty.append('refactor');\nCodeActionKind.RefactorExtract = CodeActionKind.Refactor.append('extract');\nCodeActionKind.RefactorInline = CodeActionKind.Refactor.append('inline');\nCodeActionKind.RefactorRewrite = CodeActionKind.Refactor.append('rewrite');\nCodeActionKind.Source = CodeActionKind.Empty.append('source');\nCodeActionKind.SourceOrganizeImports = CodeActionKind.Source.append('organizeImports');\nCodeActionKind.SourceFixAll = CodeActionKind.Source.append('fixAll');\n\n@es5ClassCompat\nexport class SelectionRange {\n\n\trange: Range;\n\tparent?: SelectionRange;\n\n\tconstructor(range: Range, parent?: SelectionRange) {\n\t\tthis.range = range;\n\t\tthis.parent = parent;\n\n\t\tif (parent && !parent.range.contains(this.range)) {\n\t\t\tthrow new Error('Invalid argument: parent must contain this range');\n\t\t}\n\t}\n}\n\nexport class CallHierarchyItem {\n\n\t_sessionId?: string;\n\t_itemId?: string;\n\n\tkind: SymbolKind;\n\ttags?: SymbolTag[];\n\tname: string;\n\tdetail?: string;\n\turi: URI;\n\trange: Range;\n\tselectionRange: Range;\n\n\tconstructor(kind: SymbolKind, name: string, detail: string, uri: URI, range: Range, selectionRange: Range) {\n\t\tthis.kind = kind;\n\t\tthis.name = name;\n\t\tthis.detail = detail;\n\t\tthis.uri = uri;\n\t\tthis.range = range;\n\t\tthis.selectionRange = selectionRange;\n\t}\n}\n\nexport class CallHierarchyIncomingCall {\n\n\tfrom: vscode.CallHierarchyItem;\n\tfromRanges: vscode.Range[];\n\n\tconstructor(item: vscode.CallHierarchyItem, fromRanges: vscode.Range[]) {\n\t\tthis.fromRanges = fromRanges;\n\t\tthis.from = item;\n\t}\n}\nexport class CallHierarchyOutgoingCall {\n\n\tto: vscode.CallHierarchyItem;\n\tfromRanges: vscode.Range[];\n\n\tconstructor(item: vscode.CallHierarchyItem, fromRanges: vscode.Range[]) {\n\t\tthis.fromRanges = fromRanges;\n\t\tthis.to = item;\n\t}\n}\n\nexport enum LanguageStatusSeverity {\n\tInformation = 0,\n\tWarning = 1,\n\tError = 2\n}\n\n\n@es5ClassCompat\nexport class CodeLens {\n\n\trange: Range;\n\n\tcommand: vscode.Command | undefined;\n\n\tconstructor(range: Range, command?: vscode.Command) {\n\t\tthis.range = range;\n\t\tthis.command = command;\n\t}\n\n\tget isResolved(): boolean {\n\t\treturn !!this.command;\n\t}\n}\n\n@es5ClassCompat\nexport class MarkdownString implements vscode.MarkdownString {\n\n\treadonly #delegate: BaseMarkdownString;\n\n\tstatic isMarkdownString(thing: any): thing is vscode.MarkdownString {\n\t\tif (thing instanceof MarkdownString) {\n\t\t\treturn true;\n\t\t}\n\t\treturn thing && thing.appendCodeblock && thing.appendMarkdown && thing.appendText && (thing.value !== undefined);\n\t}\n\n\tconstructor(value?: string, supportThemeIcons: boolean = false) {\n\t\tthis.#delegate = new BaseMarkdownString(value, { supportThemeIcons });\n\t}\n\n\tget value(): string {\n\t\treturn this.#delegate.value;\n\t}\n\tset value(value: string) {\n\t\tthis.#delegate.value = value;\n\t}\n\n\tget isTrusted(): boolean | undefined {\n\t\treturn this.#delegate.isTrusted;\n\t}\n\n\tset isTrusted(value: boolean | undefined) {\n\t\tthis.#delegate.isTrusted = value;\n\t}\n\n\tget supportThemeIcons(): boolean | undefined {\n\t\treturn this.#delegate.supportThemeIcons;\n\t}\n\n\tset supportThemeIcons(value: boolean | undefined) {\n\t\tthis.#delegate.supportThemeIcons = value;\n\t}\n\n\tget supportHtml(): boolean | undefined {\n\t\treturn this.#delegate.supportHtml;\n\t}\n\n\tset supportHtml(value: boolean | undefined) {\n\t\tthis.#delegate.supportHtml = value;\n\t}\n\n\tget baseUri(): vscode.Uri | undefined {\n\t\treturn this.#delegate.baseUri;\n\t}\n\n\tset baseUri(value: vscode.Uri | undefined) {\n\t\tthis.#delegate.baseUri = value;\n\t}\n\n\tappendText(value: string): vscode.MarkdownString {\n\t\tthis.#delegate.appendText(value);\n\t\treturn this;\n\t}\n\n\tappendMarkdown(value: string): vscode.MarkdownString {\n\t\tthis.#delegate.appendMarkdown(value);\n\t\treturn this;\n\t}\n\n\tappendCodeblock(value: string, language?: string): vscode.MarkdownString {\n\t\tthis.#delegate.appendCodeblock(language ?? '', value);\n\t\treturn this;\n\t}\n}\n\n@es5ClassCompat\nexport class ParameterInformation {\n\n\tlabel: string | [number, number];\n\tdocumentation?: string | vscode.MarkdownString;\n\n\tconstructor(label: string | [number, number], documentation?: string | vscode.MarkdownString) {\n\t\tthis.label = label;\n\t\tthis.documentation = documentation;\n\t}\n}\n\n@es5ClassCompat\nexport class SignatureInformation {\n\n\tlabel: string;\n\tdocumentation?: string | vscode.MarkdownString;\n\tparameters: ParameterInformation[];\n\tactiveParameter?: number;\n\n\tconstructor(label: string, documentation?: string | vscode.MarkdownString) {\n\t\tthis.label = label;\n\t\tthis.documentation = documentation;\n\t\tthis.parameters = [];\n\t}\n}\n\n@es5ClassCompat\nexport class SignatureHelp {\n\n\tsignatures: SignatureInformation[];\n\tactiveSignature: number = 0;\n\tactiveParameter: number = 0;\n\n\tconstructor() {\n\t\tthis.signatures = [];\n\t}\n}\n\nexport enum SignatureHelpTriggerKind {\n\tInvoke = 1,\n\tTriggerCharacter = 2,\n\tContentChange = 3,\n}\n\n\nexport enum InlayHintKind {\n\tType = 1,\n\tParameter = 2,\n}\n\n@es5ClassCompat\nexport class InlayHintLabelPart {\n\n\tvalue: string;\n\ttooltip?: string | vscode.MarkdownString;\n\tlocation?: Location;\n\tcommand?: vscode.Command;\n\n\tconstructor(value: string) {\n\t\tthis.value = value;\n\t}\n}\n\n@es5ClassCompat\nexport class InlayHint implements vscode.InlayHint {\n\n\tlabel: string | InlayHintLabelPart[];\n\ttooltip?: string | vscode.MarkdownString;\n\tposition: Position;\n\ttextEdits?: TextEdit[];\n\tkind?: vscode.InlayHintKind;\n\tpaddingLeft?: boolean;\n\tpaddingRight?: boolean;\n\n\tconstructor(position: Position, label: string | InlayHintLabelPart[], kind?: vscode.InlayHintKind) {\n\t\tthis.position = position;\n\t\tthis.label = label;\n\t\tthis.kind = kind;\n\t}\n}\n\nexport enum CompletionTriggerKind {\n\tInvoke = 0,\n\tTriggerCharacter = 1,\n\tTriggerForIncompleteCompletions = 2\n}\n\nexport interface CompletionContext {\n\treadonly triggerKind: CompletionTriggerKind;\n\treadonly triggerCharacter: string | undefined;\n}\n\nexport enum CompletionItemKind {\n\tText = 0,\n\tMethod = 1,\n\tFunction = 2,\n\tConstructor = 3,\n\tField = 4,\n\tVariable = 5,\n\tClass = 6,\n\tInterface = 7,\n\tModule = 8,\n\tProperty = 9,\n\tUnit = 10,\n\tValue = 11,\n\tEnum = 12,\n\tKeyword = 13,\n\tSnippet = 14,\n\tColor = 15,\n\tFile = 16,\n\tReference = 17,\n\tFolder = 18,\n\tEnumMember = 19,\n\tConstant = 20,\n\tStruct = 21,\n\tEvent = 22,\n\tOperator = 23,\n\tTypeParameter = 24,\n\tUser = 25,\n\tIssue = 26\n}\n\nexport enum CompletionItemTag {\n\tDeprecated = 1,\n}\n\nexport interface CompletionItemLabel {\n\tlabel: string;\n\tdetail?: string;\n\tdescription?: string;\n}\n\n@es5ClassCompat\nexport class CompletionItem implements vscode.CompletionItem {\n\n\tlabel: string | CompletionItemLabel;\n\tkind?: CompletionItemKind;\n\ttags?: CompletionItemTag[];\n\tdetail?: string;\n\tdocumentation?: string | vscode.MarkdownString;\n\tsortText?: string;\n\tfilterText?: string;\n\tpreselect?: boolean;\n\tinsertText?: string | SnippetString;\n\tkeepWhitespace?: boolean;\n\trange?: Range | { inserting: Range; replacing: Range };\n\tcommitCharacters?: string[];\n\ttextEdit?: TextEdit;\n\tadditionalTextEdits?: TextEdit[];\n\tcommand?: vscode.Command;\n\n\tconstructor(label: string | CompletionItemLabel, kind?: CompletionItemKind) {\n\t\tthis.label = label;\n\t\tthis.kind = kind;\n\t}\n\n\ttoJSON(): any {\n\t\treturn {\n\t\t\tlabel: this.label,\n\t\t\tkind: this.kind && CompletionItemKind[this.kind],\n\t\t\tdetail: this.detail,\n\t\t\tdocumentation: this.documentation,\n\t\t\tsortText: this.sortText,\n\t\t\tfilterText: this.filterText,\n\t\t\tpreselect: this.preselect,\n\t\t\tinsertText: this.insertText,\n\t\t\ttextEdit: this.textEdit\n\t\t};\n\t}\n}\n\n@es5ClassCompat\nexport class CompletionList {\n\n\tisIncomplete?: boolean;\n\titems: vscode.CompletionItem[];\n\n\tconstructor(items: vscode.CompletionItem[] = [], isIncomplete: boolean = false) {\n\t\tthis.items = items;\n\t\tthis.isIncomplete = isIncomplete;\n\t}\n}\n\n@es5ClassCompat\nexport class InlineSuggestion implements vscode.InlineCompletionItem {\n\n\tfilterText?: string;\n\tinsertText: string;\n\trange?: Range;\n\tcommand?: vscode.Command;\n\n\tconstructor(insertText: string, range?: Range, command?: vscode.Command) {\n\t\tthis.insertText = insertText;\n\t\tthis.range = range;\n\t\tthis.command = command;\n\t}\n}\n\n@es5ClassCompat\nexport class InlineSuggestionList implements vscode.InlineCompletionList {\n\titems: vscode.InlineCompletionItemNew[];\n\n\tcommands: vscode.Command[] | undefined = undefined;\n\n\tconstructor(items: vscode.InlineCompletionItemNew[]) {\n\t\tthis.items = items;\n\t}\n}\n\n@es5ClassCompat\nexport class InlineSuggestionNew implements vscode.InlineCompletionItemNew {\n\tinsertText: string;\n\trange?: Range;\n\tcommand?: vscode.Command;\n\n\tconstructor(insertText: string, range?: Range, command?: vscode.Command) {\n\t\tthis.insertText = insertText;\n\t\tthis.range = range;\n\t\tthis.command = command;\n\t}\n}\n\n@es5ClassCompat\nexport class InlineSuggestionsNew implements vscode.InlineCompletionListNew {\n\titems: vscode.InlineCompletionItemNew[];\n\n\tcommands: vscode.Command[] | undefined;\n\n\tconstructor(items: vscode.InlineCompletionItemNew[], commands?: vscode.Command[]) {\n\t\tthis.items = items;\n\t\tthis.commands = commands;\n\t}\n}\n\nexport enum ViewColumn {\n\tActive = -1,\n\tBeside = -2,\n\tOne = 1,\n\tTwo = 2,\n\tThree = 3,\n\tFour = 4,\n\tFive = 5,\n\tSix = 6,\n\tSeven = 7,\n\tEight = 8,\n\tNine = 9\n}\n\nexport enum StatusBarAlignment {\n\tLeft = 1,\n\tRight = 2\n}\n\nexport enum TextEditorLineNumbersStyle {\n\tOff = 0,\n\tOn = 1,\n\tRelative = 2\n}\n\nexport enum TextDocumentSaveReason {\n\tManual = 1,\n\tAfterDelay = 2,\n\tFocusOut = 3\n}\n\nexport enum TextEditorRevealType {\n\tDefault = 0,\n\tInCenter = 1,\n\tInCenterIfOutsideViewport = 2,\n\tAtTop = 3\n}\n\nexport enum TextEditorSelectionChangeKind {\n\tKeyboard = 1,\n\tMouse = 2,\n\tCommand = 3\n}\n\nexport enum TextDocumentChangeReason {\n\tUndo = 1,\n\tRedo = 2,\n}\n\n/**\n * These values match very carefully the values of `TrackedRangeStickiness`\n */\nexport enum DecorationRangeBehavior {\n\t/**\n\t * TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges\n\t */\n\tOpenOpen = 0,\n\t/**\n\t * TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges\n\t */\n\tClosedClosed = 1,\n\t/**\n\t * TrackedRangeStickiness.GrowsOnlyWhenTypingBefore\n\t */\n\tOpenClosed = 2,\n\t/**\n\t * TrackedRangeStickiness.GrowsOnlyWhenTypingAfter\n\t */\n\tClosedOpen = 3\n}\n\nexport namespace TextEditorSelectionChangeKind {\n\texport function fromValue(s: string | undefined) {\n\t\tswitch (s) {\n\t\t\tcase 'keyboard': return TextEditorSelectionChangeKind.Keyboard;\n\t\t\tcase 'mouse': return TextEditorSelectionChangeKind.Mouse;\n\t\t\tcase 'api': return TextEditorSelectionChangeKind.Command;\n\t\t}\n\t\treturn undefined;\n\t}\n}\n\n@es5ClassCompat\nexport class DocumentLink {\n\n\trange: Range;\n\n\ttarget?: URI;\n\n\ttooltip?: string;\n\n\tconstructor(range: Range, target: URI | undefined) {\n\t\tif (target && !(URI.isUri(target))) {\n\t\t\tthrow illegalArgument('target');\n\t\t}\n\t\tif (!Range.isRange(range) || range.isEmpty) {\n\t\t\tthrow illegalArgument('range');\n\t\t}\n\t\tthis.range = range;\n\t\tthis.target = target;\n\t}\n}\n\n@es5ClassCompat\nexport class Color {\n\treadonly red: number;\n\treadonly green: number;\n\treadonly blue: number;\n\treadonly alpha: number;\n\n\tconstructor(red: number, green: number, blue: number, alpha: number) {\n\t\tthis.red = red;\n\t\tthis.green = green;\n\t\tthis.blue = blue;\n\t\tthis.alpha = alpha;\n\t}\n}\n\nexport type IColorFormat = string | { opaque: string; transparent: string };\n\n@es5ClassCompat\nexport class ColorInformation {\n\trange: Range;\n\n\tcolor: Color;\n\n\tconstructor(range: Range, color: Color) {\n\t\tif (color && !(color instanceof Color)) {\n\t\t\tthrow illegalArgument('color');\n\t\t}\n\t\tif (!Range.isRange(range) || range.isEmpty) {\n\t\t\tthrow illegalArgument('range');\n\t\t}\n\t\tthis.range = range;\n\t\tthis.color = color;\n\t}\n}\n\n@es5ClassCompat\nexport class ColorPresentation {\n\tlabel: string;\n\ttextEdit?: TextEdit;\n\tadditionalTextEdits?: TextEdit[];\n\n\tconstructor(label: string) {\n\t\tif (!label || typeof label !== 'string') {\n\t\t\tthrow illegalArgument('label');\n\t\t}\n\t\tthis.label = label;\n\t}\n}\n\nexport enum ColorFormat {\n\tRGB = 0,\n\tHEX = 1,\n\tHSL = 2\n}\n\nexport enum SourceControlInputBoxValidationType {\n\tError = 0,\n\tWarning = 1,\n\tInformation = 2\n}\n\nexport enum TerminalExitReason {\n\tUnknown = 0,\n\tShutdown = 1,\n\tProcess = 2,\n\tUser = 3,\n\tExtension = 4\n}\n\nexport class TerminalLink implements vscode.TerminalLink {\n\tconstructor(\n\t\tpublic startIndex: number,\n\t\tpublic length: number,\n\t\tpublic tooltip?: string\n\t) {\n\t\tif (typeof startIndex !== 'number' || startIndex < 0) {\n\t\t\tthrow illegalArgument('startIndex');\n\t\t}\n\t\tif (typeof length !== 'number' || length < 1) {\n\t\t\tthrow illegalArgument('length');\n\t\t}\n\t\tif (tooltip !== undefined && typeof tooltip !== 'string') {\n\t\t\tthrow illegalArgument('tooltip');\n\t\t}\n\t}\n}\n\nexport enum TerminalLocation {\n\tPanel = 1,\n\tEditor = 2,\n}\n\nexport class TerminalProfile implements vscode.TerminalProfile {\n\tconstructor(\n\t\tpublic options: vscode.TerminalOptions | vscode.ExtensionTerminalOptions\n\t) {\n\t\tif (typeof options !== 'object') {\n\t\t\tthrow illegalArgument('options');\n\t\t}\n\t}\n}\n\nexport enum TaskRevealKind {\n\tAlways = 1,\n\n\tSilent = 2,\n\n\tNever = 3\n}\n\nexport enum TaskPanelKind {\n\tShared = 1,\n\n\tDedicated = 2,\n\n\tNew = 3\n}\n\n@es5ClassCompat\nexport class TaskGroup implements vscode.TaskGroup {\n\n\tisDefault: boolean | undefined;\n\tprivate _id: string;\n\n\tpublic static Clean: TaskGroup = new TaskGroup('clean', 'Clean');\n\n\tpublic static Build: TaskGroup = new TaskGroup('build', 'Build');\n\n\tpublic static Rebuild: TaskGroup = new TaskGroup('rebuild', 'Rebuild');\n\n\tpublic static Test: TaskGroup = new TaskGroup('test', 'Test');\n\n\tpublic static from(value: string) {\n\t\tswitch (value) {\n\t\t\tcase 'clean':\n\t\t\t\treturn TaskGroup.Clean;\n\t\t\tcase 'build':\n\t\t\t\treturn TaskGroup.Build;\n\t\t\tcase 'rebuild':\n\t\t\t\treturn TaskGroup.Rebuild;\n\t\t\tcase 'test':\n\t\t\t\treturn TaskGroup.Test;\n\t\t\tdefault:\n\t\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tconstructor(id: string, public readonly label: string) {\n\t\tif (typeof id !== 'string') {\n\t\t\tthrow illegalArgument('name');\n\t\t}\n\t\tif (typeof label !== 'string') {\n\t\t\tthrow illegalArgument('name');\n\t\t}\n\t\tthis._id = id;\n\t}\n\n\tget id(): string {\n\t\treturn this._id;\n\t}\n}\n\nfunction computeTaskExecutionId(values: string[]): string {\n\tlet id: string = '';\n\tfor (let i = 0; i < values.length; i++) {\n\t\tid += values[i].replace(/,/g, ',,') + ',';\n\t}\n\treturn id;\n}\n\n@es5ClassCompat\nexport class ProcessExecution implements vscode.ProcessExecution {\n\n\tprivate _process: string;\n\tprivate _args: string[];\n\tprivate _options: vscode.ProcessExecutionOptions | undefined;\n\n\tconstructor(process: string, options?: vscode.ProcessExecutionOptions);\n\tconstructor(process: string, args: string[], options?: vscode.ProcessExecutionOptions);\n\tconstructor(process: string, varg1?: string[] | vscode.ProcessExecutionOptions, varg2?: vscode.ProcessExecutionOptions) {\n\t\tif (typeof process !== 'string') {\n\t\t\tthrow illegalArgument('process');\n\t\t}\n\t\tthis._args = [];\n\t\tthis._process = process;\n\t\tif (varg1 !== undefined) {\n\t\t\tif (Array.isArray(varg1)) {\n\t\t\t\tthis._args = varg1;\n\t\t\t\tthis._options = varg2;\n\t\t\t} else {\n\t\t\t\tthis._options = varg1;\n\t\t\t}\n\t\t}\n\t}\n\n\n\tget process(): string {\n\t\treturn this._process;\n\t}\n\n\tset process(value: string) {\n\t\tif (typeof value !== 'string') {\n\t\t\tthrow illegalArgument('process');\n\t\t}\n\t\tthis._process = value;\n\t}\n\n\tget args(): string[] {\n\t\treturn this._args;\n\t}\n\n\tset args(value: string[]) {\n\t\tif (!Array.isArray(value)) {\n\t\t\tvalue = [];\n\t\t}\n\t\tthis._args = value;\n\t}\n\n\tget options(): vscode.ProcessExecutionOptions | undefined {\n\t\treturn this._options;\n\t}\n\n\tset options(value: vscode.ProcessExecutionOptions | undefined) {\n\t\tthis._options = value;\n\t}\n\n\tpublic computeId(): string {\n\t\tconst props: string[] = [];\n\t\tprops.push('process');\n\t\tif (this._process !== undefined) {\n\t\t\tprops.push(this._process);\n\t\t}\n\t\tif (this._args && this._args.length > 0) {\n\t\t\tfor (const arg of this._args) {\n\t\t\t\tprops.push(arg);\n\t\t\t}\n\t\t}\n\t\treturn computeTaskExecutionId(props);\n\t}\n}\n\n@es5ClassCompat\nexport class ShellExecution implements vscode.ShellExecution {\n\n\tprivate _commandLine: string | undefined;\n\tprivate _command: string | vscode.ShellQuotedString | undefined;\n\tprivate _args: (string | vscode.ShellQuotedString)[] = [];\n\tprivate _options: vscode.ShellExecutionOptions | undefined;\n\n\tconstructor(commandLine: string, options?: vscode.ShellExecutionOptions);\n\tconstructor(command: string | vscode.ShellQuotedString, args: (string | vscode.ShellQuotedString)[], options?: vscode.ShellExecutionOptions);\n\tconstructor(arg0: string | vscode.ShellQuotedString, arg1?: vscode.ShellExecutionOptions | (string | vscode.ShellQuotedString)[], arg2?: vscode.ShellExecutionOptions) {\n\t\tif (Array.isArray(arg1)) {\n\t\t\tif (!arg0) {\n\t\t\t\tthrow illegalArgument('command can\\'t be undefined or null');\n\t\t\t}\n\t\t\tif (typeof arg0 !== 'string' && typeof arg0.value !== 'string') {\n\t\t\t\tthrow illegalArgument('command');\n\t\t\t}\n\t\t\tthis._command = arg0;\n\t\t\tthis._args = arg1 as (string | vscode.ShellQuotedString)[];\n\t\t\tthis._options = arg2;\n\t\t} else {\n\t\t\tif (typeof arg0 !== 'string') {\n\t\t\t\tthrow illegalArgument('commandLine');\n\t\t\t}\n\t\t\tthis._commandLine = arg0;\n\t\t\tthis._options = arg1;\n\t\t}\n\t}\n\n\tget commandLine(): string | undefined {\n\t\treturn this._commandLine;\n\t}\n\n\tset commandLine(value: string | undefined) {\n\t\tif (typeof value !== 'string') {\n\t\t\tthrow illegalArgument('commandLine');\n\t\t}\n\t\tthis._commandLine = value;\n\t}\n\n\tget command(): string | vscode.ShellQuotedString {\n\t\treturn this._command ? this._command : '';\n\t}\n\n\tset command(value: string | vscode.ShellQuotedString) {\n\t\tif (typeof value !== 'string' && typeof value.value !== 'string') {\n\t\t\tthrow illegalArgument('command');\n\t\t}\n\t\tthis._command = value;\n\t}\n\n\tget args(): (string | vscode.ShellQuotedString)[] {\n\t\treturn this._args;\n\t}\n\n\tset args(value: (string | vscode.ShellQuotedString)[]) {\n\t\tthis._args = value || [];\n\t}\n\n\tget options(): vscode.ShellExecutionOptions | undefined {\n\t\treturn this._options;\n\t}\n\n\tset options(value: vscode.ShellExecutionOptions | undefined) {\n\t\tthis._options = value;\n\t}\n\n\tpublic computeId(): string {\n\t\tconst props: string[] = [];\n\t\tprops.push('shell');\n\t\tif (this._commandLine !== undefined) {\n\t\t\tprops.push(this._commandLine);\n\t\t}\n\t\tif (this._command !== undefined) {\n\t\t\tprops.push(typeof this._command === 'string' ? this._command : this._command.value);\n\t\t}\n\t\tif (this._args && this._args.length > 0) {\n\t\t\tfor (const arg of this._args) {\n\t\t\t\tprops.push(typeof arg === 'string' ? arg : arg.value);\n\t\t\t}\n\t\t}\n\t\treturn computeTaskExecutionId(props);\n\t}\n}\n\nexport enum ShellQuoting {\n\tEscape = 1,\n\tStrong = 2,\n\tWeak = 3\n}\n\nexport enum TaskScope {\n\tGlobal = 1,\n\tWorkspace = 2\n}\n\nexport class CustomExecution implements vscode.CustomExecution {\n\tprivate _callback: (resolvedDefinition: vscode.TaskDefinition) => Thenable<vscode.Pseudoterminal>;\n\tconstructor(callback: (resolvedDefinition: vscode.TaskDefinition) => Thenable<vscode.Pseudoterminal>) {\n\t\tthis._callback = callback;\n\t}\n\tpublic computeId(): string {\n\t\treturn 'customExecution' + generateUuid();\n\t}\n\n\tpublic set callback(value: (resolvedDefinition: vscode.TaskDefinition) => Thenable<vscode.Pseudoterminal>) {\n\t\tthis._callback = value;\n\t}\n\n\tpublic get callback(): ((resolvedDefinition: vscode.TaskDefinition) => Thenable<vscode.Pseudoterminal>) {\n\t\treturn this._callback;\n\t}\n}\n\n@es5ClassCompat\nexport class Task implements vscode.Task {\n\n\tprivate static ExtensionCallbackType: string = 'customExecution';\n\tprivate static ProcessType: string = 'process';\n\tprivate static ShellType: string = 'shell';\n\tprivate static EmptyType: string = '$empty';\n\n\tprivate __id: string | undefined;\n\tprivate __deprecated: boolean = false;\n\n\tprivate _definition: vscode.TaskDefinition;\n\tprivate _scope: vscode.TaskScope.Global | vscode.TaskScope.Workspace | vscode.WorkspaceFolder | undefined;\n\tprivate _name: string;\n\tprivate _execution: ProcessExecution | ShellExecution | CustomExecution | undefined;\n\tprivate _problemMatchers: string[];\n\tprivate _hasDefinedMatchers: boolean;\n\tprivate _isBackground: boolean;\n\tprivate _source: string;\n\tprivate _group: TaskGroup | undefined;\n\tprivate _presentationOptions: vscode.TaskPresentationOptions;\n\tprivate _runOptions: vscode.RunOptions;\n\tprivate _detail: string | undefined;\n\n\tconstructor(definition: vscode.TaskDefinition, name: string, source: string, execution?: ProcessExecution | ShellExecution | CustomExecution, problemMatchers?: string | string[]);\n\tconstructor(definition: vscode.TaskDefinition, scope: vscode.TaskScope.Global | vscode.TaskScope.Workspace | vscode.WorkspaceFolder, name: string, source: string, execution?: ProcessExecution | ShellExecution | CustomExecution, problemMatchers?: string | string[]);\n\tconstructor(definition: vscode.TaskDefinition, arg2: string | (vscode.TaskScope.Global | vscode.TaskScope.Workspace) | vscode.WorkspaceFolder, arg3: any, arg4?: any, arg5?: any, arg6?: any) {\n\t\tthis._definition = this.definition = definition;\n\t\tlet problemMatchers: string | string[];\n\t\tif (typeof arg2 === 'string') {\n\t\t\tthis._name = this.name = arg2;\n\t\t\tthis._source = this.source = arg3;\n\t\t\tthis.execution = arg4;\n\t\t\tproblemMatchers = arg5;\n\t\t\tthis.__deprecated = true;\n\t\t} else if (arg2 === TaskScope.Global || arg2 === TaskScope.Workspace) {\n\t\t\tthis.target = arg2;\n\t\t\tthis._name = this.name = arg3;\n\t\t\tthis._source = this.source = arg4;\n\t\t\tthis.execution = arg5;\n\t\t\tproblemMatchers = arg6;\n\t\t} else {\n\t\t\tthis.target = arg2;\n\t\t\tthis._name = this.name = arg3;\n\t\t\tthis._source = this.source = arg4;\n\t\t\tthis.execution = arg5;\n\t\t\tproblemMatchers = arg6;\n\t\t}\n\t\tif (typeof problemMatchers === 'string') {\n\t\t\tthis._problemMatchers = [problemMatchers];\n\t\t\tthis._hasDefinedMatchers = true;\n\t\t} else if (Array.isArray(problemMatchers)) {\n\t\t\tthis._problemMatchers = problemMatchers;\n\t\t\tthis._hasDefinedMatchers = true;\n\t\t} else {\n\t\t\tthis._problemMatchers = [];\n\t\t\tthis._hasDefinedMatchers = false;\n\t\t}\n\t\tthis._isBackground = false;\n\t\tthis._presentationOptions = Object.create(null);\n\t\tthis._runOptions = Object.create(null);\n\t}\n\n\tget _id(): string | undefined {\n\t\treturn this.__id;\n\t}\n\n\tset _id(value: string | undefined) {\n\t\tthis.__id = value;\n\t}\n\n\tget _deprecated(): boolean {\n\t\treturn this.__deprecated;\n\t}\n\n\tprivate clear(): void {\n\t\tif (this.__id === undefined) {\n\t\t\treturn;\n\t\t}\n\t\tthis.__id = undefined;\n\t\tthis._scope = undefined;\n\t\tthis.computeDefinitionBasedOnExecution();\n\t}\n\n\tprivate computeDefinitionBasedOnExecution(): void {\n\t\tif (this._execution instanceof ProcessExecution) {\n\t\t\tthis._definition = {\n\t\t\t\ttype: Task.ProcessType,\n\t\t\t\tid: this._execution.computeId()\n\t\t\t};\n\t\t} else if (this._execution instanceof ShellExecution) {\n\t\t\tthis._definition = {\n\t\t\t\ttype: Task.ShellType,\n\t\t\t\tid: this._execution.computeId()\n\t\t\t};\n\t\t} else if (this._execution instanceof CustomExecution) {\n\t\t\tthis._definition = {\n\t\t\t\ttype: Task.ExtensionCallbackType,\n\t\t\t\tid: this._execution.computeId()\n\t\t\t};\n\t\t} else {\n\t\t\tthis._definition = {\n\t\t\t\ttype: Task.EmptyType,\n\t\t\t\tid: generateUuid()\n\t\t\t};\n\t\t}\n\t}\n\n\tget definition(): vscode.TaskDefinition {\n\t\treturn this._definition;\n\t}\n\n\tset definition(value: vscode.TaskDefinition) {\n\t\tif (value === undefined || value === null) {\n\t\t\tthrow illegalArgument('Kind can\\'t be undefined or null');\n\t\t}\n\t\tthis.clear();\n\t\tthis._definition = value;\n\t}\n\n\tget scope(): vscode.TaskScope.Global | vscode.TaskScope.Workspace | vscode.WorkspaceFolder | undefined {\n\t\treturn this._scope;\n\t}\n\n\tset target(value: vscode.TaskScope.Global | vscode.TaskScope.Workspace | vscode.WorkspaceFolder) {\n\t\tthis.clear();\n\t\tthis._scope = value;\n\t}\n\n\tget name(): string {\n\t\treturn this._name;\n\t}\n\n\tset name(value: string) {\n\t\tif (typeof value !== 'string') {\n\t\t\tthrow illegalArgument('name');\n\t\t}\n\t\tthis.clear();\n\t\tthis._name = value;\n\t}\n\n\tget execution(): ProcessExecution | ShellExecution | CustomExecution | undefined {\n\t\treturn this._execution;\n\t}\n\n\tset execution(value: ProcessExecution | ShellExecution | CustomExecution | undefined) {\n\t\tif (value === null) {\n\t\t\tvalue = undefined;\n\t\t}\n\t\tthis.clear();\n\t\tthis._execution = value;\n\t\tconst type = this._definition.type;\n\t\tif (Task.EmptyType === type || Task.ProcessType === type || Task.ShellType === type || Task.ExtensionCallbackType === type) {\n\t\t\tthis.computeDefinitionBasedOnExecution();\n\t\t}\n\t}\n\n\tget problemMatchers(): string[] {\n\t\treturn this._problemMatchers;\n\t}\n\n\tset problemMatchers(value: string[]) {\n\t\tif (!Array.isArray(value)) {\n\t\t\tthis.clear();\n\t\t\tthis._problemMatchers = [];\n\t\t\tthis._hasDefinedMatchers = false;\n\t\t\treturn;\n\t\t} else {\n\t\t\tthis.clear();\n\t\t\tthis._problemMatchers = value;\n\t\t\tthis._hasDefinedMatchers = true;\n\t\t}\n\t}\n\n\tget hasDefinedMatchers(): boolean {\n\t\treturn this._hasDefinedMatchers;\n\t}\n\n\tget isBackground(): boolean {\n\t\treturn this._isBackground;\n\t}\n\n\tset isBackground(value: boolean) {\n\t\tif (value !== true && value !== false) {\n\t\t\tvalue = false;\n\t\t}\n\t\tthis.clear();\n\t\tthis._isBackground = value;\n\t}\n\n\tget source(): string {\n\t\treturn this._source;\n\t}\n\n\tset source(value: string) {\n\t\tif (typeof value !== 'string' || value.length === 0) {\n\t\t\tthrow illegalArgument('source must be a string of length > 0');\n\t\t}\n\t\tthis.clear();\n\t\tthis._source = value;\n\t}\n\n\tget group(): TaskGroup | undefined {\n\t\treturn this._group;\n\t}\n\n\tset group(value: TaskGroup | undefined) {\n\t\tif (value === null) {\n\t\t\tvalue = undefined;\n\t\t}\n\t\tthis.clear();\n\t\tthis._group = value;\n\t}\n\n\tget detail(): string | undefined {\n\t\treturn this._detail;\n\t}\n\n\tset detail(value: string | undefined) {\n\t\tif (value === null) {\n\t\t\tvalue = undefined;\n\t\t}\n\t\tthis._detail = value;\n\t}\n\n\tget presentationOptions(): vscode.TaskPresentationOptions {\n\t\treturn this._presentationOptions;\n\t}\n\n\tset presentationOptions(value: vscode.TaskPresentationOptions) {\n\t\tif (value === null || value === undefined) {\n\t\t\tvalue = Object.create(null);\n\t\t}\n\t\tthis.clear();\n\t\tthis._presentationOptions = value;\n\t}\n\n\tget runOptions(): vscode.RunOptions {\n\t\treturn this._runOptions;\n\t}\n\n\tset runOptions(value: vscode.RunOptions) {\n\t\tif (value === null || value === undefined) {\n\t\t\tvalue = Object.create(null);\n\t\t}\n\t\tthis.clear();\n\t\tthis._runOptions = value;\n\t}\n}\n\n\nexport enum ProgressLocation {\n\tSourceControl = 1,\n\tWindow = 10,\n\tNotification = 15\n}\n\n@es5ClassCompat\nexport class TreeItem {\n\n\tlabel?: string | vscode.TreeItemLabel;\n\tresourceUri?: URI;\n\ticonPath?: string | URI | { light: string | URI; dark: string | URI } | ThemeIcon;\n\tcommand?: vscode.Command;\n\tcontextValue?: string;\n\ttooltip?: string | vscode.MarkdownString;\n\n\tstatic isTreeItem(thing: any): thing is TreeItem {\n\t\tif (thing instanceof TreeItem) {\n\t\t\treturn true;\n\t\t}\n\t\tconst treeItemThing = thing as vscode.TreeItem;\n\t\tif (treeItemThing.label !== undefined && !isString(treeItemThing.label) && !(treeItemThing.label.label)) {\n\t\t\tconsole.log('INVALID tree item, invalid label', treeItemThing.label);\n\t\t\treturn false;\n\t\t}\n\t\tif ((treeItemThing.id !== undefined) && !isString(treeItemThing.id)) {\n\t\t\tconsole.log('INVALID tree item, invalid id', treeItemThing.id);\n\t\t\treturn false;\n\t\t}\n\t\tif ((treeItemThing.iconPath !== undefined) && !isString(treeItemThing.iconPath) && !URI.isUri(treeItemThing.iconPath) && !isString((treeItemThing.iconPath as vscode.ThemeIcon).id)) {\n\t\t\tconsole.log('INVALID tree item, invalid iconPath', treeItemThing.iconPath);\n\t\t\treturn false;\n\t\t}\n\t\tif ((treeItemThing.description !== undefined) && !isString(treeItemThing.description) && (typeof treeItemThing.description !== 'boolean')) {\n\t\t\tconsole.log('INVALID tree item, invalid description', treeItemThing.description);\n\t\t\treturn false;\n\t\t}\n\t\tif ((treeItemThing.resourceUri !== undefined) && !URI.isUri(treeItemThing.resourceUri)) {\n\t\t\tconsole.log('INVALID tree item, invalid resourceUri', treeItemThing.resourceUri);\n\t\t\treturn false;\n\t\t}\n\t\tif ((treeItemThing.tooltip !== undefined) && !isString(treeItemThing.tooltip) && !(treeItemThing.tooltip instanceof MarkdownString)) {\n\t\t\tconsole.log('INVALID tree item, invalid tooltip', treeItemThing.tooltip);\n\t\t\treturn false;\n\t\t}\n\t\tif ((treeItemThing.command !== undefined) && !treeItemThing.command.command) {\n\t\t\tconsole.log('INVALID tree item, invalid command', treeItemThing.command);\n\t\t\treturn false;\n\t\t}\n\t\tif ((treeItemThing.collapsibleState !== undefined) && (treeItemThing.collapsibleState < TreeItemCollapsibleState.None) && (treeItemThing.collapsibleState > TreeItemCollapsibleState.Expanded)) {\n\t\t\tconsole.log('INVALID tree item, invalid collapsibleState', treeItemThing.collapsibleState);\n\t\t\treturn false;\n\t\t}\n\t\tif ((treeItemThing.contextValue !== undefined) && !isString(treeItemThing.contextValue)) {\n\t\t\tconsole.log('INVALID tree item, invalid contextValue', treeItemThing.contextValue);\n\t\t\treturn false;\n\t\t}\n\t\tif ((treeItemThing.accessibilityInformation !== undefined) && !treeItemThing.accessibilityInformation.label) {\n\t\t\tconsole.log('INVALID tree item, invalid accessibilityInformation', treeItemThing.accessibilityInformation);\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tconstructor(label: string | vscode.TreeItemLabel, collapsibleState?: vscode.TreeItemCollapsibleState);\n\tconstructor(resourceUri: URI, collapsibleState?: vscode.TreeItemCollapsibleState);\n\tconstructor(arg1: string | vscode.TreeItemLabel | URI, public collapsibleState: vscode.TreeItemCollapsibleState = TreeItemCollapsibleState.None) {\n\t\tif (URI.isUri(arg1)) {\n\t\t\tthis.resourceUri = arg1;\n\t\t} else {\n\t\t\tthis.label = arg1;\n\t\t}\n\t}\n\n}\n\nexport enum TreeItemCollapsibleState {\n\tNone = 0,\n\tCollapsed = 1,\n\tExpanded = 2\n}\n\n@es5ClassCompat\nexport class DataTransferItem {\n\n\tasync asString(): Promise<string> {\n\t\treturn typeof this.value === 'string' ? this.value : JSON.stringify(this.value);\n\t}\n\n\tasFile(): undefined | vscode.DataTransferFile {\n\t\treturn undefined;\n\t}\n\n\tconstructor(public readonly value: any) { }\n}\n\n@es5ClassCompat\nexport class DataTransfer implements vscode.DataTransfer {\n\t#items = new Map<string, DataTransferItem[]>();\n\n\tconstructor(init?: Iterable<readonly [string, DataTransferItem]>) {\n\t\tfor (const [mime, item] of init ?? []) {\n\t\t\tconst existing = this.#items.get(mime);\n\t\t\tif (existing) {\n\t\t\t\texisting.push(item);\n\t\t\t} else {\n\t\t\t\tthis.#items.set(mime, [item]);\n\t\t\t}\n\t\t}\n\t}\n\n\tget(mimeType: string): DataTransferItem | undefined {\n\t\treturn this.#items.get(mimeType)?.[0];\n\t}\n\n\tset(mimeType: string, value: DataTransferItem): void {\n\t\t// This intentionally overwrites all entries for a given mimetype.\n\t\t// This is similar to how the DOM DataTransfer type works\n\t\tthis.#items.set(mimeType, [value]);\n\t}\n\n\tforEach(callbackfn: (value: DataTransferItem, key: string, dataTransfer: DataTransfer) => void, thisArg?: unknown): void {\n\t\tfor (const [mime, items] of this.#items) {\n\t\t\tfor (const item of items) {\n\t\t\t\tcallbackfn.call(thisArg, item, mime, this);\n\t\t\t}\n\t\t}\n\t}\n\n\t*[Symbol.iterator](): IterableIterator<[mimeType: string, item: vscode.DataTransferItem]> {\n\t\tfor (const [mime, items] of this.#items) {\n\t\t\tfor (const item of items) {\n\t\t\t\tyield [mime, item];\n\t\t\t}\n\t\t}\n\t}\n}\n\n@es5ClassCompat\nexport class DocumentDropEdit {\n\tinsertText: string | SnippetString;\n\n\tadditionalEdit?: WorkspaceEdit;\n\n\tconstructor(insertText: string | SnippetString) {\n\t\tthis.insertText = insertText;\n\t}\n}\n\n@es5ClassCompat\nexport class DocumentPasteEdit {\n\tinsertText: string | SnippetString;\n\n\tadditionalEdit?: WorkspaceEdit;\n\n\tconstructor(insertText: string | SnippetString) {\n\t\tthis.insertText = insertText;\n\t}\n}\n\n@es5ClassCompat\nexport class ThemeIcon {\n\n\tstatic File: ThemeIcon;\n\tstatic Folder: ThemeIcon;\n\n\treadonly id: string;\n\treadonly color?: ThemeColor;\n\n\tconstructor(id: string, color?: ThemeColor) {\n\t\tthis.id = id;\n\t\tthis.color = color;\n\t}\n}\nThemeIcon.File = new ThemeIcon('file');\nThemeIcon.Folder = new ThemeIcon('folder');\n\n\n@es5ClassCompat\nexport class ThemeColor {\n\tid: string;\n\tconstructor(id: string) {\n\t\tthis.id = id;\n\t}\n}\n\nexport enum ConfigurationTarget {\n\tGlobal = 1,\n\n\tWorkspace = 2,\n\n\tWorkspaceFolder = 3\n}\n\n@es5ClassCompat\nexport class RelativePattern implements IRelativePattern {\n\n\tpattern: string;\n\n\tprivate _base!: string;\n\tget base(): string {\n\t\treturn this._base;\n\t}\n\tset base(base: string) {\n\t\tthis._base = base;\n\t\tthis._baseUri = URI.file(base);\n\t}\n\n\tprivate _baseUri!: URI;\n\tget baseUri(): URI {\n\t\treturn this._baseUri;\n\t}\n\tset baseUri(baseUri: URI) {\n\t\tthis._baseUri = baseUri;\n\t\tthis._base = baseUri.fsPath;\n\t}\n\n\tconstructor(base: vscode.WorkspaceFolder | URI | string, pattern: string) {\n\t\tif (typeof base !== 'string') {\n\t\t\tif (!base || !URI.isUri(base) && !URI.isUri(base.uri)) {\n\t\t\t\tthrow illegalArgument('base');\n\t\t\t}\n\t\t}\n\n\t\tif (typeof pattern !== 'string') {\n\t\t\tthrow illegalArgument('pattern');\n\t\t}\n\n\t\tif (typeof base === 'string') {\n\t\t\tthis.baseUri = URI.file(base);\n\t\t} else if (URI.isUri(base)) {\n\t\t\tthis.baseUri = base;\n\t\t} else {\n\t\t\tthis.baseUri = base.uri;\n\t\t}\n\n\t\tthis.pattern = pattern;\n\t}\n\n\ttoJSON(): IRelativePatternDto {\n\t\treturn {\n\t\t\tpattern: this.pattern,\n\t\t\tbase: this.base,\n\t\t\tbaseUri: this.baseUri.toJSON()\n\t\t};\n\t}\n}\n\n@es5ClassCompat\nexport class Breakpoint {\n\n\tprivate _id: string | undefined;\n\n\treadonly enabled: boolean;\n\treadonly condition?: string;\n\treadonly hitCondition?: string;\n\treadonly logMessage?: string;\n\n\tprotected constructor(enabled?: boolean, condition?: string, hitCondition?: string, logMessage?: string) {\n\t\tthis.enabled = typeof enabled === 'boolean' ? enabled : true;\n\t\tif (typeof condition === 'string') {\n\t\t\tthis.condition = condition;\n\t\t}\n\t\tif (typeof hitCondition === 'string') {\n\t\t\tthis.hitCondition = hitCondition;\n\t\t}\n\t\tif (typeof logMessage === 'string') {\n\t\t\tthis.logMessage = logMessage;\n\t\t}\n\t}\n\n\tget id(): string {\n\t\tif (!this._id) {\n\t\t\tthis._id = generateUuid();\n\t\t}\n\t\treturn this._id;\n\t}\n}\n\n@es5ClassCompat\nexport class SourceBreakpoint extends Breakpoint {\n\treadonly location: Location;\n\n\tconstructor(location: Location, enabled?: boolean, condition?: string, hitCondition?: string, logMessage?: string) {\n\t\tsuper(enabled, condition, hitCondition, logMessage);\n\t\tif (location === null) {\n\t\t\tthrow illegalArgument('location');\n\t\t}\n\t\tthis.location = location;\n\t}\n}\n\n@es5ClassCompat\nexport class FunctionBreakpoint extends Breakpoint {\n\treadonly functionName: string;\n\n\tconstructor(functionName: string, enabled?: boolean, condition?: string, hitCondition?: string, logMessage?: string) {\n\t\tsuper(enabled, condition, hitCondition, logMessage);\n\t\tthis.functionName = functionName;\n\t}\n}\n\n@es5ClassCompat\nexport class DataBreakpoint extends Breakpoint {\n\treadonly label: string;\n\treadonly dataId: string;\n\treadonly canPersist: boolean;\n\n\tconstructor(label: string, dataId: string, canPersist: boolean, enabled?: boolean, condition?: string, hitCondition?: string, logMessage?: string) {\n\t\tsuper(enabled, condition, hitCondition, logMessage);\n\t\tif (!dataId) {\n\t\t\tthrow illegalArgument('dataId');\n\t\t}\n\t\tthis.label = label;\n\t\tthis.dataId = dataId;\n\t\tthis.canPersist = canPersist;\n\t}\n}\n\n\n@es5ClassCompat\nexport class DebugAdapterExecutable implements vscode.DebugAdapterExecutable {\n\treadonly command: string;\n\treadonly args: string[];\n\treadonly options?: vscode.DebugAdapterExecutableOptions;\n\n\tconstructor(command: string, args: string[], options?: vscode.DebugAdapterExecutableOptions) {\n\t\tthis.command = command;\n\t\tthis.args = args || [];\n\t\tthis.options = options;\n\t}\n}\n\n@es5ClassCompat\nexport class DebugAdapterServer implements vscode.DebugAdapterServer {\n\treadonly port: number;\n\treadonly host?: string;\n\n\tconstructor(port: number, host?: string) {\n\t\tthis.port = port;\n\t\tthis.host = host;\n\t}\n}\n\n@es5ClassCompat\nexport class DebugAdapterNamedPipeServer implements vscode.DebugAdapterNamedPipeServer {\n\tconstructor(public readonly path: string) {\n\t}\n}\n\n@es5ClassCompat\nexport class DebugAdapterInlineImplementation implements vscode.DebugAdapterInlineImplementation {\n\treadonly implementation: vscode.DebugAdapter;\n\n\tconstructor(impl: vscode.DebugAdapter) {\n\t\tthis.implementation = impl;\n\t}\n}\n\n@es5ClassCompat\nexport class EvaluatableExpression implements vscode.EvaluatableExpression {\n\treadonly range: vscode.Range;\n\treadonly expression?: string;\n\n\tconstructor(range: vscode.Range, expression?: string) {\n\t\tthis.range = range;\n\t\tthis.expression = expression;\n\t}\n}\n\nexport enum InlineCompletionTriggerKind {\n\tInvoke = 0,\n\tAutomatic = 1,\n}\n\nexport enum InlineCompletionTriggerKindNew {\n\tInvoke = 0,\n\tAutomatic = 1,\n}\n\n@es5ClassCompat\nexport class InlineValueText implements vscode.InlineValueText {\n\treadonly range: Range;\n\treadonly text: string;\n\n\tconstructor(range: Range, text: string) {\n\t\tthis.range = range;\n\t\tthis.text = text;\n\t}\n}\n\n@es5ClassCompat\nexport class InlineValueVariableLookup implements vscode.InlineValueVariableLookup {\n\treadonly range: Range;\n\treadonly variableName?: string;\n\treadonly caseSensitiveLookup: boolean;\n\n\tconstructor(range: Range, variableName?: string, caseSensitiveLookup: boolean = true) {\n\t\tthis.range = range;\n\t\tthis.variableName = variableName;\n\t\tthis.caseSensitiveLookup = caseSensitiveLookup;\n\t}\n}\n\n@es5ClassCompat\nexport class InlineValueEvaluatableExpression implements vscode.InlineValueEvaluatableExpression {\n\treadonly range: Range;\n\treadonly expression?: string;\n\n\tconstructor(range: Range, expression?: string) {\n\t\tthis.range = range;\n\t\tthis.expression = expression;\n\t}\n}\n\n@es5ClassCompat\nexport class InlineValueContext implements vscode.InlineValueContext {\n\n\treadonly frameId: number;\n\treadonly stoppedLocation: vscode.Range;\n\n\tconstructor(frameId: number, range: vscode.Range) {\n\t\tthis.frameId = frameId;\n\t\tthis.stoppedLocation = range;\n\t}\n}\n\n//#region file api\n\nexport enum FileChangeType {\n\tChanged = 1,\n\tCreated = 2,\n\tDeleted = 3,\n}\n\n@es5ClassCompat\nexport class FileSystemError extends Error {\n\n\tstatic FileExists(messageOrUri?: string | URI): FileSystemError {\n\t\treturn new FileSystemError(messageOrUri, FileSystemProviderErrorCode.FileExists, FileSystemError.FileExists);\n\t}\n\tstatic FileNotFound(messageOrUri?: string | URI): FileSystemError {\n\t\treturn new FileSystemError(messageOrUri, FileSystemProviderErrorCode.FileNotFound, FileSystemError.FileNotFound);\n\t}\n\tstatic FileNotADirectory(messageOrUri?: string | URI): FileSystemError {\n\t\treturn new FileSystemError(messageOrUri, FileSystemProviderErrorCode.FileNotADirectory, FileSystemError.FileNotADirectory);\n\t}\n\tstatic FileIsADirectory(messageOrUri?: string | URI): FileSystemError {\n\t\treturn new FileSystemError(messageOrUri, FileSystemProviderErrorCode.FileIsADirectory, FileSystemError.FileIsADirectory);\n\t}\n\tstatic NoPermissions(messageOrUri?: string | URI): FileSystemError {\n\t\treturn new FileSystemError(messageOrUri, FileSystemProviderErrorCode.NoPermissions, FileSystemError.NoPermissions);\n\t}\n\tstatic Unavailable(messageOrUri?: string | URI): FileSystemError {\n\t\treturn new FileSystemError(messageOrUri, FileSystemProviderErrorCode.Unavailable, FileSystemError.Unavailable);\n\t}\n\n\treadonly code: string;\n\n\tconstructor(uriOrMessage?: string | URI, code: FileSystemProviderErrorCode = FileSystemProviderErrorCode.Unknown, terminator?: Function) {\n\t\tsuper(URI.isUri(uriOrMessage) ? uriOrMessage.toString(true) : uriOrMessage);\n\n\t\tthis.code = terminator?.name ?? 'Unknown';\n\n\t\t// mark the error as file system provider error so that\n\t\t// we can extract the error code on the receiving side\n\t\tmarkAsFileSystemProviderError(this, code);\n\n\t\t// workaround when extending builtin objects and when compiling to ES5, see:\n\t\t// https://github.com/microsoft/TypeScript-wiki/blob/master/Breaking-Changes.md#extending-built-ins-like-error-array-and-map-may-no-longer-work\n\t\tif (typeof (<any>Object).setPrototypeOf === 'function') {\n\t\t\t(<any>Object).setPrototypeOf(this, FileSystemError.prototype);\n\t\t}\n\n\t\tif (typeof Error.captureStackTrace === 'function' && typeof terminator === 'function') {\n\t\t\t// nice stack traces\n\t\t\tError.captureStackTrace(this, terminator);\n\t\t}\n\t}\n}\n\n//#endregion\n\n//#region folding api\n\n@es5ClassCompat\nexport class FoldingRange {\n\n\tstart: number;\n\n\tend: number;\n\n\tkind?: FoldingRangeKind;\n\n\tconstructor(start: number, end: number, kind?: FoldingRangeKind) {\n\t\tthis.start = start;\n\t\tthis.end = end;\n\t\tthis.kind = kind;\n\t}\n}\n\nexport enum FoldingRangeKind {\n\tComment = 1,\n\tImports = 2,\n\tRegion = 3\n}\n\n//#endregion\n\n//#region Comment\nexport enum CommentThreadCollapsibleState {\n\t/**\n\t * Determines an item is collapsed\n\t */\n\tCollapsed = 0,\n\t/**\n\t * Determines an item is expanded\n\t */\n\tExpanded = 1\n}\n\nexport enum CommentMode {\n\tEditing = 0,\n\tPreview = 1\n}\n\nexport enum CommentThreadState {\n\tUnresolved = 0,\n\tResolved = 1\n}\n\n//#endregion\n\n//#region Semantic Coloring\n\nexport class SemanticTokensLegend {\n\tpublic readonly tokenTypes: string[];\n\tpublic readonly tokenModifiers: string[];\n\n\tconstructor(tokenTypes: string[], tokenModifiers: string[] = []) {\n\t\tthis.tokenTypes = tokenTypes;\n\t\tthis.tokenModifiers = tokenModifiers;\n\t}\n}\n\nfunction isStrArrayOrUndefined(arg: any): arg is string[] | undefined {\n\treturn ((typeof arg === 'undefined') || isStringArray(arg));\n}\n\nexport class SemanticTokensBuilder {\n\n\tprivate _prevLine: number;\n\tprivate _prevChar: number;\n\tprivate _dataIsSortedAndDeltaEncoded: boolean;\n\tprivate _data: number[];\n\tprivate _dataLen: number;\n\tprivate _tokenTypeStrToInt: Map<string, number>;\n\tprivate _tokenModifierStrToInt: Map<string, number>;\n\tprivate _hasLegend: boolean;\n\n\tconstructor(legend?: vscode.SemanticTokensLegend) {\n\t\tthis._prevLine = 0;\n\t\tthis._prevChar = 0;\n\t\tthis._dataIsSortedAndDeltaEncoded = true;\n\t\tthis._data = [];\n\t\tthis._dataLen = 0;\n\t\tthis._tokenTypeStrToInt = new Map<string, number>();\n\t\tthis._tokenModifierStrToInt = new Map<string, number>();\n\t\tthis._hasLegend = false;\n\t\tif (legend) {\n\t\t\tthis._hasLegend = true;\n\t\t\tfor (let i = 0, len = legend.tokenTypes.length; i < len; i++) {\n\t\t\t\tthis._tokenTypeStrToInt.set(legend.tokenTypes[i], i);\n\t\t\t}\n\t\t\tfor (let i = 0, len = legend.tokenModifiers.length; i < len; i++) {\n\t\t\t\tthis._tokenModifierStrToInt.set(legend.tokenModifiers[i], i);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic push(line: number, char: number, length: number, tokenType: number, tokenModifiers?: number): void;\n\tpublic push(range: Range, tokenType: string, tokenModifiers?: string[]): void;\n\tpublic push(arg0: any, arg1: any, arg2: any, arg3?: any, arg4?: any): void {\n\t\tif (typeof arg0 === 'number' && typeof arg1 === 'number' && typeof arg2 === 'number' && typeof arg3 === 'number' && (typeof arg4 === 'number' || typeof arg4 === 'undefined')) {\n\t\t\tif (typeof arg4 === 'undefined') {\n\t\t\t\targ4 = 0;\n\t\t\t}\n\t\t\t// 1st overload\n\t\t\treturn this._pushEncoded(arg0, arg1, arg2, arg3, arg4);\n\t\t}\n\t\tif (Range.isRange(arg0) && typeof arg1 === 'string' && isStrArrayOrUndefined(arg2)) {\n\t\t\t// 2nd overload\n\t\t\treturn this._push(arg0, arg1, arg2);\n\t\t}\n\t\tthrow illegalArgument();\n\t}\n\n\tprivate _push(range: vscode.Range, tokenType: string, tokenModifiers?: string[]): void {\n\t\tif (!this._hasLegend) {\n\t\t\tthrow new Error('Legend must be provided in constructor');\n\t\t}\n\t\tif (range.start.line !== range.end.line) {\n\t\t\tthrow new Error('`range` cannot span multiple lines');\n\t\t}\n\t\tif (!this._tokenTypeStrToInt.has(tokenType)) {\n\t\t\tthrow new Error('`tokenType` is not in the provided legend');\n\t\t}\n\t\tconst line = range.start.line;\n\t\tconst char = range.start.character;\n\t\tconst length = range.end.character - range.start.character;\n\t\tconst nTokenType = this._tokenTypeStrToInt.get(tokenType)!;\n\t\tlet nTokenModifiers = 0;\n\t\tif (tokenModifiers) {\n\t\t\tfor (const tokenModifier of tokenModifiers) {\n\t\t\t\tif (!this._tokenModifierStrToInt.has(tokenModifier)) {\n\t\t\t\t\tthrow new Error('`tokenModifier` is not in the provided legend');\n\t\t\t\t}\n\t\t\t\tconst nTokenModifier = this._tokenModifierStrToInt.get(tokenModifier)!;\n\t\t\t\tnTokenModifiers |= (1 << nTokenModifier) >>> 0;\n\t\t\t}\n\t\t}\n\t\tthis._pushEncoded(line, char, length, nTokenType, nTokenModifiers);\n\t}\n\n\tprivate _pushEncoded(line: number, char: number, length: number, tokenType: number, tokenModifiers: number): void {\n\t\tif (this._dataIsSortedAndDeltaEncoded && (line < this._prevLine || (line === this._prevLine && char < this._prevChar))) {\n\t\t\t// push calls were ordered and are no longer ordered\n\t\t\tthis._dataIsSortedAndDeltaEncoded = false;\n\n\t\t\t// Remove delta encoding from data\n\t\t\tconst tokenCount = (this._data.length / 5) | 0;\n\t\t\tlet prevLine = 0;\n\t\t\tlet prevChar = 0;\n\t\t\tfor (let i = 0; i < tokenCount; i++) {\n\t\t\t\tlet line = this._data[5 * i];\n\t\t\t\tlet char = this._data[5 * i + 1];\n\n\t\t\t\tif (line === 0) {\n\t\t\t\t\t// on the same line as previous token\n\t\t\t\t\tline = prevLine;\n\t\t\t\t\tchar += prevChar;\n\t\t\t\t} else {\n\t\t\t\t\t// on a different line than previous token\n\t\t\t\t\tline += prevLine;\n\t\t\t\t}\n\n\t\t\t\tthis._data[5 * i] = line;\n\t\t\t\tthis._data[5 * i + 1] = char;\n\n\t\t\t\tprevLine = line;\n\t\t\t\tprevChar = char;\n\t\t\t}\n\t\t}\n\n\t\tlet pushLine = line;\n\t\tlet pushChar = char;\n\t\tif (this._dataIsSortedAndDeltaEncoded && this._dataLen > 0) {\n\t\t\tpushLine -= this._prevLine;\n\t\t\tif (pushLine === 0) {\n\t\t\t\tpushChar -= this._prevChar;\n\t\t\t}\n\t\t}\n\n\t\tthis._data[this._dataLen++] = pushLine;\n\t\tthis._data[this._dataLen++] = pushChar;\n\t\tthis._data[this._dataLen++] = length;\n\t\tthis._data[this._dataLen++] = tokenType;\n\t\tthis._data[this._dataLen++] = tokenModifiers;\n\n\t\tthis._prevLine = line;\n\t\tthis._prevChar = char;\n\t}\n\n\tprivate static _sortAndDeltaEncode(data: number[]): Uint32Array {\n\t\tconst pos: number[] = [];\n\t\tconst tokenCount = (data.length / 5) | 0;\n\t\tfor (let i = 0; i < tokenCount; i++) {\n\t\t\tpos[i] = i;\n\t\t}\n\t\tpos.sort((a, b) => {\n\t\t\tconst aLine = data[5 * a];\n\t\t\tconst bLine = data[5 * b];\n\t\t\tif (aLine === bLine) {\n\t\t\t\tconst aChar = data[5 * a + 1];\n\t\t\t\tconst bChar = data[5 * b + 1];\n\t\t\t\treturn aChar - bChar;\n\t\t\t}\n\t\t\treturn aLine - bLine;\n\t\t});\n\t\tconst result = new Uint32Array(data.length);\n\t\tlet prevLine = 0;\n\t\tlet prevChar = 0;\n\t\tfor (let i = 0; i < tokenCount; i++) {\n\t\t\tconst srcOffset = 5 * pos[i];\n\t\t\tconst line = data[srcOffset + 0];\n\t\t\tconst char = data[srcOffset + 1];\n\t\t\tconst length = data[srcOffset + 2];\n\t\t\tconst tokenType = data[srcOffset + 3];\n\t\t\tconst tokenModifiers = data[srcOffset + 4];\n\n\t\t\tconst pushLine = line - prevLine;\n\t\t\tconst pushChar = (pushLine === 0 ? char - prevChar : char);\n\n\t\t\tconst dstOffset = 5 * i;\n\t\t\tresult[dstOffset + 0] = pushLine;\n\t\t\tresult[dstOffset + 1] = pushChar;\n\t\t\tresult[dstOffset + 2] = length;\n\t\t\tresult[dstOffset + 3] = tokenType;\n\t\t\tresult[dstOffset + 4] = tokenModifiers;\n\n\t\t\tprevLine = line;\n\t\t\tprevChar = char;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tpublic build(resultId?: string): SemanticTokens {\n\t\tif (!this._dataIsSortedAndDeltaEncoded) {\n\t\t\treturn new SemanticTokens(SemanticTokensBuilder._sortAndDeltaEncode(this._data), resultId);\n\t\t}\n\t\treturn new SemanticTokens(new Uint32Array(this._data), resultId);\n\t}\n}\n\nexport class SemanticTokens {\n\treadonly resultId: string | undefined;\n\treadonly data: Uint32Array;\n\n\tconstructor(data: Uint32Array, resultId?: string) {\n\t\tthis.resultId = resultId;\n\t\tthis.data = data;\n\t}\n}\n\nexport class SemanticTokensEdit {\n\treadonly start: number;\n\treadonly deleteCount: number;\n\treadonly data: Uint32Array | undefined;\n\n\tconstructor(start: number, deleteCount: number, data?: Uint32Array) {\n\t\tthis.start = start;\n\t\tthis.deleteCount = deleteCount;\n\t\tthis.data = data;\n\t}\n}\n\nexport class SemanticTokensEdits {\n\treadonly resultId: string | undefined;\n\treadonly edits: SemanticTokensEdit[];\n\n\tconstructor(edits: SemanticTokensEdit[], resultId?: string) {\n\t\tthis.resultId = resultId;\n\t\tthis.edits = edits;\n\t}\n}\n\n//#endregion\n\n//#region debug\nexport enum DebugConsoleMode {\n\t/**\n\t * Debug session should have a separate debug console.\n\t */\n\tSeparate = 0,\n\n\t/**\n\t * Debug session should share debug console with its parent session.\n\t * This value has no effect for sessions which do not have a parent session.\n\t */\n\tMergeWithParent = 1\n}\n\n//#endregion\n\n@es5ClassCompat\nexport class QuickInputButtons {\n\n\tstatic readonly Back: vscode.QuickInputButton = { iconPath: new ThemeIcon('arrow-left') };\n\n\tprivate constructor() { }\n}\n\nexport enum QuickPickItemKind {\n\tSeparator = -1,\n\tDefault = 0,\n}\n\nexport enum InputBoxValidationSeverity {\n\tInfo = 1,\n\tWarning = 2,\n\tError = 3\n}\n\nexport enum ExtensionKind {\n\tUI = 1,\n\tWorkspace = 2\n}\n\nexport class FileDecoration {\n\n\tstatic validate(d: FileDecoration): boolean {\n\t\tif (d.badge) {\n\t\t\tlet len = nextCharLength(d.badge, 0);\n\t\t\tif (len < d.badge.length) {\n\t\t\t\tlen += nextCharLength(d.badge, len);\n\t\t\t}\n\t\t\tif (d.badge.length > len) {\n\t\t\t\tthrow new Error(`The 'badge'-property must be undefined or a short character`);\n\t\t\t}\n\t\t}\n\t\tif (!d.color && !d.badge && !d.tooltip) {\n\t\t\tthrow new Error(`The decoration is empty`);\n\t\t}\n\t\treturn true;\n\t}\n\n\tbadge?: string;\n\ttooltip?: string;\n\tcolor?: vscode.ThemeColor;\n\tpropagate?: boolean;\n\n\tconstructor(badge?: string, tooltip?: string, color?: ThemeColor) {\n\t\tthis.badge = badge;\n\t\tthis.tooltip = tooltip;\n\t\tthis.color = color;\n\t}\n}\n\n//#region Theming\n\n@es5ClassCompat\nexport class ColorTheme implements vscode.ColorTheme {\n\tconstructor(public readonly kind: ColorThemeKind) {\n\t}\n}\n\nexport enum ColorThemeKind {\n\tLight = 1,\n\tDark = 2,\n\tHighContrast = 3,\n\tHighContrastLight = 4\n}\n\n//#endregion Theming\n\n//#region Notebook\n\nexport class NotebookRange {\n\tstatic isNotebookRange(thing: any): thing is vscode.NotebookRange {\n\t\tif (thing instanceof NotebookRange) {\n\t\t\treturn true;\n\t\t}\n\t\tif (!thing) {\n\t\t\treturn false;\n\t\t}\n\t\treturn typeof (<NotebookRange>thing).start === 'number'\n\t\t\t&& typeof (<NotebookRange>thing).end === 'number';\n\t}\n\n\tprivate _start: number;\n\tprivate _end: number;\n\n\tget start() {\n\t\treturn this._start;\n\t}\n\n\tget end() {\n\t\treturn this._end;\n\t}\n\n\tget isEmpty(): boolean {\n\t\treturn this._start === this._end;\n\t}\n\n\tconstructor(start: number, end: number) {\n\t\tif (start < 0) {\n\t\t\tthrow illegalArgument('start must be positive');\n\t\t}\n\t\tif (end < 0) {\n\t\t\tthrow illegalArgument('end must be positive');\n\t\t}\n\t\tif (start <= end) {\n\t\t\tthis._start = start;\n\t\t\tthis._end = end;\n\t\t} else {\n\t\t\tthis._start = end;\n\t\t\tthis._end = start;\n\t\t}\n\t}\n\n\twith(change: { start?: number; end?: number }): NotebookRange {\n\t\tlet start = this._start;\n\t\tlet end = this._end;\n\n\t\tif (change.start !== undefined) {\n\t\t\tstart = change.start;\n\t\t}\n\t\tif (change.end !== undefined) {\n\t\t\tend = change.end;\n\t\t}\n\t\tif (start === this._start && end === this._end) {\n\t\t\treturn this;\n\t\t}\n\t\treturn new NotebookRange(start, end);\n\t}\n}\n\nexport class NotebookCellData {\n\n\tstatic validate(data: NotebookCellData): void {\n\t\tif (typeof data.kind !== 'number') {\n\t\t\tthrow new Error('NotebookCellData MUST have \\'kind\\' property');\n\t\t}\n\t\tif (typeof data.value !== 'string') {\n\t\t\tthrow new Error('NotebookCellData MUST have \\'value\\' property');\n\t\t}\n\t\tif (typeof data.languageId !== 'string') {\n\t\t\tthrow new Error('NotebookCellData MUST have \\'languageId\\' property');\n\t\t}\n\t}\n\n\tstatic isNotebookCellDataArray(value: unknown): value is vscode.NotebookCellData[] {\n\t\treturn Array.isArray(value) && (<unknown[]>value).every(elem => NotebookCellData.isNotebookCellData(elem));\n\t}\n\n\tstatic isNotebookCellData(value: unknown): value is vscode.NotebookCellData {\n\t\t// return value instanceof NotebookCellData;\n\t\treturn true;\n\t}\n\n\tkind: NotebookCellKind;\n\tvalue: string;\n\tlanguageId: string;\n\tmime?: string;\n\toutputs?: vscode.NotebookCellOutput[];\n\tmetadata?: Record<string, any>;\n\texecutionSummary?: vscode.NotebookCellExecutionSummary;\n\n\tconstructor(kind: NotebookCellKind, value: string, languageId: string, mime?: string, outputs?: vscode.NotebookCellOutput[], metadata?: Record<string, any>, executionSummary?: vscode.NotebookCellExecutionSummary) {\n\t\tthis.kind = kind;\n\t\tthis.value = value;\n\t\tthis.languageId = languageId;\n\t\tthis.mime = mime;\n\t\tthis.outputs = outputs ?? [];\n\t\tthis.metadata = metadata;\n\t\tthis.executionSummary = executionSummary;\n\n\t\tNotebookCellData.validate(this);\n\t}\n}\n\nexport class NotebookData {\n\n\tcells: NotebookCellData[];\n\tmetadata?: { [key: string]: any };\n\n\tconstructor(cells: NotebookCellData[]) {\n\t\tthis.cells = cells;\n\t}\n}\n\n\nexport class NotebookCellOutputItem {\n\n\tstatic isNotebookCellOutputItem(obj: unknown): obj is vscode.NotebookCellOutputItem {\n\t\tif (obj instanceof NotebookCellOutputItem) {\n\t\t\treturn true;\n\t\t}\n\t\tif (!obj) {\n\t\t\treturn false;\n\t\t}\n\t\treturn typeof (<vscode.NotebookCellOutputItem>obj).mime === 'string'\n\t\t\t&& (<vscode.NotebookCellOutputItem>obj).data instanceof Uint8Array;\n\t}\n\n\tstatic error(err: Error | { name: string; message?: string; stack?: string }): NotebookCellOutputItem {\n\t\tconst obj = {\n\t\t\tname: err.name,\n\t\t\tmessage: err.message,\n\t\t\tstack: err.stack\n\t\t};\n\t\treturn NotebookCellOutputItem.json(obj, 'application/vnd.code.notebook.error');\n\t}\n\n\tstatic stdout(value: string): NotebookCellOutputItem {\n\t\treturn NotebookCellOutputItem.text(value, 'application/vnd.code.notebook.stdout');\n\t}\n\n\tstatic stderr(value: string): NotebookCellOutputItem {\n\t\treturn NotebookCellOutputItem.text(value, 'application/vnd.code.notebook.stderr');\n\t}\n\n\tstatic bytes(value: Uint8Array, mime: string = 'application/octet-stream'): NotebookCellOutputItem {\n\t\treturn new NotebookCellOutputItem(value, mime);\n\t}\n\n\tstatic #encoder = new TextEncoder();\n\n\tstatic text(value: string, mime: string = Mimes.text): NotebookCellOutputItem {\n\t\tconst bytes = NotebookCellOutputItem.#encoder.encode(String(value));\n\t\treturn new NotebookCellOutputItem(bytes, mime);\n\t}\n\n\tstatic json(value: any, mime: string = 'text/x-json'): NotebookCellOutputItem {\n\t\tconst rawStr = JSON.stringify(value, undefined, '\\t');\n\t\treturn NotebookCellOutputItem.text(rawStr, mime);\n\t}\n\n\tconstructor(\n\t\tpublic data: Uint8Array,\n\t\tpublic mime: string,\n\t) {\n\t\tconst mimeNormalized = normalizeMimeType(mime, true);\n\t\tif (!mimeNormalized) {\n\t\t\tthrow new Error(`INVALID mime type: ${mime}. Must be in the format \"type/subtype[;optionalparameter]\"`);\n\t\t}\n\t\tthis.mime = mimeNormalized;\n\t}\n}\n\nexport class NotebookCellOutput {\n\n\tstatic isNotebookCellOutput(candidate: any): candidate is vscode.NotebookCellOutput {\n\t\tif (candidate instanceof NotebookCellOutput) {\n\t\t\treturn true;\n\t\t}\n\t\tif (!candidate || typeof candidate !== 'object') {\n\t\t\treturn false;\n\t\t}\n\t\treturn typeof (<NotebookCellOutput>candidate).id === 'string' && isArray((<NotebookCellOutput>candidate).items);\n\t}\n\n\tstatic ensureUniqueMimeTypes(items: NotebookCellOutputItem[], warn: boolean = false): NotebookCellOutputItem[] {\n\t\tconst seen = new Set<string>();\n\t\tconst removeIdx = new Set<number>();\n\t\tfor (let i = 0; i < items.length; i++) {\n\t\t\tconst item = items[i];\n\t\t\tconst normalMime = normalizeMimeType(item.mime);\n\t\t\tif (!seen.has(normalMime)) {\n\t\t\t\tseen.add(normalMime);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t// duplicated mime types... first has won\n\t\t\tremoveIdx.add(i);\n\t\t\tif (warn) {\n\t\t\t\tconsole.warn(`DUPLICATED mime type '${item.mime}' will be dropped`);\n\t\t\t}\n\t\t}\n\t\tif (removeIdx.size === 0) {\n\t\t\treturn items;\n\t\t}\n\t\treturn items.filter((_item, index) => !removeIdx.has(index));\n\t}\n\n\tid: string;\n\titems: NotebookCellOutputItem[];\n\tmetadata?: Record<string, any>;\n\n\tconstructor(\n\t\titems: NotebookCellOutputItem[],\n\t\tidOrMetadata?: string | Record<string, any>,\n\t\tmetadata?: Record<string, any>\n\t) {\n\t\tthis.items = NotebookCellOutput.ensureUniqueMimeTypes(items, true);\n\t\tif (typeof idOrMetadata === 'string') {\n\t\t\tthis.id = idOrMetadata;\n\t\t\tthis.metadata = metadata;\n\t\t} else {\n\t\t\tthis.id = generateUuid();\n\t\t\tthis.metadata = idOrMetadata ?? metadata;\n\t\t}\n\t}\n}\n\nexport enum NotebookCellKind {\n\tMarkup = 1,\n\tCode = 2\n}\n\nexport enum NotebookCellExecutionState {\n\tIdle = 1,\n\tPending = 2,\n\tExecuting = 3,\n}\n\nexport enum NotebookCellStatusBarAlignment {\n\tLeft = 1,\n\tRight = 2\n}\n\nexport enum NotebookEditorRevealType {\n\tDefault = 0,\n\tInCenter = 1,\n\tInCenterIfOutsideViewport = 2,\n\tAtTop = 3\n}\n\nexport class NotebookCellStatusBarItem {\n\tconstructor(\n\t\tpublic text: string,\n\t\tpublic alignment: NotebookCellStatusBarAlignment) { }\n}\n\n\nexport enum NotebookControllerAffinity {\n\tDefault = 1,\n\tPreferred = 2\n}\n\nexport class NotebookRendererScript {\n\n\tpublic provides: string[];\n\n\tconstructor(\n\t\tpublic uri: vscode.Uri,\n\t\tprovides: string | string[] = []\n\t) {\n\t\tthis.provides = asArray(provides);\n\t}\n}\n\n//#endregion\n\n//#region Timeline\n\n@es5ClassCompat\nexport class TimelineItem implements vscode.TimelineItem {\n\tconstructor(public label: string, public timestamp: number) { }\n}\n\n//#endregion Timeline\n\n//#region ExtensionContext\n\nexport enum ExtensionMode {\n\t/**\n\t * The extension is installed normally (for example, from the marketplace\n\t * or VSIX) in VS Code.\n\t */\n\tProduction = 1,\n\n\t/**\n\t * The extension is running from an `--extensionDevelopmentPath` provided\n\t * when launching VS Code.\n\t */\n\tDevelopment = 2,\n\n\t/**\n\t * The extension is running from an `--extensionDevelopmentPath` and\n\t * the extension host is running unit tests.\n\t */\n\tTest = 3,\n}\n\nexport enum ExtensionRuntime {\n\t/**\n\t * The extension is running in a NodeJS extension host. Runtime access to NodeJS APIs is available.\n\t */\n\tNode = 1,\n\t/**\n\t * The extension is running in a Webworker extension host. Runtime access is limited to Webworker APIs.\n\t */\n\tWebworker = 2\n}\n\n//#endregion ExtensionContext\n\nexport enum StandardTokenType {\n\tOther = 0,\n\tComment = 1,\n\tString = 2,\n\tRegEx = 3\n}\n\n\nexport class LinkedEditingRanges {\n\tconstructor(public readonly ranges: Range[], public readonly wordPattern?: RegExp) {\n\t}\n}\n\n//#region ports\nexport class PortAttributes {\n\tprivate _port: number;\n\tprivate _autoForwardAction: PortAutoForwardAction;\n\tconstructor(port: number, autoForwardAction: PortAutoForwardAction) {\n\t\tthis._port = port;\n\t\tthis._autoForwardAction = autoForwardAction;\n\t}\n\n\tget port(): number {\n\t\treturn this._port;\n\t}\n\n\tget autoForwardAction(): PortAutoForwardAction {\n\t\treturn this._autoForwardAction;\n\t}\n}\n//#endregion ports\n\n//#region Testing\nexport enum TestResultState {\n\tQueued = 1,\n\tRunning = 2,\n\tPassed = 3,\n\tFailed = 4,\n\tSkipped = 5,\n\tErrored = 6\n}\n\nexport enum TestRunProfileKind {\n\tRun = 1,\n\tDebug = 2,\n\tCoverage = 3,\n}\n\n@es5ClassCompat\nexport class TestRunRequest implements vscode.TestRunRequest {\n\tconstructor(\n\t\tpublic readonly include: vscode.TestItem[] | undefined = undefined,\n\t\tpublic readonly exclude: vscode.TestItem[] | undefined = undefined,\n\t\tpublic readonly profile: vscode.TestRunProfile | undefined = undefined,\n\t) { }\n}\n\n@es5ClassCompat\nexport class TestMessage implements vscode.TestMessage {\n\tpublic expectedOutput?: string;\n\tpublic actualOutput?: string;\n\tpublic location?: vscode.Location;\n\n\tpublic static diff(message: string | vscode.MarkdownString, expected: string, actual: string) {\n\t\tconst msg = new TestMessage(message);\n\t\tmsg.expectedOutput = expected;\n\t\tmsg.actualOutput = actual;\n\t\treturn msg;\n\t}\n\n\tconstructor(public message: string | vscode.MarkdownString) { }\n}\n\n@es5ClassCompat\nexport class TestTag implements vscode.TestTag {\n\tconstructor(public readonly id: string) { }\n}\n\n//#endregion\n\n//#region Test Coverage\n@es5ClassCompat\nexport class CoveredCount implements vscode.CoveredCount {\n\tconstructor(public covered: number, public total: number) { }\n}\n\n@es5ClassCompat\nexport class FileCoverage implements vscode.FileCoverage {\n\tpublic static fromDetails(uri: vscode.Uri, details: vscode.DetailedCoverage[]): vscode.FileCoverage {\n\t\tconst statements = new CoveredCount(0, 0);\n\t\tconst branches = new CoveredCount(0, 0);\n\t\tconst fn = new CoveredCount(0, 0);\n\n\t\tfor (const detail of details) {\n\t\t\tif ('branches' in detail) {\n\t\t\t\tstatements.total += 1;\n\t\t\t\tstatements.covered += detail.executionCount > 0 ? 1 : 0;\n\n\t\t\t\tfor (const branch of detail.branches) {\n\t\t\t\t\tbranches.total += 1;\n\t\t\t\t\tbranches.covered += branch.executionCount > 0 ? 1 : 0;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfn.total += 1;\n\t\t\t\tfn.covered += detail.executionCount > 0 ? 1 : 0;\n\t\t\t}\n\t\t}\n\n\t\tconst coverage = new FileCoverage(\n\t\t\turi,\n\t\t\tstatements,\n\t\t\tbranches.total > 0 ? branches : undefined,\n\t\t\tfn.total > 0 ? fn : undefined,\n\t\t);\n\n\t\tcoverage.detailedCoverage = details;\n\n\t\treturn coverage;\n\t}\n\n\tdetailedCoverage?: vscode.DetailedCoverage[];\n\n\tconstructor(\n\t\tpublic readonly uri: vscode.Uri,\n\t\tpublic statementCoverage: vscode.CoveredCount,\n\t\tpublic branchCoverage?: vscode.CoveredCount,\n\t\tpublic functionCoverage?: vscode.CoveredCount,\n\t) { }\n}\n\n@es5ClassCompat\nexport class StatementCoverage implements vscode.StatementCoverage {\n\tconstructor(\n\t\tpublic executionCount: number,\n\t\tpublic location: Position | Range,\n\t\tpublic branches: vscode.BranchCoverage[] = [],\n\t) { }\n}\n\n@es5ClassCompat\nexport class BranchCoverage implements vscode.BranchCoverage {\n\tconstructor(\n\t\tpublic executionCount: number,\n\t\tpublic location: Position | Range,\n\t) { }\n}\n\n@es5ClassCompat\nexport class FunctionCoverage implements vscode.FunctionCoverage {\n\tconstructor(\n\t\tpublic executionCount: number,\n\t\tpublic location: Position | Range,\n\t) { }\n}\n//#endregion\n\nexport enum ExternalUriOpenerPriority {\n\tNone = 0,\n\tOption = 1,\n\tDefault = 2,\n\tPreferred = 3,\n}\n\nexport enum WorkspaceTrustState {\n\tUntrusted = 0,\n\tTrusted = 1,\n\tUnspecified = 2\n}\n\nexport enum PortAutoForwardAction {\n\tNotify = 1,\n\tOpenBrowser = 2,\n\tOpenPreview = 3,\n\tSilent = 4,\n\tIgnore = 5,\n\tOpenBrowserOnce = 6\n}\n\nexport class TypeHierarchyItem {\n\t_sessionId?: string;\n\t_itemId?: string;\n\n\tkind: SymbolKind;\n\ttags?: SymbolTag[];\n\tname: string;\n\tdetail?: string;\n\turi: URI;\n\trange: Range;\n\tselectionRange: Range;\n\n\tconstructor(kind: SymbolKind, name: string, detail: string, uri: URI, range: Range, selectionRange: Range) {\n\t\tthis.kind = kind;\n\t\tthis.name = name;\n\t\tthis.detail = detail;\n\t\tthis.uri = uri;\n\t\tthis.range = range;\n\t\tthis.selectionRange = selectionRange;\n\t}\n}\n\n//#region Tab Inputs\n\nexport class TextTabInput {\n\tconstructor(readonly uri: URI) { }\n}\n\nexport class TextDiffTabInput {\n\tconstructor(readonly original: URI, readonly modified: URI) { }\n}\n\nexport class TextMergeTabInput {\n\tconstructor(readonly base: URI, readonly input1: URI, readonly input2: URI, readonly result: URI) { }\n}\n\nexport class CustomEditorTabInput {\n\tconstructor(readonly uri: URI, readonly viewType: string) { }\n}\n\nexport class WebviewEditorTabInput {\n\tconstructor(readonly viewType: string) { }\n}\n\nexport class NotebookEditorTabInput {\n\tconstructor(readonly uri: URI, readonly notebookType: string) { }\n}\n\nexport class NotebookDiffEditorTabInput {\n\tconstructor(readonly original: URI, readonly modified: URI, readonly notebookType: string) { }\n}\n\nexport class TerminalEditorTabInput {\n\tconstructor() { }\n}\nexport class InteractiveWindowInput {\n\tconstructor(readonly uri: URI, readonly inputBoxUri: URI) { }\n}\n//#endregion\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ok } from 'vs/base/common/assert';\nimport { Schemas } from 'vs/base/common/network';\nimport { regExpLeadsToEndlessLoop } from 'vs/base/common/strings';\nimport { URI } from 'vs/base/common/uri';\nimport { MirrorTextModel } from 'vs/editor/common/model/mirrorTextModel';\nimport { ensureValidWordDefinition, getWordAtText } from 'vs/editor/common/core/wordHelper';\nimport { MainThreadDocumentsShape } from 'vs/workbench/api/common/extHost.protocol';\nimport { EndOfLine, Position, Range } from 'vs/workbench/api/common/extHostTypes';\nimport type * as vscode from 'vscode';\nimport { equals } from 'vs/base/common/arrays';\n\nconst _languageId2WordDefinition = new Map<string, RegExp>();\nexport function setWordDefinitionFor(languageId: string, wordDefinition: RegExp | undefined): void {\n\tif (!wordDefinition) {\n\t\t_languageId2WordDefinition.delete(languageId);\n\t} else {\n\t\t_languageId2WordDefinition.set(languageId, wordDefinition);\n\t}\n}\n\nexport function getWordDefinitionFor(languageId: string): RegExp | undefined {\n\treturn _languageId2WordDefinition.get(languageId);\n}\n\nexport class ExtHostDocumentData extends MirrorTextModel {\n\n\tprivate _document?: vscode.TextDocument;\n\tprivate _isDisposed: boolean = false;\n\n\tconstructor(\n\t\tprivate readonly _proxy: MainThreadDocumentsShape,\n\t\turi: URI, lines: string[], eol: string, versionId: number,\n\t\tprivate _languageId: string,\n\t\tprivate _isDirty: boolean,\n\t\tpublic readonly notebook?: vscode.NotebookDocument | undefined\n\t) {\n\t\tsuper(uri, lines, eol, versionId);\n\t}\n\n\toverride dispose(): void {\n\t\t// we don't really dispose documents but let\n\t\t// extensions still read from them. some\n\t\t// operations, live saving, will now error tho\n\t\tok(!this._isDisposed);\n\t\tthis._isDisposed = true;\n\t\tthis._isDirty = false;\n\t}\n\n\tequalLines(lines: readonly string[]): boolean {\n\t\treturn equals(this._lines, lines);\n\t}\n\n\tget document(): vscode.TextDocument {\n\t\tif (!this._document) {\n\t\t\tconst that = this;\n\t\t\tthis._document = {\n\t\t\t\tget uri() { return that._uri; },\n\t\t\t\tget fileName() { return that._uri.fsPath; },\n\t\t\t\tget isUntitled() { return that._uri.scheme === Schemas.untitled; },\n\t\t\t\tget languageId() { return that._languageId; },\n\t\t\t\tget version() { return that._versionId; },\n\t\t\t\tget isClosed() { return that._isDisposed; },\n\t\t\t\tget isDirty() { return that._isDirty; },\n\t\t\t\tsave() { return that._save(); },\n\t\t\t\tgetText(range?) { return range ? that._getTextInRange(range) : that.getText(); },\n\t\t\t\tget eol() { return that._eol === '\\n' ? EndOfLine.LF : EndOfLine.CRLF; },\n\t\t\t\tget lineCount() { return that._lines.length; },\n\t\t\t\tlineAt(lineOrPos: number | vscode.Position) { return that._lineAt(lineOrPos); },\n\t\t\t\toffsetAt(pos) { return that._offsetAt(pos); },\n\t\t\t\tpositionAt(offset) { return that._positionAt(offset); },\n\t\t\t\tvalidateRange(ran) { return that._validateRange(ran); },\n\t\t\t\tvalidatePosition(pos) { return that._validatePosition(pos); },\n\t\t\t\tgetWordRangeAtPosition(pos, regexp?) { return that._getWordRangeAtPosition(pos, regexp); },\n\t\t\t};\n\t\t}\n\t\treturn Object.freeze(this._document);\n\t}\n\n\t_acceptLanguageId(newLanguageId: string): void {\n\t\tok(!this._isDisposed);\n\t\tthis._languageId = newLanguageId;\n\t}\n\n\t_acceptIsDirty(isDirty: boolean): void {\n\t\tok(!this._isDisposed);\n\t\tthis._isDirty = isDirty;\n\t}\n\n\tprivate _save(): Promise<boolean> {\n\t\tif (this._isDisposed) {\n\t\t\treturn Promise.reject(new Error('Document has been closed'));\n\t\t}\n\t\treturn this._proxy.$trySaveDocument(this._uri);\n\t}\n\n\tprivate _getTextInRange(_range: vscode.Range): string {\n\t\tconst range = this._validateRange(_range);\n\n\t\tif (range.isEmpty) {\n\t\t\treturn '';\n\t\t}\n\n\t\tif (range.isSingleLine) {\n\t\t\treturn this._lines[range.start.line].substring(range.start.character, range.end.character);\n\t\t}\n\n\t\tconst lineEnding = this._eol,\n\t\t\tstartLineIndex = range.start.line,\n\t\t\tendLineIndex = range.end.line,\n\t\t\tresultLines: string[] = [];\n\n\t\tresultLines.push(this._lines[startLineIndex].substring(range.start.character));\n\t\tfor (let i = startLineIndex + 1; i < endLineIndex; i++) {\n\t\t\tresultLines.push(this._lines[i]);\n\t\t}\n\t\tresultLines.push(this._lines[endLineIndex].substring(0, range.end.character));\n\n\t\treturn resultLines.join(lineEnding);\n\t}\n\n\tprivate _lineAt(lineOrPosition: number | vscode.Position): vscode.TextLine {\n\n\t\tlet line: number | undefined;\n\t\tif (lineOrPosition instanceof Position) {\n\t\t\tline = lineOrPosition.line;\n\t\t} else if (typeof lineOrPosition === 'number') {\n\t\t\tline = lineOrPosition;\n\t\t}\n\n\t\tif (typeof line !== 'number' || line < 0 || line >= this._lines.length || Math.floor(line) !== line) {\n\t\t\tthrow new Error('Illegal value for `line`');\n\t\t}\n\n\t\treturn new ExtHostDocumentLine(line, this._lines[line], line === this._lines.length - 1);\n\t}\n\n\tprivate _offsetAt(position: vscode.Position): number {\n\t\tposition = this._validatePosition(position);\n\t\tthis._ensureLineStarts();\n\t\treturn this._lineStarts!.getPrefixSum(position.line - 1) + position.character;\n\t}\n\n\tprivate _positionAt(offset: number): vscode.Position {\n\t\toffset = Math.floor(offset);\n\t\toffset = Math.max(0, offset);\n\n\t\tthis._ensureLineStarts();\n\t\tconst out = this._lineStarts!.getIndexOf(offset);\n\n\t\tconst lineLength = this._lines[out.index].length;\n\n\t\t// Ensure we return a valid position\n\t\treturn new Position(out.index, Math.min(out.remainder, lineLength));\n\t}\n\n\t// ---- range math\n\n\tprivate _validateRange(range: vscode.Range): vscode.Range {\n\t\tif (!(range instanceof Range)) {\n\t\t\tthrow new Error('Invalid argument');\n\t\t}\n\n\t\tconst start = this._validatePosition(range.start);\n\t\tconst end = this._validatePosition(range.end);\n\n\t\tif (start === range.start && end === range.end) {\n\t\t\treturn range;\n\t\t}\n\t\treturn new Range(start.line, start.character, end.line, end.character);\n\t}\n\n\tprivate _validatePosition(position: vscode.Position): vscode.Position {\n\t\tif (!(position instanceof Position)) {\n\t\t\tthrow new Error('Invalid argument');\n\t\t}\n\n\t\tif (this._lines.length === 0) {\n\t\t\treturn position.with(0, 0);\n\t\t}\n\n\t\tlet { line, character } = position;\n\t\tlet hasChanged = false;\n\n\t\tif (line < 0) {\n\t\t\tline = 0;\n\t\t\tcharacter = 0;\n\t\t\thasChanged = true;\n\t\t}\n\t\telse if (line >= this._lines.length) {\n\t\t\tline = this._lines.length - 1;\n\t\t\tcharacter = this._lines[line].length;\n\t\t\thasChanged = true;\n\t\t}\n\t\telse {\n\t\t\tconst maxCharacter = this._lines[line].length;\n\t\t\tif (character < 0) {\n\t\t\t\tcharacter = 0;\n\t\t\t\thasChanged = true;\n\t\t\t}\n\t\t\telse if (character > maxCharacter) {\n\t\t\t\tcharacter = maxCharacter;\n\t\t\t\thasChanged = true;\n\t\t\t}\n\t\t}\n\n\t\tif (!hasChanged) {\n\t\t\treturn position;\n\t\t}\n\t\treturn new Position(line, character);\n\t}\n\n\tprivate _getWordRangeAtPosition(_position: vscode.Position, regexp?: RegExp): vscode.Range | undefined {\n\t\tconst position = this._validatePosition(_position);\n\n\t\tif (!regexp) {\n\t\t\t// use default when custom-regexp isn't provided\n\t\t\tregexp = getWordDefinitionFor(this._languageId);\n\n\t\t} else if (regExpLeadsToEndlessLoop(regexp)) {\n\t\t\t// use default when custom-regexp is bad\n\t\t\tthrow new Error(`[getWordRangeAtPosition]: ignoring custom regexp '${regexp.source}' because it matches the empty string.`);\n\t\t}\n\n\t\tconst wordAtText = getWordAtText(\n\t\t\tposition.character + 1,\n\t\t\tensureValidWordDefinition(regexp),\n\t\t\tthis._lines[position.line],\n\t\t\t0\n\t\t);\n\n\t\tif (wordAtText) {\n\t\t\treturn new Range(position.line, wordAtText.startColumn - 1, position.line, wordAtText.endColumn - 1);\n\t\t}\n\t\treturn undefined;\n\t}\n}\n\nexport class ExtHostDocumentLine implements vscode.TextLine {\n\n\tprivate readonly _line: number;\n\tprivate readonly _text: string;\n\tprivate readonly _isLastLine: boolean;\n\n\tconstructor(line: number, text: string, isLastLine: boolean) {\n\t\tthis._line = line;\n\t\tthis._text = text;\n\t\tthis._isLastLine = isLastLine;\n\t}\n\n\tpublic get lineNumber(): number {\n\t\treturn this._line;\n\t}\n\n\tpublic get text(): string {\n\t\treturn this._text;\n\t}\n\n\tpublic get range(): Range {\n\t\treturn new Range(this._line, 0, this._line, this._text.length);\n\t}\n\n\tpublic get rangeIncludingLineBreak(): Range {\n\t\tif (this._isLastLine) {\n\t\t\treturn this.range;\n\t\t}\n\t\treturn new Range(this._line, 0, this._line + 1, 0);\n\t}\n\n\tpublic get firstNonWhitespaceCharacterIndex(): number {\n\t\t//TODO@api, rename to 'leadingWhitespaceLength'\n\t\treturn /^(\\s*)/.exec(this._text)![1].length;\n\t}\n\n\tpublic get isEmptyOrWhitespace(): boolean {\n\t\treturn this.firstNonWhitespaceCharacterIndex === this._text.length;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ColorTheme, ColorThemeKind } from './extHostTypes';\nimport { IExtHostRpcService } from 'vs/workbench/api/common/extHostRpcService';\nimport { ExtHostThemingShape } from 'vs/workbench/api/common/extHost.protocol';\nimport { Emitter, Event } from 'vs/base/common/event';\n\nexport class ExtHostTheming implements ExtHostThemingShape {\n\n\treadonly _serviceBrand: undefined;\n\n\tprivate _actual: ColorTheme;\n\tprivate _onDidChangeActiveColorTheme: Emitter<ColorTheme>;\n\n\tconstructor(\n\t\t@IExtHostRpcService _extHostRpc: IExtHostRpcService\n\t) {\n\t\tthis._actual = new ColorTheme(ColorThemeKind.Dark);\n\t\tthis._onDidChangeActiveColorTheme = new Emitter<ColorTheme>();\n\t}\n\n\tpublic get activeColorTheme(): ColorTheme {\n\t\treturn this._actual;\n\t}\n\n\t$onColorThemeChange(type: string): void {\n\t\tlet kind;\n\t\tswitch (type) {\n\t\t\tcase 'light': kind = ColorThemeKind.Light; break;\n\t\t\tcase 'hcDark': kind = ColorThemeKind.HighContrast; break;\n\t\t\tcase 'hcLight': kind = ColorThemeKind.HighContrastLight; break;\n\t\t\tdefault:\n\t\t\t\tkind = ColorThemeKind.Dark;\n\t\t}\n\t\tthis._actual = new ColorTheme(kind);\n\t\tthis._onDidChangeActiveColorTheme.fire(this._actual);\n\t}\n\n\tpublic get onDidChangeActiveColorTheme(): Event<ColorTheme> {\n\t\treturn this._onDidChangeActiveColorTheme.event;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IURITransformer } from 'vs/base/common/uriIpc';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { URI, UriComponents } from 'vs/base/common/uri';\n\nexport interface IURITransformerService extends IURITransformer {\n\treadonly _serviceBrand: undefined;\n}\n\nexport const IURITransformerService = createDecorator<IURITransformerService>('IURITransformerService');\n\nexport class URITransformerService implements IURITransformerService {\n\tdeclare readonly _serviceBrand: undefined;\n\n\ttransformIncoming: (uri: UriComponents) => UriComponents;\n\ttransformOutgoing: (uri: UriComponents) => UriComponents;\n\ttransformOutgoingURI: (uri: URI) => URI;\n\ttransformOutgoingScheme: (scheme: string) => string;\n\n\tconstructor(delegate: IURITransformer | null) {\n\t\tif (!delegate) {\n\t\t\tthis.transformIncoming = arg => arg;\n\t\t\tthis.transformOutgoing = arg => arg;\n\t\t\tthis.transformOutgoingURI = arg => arg;\n\t\t\tthis.transformOutgoingScheme = arg => arg;\n\t\t} else {\n\t\t\tthis.transformIncoming = delegate.transformIncoming.bind(delegate);\n\t\t\tthis.transformOutgoing = delegate.transformOutgoing.bind(delegate);\n\t\t\tthis.transformOutgoingURI = delegate.transformOutgoingURI.bind(delegate);\n\t\t\tthis.transformOutgoingScheme = delegate.transformOutgoingScheme.bind(delegate);\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { VSBuffer } from 'vs/base/common/buffer';\nimport * as extHostProtocol from './extHost.protocol';\n\nclass ArrayBufferSet {\n\tpublic readonly buffers: ArrayBuffer[] = [];\n\n\tpublic add(buffer: ArrayBuffer): number {\n\t\tlet index = this.buffers.indexOf(buffer);\n\t\tif (index < 0) {\n\t\t\tindex = this.buffers.length;\n\t\t\tthis.buffers.push(buffer);\n\t\t}\n\t\treturn index;\n\t}\n}\n\nexport function serializeWebviewMessage(\n\tmessage: any,\n\toptions: { serializeBuffersForPostMessage?: boolean }\n): { message: string; buffers: VSBuffer[] } {\n\tif (options.serializeBuffersForPostMessage) {\n\t\t// Extract all ArrayBuffers from the message and replace them with references.\n\t\tconst arrayBuffers = new ArrayBufferSet();\n\n\t\tconst replacer = (_key: string, value: any) => {\n\t\t\tif (value instanceof ArrayBuffer) {\n\t\t\t\tconst index = arrayBuffers.add(value);\n\t\t\t\treturn <extHostProtocol.WebviewMessageArrayBufferReference>{\n\t\t\t\t\t$$vscode_array_buffer_reference$$: true,\n\t\t\t\t\tindex,\n\t\t\t\t};\n\t\t\t} else if (ArrayBuffer.isView(value)) {\n\t\t\t\tconst type = getTypedArrayType(value);\n\t\t\t\tif (type) {\n\t\t\t\t\tconst index = arrayBuffers.add(value.buffer);\n\t\t\t\t\treturn <extHostProtocol.WebviewMessageArrayBufferReference>{\n\t\t\t\t\t\t$$vscode_array_buffer_reference$$: true,\n\t\t\t\t\t\tindex,\n\t\t\t\t\t\tview: {\n\t\t\t\t\t\t\ttype: type,\n\t\t\t\t\t\t\tbyteLength: value.byteLength,\n\t\t\t\t\t\t\tbyteOffset: value.byteOffset,\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn value;\n\t\t};\n\n\t\tconst serializedMessage = JSON.stringify(message, replacer);\n\n\t\tconst buffers = arrayBuffers.buffers.map(arrayBuffer => {\n\t\t\tconst bytes = new Uint8Array(arrayBuffer);\n\t\t\treturn VSBuffer.wrap(bytes);\n\t\t});\n\n\t\treturn { message: serializedMessage, buffers };\n\t} else {\n\t\treturn { message: JSON.stringify(message), buffers: [] };\n\t}\n}\n\nfunction getTypedArrayType(value: ArrayBufferView): extHostProtocol.WebviewMessageArrayBufferViewType | undefined {\n\tswitch (value.constructor.name) {\n\t\tcase 'Int8Array': return extHostProtocol.WebviewMessageArrayBufferViewType.Int8Array;\n\t\tcase 'Uint8Array': return extHostProtocol.WebviewMessageArrayBufferViewType.Uint8Array;\n\t\tcase 'Uint8ClampedArray': return extHostProtocol.WebviewMessageArrayBufferViewType.Uint8ClampedArray;\n\t\tcase 'Int16Array': return extHostProtocol.WebviewMessageArrayBufferViewType.Int16Array;\n\t\tcase 'Uint16Array': return extHostProtocol.WebviewMessageArrayBufferViewType.Uint16Array;\n\t\tcase 'Int32Array': return extHostProtocol.WebviewMessageArrayBufferViewType.Int32Array;\n\t\tcase 'Uint32Array': return extHostProtocol.WebviewMessageArrayBufferViewType.Uint32Array;\n\t\tcase 'Float32Array': return extHostProtocol.WebviewMessageArrayBufferViewType.Float32Array;\n\t\tcase 'Float64Array': return extHostProtocol.WebviewMessageArrayBufferViewType.Float64Array;\n\t\tcase 'BigInt64Array': return extHostProtocol.WebviewMessageArrayBufferViewType.BigInt64Array;\n\t\tcase 'BigUint64Array': return extHostProtocol.WebviewMessageArrayBufferViewType.BigUint64Array;\n\t}\n\treturn undefined;\n}\n\nexport function deserializeWebviewMessage(jsonMessage: string, buffers: VSBuffer[]): { message: any; arrayBuffers: ArrayBuffer[] } {\n\tconst arrayBuffers: ArrayBuffer[] = buffers.map(buffer => {\n\t\tconst arrayBuffer = new ArrayBuffer(buffer.byteLength);\n\t\tconst uint8Array = new Uint8Array(arrayBuffer);\n\t\tuint8Array.set(buffer.buffer);\n\t\treturn arrayBuffer;\n\t});\n\n\tconst reviver = !buffers.length ? undefined : (_key: string, value: any) => {\n\t\tif (value && typeof value === 'object' && (value as extHostProtocol.WebviewMessageArrayBufferReference).$$vscode_array_buffer_reference$$) {\n\t\t\tconst ref = value as extHostProtocol.WebviewMessageArrayBufferReference;\n\t\t\tconst { index } = ref;\n\t\t\tconst arrayBuffer = arrayBuffers[index];\n\t\t\tif (ref.view) {\n\t\t\t\tswitch (ref.view.type) {\n\t\t\t\t\tcase extHostProtocol.WebviewMessageArrayBufferViewType.Int8Array: return new Int8Array(arrayBuffer, ref.view.byteOffset, ref.view.byteLength / Int8Array.BYTES_PER_ELEMENT);\n\t\t\t\t\tcase extHostProtocol.WebviewMessageArrayBufferViewType.Uint8Array: return new Uint8Array(arrayBuffer, ref.view.byteOffset, ref.view.byteLength / Uint8Array.BYTES_PER_ELEMENT);\n\t\t\t\t\tcase extHostProtocol.WebviewMessageArrayBufferViewType.Uint8ClampedArray: return new Uint8ClampedArray(arrayBuffer, ref.view.byteOffset, ref.view.byteLength / Uint8ClampedArray.BYTES_PER_ELEMENT);\n\t\t\t\t\tcase extHostProtocol.WebviewMessageArrayBufferViewType.Int16Array: return new Int16Array(arrayBuffer, ref.view.byteOffset, ref.view.byteLength / Int16Array.BYTES_PER_ELEMENT);\n\t\t\t\t\tcase extHostProtocol.WebviewMessageArrayBufferViewType.Uint16Array: return new Uint16Array(arrayBuffer, ref.view.byteOffset, ref.view.byteLength / Uint16Array.BYTES_PER_ELEMENT);\n\t\t\t\t\tcase extHostProtocol.WebviewMessageArrayBufferViewType.Int32Array: return new Int32Array(arrayBuffer, ref.view.byteOffset, ref.view.byteLength / Int32Array.BYTES_PER_ELEMENT);\n\t\t\t\t\tcase extHostProtocol.WebviewMessageArrayBufferViewType.Uint32Array: return new Uint32Array(arrayBuffer, ref.view.byteOffset, ref.view.byteLength / Uint32Array.BYTES_PER_ELEMENT);\n\t\t\t\t\tcase extHostProtocol.WebviewMessageArrayBufferViewType.Float32Array: return new Float32Array(arrayBuffer, ref.view.byteOffset, ref.view.byteLength / Float32Array.BYTES_PER_ELEMENT);\n\t\t\t\t\tcase extHostProtocol.WebviewMessageArrayBufferViewType.Float64Array: return new Float64Array(arrayBuffer, ref.view.byteOffset, ref.view.byteLength / Float64Array.BYTES_PER_ELEMENT);\n\t\t\t\t\tcase extHostProtocol.WebviewMessageArrayBufferViewType.BigInt64Array: return new BigInt64Array(arrayBuffer, ref.view.byteOffset, ref.view.byteLength / BigInt64Array.BYTES_PER_ELEMENT);\n\t\t\t\t\tcase extHostProtocol.WebviewMessageArrayBufferViewType.BigUint64Array: return new BigUint64Array(arrayBuffer, ref.view.byteOffset, ref.view.byteLength / BigUint64Array.BYTES_PER_ELEMENT);\n\t\t\t\t\tdefault: throw new Error('Unknown array buffer view type');\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn arrayBuffer;\n\t\t}\n\t\treturn value;\n\t};\n\n\tconst message = JSON.parse(jsonMessage, reviver);\n\treturn { message, arrayBuffers };\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { localize } from 'vs/nls';\nimport { Event } from 'vs/base/common/event';\nimport { assertIsDefined } from 'vs/base/common/types';\nimport { URI } from 'vs/base/common/uri';\nimport { Disposable, IDisposable, toDisposable } from 'vs/base/common/lifecycle';\nimport { ICodeEditorViewState, IDiffEditor, IDiffEditorViewState, IEditor, IEditorViewState } from 'vs/editor/common/editorCommon';\nimport { IEditorOptions, IResourceEditorInput, ITextResourceEditorInput, IBaseTextResourceEditorInput, IBaseUntypedEditorInput } from 'vs/platform/editor/common/editor';\nimport type { EditorInput } from 'vs/workbench/common/editor/editorInput';\nimport { IInstantiationService, IConstructorSignature, ServicesAccessor, BrandedService } from 'vs/platform/instantiation/common/instantiation';\nimport { IContextKeyService } from 'vs/platform/contextkey/common/contextkey';\nimport { Registry } from 'vs/platform/registry/common/platform';\nimport { IEncodingSupport, ILanguageSupport } from 'vs/workbench/services/textfile/common/textfiles';\nimport { IEditorGroup } from 'vs/workbench/services/editor/common/editorGroupsService';\nimport { ICompositeControl, IComposite } from 'vs/workbench/common/composite';\nimport { FileType, IFileService } from 'vs/platform/files/common/files';\nimport { IPathData } from 'vs/platform/window/common/window';\nimport { coalesce } from 'vs/base/common/arrays';\nimport { IExtUri } from 'vs/base/common/resources';\nimport { Schemas } from 'vs/base/common/network';\nimport { IEditorService } from 'vs/workbench/services/editor/common/editorService';\n\n// Static values for editor contributions\nexport const EditorExtensions = {\n\tEditorPane: 'workbench.contributions.editors',\n\tEditorFactory: 'workbench.contributions.editor.inputFactories'\n};\n\n// Static information regarding the text editor\nexport const DEFAULT_EDITOR_ASSOCIATION = {\n\tid: 'default',\n\tdisplayName: localize('promptOpenWith.defaultEditor.displayName', \"Text Editor\"),\n\tproviderDisplayName: localize('builtinProviderDisplayName', \"Built-in\")\n};\n\n/**\n * Side by side editor id.\n */\nexport const SIDE_BY_SIDE_EDITOR_ID = 'workbench.editor.sidebysideEditor';\n\n/**\n * Text diff editor id.\n */\nexport const TEXT_DIFF_EDITOR_ID = 'workbench.editors.textDiffEditor';\n\n/**\n * Binary diff editor id.\n */\nexport const BINARY_DIFF_EDITOR_ID = 'workbench.editors.binaryResourceDiffEditor';\n\nexport interface IEditorDescriptor<T extends IEditorPane> {\n\n\t/**\n\t * The unique type identifier of the editor. All instances\n\t * of the same `IEditorPane` should have the same type\n\t * identifier.\n\t */\n\treadonly typeId: string;\n\n\t/**\n\t * The display name of the editor.\n\t */\n\treadonly name: string;\n\n\t/**\n\t * Instantiates the editor pane using the provided services.\n\t */\n\tinstantiate(instantiationService: IInstantiationService): T;\n\n\t/**\n\t * Whether the descriptor is for the provided editor pane.\n\t */\n\tdescribes(editorPane: T): boolean;\n}\n\n/**\n * The editor pane is the container for workbench editors.\n */\nexport interface IEditorPane extends IComposite {\n\n\t/**\n\t * An event to notify when the `IEditorControl` in this\n\t * editor pane changes.\n\t *\n\t * This can be used for editor panes that are a compound\n\t * of multiple editor controls to signal that the active\n\t * editor control has changed when the user clicks around.\n\t */\n\treadonly onDidChangeControl: Event<void>;\n\n\t/**\n\t * An optional event to notify when the selection inside the editor\n\t * pane changed in case the editor has a selection concept.\n\t *\n\t * For example, in a text editor pane, the selection changes whenever\n\t * the cursor is set to a new location.\n\t */\n\treadonly onDidChangeSelection?: Event<IEditorPaneSelectionChangeEvent>;\n\n\t/**\n\t * The assigned input of this editor.\n\t */\n\treadonly input: EditorInput | undefined;\n\n\t/**\n\t * The assigned options of the editor.\n\t */\n\treadonly options: IEditorOptions | undefined;\n\n\t/**\n\t * The assigned group this editor is showing in.\n\t */\n\treadonly group: IEditorGroup | undefined;\n\n\t/**\n\t * The minimum width of this editor.\n\t */\n\treadonly minimumWidth: number;\n\n\t/**\n\t * The maximum width of this editor.\n\t */\n\treadonly maximumWidth: number;\n\n\t/**\n\t * The minimum height of this editor.\n\t */\n\treadonly minimumHeight: number;\n\n\t/**\n\t * The maximum height of this editor.\n\t */\n\treadonly maximumHeight: number;\n\n\t/**\n\t * An event to notify whenever minimum/maximum width/height changes.\n\t */\n\treadonly onDidChangeSizeConstraints: Event<{ width: number; height: number } | undefined>;\n\n\t/**\n\t * The context key service for this editor. Should be overridden by\n\t * editors that have their own ScopedContextKeyService\n\t */\n\treadonly scopedContextKeyService: IContextKeyService | undefined;\n\n\t/**\n\t * Returns the underlying control of this editor. Callers need to cast\n\t * the control to a specific instance as needed, e.g. by using the\n\t * `isCodeEditor` helper method to access the text code editor.\n\t *\n\t * Use the `onDidChangeControl` event to track whenever the control\n\t * changes.\n\t */\n\tgetControl(): IEditorControl | undefined;\n\n\t/**\n\t * Returns the current view state of the editor if any.\n\t *\n\t * This method is optional to override for the editor pane\n\t * and should only be overridden when the pane can deal with\n\t * `IEditorOptions.viewState` to be applied when opening.\n\t */\n\tgetViewState(): object | undefined;\n\n\t/**\n\t * An optional method to return the current selection in\n\t * the editor pane in case the editor pane has a selection\n\t * concept.\n\t *\n\t * Clients of this method will typically react to the\n\t * `onDidChangeSelection` event to receive the current\n\t * selection as needed.\n\t */\n\tgetSelection?(): IEditorPaneSelection | undefined;\n\n\t/**\n\t * Finds out if this editor is visible or not.\n\t */\n\tisVisible(): boolean;\n}\n\nexport interface IEditorPaneSelectionChangeEvent {\n\n\t/**\n\t * More details for how the selection was made.\n\t */\n\treason: EditorPaneSelectionChangeReason;\n}\n\nexport const enum EditorPaneSelectionChangeReason {\n\n\t/**\n\t * The selection was changed as a result of a programmatic\n\t * method invocation.\n\t *\n\t * For a text editor pane, this for example can be a selection\n\t * being restored from previous view state automatically.\n\t */\n\tPROGRAMMATIC = 1,\n\n\t/**\n\t * The selection was changed by the user.\n\t *\n\t * This typically means the user changed the selection\n\t * with mouse or keyboard.\n\t */\n\tUSER,\n\n\t/**\n\t * The selection was changed as a result of editing in\n\t * the editor pane.\n\t *\n\t * For a text editor pane, this for example can be typing\n\t * in the text of the editor pane.\n\t */\n\tEDIT,\n\n\t/**\n\t * The selection was changed as a result of a navigation\n\t * action.\n\t *\n\t * For a text editor pane, this for example can be a result\n\t * of selecting an entry from a text outline view.\n\t */\n\tNAVIGATION,\n\n\t/**\n\t * The selection was changed as a result of a jump action\n\t * from within the editor pane.\n\t *\n\t * For a text editor pane, this for example can be a result\n\t * of invoking \"Go to definition\" from a symbol.\n\t */\n\tJUMP\n}\n\nexport interface IEditorPaneSelection {\n\n\t/**\n\t * Asks to compare this selection to another selection.\n\t */\n\tcompare(otherSelection: IEditorPaneSelection): EditorPaneSelectionCompareResult;\n\n\t/**\n\t * Asks to massage the provided `options` in a way\n\t * that the selection can be restored when the editor\n\t * is opened again.\n\t *\n\t * For a text editor this means to apply the selected\n\t * line and column as text editor options.\n\t */\n\trestore(options: IEditorOptions): IEditorOptions;\n\n\t/**\n\t * Only used for logging to print more info about the selection.\n\t */\n\tlog?(): string;\n}\n\nexport const enum EditorPaneSelectionCompareResult {\n\n\t/**\n\t * The selections are identical.\n\t */\n\tIDENTICAL = 1,\n\n\t/**\n\t * The selections are similar.\n\t *\n\t * For a text editor this can mean that the one\n\t * selection is in close proximity to the other\n\t * selection.\n\t *\n\t * Upstream clients may decide in this case to\n\t * not treat the selection different from the\n\t * previous one because it is not distinct enough.\n\t */\n\tSIMILAR = 2,\n\n\t/**\n\t * The selections are entirely different.\n\t */\n\tDIFFERENT = 3\n}\n\nexport interface IEditorPaneWithSelection extends IEditorPane {\n\n\treadonly onDidChangeSelection: Event<IEditorPaneSelectionChangeEvent>;\n\n\tgetSelection(): IEditorPaneSelection | undefined;\n}\n\nexport function isEditorPaneWithSelection(editorPane: IEditorPane | undefined): editorPane is IEditorPaneWithSelection {\n\tconst candidate = editorPane as IEditorPaneWithSelection | undefined;\n\n\treturn !!candidate && typeof candidate.getSelection === 'function' && !!candidate.onDidChangeSelection;\n}\n\n/**\n * Try to retrieve the view state for the editor pane that\n * has the provided editor input opened, if at all.\n *\n * This method will return `undefined` if the editor input\n * is not visible in any of the opened editor panes.\n */\nexport function findViewStateForEditor(input: EditorInput, group: GroupIdentifier, editorService: IEditorService): object | undefined {\n\tfor (const editorPane of editorService.visibleEditorPanes) {\n\t\tif (editorPane.group.id === group && input.matches(editorPane.input)) {\n\t\t\treturn editorPane.getViewState();\n\t\t}\n\t}\n\n\treturn undefined;\n}\n\n/**\n * Overrides `IEditorPane` where `input` and `group` are known to be set.\n */\nexport interface IVisibleEditorPane extends IEditorPane {\n\treadonly input: EditorInput;\n\treadonly group: IEditorGroup;\n}\n\n/**\n * The text editor pane is the container for workbench text editors.\n */\nexport interface ITextEditorPane extends IEditorPane {\n\n\t/**\n\t * Returns the underlying text editor widget of this editor.\n\t */\n\tgetControl(): IEditor | undefined;\n}\n\n/**\n * The text editor pane is the container for workbench text diff editors.\n */\nexport interface ITextDiffEditorPane extends IEditorPane {\n\n\t/**\n\t * Returns the underlying text diff editor widget of this editor.\n\t */\n\tgetControl(): IDiffEditor | undefined;\n}\n\n/**\n * Marker interface for the control inside an editor pane. Callers\n * have to cast the control to work with it, e.g. via methods\n * such as `isCodeEditor(control)`.\n */\nexport interface IEditorControl extends ICompositeControl { }\n\nexport interface IFileEditorFactory {\n\n\t/**\n\t * The type identifier of the file editor.\n\t */\n\ttypeId: string;\n\n\t/**\n\t * Creates new new editor capable of showing files.\n\t */\n\tcreateFileEditor(resource: URI, preferredResource: URI | undefined, preferredName: string | undefined, preferredDescription: string | undefined, preferredEncoding: string | undefined, preferredLanguageId: string | undefined, preferredContents: string | undefined, instantiationService: IInstantiationService): IFileEditorInput;\n\n\t/**\n\t * Check if the provided object is a file editor.\n\t */\n\tisFileEditor(obj: unknown): obj is IFileEditorInput;\n}\n\nexport interface IEditorFactoryRegistry {\n\n\t/**\n\t * Registers the file editor factory to use for file editors.\n\t */\n\tregisterFileEditorFactory(factory: IFileEditorFactory): void;\n\n\t/**\n\t * Returns the file editor factory to use for file editors.\n\t */\n\tgetFileEditorFactory(): IFileEditorFactory;\n\n\t/**\n\t * Registers a editor serializer for the given editor to the registry.\n\t * An editor serializer is capable of serializing and deserializing editor\n\t * from string data.\n\t *\n\t * @param editorTypeId the type identifier of the editor\n\t * @param serializer the editor serializer for serialization/deserialization\n\t */\n\tregisterEditorSerializer<Services extends BrandedService[]>(editorTypeId: string, ctor: { new(...Services: Services): IEditorSerializer }): IDisposable;\n\n\t/**\n\t * Returns the editor serializer for the given editor.\n\t */\n\tgetEditorSerializer(editor: EditorInput): IEditorSerializer | undefined;\n\tgetEditorSerializer(editorTypeId: string): IEditorSerializer | undefined;\n\n\t/**\n\t * Starts the registry by providing the required services.\n\t */\n\tstart(accessor: ServicesAccessor): void;\n}\n\nexport interface IEditorSerializer {\n\n\t/**\n\t * Determines whether the given editor can be serialized by the serializer.\n\t */\n\tcanSerialize(editor: EditorInput): boolean;\n\n\t/**\n\t * Returns a string representation of the provided editor that contains enough information\n\t * to deserialize back to the original editor from the deserialize() method.\n\t */\n\tserialize(editor: EditorInput): string | undefined;\n\n\t/**\n\t * Returns an editor from the provided serialized form of the editor. This form matches\n\t * the value returned from the serialize() method.\n\t */\n\tdeserialize(instantiationService: IInstantiationService, serializedEditor: string): EditorInput | undefined;\n}\n\nexport interface IUntitledTextResourceEditorInput extends IBaseTextResourceEditorInput {\n\n\t/**\n\t * Optional resource for the untitled editor. Depending on the value, the editor:\n\t * - should get a unique name if `undefined` (for example `Untitled-1`)\n\t * - should use the resource directly if the scheme is `untitled:`\n\t * - should change the scheme to `untitled:` otherwise and assume an associated path\n\t *\n\t * Untitled editors with associated path behave slightly different from other untitled\n\t * editors:\n\t * - they are dirty right when opening\n\t * - they will not ask for a file path when saving but use the associated path\n\t */\n\treadonly resource: URI | undefined;\n}\n\n/**\n * A resource side by side editor input shows 2 editors side by side but\n * without highlighting any differences.\n *\n * Note: both sides will be resolved as editor individually. As such, it is\n * possible to show 2 different editors side by side.\n *\n * @see {@link IResourceDiffEditorInput} for a variant that compares 2 editors.\n */\nexport interface IResourceSideBySideEditorInput extends IBaseUntypedEditorInput {\n\n\t/**\n\t * The right hand side editor to open inside a side-by-side editor.\n\t */\n\treadonly primary: IResourceEditorInput | ITextResourceEditorInput | IUntitledTextResourceEditorInput;\n\n\t/**\n\t * The left hand side editor to open inside a side-by-side editor.\n\t */\n\treadonly secondary: IResourceEditorInput | ITextResourceEditorInput | IUntitledTextResourceEditorInput;\n}\n\n/**\n * A resource diff editor input compares 2 editors side by side\n * highlighting the differences.\n *\n * Note: both sides must be resolvable to the same editor, or\n * a text based presentation will be used as fallback.\n */\nexport interface IResourceDiffEditorInput extends IBaseUntypedEditorInput {\n\n\t/**\n\t * The left hand side editor to open inside a diff editor.\n\t */\n\treadonly original: IResourceEditorInput | ITextResourceEditorInput | IUntitledTextResourceEditorInput;\n\n\t/**\n\t * The right hand side editor to open inside a diff editor.\n\t */\n\treadonly modified: IResourceEditorInput | ITextResourceEditorInput | IUntitledTextResourceEditorInput;\n}\n\n/**\n * A resource merge editor input compares multiple editors\n * highlighting the differences for merging.\n *\n * Note: all sides must be resolvable to the same editor, or\n * a text based presentation will be used as fallback.\n */\nexport interface IResourceMergeEditorInput extends IBaseUntypedEditorInput {\n\n\t/**\n\t * The one changed version of the file.\n\t */\n\treadonly input1: IResourceEditorInput | ITextResourceEditorInput;\n\n\t/**\n\t * The second changed version of the file.\n\t */\n\treadonly input2: IResourceEditorInput | ITextResourceEditorInput;\n\n\t/**\n\t * The base common ancestor of the file to merge.\n\t */\n\treadonly base: IResourceEditorInput | ITextResourceEditorInput;\n\n\t/**\n\t * The resulting output of the merge.\n\t */\n\treadonly result: IResourceEditorInput | ITextResourceEditorInput;\n}\n\nexport function isResourceEditorInput(editor: unknown): editor is IResourceEditorInput {\n\tif (isEditorInput(editor)) {\n\t\treturn false; // make sure to not accidentally match on typed editor inputs\n\t}\n\n\tconst candidate = editor as IResourceEditorInput | undefined;\n\n\treturn URI.isUri(candidate?.resource);\n}\n\nexport function isResourceDiffEditorInput(editor: unknown): editor is IResourceDiffEditorInput {\n\tif (isEditorInput(editor)) {\n\t\treturn false; // make sure to not accidentally match on typed editor inputs\n\t}\n\n\tconst candidate = editor as IResourceDiffEditorInput | undefined;\n\n\treturn candidate?.original !== undefined && candidate.modified !== undefined;\n}\n\nexport function isResourceSideBySideEditorInput(editor: unknown): editor is IResourceSideBySideEditorInput {\n\tif (isEditorInput(editor)) {\n\t\treturn false; // make sure to not accidentally match on typed editor inputs\n\t}\n\n\tif (isResourceDiffEditorInput(editor)) {\n\t\treturn false; // make sure to not accidentally match on diff editors\n\t}\n\n\tconst candidate = editor as IResourceSideBySideEditorInput | undefined;\n\n\treturn candidate?.primary !== undefined && candidate.secondary !== undefined;\n}\n\nexport function isUntitledResourceEditorInput(editor: unknown): editor is IUntitledTextResourceEditorInput {\n\tif (isEditorInput(editor)) {\n\t\treturn false; // make sure to not accidentally match on typed editor inputs\n\t}\n\n\tconst candidate = editor as IUntitledTextResourceEditorInput | undefined;\n\tif (!candidate) {\n\t\treturn false;\n\t}\n\n\treturn candidate.resource === undefined || candidate.resource.scheme === Schemas.untitled || candidate.forceUntitled === true;\n}\n\nexport function isResourceMergeEditorInput(editor: unknown): editor is IResourceMergeEditorInput {\n\tif (isEditorInput(editor)) {\n\t\treturn false; // make sure to not accidentally match on typed editor inputs\n\t}\n\n\tconst candidate = editor as IResourceMergeEditorInput | undefined;\n\n\treturn URI.isUri(candidate?.base?.resource) && URI.isUri(candidate?.input1?.resource) && URI.isUri(candidate?.input2?.resource) && URI.isUri(candidate?.result?.resource);\n}\n\nexport const enum Verbosity {\n\tSHORT,\n\tMEDIUM,\n\tLONG\n}\n\nexport const enum SaveReason {\n\n\t/**\n\t * Explicit user gesture.\n\t */\n\tEXPLICIT = 1,\n\n\t/**\n\t * Auto save after a timeout.\n\t */\n\tAUTO = 2,\n\n\t/**\n\t * Auto save after editor focus change.\n\t */\n\tFOCUS_CHANGE = 3,\n\n\t/**\n\t * Auto save after window change.\n\t */\n\tWINDOW_CHANGE = 4\n}\n\nexport type SaveSource = string;\n\ninterface ISaveSourceDescriptor {\n\tsource: SaveSource;\n\tlabel: string;\n}\n\nclass SaveSourceFactory {\n\n\tprivate readonly mapIdToSaveSource = new Map<SaveSource, ISaveSourceDescriptor>();\n\n\t/**\n\t * Registers a `SaveSource` with an identifier and label\n\t * to the registry so that it can be used in save operations.\n\t */\n\tregisterSource(id: string, label: string): SaveSource {\n\t\tlet sourceDescriptor = this.mapIdToSaveSource.get(id);\n\t\tif (!sourceDescriptor) {\n\t\t\tsourceDescriptor = { source: id, label };\n\t\t\tthis.mapIdToSaveSource.set(id, sourceDescriptor);\n\t\t}\n\n\t\treturn sourceDescriptor.source;\n\t}\n\n\tgetSourceLabel(source: SaveSource): string {\n\t\treturn this.mapIdToSaveSource.get(source)?.label ?? source;\n\t}\n}\n\nexport const SaveSourceRegistry = new SaveSourceFactory();\n\nexport interface ISaveOptions {\n\n\t/**\n\t * An indicator how the save operation was triggered.\n\t */\n\treason?: SaveReason;\n\n\t/**\n\t * An indicator about the source of the save operation.\n\t *\n\t * Must use `SaveSourceRegistry.registerSource()` to obtain.\n\t */\n\treadonly source?: SaveSource;\n\n\t/**\n\t * Forces to save the contents of the working copy\n\t * again even if the working copy is not dirty.\n\t */\n\treadonly force?: boolean;\n\n\t/**\n\t * Instructs the save operation to skip any save participants.\n\t */\n\treadonly skipSaveParticipants?: boolean;\n\n\t/**\n\t * A hint as to which file systems should be available for saving.\n\t */\n\treadonly availableFileSystems?: string[];\n}\n\nexport interface IRevertOptions {\n\n\t/**\n\t * Forces to load the contents of the working copy\n\t * again even if the working copy is not dirty.\n\t */\n\treadonly force?: boolean;\n\n\t/**\n\t * A soft revert will clear dirty state of a working copy\n\t * but will not attempt to load it from its persisted state.\n\t *\n\t * This option may be used in scenarios where an editor is\n\t * closed and where we do not require to load the contents.\n\t */\n\treadonly soft?: boolean;\n}\n\nexport interface IMoveResult {\n\teditor: EditorInput | IUntypedEditorInput;\n\toptions?: IEditorOptions;\n}\n\nexport const enum EditorInputCapabilities {\n\n\t/**\n\t * Signals no specific capability for the input.\n\t */\n\tNone = 0,\n\n\t/**\n\t * Signals that the input is readonly.\n\t */\n\tReadonly = 1 << 1,\n\n\t/**\n\t * Signals that the input is untitled.\n\t */\n\tUntitled = 1 << 2,\n\n\t/**\n\t * Signals that the input can only be shown in one group\n\t * and not be split into multiple groups.\n\t */\n\tSingleton = 1 << 3,\n\n\t/**\n\t * Signals that the input requires workspace trust.\n\t */\n\tRequiresTrust = 1 << 4,\n\n\t/**\n\t * Signals that the editor can split into 2 in the same\n\t * editor group.\n\t */\n\tCanSplitInGroup = 1 << 5,\n\n\t/**\n\t * Signals that the editor wants it's description to be\n\t * visible when presented to the user. By default, a UI\n\t * component may decide to hide the description portion\n\t * for brevity.\n\t */\n\tForceDescription = 1 << 6,\n\n\t/**\n\t * Signals that the editor supports dropping into the\n\t * editor by holding shift.\n\t */\n\tCanDropIntoEditor = 1 << 7,\n\n\t/**\n\t * Signals that the editor is composed of multiple editors\n\t * within.\n\t */\n\tMultipleEditors = 1 << 8\n}\n\nexport type IUntypedEditorInput = IResourceEditorInput | ITextResourceEditorInput | IUntitledTextResourceEditorInput | IResourceDiffEditorInput | IResourceSideBySideEditorInput | IResourceMergeEditorInput;\n\nexport abstract class AbstractEditorInput extends Disposable {\n\t// Marker class for implementing `isEditorInput`\n}\n\nexport function isEditorInput(editor: unknown): editor is EditorInput {\n\treturn editor instanceof AbstractEditorInput;\n}\n\nexport interface EditorInputWithPreferredResource {\n\n\t/**\n\t * An editor may provide an additional preferred resource alongside\n\t * the `resource` property. While the `resource` property serves as\n\t * unique identifier of the editor that should be used whenever we\n\t * compare to other editors, the `preferredResource` should be used\n\t * in places where e.g. the resource is shown to the user.\n\t *\n\t * For example: on Windows and macOS, the same URI with different\n\t * casing may point to the same file. The editor may chose to\n\t * \"normalize\" the URIs so that only one editor opens for different\n\t * URIs. But when displaying the editor label to the user, the\n\t * preferred URI should be used.\n\t *\n\t * Not all editors have a `preferredResource`. The `EditorResourceAccessor`\n\t * utility can be used to always get the right resource without having\n\t * to do instanceof checks.\n\t */\n\treadonly preferredResource: URI;\n}\n\nfunction isEditorInputWithPreferredResource(editor: unknown): editor is EditorInputWithPreferredResource {\n\tconst candidate = editor as EditorInputWithPreferredResource | undefined;\n\n\treturn URI.isUri(candidate?.preferredResource);\n}\n\nexport interface ISideBySideEditorInput extends EditorInput {\n\n\t/**\n\t * The primary editor input is shown on the right hand side.\n\t */\n\tprimary: EditorInput;\n\n\t/**\n\t * The secondary editor input is shown on the left hand side.\n\t */\n\tsecondary: EditorInput;\n}\n\nexport function isSideBySideEditorInput(editor: unknown): editor is ISideBySideEditorInput {\n\tconst candidate = editor as ISideBySideEditorInput | undefined;\n\n\treturn isEditorInput(candidate?.primary) && isEditorInput(candidate?.secondary);\n}\n\nexport interface IDiffEditorInput extends EditorInput {\n\n\t/**\n\t * The modified (primary) editor input is shown on the right hand side.\n\t */\n\tmodified: EditorInput;\n\n\t/**\n\t * The original (secondary) editor input is shown on the left hand side.\n\t */\n\toriginal: EditorInput;\n}\n\nexport function isDiffEditorInput(editor: unknown): editor is IDiffEditorInput {\n\tconst candidate = editor as IDiffEditorInput | undefined;\n\n\treturn isEditorInput(candidate?.modified) && isEditorInput(candidate?.original);\n}\n\nexport interface IUntypedFileEditorInput extends ITextResourceEditorInput {\n\n\t/**\n\t * A marker to create a `IFileEditorInput` from this untyped input.\n\t */\n\tforceFile: true;\n}\n\n/**\n * This is a tagging interface to declare an editor input being capable of dealing with files. It is only used in the editor registry\n * to register this kind of input to the platform.\n */\nexport interface IFileEditorInput extends EditorInput, IEncodingSupport, ILanguageSupport, EditorInputWithPreferredResource {\n\n\t/**\n\t * Gets the resource this file input is about. This will always be the\n\t * canonical form of the resource, so it may differ from the original\n\t * resource that was provided to create the input. Use `preferredResource`\n\t * for the form as it was created.\n\t */\n\treadonly resource: URI;\n\n\t/**\n\t * Sets the preferred resource to use for this file input.\n\t */\n\tsetPreferredResource(preferredResource: URI): void;\n\n\t/**\n\t * Sets the preferred name to use for this file input.\n\t *\n\t * Note: for certain file schemes the input may decide to ignore this\n\t * name and use our standard naming. Specifically for schemes we own,\n\t * we do not let others override the name.\n\t */\n\tsetPreferredName(name: string): void;\n\n\t/**\n\t * Sets the preferred description to use for this file input.\n\t *\n\t * Note: for certain file schemes the input may decide to ignore this\n\t * description and use our standard naming. Specifically for schemes we own,\n\t * we do not let others override the description.\n\t */\n\tsetPreferredDescription(description: string): void;\n\n\t/**\n\t * Sets the preferred encoding to use for this file input.\n\t */\n\tsetPreferredEncoding(encoding: string): void;\n\n\t/**\n\t * Sets the preferred language id to use for this file input.\n\t */\n\tsetPreferredLanguageId(languageId: string): void;\n\n\t/**\n\t * Sets the preferred contents to use for this file input.\n\t */\n\tsetPreferredContents(contents: string): void;\n\n\t/**\n\t * Forces this file input to open as binary instead of text.\n\t */\n\tsetForceOpenAsBinary(): void;\n\n\t/**\n\t * Figure out if the file input has been resolved or not.\n\t */\n\tisResolved(): boolean;\n}\n\nexport interface EditorInputWithOptions {\n\teditor: EditorInput;\n\toptions?: IEditorOptions;\n}\n\nexport interface EditorInputWithOptionsAndGroup extends EditorInputWithOptions {\n\tgroup: IEditorGroup;\n}\n\nexport function isEditorInputWithOptions(editor: unknown): editor is EditorInputWithOptions {\n\tconst candidate = editor as EditorInputWithOptions | undefined;\n\n\treturn isEditorInput(candidate?.editor);\n}\n\nexport function isEditorInputWithOptionsAndGroup(editor: unknown): editor is EditorInputWithOptionsAndGroup {\n\tconst candidate = editor as EditorInputWithOptionsAndGroup | undefined;\n\n\treturn isEditorInputWithOptions(editor) && candidate?.group !== undefined;\n}\n\n/**\n * Context passed into `EditorPane#setInput` to give additional\n * context information around why the editor was opened.\n */\nexport interface IEditorOpenContext {\n\n\t/**\n\t * An indicator if the editor input is new for the group the editor is in.\n\t * An editor is new for a group if it was not part of the group before and\n\t * otherwise was already opened in the group and just became the active editor.\n\t *\n\t * This hint can e.g. be used to decide whether to restore view state or not.\n\t */\n\tnewInGroup?: boolean;\n}\n\nexport interface IEditorIdentifier {\n\tgroupId: GroupIdentifier;\n\teditor: EditorInput;\n}\n\nexport function isEditorIdentifier(identifier: unknown): identifier is IEditorIdentifier {\n\tconst candidate = identifier as IEditorIdentifier | undefined;\n\n\treturn typeof candidate?.groupId === 'number' && isEditorInput(candidate.editor);\n}\n\n/**\n * The editor commands context is used for editor commands (e.g. in the editor title)\n * and we must ensure that the context is serializable because it potentially travels\n * to the extension host!\n */\nexport interface IEditorCommandsContext {\n\tgroupId: GroupIdentifier;\n\teditorIndex?: number;\n\n\tpreserveFocus?: boolean;\n}\n\n/**\n * More information around why an editor was closed in the model.\n */\nexport enum EditorCloseContext {\n\n\t/**\n\t * No specific context for closing (e.g. explicit user gesture).\n\t */\n\tUNKNOWN,\n\n\t/**\n\t * The editor closed because it was replaced with another editor.\n\t * This can either happen via explicit replace call or when an\n\t * editor is in preview mode and another editor opens.\n\t */\n\tREPLACE,\n\n\t/**\n\t * The editor closed as a result of moving it to another group.\n\t */\n\tMOVE,\n\n\t/**\n\t * The editor closed because another editor turned into preview\n\t * and this used to be the preview editor before.\n\t */\n\tUNPIN\n}\n\nexport interface IEditorCloseEvent extends IEditorIdentifier {\n\n\t/**\n\t * More information around why the editor was closed.\n\t */\n\treadonly context: EditorCloseContext;\n\n\t/**\n\t * The index of the editor before closing.\n\t */\n\treadonly index: number;\n\n\t/**\n\t * Whether the editor was sticky or not.\n\t */\n\treadonly sticky: boolean;\n}\n\nexport interface IActiveEditorChangeEvent {\n\n\t/**\n\t * The new active editor or `undefined` if the group is empty.\n\t */\n\teditor: EditorInput | undefined;\n}\n\nexport interface IEditorWillMoveEvent extends IEditorIdentifier {\n\n\t/**\n\t * The target group of the move operation.\n\t */\n\treadonly target: GroupIdentifier;\n}\n\nexport interface IEditorWillOpenEvent extends IEditorIdentifier { }\n\nexport type GroupIdentifier = number;\n\nexport const enum GroupModelChangeKind {\n\n\t/* Group Changes */\n\tGROUP_ACTIVE,\n\tGROUP_INDEX,\n\tGROUP_LOCKED,\n\n\t/* Editor Changes */\n\tEDITOR_OPEN,\n\tEDITOR_CLOSE,\n\tEDITOR_MOVE,\n\tEDITOR_ACTIVE,\n\tEDITOR_LABEL,\n\tEDITOR_CAPABILITIES,\n\tEDITOR_PIN,\n\tEDITOR_STICKY,\n\tEDITOR_DIRTY,\n\tEDITOR_WILL_DISPOSE\n}\n\nexport interface IWorkbenchEditorConfiguration {\n\tworkbench?: {\n\t\teditor?: IEditorPartConfiguration;\n\t\ticonTheme?: string;\n\t};\n}\n\ninterface IEditorPartConfiguration {\n\tshowTabs?: boolean;\n\twrapTabs?: boolean;\n\tscrollToSwitchTabs?: boolean;\n\thighlightModifiedTabs?: boolean;\n\ttabCloseButton?: 'left' | 'right' | 'off';\n\ttabSizing?: 'fit' | 'shrink';\n\tpinnedTabSizing?: 'normal' | 'compact' | 'shrink';\n\ttitleScrollbarSizing?: 'default' | 'large';\n\tfocusRecentEditorAfterClose?: boolean;\n\tshowIcons?: boolean;\n\tenablePreview?: boolean;\n\tenablePreviewFromQuickOpen?: boolean;\n\tenablePreviewFromCodeNavigation?: boolean;\n\tcloseOnFileDelete?: boolean;\n\topenPositioning?: 'left' | 'right' | 'first' | 'last';\n\topenSideBySideDirection?: 'right' | 'down';\n\tcloseEmptyGroups?: boolean;\n\tautoLockGroups?: Set<string>;\n\trevealIfOpen?: boolean;\n\tmouseBackForwardToNavigate?: boolean;\n\tlabelFormat?: 'default' | 'short' | 'medium' | 'long';\n\trestoreViewState?: boolean;\n\tsplitInGroupLayout?: 'vertical' | 'horizontal';\n\tsplitSizing?: 'split' | 'distribute';\n\tsplitOnDragAndDrop?: boolean;\n\tlimit?: {\n\t\tenabled?: boolean;\n\t\texcludeDirty?: boolean;\n\t\tvalue?: number;\n\t\tperEditorGroup?: boolean;\n\t};\n\tdecorations?: {\n\t\tbadges?: boolean;\n\t\tcolors?: boolean;\n\t};\n}\n\nexport interface IEditorPartOptions extends IEditorPartConfiguration {\n\thasIcons?: boolean;\n}\n\nexport interface IEditorPartOptionsChangeEvent {\n\toldPartOptions: IEditorPartOptions;\n\tnewPartOptions: IEditorPartOptions;\n}\n\nexport enum SideBySideEditor {\n\tPRIMARY = 1,\n\tSECONDARY = 2,\n\tBOTH = 3,\n\tANY = 4\n}\n\nexport interface IFindEditorOptions {\n\n\t/**\n\t * Whether to consider any or both side by side editor as matching.\n\t * By default, side by side editors will not be considered\n\t * as matching, even if the editor is opened in one of the sides.\n\t */\n\tsupportSideBySide?: SideBySideEditor.PRIMARY | SideBySideEditor.SECONDARY | SideBySideEditor.ANY;\n}\n\nexport interface IMatchEditorOptions {\n\n\t/**\n\t * Whether to consider a side by side editor as matching.\n\t * By default, side by side editors will not be considered\n\t * as matching, even if the editor is opened in one of the sides.\n\t */\n\tsupportSideBySide?: SideBySideEditor.ANY | SideBySideEditor.BOTH;\n\n\t/**\n\t * Only consider an editor to match when the\n\t * `candidate === editor` but not when\n\t * `candidate.matches(editor)`.\n\t */\n\tstrictEquals?: boolean;\n}\n\nexport interface IEditorResourceAccessorOptions {\n\n\t/**\n\t * Allows to access the `resource(s)` of side by side editors. If not\n\t * specified, a `resource` for a side by side editor will always be\n\t * `undefined`.\n\t */\n\tsupportSideBySide?: SideBySideEditor;\n\n\t/**\n\t * Allows to filter the scheme to consider. A resource scheme that does\n\t * not match a filter will not be considered.\n\t */\n\tfilterByScheme?: string | string[];\n}\n\nclass EditorResourceAccessorImpl {\n\n\t/**\n\t * The original URI of an editor is the URI that was used originally to open\n\t * the editor and should be used whenever the URI is presented to the user,\n\t * e.g. as a label together with utility methods such as `ResourceLabel` or\n\t * `ILabelService` that can turn this original URI into the best form for\n\t * presenting.\n\t *\n\t * In contrast, the canonical URI (#getCanonicalUri) may be different and should\n\t * be used whenever the URI is used to e.g. compare with other editors or when\n\t * caching certain data based on the URI.\n\t *\n\t * For example: on Windows and macOS, the same file URI with different casing may\n\t * point to the same file. The editor may chose to \"normalize\" the URI into a canonical\n\t * form so that only one editor opens for same file URIs with different casing. As\n\t * such, the original URI and the canonical URI can be different.\n\t */\n\tgetOriginalUri(editor: EditorInput | IUntypedEditorInput | undefined | null): URI | undefined;\n\tgetOriginalUri(editor: EditorInput | IUntypedEditorInput | undefined | null, options: IEditorResourceAccessorOptions & { supportSideBySide?: SideBySideEditor.PRIMARY | SideBySideEditor.SECONDARY | SideBySideEditor.ANY }): URI | undefined;\n\tgetOriginalUri(editor: EditorInput | IUntypedEditorInput | undefined | null, options: IEditorResourceAccessorOptions & { supportSideBySide: SideBySideEditor.BOTH }): URI | { primary?: URI; secondary?: URI } | undefined;\n\tgetOriginalUri(editor: EditorInput | IUntypedEditorInput | undefined | null, options?: IEditorResourceAccessorOptions): URI | { primary?: URI; secondary?: URI } | undefined;\n\tgetOriginalUri(editor: EditorInput | IUntypedEditorInput | undefined | null, options?: IEditorResourceAccessorOptions): URI | { primary?: URI; secondary?: URI } | undefined {\n\t\tif (!editor) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// Merge editors are handled with `merged` result editor\n\t\tif (isResourceMergeEditorInput(editor)) {\n\t\t\treturn EditorResourceAccessor.getOriginalUri(editor.result, options);\n\t\t}\n\n\t\t// Optionally support side-by-side editors\n\t\tif (options?.supportSideBySide) {\n\t\t\tconst { primary, secondary } = this.getSideEditors(editor);\n\t\t\tif (primary && secondary) {\n\t\t\t\tif (options?.supportSideBySide === SideBySideEditor.BOTH) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tprimary: this.getOriginalUri(primary, { filterByScheme: options.filterByScheme }),\n\t\t\t\t\t\tsecondary: this.getOriginalUri(secondary, { filterByScheme: options.filterByScheme })\n\t\t\t\t\t};\n\t\t\t\t} else if (options?.supportSideBySide === SideBySideEditor.ANY) {\n\t\t\t\t\treturn this.getOriginalUri(primary, { filterByScheme: options.filterByScheme }) ?? this.getOriginalUri(secondary, { filterByScheme: options.filterByScheme });\n\t\t\t\t}\n\n\t\t\t\teditor = options.supportSideBySide === SideBySideEditor.PRIMARY ? primary : secondary;\n\t\t\t}\n\t\t}\n\n\t\tif (isResourceDiffEditorInput(editor) || isResourceSideBySideEditorInput(editor) || isResourceMergeEditorInput(editor)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// Original URI is the `preferredResource` of an editor if any\n\t\tconst originalResource = isEditorInputWithPreferredResource(editor) ? editor.preferredResource : editor.resource;\n\t\tif (!originalResource || !options || !options.filterByScheme) {\n\t\t\treturn originalResource;\n\t\t}\n\n\t\treturn this.filterUri(originalResource, options.filterByScheme);\n\t}\n\n\tprivate getSideEditors(editor: EditorInput | IUntypedEditorInput): { primary: EditorInput | IUntypedEditorInput | undefined; secondary: EditorInput | IUntypedEditorInput | undefined } {\n\t\tif (isSideBySideEditorInput(editor) || isResourceSideBySideEditorInput(editor)) {\n\t\t\treturn { primary: editor.primary, secondary: editor.secondary };\n\t\t}\n\n\t\tif (isDiffEditorInput(editor) || isResourceDiffEditorInput(editor)) {\n\t\t\treturn { primary: editor.modified, secondary: editor.original };\n\t\t}\n\n\t\treturn { primary: undefined, secondary: undefined };\n\t}\n\n\t/**\n\t * The canonical URI of an editor is the true unique identifier of the editor\n\t * and should be used whenever the URI is used e.g. to compare with other\n\t * editors or when caching certain data based on the URI.\n\t *\n\t * In contrast, the original URI (#getOriginalUri) may be different and should\n\t * be used whenever the URI is presented to the user, e.g. as a label.\n\t *\n\t * For example: on Windows and macOS, the same file URI with different casing may\n\t * point to the same file. The editor may chose to \"normalize\" the URI into a canonical\n\t * form so that only one editor opens for same file URIs with different casing. As\n\t * such, the original URI and the canonical URI can be different.\n\t */\n\tgetCanonicalUri(editor: EditorInput | IUntypedEditorInput | undefined | null): URI | undefined;\n\tgetCanonicalUri(editor: EditorInput | IUntypedEditorInput | undefined | null, options: IEditorResourceAccessorOptions & { supportSideBySide?: SideBySideEditor.PRIMARY | SideBySideEditor.SECONDARY | SideBySideEditor.ANY }): URI | undefined;\n\tgetCanonicalUri(editor: EditorInput | IUntypedEditorInput | undefined | null, options: IEditorResourceAccessorOptions & { supportSideBySide: SideBySideEditor.BOTH }): URI | { primary?: URI; secondary?: URI } | undefined;\n\tgetCanonicalUri(editor: EditorInput | IUntypedEditorInput | undefined | null, options?: IEditorResourceAccessorOptions): URI | { primary?: URI; secondary?: URI } | undefined;\n\tgetCanonicalUri(editor: EditorInput | IUntypedEditorInput | undefined | null, options?: IEditorResourceAccessorOptions): URI | { primary?: URI; secondary?: URI } | undefined {\n\t\tif (!editor) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// Merge editors are handled with `merged` result editor\n\t\tif (isResourceMergeEditorInput(editor)) {\n\t\t\treturn EditorResourceAccessor.getCanonicalUri(editor.result, options);\n\t\t}\n\n\t\t// Optionally support side-by-side editors\n\t\tif (options?.supportSideBySide) {\n\t\t\tconst { primary, secondary } = this.getSideEditors(editor);\n\t\t\tif (primary && secondary) {\n\t\t\t\tif (options?.supportSideBySide === SideBySideEditor.BOTH) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tprimary: this.getCanonicalUri(primary, { filterByScheme: options.filterByScheme }),\n\t\t\t\t\t\tsecondary: this.getCanonicalUri(secondary, { filterByScheme: options.filterByScheme })\n\t\t\t\t\t};\n\t\t\t\t} else if (options?.supportSideBySide === SideBySideEditor.ANY) {\n\t\t\t\t\treturn this.getCanonicalUri(primary, { filterByScheme: options.filterByScheme }) ?? this.getCanonicalUri(secondary, { filterByScheme: options.filterByScheme });\n\t\t\t\t}\n\n\t\t\t\teditor = options.supportSideBySide === SideBySideEditor.PRIMARY ? primary : secondary;\n\t\t\t}\n\t\t}\n\n\t\tif (isResourceDiffEditorInput(editor) || isResourceSideBySideEditorInput(editor) || isResourceMergeEditorInput(editor)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// Canonical URI is the `resource` of an editor\n\t\tconst canonicalResource = editor.resource;\n\t\tif (!canonicalResource || !options || !options.filterByScheme) {\n\t\t\treturn canonicalResource;\n\t\t}\n\n\t\treturn this.filterUri(canonicalResource, options.filterByScheme);\n\t}\n\n\tprivate filterUri(resource: URI, filter: string | string[]): URI | undefined {\n\n\t\t// Multiple scheme filter\n\t\tif (Array.isArray(filter)) {\n\t\t\tif (filter.some(scheme => resource.scheme === scheme)) {\n\t\t\t\treturn resource;\n\t\t\t}\n\t\t}\n\n\t\t// Single scheme filter\n\t\telse {\n\t\t\tif (filter === resource.scheme) {\n\t\t\t\treturn resource;\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n}\n\nexport const EditorResourceAccessor = new EditorResourceAccessorImpl();\n\nexport const enum CloseDirection {\n\tLEFT,\n\tRIGHT\n}\n\nexport interface IEditorMemento<T> {\n\n\tsaveEditorState(group: IEditorGroup, resource: URI, state: T): void;\n\tsaveEditorState(group: IEditorGroup, editor: EditorInput, state: T): void;\n\n\tloadEditorState(group: IEditorGroup, resource: URI): T | undefined;\n\tloadEditorState(group: IEditorGroup, editor: EditorInput): T | undefined;\n\n\tclearEditorState(resource: URI, group?: IEditorGroup): void;\n\tclearEditorState(editor: EditorInput, group?: IEditorGroup): void;\n\n\tclearEditorStateOnDispose(resource: URI, editor: EditorInput): void;\n\n\tmoveEditorState(source: URI, target: URI, comparer: IExtUri): void;\n}\n\nclass EditorFactoryRegistry implements IEditorFactoryRegistry {\n\tprivate instantiationService: IInstantiationService | undefined;\n\n\tprivate fileEditorFactory: IFileEditorFactory | undefined;\n\n\tprivate readonly editorSerializerConstructors = new Map<string /* Type ID */, IConstructorSignature<IEditorSerializer>>();\n\tprivate readonly editorSerializerInstances = new Map<string /* Type ID */, IEditorSerializer>();\n\n\tstart(accessor: ServicesAccessor): void {\n\t\tconst instantiationService = this.instantiationService = accessor.get(IInstantiationService);\n\n\t\tfor (const [key, ctor] of this.editorSerializerConstructors) {\n\t\t\tthis.createEditorSerializer(key, ctor, instantiationService);\n\t\t}\n\n\t\tthis.editorSerializerConstructors.clear();\n\t}\n\n\tprivate createEditorSerializer(editorTypeId: string, ctor: IConstructorSignature<IEditorSerializer>, instantiationService: IInstantiationService): void {\n\t\tconst instance = instantiationService.createInstance(ctor);\n\t\tthis.editorSerializerInstances.set(editorTypeId, instance);\n\t}\n\n\tregisterFileEditorFactory(factory: IFileEditorFactory): void {\n\t\tif (this.fileEditorFactory) {\n\t\t\tthrow new Error('Can only register one file editor factory.');\n\t\t}\n\n\t\tthis.fileEditorFactory = factory;\n\t}\n\n\tgetFileEditorFactory(): IFileEditorFactory {\n\t\treturn assertIsDefined(this.fileEditorFactory);\n\t}\n\n\tregisterEditorSerializer(editorTypeId: string, ctor: IConstructorSignature<IEditorSerializer>): IDisposable {\n\t\tif (this.editorSerializerConstructors.has(editorTypeId) || this.editorSerializerInstances.has(editorTypeId)) {\n\t\t\tthrow new Error(`A editor serializer with type ID '${editorTypeId}' was already registered.`);\n\t\t}\n\n\t\tif (!this.instantiationService) {\n\t\t\tthis.editorSerializerConstructors.set(editorTypeId, ctor);\n\t\t} else {\n\t\t\tthis.createEditorSerializer(editorTypeId, ctor, this.instantiationService);\n\t\t}\n\n\t\treturn toDisposable(() => {\n\t\t\tthis.editorSerializerConstructors.delete(editorTypeId);\n\t\t\tthis.editorSerializerInstances.delete(editorTypeId);\n\t\t});\n\t}\n\n\tgetEditorSerializer(editor: EditorInput): IEditorSerializer | undefined;\n\tgetEditorSerializer(editorTypeId: string): IEditorSerializer | undefined;\n\tgetEditorSerializer(arg1: string | EditorInput): IEditorSerializer | undefined {\n\t\treturn this.editorSerializerInstances.get(typeof arg1 === 'string' ? arg1 : arg1.typeId);\n\t}\n}\n\nRegistry.add(EditorExtensions.EditorFactory, new EditorFactoryRegistry());\n\nexport async function pathsToEditors(paths: IPathData[] | undefined, fileService: IFileService): Promise<(IResourceEditorInput | IUntitledTextResourceEditorInput)[]> {\n\tif (!paths || !paths.length) {\n\t\treturn [];\n\t}\n\n\tconst editors = await Promise.all(paths.map(async path => {\n\t\tconst resource = URI.revive(path.fileUri);\n\t\tif (!resource) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst canHandleResource = await fileService.canHandleResource(resource);\n\t\tif (!canHandleResource) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet exists = path.exists;\n\t\tlet type = path.type;\n\t\tif (typeof exists !== 'boolean' || typeof type !== 'number') {\n\t\t\ttry {\n\t\t\t\ttype = (await fileService.stat(resource)).isDirectory ? FileType.Directory : FileType.Unknown;\n\t\t\t\texists = true;\n\t\t\t} catch {\n\t\t\t\texists = false;\n\t\t\t}\n\t\t}\n\n\t\tif (!exists && path.openOnlyIfExists) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (type === FileType.Directory) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst options: IEditorOptions = {\n\t\t\t...path.options,\n\t\t\tpinned: true\n\t\t};\n\n\t\tlet input: IResourceEditorInput | IUntitledTextResourceEditorInput;\n\t\tif (!exists) {\n\t\t\tinput = { resource, options, forceUntitled: true };\n\t\t} else {\n\t\t\tinput = { resource, options };\n\t\t}\n\n\t\treturn input;\n\t}));\n\n\treturn coalesce(editors);\n}\n\nexport const enum EditorsOrder {\n\n\t/**\n\t * Editors sorted by most recent activity (most recent active first)\n\t */\n\tMOST_RECENTLY_ACTIVE,\n\n\t/**\n\t * Editors sorted by sequential order\n\t */\n\tSEQUENTIAL\n}\n\nexport function isTextEditorViewState(candidate: unknown): candidate is IEditorViewState {\n\tconst viewState = candidate as IEditorViewState | undefined;\n\tif (!viewState) {\n\t\treturn false;\n\t}\n\n\tconst diffEditorViewState = viewState as IDiffEditorViewState;\n\tif (diffEditorViewState.modified) {\n\t\treturn isTextEditorViewState(diffEditorViewState.modified);\n\t}\n\n\tconst codeEditorViewState = viewState as ICodeEditorViewState;\n\n\treturn !!(codeEditorViewState.contributionsState && codeEditorViewState.viewState && Array.isArray(codeEditorViewState.cursorState));\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CharCode } from 'vs/base/common/charCode';\nimport { Schemas } from 'vs/base/common/network';\nimport { URI } from 'vs/base/common/uri';\n\nexport interface WebviewRemoteInfo {\n\treadonly isRemote: boolean;\n\treadonly authority: string | undefined;\n}\n\n/**\n * Root from which resources in webviews are loaded.\n *\n * This is hardcoded because we never expect to actually hit it. Instead these requests\n * should always go to a service worker.\n */\nexport const webviewResourceBaseHost = 'vscode-cdn.net';\n\nexport const webviewRootResourceAuthority = `vscode-resource.${webviewResourceBaseHost}`;\n\nexport const webviewGenericCspSource = `'self' https://*.${webviewResourceBaseHost}`;\n\n/**\n * Construct a uri that can load resources inside a webview\n *\n * We encode the resource component of the uri so that on the main thread\n * we know where to load the resource from (remote or truly local):\n *\n * ```txt\n * ${scheme}+${resource-authority}.vscode-resource.vscode-cdn.net/${path}\n * ```\n *\n * @param resource Uri of the resource to load.\n * @param remoteInfo Optional information about the remote that specifies where `resource` should be resolved from.\n */\nexport function asWebviewUri(resource: URI, remoteInfo?: WebviewRemoteInfo): URI {\n\tif (resource.scheme === Schemas.http || resource.scheme === Schemas.https) {\n\t\treturn resource;\n\t}\n\n\tif (remoteInfo && remoteInfo.authority && remoteInfo.isRemote && resource.scheme === Schemas.file) {\n\t\tresource = URI.from({\n\t\t\tscheme: Schemas.vscodeRemote,\n\t\t\tauthority: remoteInfo.authority,\n\t\t\tpath: resource.path,\n\t\t});\n\t}\n\n\treturn URI.from({\n\t\tscheme: Schemas.https,\n\t\tauthority: `${resource.scheme}+${encodeAuthority(resource.authority)}.${webviewRootResourceAuthority}`,\n\t\tpath: resource.path,\n\t\tfragment: resource.fragment,\n\t\tquery: resource.query,\n\t});\n}\n\nfunction encodeAuthority(authority: string): string {\n\treturn authority.replace(/./g, char => {\n\t\tconst code = char.charCodeAt(0);\n\t\tif (\n\t\t\t(code >= CharCode.a && code <= CharCode.z)\n\t\t\t|| (code >= CharCode.A && code <= CharCode.Z)\n\t\t\t|| (code >= CharCode.Digit0 && code <= CharCode.Digit9)\n\t\t) {\n\t\t\treturn char;\n\t\t}\n\t\treturn '-' + code.toString(16).padStart(4, '0');\n\t});\n}\n\nexport function decodeAuthority(authority: string) {\n\treturn authority.replace(/-([0-9a-f]{4})/g, (_, code) => String.fromCharCode(parseInt(code, 16)));\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter } from 'vs/base/common/event';\nimport { DisposableStore } from 'vs/base/common/lifecycle';\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { ExtHostTextEditor } from 'vs/workbench/api/common/extHostTextEditor';\nimport { ExtHostEditors } from 'vs/workbench/api/common/extHostTextEditors';\nimport { asWebviewUri, webviewGenericCspSource, WebviewRemoteInfo } from 'vs/workbench/common/webview';\nimport type * as vscode from 'vscode';\nimport { ExtHostEditorInsetsShape, MainThreadEditorInsetsShape } from './extHost.protocol';\n\nexport class ExtHostEditorInsets implements ExtHostEditorInsetsShape {\n\n\tprivate _handlePool = 0;\n\tprivate _disposables = new DisposableStore();\n\tprivate _insets = new Map<number, { editor: vscode.TextEditor; inset: vscode.WebviewEditorInset; onDidReceiveMessage: Emitter<any> }>();\n\n\tconstructor(\n\t\tprivate readonly _proxy: MainThreadEditorInsetsShape,\n\t\tprivate readonly _editors: ExtHostEditors,\n\t\tprivate readonly _remoteInfo: WebviewRemoteInfo\n\t) {\n\n\t\t// dispose editor inset whenever the hosting editor goes away\n\t\tthis._disposables.add(_editors.onDidChangeVisibleTextEditors(() => {\n\t\t\tconst visibleEditor = _editors.getVisibleTextEditors();\n\t\t\tfor (const value of this._insets.values()) {\n\t\t\t\tif (visibleEditor.indexOf(value.editor) < 0) {\n\t\t\t\t\tvalue.inset.dispose(); // will remove from `this._insets`\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t}\n\n\tdispose(): void {\n\t\tthis._insets.forEach(value => value.inset.dispose());\n\t\tthis._disposables.dispose();\n\t}\n\n\tcreateWebviewEditorInset(editor: vscode.TextEditor, line: number, height: number, options: vscode.WebviewOptions | undefined, extension: IExtensionDescription): vscode.WebviewEditorInset {\n\n\t\tlet apiEditor: ExtHostTextEditor | undefined;\n\t\tfor (const candidate of this._editors.getVisibleTextEditors(true)) {\n\t\t\tif (candidate.value === editor) {\n\t\t\t\tapiEditor = <ExtHostTextEditor>candidate;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!apiEditor) {\n\t\t\tthrow new Error('not a visible editor');\n\t\t}\n\n\t\tconst that = this;\n\t\tconst handle = this._handlePool++;\n\t\tconst onDidReceiveMessage = new Emitter<any>();\n\t\tconst onDidDispose = new Emitter<void>();\n\n\t\tconst webview = new class implements vscode.Webview {\n\n\t\t\tprivate _html: string = '';\n\t\t\tprivate _options: vscode.WebviewOptions = Object.create(null);\n\n\t\t\tasWebviewUri(resource: vscode.Uri): vscode.Uri {\n\t\t\t\treturn asWebviewUri(resource, that._remoteInfo);\n\t\t\t}\n\n\t\t\tget cspSource(): string {\n\t\t\t\treturn webviewGenericCspSource;\n\t\t\t}\n\n\t\t\tset options(value: vscode.WebviewOptions) {\n\t\t\t\tthis._options = value;\n\t\t\t\tthat._proxy.$setOptions(handle, value);\n\t\t\t}\n\n\t\t\tget options(): vscode.WebviewOptions {\n\t\t\t\treturn this._options;\n\t\t\t}\n\n\t\t\tset html(value: string) {\n\t\t\t\tthis._html = value;\n\t\t\t\tthat._proxy.$setHtml(handle, value);\n\t\t\t}\n\n\t\t\tget html(): string {\n\t\t\t\treturn this._html;\n\t\t\t}\n\n\t\t\tget onDidReceiveMessage(): vscode.Event<any> {\n\t\t\t\treturn onDidReceiveMessage.event;\n\t\t\t}\n\n\t\t\tpostMessage(message: any): Thenable<boolean> {\n\t\t\t\treturn that._proxy.$postMessage(handle, message);\n\t\t\t}\n\t\t};\n\n\t\tconst inset = new class implements vscode.WebviewEditorInset {\n\n\t\t\treadonly editor: vscode.TextEditor = editor;\n\t\t\treadonly line: number = line;\n\t\t\treadonly height: number = height;\n\t\t\treadonly webview: vscode.Webview = webview;\n\t\t\treadonly onDidDispose: vscode.Event<void> = onDidDispose.event;\n\n\t\t\tdispose(): void {\n\t\t\t\tif (that._insets.has(handle)) {\n\t\t\t\t\tthat._insets.delete(handle);\n\t\t\t\t\tthat._proxy.$disposeEditorInset(handle);\n\t\t\t\t\tonDidDispose.fire();\n\n\t\t\t\t\t// final cleanup\n\t\t\t\t\tonDidDispose.dispose();\n\t\t\t\t\tonDidReceiveMessage.dispose();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tthis._proxy.$createEditorInset(handle, apiEditor.id, apiEditor.value.document.uri, line + 1, height, options || {}, extension.identifier, extension.extensionLocation);\n\t\tthis._insets.set(handle, { editor, inset, onDidReceiveMessage });\n\n\t\treturn inset;\n\t}\n\n\t$onDidDispose(handle: number): void {\n\t\tconst value = this._insets.get(handle);\n\t\tif (value) {\n\t\t\tvalue.inset.dispose();\n\t\t}\n\t}\n\n\t$onDidReceiveMessage(handle: number, message: any): void {\n\t\tconst value = this._insets.get(handle);\n\t\tvalue?.onDidReceiveMessage.fire(message);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { IDebugAdapter } from 'vs/workbench/contrib/debug/common/debug';\nimport { timeout } from 'vs/base/common/async';\nimport { localize } from 'vs/nls';\n\n/**\n * Abstract implementation of the low level API for a debug adapter.\n * Missing is how this API communicates with the debug adapter.\n */\nexport abstract class AbstractDebugAdapter implements IDebugAdapter {\n\tprivate sequence: number;\n\tprivate pendingRequests = new Map<number, (e: DebugProtocol.Response) => void>();\n\tprivate requestCallback: ((request: DebugProtocol.Request) => void) | undefined;\n\tprivate eventCallback: ((request: DebugProtocol.Event) => void) | undefined;\n\tprivate messageCallback: ((message: DebugProtocol.ProtocolMessage) => void) | undefined;\n\tprivate queue: DebugProtocol.ProtocolMessage[] = [];\n\tprotected readonly _onError = new Emitter<Error>();\n\tprotected readonly _onExit = new Emitter<number | null>();\n\n\tconstructor() {\n\t\tthis.sequence = 1;\n\t}\n\n\tabstract startSession(): Promise<void>;\n\n\tabstract stopSession(): Promise<void>;\n\n\tabstract sendMessage(message: DebugProtocol.ProtocolMessage): void;\n\n\tget onError(): Event<Error> {\n\t\treturn this._onError.event;\n\t}\n\n\tget onExit(): Event<number | null> {\n\t\treturn this._onExit.event;\n\t}\n\n\tonMessage(callback: (message: DebugProtocol.ProtocolMessage) => void): void {\n\t\tif (this.messageCallback) {\n\t\t\tthis._onError.fire(new Error(`attempt to set more than one 'Message' callback`));\n\t\t}\n\t\tthis.messageCallback = callback;\n\t}\n\n\tonEvent(callback: (event: DebugProtocol.Event) => void): void {\n\t\tif (this.eventCallback) {\n\t\t\tthis._onError.fire(new Error(`attempt to set more than one 'Event' callback`));\n\t\t}\n\t\tthis.eventCallback = callback;\n\t}\n\n\tonRequest(callback: (request: DebugProtocol.Request) => void): void {\n\t\tif (this.requestCallback) {\n\t\t\tthis._onError.fire(new Error(`attempt to set more than one 'Request' callback`));\n\t\t}\n\t\tthis.requestCallback = callback;\n\t}\n\n\tsendResponse(response: DebugProtocol.Response): void {\n\t\tif (response.seq > 0) {\n\t\t\tthis._onError.fire(new Error(`attempt to send more than one response for command ${response.command}`));\n\t\t} else {\n\t\t\tthis.internalSend('response', response);\n\t\t}\n\t}\n\n\tsendRequest(command: string, args: any, clb: (result: DebugProtocol.Response) => void, timeout?: number): number {\n\t\tconst request: any = {\n\t\t\tcommand: command\n\t\t};\n\t\tif (args && Object.keys(args).length > 0) {\n\t\t\trequest.arguments = args;\n\t\t}\n\t\tthis.internalSend('request', request);\n\t\tif (typeof timeout === 'number') {\n\t\t\tconst timer = setTimeout(() => {\n\t\t\t\tclearTimeout(timer);\n\t\t\t\tconst clb = this.pendingRequests.get(request.seq);\n\t\t\t\tif (clb) {\n\t\t\t\t\tthis.pendingRequests.delete(request.seq);\n\t\t\t\t\tconst err: DebugProtocol.Response = {\n\t\t\t\t\t\ttype: 'response',\n\t\t\t\t\t\tseq: 0,\n\t\t\t\t\t\trequest_seq: request.seq,\n\t\t\t\t\t\tsuccess: false,\n\t\t\t\t\t\tcommand,\n\t\t\t\t\t\tmessage: localize('timeout', \"Timeout after {0} ms for '{1}'\", timeout, command)\n\t\t\t\t\t};\n\t\t\t\t\tclb(err);\n\t\t\t\t}\n\t\t\t}, timeout);\n\t\t}\n\t\tif (clb) {\n\t\t\t// store callback for this request\n\t\t\tthis.pendingRequests.set(request.seq, clb);\n\t\t}\n\n\t\treturn request.seq;\n\t}\n\n\tacceptMessage(message: DebugProtocol.ProtocolMessage): void {\n\t\tif (this.messageCallback) {\n\t\t\tthis.messageCallback(message);\n\t\t} else {\n\t\t\tthis.queue.push(message);\n\t\t\tif (this.queue.length === 1) {\n\t\t\t\t// first item = need to start processing loop\n\t\t\t\tthis.processQueue();\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Returns whether we should insert a timeout between processing messageA\n\t * and messageB. Artificially queueing protocol messages guarantees that any\n\t * microtasks for previous message finish before next message is processed.\n\t * This is essential ordering when using promises anywhere along the call path.\n\t *\n\t * For example, take the following, where `chooseAndSendGreeting` returns\n\t * a person name and then emits a greeting event:\n\t *\n\t * ```\n\t * let person: string;\n\t * adapter.onGreeting(() => console.log('hello', person));\n\t * person = await adapter.chooseAndSendGreeting();\n\t * ```\n\t *\n\t * Because the event is dispatched synchronously, it may fire before person\n\t * is assigned if they're processed in the same task. Inserting a task\n\t * boundary avoids this issue.\n\t */\n\tprotected needsTaskBoundaryBetween(messageA: DebugProtocol.ProtocolMessage, messageB: DebugProtocol.ProtocolMessage) {\n\t\treturn messageA.type !== 'event' || messageB.type !== 'event';\n\t}\n\n\t/**\n\t * Reads and dispatches items from the queue until it is empty.\n\t */\n\tprivate async processQueue() {\n\t\tlet message: DebugProtocol.ProtocolMessage | undefined;\n\t\twhile (this.queue.length) {\n\t\t\tif (!message || this.needsTaskBoundaryBetween(this.queue[0], message)) {\n\t\t\t\tawait timeout(0);\n\t\t\t}\n\n\t\t\tmessage = this.queue.shift();\n\t\t\tif (!message) {\n\t\t\t\treturn; // may have been disposed of\n\t\t\t}\n\n\t\t\tswitch (message.type) {\n\t\t\t\tcase 'event':\n\t\t\t\t\tthis.eventCallback?.(<DebugProtocol.Event>message);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'request':\n\t\t\t\t\tthis.requestCallback?.(<DebugProtocol.Request>message);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'response': {\n\t\t\t\t\tconst response = <DebugProtocol.Response>message;\n\t\t\t\t\tconst clb = this.pendingRequests.get(response.request_seq);\n\t\t\t\t\tif (clb) {\n\t\t\t\t\t\tthis.pendingRequests.delete(response.request_seq);\n\t\t\t\t\t\tclb(response);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate internalSend(typ: 'request' | 'response' | 'event', message: DebugProtocol.ProtocolMessage): void {\n\t\tmessage.type = typ;\n\t\tmessage.seq = this.sequence++;\n\t\tthis.sendMessage(message);\n\t}\n\n\tprotected async cancelPendingRequests(): Promise<void> {\n\t\tif (this.pendingRequests.size === 0) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst pending = new Map<number, (e: DebugProtocol.Response) => void>();\n\t\tthis.pendingRequests.forEach((value, key) => pending.set(key, value));\n\t\tawait timeout(500);\n\t\tpending.forEach((callback, request_seq) => {\n\t\t\tconst err: DebugProtocol.Response = {\n\t\t\t\ttype: 'response',\n\t\t\t\tseq: 0,\n\t\t\t\trequest_seq,\n\t\t\t\tsuccess: false,\n\t\t\t\tcommand: 'canceled',\n\t\t\t\tmessage: 'canceled'\n\t\t\t};\n\t\t\tcallback(err);\n\t\t\tthis.pendingRequests.delete(request_seq);\n\t\t});\n\t}\n\n\tgetPendingRequestIds(): number[] {\n\t\treturn Array.from(this.pendingRequests.keys());\n\t}\n\n\tdispose(): void {\n\t\tthis.queue = [];\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IAction } from 'vs/base/common/actions';\nimport { VSBuffer } from 'vs/base/common/buffer';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { Event } from 'vs/base/common/event';\nimport { IJSONSchemaSnippet } from 'vs/base/common/jsonSchema';\nimport { IDisposable } from 'vs/base/common/lifecycle';\nimport severity from 'vs/base/common/severity';\nimport { URI as uri } from 'vs/base/common/uri';\nimport { IPosition, Position } from 'vs/editor/common/core/position';\nimport { IRange, Range } from 'vs/editor/common/core/range';\nimport * as editorCommon from 'vs/editor/common/editorCommon';\nimport { ITextModel as EditorIModel } from 'vs/editor/common/model';\nimport * as nls from 'vs/nls';\nimport { ConfigurationTarget } from 'vs/platform/configuration/common/configuration';\nimport { RawContextKey } from 'vs/platform/contextkey/common/contextkey';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { ITelemetryEndpoint } from 'vs/platform/telemetry/common/telemetry';\nimport { IWorkspaceFolder } from 'vs/platform/workspace/common/workspace';\nimport { IEditorPane } from 'vs/workbench/common/editor';\nimport { DebugCompoundRoot } from 'vs/workbench/contrib/debug/common/debugCompoundRoot';\nimport { Source } from 'vs/workbench/contrib/debug/common/debugSource';\nimport { ITaskIdentifier } from 'vs/workbench/contrib/tasks/common/tasks';\nimport { IEditorService } from 'vs/workbench/services/editor/common/editorService';\n\nexport const VIEWLET_ID = 'workbench.view.debug';\n\nexport const VARIABLES_VIEW_ID = 'workbench.debug.variablesView';\nexport const WATCH_VIEW_ID = 'workbench.debug.watchExpressionsView';\nexport const CALLSTACK_VIEW_ID = 'workbench.debug.callStackView';\nexport const LOADED_SCRIPTS_VIEW_ID = 'workbench.debug.loadedScriptsView';\nexport const BREAKPOINTS_VIEW_ID = 'workbench.debug.breakPointsView';\nexport const DISASSEMBLY_VIEW_ID = 'workbench.debug.disassemblyView';\nexport const DEBUG_PANEL_ID = 'workbench.panel.repl';\nexport const REPL_VIEW_ID = 'workbench.panel.repl.view';\nexport const DEBUG_SERVICE_ID = 'debugService';\nexport const CONTEXT_DEBUG_TYPE = new RawContextKey<string>('debugType', undefined, { type: 'string', description: nls.localize('debugType', \"Debug type of the active debug session. For example 'python'.\") });\nexport const CONTEXT_DEBUG_CONFIGURATION_TYPE = new RawContextKey<string>('debugConfigurationType', undefined, { type: 'string', description: nls.localize('debugConfigurationType', \"Debug type of the selected launch configuration. For example 'python'.\") });\nexport const CONTEXT_DEBUG_STATE = new RawContextKey<string>('debugState', 'inactive', { type: 'string', description: nls.localize('debugState', \"State that the focused debug session is in. One of the following: 'inactive', 'initializing', 'stopped' or 'running'.\") });\nexport const CONTEXT_DEBUG_UX_KEY = 'debugUx';\nexport const CONTEXT_DEBUG_UX = new RawContextKey<string>(CONTEXT_DEBUG_UX_KEY, 'default', { type: 'string', description: nls.localize('debugUX', \"Debug UX state. When there are no debug configurations it is 'simple', otherwise 'default'. Used to decide when to show welcome views in the debug viewlet.\") });\nexport const CONTEXT_IN_DEBUG_MODE = new RawContextKey<boolean>('inDebugMode', false, { type: 'boolean', description: nls.localize('inDebugMode', \"True when debugging, false otherwise.\") });\nexport const CONTEXT_IN_DEBUG_REPL = new RawContextKey<boolean>('inDebugRepl', false, { type: 'boolean', description: nls.localize('inDebugRepl', \"True when focus is in the debug console, false otherwise.\") });\nexport const CONTEXT_BREAKPOINT_WIDGET_VISIBLE = new RawContextKey<boolean>('breakpointWidgetVisible', false, { type: 'boolean', description: nls.localize('breakpointWidgetVisibile', \"True when breakpoint editor zone widget is visible, false otherwise.\") });\nexport const CONTEXT_IN_BREAKPOINT_WIDGET = new RawContextKey<boolean>('inBreakpointWidget', false, { type: 'boolean', description: nls.localize('inBreakpointWidget', \"True when focus is in the breakpoint editor zone widget, false otherwise.\") });\nexport const CONTEXT_BREAKPOINTS_FOCUSED = new RawContextKey<boolean>('breakpointsFocused', true, { type: 'boolean', description: nls.localize('breakpointsFocused', \"True when the BREAKPOINTS view is focused, false otherwise.\") });\nexport const CONTEXT_WATCH_EXPRESSIONS_FOCUSED = new RawContextKey<boolean>('watchExpressionsFocused', true, { type: 'boolean', description: nls.localize('watchExpressionsFocused', \"True when the WATCH view is focused, false otherwsie.\") });\nexport const CONTEXT_WATCH_EXPRESSIONS_EXIST = new RawContextKey<boolean>('watchExpressionsExist', false, { type: 'boolean', description: nls.localize('watchExpressionsExist', \"True when at least one watch expression exists, false otherwise.\") });\nexport const CONTEXT_VARIABLES_FOCUSED = new RawContextKey<boolean>('variablesFocused', true, { type: 'boolean', description: nls.localize('variablesFocused', \"True when the VARIABLES views is focused, false otherwsie\") });\nexport const CONTEXT_EXPRESSION_SELECTED = new RawContextKey<boolean>('expressionSelected', false, { type: 'boolean', description: nls.localize('expressionSelected', \"True when an expression input box is open in either the WATCH or the VARIABLES view, false otherwise.\") });\nexport const CONTEXT_BREAKPOINT_INPUT_FOCUSED = new RawContextKey<boolean>('breakpointInputFocused', false, { type: 'boolean', description: nls.localize('breakpointInputFocused', \"True when the input box has focus in the BREAKPOINTS view.\") });\nexport const CONTEXT_CALLSTACK_ITEM_TYPE = new RawContextKey<string>('callStackItemType', undefined, { type: 'string', description: nls.localize('callStackItemType', \"Represents the item type of the focused element in the CALL STACK view. For example: 'session', 'thread', 'stackFrame'\") });\nexport const CONTEXT_CALLSTACK_SESSION_IS_ATTACH = new RawContextKey<boolean>('callStackSessionIsAttach', false, { type: 'boolean', description: nls.localize('callStackSessionIsAttach', \"True when the session in the CALL STACK view is attach, false otherwise. Used internally for inline menus in the CALL STACK view.\") });\nexport const CONTEXT_CALLSTACK_ITEM_STOPPED = new RawContextKey<boolean>('callStackItemStopped', false, { type: 'boolean', description: nls.localize('callStackItemStopped', \"True when the focused item in the CALL STACK is stopped. Used internaly for inline menus in the CALL STACK view.\") });\nexport const CONTEXT_CALLSTACK_SESSION_HAS_ONE_THREAD = new RawContextKey<boolean>('callStackSessionHasOneThread', false, { type: 'boolean', description: nls.localize('callStackSessionHasOneThread', \"True when the focused session in the CALL STACK view has exactly one thread. Used internally for inline menus in the CALL STACK view.\") });\nexport const CONTEXT_WATCH_ITEM_TYPE = new RawContextKey<string>('watchItemType', undefined, { type: 'string', description: nls.localize('watchItemType', \"Represents the item type of the focused element in the WATCH view. For example: 'expression', 'variable'\") });\nexport const CONTEXT_CAN_VIEW_MEMORY = new RawContextKey<boolean>('canViewMemory', undefined, { type: 'boolean', description: nls.localize('canViewMemory', \"Indicates whether the item in the view has an associated memory refrence.\") });\nexport const CONTEXT_BREAKPOINT_ITEM_TYPE = new RawContextKey<string>('breakpointItemType', undefined, { type: 'string', description: nls.localize('breakpointItemType', \"Represents the item type of the focused element in the BREAKPOINTS view. For example: 'breakpoint', 'exceptionBreakppint', 'functionBreakpoint', 'dataBreakpoint'\") });\nexport const CONTEXT_BREAKPOINT_ACCESS_TYPE = new RawContextKey<string>('breakpointAccessType', undefined, { type: 'string', description: nls.localize('breakpointAccessType', \"Represents the access type of the focused data breakpoint in the BREAKPOINTS view. For example: 'read', 'readWrite', 'write'\") });\nexport const CONTEXT_BREAKPOINT_SUPPORTS_CONDITION = new RawContextKey<boolean>('breakpointSupportsCondition', false, { type: 'boolean', description: nls.localize('breakpointSupportsCondition', \"True when the focused breakpoint supports conditions.\") });\nexport const CONTEXT_LOADED_SCRIPTS_SUPPORTED = new RawContextKey<boolean>('loadedScriptsSupported', false, { type: 'boolean', description: nls.localize('loadedScriptsSupported', \"True when the focused sessions supports the LOADED SCRIPTS view\") });\nexport const CONTEXT_LOADED_SCRIPTS_ITEM_TYPE = new RawContextKey<string>('loadedScriptsItemType', undefined, { type: 'string', description: nls.localize('loadedScriptsItemType', \"Represents the item type of the focused element in the LOADED SCRIPTS view.\") });\nexport const CONTEXT_FOCUSED_SESSION_IS_ATTACH = new RawContextKey<boolean>('focusedSessionIsAttach', false, { type: 'boolean', description: nls.localize('focusedSessionIsAttach', \"True when the focused session is 'attach'.\") });\nexport const CONTEXT_STEP_BACK_SUPPORTED = new RawContextKey<boolean>('stepBackSupported', false, { type: 'boolean', description: nls.localize('stepBackSupported', \"True when the focused session supports 'stepBack' requests.\") });\nexport const CONTEXT_RESTART_FRAME_SUPPORTED = new RawContextKey<boolean>('restartFrameSupported', false, { type: 'boolean', description: nls.localize('restartFrameSupported', \"True when the focused session supports 'restartFrame' requests.\") });\nexport const CONTEXT_STACK_FRAME_SUPPORTS_RESTART = new RawContextKey<boolean>('stackFrameSupportsRestart', false, { type: 'boolean', description: nls.localize('stackFrameSupportsRestart', \"True when the focused stack frame suppots 'restartFrame'.\") });\nexport const CONTEXT_JUMP_TO_CURSOR_SUPPORTED = new RawContextKey<boolean>('jumpToCursorSupported', false, { type: 'boolean', description: nls.localize('jumpToCursorSupported', \"True when the focused session supports 'jumpToCursor' request.\") });\nexport const CONTEXT_STEP_INTO_TARGETS_SUPPORTED = new RawContextKey<boolean>('stepIntoTargetsSupported', false, { type: 'boolean', description: nls.localize('stepIntoTargetsSupported', \"True when the focused session supports 'stepIntoTargets' request.\") });\nexport const CONTEXT_BREAKPOINTS_EXIST = new RawContextKey<boolean>('breakpointsExist', false, { type: 'boolean', description: nls.localize('breakpointsExist', \"True when at least one breakpoint exists.\") });\nexport const CONTEXT_DEBUGGERS_AVAILABLE = new RawContextKey<boolean>('debuggersAvailable', false, { type: 'boolean', description: nls.localize('debuggersAvailable', \"True when there is at least one debug extensions active.\") });\nexport const CONTEXT_DEBUG_EXTENSION_AVAILABLE = new RawContextKey<boolean>('debugExtensionAvailable', false, { type: 'boolean', description: nls.localize('debugExtensionsAvailable', \"True when there is at least one debug extension installed and enabled.\") });\nexport const CONTEXT_DEBUG_PROTOCOL_VARIABLE_MENU_CONTEXT = new RawContextKey<string>('debugProtocolVariableMenuContext', undefined, { type: 'string', description: nls.localize('debugProtocolVariableMenuContext', \"Represents the context the debug adapter sets on the focused variable in the VARIABLES view.\") });\nexport const CONTEXT_SET_VARIABLE_SUPPORTED = new RawContextKey<boolean>('debugSetVariableSupported', false, { type: 'boolean', description: nls.localize('debugSetVariableSupported', \"True when the focused session supports 'setVariable' request.\") });\nexport const CONTEXT_SET_EXPRESSION_SUPPORTED = new RawContextKey<boolean>('debugSetExpressionSupported', false, { type: 'boolean', description: nls.localize('debugSetExpressionSupported', \"True when the focused session supports 'setExpression' request.\") });\nexport const CONTEXT_BREAK_WHEN_VALUE_CHANGES_SUPPORTED = new RawContextKey<boolean>('breakWhenValueChangesSupported', false, { type: 'boolean', description: nls.localize('breakWhenValueChangesSupported', \"True when the focused session supports to break when value changes.\") });\nexport const CONTEXT_BREAK_WHEN_VALUE_IS_ACCESSED_SUPPORTED = new RawContextKey<boolean>('breakWhenValueIsAccessedSupported', false, { type: 'boolean', description: nls.localize('breakWhenValueIsAccessedSupported', \"True when the focused breakpoint supports to break when value is accessed.\") });\nexport const CONTEXT_BREAK_WHEN_VALUE_IS_READ_SUPPORTED = new RawContextKey<boolean>('breakWhenValueIsReadSupported', false, { type: 'boolean', description: nls.localize('breakWhenValueIsReadSupported', \"True when the focused breakpoint supports to break when value is read.\") });\nexport const CONTEXT_TERMINATE_DEBUGGEE_SUPPORTED = new RawContextKey<boolean>('terminateDebuggeeSupported', false, { type: 'boolean', description: nls.localize('terminateDebuggeeSupported', \"True when the focused session supports the terminate debuggee capability.\") });\nexport const CONTEXT_SUSPEND_DEBUGGEE_SUPPORTED = new RawContextKey<boolean>('suspendDebuggeeSupported', false, { type: 'boolean', description: nls.localize('suspendDebuggeeSupported', \"True when the focused session supports the suspend debuggee capability.\") });\nexport const CONTEXT_VARIABLE_EVALUATE_NAME_PRESENT = new RawContextKey<boolean>('variableEvaluateNamePresent', false, { type: 'boolean', description: nls.localize('variableEvaluateNamePresent', \"True when the focused variable has an 'evalauteName' field set.\") });\nexport const CONTEXT_VARIABLE_IS_READONLY = new RawContextKey<boolean>('variableIsReadonly', false, { type: 'boolean', description: nls.localize('variableIsReadonly', \"True when the focused variable is readonly.\") });\nexport const CONTEXT_EXCEPTION_WIDGET_VISIBLE = new RawContextKey<boolean>('exceptionWidgetVisible', false, { type: 'boolean', description: nls.localize('exceptionWidgetVisible', \"True when the exception widget is visible.\") });\nexport const CONTEXT_MULTI_SESSION_REPL = new RawContextKey<boolean>('multiSessionRepl', false, { type: 'boolean', description: nls.localize('multiSessionRepl', \"True when there is more than 1 debug console.\") });\nexport const CONTEXT_MULTI_SESSION_DEBUG = new RawContextKey<boolean>('multiSessionDebug', false, { type: 'boolean', description: nls.localize('multiSessionDebug', \"True when there is more than 1 active debug session.\") });\nexport const CONTEXT_DISASSEMBLE_REQUEST_SUPPORTED = new RawContextKey<boolean>('disassembleRequestSupported', false, { type: 'boolean', description: nls.localize('disassembleRequestSupported', \"True when the focused sessions supports disassemble request.\") });\nexport const CONTEXT_DISASSEMBLY_VIEW_FOCUS = new RawContextKey<boolean>('disassemblyViewFocus', false, { type: 'boolean', description: nls.localize('disassemblyViewFocus', \"True when the Disassembly View is focused.\") });\nexport const CONTEXT_LANGUAGE_SUPPORTS_DISASSEMBLE_REQUEST = new RawContextKey<boolean>('languageSupportsDisassembleRequest', false, { type: 'boolean', description: nls.localize('languageSupportsDisassembleRequest', \"True when the language in the current editor supports disassemble request.\") });\nexport const CONTEXT_FOCUSED_STACK_FRAME_HAS_INSTRUCTION_POINTER_REFERENCE = new RawContextKey<boolean>('focusedStackFrameHasInstructionReference', false, { type: 'boolean', description: nls.localize('focusedStackFrameHasInstructionReference', \"True when the focused stack frame has instruction pointer reference.\") });\n\nexport const debuggerDisabledMessage = (debugType: string) => nls.localize('debuggerDisabled', \"Configured debug type '{0}' is installed but not supported in this environment.\", debugType);\n\nexport const EDITOR_CONTRIBUTION_ID = 'editor.contrib.debug';\nexport const BREAKPOINT_EDITOR_CONTRIBUTION_ID = 'editor.contrib.breakpoint';\nexport const DEBUG_SCHEME = 'debug';\nexport const INTERNAL_CONSOLE_OPTIONS_SCHEMA = {\n\tenum: ['neverOpen', 'openOnSessionStart', 'openOnFirstSessionStart'],\n\tdefault: 'openOnFirstSessionStart',\n\tdescription: nls.localize('internalConsoleOptions', \"Controls when the internal debug console should open.\")\n};\n\n// raw\n\nexport interface IRawModelUpdate {\n\tsessionId: string;\n\tthreads: DebugProtocol.Thread[];\n\tstoppedDetails?: IRawStoppedDetails;\n}\n\nexport interface IRawStoppedDetails {\n\treason?: string;\n\tdescription?: string;\n\tthreadId?: number;\n\ttext?: string;\n\ttotalFrames?: number;\n\tallThreadsStopped?: boolean;\n\tframesErrorMessage?: string;\n\thitBreakpointIds?: number[];\n}\n\n// model\n\nexport interface ITreeElement {\n\tgetId(): string;\n}\n\nexport interface IReplElement extends ITreeElement {\n\ttoString(includeSource?: boolean): string;\n\treadonly sourceData?: IReplElementSource;\n}\n\nexport interface IReplElementSource {\n\treadonly source: Source;\n\treadonly lineNumber: number;\n\treadonly column: number;\n}\n\nexport interface IExpressionContainer extends ITreeElement {\n\treadonly hasChildren: boolean;\n\tevaluateLazy(): Promise<void>;\n\tgetChildren(): Promise<IExpression[]>;\n\treadonly reference?: number;\n\treadonly value: string;\n\treadonly type?: string;\n\tvalueChanged?: boolean;\n\treadonly presentationHint?: DebugProtocol.VariablePresentationHint | undefined;\n}\n\nexport interface IExpression extends IExpressionContainer {\n\tname: string;\n}\n\nexport interface IDebugger {\n\tcreateDebugAdapter(session: IDebugSession): Promise<IDebugAdapter>;\n\trunInTerminal(args: DebugProtocol.RunInTerminalRequestArguments, sessionId: string): Promise<number | undefined>;\n\tgetCustomTelemetryEndpoint(): ITelemetryEndpoint | undefined;\n}\n\nexport interface IDebuggerMetadata {\n\tlabel: string;\n\ttype: string;\n\tuiMessages?: { [key in DebuggerUiMessage]: string };\n\tinterestedInLanguage(languageId: string): boolean;\n}\n\nexport const enum State {\n\tInactive,\n\tInitializing,\n\tStopped,\n\tRunning\n}\n\nexport function getStateLabel(state: State): string {\n\tswitch (state) {\n\t\tcase State.Initializing: return 'initializing';\n\t\tcase State.Stopped: return 'stopped';\n\t\tcase State.Running: return 'running';\n\t\tdefault: return 'inactive';\n\t}\n}\n\nexport interface AdapterEndEvent {\n\terror?: Error;\n\tsessionLengthInSeconds: number;\n\temittedStopped: boolean;\n}\n\nexport interface LoadedSourceEvent {\n\treason: 'new' | 'changed' | 'removed';\n\tsource: Source;\n}\n\nexport type IDebugSessionReplMode = 'separate' | 'mergeWithParent';\n\nexport interface IDebugSessionOptions {\n\tnoDebug?: boolean;\n\tparentSession?: IDebugSession;\n\tlifecycleManagedByParent?: boolean;\n\trepl?: IDebugSessionReplMode;\n\tcompoundRoot?: DebugCompoundRoot;\n\tcompact?: boolean;\n\tdebugUI?: {\n\t\tsimple?: boolean;\n\t};\n\tstartedByUser?: boolean;\n\tsaveBeforeStart?: boolean;\n}\n\nexport interface IDataBreakpointInfoResponse {\n\tdataId: string | null;\n\tdescription: string;\n\tcanPersist?: boolean;\n\taccessTypes?: DebugProtocol.DataBreakpointAccessType[];\n}\n\nexport interface IMemoryInvalidationEvent {\n\tfromOffset: number;\n\ttoOffset: number;\n}\n\nexport const enum MemoryRangeType {\n\tValid,\n\tUnreadable,\n\tError,\n}\n\nexport interface IMemoryRange {\n\ttype: MemoryRangeType;\n\toffset: number;\n\tlength: number;\n}\n\nexport interface IValidMemoryRange extends IMemoryRange {\n\ttype: MemoryRangeType.Valid;\n\toffset: number;\n\tlength: number;\n\tdata: VSBuffer;\n}\n\nexport interface IUnreadableMemoryRange extends IMemoryRange {\n\ttype: MemoryRangeType.Unreadable;\n}\n\nexport interface IErrorMemoryRange extends IMemoryRange {\n\ttype: MemoryRangeType.Error;\n\terror: string;\n}\n\n/**\n * Union type of memory that can be returned from read(). Since a read request\n * could encompass multiple previously-read ranges, multiple of these types\n * are possible to return.\n */\nexport type MemoryRange = IValidMemoryRange | IUnreadableMemoryRange | IErrorMemoryRange;\n\nexport const DEBUG_MEMORY_SCHEME = 'vscode-debug-memory';\n\n/**\n * An IMemoryRegion corresponds to a contiguous range of memory referred to\n * by a DAP `memoryReference`.\n */\nexport interface IMemoryRegion extends IDisposable {\n\t/**\n\t * Event that fires when memory changes. Can be a result of memory events or\n\t * `write` requests.\n\t */\n\treadonly onDidInvalidate: Event<IMemoryInvalidationEvent>;\n\n\t/**\n\t * Whether writes are supported on this memory region.\n\t */\n\treadonly writable: boolean;\n\n\t/**\n\t * Requests memory ranges from the debug adapter. It returns a list of memory\n\t * ranges that overlap (but may exceed!) the given offset. Use the `offset`\n\t * and `length` of each range for display.\n\t */\n\tread(fromOffset: number, toOffset: number): Promise<MemoryRange[]>;\n\n\t/**\n\t * Writes memory to the debug adapter at the given offset.\n\t */\n\twrite(offset: number, data: VSBuffer): Promise<number>;\n}\n\nexport interface IDebugSession extends ITreeElement {\n\n\treadonly configuration: IConfig;\n\treadonly unresolvedConfiguration: IConfig | undefined;\n\treadonly state: State;\n\treadonly root: IWorkspaceFolder | undefined;\n\treadonly parentSession: IDebugSession | undefined;\n\treadonly subId: string | undefined;\n\treadonly compact: boolean;\n\treadonly compoundRoot: DebugCompoundRoot | undefined;\n\treadonly saveBeforeStart: boolean;\n\treadonly name: string;\n\treadonly isSimpleUI: boolean;\n\treadonly autoExpandLazyVariables: boolean;\n\n\tsetSubId(subId: string | undefined): void;\n\n\tgetMemory(memoryReference: string): IMemoryRegion;\n\n\tsetName(name: string): void;\n\treadonly onDidChangeName: Event<string>;\n\tgetLabel(): string;\n\n\tgetSourceForUri(modelUri: uri): Source | undefined;\n\tgetSource(raw?: DebugProtocol.Source): Source;\n\n\tsetConfiguration(configuration: { resolved: IConfig; unresolved: IConfig | undefined }): void;\n\trawUpdate(data: IRawModelUpdate): void;\n\n\tgetThread(threadId: number): IThread | undefined;\n\tgetAllThreads(): IThread[];\n\tclearThreads(removeThreads: boolean, reference?: number): void;\n\tgetStoppedDetails(): IRawStoppedDetails | undefined;\n\n\tgetReplElements(): IReplElement[];\n\thasSeparateRepl(): boolean;\n\tremoveReplExpressions(): void;\n\taddReplExpression(stackFrame: IStackFrame | undefined, name: string): Promise<void>;\n\tappendToRepl(data: string | IExpression, severity: severity, isImportant?: boolean, source?: IReplElementSource): void;\n\n\t// session events\n\treadonly onDidEndAdapter: Event<AdapterEndEvent | undefined>;\n\treadonly onDidChangeState: Event<void>;\n\treadonly onDidChangeReplElements: Event<void>;\n\n\t// DA capabilities\n\treadonly capabilities: DebugProtocol.Capabilities;\n\n\t// DAP events\n\n\treadonly onDidLoadedSource: Event<LoadedSourceEvent>;\n\treadonly onDidCustomEvent: Event<DebugProtocol.Event>;\n\treadonly onDidProgressStart: Event<DebugProtocol.ProgressStartEvent>;\n\treadonly onDidProgressUpdate: Event<DebugProtocol.ProgressUpdateEvent>;\n\treadonly onDidProgressEnd: Event<DebugProtocol.ProgressEndEvent>;\n\treadonly onDidInvalidateMemory: Event<DebugProtocol.MemoryEvent>;\n\n\t// DAP request\n\n\tinitialize(dbgr: IDebugger): Promise<void>;\n\tlaunchOrAttach(config: IConfig): Promise<void>;\n\trestart(): Promise<void>;\n\tterminate(restart?: boolean /* false */): Promise<void>;\n\tdisconnect(restart?: boolean /* false */, suspend?: boolean): Promise<void>;\n\n\tsendBreakpoints(modelUri: uri, bpts: IBreakpoint[], sourceModified: boolean): Promise<void>;\n\tsendFunctionBreakpoints(fbps: IFunctionBreakpoint[]): Promise<void>;\n\tdataBreakpointInfo(name: string, variablesReference?: number): Promise<IDataBreakpointInfoResponse | undefined>;\n\tsendDataBreakpoints(dbps: IDataBreakpoint[]): Promise<void>;\n\tsendInstructionBreakpoints(dbps: IInstructionBreakpoint[]): Promise<void>;\n\tsendExceptionBreakpoints(exbpts: IExceptionBreakpoint[]): Promise<void>;\n\tbreakpointsLocations(uri: uri, lineNumber: number): Promise<IPosition[]>;\n\tgetDebugProtocolBreakpoint(breakpointId: string): DebugProtocol.Breakpoint | undefined;\n\n\tstackTrace(threadId: number, startFrame: number, levels: number, token: CancellationToken): Promise<DebugProtocol.StackTraceResponse | undefined>;\n\texceptionInfo(threadId: number): Promise<IExceptionInfo | undefined>;\n\tscopes(frameId: number, threadId: number): Promise<DebugProtocol.ScopesResponse | undefined>;\n\tvariables(variablesReference: number, threadId: number | undefined, filter: 'indexed' | 'named' | undefined, start: number | undefined, count: number | undefined): Promise<DebugProtocol.VariablesResponse | undefined>;\n\tevaluate(expression: string, frameId?: number, context?: string): Promise<DebugProtocol.EvaluateResponse | undefined>;\n\tcustomRequest(request: string, args: any): Promise<DebugProtocol.Response | undefined>;\n\tcancel(progressId: string): Promise<DebugProtocol.CancelResponse | undefined>;\n\tdisassemble(memoryReference: string, offset: number, instructionOffset: number, instructionCount: number): Promise<DebugProtocol.DisassembledInstruction[] | undefined>;\n\treadMemory(memoryReference: string, offset: number, count: number): Promise<DebugProtocol.ReadMemoryResponse | undefined>;\n\twriteMemory(memoryReference: string, offset: number, data: string, allowPartial?: boolean): Promise<DebugProtocol.WriteMemoryResponse | undefined>;\n\n\trestartFrame(frameId: number, threadId: number): Promise<void>;\n\tnext(threadId: number, granularity?: DebugProtocol.SteppingGranularity): Promise<void>;\n\tstepIn(threadId: number, targetId?: number, granularity?: DebugProtocol.SteppingGranularity): Promise<void>;\n\tstepInTargets(frameId: number): Promise<DebugProtocol.StepInTarget[] | undefined>;\n\tstepOut(threadId: number, granularity?: DebugProtocol.SteppingGranularity): Promise<void>;\n\tstepBack(threadId: number, granularity?: DebugProtocol.SteppingGranularity): Promise<void>;\n\tcontinue(threadId: number): Promise<void>;\n\treverseContinue(threadId: number): Promise<void>;\n\tpause(threadId: number): Promise<void>;\n\tterminateThreads(threadIds: number[]): Promise<void>;\n\n\tcompletions(frameId: number | undefined, threadId: number, text: string, position: Position, overwriteBefore: number, token: CancellationToken): Promise<DebugProtocol.CompletionsResponse | undefined>;\n\tsetVariable(variablesReference: number | undefined, name: string, value: string): Promise<DebugProtocol.SetVariableResponse | undefined>;\n\tsetExpression(frameId: number, expression: string, value: string): Promise<DebugProtocol.SetExpressionResponse | undefined>;\n\tloadSource(resource: uri): Promise<DebugProtocol.SourceResponse | undefined>;\n\tgetLoadedSources(): Promise<Source[]>;\n\n\tgotoTargets(source: DebugProtocol.Source, line: number, column?: number): Promise<DebugProtocol.GotoTargetsResponse | undefined>;\n\tgoto(threadId: number, targetId: number): Promise<DebugProtocol.GotoResponse | undefined>;\n}\n\nexport interface IThread extends ITreeElement {\n\n\t/**\n\t * Process the thread belongs to\n\t */\n\treadonly session: IDebugSession;\n\n\t/**\n\t * Id of the thread generated by the debug adapter backend.\n\t */\n\treadonly threadId: number;\n\n\t/**\n\t * Name of the thread.\n\t */\n\treadonly name: string;\n\n\t/**\n\t * Information about the current thread stop event. Undefined if thread is not stopped.\n\t */\n\treadonly stoppedDetails: IRawStoppedDetails | undefined;\n\n\t/**\n\t * Information about the exception if an 'exception' stopped event raised and DA supports the 'exceptionInfo' request, otherwise undefined.\n\t */\n\treadonly exceptionInfo: Promise<IExceptionInfo | undefined>;\n\n\treadonly stateLabel: string;\n\n\t/**\n\t * Gets the callstack if it has already been received from the debug\n\t * adapter.\n\t */\n\tgetCallStack(): ReadonlyArray<IStackFrame>;\n\n\n\t/**\n\t * Gets the top stack frame that is not hidden if the callstack has already been received from the debug adapter\n\t */\n\tgetTopStackFrame(): IStackFrame | undefined;\n\n\t/**\n\t * Invalidates the callstack cache\n\t */\n\tclearCallStack(): void;\n\n\t/**\n\t * Indicates whether this thread is stopped. The callstack for stopped\n\t * threads can be retrieved from the debug adapter.\n\t */\n\treadonly stopped: boolean;\n\n\tnext(granularity?: DebugProtocol.SteppingGranularity): Promise<any>;\n\tstepIn(granularity?: DebugProtocol.SteppingGranularity): Promise<any>;\n\tstepOut(granularity?: DebugProtocol.SteppingGranularity): Promise<any>;\n\tstepBack(granularity?: DebugProtocol.SteppingGranularity): Promise<any>;\n\tcontinue(): Promise<any>;\n\tpause(): Promise<any>;\n\tterminate(): Promise<any>;\n\treverseContinue(): Promise<any>;\n}\n\nexport interface IScope extends IExpressionContainer {\n\treadonly name: string;\n\treadonly expensive: boolean;\n\treadonly range?: IRange;\n\treadonly hasChildren: boolean;\n}\n\nexport interface IStackFrame extends ITreeElement {\n\treadonly thread: IThread;\n\treadonly name: string;\n\treadonly presentationHint: string | undefined;\n\treadonly frameId: number;\n\treadonly range: IRange;\n\treadonly source: Source;\n\treadonly canRestart: boolean;\n\treadonly instructionPointerReference?: string;\n\tgetScopes(): Promise<IScope[]>;\n\tgetMostSpecificScopes(range: IRange): Promise<ReadonlyArray<IScope>>;\n\tforgetScopes(): void;\n\trestart(): Promise<any>;\n\ttoString(): string;\n\topenInEditor(editorService: IEditorService, preserveFocus?: boolean, sideBySide?: boolean, pinned?: boolean): Promise<IEditorPane | undefined>;\n\tequals(other: IStackFrame): boolean;\n}\n\nexport interface IEnablement extends ITreeElement {\n\treadonly enabled: boolean;\n}\n\nexport interface IBreakpointData {\n\treadonly id?: string;\n\treadonly lineNumber: number;\n\treadonly column?: number;\n\treadonly enabled?: boolean;\n\treadonly condition?: string;\n\treadonly logMessage?: string;\n\treadonly hitCondition?: string;\n}\n\nexport interface IBreakpointUpdateData {\n\treadonly condition?: string;\n\treadonly hitCondition?: string;\n\treadonly logMessage?: string;\n\treadonly lineNumber?: number;\n\treadonly column?: number;\n}\n\nexport interface IBaseBreakpoint extends IEnablement {\n\treadonly condition?: string;\n\treadonly hitCondition?: string;\n\treadonly logMessage?: string;\n\treadonly verified: boolean;\n\treadonly supported: boolean;\n\treadonly message?: string;\n\treadonly sessionsThatVerified: string[];\n\tgetIdFromAdapter(sessionId: string): number | undefined;\n}\n\nexport interface IBreakpoint extends IBaseBreakpoint {\n\treadonly uri: uri;\n\treadonly lineNumber: number;\n\treadonly endLineNumber?: number;\n\treadonly column?: number;\n\treadonly endColumn?: number;\n\treadonly adapterData: any;\n\treadonly sessionAgnosticData: { lineNumber: number; column: number | undefined };\n}\n\nexport interface IFunctionBreakpoint extends IBaseBreakpoint {\n\treadonly name: string;\n}\n\nexport interface IExceptionBreakpoint extends IBaseBreakpoint {\n\treadonly filter: string;\n\treadonly label: string;\n\treadonly description: string | undefined;\n}\n\nexport interface IDataBreakpoint extends IBaseBreakpoint {\n\treadonly description: string;\n\treadonly dataId: string;\n\treadonly canPersist: boolean;\n\treadonly accessType: DebugProtocol.DataBreakpointAccessType;\n}\n\nexport interface IInstructionBreakpoint extends IBaseBreakpoint {\n\t// instructionReference is the instruction 'address' from the debugger.\n\treadonly instructionReference: string;\n\treadonly offset?: number;\n}\n\nexport interface IExceptionInfo {\n\treadonly id?: string;\n\treadonly description?: string;\n\treadonly breakMode: string | null;\n\treadonly details?: DebugProtocol.ExceptionDetails;\n}\n\n// model interfaces\n\nexport interface IViewModel extends ITreeElement {\n\t/**\n\t * Returns the focused debug session or undefined if no session is stopped.\n\t */\n\treadonly focusedSession: IDebugSession | undefined;\n\n\t/**\n\t * Returns the focused thread or undefined if no thread is stopped.\n\t */\n\treadonly focusedThread: IThread | undefined;\n\n\t/**\n\t * Returns the focused stack frame or undefined if there are no stack frames.\n\t */\n\treadonly focusedStackFrame: IStackFrame | undefined;\n\n\tgetSelectedExpression(): { expression: IExpression; settingWatch: boolean } | undefined;\n\tsetSelectedExpression(expression: IExpression | undefined, settingWatch: boolean): void;\n\tupdateViews(): void;\n\n\tisMultiSessionView(): boolean;\n\n\tonDidFocusSession: Event<IDebugSession | undefined>;\n\tonDidFocusStackFrame: Event<{ stackFrame: IStackFrame | undefined; explicit: boolean }>;\n\tonDidSelectExpression: Event<{ expression: IExpression; settingWatch: boolean } | undefined>;\n\tonDidEvaluateLazyExpression: Event<IExpressionContainer>;\n\tonWillUpdateViews: Event<void>;\n\n\tevaluateLazyExpression(expression: IExpressionContainer): void;\n}\n\nexport interface IEvaluate {\n\tevaluate(session: IDebugSession, stackFrame: IStackFrame, context: string): Promise<void>;\n}\n\nexport interface IDebugModel extends ITreeElement {\n\tgetSession(sessionId: string | undefined, includeInactive?: boolean): IDebugSession | undefined;\n\tgetSessions(includeInactive?: boolean): IDebugSession[];\n\tgetBreakpoints(filter?: { uri?: uri; lineNumber?: number; column?: number; enabledOnly?: boolean }): ReadonlyArray<IBreakpoint>;\n\tareBreakpointsActivated(): boolean;\n\tgetFunctionBreakpoints(): ReadonlyArray<IFunctionBreakpoint>;\n\tgetDataBreakpoints(): ReadonlyArray<IDataBreakpoint>;\n\tgetExceptionBreakpoints(): ReadonlyArray<IExceptionBreakpoint>;\n\tgetInstructionBreakpoints(): ReadonlyArray<IInstructionBreakpoint>;\n\tgetWatchExpressions(): ReadonlyArray<IExpression & IEvaluate>;\n\n\tonDidChangeBreakpoints: Event<IBreakpointsChangeEvent | undefined>;\n\tonDidChangeCallStack: Event<void>;\n\tonDidChangeWatchExpressions: Event<IExpression | undefined>;\n\n\tfetchCallstack(thread: IThread, levels?: number): Promise<void>;\n}\n\n/**\n * An event describing a change to the set of [breakpoints](#debug.Breakpoint).\n */\nexport interface IBreakpointsChangeEvent {\n\tadded?: Array<IBreakpoint | IFunctionBreakpoint | IDataBreakpoint | IInstructionBreakpoint>;\n\tremoved?: Array<IBreakpoint | IFunctionBreakpoint | IDataBreakpoint | IInstructionBreakpoint>;\n\tchanged?: Array<IBreakpoint | IFunctionBreakpoint | IDataBreakpoint | IInstructionBreakpoint>;\n\tsessionOnly: boolean;\n}\n\n// Debug configuration interfaces\n\nexport interface IDebugConfiguration {\n\tallowBreakpointsEverywhere: boolean;\n\topenDebug: 'neverOpen' | 'openOnSessionStart' | 'openOnFirstSessionStart' | 'openOnDebugBreak';\n\topenExplorerOnEnd: boolean;\n\tinlineValues: boolean | 'auto' | 'on' | 'off'; // boolean for back-compat\n\ttoolBarLocation: 'floating' | 'docked' | 'hidden';\n\tshowInStatusBar: 'never' | 'always' | 'onFirstSessionStart';\n\tinternalConsoleOptions: 'neverOpen' | 'openOnSessionStart' | 'openOnFirstSessionStart';\n\textensionHostDebugAdapter: boolean;\n\tenableAllHovers: boolean;\n\tshowSubSessionsInToolBar: boolean;\n\tconsole: {\n\t\tfontSize: number;\n\t\tfontFamily: string;\n\t\tlineHeight: number;\n\t\twordWrap: boolean;\n\t\tcloseOnEnd: boolean;\n\t\tcollapseIdenticalLines: boolean;\n\t\thistorySuggestions: boolean;\n\t\tacceptSuggestionOnEnter: 'off' | 'on';\n\t};\n\tfocusWindowOnBreak: boolean;\n\tfocusEditorOnBreak: boolean;\n\tonTaskErrors: 'debugAnyway' | 'showErrors' | 'prompt' | 'abort';\n\tshowBreakpointsInOverviewRuler: boolean;\n\tshowInlineBreakpointCandidates: boolean;\n\tconfirmOnExit: 'always' | 'never';\n\tdisassemblyView: {\n\t\tshowSourceCode: boolean;\n\t};\n\tautoExpandLazyVariables: boolean;\n}\n\nexport interface IGlobalConfig {\n\tversion: string;\n\tcompounds: ICompound[];\n\tconfigurations: IConfig[];\n}\n\nexport interface IEnvConfig {\n\tinternalConsoleOptions?: 'neverOpen' | 'openOnSessionStart' | 'openOnFirstSessionStart';\n\tpreRestartTask?: string | ITaskIdentifier;\n\tpostRestartTask?: string | ITaskIdentifier;\n\tpreLaunchTask?: string | ITaskIdentifier;\n\tpostDebugTask?: string | ITaskIdentifier;\n\tdebugServer?: number;\n\tnoDebug?: boolean;\n}\n\nexport interface IConfigPresentation {\n\thidden?: boolean;\n\tgroup?: string;\n\torder?: number;\n}\n\nexport interface IConfig extends IEnvConfig {\n\n\t// fundamental attributes\n\ttype: string;\n\trequest: string;\n\tname: string;\n\tpresentation?: IConfigPresentation;\n\t// platform specifics\n\twindows?: IEnvConfig;\n\tosx?: IEnvConfig;\n\tlinux?: IEnvConfig;\n\n\t// internals\n\t__configurationTarget?: ConfigurationTarget;\n\t__sessionId?: string;\n\t__restart?: any;\n\t__autoAttach?: boolean;\n\tport?: number; // TODO\n}\n\nexport interface ICompound {\n\tname: string;\n\tstopAll?: boolean;\n\tpreLaunchTask?: string | ITaskIdentifier;\n\tconfigurations: (string | { name: string; folder: string })[];\n\tpresentation?: IConfigPresentation;\n}\n\nexport interface IDebugAdapter extends IDisposable {\n\treadonly onError: Event<Error>;\n\treadonly onExit: Event<number | null>;\n\tonRequest(callback: (request: DebugProtocol.Request) => void): void;\n\tonEvent(callback: (event: DebugProtocol.Event) => void): void;\n\tstartSession(): Promise<void>;\n\tsendMessage(message: DebugProtocol.ProtocolMessage): void;\n\tsendResponse(response: DebugProtocol.Response): void;\n\tsendRequest(command: string, args: any, clb: (result: DebugProtocol.Response) => void, timeout?: number): number;\n\tstopSession(): Promise<void>;\n}\n\nexport interface IDebugAdapterFactory extends ITerminalLauncher {\n\tcreateDebugAdapter(session: IDebugSession): IDebugAdapter;\n\tsubstituteVariables(folder: IWorkspaceFolder | undefined, config: IConfig): Promise<IConfig>;\n}\n\nexport interface IDebugAdapterExecutableOptions {\n\tcwd?: string;\n\tenv?: { [key: string]: string };\n}\n\nexport interface IDebugAdapterExecutable {\n\treadonly type: 'executable';\n\treadonly command: string;\n\treadonly args: string[];\n\treadonly options?: IDebugAdapterExecutableOptions;\n}\n\nexport interface IDebugAdapterServer {\n\treadonly type: 'server';\n\treadonly port: number;\n\treadonly host?: string;\n}\n\nexport interface IDebugAdapterNamedPipeServer {\n\treadonly type: 'pipeServer';\n\treadonly path: string;\n}\n\nexport interface IDebugAdapterInlineImpl extends IDisposable {\n\treadonly onDidSendMessage: Event<DebugProtocol.Message>;\n\thandleMessage(message: DebugProtocol.Message): void;\n}\n\nexport interface IDebugAdapterImpl {\n\treadonly type: 'implementation';\n\treadonly implementation: IDebugAdapterInlineImpl;\n}\n\nexport type IAdapterDescriptor = IDebugAdapterExecutable | IDebugAdapterServer | IDebugAdapterNamedPipeServer | IDebugAdapterImpl;\n\nexport interface IPlatformSpecificAdapterContribution {\n\tprogram?: string;\n\targs?: string[];\n\truntime?: string;\n\truntimeArgs?: string[];\n}\n\nexport interface IDebuggerContribution extends IPlatformSpecificAdapterContribution {\n\ttype: string;\n\tlabel?: string;\n\twin?: IPlatformSpecificAdapterContribution;\n\twinx86?: IPlatformSpecificAdapterContribution;\n\twindows?: IPlatformSpecificAdapterContribution;\n\tosx?: IPlatformSpecificAdapterContribution;\n\tlinux?: IPlatformSpecificAdapterContribution;\n\n\t// internal\n\taiKey?: string;\n\n\t// supported languages\n\tlanguages?: string[];\n\n\t// debug configuration support\n\tconfigurationAttributes?: any;\n\tinitialConfigurations?: any[];\n\tconfigurationSnippets?: IJSONSchemaSnippet[];\n\tvariables?: { [key: string]: string };\n\twhen?: string;\n\tdeprecated?: string;\n\tuiMessages?: { [key in DebuggerUiMessage]: string };\n}\n\nexport interface IBreakpointContribution {\n\tlanguage: string;\n\twhen?: string;\n}\n\nexport enum DebugConfigurationProviderTriggerKind {\n\t/**\n\t *\t`DebugConfigurationProvider.provideDebugConfigurations` is called to provide the initial debug configurations for a newly created launch.json.\n\t */\n\tInitial = 1,\n\t/**\n\t * `DebugConfigurationProvider.provideDebugConfigurations` is called to provide dynamically generated debug configurations when the user asks for them through the UI (e.g. via the \"Select and Start Debugging\" command).\n\t */\n\tDynamic = 2\n}\n\nexport interface IDebugConfigurationProvider {\n\treadonly type: string;\n\treadonly triggerKind: DebugConfigurationProviderTriggerKind;\n\tresolveDebugConfiguration?(folderUri: uri | undefined, debugConfiguration: IConfig, token: CancellationToken): Promise<IConfig | null | undefined>;\n\tresolveDebugConfigurationWithSubstitutedVariables?(folderUri: uri | undefined, debugConfiguration: IConfig, token: CancellationToken): Promise<IConfig | null | undefined>;\n\tprovideDebugConfigurations?(folderUri: uri | undefined, token: CancellationToken): Promise<IConfig[]>;\n}\n\nexport interface IDebugAdapterDescriptorFactory {\n\treadonly type: string;\n\tcreateDebugAdapterDescriptor(session: IDebugSession): Promise<IAdapterDescriptor>;\n}\n\nexport interface IDebugAdapterTrackerFactory {\n\treadonly type: string;\n}\n\nexport interface ITerminalLauncher {\n\trunInTerminal(args: DebugProtocol.RunInTerminalRequestArguments, sessionId: string): Promise<number | undefined>;\n}\n\nexport interface IConfigurationManager {\n\n\t/**\n\t * Returns an object containing the selected launch configuration and the selected configuration name. Both these fields can be null (no folder workspace).\n\t */\n\treadonly selectedConfiguration: {\n\t\tlaunch: ILaunch | undefined;\n\t\t// Potentially activates extensions\n\t\tgetConfig: () => Promise<IConfig | undefined>;\n\t\tname: string | undefined;\n\t\t// Type is used when matching dynamic configurations to their corresponding provider\n\t\ttype: string | undefined;\n\t};\n\n\tselectConfiguration(launch: ILaunch | undefined, name?: string, config?: IConfig, dynamicConfigOptions?: { type?: string }): Promise<void>;\n\n\tgetLaunches(): ReadonlyArray<ILaunch>;\n\tgetLaunch(workspaceUri: uri | undefined): ILaunch | undefined;\n\tgetAllConfigurations(): { launch: ILaunch; name: string; presentation?: IConfigPresentation }[];\n\tremoveRecentDynamicConfigurations(name: string, type: string): void;\n\tgetRecentDynamicConfigurations(): { name: string; type: string }[];\n\n\t/**\n\t * Allows to register on change of selected debug configuration.\n\t */\n\tonDidSelectConfiguration: Event<void>;\n\n\thasDebugConfigurationProvider(debugType: string): boolean;\n\tgetDynamicProviders(): Promise<{ label: string; type: string; pick: () => Promise<{ launch: ILaunch; config: IConfig } | undefined> }[]>;\n\n\tregisterDebugConfigurationProvider(debugConfigurationProvider: IDebugConfigurationProvider): IDisposable;\n\tunregisterDebugConfigurationProvider(debugConfigurationProvider: IDebugConfigurationProvider): void;\n\n\tresolveConfigurationByProviders(folderUri: uri | undefined, type: string | undefined, debugConfiguration: any, token: CancellationToken): Promise<any>;\n}\n\nexport enum DebuggerUiMessage {\n\tUnverifiedBreakpoints = 'unverifiedBreakpoints'\n}\n\nexport interface IAdapterManager {\n\n\tonDidRegisterDebugger: Event<void>;\n\n\thasEnabledDebuggers(): boolean;\n\tgetDebugAdapterDescriptor(session: IDebugSession): Promise<IAdapterDescriptor | undefined>;\n\tgetDebuggerLabel(type: string): string | undefined;\n\tsomeDebuggerInterestedInLanguage(language: string): boolean;\n\tgetDebugger(type: string): IDebuggerMetadata | undefined;\n\n\tactivateDebuggers(activationEvent: string, debugType?: string): Promise<void>;\n\tregisterDebugAdapterFactory(debugTypes: string[], debugAdapterFactory: IDebugAdapterFactory): IDisposable;\n\tcreateDebugAdapter(session: IDebugSession): IDebugAdapter | undefined;\n\tregisterDebugAdapterDescriptorFactory(debugAdapterDescriptorFactory: IDebugAdapterDescriptorFactory): IDisposable;\n\tunregisterDebugAdapterDescriptorFactory(debugAdapterDescriptorFactory: IDebugAdapterDescriptorFactory): void;\n\n\tsubstituteVariables(debugType: string, folder: IWorkspaceFolder | undefined, config: IConfig): Promise<IConfig>;\n\trunInTerminal(debugType: string, args: DebugProtocol.RunInTerminalRequestArguments, sessionId: string): Promise<number | undefined>;\n}\n\nexport interface ILaunch {\n\n\t/**\n\t * Resource pointing to the launch.json this object is wrapping.\n\t */\n\treadonly uri: uri;\n\n\t/**\n\t * Name of the launch.\n\t */\n\treadonly name: string;\n\n\t/**\n\t * Workspace of the launch. Can be undefined.\n\t */\n\treadonly workspace: IWorkspaceFolder | undefined;\n\n\t/**\n\t * Should this launch be shown in the debug dropdown.\n\t */\n\treadonly hidden: boolean;\n\n\t/**\n\t * Returns a configuration with the specified name.\n\t * Returns undefined if there is no configuration with the specified name.\n\t */\n\tgetConfiguration(name: string): IConfig | undefined;\n\n\t/**\n\t * Returns a compound with the specified name.\n\t * Returns undefined if there is no compound with the specified name.\n\t */\n\tgetCompound(name: string): ICompound | undefined;\n\n\t/**\n\t * Returns the names of all configurations and compounds.\n\t * Ignores configurations which are invalid.\n\t */\n\tgetConfigurationNames(ignoreCompoundsAndPresentation?: boolean): string[];\n\n\t/**\n\t * Opens the launch.json file. Creates if it does not exist.\n\t */\n\topenConfigFile(options: { preserveFocus: boolean; type?: string; suppressInitialConfigs?: boolean }, token?: CancellationToken): Promise<{ editor: IEditorPane | null; created: boolean }>;\n}\n\n// Debug service interfaces\n\nexport const IDebugService = createDecorator<IDebugService>(DEBUG_SERVICE_ID);\n\nexport interface IDebugService {\n\treadonly _serviceBrand: undefined;\n\n\t/**\n\t * Gets the current debug state.\n\t */\n\treadonly state: State;\n\n\treadonly initializingOptions?: IDebugSessionOptions | undefined;\n\n\t/**\n\t * Allows to register on debug state changes.\n\t */\n\tonDidChangeState: Event<State>;\n\n\t/**\n\t * Allows to register on new session events.\n\t */\n\tonDidNewSession: Event<IDebugSession>;\n\n\t/**\n\t * Allows to register on sessions about to be created (not yet fully initialised)\n\t */\n\tonWillNewSession: Event<IDebugSession>;\n\n\t/**\n\t * Allows to register on end session events.\n\t */\n\tonDidEndSession: Event<IDebugSession>;\n\n\t/**\n\t * Gets the configuration manager.\n\t */\n\tgetConfigurationManager(): IConfigurationManager;\n\n\t/**\n\t * Gets the adapter manager.\n\t */\n\tgetAdapterManager(): IAdapterManager;\n\n\t/**\n\t * Sets the focused stack frame and evaluates all expressions against the newly focused stack frame,\n\t */\n\tfocusStackFrame(focusedStackFrame: IStackFrame | undefined, thread?: IThread, session?: IDebugSession, options?: { explicit?: boolean; preserveFocus?: boolean; sideBySide?: boolean; pinned?: boolean }): Promise<void>;\n\n\t/**\n\t * Returns true if breakpoints can be set for a given editor model. Depends on mode.\n\t */\n\tcanSetBreakpointsIn(model: EditorIModel): boolean;\n\n\t/**\n\t * Adds new breakpoints to the model for the file specified with the uri. Notifies debug adapter of breakpoint changes.\n\t */\n\taddBreakpoints(uri: uri, rawBreakpoints: IBreakpointData[], ariaAnnounce?: boolean): Promise<IBreakpoint[]>;\n\n\t/**\n\t * Updates the breakpoints.\n\t */\n\tupdateBreakpoints(uri: uri, data: Map<string, IBreakpointUpdateData>, sendOnResourceSaved: boolean): Promise<void>;\n\n\t/**\n\t * Enables or disables all breakpoints. If breakpoint is passed only enables or disables the passed breakpoint.\n\t * Notifies debug adapter of breakpoint changes.\n\t */\n\tenableOrDisableBreakpoints(enable: boolean, breakpoint?: IEnablement): Promise<void>;\n\n\t/**\n\t * Sets the global activated property for all breakpoints.\n\t * Notifies debug adapter of breakpoint changes.\n\t */\n\tsetBreakpointsActivated(activated: boolean): Promise<void>;\n\n\t/**\n\t * Removes all breakpoints. If id is passed only removes the breakpoint associated with that id.\n\t * Notifies debug adapter of breakpoint changes.\n\t */\n\tremoveBreakpoints(id?: string): Promise<any>;\n\n\t/**\n\t * Adds a new function breakpoint for the given name.\n\t */\n\taddFunctionBreakpoint(name?: string, id?: string): void;\n\n\t/**\n\t * Updates an already existing function breakpoint.\n\t * Notifies debug adapter of breakpoint changes.\n\t */\n\tupdateFunctionBreakpoint(id: string, update: { name?: string; hitCondition?: string; condition?: string }): Promise<void>;\n\n\t/**\n\t * Removes all function breakpoints. If id is passed only removes the function breakpoint with the passed id.\n\t * Notifies debug adapter of breakpoint changes.\n\t */\n\tremoveFunctionBreakpoints(id?: string): Promise<void>;\n\n\t/**\n\t * Adds a new data breakpoint.\n\t */\n\taddDataBreakpoint(label: string, dataId: string, canPersist: boolean, accessTypes: DebugProtocol.DataBreakpointAccessType[] | undefined, accessType: DebugProtocol.DataBreakpointAccessType): Promise<void>;\n\n\t/**\n\t * Removes all data breakpoints. If id is passed only removes the data breakpoint with the passed id.\n\t * Notifies debug adapter of breakpoint changes.\n\t */\n\tremoveDataBreakpoints(id?: string): Promise<void>;\n\n\t/**\n\t * Adds a new instruction breakpoint.\n\t */\n\taddInstructionBreakpoint(address: string, offset: number, condition?: string, hitCondition?: string): Promise<void>;\n\n\t/**\n\t * Removes all instruction breakpoints. If address is passed only removes the instruction breakpoint with the passed address.\n\t * The address should be the address string supplied by the debugger from the \"Disassemble\" request.\n\t * Notifies debug adapter of breakpoint changes.\n\t */\n\tremoveInstructionBreakpoints(address?: string): Promise<void>;\n\n\tsetExceptionBreakpointCondition(breakpoint: IExceptionBreakpoint, condition: string | undefined): Promise<void>;\n\n\tsetExceptionBreakpoints(data: DebugProtocol.ExceptionBreakpointsFilter[]): void;\n\n\t/**\n\t * Sends all breakpoints to the passed session.\n\t * If session is not passed, sends all breakpoints to each session.\n\t */\n\tsendAllBreakpoints(session?: IDebugSession): Promise<any>;\n\n\t/**\n\t * Adds a new watch expression and evaluates it against the debug adapter.\n\t */\n\taddWatchExpression(name?: string): void;\n\n\t/**\n\t * Renames a watch expression and evaluates it against the debug adapter.\n\t */\n\trenameWatchExpression(id: string, newName: string): void;\n\n\t/**\n\t * Moves a watch expression to a new possition. Used for reordering watch expressions.\n\t */\n\tmoveWatchExpression(id: string, position: number): void;\n\n\t/**\n\t * Removes all watch expressions. If id is passed only removes the watch expression with the passed id.\n\t */\n\tremoveWatchExpressions(id?: string): void;\n\n\t/**\n\t * Starts debugging. If the configOrName is not passed uses the selected configuration in the debug dropdown.\n\t * Also saves all files, manages if compounds are present in the configuration\n\t * and resolveds configurations via DebugConfigurationProviders.\n\t *\n\t * Returns true if the start debugging was successful. For compound launches, all configurations have to start successfully for it to return success.\n\t * On errors the startDebugging will throw an error, however some error and cancelations are handled and in that case will simply return false.\n\t */\n\tstartDebugging(launch: ILaunch | undefined, configOrName?: IConfig | string, options?: IDebugSessionOptions): Promise<boolean>;\n\n\t/**\n\t * Restarts a session or creates a new one if there is no active session.\n\t */\n\trestartSession(session: IDebugSession, restartData?: any): Promise<any>;\n\n\t/**\n\t * Stops the session. If no session is specified then all sessions are stopped.\n\t */\n\tstopSession(session: IDebugSession | undefined, disconnect?: boolean, suspend?: boolean): Promise<any>;\n\n\t/**\n\t * Makes unavailable all sources with the passed uri. Source will appear as grayed out in callstack view.\n\t */\n\tsourceIsNotAvailable(uri: uri): void;\n\n\t/**\n\t * Gets the current debug model.\n\t */\n\tgetModel(): IDebugModel;\n\n\t/**\n\t * Gets the current view model.\n\t */\n\tgetViewModel(): IViewModel;\n\n\t/**\n\t * Resumes execution and pauses until the given position is reached.\n\t */\n\trunTo(uri: uri, lineNumber: number, column?: number): Promise<void>;\n}\n\n// Editor interfaces\nexport const enum BreakpointWidgetContext {\n\tCONDITION = 0,\n\tHIT_COUNT = 1,\n\tLOG_MESSAGE = 2\n}\n\nexport interface IDebugEditorContribution extends editorCommon.IEditorContribution {\n\tshowHover(range: Range, focus: boolean): Promise<void>;\n\taddLaunchConfiguration(): Promise<any>;\n\tcloseExceptionWidget(): void;\n}\n\nexport interface IBreakpointEditorContribution extends editorCommon.IEditorContribution {\n\tshowBreakpointWidget(lineNumber: number, column: number | undefined, context?: BreakpointWidgetContext): void;\n\tcloseBreakpointWidget(): void;\n\tgetContextMenuActionsAtPosition(lineNumber: number, model: EditorIModel): IAction[];\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { equalsIgnoreCase } from 'vs/base/common/strings';\nimport { IDebuggerContribution, IDebugSession, IConfigPresentation } from 'vs/workbench/contrib/debug/common/debug';\nimport { URI as uri } from 'vs/base/common/uri';\nimport { isAbsolute } from 'vs/base/common/path';\nimport { deepClone } from 'vs/base/common/objects';\nimport { Schemas } from 'vs/base/common/network';\nimport { IEditorService } from 'vs/workbench/services/editor/common/editorService';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\n\nconst _formatPIIRegexp = /{([^}]+)}/g;\n\nexport function formatPII(value: string, excludePII: boolean, args: { [key: string]: string } | undefined): string {\n\treturn value.replace(_formatPIIRegexp, function (match, group) {\n\t\tif (excludePII && group.length > 0 && group[0] !== '_') {\n\t\t\treturn match;\n\t\t}\n\n\t\treturn args && args.hasOwnProperty(group) ?\n\t\t\targs[group] :\n\t\t\tmatch;\n\t});\n}\n\n/**\n * Filters exceptions (keys marked with \"!\") from the given object. Used to\n * ensure exception data is not sent on web remotes, see #97628.\n */\nexport function filterExceptionsFromTelemetry<T extends { [key: string]: unknown }>(data: T): Partial<T> {\n\tconst output: Partial<T> = {};\n\tfor (const key of Object.keys(data) as (keyof T & string)[]) {\n\t\tif (!key.startsWith('!')) {\n\t\t\toutput[key] = data[key];\n\t\t}\n\t}\n\n\treturn output;\n}\n\n\nexport function isSessionAttach(session: IDebugSession): boolean {\n\treturn session.configuration.request === 'attach' && !getExtensionHostDebugSession(session) && (!session.parentSession || isSessionAttach(session.parentSession));\n}\n\n/**\n * Returns the session or any parent which is an extension host debug session.\n * Returns undefined if there's none.\n */\nexport function getExtensionHostDebugSession(session: IDebugSession): IDebugSession | void {\n\tlet type = session.configuration.type;\n\tif (!type) {\n\t\treturn;\n\t}\n\n\tif (type === 'vslsShare') {\n\t\ttype = (<any>session.configuration).adapterProxy.configuration.type;\n\t}\n\n\tif (equalsIgnoreCase(type, 'extensionhost') || equalsIgnoreCase(type, 'pwa-extensionhost')) {\n\t\treturn session;\n\t}\n\n\treturn session.parentSession ? getExtensionHostDebugSession(session.parentSession) : undefined;\n}\n\n// only a debugger contributions with a label, program, or runtime attribute is considered a \"defining\" or \"main\" debugger contribution\nexport function isDebuggerMainContribution(dbg: IDebuggerContribution) {\n\treturn dbg.type && (dbg.label || dbg.program || dbg.runtime);\n}\n\nexport function getExactExpressionStartAndEnd(lineContent: string, looseStart: number, looseEnd: number): { start: number; end: number } {\n\tlet matchingExpression: string | undefined = undefined;\n\tlet startOffset = 0;\n\n\t// Some example supported expressions: myVar.prop, a.b.c.d, myVar?.prop, myVar->prop, MyClass::StaticProp, *myVar\n\t// Match any character except a set of characters which often break interesting sub-expressions\n\tconst expression: RegExp = /([^()\\[\\]{}<>\\s+\\-/%~#^;=|,`!]|\\->)+/g;\n\tlet result: RegExpExecArray | null = null;\n\n\t// First find the full expression under the cursor\n\twhile (result = expression.exec(lineContent)) {\n\t\tconst start = result.index + 1;\n\t\tconst end = start + result[0].length;\n\n\t\tif (start <= looseStart && end >= looseEnd) {\n\t\t\tmatchingExpression = result[0];\n\t\t\tstartOffset = start;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t// If there are non-word characters after the cursor, we want to truncate the expression then.\n\t// For example in expression 'a.b.c.d', if the focus was under 'b', 'a.b' would be evaluated.\n\tif (matchingExpression) {\n\t\tconst subExpression: RegExp = /\\w+/g;\n\t\tlet subExpressionResult: RegExpExecArray | null = null;\n\t\twhile (subExpressionResult = subExpression.exec(matchingExpression)) {\n\t\t\tconst subEnd = subExpressionResult.index + 1 + startOffset + subExpressionResult[0].length;\n\t\t\tif (subEnd >= looseEnd) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (subExpressionResult) {\n\t\t\tmatchingExpression = matchingExpression.substring(0, subExpression.lastIndex);\n\t\t}\n\t}\n\n\treturn matchingExpression ?\n\t\t{ start: startOffset, end: startOffset + matchingExpression.length - 1 } :\n\t\t{ start: 0, end: 0 };\n}\n\n// RFC 2396, Appendix A: https://www.ietf.org/rfc/rfc2396.txt\nconst _schemePattern = /^[a-zA-Z][a-zA-Z0-9\\+\\-\\.]+:/;\n\nexport function isUri(s: string | undefined): boolean {\n\t// heuristics: a valid uri starts with a scheme and\n\t// the scheme has at least 2 characters so that it doesn't look like a drive letter.\n\treturn !!(s && s.match(_schemePattern));\n}\n\nfunction stringToUri(source: PathContainer): string | undefined {\n\tif (typeof source.path === 'string') {\n\t\tif (typeof source.sourceReference === 'number' && source.sourceReference > 0) {\n\t\t\t// if there is a source reference, don't touch path\n\t\t} else {\n\t\t\tif (isUri(source.path)) {\n\t\t\t\treturn <string><unknown>uri.parse(source.path);\n\t\t\t} else {\n\t\t\t\t// assume path\n\t\t\t\tif (isAbsolute(source.path)) {\n\t\t\t\t\treturn <string><unknown>uri.file(source.path);\n\t\t\t\t} else {\n\t\t\t\t\t// leave relative path as is\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn source.path;\n}\n\nfunction uriToString(source: PathContainer): string | undefined {\n\tif (typeof source.path === 'object') {\n\t\tconst u = uri.revive(source.path);\n\t\tif (u) {\n\t\t\tif (u.scheme === Schemas.file) {\n\t\t\t\treturn u.fsPath;\n\t\t\t} else {\n\t\t\t\treturn u.toString();\n\t\t\t}\n\t\t}\n\t}\n\treturn source.path;\n}\n\n// path hooks helpers\n\ninterface PathContainer {\n\tpath?: string;\n\tsourceReference?: number;\n}\n\nexport function convertToDAPaths(message: DebugProtocol.ProtocolMessage, toUri: boolean): DebugProtocol.ProtocolMessage {\n\n\tconst fixPath = toUri ? stringToUri : uriToString;\n\n\t// since we modify Source.paths in the message in place, we need to make a copy of it (see #61129)\n\tconst msg = deepClone(message);\n\n\tconvertPaths(msg, (toDA: boolean, source: PathContainer | undefined) => {\n\t\tif (toDA && source) {\n\t\t\tsource.path = fixPath(source);\n\t\t}\n\t});\n\treturn msg;\n}\n\nexport function convertToVSCPaths(message: DebugProtocol.ProtocolMessage, toUri: boolean): DebugProtocol.ProtocolMessage {\n\n\tconst fixPath = toUri ? stringToUri : uriToString;\n\n\t// since we modify Source.paths in the message in place, we need to make a copy of it (see #61129)\n\tconst msg = deepClone(message);\n\n\tconvertPaths(msg, (toDA: boolean, source: PathContainer | undefined) => {\n\t\tif (!toDA && source) {\n\t\t\tsource.path = fixPath(source);\n\t\t}\n\t});\n\treturn msg;\n}\n\nfunction convertPaths(msg: DebugProtocol.ProtocolMessage, fixSourcePath: (toDA: boolean, source: PathContainer | undefined) => void): void {\n\n\tswitch (msg.type) {\n\t\tcase 'event': {\n\t\t\tconst event = <DebugProtocol.Event>msg;\n\t\t\tswitch (event.event) {\n\t\t\t\tcase 'output':\n\t\t\t\t\tfixSourcePath(false, (<DebugProtocol.OutputEvent>event).body.source);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'loadedSource':\n\t\t\t\t\tfixSourcePath(false, (<DebugProtocol.LoadedSourceEvent>event).body.source);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'breakpoint':\n\t\t\t\t\tfixSourcePath(false, (<DebugProtocol.BreakpointEvent>event).body.breakpoint.source);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\tcase 'request': {\n\t\t\tconst request = <DebugProtocol.Request>msg;\n\t\t\tswitch (request.command) {\n\t\t\t\tcase 'setBreakpoints':\n\t\t\t\t\tfixSourcePath(true, (<DebugProtocol.SetBreakpointsArguments>request.arguments).source);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'breakpointLocations':\n\t\t\t\t\tfixSourcePath(true, (<DebugProtocol.BreakpointLocationsArguments>request.arguments).source);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'source':\n\t\t\t\t\tfixSourcePath(true, (<DebugProtocol.SourceArguments>request.arguments).source);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'gotoTargets':\n\t\t\t\t\tfixSourcePath(true, (<DebugProtocol.GotoTargetsArguments>request.arguments).source);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'launchVSCode':\n\t\t\t\t\trequest.arguments.args.forEach((arg: PathContainer | undefined) => fixSourcePath(false, arg));\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\tcase 'response': {\n\t\t\tconst response = <DebugProtocol.Response>msg;\n\t\t\tif (response.success && response.body) {\n\t\t\t\tswitch (response.command) {\n\t\t\t\t\tcase 'stackTrace':\n\t\t\t\t\t\t(<DebugProtocol.StackTraceResponse>response).body.stackFrames.forEach(frame => fixSourcePath(false, frame.source));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'loadedSources':\n\t\t\t\t\t\t(<DebugProtocol.LoadedSourcesResponse>response).body.sources.forEach(source => fixSourcePath(false, source));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'scopes':\n\t\t\t\t\t\t(<DebugProtocol.ScopesResponse>response).body.scopes.forEach(scope => fixSourcePath(false, scope.source));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'setFunctionBreakpoints':\n\t\t\t\t\t\t(<DebugProtocol.SetFunctionBreakpointsResponse>response).body.breakpoints.forEach(bp => fixSourcePath(false, bp.source));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'setBreakpoints':\n\t\t\t\t\t\t(<DebugProtocol.SetBreakpointsResponse>response).body.breakpoints.forEach(bp => fixSourcePath(false, bp.source));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'disassemble':\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst di = <DebugProtocol.DisassembleResponse>response;\n\t\t\t\t\t\t\tdi.body?.instructions.forEach(di => fixSourcePath(false, di.location));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n}\n\nexport function getVisibleAndSorted<T extends { presentation?: IConfigPresentation }>(array: T[]): T[] {\n\treturn array.filter(config => !config.presentation?.hidden).sort((first, second) => {\n\t\tif (!first.presentation) {\n\t\t\tif (!second.presentation) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\treturn 1;\n\t\t}\n\t\tif (!second.presentation) {\n\t\t\treturn -1;\n\t\t}\n\t\tif (!first.presentation.group) {\n\t\t\tif (!second.presentation.group) {\n\t\t\t\treturn compareOrders(first.presentation.order, second.presentation.order);\n\t\t\t}\n\t\t\treturn 1;\n\t\t}\n\t\tif (!second.presentation.group) {\n\t\t\treturn -1;\n\t\t}\n\t\tif (first.presentation.group !== second.presentation.group) {\n\t\t\treturn first.presentation.group.localeCompare(second.presentation.group);\n\t\t}\n\n\t\treturn compareOrders(first.presentation.order, second.presentation.order);\n\t});\n}\n\nfunction compareOrders(first: number | undefined, second: number | undefined): number {\n\tif (typeof first !== 'number') {\n\t\tif (typeof second !== 'number') {\n\t\t\treturn 0;\n\t\t}\n\n\t\treturn 1;\n\t}\n\tif (typeof second !== 'number') {\n\t\treturn -1;\n\t}\n\n\treturn first - second;\n}\n\nexport async function saveAllBeforeDebugStart(configurationService: IConfigurationService, editorService: IEditorService): Promise<void> {\n\tconst saveBeforeStartConfig: string = configurationService.getValue('debug.saveBeforeStart', { overrideIdentifier: editorService.activeTextEditorLanguageId });\n\tif (saveBeforeStartConfig !== 'none') {\n\t\tawait editorService.saveAll();\n\t\tif (saveBeforeStartConfig === 'allEditorsInActiveGroup') {\n\t\t\tconst activeEditor = editorService.activeEditorPane;\n\t\t\tif (activeEditor && activeEditor.input.resource?.scheme === Schemas.untitled) {\n\t\t\t\t// Make sure to save the active editor in case it is in untitled file it wont be saved as part of saveAll #111850\n\t\t\t\tawait editorService.save({ editor: activeEditor.input, groupId: activeEditor.group.id });\n\t\t\t}\n\t\t}\n\t}\n\tawait configurationService.reloadConfiguration();\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { decodeBase64, encodeBase64, VSBuffer } from 'vs/base/common/buffer';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { IDiffResult } from 'vs/base/common/diff/diff';\nimport { Event } from 'vs/base/common/event';\nimport * as glob from 'vs/base/common/glob';\nimport { Iterable } from 'vs/base/common/iterator';\nimport { Mimes } from 'vs/base/common/mime';\nimport { Schemas } from 'vs/base/common/network';\nimport { basename } from 'vs/base/common/path';\nimport { isWindows } from 'vs/base/common/platform';\nimport { ISplice } from 'vs/base/common/sequence';\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { ILineChange } from 'vs/editor/common/diff/diffComputer';\nimport * as editorCommon from 'vs/editor/common/editorCommon';\nimport { Command, WorkspaceEditMetadata } from 'vs/editor/common/languages';\nimport { IReadonlyTextBuffer } from 'vs/editor/common/model';\nimport { IAccessibilityInformation } from 'vs/platform/accessibility/common/accessibility';\nimport { RawContextKey } from 'vs/platform/contextkey/common/contextkey';\nimport { IEditorModel } from 'vs/platform/editor/common/editor';\nimport { ExtensionIdentifier } from 'vs/platform/extensions/common/extensions';\nimport { ThemeColor } from 'vs/platform/theme/common/themeService';\nimport { UndoRedoGroup } from 'vs/platform/undoRedo/common/undoRedo';\nimport { IRevertOptions, ISaveOptions, IUntypedEditorInput } from 'vs/workbench/common/editor';\nimport { NotebookTextModel } from 'vs/workbench/contrib/notebook/common/model/notebookTextModel';\nimport { ICellRange } from 'vs/workbench/contrib/notebook/common/notebookRange';\nimport { IWorkingCopyBackupMeta, IWorkingCopySaveEvent } from 'vs/workbench/services/workingCopy/common/workingCopy';\n\nexport const NOTEBOOK_EDITOR_ID = 'workbench.editor.notebook';\nexport const NOTEBOOK_DIFF_EDITOR_ID = 'workbench.editor.notebookTextDiffEditor';\n\n\nexport enum CellKind {\n\tMarkup = 1,\n\tCode = 2\n}\n\nexport const NOTEBOOK_DISPLAY_ORDER: readonly string[] = [\n\t'application/json',\n\t'application/javascript',\n\t'text/html',\n\t'image/svg+xml',\n\tMimes.latex,\n\tMimes.markdown,\n\t'image/png',\n\t'image/jpeg',\n\tMimes.text\n];\n\nexport const ACCESSIBLE_NOTEBOOK_DISPLAY_ORDER: readonly string[] = [\n\tMimes.latex,\n\tMimes.markdown,\n\t'application/json',\n\tMimes.text,\n\t'text/html',\n\t'image/svg+xml',\n\t'image/png',\n\t'image/jpeg',\n];\n\n/**\n * A mapping of extension IDs who contain renderers, to notebook ids who they\n * should be treated as the same in the renderer selection logic. This is used\n * to prefer the 1st party Jupyter renderers even though they're in a separate\n * extension, for instance. See #136247.\n */\nexport const RENDERER_EQUIVALENT_EXTENSIONS: ReadonlyMap<string, ReadonlySet<string>> = new Map([\n\t['ms-toolsai.jupyter', new Set(['jupyter-notebook', 'interactive'])],\n\t['ms-toolsai.jupyter-renderers', new Set(['jupyter-notebook', 'interactive'])],\n]);\n\nexport const RENDERER_NOT_AVAILABLE = '_notAvailable';\n\nexport type NotebookRendererEntrypoint = string | { readonly extends: string; readonly path: string };\n\nexport enum NotebookRunState {\n\tRunning = 1,\n\tIdle = 2\n}\n\nexport type NotebookDocumentMetadata = Record<string, unknown>;\n\nexport enum NotebookCellExecutionState {\n\tUnconfirmed = 1,\n\tPending = 2,\n\tExecuting = 3\n}\n\nexport interface INotebookCellPreviousExecutionResult {\n\texecutionOrder?: number;\n\tsuccess?: boolean;\n\tduration?: number;\n}\n\nexport interface NotebookCellMetadata {\n\t/**\n\t * custom metadata\n\t */\n\t[key: string]: unknown;\n}\n\nexport interface NotebookCellInternalMetadata {\n\texecutionOrder?: number;\n\tlastRunSuccess?: boolean;\n\trunStartTime?: number;\n\trunStartTimeAdjustment?: number;\n\trunEndTime?: number;\n}\n\nexport interface NotebookCellCollapseState {\n\tinputCollapsed?: boolean;\n\toutputCollapsed?: boolean;\n}\n\nexport interface NotebookCellDefaultCollapseConfig {\n\tcodeCell?: NotebookCellCollapseState;\n\tmarkupCell?: NotebookCellCollapseState;\n}\n\nexport type InteractiveWindowCollapseCodeCells = 'always' | 'never' | 'fromEditor';\n\nexport type TransientCellMetadata = { [K in keyof NotebookCellMetadata]?: boolean };\nexport type TransientDocumentMetadata = { [K in keyof NotebookDocumentMetadata]?: boolean };\n\nexport interface TransientOptions {\n\ttransientOutputs: boolean;\n\ttransientCellMetadata: TransientCellMetadata;\n\ttransientDocumentMetadata: TransientDocumentMetadata;\n}\n\n/** Note: enum values are used for sorting */\nexport const enum NotebookRendererMatch {\n\t/** Renderer has a hard dependency on an available kernel */\n\tWithHardKernelDependency = 0,\n\t/** Renderer works better with an available kernel */\n\tWithOptionalKernelDependency = 1,\n\t/** Renderer is kernel-agnostic */\n\tPure = 2,\n\t/** Renderer is for a different mimeType or has a hard dependency which is unsatisfied */\n\tNever = 3,\n}\n\n/**\n * Renderer messaging requirement. While this allows for 'optional' messaging,\n * VS Code effectively treats it the same as true right now. \"Partial\n * activation\" of extensions is a very tricky problem, which could allow\n * solving this. But for now, optional is mostly only honored for aznb.\n */\nexport const enum RendererMessagingSpec {\n\tAlways = 'always',\n\tNever = 'never',\n\tOptional = 'optional',\n}\n\nexport interface INotebookRendererInfo {\n\tid: string;\n\tdisplayName: string;\n\textends?: string;\n\tentrypoint: URI;\n\tpreloads: ReadonlyArray<URI>;\n\textensionLocation: URI;\n\textensionId: ExtensionIdentifier;\n\tmessaging: RendererMessagingSpec;\n\n\treadonly mimeTypes: readonly string[];\n\n\treadonly dependencies: readonly string[];\n\n\treadonly isBuiltin: boolean;\n\n\tmatchesWithoutKernel(mimeType: string): NotebookRendererMatch;\n\tmatches(mimeType: string, kernelProvides: ReadonlyArray<string>): NotebookRendererMatch;\n}\n\n\nexport interface IOrderedMimeType {\n\tmimeType: string;\n\trendererId: string;\n\tisTrusted: boolean;\n}\n\nexport interface IOutputItemDto {\n\treadonly mime: string;\n\treadonly data: VSBuffer;\n}\n\nexport interface IOutputDto {\n\toutputs: IOutputItemDto[];\n\toutputId: string;\n\tmetadata?: Record<string, any>;\n}\n\nexport interface ICellOutput {\n\toutputs: IOutputItemDto[];\n\tmetadata?: Record<string, any>;\n\toutputId: string;\n\tonDidChangeData: Event<void>;\n\treplaceData(items: IOutputItemDto[]): void;\n\tappendData(items: IOutputItemDto[]): void;\n}\n\nexport interface CellInternalMetadataChangedEvent {\n\treadonly lastRunSuccessChanged?: boolean;\n}\n\nexport interface ICell {\n\treadonly uri: URI;\n\thandle: number;\n\tlanguage: string;\n\tcellKind: CellKind;\n\toutputs: ICellOutput[];\n\tmetadata: NotebookCellMetadata;\n\tinternalMetadata: NotebookCellInternalMetadata;\n\tgetHashValue(): number;\n\ttextBuffer: IReadonlyTextBuffer;\n\tonDidChangeOutputs?: Event<NotebookCellOutputsSplice>;\n\tonDidChangeOutputItems?: Event<void>;\n\tonDidChangeLanguage: Event<string>;\n\tonDidChangeMetadata: Event<void>;\n\tonDidChangeInternalMetadata: Event<CellInternalMetadataChangedEvent>;\n}\n\nexport interface INotebookTextModel {\n\treadonly viewType: string;\n\tmetadata: NotebookDocumentMetadata;\n\treadonly transientOptions: TransientOptions;\n\treadonly uri: URI;\n\treadonly versionId: number;\n\treadonly length: number;\n\treadonly cells: readonly ICell[];\n\treset(cells: ICellDto2[], metadata: NotebookDocumentMetadata, transientOptions: TransientOptions): void;\n\tapplyEdits(rawEdits: ICellEditOperation[], synchronous: boolean, beginSelectionState: ISelectionState | undefined, endSelectionsComputer: () => ISelectionState | undefined, undoRedoGroup: UndoRedoGroup | undefined, computeUndoRedo?: boolean): boolean;\n\tonDidChangeContent: Event<NotebookTextModelChangedEvent>;\n\tonWillDispose: Event<void>;\n}\n\nexport type NotebookCellTextModelSplice<T> = [\n\tstart: number,\n\tdeleteCount: number,\n\tnewItems: T[]\n];\n\nexport type NotebookCellOutputsSplice = {\n\tstart: number /* start */;\n\tdeleteCount: number /* delete count */;\n\tnewOutputs: ICellOutput[];\n};\n\nexport interface IMainCellDto {\n\thandle: number;\n\turi: UriComponents;\n\tsource: string[];\n\teol: string;\n\tlanguage: string;\n\tcellKind: CellKind;\n\toutputs: IOutputDto[];\n\tmetadata?: NotebookCellMetadata;\n\tinternalMetadata?: NotebookCellInternalMetadata;\n}\n\nexport enum NotebookCellsChangeType {\n\tModelChange = 1,\n\tMove = 2,\n\tChangeCellLanguage = 5,\n\tInitialize = 6,\n\tChangeCellMetadata = 7,\n\tOutput = 8,\n\tOutputItem = 9,\n\tChangeCellContent = 10,\n\tChangeDocumentMetadata = 11,\n\tChangeCellInternalMetadata = 12,\n\tChangeCellMime = 13,\n\tUnknown = 100\n}\n\nexport interface NotebookCellsInitializeEvent<T> {\n\treadonly kind: NotebookCellsChangeType.Initialize;\n\treadonly changes: NotebookCellTextModelSplice<T>[];\n}\n\nexport interface NotebookCellContentChangeEvent {\n\treadonly kind: NotebookCellsChangeType.ChangeCellContent;\n\treadonly index: number;\n}\n\nexport interface NotebookCellsModelChangedEvent<T> {\n\treadonly kind: NotebookCellsChangeType.ModelChange;\n\treadonly changes: NotebookCellTextModelSplice<T>[];\n}\n\nexport interface NotebookCellsModelMoveEvent<T> {\n\treadonly kind: NotebookCellsChangeType.Move;\n\treadonly index: number;\n\treadonly length: number;\n\treadonly newIdx: number;\n\treadonly cells: T[];\n}\n\nexport interface NotebookOutputChangedEvent {\n\treadonly kind: NotebookCellsChangeType.Output;\n\treadonly index: number;\n\treadonly outputs: IOutputDto[];\n\treadonly append: boolean;\n}\n\nexport interface NotebookOutputItemChangedEvent {\n\treadonly kind: NotebookCellsChangeType.OutputItem;\n\treadonly index: number;\n\treadonly outputId: string;\n\treadonly outputItems: IOutputItemDto[];\n\treadonly append: boolean;\n}\n\nexport interface NotebookCellsChangeLanguageEvent {\n\treadonly kind: NotebookCellsChangeType.ChangeCellLanguage;\n\treadonly index: number;\n\treadonly language: string;\n}\n\nexport interface NotebookCellsChangeMimeEvent {\n\treadonly kind: NotebookCellsChangeType.ChangeCellMime;\n\treadonly index: number;\n\treadonly mime: string | undefined;\n}\n\nexport interface NotebookCellsChangeMetadataEvent {\n\treadonly kind: NotebookCellsChangeType.ChangeCellMetadata;\n\treadonly index: number;\n\treadonly metadata: NotebookCellMetadata;\n}\n\nexport interface NotebookCellsChangeInternalMetadataEvent {\n\treadonly kind: NotebookCellsChangeType.ChangeCellInternalMetadata;\n\treadonly index: number;\n\treadonly internalMetadata: NotebookCellInternalMetadata;\n}\n\nexport interface NotebookDocumentChangeMetadataEvent {\n\treadonly kind: NotebookCellsChangeType.ChangeDocumentMetadata;\n\treadonly metadata: NotebookDocumentMetadata;\n}\n\nexport interface NotebookDocumentUnknownChangeEvent {\n\treadonly kind: NotebookCellsChangeType.Unknown;\n}\n\nexport type NotebookRawContentEventDto = NotebookCellsInitializeEvent<IMainCellDto> | NotebookDocumentChangeMetadataEvent | NotebookCellContentChangeEvent | NotebookCellsModelChangedEvent<IMainCellDto> | NotebookCellsModelMoveEvent<IMainCellDto> | NotebookOutputChangedEvent | NotebookOutputItemChangedEvent | NotebookCellsChangeLanguageEvent | NotebookCellsChangeMimeEvent | NotebookCellsChangeMetadataEvent | NotebookCellsChangeInternalMetadataEvent | NotebookDocumentUnknownChangeEvent;\n\nexport type NotebookCellsChangedEventDto = {\n\treadonly rawEvents: NotebookRawContentEventDto[];\n\treadonly versionId: number;\n};\n\nexport type NotebookRawContentEvent = (NotebookCellsInitializeEvent<ICell> | NotebookDocumentChangeMetadataEvent | NotebookCellContentChangeEvent | NotebookCellsModelChangedEvent<ICell> | NotebookCellsModelMoveEvent<ICell> | NotebookOutputChangedEvent | NotebookOutputItemChangedEvent | NotebookCellsChangeLanguageEvent | NotebookCellsChangeMimeEvent | NotebookCellsChangeMetadataEvent | NotebookCellsChangeInternalMetadataEvent | NotebookDocumentUnknownChangeEvent) & { transient: boolean };\n\nexport enum SelectionStateType {\n\tHandle = 0,\n\tIndex = 1\n}\n\nexport interface ISelectionHandleState {\n\tkind: SelectionStateType.Handle;\n\tprimary: number | null;\n\tselections: number[];\n}\n\nexport interface ISelectionIndexState {\n\tkind: SelectionStateType.Index;\n\tfocus: ICellRange;\n\tselections: ICellRange[];\n}\n\nexport type ISelectionState = ISelectionHandleState | ISelectionIndexState;\n\nexport type NotebookTextModelChangedEvent = {\n\treadonly rawEvents: NotebookRawContentEvent[];\n\treadonly versionId: number;\n\treadonly synchronous: boolean | undefined;\n\treadonly endSelectionState: ISelectionState | undefined;\n};\n\nexport type NotebookTextModelWillAddRemoveEvent = {\n\treadonly rawEvent: NotebookCellsModelChangedEvent<ICell>;\n};\n\nexport const enum CellEditType {\n\tReplace = 1,\n\tOutput = 2,\n\tMetadata = 3,\n\tCellLanguage = 4,\n\tDocumentMetadata = 5,\n\tMove = 6,\n\tOutputItems = 7,\n\tPartialMetadata = 8,\n\tPartialInternalMetadata = 9,\n}\n\nexport interface ICellDto2 {\n\tsource: string;\n\tlanguage: string;\n\tmime: string | undefined;\n\tcellKind: CellKind;\n\toutputs: IOutputDto[];\n\tmetadata?: NotebookCellMetadata;\n\tinternalMetadata?: NotebookCellInternalMetadata;\n\tcollapseState?: NotebookCellCollapseState;\n}\n\nexport interface ICellReplaceEdit {\n\teditType: CellEditType.Replace;\n\tindex: number;\n\tcount: number;\n\tcells: ICellDto2[];\n}\n\nexport interface ICellOutputEdit {\n\teditType: CellEditType.Output;\n\tindex: number;\n\toutputs: IOutputDto[];\n\tappend?: boolean;\n}\n\nexport interface ICellOutputEditByHandle {\n\teditType: CellEditType.Output;\n\thandle: number;\n\toutputs: IOutputDto[];\n\tappend?: boolean;\n}\n\nexport interface ICellOutputItemEdit {\n\teditType: CellEditType.OutputItems;\n\toutputId: string;\n\titems: IOutputItemDto[];\n\tappend?: boolean;\n}\n\nexport interface ICellMetadataEdit {\n\teditType: CellEditType.Metadata;\n\tindex: number;\n\tmetadata: NotebookCellMetadata;\n}\n\n// These types are nullable because we need to use 'null' on the EH side so it is JSON-stringified\nexport type NullablePartialNotebookCellMetadata = {\n\t[Key in keyof Partial<NotebookCellMetadata>]: NotebookCellMetadata[Key] | null\n};\n\nexport interface ICellPartialMetadataEdit {\n\teditType: CellEditType.PartialMetadata;\n\tindex: number;\n\tmetadata: NullablePartialNotebookCellMetadata;\n}\n\nexport interface ICellPartialMetadataEditByHandle {\n\teditType: CellEditType.PartialMetadata;\n\thandle: number;\n\tmetadata: NullablePartialNotebookCellMetadata;\n}\n\nexport type NullablePartialNotebookCellInternalMetadata = {\n\t[Key in keyof Partial<NotebookCellInternalMetadata>]: NotebookCellInternalMetadata[Key] | null\n};\nexport interface ICellPartialInternalMetadataEdit {\n\teditType: CellEditType.PartialInternalMetadata;\n\tindex: number;\n\tinternalMetadata: NullablePartialNotebookCellInternalMetadata;\n}\n\nexport interface ICellPartialInternalMetadataEditByHandle {\n\teditType: CellEditType.PartialInternalMetadata;\n\thandle: number;\n\tinternalMetadata: NullablePartialNotebookCellInternalMetadata;\n}\n\nexport interface ICellLanguageEdit {\n\teditType: CellEditType.CellLanguage;\n\tindex: number;\n\tlanguage: string;\n}\n\nexport interface IDocumentMetadataEdit {\n\teditType: CellEditType.DocumentMetadata;\n\tmetadata: NotebookDocumentMetadata;\n}\n\nexport interface ICellMoveEdit {\n\teditType: CellEditType.Move;\n\tindex: number;\n\tlength: number;\n\tnewIdx: number;\n}\n\nexport type IImmediateCellEditOperation = ICellOutputEditByHandle | ICellPartialMetadataEditByHandle | ICellOutputItemEdit | ICellPartialInternalMetadataEdit | ICellPartialInternalMetadataEditByHandle | ICellPartialMetadataEdit;\nexport type ICellEditOperation = IImmediateCellEditOperation | ICellReplaceEdit | ICellOutputEdit | ICellMetadataEdit | ICellPartialMetadataEdit | ICellPartialInternalMetadataEdit | IDocumentMetadataEdit | ICellMoveEdit | ICellOutputItemEdit | ICellLanguageEdit;\n\n\nexport interface IWorkspaceNotebookCellEdit {\n\tmetadata?: WorkspaceEditMetadata;\n\tresource: URI;\n\tnotebookVersionId: number | undefined;\n\tcellEdit: ICellPartialMetadataEdit | IDocumentMetadataEdit | ICellReplaceEdit;\n}\n\nexport interface NotebookData {\n\treadonly cells: ICellDto2[];\n\treadonly metadata: NotebookDocumentMetadata;\n}\n\n\nexport interface INotebookContributionData {\n\textension?: ExtensionIdentifier;\n\tproviderDisplayName: string;\n\tdisplayName: string;\n\tfilenamePattern: (string | glob.IRelativePattern | INotebookExclusiveDocumentFilter)[];\n\texclusive: boolean;\n}\n\n\nexport namespace CellUri {\n\n\texport const scheme = Schemas.vscodeNotebookCell;\n\n\n\tconst _lengths = ['W', 'X', 'Y', 'Z', 'a', 'b', 'c', 'd', 'e', 'f'];\n\tconst _padRegexp = new RegExp(`^[${_lengths.join('')}]+`);\n\tconst _radix = 7;\n\n\texport function generate(notebook: URI, handle: number): URI {\n\n\t\tconst s = handle.toString(_radix);\n\t\tconst p = s.length < _lengths.length ? _lengths[s.length - 1] : 'z';\n\n\t\tconst fragment = `${p}${s}s${encodeBase64(VSBuffer.fromString(notebook.scheme), true, true)}`;\n\t\treturn notebook.with({ scheme, fragment });\n\t}\n\n\texport function parse(cell: URI): { notebook: URI; handle: number } | undefined {\n\t\tif (cell.scheme !== scheme) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst idx = cell.fragment.indexOf('s');\n\t\tif (idx < 0) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst handle = parseInt(cell.fragment.substring(0, idx).replace(_padRegexp, ''), _radix);\n\t\tconst _scheme = decodeBase64(cell.fragment.substring(idx + 1)).toString();\n\n\t\tif (isNaN(handle)) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn {\n\t\t\thandle,\n\t\t\tnotebook: cell.with({ scheme: _scheme, fragment: null })\n\t\t};\n\t}\n\n\n\tconst _regex = /^(\\d{8,})(\\w[\\w\\d+.-]*)$/;\n\n\texport function generateCellOutputUri(notebook: URI, outputId?: string) {\n\t\treturn notebook.with({\n\t\t\tscheme: Schemas.vscodeNotebookCellOutput,\n\t\t\tfragment: `op${outputId ?? ''},${notebook.scheme !== Schemas.file ? notebook.scheme : ''}`\n\t\t});\n\t}\n\n\texport function parseCellOutputUri(uri: URI): { notebook: URI; outputId?: string } | undefined {\n\t\tif (uri.scheme !== Schemas.vscodeNotebookCellOutput) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst match = /^op([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})?\\,(.*)$/i.exec(uri.fragment);\n\t\tif (!match) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst outputId = (match[1] && match[1] !== '') ? match[1] : undefined;\n\t\tconst scheme = match[2];\n\t\treturn {\n\t\t\toutputId,\n\t\t\tnotebook: uri.with({\n\t\t\t\tscheme: scheme || Schemas.file,\n\t\t\t\tfragment: null\n\t\t\t})\n\t\t};\n\t}\n\n\texport function generateCellUri(notebook: URI, handle: number, scheme: string): URI {\n\t\treturn notebook.with({\n\t\t\tscheme: scheme,\n\t\t\tfragment: `ch${handle.toString().padStart(7, '0')}${notebook.scheme !== Schemas.file ? notebook.scheme : ''}`\n\t\t});\n\t}\n\n\texport function parseCellUri(metadata: URI, scheme: string) {\n\t\tif (metadata.scheme !== scheme) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst match = _regex.exec(metadata.fragment);\n\t\tif (!match) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst handle = Number(match[1]);\n\t\treturn {\n\t\t\thandle,\n\t\t\tnotebook: metadata.with({\n\t\t\t\tscheme: metadata.fragment.substring(match[0].length) || Schemas.file,\n\t\t\t\tfragment: null\n\t\t\t})\n\t\t};\n\t}\n}\n\nconst normalizeSlashes = (str: string) => isWindows ? str.replace(/\\//g, '\\\\') : str;\n\ninterface IMimeTypeWithMatcher {\n\tpattern: string;\n\tmatches: glob.ParsedPattern;\n}\n\nexport class MimeTypeDisplayOrder {\n\tprivate readonly order: IMimeTypeWithMatcher[];\n\n\tconstructor(\n\t\tinitialValue: readonly string[] = [],\n\t\tprivate readonly defaultOrder = NOTEBOOK_DISPLAY_ORDER,\n\t) {\n\t\tthis.order = [...new Set(initialValue)].map(pattern => ({\n\t\t\tpattern,\n\t\t\tmatches: glob.parse(normalizeSlashes(pattern))\n\t\t}));\n\t}\n\n\t/**\n\t * Returns a sorted array of the input mimetypes.\n\t */\n\tpublic sort(mimetypes: Iterable<string>): string[] {\n\t\tconst remaining = new Map(Iterable.map(mimetypes, m => [m, normalizeSlashes(m)]));\n\t\tlet sorted: string[] = [];\n\n\t\tfor (const { matches } of this.order) {\n\t\t\tfor (const [original, normalized] of remaining) {\n\t\t\t\tif (matches(normalized)) {\n\t\t\t\t\tsorted.push(original);\n\t\t\t\t\tremaining.delete(original);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (remaining.size) {\n\t\t\tsorted = sorted.concat([...remaining.keys()].sort(\n\t\t\t\t(a, b) => this.defaultOrder.indexOf(a) - this.defaultOrder.indexOf(b),\n\t\t\t));\n\t\t}\n\n\t\treturn sorted;\n\t}\n\n\t/**\n\t * Records that the user selected the given mimetype over the other\n\t * possible mimetypes, prioritizing it for future reference.\n\t */\n\tpublic prioritize(chosenMimetype: string, otherMimetypes: readonly string[]) {\n\t\tconst chosenIndex = this.findIndex(chosenMimetype);\n\t\tif (chosenIndex === -1) {\n\t\t\t// always first, nothing more to do\n\t\t\tthis.order.unshift({ pattern: chosenMimetype, matches: glob.parse(normalizeSlashes(chosenMimetype)) });\n\t\t\treturn;\n\t\t}\n\n\t\t// Get the other mimetypes that are before the chosenMimetype. Then, move\n\t\t// them after it, retaining order.\n\t\tconst uniqueIndicies = new Set(otherMimetypes.map(m => this.findIndex(m, chosenIndex)));\n\t\tuniqueIndicies.delete(-1);\n\t\tconst otherIndices = Array.from(uniqueIndicies).sort();\n\t\tthis.order.splice(chosenIndex + 1, 0, ...otherIndices.map(i => this.order[i]));\n\n\t\tfor (let oi = otherIndices.length - 1; oi >= 0; oi--) {\n\t\t\tthis.order.splice(otherIndices[oi], 1);\n\t\t}\n\t}\n\n\t/**\n\t * Gets an array of in-order mimetype preferences.\n\t */\n\tpublic toArray() {\n\t\treturn this.order.map(o => o.pattern);\n\t}\n\n\tprivate findIndex(mimeType: string, maxIndex = this.order.length) {\n\t\tconst normalized = normalizeSlashes(mimeType);\n\t\tfor (let i = 0; i < maxIndex; i++) {\n\t\t\tif (this.order[i].matches(normalized)) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\n\t\treturn -1;\n\t}\n}\n\ninterface IMutableSplice<T> extends ISplice<T> {\n\tdeleteCount: number;\n}\n\nexport function diff<T>(before: T[], after: T[], contains: (a: T) => boolean, equal: (a: T, b: T) => boolean = (a: T, b: T) => a === b): ISplice<T>[] {\n\tconst result: IMutableSplice<T>[] = [];\n\n\tfunction pushSplice(start: number, deleteCount: number, toInsert: T[]): void {\n\t\tif (deleteCount === 0 && toInsert.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst latest = result[result.length - 1];\n\n\t\tif (latest && latest.start + latest.deleteCount === start) {\n\t\t\tlatest.deleteCount += deleteCount;\n\t\t\tlatest.toInsert.push(...toInsert);\n\t\t} else {\n\t\t\tresult.push({ start, deleteCount, toInsert });\n\t\t}\n\t}\n\n\tlet beforeIdx = 0;\n\tlet afterIdx = 0;\n\n\twhile (true) {\n\t\tif (beforeIdx === before.length) {\n\t\t\tpushSplice(beforeIdx, 0, after.slice(afterIdx));\n\t\t\tbreak;\n\t\t}\n\n\t\tif (afterIdx === after.length) {\n\t\t\tpushSplice(beforeIdx, before.length - beforeIdx, []);\n\t\t\tbreak;\n\t\t}\n\n\t\tconst beforeElement = before[beforeIdx];\n\t\tconst afterElement = after[afterIdx];\n\n\t\tif (equal(beforeElement, afterElement)) {\n\t\t\t// equal\n\t\t\tbeforeIdx += 1;\n\t\t\tafterIdx += 1;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (contains(afterElement)) {\n\t\t\t// `afterElement` exists before, which means some elements before `afterElement` are deleted\n\t\t\tpushSplice(beforeIdx, 1, []);\n\t\t\tbeforeIdx += 1;\n\t\t} else {\n\t\t\t// `afterElement` added\n\t\t\tpushSplice(beforeIdx, 0, [afterElement]);\n\t\t\tafterIdx += 1;\n\t\t}\n\t}\n\n\treturn result;\n}\n\nexport interface ICellEditorViewState {\n\tselections: editorCommon.ICursorState[];\n}\n\nexport const NOTEBOOK_EDITOR_CURSOR_BOUNDARY = new RawContextKey<'none' | 'top' | 'bottom' | 'both'>('notebookEditorCursorAtBoundary', 'none');\n\n\nexport interface INotebookLoadOptions {\n\t/**\n\t * Go to disk bypassing any cache of the model if any.\n\t */\n\tforceReadFromFile?: boolean;\n}\n\nexport interface IResolvedNotebookEditorModel extends INotebookEditorModel {\n\tnotebook: NotebookTextModel;\n}\n\nexport interface INotebookEditorModel extends IEditorModel {\n\treadonly onDidChangeDirty: Event<void>;\n\treadonly onDidSave: Event<IWorkingCopySaveEvent>;\n\treadonly onDidChangeOrphaned: Event<void>;\n\treadonly onDidChangeReadonly: Event<void>;\n\treadonly resource: URI;\n\treadonly viewType: string;\n\treadonly notebook: INotebookTextModel | undefined;\n\tisResolved(): this is IResolvedNotebookEditorModel;\n\tisDirty(): boolean;\n\tisReadonly(): boolean;\n\tisOrphaned(): boolean;\n\thasAssociatedFilePath(): boolean;\n\tload(options?: INotebookLoadOptions): Promise<IResolvedNotebookEditorModel>;\n\tsave(options?: ISaveOptions): Promise<boolean>;\n\tsaveAs(target: URI): Promise<IUntypedEditorInput | undefined>;\n\trevert(options?: IRevertOptions): Promise<void>;\n}\n\nexport interface INotebookDiffEditorModel extends IEditorModel {\n\toriginal: IResolvedNotebookEditorModel;\n\tmodified: IResolvedNotebookEditorModel;\n}\n\nexport interface NotebookDocumentBackupData extends IWorkingCopyBackupMeta {\n\treadonly viewType: string;\n\treadonly backupId?: string;\n\treadonly mtime?: number;\n}\n\nexport enum NotebookEditorPriority {\n\tdefault = 'default',\n\toption = 'option',\n}\n\nexport interface INotebookSearchOptions {\n\tregex?: boolean;\n\twholeWord?: boolean;\n\tcaseSensitive?: boolean;\n\twordSeparators?: string;\n\tincludeMarkupInput?: boolean;\n\tincludeMarkupPreview?: boolean;\n\tincludeCodeInput?: boolean;\n\tincludeOutput?: boolean;\n}\n\nexport interface INotebookExclusiveDocumentFilter {\n\tinclude?: string | glob.IRelativePattern;\n\texclude?: string | glob.IRelativePattern;\n}\n\nexport interface INotebookDocumentFilter {\n\tviewType?: string | string[];\n\tfilenamePattern?: string | glob.IRelativePattern | INotebookExclusiveDocumentFilter;\n}\n\n//TODO@rebornix test\n\nexport function isDocumentExcludePattern(filenamePattern: string | glob.IRelativePattern | INotebookExclusiveDocumentFilter): filenamePattern is { include: string | glob.IRelativePattern; exclude: string | glob.IRelativePattern } {\n\tconst arg = filenamePattern as INotebookExclusiveDocumentFilter;\n\n\tif ((typeof arg.include === 'string' || glob.isRelativePattern(arg.include))\n\t\t&& (typeof arg.exclude === 'string' || glob.isRelativePattern(arg.exclude))) {\n\t\treturn true;\n\t}\n\n\treturn false;\n}\nexport function notebookDocumentFilterMatch(filter: INotebookDocumentFilter, viewType: string, resource: URI): boolean {\n\tif (Array.isArray(filter.viewType) && filter.viewType.indexOf(viewType) >= 0) {\n\t\treturn true;\n\t}\n\n\tif (filter.viewType === viewType) {\n\t\treturn true;\n\t}\n\n\tif (filter.filenamePattern) {\n\t\tconst filenamePattern = isDocumentExcludePattern(filter.filenamePattern) ? filter.filenamePattern.include : (filter.filenamePattern as string | glob.IRelativePattern);\n\t\tconst excludeFilenamePattern = isDocumentExcludePattern(filter.filenamePattern) ? filter.filenamePattern.exclude : undefined;\n\n\t\tif (glob.match(filenamePattern, basename(resource.fsPath).toLowerCase())) {\n\t\t\tif (excludeFilenamePattern) {\n\t\t\t\tif (glob.match(excludeFilenamePattern, basename(resource.fsPath).toLowerCase())) {\n\t\t\t\t\t// should exclude\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nexport interface INotebookCellStatusBarItemProvider {\n\tviewType: string;\n\tonDidChangeStatusBarItems?: Event<void>;\n\tprovideCellStatusBarItems(uri: URI, index: number, token: CancellationToken): Promise<INotebookCellStatusBarItemList | undefined>;\n}\n\n\nexport interface INotebookDiffResult {\n\tcellsDiff: IDiffResult;\n\tlinesDiff?: { originalCellhandle: number; modifiedCellhandle: number; lineChanges: ILineChange[] }[];\n}\n\nexport interface INotebookCellStatusBarItem {\n\treadonly alignment: CellStatusbarAlignment;\n\treadonly priority?: number;\n\treadonly text: string;\n\treadonly color?: string | ThemeColor;\n\treadonly backgroundColor?: string | ThemeColor;\n\treadonly tooltip?: string;\n\treadonly command?: string | Command;\n\treadonly accessibilityInformation?: IAccessibilityInformation;\n\treadonly opacity?: string;\n\treadonly onlyShowWhenActive?: boolean;\n}\n\nexport interface INotebookCellStatusBarItemList {\n\titems: INotebookCellStatusBarItem[];\n\tdispose?(): void;\n}\n\nexport type ShowCellStatusBarType = 'hidden' | 'visible' | 'visibleAfterExecute';\n\nexport const NotebookSetting = {\n\tdisplayOrder: 'notebook.displayOrder',\n\tcellToolbarLocation: 'notebook.cellToolbarLocation',\n\tcellToolbarVisibility: 'notebook.cellToolbarVisibility',\n\tshowCellStatusBar: 'notebook.showCellStatusBar',\n\ttextDiffEditorPreview: 'notebook.diff.enablePreview',\n\texperimentalInsertToolbarAlignment: 'notebook.experimental.insertToolbarAlignment',\n\tcompactView: 'notebook.compactView',\n\tfocusIndicator: 'notebook.cellFocusIndicator',\n\tinsertToolbarLocation: 'notebook.insertToolbarLocation',\n\tglobalToolbar: 'notebook.globalToolbar',\n\tundoRedoPerCell: 'notebook.undoRedoPerCell',\n\tconsolidatedOutputButton: 'notebook.consolidatedOutputButton',\n\tshowFoldingControls: 'notebook.showFoldingControls',\n\tdragAndDropEnabled: 'notebook.dragAndDropEnabled',\n\tcellEditorOptionsCustomizations: 'notebook.editorOptionsCustomizations',\n\tconsolidatedRunButton: 'notebook.consolidatedRunButton',\n\topenGettingStarted: 'notebook.experimental.openGettingStarted',\n\ttextOutputLineLimit: 'notebook.output.textLineLimit',\n\tglobalToolbarShowLabel: 'notebook.globalToolbarShowLabel',\n\tmarkupFontSize: 'notebook.markup.fontSize',\n\tinteractiveWindowCollapseCodeCells: 'interactiveWindow.collapseCellInputCode',\n\toutputLineHeight: 'notebook.outputLineHeight',\n\toutputFontSize: 'notebook.outputFontSize',\n\toutputFontFamily: 'notebook.outputFontFamily'\n} as const;\n\nexport const enum CellStatusbarAlignment {\n\tLeft = 1,\n\tRight = 2\n}\n\nexport class NotebookWorkingCopyTypeIdentifier {\n\n\tprivate static _prefix = 'notebook/';\n\n\tstatic create(viewType: string): string {\n\t\treturn `${NotebookWorkingCopyTypeIdentifier._prefix}${viewType}`;\n\t}\n\n\tstatic parse(candidate: string): string | undefined {\n\t\tif (candidate.startsWith(NotebookWorkingCopyTypeIdentifier._prefix)) {\n\t\t\treturn candidate.substring(NotebookWorkingCopyTypeIdentifier._prefix.length);\n\t\t}\n\t\treturn undefined;\n\t}\n}\n\nexport interface NotebookExtensionDescription {\n\treadonly id: ExtensionIdentifier;\n\treadonly location: UriComponents | undefined;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { NotebookCellTextModel } from 'vs/workbench/contrib/notebook/common/model/notebookCellTextModel';\nimport { INotebookTextModel, IOutputDto, IOutputItemDto } from 'vs/workbench/contrib/notebook/common/notebookCommon';\n\nexport enum CellExecutionUpdateType {\n\tOutput = 1,\n\tOutputItems = 2,\n\tExecutionState = 3,\n}\n\nexport interface ICellExecuteOutputEdit {\n\teditType: CellExecutionUpdateType.Output;\n\tcellHandle: number;\n\tappend?: boolean;\n\toutputs: IOutputDto[];\n}\n\nexport interface ICellExecuteOutputItemEdit {\n\teditType: CellExecutionUpdateType.OutputItems;\n\tappend?: boolean;\n\toutputId: string;\n\titems: IOutputItemDto[];\n}\n\nexport const INotebookExecutionService = createDecorator<INotebookExecutionService>('INotebookExecutionService');\n\nexport interface INotebookExecutionService {\n\t_serviceBrand: undefined;\n\n\texecuteNotebookCells(notebook: INotebookTextModel, cells: Iterable<NotebookCellTextModel>): Promise<void>;\n\tcancelNotebookCells(notebook: INotebookTextModel, cells: Iterable<NotebookCellTextModel>): Promise<void>;\n\tcancelNotebookCellHandles(notebook: INotebookTextModel, cells: Iterable<number>): Promise<void>;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IEnvironmentVariableCollection, IEnvironmentVariableMutator, ISerializableEnvironmentVariableCollection, ISerializableEnvironmentVariableCollections } from 'vs/workbench/contrib/terminal/common/environmentVariable';\n\n// This file is shared between the renderer and extension host\n\nexport function serializeEnvironmentVariableCollection(collection: ReadonlyMap<string, IEnvironmentVariableMutator>): ISerializableEnvironmentVariableCollection {\n\treturn [...collection.entries()];\n}\n\nexport function deserializeEnvironmentVariableCollection(\n\tserializedCollection: ISerializableEnvironmentVariableCollection\n): Map<string, IEnvironmentVariableMutator> {\n\treturn new Map<string, IEnvironmentVariableMutator>(serializedCollection);\n}\n\nexport function serializeEnvironmentVariableCollections(collections: ReadonlyMap<string, IEnvironmentVariableCollection>): ISerializableEnvironmentVariableCollections {\n\treturn Array.from(collections.entries()).map(e => {\n\t\treturn [e[0], serializeEnvironmentVariableCollection(e[1].map)];\n\t});\n}\n\nexport function deserializeEnvironmentVariableCollections(\n\tserializedCollection: ISerializableEnvironmentVariableCollections\n): Map<string, IEnvironmentVariableCollection> {\n\treturn new Map<string, IEnvironmentVariableCollection>(serializedCollection.map(e => {\n\t\treturn [e[0], { map: deserializeEnvironmentVariableCollection(e[1]) }];\n\t}));\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport const enum TestIdPathParts {\n\t/** Delimiter for path parts in test IDs */\n\tDelimiter = '\\0',\n}\n\n/**\n * Enum for describing relative positions of tests. Similar to\n * `node.compareDocumentPosition` in the DOM.\n */\nexport const enum TestPosition {\n\t/** a === b */\n\tIsSame,\n\t/** Neither a nor b are a child of one another. They may share a common parent, though. */\n\tDisconnected,\n\t/** b is a child of a */\n\tIsChild,\n\t/** b is a parent of a */\n\tIsParent,\n}\n\ntype TestItemLike = { id: string; parent?: TestItemLike };\n\n/**\n * The test ID is a stringifiable client that\n */\nexport class TestId {\n\tprivate stringifed?: string;\n\n\t/**\n\t * Creates a test ID from an ext host test item.\n\t */\n\tpublic static fromExtHostTestItem(item: TestItemLike, rootId: string, parent = item.parent) {\n\t\tif (item.id === rootId) {\n\t\t\treturn new TestId([rootId]);\n\t\t}\n\n\t\tconst path = [item.id];\n\t\tfor (let i = parent; i && i.id !== rootId; i = i.parent) {\n\t\t\tpath.push(i.id);\n\t\t}\n\t\tpath.push(rootId);\n\n\t\treturn new TestId(path.reverse());\n\t}\n\n\t/**\n\t * Cheaply ets whether the ID refers to the root .\n\t */\n\tpublic static isRoot(idString: string) {\n\t\treturn !idString.includes(TestIdPathParts.Delimiter);\n\t}\n\n\t/**\n\t * Cheaply ets whether the ID refers to the root .\n\t */\n\tpublic static root(idString: string) {\n\t\tconst idx = idString.indexOf(TestIdPathParts.Delimiter);\n\t\treturn idx === -1 ? idString : idString.slice(0, idx);\n\t}\n\n\t/**\n\t * Creates a test ID from a serialized TestId instance.\n\t */\n\tpublic static fromString(idString: string) {\n\t\treturn new TestId(idString.split(TestIdPathParts.Delimiter));\n\t}\n\n\t/**\n\t * Gets the ID resulting from adding b to the base ID.\n\t */\n\tpublic static join(base: TestId, b: string) {\n\t\treturn new TestId([...base.path, b]);\n\t}\n\n\t/**\n\t * Gets the string ID resulting from adding b to the base ID.\n\t */\n\tpublic static joinToString(base: string | TestId, b: string) {\n\t\treturn base.toString() + TestIdPathParts.Delimiter + b;\n\t}\n\n\t/**\n\t * Compares the position of the two ID strings.\n\t */\n\tpublic static compare(a: string, b: string) {\n\t\tif (a === b) {\n\t\t\treturn TestPosition.IsSame;\n\t\t}\n\n\t\tif (b.startsWith(a + TestIdPathParts.Delimiter)) {\n\t\t\treturn TestPosition.IsChild;\n\t\t}\n\n\t\tif (a.startsWith(b + TestIdPathParts.Delimiter)) {\n\t\t\treturn TestPosition.IsParent;\n\t\t}\n\n\t\treturn TestPosition.Disconnected;\n\t}\n\n\tconstructor(\n\t\tpublic readonly path: readonly string[],\n\t\tprivate readonly viewEnd = path.length,\n\t) {\n\t\tif (path.length === 0 || viewEnd < 1) {\n\t\t\tthrow new Error('cannot create test with empty path');\n\t\t}\n\t}\n\n\t/**\n\t * Gets the ID of the parent test.\n\t */\n\tpublic get parentId(): TestId {\n\t\treturn this.viewEnd > 1 ? new TestId(this.path, this.viewEnd - 1) : this;\n\t}\n\n\t/**\n\t * Gets the local ID of the current full test ID.\n\t */\n\tpublic get localId() {\n\t\treturn this.path[this.viewEnd - 1];\n\t}\n\n\t/**\n\t * Gets whether this ID refers to the root.\n\t */\n\tpublic get controllerId() {\n\t\treturn this.path[0];\n\t}\n\n\t/**\n\t * Gets whether this ID refers to the root.\n\t */\n\tpublic get isRoot() {\n\t\treturn this.viewEnd === 1;\n\t}\n\n\t/**\n\t * Returns an iterable that yields IDs of all parent items down to and\n\t * including the current item.\n\t */\n\tpublic *idsFromRoot() {\n\t\tfor (let i = 1; i <= this.viewEnd; i++) {\n\t\t\tyield new TestId(this.path, i);\n\t\t}\n\t}\n\n\t/**\n\t * Compares the other test ID with this one.\n\t */\n\tpublic compare(other: TestId | string) {\n\t\tif (typeof other === 'string') {\n\t\t\treturn TestId.compare(this.toString(), other);\n\t\t}\n\n\t\tfor (let i = 0; i < other.viewEnd && i < this.viewEnd; i++) {\n\t\t\tif (other.path[i] !== this.path[i]) {\n\t\t\t\treturn TestPosition.Disconnected;\n\t\t\t}\n\t\t}\n\n\t\tif (other.viewEnd > this.viewEnd) {\n\t\t\treturn TestPosition.IsChild;\n\t\t}\n\n\t\tif (other.viewEnd < this.viewEnd) {\n\t\t\treturn TestPosition.IsParent;\n\t\t}\n\n\t\treturn TestPosition.IsSame;\n\t}\n\n\t/**\n\t * Serializes the ID.\n\t */\n\tpublic toJSON() {\n\t\treturn this.toString();\n\t}\n\n\t/**\n\t * Serializes the ID to a string.\n\t */\n\tpublic toString() {\n\t\tif (!this.stringifed) {\n\t\t\tthis.stringifed = this.path[0];\n\t\t\tfor (let i = 1; i < this.viewEnd; i++) {\n\t\t\t\tthis.stringifed += TestIdPathParts.Delimiter;\n\t\t\t\tthis.stringifed += this.path[i];\n\t\t\t}\n\t\t}\n\n\t\treturn this.stringifed;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IMarkdownString } from 'vs/base/common/htmlContent';\nimport { MarshalledId } from 'vs/base/common/marshallingIds';\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { IPosition } from 'vs/editor/common/core/position';\nimport { IRange, Range } from 'vs/editor/common/core/range';\n\nexport const enum TestResultState {\n\tUnset = 0,\n\tQueued = 1,\n\tRunning = 2,\n\tPassed = 3,\n\tFailed = 4,\n\tSkipped = 5,\n\tErrored = 6\n}\n\nexport const enum TestRunProfileBitset {\n\tRun = 1 << 1,\n\tDebug = 1 << 2,\n\tCoverage = 1 << 3,\n\tHasNonDefaultProfile = 1 << 4,\n\tHasConfigurable = 1 << 5,\n}\n\n/**\n * List of all test run profile bitset values.\n */\nexport const testRunProfileBitsetList = [\n\tTestRunProfileBitset.Run,\n\tTestRunProfileBitset.Debug,\n\tTestRunProfileBitset.Coverage,\n\tTestRunProfileBitset.HasNonDefaultProfile,\n];\n\n/**\n * DTO for a controller's run profiles.\n */\nexport interface ITestRunProfile {\n\tcontrollerId: string;\n\tprofileId: number;\n\tlabel: string;\n\tgroup: TestRunProfileBitset;\n\tisDefault: boolean;\n\ttag: string | null;\n\thasConfigurationHandler: boolean;\n}\n\n/**\n * A fully-resolved request to run tests, passsed between the main thread\n * and extension host.\n */\nexport interface ResolvedTestRunRequest {\n\ttargets: {\n\t\ttestIds: string[];\n\t\tcontrollerId: string;\n\t\tprofileGroup: TestRunProfileBitset;\n\t\tprofileId: number;\n\t}[];\n\texclude?: string[];\n\tisAutoRun?: boolean;\n\t/** Whether this was trigged by a user action in UI. Default=true */\n\tisUiTriggered?: boolean;\n}\n\n/**\n * Request to the main thread to run a set of tests.\n */\nexport interface ExtensionRunTestsRequest {\n\tid: string;\n\tinclude: string[];\n\texclude: string[];\n\tcontrollerId: string;\n\tprofile?: { group: TestRunProfileBitset; id: number };\n\tpersist: boolean;\n}\n\n/**\n * Request from the main thread to run tests for a single controller.\n */\nexport interface RunTestForControllerRequest {\n\trunId: string;\n\tcontrollerId: string;\n\tprofileId: number;\n\texcludeExtIds: string[];\n\ttestIds: string[];\n}\n\n/**\n * Location with a fully-instantiated Range and URI.\n */\nexport interface IRichLocation {\n\trange: Range;\n\turi: URI;\n}\n\nexport namespace IRichLocation {\n\texport interface Serialize {\n\t\trange: IRange;\n\t\turi: UriComponents;\n\t}\n\n\texport const serialize = (location: IRichLocation): Serialize => ({\n\t\trange: location.range.toJSON(),\n\t\turi: location.uri.toJSON(),\n\t});\n\n\texport const deserialize = (location: Serialize): IRichLocation => ({\n\t\trange: Range.lift(location.range),\n\t\turi: URI.revive(location.uri),\n\t});\n}\n\nexport const enum TestMessageType {\n\tError,\n\tOutput\n}\n\nexport interface ITestErrorMessage {\n\tmessage: string | IMarkdownString;\n\ttype: TestMessageType.Error;\n\texpected: string | undefined;\n\tactual: string | undefined;\n\tlocation: IRichLocation | undefined;\n}\n\nexport namespace ITestErrorMessage {\n\texport interface Serialized {\n\t\tmessage: string | IMarkdownString;\n\t\ttype: TestMessageType.Error;\n\t\texpected: string | undefined;\n\t\tactual: string | undefined;\n\t\tlocation: IRichLocation.Serialize | undefined;\n\t}\n\n\texport const serialize = (message: ITestErrorMessage): Serialized => ({\n\t\tmessage: message.message,\n\t\ttype: TestMessageType.Error,\n\t\texpected: message.expected,\n\t\tactual: message.actual,\n\t\tlocation: message.location && IRichLocation.serialize(message.location),\n\t});\n\n\texport const deserialize = (message: Serialized): ITestErrorMessage => ({\n\t\tmessage: message.message,\n\t\ttype: TestMessageType.Error,\n\t\texpected: message.expected,\n\t\tactual: message.actual,\n\t\tlocation: message.location && IRichLocation.deserialize(message.location),\n\t});\n}\n\nexport interface ITestOutputMessage {\n\tmessage: string;\n\ttype: TestMessageType.Output;\n\toffset: number;\n\tlocation: IRichLocation | undefined;\n}\n\nexport namespace ITestOutputMessage {\n\texport interface Serialized {\n\t\tmessage: string;\n\t\toffset: number;\n\t\ttype: TestMessageType.Output;\n\t\tlocation: IRichLocation.Serialize | undefined;\n\t}\n\n\texport const serialize = (message: ITestOutputMessage): Serialized => ({\n\t\tmessage: message.message,\n\t\ttype: TestMessageType.Output,\n\t\toffset: message.offset,\n\t\tlocation: message.location && IRichLocation.serialize(message.location),\n\t});\n\n\texport const deserialize = (message: Serialized): ITestOutputMessage => ({\n\t\tmessage: message.message,\n\t\ttype: TestMessageType.Output,\n\t\toffset: message.offset,\n\t\tlocation: message.location && IRichLocation.deserialize(message.location),\n\t});\n}\n\nexport type ITestMessage = ITestErrorMessage | ITestOutputMessage;\n\nexport namespace ITestMessage {\n\texport type Serialized = ITestErrorMessage.Serialized | ITestOutputMessage.Serialized;\n\n\texport const serialize = (message: ITestMessage): Serialized =>\n\t\tmessage.type === TestMessageType.Error ? ITestErrorMessage.serialize(message) : ITestOutputMessage.serialize(message);\n\n\texport const deserialize = (message: Serialized): ITestMessage =>\n\t\tmessage.type === TestMessageType.Error ? ITestErrorMessage.deserialize(message) : ITestOutputMessage.deserialize(message);\n}\n\nexport interface ITestTaskState {\n\tstate: TestResultState;\n\tduration: number | undefined;\n\tmessages: ITestMessage[];\n}\n\nexport namespace ITestTaskState {\n\texport interface Serialized {\n\t\tstate: TestResultState;\n\t\tduration: number | undefined;\n\t\tmessages: ITestMessage.Serialized[];\n\t}\n\n\texport const serialize = (state: ITestTaskState): Serialized => ({\n\t\tstate: state.state,\n\t\tduration: state.duration,\n\t\tmessages: state.messages.map(ITestMessage.serialize),\n\t});\n\n\texport const deserialize = (state: Serialized): ITestTaskState => ({\n\t\tstate: state.state,\n\t\tduration: state.duration,\n\t\tmessages: state.messages.map(ITestMessage.deserialize),\n\t});\n}\n\nexport interface ITestRunTask {\n\tid: string;\n\tname: string | undefined;\n\trunning: boolean;\n}\n\nexport interface ITestTag {\n\treadonly id: string;\n}\n\nconst testTagDelimiter = '\\0';\n\nexport const namespaceTestTag =\n\t(ctrlId: string, tagId: string) => ctrlId + testTagDelimiter + tagId;\n\nexport const denamespaceTestTag = (namespaced: string) => {\n\tconst index = namespaced.indexOf(testTagDelimiter);\n\treturn { ctrlId: namespaced.slice(0, index), tagId: namespaced.slice(index + 1) };\n};\n\nexport interface ITestTagDisplayInfo {\n\tid: string;\n}\n\n/**\n * The TestItem from .d.ts, as a plain object without children.\n */\nexport interface ITestItem {\n\t/** ID of the test given by the test controller */\n\textId: string;\n\tlabel: string;\n\ttags: string[];\n\tbusy: boolean;\n\tchildren?: never;\n\turi: URI | undefined;\n\trange: Range | null;\n\tdescription: string | null;\n\terror: string | IMarkdownString | null;\n\tsortText: string | null;\n}\n\nexport namespace ITestItem {\n\texport interface Serialized {\n\t\textId: string;\n\t\tlabel: string;\n\t\ttags: string[];\n\t\tbusy: boolean;\n\t\tchildren?: never;\n\t\turi: UriComponents | undefined;\n\t\trange: IRange | null;\n\t\tdescription: string | null;\n\t\terror: string | IMarkdownString | null;\n\t\tsortText: string | null;\n\t}\n\n\texport const serialize = (item: ITestItem): Serialized => ({\n\t\textId: item.extId,\n\t\tlabel: item.label,\n\t\ttags: item.tags,\n\t\tbusy: item.busy,\n\t\tchildren: undefined,\n\t\turi: item.uri?.toJSON(),\n\t\trange: item.range?.toJSON() || null,\n\t\tdescription: item.description,\n\t\terror: item.error,\n\t\tsortText: item.sortText\n\t});\n\n\texport const deserialize = (serialized: Serialized): ITestItem => ({\n\t\textId: serialized.extId,\n\t\tlabel: serialized.label,\n\t\ttags: serialized.tags,\n\t\tbusy: serialized.busy,\n\t\tchildren: undefined,\n\t\turi: serialized.uri ? URI.revive(serialized.uri) : undefined,\n\t\trange: serialized.range ? Range.lift(serialized.range) : null,\n\t\tdescription: serialized.description,\n\t\terror: serialized.error,\n\t\tsortText: serialized.sortText\n\t});\n}\n\nexport const enum TestItemExpandState {\n\tNotExpandable,\n\tExpandable,\n\tBusyExpanding,\n\tExpanded,\n}\n\n/**\n * TestItem-like shape, butm with an ID and children as strings.\n */\nexport interface InternalTestItem {\n\t/** Controller ID from whence this test came */\n\tcontrollerId: string;\n\t/** Expandability state */\n\texpand: TestItemExpandState;\n\t/** Parent ID, if any */\n\tparent: string | null;\n\t/** Raw test item properties */\n\titem: ITestItem;\n}\n\nexport namespace InternalTestItem {\n\texport interface Serialized {\n\t\tcontrollerId: string;\n\t\texpand: TestItemExpandState;\n\t\tparent: string | null;\n\t\titem: ITestItem.Serialized;\n\t}\n\n\texport const serialize = (item: InternalTestItem): Serialized => ({\n\t\tcontrollerId: item.controllerId,\n\t\texpand: item.expand,\n\t\tparent: item.parent,\n\t\titem: ITestItem.serialize(item.item)\n\t});\n\n\texport const deserialize = (serialized: Serialized): InternalTestItem => ({\n\t\tcontrollerId: serialized.controllerId,\n\t\texpand: serialized.expand,\n\t\tparent: serialized.parent,\n\t\titem: ITestItem.deserialize(serialized.item)\n\t});\n}\n\n/**\n * A partial update made to an existing InternalTestItem.\n */\nexport interface ITestItemUpdate {\n\textId: string;\n\texpand?: TestItemExpandState;\n\titem?: Partial<ITestItem>;\n}\n\nexport namespace ITestItemUpdate {\n\texport interface Serialized {\n\t\textId: string;\n\t\texpand?: TestItemExpandState;\n\t\titem?: Partial<ITestItem.Serialized>;\n\t}\n\n\texport const serialize = (u: ITestItemUpdate): Serialized => {\n\t\tlet item: Partial<ITestItem.Serialized> | undefined;\n\t\tif (u.item) {\n\t\t\titem = {};\n\t\t\tif (u.item.label !== undefined) { item.label = u.item.label; }\n\t\t\tif (u.item.tags !== undefined) { item.tags = u.item.tags; }\n\t\t\tif (u.item.busy !== undefined) { item.busy = u.item.busy; }\n\t\t\tif (u.item.uri !== undefined) { item.uri = u.item.uri?.toJSON(); }\n\t\t\tif (u.item.range !== undefined) { item.range = u.item.range?.toJSON(); }\n\t\t\tif (u.item.description !== undefined) { item.description = u.item.description; }\n\t\t\tif (u.item.error !== undefined) { item.error = u.item.error; }\n\t\t\tif (u.item.sortText !== undefined) { item.sortText = u.item.sortText; }\n\t\t}\n\n\t\treturn { extId: u.extId, expand: u.expand, item };\n\t};\n\n\texport const deserialize = (u: Serialized): ITestItemUpdate => {\n\t\tlet item: Partial<ITestItem> | undefined;\n\t\tif (u.item) {\n\t\t\titem = {};\n\t\t\tif (u.item.label !== undefined) { item.label = u.item.label; }\n\t\t\tif (u.item.tags !== undefined) { item.tags = u.item.tags; }\n\t\t\tif (u.item.busy !== undefined) { item.busy = u.item.busy; }\n\t\t\tif (u.item.range !== undefined) { item.range = u.item.range ? Range.lift(u.item.range) : null; }\n\t\t\tif (u.item.description !== undefined) { item.description = u.item.description; }\n\t\t\tif (u.item.error !== undefined) { item.error = u.item.error; }\n\t\t\tif (u.item.sortText !== undefined) { item.sortText = u.item.sortText; }\n\t\t}\n\n\t\treturn { extId: u.extId, expand: u.expand, item };\n\t};\n\n}\n\nexport const applyTestItemUpdate = (internal: InternalTestItem | ITestItemUpdate, patch: ITestItemUpdate) => {\n\tif (patch.expand !== undefined) {\n\t\tinternal.expand = patch.expand;\n\t}\n\tif (patch.item !== undefined) {\n\t\tinternal.item = internal.item ? Object.assign(internal.item, patch.item) : patch.item;\n\t}\n};\n\n/**\n * Test result item used in the main thread.\n */\nexport interface TestResultItem extends InternalTestItem {\n\t/** State of this test in various tasks */\n\ttasks: ITestTaskState[];\n\t/** State of this test as a computation of its tasks */\n\townComputedState: TestResultState;\n\t/** Computed state based on children */\n\tcomputedState: TestResultState;\n\t/** Max duration of the item's tasks (if run directly) */\n\townDuration?: number;\n}\n\nexport namespace TestResultItem {\n\t/** Serialized version of the TestResultItem */\n\texport interface Serialized extends InternalTestItem.Serialized {\n\t\tchildren: string[];\n\t\ttasks: ITestTaskState.Serialized[];\n\t\townComputedState: TestResultState;\n\t\tcomputedState: TestResultState;\n\t}\n\n\texport const serialize = (original: TestResultItem, children: string[]): Serialized => ({\n\t\t...InternalTestItem.serialize(original),\n\t\tchildren,\n\t\townComputedState: original.ownComputedState,\n\t\tcomputedState: original.computedState,\n\t\ttasks: original.tasks.map(ITestTaskState.serialize),\n\t});\n}\n\nexport interface ISerializedTestResults {\n\t/** ID of these test results */\n\tid: string;\n\t/** Time the results were compelted */\n\tcompletedAt: number;\n\t/** Subset of test result items */\n\titems: TestResultItem.Serialized[];\n\t/** Tasks involved in the run. */\n\ttasks: { id: string; name: string | undefined; messages: ITestOutputMessage.Serialized[] }[];\n\t/** Human-readable name of the test run. */\n\tname: string;\n\t/** Test trigger informaton */\n\trequest: ResolvedTestRunRequest;\n}\n\nexport interface ITestCoverage {\n\tfiles: IFileCoverage[];\n}\n\nexport interface ICoveredCount {\n\tcovered: number;\n\ttotal: number;\n}\n\nexport interface IFileCoverage {\n\turi: URI;\n\tstatement: ICoveredCount;\n\tbranch?: ICoveredCount;\n\tfunction?: ICoveredCount;\n\tdetails?: CoverageDetails[];\n}\n\nexport const enum DetailType {\n\tFunction,\n\tStatement,\n}\n\nexport type CoverageDetails = IFunctionCoverage | IStatementCoverage;\n\nexport interface IBranchCoverage {\n\tcount: number;\n\tlocation?: IRange | IPosition;\n}\n\nexport interface IFunctionCoverage {\n\ttype: DetailType.Function;\n\tcount: number;\n\tlocation?: IRange | IPosition;\n}\n\nexport interface IStatementCoverage {\n\ttype: DetailType.Statement;\n\tcount: number;\n\tlocation: IRange | IPosition;\n\tbranches?: IBranchCoverage[];\n}\n\nexport const enum TestDiffOpType {\n\t/** Adds a new test (with children) */\n\tAdd,\n\t/** Shallow-updates an existing test */\n\tUpdate,\n\t/** Removes a test (and all its children) */\n\tRemove,\n\t/** Changes the number of controllers who are yet to publish their collection roots. */\n\tIncrementPendingExtHosts,\n\t/** Retires a test/result */\n\tRetire,\n\t/** Add a new test tag */\n\tAddTag,\n\t/** Remove a test tag */\n\tRemoveTag,\n}\n\nexport type TestsDiffOp =\n\t| { op: TestDiffOpType.Add; item: InternalTestItem }\n\t| { op: TestDiffOpType.Update; item: ITestItemUpdate }\n\t| { op: TestDiffOpType.Remove; itemId: string }\n\t| { op: TestDiffOpType.Retire; itemId: string }\n\t| { op: TestDiffOpType.IncrementPendingExtHosts; amount: number }\n\t| { op: TestDiffOpType.AddTag; tag: ITestTagDisplayInfo }\n\t| { op: TestDiffOpType.RemoveTag; id: string };\n\nexport namespace TestsDiffOp {\n\texport type Serialized =\n\t\t| { op: TestDiffOpType.Add; item: InternalTestItem.Serialized }\n\t\t| { op: TestDiffOpType.Update; item: ITestItemUpdate.Serialized }\n\t\t| { op: TestDiffOpType.Remove; itemId: string }\n\t\t| { op: TestDiffOpType.Retire; itemId: string }\n\t\t| { op: TestDiffOpType.IncrementPendingExtHosts; amount: number }\n\t\t| { op: TestDiffOpType.AddTag; tag: ITestTagDisplayInfo }\n\t\t| { op: TestDiffOpType.RemoveTag; id: string };\n\n\texport const deserialize = (u: Serialized): TestsDiffOp => {\n\t\tif (u.op === TestDiffOpType.Add) {\n\t\t\treturn { op: u.op, item: InternalTestItem.deserialize(u.item) };\n\t\t} else if (u.op === TestDiffOpType.Update) {\n\t\t\treturn { op: u.op, item: ITestItemUpdate.deserialize(u.item) };\n\t\t} else {\n\t\t\treturn u;\n\t\t}\n\t};\n\n\texport const serialize = (u: TestsDiffOp): Serialized => {\n\t\tif (u.op === TestDiffOpType.Add) {\n\t\t\treturn { op: u.op, item: InternalTestItem.serialize(u.item) };\n\t\t} else if (u.op === TestDiffOpType.Update) {\n\t\t\treturn { op: u.op, item: ITestItemUpdate.serialize(u.item) };\n\t\t} else {\n\t\t\treturn u;\n\t\t}\n\t};\n}\n\n/**\n * Context for actions taken in the test explorer view.\n */\nexport interface ITestItemContext {\n\t/** Marshalling marker */\n\t$mid: MarshalledId.TestItemContext;\n\t/** Tests and parents from the root to the current items */\n\ttests: InternalTestItem.Serialized[];\n}\n\n/**\n * Request from the ext host or main thread to indicate that tests have\n * changed. It's assumed that any item upserted *must* have its children\n * previously also upserted, or upserted as part of the same operation.\n * Children that no longer exist in an upserted item will be removed.\n */\nexport type TestsDiff = TestsDiffOp[];\n\n/**\n * @private\n */\nexport interface IncrementalTestCollectionItem extends InternalTestItem {\n\tchildren: Set<string>;\n}\n\n/**\n * The IncrementalChangeCollector is used in the IncrementalTestCollection\n * and called with diff changes as they're applied. This is used in the\n * ext host to create a cohesive change event from a diff.\n */\nexport class IncrementalChangeCollector<T> {\n\t/**\n\t * A node was added.\n\t */\n\tpublic add(node: T): void { }\n\n\t/**\n\t * A node in the collection was updated.\n\t */\n\tpublic update(node: T): void { }\n\n\t/**\n\t * A node was removed.\n\t */\n\tpublic remove(node: T, isNestedOperation: boolean): void { }\n\n\t/**\n\t * Called when the diff has been applied.\n\t */\n\tpublic complete(): void { }\n}\n\n/**\n * Maintains tests in this extension host sent from the main thread.\n */\nexport abstract class AbstractIncrementalTestCollection<T extends IncrementalTestCollectionItem>  {\n\tprivate readonly _tags = new Map<string, ITestTagDisplayInfo>();\n\n\t/**\n\t * Map of item IDs to test item objects.\n\t */\n\tprotected readonly items = new Map<string, T>();\n\n\t/**\n\t * ID of test root items.\n\t */\n\tprotected readonly roots = new Set<T>();\n\n\t/**\n\t * Number of 'busy' controllers.\n\t */\n\tprotected busyControllerCount = 0;\n\n\t/**\n\t * Number of pending roots.\n\t */\n\tprotected pendingRootCount = 0;\n\n\t/**\n\t * Known test tags.\n\t */\n\tpublic readonly tags: ReadonlyMap<string, ITestTagDisplayInfo> = this._tags;\n\n\t/**\n\t * Applies the diff to the collection.\n\t */\n\tpublic apply(diff: TestsDiff) {\n\t\tconst changes = this.createChangeCollector();\n\n\t\tfor (const op of diff) {\n\t\t\tswitch (op.op) {\n\t\t\t\tcase TestDiffOpType.Add: {\n\t\t\t\t\tconst internalTest = InternalTestItem.deserialize(op.item);\n\t\t\t\t\tif (!internalTest.parent) {\n\t\t\t\t\t\tconst created = this.createItem(internalTest);\n\t\t\t\t\t\tthis.roots.add(created);\n\t\t\t\t\t\tthis.items.set(internalTest.item.extId, created);\n\t\t\t\t\t\tchanges.add(created);\n\t\t\t\t\t} else if (this.items.has(internalTest.parent)) {\n\t\t\t\t\t\tconst parent = this.items.get(internalTest.parent)!;\n\t\t\t\t\t\tparent.children.add(internalTest.item.extId);\n\t\t\t\t\t\tconst created = this.createItem(internalTest, parent);\n\t\t\t\t\t\tthis.items.set(internalTest.item.extId, created);\n\t\t\t\t\t\tchanges.add(created);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (internalTest.expand === TestItemExpandState.BusyExpanding) {\n\t\t\t\t\t\tthis.busyControllerCount++;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase TestDiffOpType.Update: {\n\t\t\t\t\tconst patch = ITestItemUpdate.deserialize(op.item);\n\t\t\t\t\tconst existing = this.items.get(patch.extId);\n\t\t\t\t\tif (!existing) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (patch.expand !== undefined) {\n\t\t\t\t\t\tif (existing.expand === TestItemExpandState.BusyExpanding) {\n\t\t\t\t\t\t\tthis.busyControllerCount--;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (patch.expand === TestItemExpandState.BusyExpanding) {\n\t\t\t\t\t\t\tthis.busyControllerCount++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tapplyTestItemUpdate(existing, patch);\n\t\t\t\t\tchanges.update(existing);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase TestDiffOpType.Remove: {\n\t\t\t\t\tconst toRemove = this.items.get(op.itemId);\n\t\t\t\t\tif (!toRemove) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (toRemove.parent) {\n\t\t\t\t\t\tconst parent = this.items.get(toRemove.parent)!;\n\t\t\t\t\t\tparent.children.delete(toRemove.item.extId);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.roots.delete(toRemove);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst queue: Iterable<string>[] = [[op.itemId]];\n\t\t\t\t\twhile (queue.length) {\n\t\t\t\t\t\tfor (const itemId of queue.pop()!) {\n\t\t\t\t\t\t\tconst existing = this.items.get(itemId);\n\t\t\t\t\t\t\tif (existing) {\n\t\t\t\t\t\t\t\tqueue.push(existing.children);\n\t\t\t\t\t\t\t\tthis.items.delete(itemId);\n\t\t\t\t\t\t\t\tchanges.remove(existing, existing !== toRemove);\n\n\t\t\t\t\t\t\t\tif (existing.expand === TestItemExpandState.BusyExpanding) {\n\t\t\t\t\t\t\t\t\tthis.busyControllerCount--;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase TestDiffOpType.Retire:\n\t\t\t\t\tthis.retireTest(op.itemId);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase TestDiffOpType.IncrementPendingExtHosts:\n\t\t\t\t\tthis.updatePendingRoots(op.amount);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase TestDiffOpType.AddTag:\n\t\t\t\t\tthis._tags.set(op.tag.id, op.tag);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase TestDiffOpType.RemoveTag:\n\t\t\t\t\tthis._tags.delete(op.id);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tchanges.complete();\n\t}\n\n\t/**\n\t * Called when the extension signals a test result should be retired.\n\t */\n\tprotected retireTest(testId: string) {\n\t\t// no-op\n\t}\n\n\t/**\n\t * Updates the number of test root sources who are yet to report. When\n\t * the total pending test roots reaches 0, the roots for all controllers\n\t * will exist in the collection.\n\t */\n\tpublic updatePendingRoots(delta: number) {\n\t\tthis.pendingRootCount += delta;\n\t}\n\n\t/**\n\t * Called before a diff is applied to create a new change collector.\n\t */\n\tprotected createChangeCollector() {\n\t\treturn new IncrementalChangeCollector<T>();\n\t}\n\n\t/**\n\t * Creates a new item for the collection from the internal test item.\n\t */\n\tprotected abstract createItem(internal: InternalTestItem, parent?: T): T;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Barrier, isThenable, RunOnceScheduler } from 'vs/base/common/async';\nimport { Emitter } from 'vs/base/common/event';\nimport { Disposable } from 'vs/base/common/lifecycle';\nimport { assertNever } from 'vs/base/common/types';\nimport { applyTestItemUpdate, ITestItem, ITestTag, namespaceTestTag, TestDiffOpType, TestItemExpandState, TestsDiff, TestsDiffOp } from 'vs/workbench/contrib/testing/common/testTypes';\nimport { TestId } from 'vs/workbench/contrib/testing/common/testId';\n\n/**\n * @private\n */\ninterface CollectionItem<T> {\n\treadonly fullId: TestId;\n\treadonly parent: TestId | null;\n\tactual: T;\n\texpand: TestItemExpandState;\n\t/**\n\t * Number of levels of items below this one that are expanded. May be infinite.\n\t */\n\texpandLevels?: number;\n\tresolveBarrier?: Barrier;\n}\n\nexport const enum TestItemEventOp {\n\tUpsert,\n\tSetTags,\n\tUpdateCanResolveChildren,\n\tRemoveChild,\n\tSetProp,\n\tBulk,\n}\n\nexport interface ITestItemUpsertChild {\n\top: TestItemEventOp.Upsert;\n\titem: ITestItemLike;\n}\n\nexport interface ITestItemUpdateCanResolveChildren {\n\top: TestItemEventOp.UpdateCanResolveChildren;\n\tstate: boolean;\n}\n\nexport interface ITestItemSetTags {\n\top: TestItemEventOp.SetTags;\n\tnew: ITestTag[];\n\told: ITestTag[];\n}\n\nexport interface ITestItemRemoveChild {\n\top: TestItemEventOp.RemoveChild;\n\tid: string;\n}\n\nexport interface ITestItemSetProp {\n\top: TestItemEventOp.SetProp;\n\tupdate: Partial<ITestItem>;\n}\nexport interface ITestItemBulkReplace {\n\top: TestItemEventOp.Bulk;\n\tops: (ITestItemUpsertChild | ITestItemRemoveChild)[];\n}\n\nexport type ExtHostTestItemEvent =\n\t| ITestItemSetTags\n\t| ITestItemUpsertChild\n\t| ITestItemRemoveChild\n\t| ITestItemUpdateCanResolveChildren\n\t| ITestItemSetProp\n\t| ITestItemBulkReplace;\n\nexport interface ITestItemApi<T> {\n\tcontrollerId: string;\n\tparent?: T;\n\tlistener?: (evt: ExtHostTestItemEvent) => void;\n}\n\nexport interface ITestItemCollectionOptions<T> {\n\t/** Controller ID to use to prefix these test items. */\n\tcontrollerId: string;\n\n\t/** Gets API for the given test item, used to listen for events and set parents. */\n\tgetApiFor(item: T): ITestItemApi<T>;\n\n\t/** Converts the full test item to the common interface. */\n\ttoITestItem(item: T): ITestItem;\n\n\t/** Gets children for the item. */\n\tgetChildren(item: T): ITestChildrenLike<T>;\n\n\t/** Root to use for the new test collection. */\n\troot: T;\n}\n\nconst strictEqualComparator = <T>(a: T, b: T) => a === b;\nconst diffableProps: { [K in keyof ITestItem]?: (a: ITestItem[K], b: ITestItem[K]) => boolean } = {\n\trange: (a, b) => {\n\t\tif (a === b) { return true; }\n\t\tif (!a || !b) { return false; }\n\t\treturn a.equalsRange(b);\n\t},\n\tbusy: strictEqualComparator,\n\tlabel: strictEqualComparator,\n\tdescription: strictEqualComparator,\n\terror: strictEqualComparator,\n\ttags: (a, b) => {\n\t\tif (a.length !== b.length) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (a.some(t1 => !b.includes(t1))) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t},\n};\n\nconst diffTestItems = (a: ITestItem, b: ITestItem) => {\n\tlet output: Record<string, unknown> | undefined;\n\tfor (const [key, cmp] of Object.entries(diffableProps) as [keyof ITestItem, (a: any, b: any) => boolean][]) {\n\t\tif (!cmp(a[key], b[key])) {\n\t\t\tif (output) {\n\t\t\t\toutput[key] = b[key];\n\t\t\t} else {\n\t\t\t\toutput = { [key]: b[key] };\n\t\t\t}\n\t\t}\n\t}\n\n\treturn output as Partial<ITestItem> | undefined;\n};\n\nexport interface ITestChildrenLike<T> extends Iterable<[string, T]> {\n\tget(id: string): T | undefined;\n\tdelete(id: string): void;\n}\n\nexport interface ITestItemLike {\n\tid: string;\n\ttags: readonly ITestTag[];\n\tcanResolveChildren: boolean;\n}\n\n/**\n * Maintains a collection of test items for a single controller.\n */\nexport class TestItemCollection<T extends ITestItemLike> extends Disposable {\n\tprivate readonly debounceSendDiff = this._register(new RunOnceScheduler(() => this.flushDiff(), 200));\n\tprivate readonly diffOpEmitter = this._register(new Emitter<TestsDiff>());\n\tprivate _resolveHandler?: (item: T | undefined) => Promise<void> | void;\n\n\tpublic get root() {\n\t\treturn this.options.root;\n\t}\n\n\tpublic readonly tree = new Map</* full test id */string, CollectionItem<T>>();\n\tprivate readonly tags = new Map<string, { label?: string; refCount: number }>();\n\n\tprotected diff: TestsDiff = [];\n\n\tconstructor(private readonly options: ITestItemCollectionOptions<T>) {\n\t\tsuper();\n\t\tthis.root.canResolveChildren = true;\n\t\tthis.upsertItem(this.root, undefined);\n\t}\n\n\t/**\n\t * Handler used for expanding test items.\n\t */\n\tpublic set resolveHandler(handler: undefined | ((item: T | undefined) => void)) {\n\t\tthis._resolveHandler = handler;\n\t\tfor (const test of this.tree.values()) {\n\t\t\tthis.updateExpandability(test);\n\t\t}\n\t}\n\n\t/**\n\t * Fires when an operation happens that should result in a diff.\n\t */\n\tpublic readonly onDidGenerateDiff = this.diffOpEmitter.event;\n\n\t/**\n\t * Gets a diff of all changes that have been made, and clears the diff queue.\n\t */\n\tpublic collectDiff() {\n\t\tconst diff = this.diff;\n\t\tthis.diff = [];\n\t\treturn diff;\n\t}\n\n\t/**\n\t * Pushes a new diff entry onto the collected diff list.\n\t */\n\tpublic pushDiff(diff: TestsDiffOp) {\n\t\t// Try to merge updates, since they're invoked per-property\n\t\tconst last = this.diff[this.diff.length - 1];\n\t\tif (last && diff.op === TestDiffOpType.Update) {\n\t\t\tif (last.op === TestDiffOpType.Update && last.item.extId === diff.item.extId) {\n\t\t\t\tapplyTestItemUpdate(last.item, diff.item);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (last.op === TestDiffOpType.Add && last.item.item.extId === diff.item.extId) {\n\t\t\t\tapplyTestItemUpdate(last.item, diff.item);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis.diff.push(diff);\n\n\t\tif (!this.debounceSendDiff.isScheduled()) {\n\t\t\tthis.debounceSendDiff.schedule();\n\t\t}\n\t}\n\n\t/**\n\t * Expands the test and the given number of `levels` of children. If levels\n\t * is < 0, then all children will be expanded. If it's 0, then only this\n\t * item will be expanded.\n\t */\n\tpublic expand(testId: string, levels: number): Promise<void> | void {\n\t\tconst internal = this.tree.get(testId);\n\t\tif (!internal) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (internal.expandLevels === undefined || levels > internal.expandLevels) {\n\t\t\tinternal.expandLevels = levels;\n\t\t}\n\n\t\t// try to avoid awaiting things if the provider returns synchronously in\n\t\t// order to keep everything in a single diff and DOM update.\n\t\tif (internal.expand === TestItemExpandState.Expandable) {\n\t\t\tconst r = this.resolveChildren(internal);\n\t\t\treturn !r.isOpen()\n\t\t\t\t? r.wait().then(() => this.expandChildren(internal, levels - 1))\n\t\t\t\t: this.expandChildren(internal, levels - 1);\n\t\t} else if (internal.expand === TestItemExpandState.Expanded) {\n\t\t\treturn internal.resolveBarrier?.isOpen() === false\n\t\t\t\t? internal.resolveBarrier.wait().then(() => this.expandChildren(internal, levels - 1))\n\t\t\t\t: this.expandChildren(internal, levels - 1);\n\t\t}\n\t}\n\n\tpublic override dispose() {\n\t\tfor (const item of this.tree.values()) {\n\t\t\tthis.options.getApiFor(item.actual).listener = undefined;\n\t\t}\n\n\t\tthis.tree.clear();\n\t\tthis.diff = [];\n\t\tsuper.dispose();\n\t}\n\n\tprivate onTestItemEvent(internal: CollectionItem<T>, evt: ExtHostTestItemEvent) {\n\t\tswitch (evt.op) {\n\t\t\tcase TestItemEventOp.RemoveChild:\n\t\t\t\tthis.removeItem(TestId.joinToString(internal.fullId, evt.id));\n\t\t\t\tbreak;\n\n\t\t\tcase TestItemEventOp.Upsert:\n\t\t\t\tthis.upsertItem(evt.item as T, internal);\n\t\t\t\tbreak;\n\n\t\t\tcase TestItemEventOp.Bulk:\n\t\t\t\tfor (const op of evt.ops) {\n\t\t\t\t\tthis.onTestItemEvent(internal, op);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase TestItemEventOp.SetTags:\n\t\t\t\tthis.diffTagRefs(evt.new, evt.old, internal.fullId.toString());\n\t\t\t\tbreak;\n\n\t\t\tcase TestItemEventOp.UpdateCanResolveChildren:\n\t\t\t\tthis.updateExpandability(internal);\n\t\t\t\tbreak;\n\n\t\t\tcase TestItemEventOp.SetProp:\n\t\t\t\tthis.pushDiff({\n\t\t\t\t\top: TestDiffOpType.Update,\n\t\t\t\t\titem: { extId: internal.fullId.toString(), item: evt.update }\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tassertNever(evt);\n\t\t}\n\t}\n\n\tprivate upsertItem(actual: T, parent: CollectionItem<T> | undefined) {\n\t\tconst fullId = TestId.fromExtHostTestItem(actual, this.root.id, parent?.actual);\n\n\t\t// If this test item exists elsewhere in the tree already (exists at an\n\t\t// old ID with an existing parent), remove that old item.\n\t\tconst privateApi = this.options.getApiFor(actual);\n\t\tif (privateApi.parent && privateApi.parent !== parent?.actual) {\n\t\t\tthis.options.getChildren(privateApi.parent).delete(actual.id);\n\t\t}\n\n\t\tlet internal = this.tree.get(fullId.toString());\n\t\t// Case 1: a brand new item\n\t\tif (!internal) {\n\t\t\tinternal = {\n\t\t\t\tfullId,\n\t\t\t\tactual,\n\t\t\t\tparent: parent ? fullId.parentId : null,\n\t\t\t\texpandLevels: parent?.expandLevels /* intentionally undefined or 0 */ ? parent.expandLevels - 1 : undefined,\n\t\t\t\texpand: TestItemExpandState.NotExpandable, // updated by `connectItemAndChildren`\n\t\t\t};\n\n\t\t\tactual.tags.forEach(this.incrementTagRefs, this);\n\t\t\tthis.tree.set(internal.fullId.toString(), internal);\n\t\t\tthis.setItemParent(actual, parent);\n\t\t\tthis.pushDiff({\n\t\t\t\top: TestDiffOpType.Add,\n\t\t\t\titem: {\n\t\t\t\t\tparent: internal.parent && internal.parent.toString(),\n\t\t\t\t\tcontrollerId: this.options.controllerId,\n\t\t\t\t\texpand: internal.expand,\n\t\t\t\t\titem: this.options.toITestItem(actual),\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.connectItemAndChildren(actual, internal, parent);\n\t\t\treturn;\n\t\t}\n\n\t\t// Case 2: re-insertion of an existing item, no-op\n\t\tif (internal.actual === actual) {\n\t\t\tthis.connectItem(actual, internal, parent); // re-connect in case the parent changed\n\t\t\treturn; // no-op\n\t\t}\n\n\t\t// Case 3: upsert of an existing item by ID, with a new instance\n\t\tconst oldChildren = this.options.getChildren(internal.actual);\n\t\tconst oldActual = internal.actual;\n\t\tconst update = diffTestItems(this.options.toITestItem(oldActual), this.options.toITestItem(actual));\n\t\tthis.options.getApiFor(oldActual).listener = undefined;\n\n\t\tinternal.actual = actual;\n\t\tinternal.expand = TestItemExpandState.NotExpandable; // updated by `connectItemAndChildren`\n\n\t\tif (update) {\n\t\t\t// tags are handled in a special way\n\t\t\tif (update.hasOwnProperty('tags')) {\n\t\t\t\tthis.diffTagRefs(actual.tags, oldActual.tags, fullId.toString());\n\t\t\t\tdelete update.tags;\n\t\t\t}\n\t\t\tthis.onTestItemEvent(internal, { op: TestItemEventOp.SetProp, update });\n\t\t}\n\n\t\tthis.connectItemAndChildren(actual, internal, parent);\n\n\t\t// Remove any orphaned children.\n\t\tfor (const [_, child] of oldChildren) {\n\t\t\tif (!this.options.getChildren(actual).get(child.id)) {\n\t\t\t\tthis.removeItem(TestId.joinToString(fullId, child.id));\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate diffTagRefs(newTags: readonly ITestTag[], oldTags: readonly ITestTag[], extId: string) {\n\t\tconst toDelete = new Set(oldTags.map(t => t.id));\n\t\tfor (const tag of newTags) {\n\t\t\tif (!toDelete.delete(tag.id)) {\n\t\t\t\tthis.incrementTagRefs(tag);\n\t\t\t}\n\t\t}\n\n\t\tthis.pushDiff({\n\t\t\top: TestDiffOpType.Update,\n\t\t\titem: { extId, item: { tags: newTags.map(v => namespaceTestTag(this.options.controllerId, v.id)) } }\n\t\t});\n\n\t\ttoDelete.forEach(this.decrementTagRefs, this);\n\t}\n\n\tprivate incrementTagRefs(tag: ITestTag) {\n\t\tconst existing = this.tags.get(tag.id);\n\t\tif (existing) {\n\t\t\texisting.refCount++;\n\t\t} else {\n\t\t\tthis.tags.set(tag.id, { refCount: 1 });\n\t\t\tthis.pushDiff({\n\t\t\t\top: TestDiffOpType.AddTag, tag: {\n\t\t\t\t\tid: namespaceTestTag(this.options.controllerId, tag.id),\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate decrementTagRefs(tagId: string) {\n\t\tconst existing = this.tags.get(tagId);\n\t\tif (existing && !--existing.refCount) {\n\t\t\tthis.tags.delete(tagId);\n\t\t\tthis.pushDiff({ op: TestDiffOpType.RemoveTag, id: namespaceTestTag(this.options.controllerId, tagId) });\n\t\t}\n\t}\n\n\tprivate setItemParent(actual: T, parent: CollectionItem<T> | undefined) {\n\t\tthis.options.getApiFor(actual).parent = parent && parent.actual !== this.root ? parent.actual : undefined;\n\t}\n\n\tprivate connectItem(actual: T, internal: CollectionItem<T>, parent: CollectionItem<T> | undefined) {\n\t\tthis.setItemParent(actual, parent);\n\t\tconst api = this.options.getApiFor(actual);\n\t\tapi.parent = parent?.actual;\n\t\tapi.listener = evt => this.onTestItemEvent(internal, evt);\n\t\tthis.updateExpandability(internal);\n\t}\n\n\tprivate connectItemAndChildren(actual: T, internal: CollectionItem<T>, parent: CollectionItem<T> | undefined) {\n\t\tthis.connectItem(actual, internal, parent);\n\n\t\t// Discover any existing children that might have already been added\n\t\tfor (const [_, child] of this.options.getChildren(actual)) {\n\t\t\tthis.upsertItem(child, internal);\n\t\t}\n\t}\n\n\t/**\n\t * Updates the `expand` state of the item. Should be called whenever the\n\t * resolved state of the item changes. Can automatically expand the item\n\t * if requested by a consumer.\n\t */\n\tprivate updateExpandability(internal: CollectionItem<T>) {\n\t\tlet newState: TestItemExpandState;\n\t\tif (!this._resolveHandler) {\n\t\t\tnewState = TestItemExpandState.NotExpandable;\n\t\t} else if (internal.resolveBarrier) {\n\t\t\tnewState = internal.resolveBarrier.isOpen()\n\t\t\t\t? TestItemExpandState.Expanded\n\t\t\t\t: TestItemExpandState.BusyExpanding;\n\t\t} else {\n\t\t\tnewState = internal.actual.canResolveChildren\n\t\t\t\t? TestItemExpandState.Expandable\n\t\t\t\t: TestItemExpandState.NotExpandable;\n\t\t}\n\n\t\tif (newState === internal.expand) {\n\t\t\treturn;\n\t\t}\n\n\t\tinternal.expand = newState;\n\t\tthis.pushDiff({ op: TestDiffOpType.Update, item: { extId: internal.fullId.toString(), expand: newState } });\n\n\t\tif (newState === TestItemExpandState.Expandable && internal.expandLevels !== undefined) {\n\t\t\tthis.resolveChildren(internal);\n\t\t}\n\t}\n\n\t/**\n\t * Expands all children of the item, \"levels\" deep. If levels is 0, only\n\t * the children will be expanded. If it's 1, the children and their children\n\t * will be expanded. If it's <0, it's a no-op.\n\t */\n\tprivate expandChildren(internal: CollectionItem<T>, levels: number): Promise<void> | void {\n\t\tif (levels < 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst expandRequests: Promise<void>[] = [];\n\t\tfor (const [_, child] of this.options.getChildren(internal.actual)) {\n\t\t\tconst promise = this.expand(TestId.joinToString(internal.fullId, child.id), levels);\n\t\t\tif (isThenable(promise)) {\n\t\t\t\texpandRequests.push(promise);\n\t\t\t}\n\t\t}\n\n\t\tif (expandRequests.length) {\n\t\t\treturn Promise.all(expandRequests).then(() => { });\n\t\t}\n\t}\n\n\t/**\n\t * Calls `discoverChildren` on the item, refreshing all its tests.\n\t */\n\tprivate resolveChildren(internal: CollectionItem<T>) {\n\t\tif (internal.resolveBarrier) {\n\t\t\treturn internal.resolveBarrier;\n\t\t}\n\n\t\tif (!this._resolveHandler) {\n\t\t\tconst b = new Barrier();\n\t\t\tb.open();\n\t\t\treturn b;\n\t\t}\n\n\t\tinternal.expand = TestItemExpandState.BusyExpanding;\n\t\tthis.pushExpandStateUpdate(internal);\n\n\t\tconst barrier = internal.resolveBarrier = new Barrier();\n\t\tconst applyError = (err: Error) => {\n\t\t\tconsole.error(`Unhandled error in resolveHandler of test controller \"${this.options.controllerId}\"`, err);\n\t\t};\n\n\t\tlet r: Thenable<void> | void;\n\t\ttry {\n\t\t\tr = this._resolveHandler(internal.actual === this.root ? undefined : internal.actual);\n\t\t} catch (err) {\n\t\t\tapplyError(err);\n\t\t}\n\n\t\tif (isThenable(r)) {\n\t\t\tr.catch(applyError).then(() => {\n\t\t\t\tbarrier.open();\n\t\t\t\tthis.updateExpandability(internal);\n\t\t\t});\n\t\t} else {\n\t\t\tbarrier.open();\n\t\t\tthis.updateExpandability(internal);\n\t\t}\n\n\t\treturn internal.resolveBarrier;\n\t}\n\n\tprivate pushExpandStateUpdate(internal: CollectionItem<T>) {\n\t\tthis.pushDiff({ op: TestDiffOpType.Update, item: { extId: internal.fullId.toString(), expand: internal.expand } });\n\t}\n\n\tprivate removeItem(childId: string) {\n\t\tconst childItem = this.tree.get(childId);\n\t\tif (!childItem) {\n\t\t\tthrow new Error('attempting to remove non-existent child');\n\t\t}\n\n\t\tthis.pushDiff({ op: TestDiffOpType.Remove, itemId: childId });\n\n\t\tconst queue: (CollectionItem<T> | undefined)[] = [childItem];\n\t\twhile (queue.length) {\n\t\t\tconst item = queue.pop();\n\t\t\tif (!item) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis.options.getApiFor(item.actual).listener = undefined;\n\n\t\t\tfor (const tag of item.actual.tags) {\n\t\t\t\tthis.decrementTagRefs(tag.id);\n\t\t\t}\n\n\t\t\tthis.tree.delete(item.fullId.toString());\n\t\t\tfor (const [_, child] of this.options.getChildren(item.actual)) {\n\t\t\t\tqueue.push(this.tree.get(TestId.joinToString(item.fullId, child.id)));\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Immediately emits any pending diffs on the collection.\n\t */\n\tpublic flushDiff() {\n\t\tconst diff = this.collectDiff();\n\t\tif (diff.length) {\n\t\t\tthis.diffOpEmitter.fire(diff);\n\t\t}\n\t}\n}\n\n/** Implementation of vscode.TestItemCollection */\nexport interface ITestItemChildren<T extends ITestItemLike> extends Iterable<[string, T]> {\n\treadonly size: number;\n\treplace(items: readonly T[]): void;\n\tforEach(callback: (item: T, collection: this) => unknown, thisArg?: unknown): void;\n\tadd(item: T): void;\n\tdelete(itemId: string): void;\n\tget(itemId: string): T | undefined;\n\n\ttoJSON(): readonly T[];\n}\n\nexport class DuplicateTestItemError extends Error {\n\tconstructor(id: string) {\n\t\tsuper(`Attempted to insert a duplicate test item ID ${id}`);\n\t}\n}\n\nexport class InvalidTestItemError extends Error {\n\tconstructor(id: string) {\n\t\tsuper(`TestItem with ID \"${id}\" is invalid. Make sure to create it from the createTestItem method.`);\n\t}\n}\n\nexport class MixedTestItemController extends Error {\n\tconstructor(id: string, ctrlA: string, ctrlB: string) {\n\t\tsuper(`TestItem with ID \"${id}\" is from controller \"${ctrlA}\" and cannot be added as a child of an item from controller \"${ctrlB}\".`);\n\t}\n}\n\nexport const createTestItemChildren = <T extends ITestItemLike>(api: ITestItemApi<T>, getApi: (item: T) => ITestItemApi<T>, checkCtor: Function): ITestItemChildren<T> => {\n\tlet mapped = new Map<string, T>();\n\n\treturn {\n\t\t/** @inheritdoc */\n\t\tget size() {\n\t\t\treturn mapped.size;\n\t\t},\n\n\t\t/** @inheritdoc */\n\t\tforEach(callback: (item: T, collection: ITestItemChildren<T>) => unknown, thisArg?: unknown) {\n\t\t\tfor (const item of mapped.values()) {\n\t\t\t\tcallback.call(thisArg, item, this);\n\t\t\t}\n\t\t},\n\n\t\t/** @inheritdoc */\n\t\t[Symbol.iterator](): IterableIterator<[string, T]> {\n\t\t\treturn mapped.entries();\n\t\t},\n\n\t\t/** @inheritdoc */\n\t\treplace(items: Iterable<T>) {\n\t\t\tconst newMapped = new Map<string, T>();\n\t\t\tconst toDelete = new Set(mapped.keys());\n\t\t\tconst bulk: ITestItemBulkReplace = { op: TestItemEventOp.Bulk, ops: [] };\n\n\t\t\tfor (const item of items) {\n\t\t\t\tif (!(item instanceof checkCtor)) {\n\t\t\t\t\tthrow new InvalidTestItemError(item.id);\n\t\t\t\t}\n\n\t\t\t\tconst itemController = getApi(item).controllerId;\n\t\t\t\tif (itemController !== api.controllerId) {\n\t\t\t\t\tthrow new MixedTestItemController(item.id, itemController, api.controllerId);\n\t\t\t\t}\n\n\t\t\t\tif (newMapped.has(item.id)) {\n\t\t\t\t\tthrow new DuplicateTestItemError(item.id);\n\t\t\t\t}\n\n\t\t\t\tnewMapped.set(item.id, item);\n\t\t\t\ttoDelete.delete(item.id);\n\t\t\t\tbulk.ops.push({ op: TestItemEventOp.Upsert, item });\n\t\t\t}\n\n\t\t\tfor (const id of toDelete.keys()) {\n\t\t\t\tbulk.ops.push({ op: TestItemEventOp.RemoveChild, id });\n\t\t\t}\n\n\t\t\tapi.listener?.(bulk);\n\n\t\t\t// important mutations come after firing, so if an error happens no\n\t\t\t// changes will be \"saved\":\n\t\t\tmapped = newMapped;\n\t\t},\n\n\n\t\t/** @inheritdoc */\n\t\tadd(item: T) {\n\t\t\tif (!(item instanceof checkCtor)) {\n\t\t\t\tthrow new InvalidTestItemError(item.id);\n\t\t\t}\n\n\t\t\tmapped.set(item.id, item);\n\t\t\tapi.listener?.({ op: TestItemEventOp.Upsert, item });\n\t\t},\n\n\t\t/** @inheritdoc */\n\t\tdelete(id: string) {\n\t\t\tif (mapped.delete(id)) {\n\t\t\t\tapi.listener?.({ op: TestItemEventOp.RemoveChild, id });\n\t\t\t}\n\t\t},\n\n\t\t/** @inheritdoc */\n\t\tget(itemId: string) {\n\t\t\treturn mapped.get(itemId);\n\t\t},\n\n\t\t/** JSON serialization function. */\n\t\ttoJSON() {\n\t\t\treturn Array.from(mapped.values());\n\t\t},\n\t};\n};\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ExtHostTestItemEvent, InvalidTestItemError } from 'vs/workbench/contrib/testing/common/testItemCollection';\nimport * as vscode from 'vscode';\n\nexport interface IExtHostTestItemApi {\n\tcontrollerId: string;\n\tparent?: vscode.TestItem;\n\tlistener?: (evt: ExtHostTestItemEvent) => void;\n}\n\nconst eventPrivateApis = new WeakMap<vscode.TestItem, IExtHostTestItemApi>();\n\nexport const createPrivateApiFor = (impl: vscode.TestItem, controllerId: string) => {\n\tconst api: IExtHostTestItemApi = { controllerId };\n\teventPrivateApis.set(impl, api);\n\treturn api;\n};\n\n/**\n * Gets the private API for a test item implementation. This implementation\n * is a managed object, but we keep a weakmap to avoid exposing any of the\n * internals to extensions.\n */\nexport const getPrivateApiFor = (impl: vscode.TestItem) => {\n\tconst api = eventPrivateApis.get(impl);\n\tif (!api) {\n\t\tthrow new InvalidTestItemError(impl?.id || '<unknown>');\n\t}\n\n\treturn api;\n};\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as paths from 'vs/base/common/path';\nimport * as process from 'vs/base/common/process';\nimport * as types from 'vs/base/common/types';\nimport * as objects from 'vs/base/common/objects';\nimport { IStringDictionary } from 'vs/base/common/collections';\nimport { IProcessEnvironment, isWindows, isMacintosh, isLinux } from 'vs/base/common/platform';\nimport { normalizeDriveLetter } from 'vs/base/common/labels';\nimport { localize } from 'vs/nls';\nimport { URI as uri } from 'vs/base/common/uri';\nimport { IConfigurationResolverService } from 'vs/workbench/services/configurationResolver/common/configurationResolver';\nimport { IWorkspaceFolder } from 'vs/platform/workspace/common/workspace';\nimport { ILabelService } from 'vs/platform/label/common/label';\nimport { replaceAsync } from 'vs/base/common/strings';\n\nexport interface IVariableResolveContext {\n\tgetFolderUri(folderName: string): uri | undefined;\n\tgetWorkspaceFolderCount(): number;\n\tgetConfigurationValue(folderUri: uri | undefined, section: string): string | undefined;\n\tgetAppRoot(): string | undefined;\n\tgetExecPath(): string | undefined;\n\tgetFilePath(): string | undefined;\n\tgetWorkspaceFolderPathForFile?(): string | undefined;\n\tgetSelectedText(): string | undefined;\n\tgetLineNumber(): string | undefined;\n\tgetExtension(id: string): Promise<{ readonly extensionLocation: uri } | undefined>;\n}\n\ntype Environment = { env: IProcessEnvironment | undefined; userHome: string | undefined };\n\nexport class AbstractVariableResolverService implements IConfigurationResolverService {\n\n\tstatic readonly VARIABLE_LHS = '${';\n\tstatic readonly VARIABLE_REGEXP = /\\$\\{(.*?)\\}/g;\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate _context: IVariableResolveContext;\n\tprivate _labelService?: ILabelService;\n\tprivate _envVariablesPromise?: Promise<IProcessEnvironment>;\n\tprivate _userHomePromise?: Promise<string>;\n\tprotected _contributedVariables: Map<string, () => Promise<string | undefined>> = new Map();\n\n\tconstructor(_context: IVariableResolveContext, _labelService?: ILabelService, _userHomePromise?: Promise<string>, _envVariablesPromise?: Promise<IProcessEnvironment>) {\n\t\tthis._context = _context;\n\t\tthis._labelService = _labelService;\n\t\tthis._userHomePromise = _userHomePromise;\n\t\tif (_envVariablesPromise) {\n\t\t\tthis._envVariablesPromise = _envVariablesPromise.then(envVariables => {\n\t\t\t\treturn this.prepareEnv(envVariables);\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate prepareEnv(envVariables: IProcessEnvironment): IProcessEnvironment {\n\t\t// windows env variables are case insensitive\n\t\tif (isWindows) {\n\t\t\tconst ev: IProcessEnvironment = Object.create(null);\n\t\t\tObject.keys(envVariables).forEach(key => {\n\t\t\t\tev[key.toLowerCase()] = envVariables[key];\n\t\t\t});\n\t\t\treturn ev;\n\t\t}\n\t\treturn envVariables;\n\t}\n\n\tpublic resolveWithEnvironment(environment: IProcessEnvironment, root: IWorkspaceFolder | undefined, value: string): Promise<string> {\n\t\treturn this.recursiveResolve({ env: this.prepareEnv(environment), userHome: undefined }, root ? root.uri : undefined, value);\n\t}\n\n\tpublic async resolveAsync(root: IWorkspaceFolder | undefined, value: string): Promise<string>;\n\tpublic async resolveAsync(root: IWorkspaceFolder | undefined, value: string[]): Promise<string[]>;\n\tpublic async resolveAsync(root: IWorkspaceFolder | undefined, value: IStringDictionary<string>): Promise<IStringDictionary<string>>;\n\tpublic async resolveAsync(root: IWorkspaceFolder | undefined, value: any): Promise<any> {\n\t\tconst environment: Environment = {\n\t\t\tenv: await this._envVariablesPromise,\n\t\t\tuserHome: await this._userHomePromise\n\t\t};\n\t\treturn this.recursiveResolve(environment, root ? root.uri : undefined, value);\n\t}\n\n\tprivate async resolveAnyBase(workspaceFolder: IWorkspaceFolder | undefined, config: any, commandValueMapping?: IStringDictionary<string>, resolvedVariables?: Map<string, string>): Promise<any> {\n\n\t\tconst result = objects.deepClone(config) as any;\n\n\t\t// hoist platform specific attributes to top level\n\t\tif (isWindows && result.windows) {\n\t\t\tObject.keys(result.windows).forEach(key => result[key] = result.windows[key]);\n\t\t} else if (isMacintosh && result.osx) {\n\t\t\tObject.keys(result.osx).forEach(key => result[key] = result.osx[key]);\n\t\t} else if (isLinux && result.linux) {\n\t\t\tObject.keys(result.linux).forEach(key => result[key] = result.linux[key]);\n\t\t}\n\n\t\t// delete all platform specific sections\n\t\tdelete result.windows;\n\t\tdelete result.osx;\n\t\tdelete result.linux;\n\n\t\t// substitute all variables recursively in string values\n\t\tconst environmentPromises: Environment = {\n\t\t\tenv: await this._envVariablesPromise,\n\t\t\tuserHome: await this._userHomePromise\n\t\t};\n\t\treturn this.recursiveResolve(environmentPromises, workspaceFolder ? workspaceFolder.uri : undefined, result, commandValueMapping, resolvedVariables);\n\t}\n\n\tpublic async resolveAnyAsync(workspaceFolder: IWorkspaceFolder | undefined, config: any, commandValueMapping?: IStringDictionary<string>): Promise<any> {\n\t\treturn this.resolveAnyBase(workspaceFolder, config, commandValueMapping);\n\t}\n\n\tpublic async resolveAnyMap(workspaceFolder: IWorkspaceFolder | undefined, config: any, commandValueMapping?: IStringDictionary<string>): Promise<{ newConfig: any; resolvedVariables: Map<string, string> }> {\n\t\tconst resolvedVariables = new Map<string, string>();\n\t\tconst newConfig = await this.resolveAnyBase(workspaceFolder, config, commandValueMapping, resolvedVariables);\n\t\treturn { newConfig, resolvedVariables };\n\t}\n\n\tpublic resolveWithInteractionReplace(folder: IWorkspaceFolder | undefined, config: any, section?: string, variables?: IStringDictionary<string>): Promise<any> {\n\t\tthrow new Error('resolveWithInteractionReplace not implemented.');\n\t}\n\n\tpublic resolveWithInteraction(folder: IWorkspaceFolder | undefined, config: any, section?: string, variables?: IStringDictionary<string>): Promise<Map<string, string> | undefined> {\n\t\tthrow new Error('resolveWithInteraction not implemented.');\n\t}\n\n\tpublic contributeVariable(variable: string, resolution: () => Promise<string | undefined>): void {\n\t\tif (this._contributedVariables.has(variable)) {\n\t\t\tthrow new Error('Variable ' + variable + ' is contributed twice.');\n\t\t} else {\n\t\t\tthis._contributedVariables.set(variable, resolution);\n\t\t}\n\t}\n\n\tprivate async recursiveResolve(environment: Environment, folderUri: uri | undefined, value: any, commandValueMapping?: IStringDictionary<string>, resolvedVariables?: Map<string, string>): Promise<any> {\n\t\tif (types.isString(value)) {\n\t\t\treturn this.resolveString(environment, folderUri, value, commandValueMapping, resolvedVariables);\n\t\t} else if (types.isArray(value)) {\n\t\t\treturn Promise.all(value.map(s => this.recursiveResolve(environment, folderUri, s, commandValueMapping, resolvedVariables)));\n\t\t} else if (types.isObject(value)) {\n\t\t\tconst result: IStringDictionary<string | IStringDictionary<string> | string[]> = Object.create(null);\n\t\t\tconst replaced = await Promise.all(Object.keys(value).map(async key => {\n\t\t\t\tconst replaced = await this.resolveString(environment, folderUri, key, commandValueMapping, resolvedVariables);\n\t\t\t\treturn [replaced, await this.recursiveResolve(environment, folderUri, value[key], commandValueMapping, resolvedVariables)] as const;\n\t\t\t}));\n\t\t\t// two step process to preserve object key order\n\t\t\tfor (const [key, value] of replaced) {\n\t\t\t\tresult[key] = value;\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\t\treturn value;\n\t}\n\n\tprivate resolveString(environment: Environment, folderUri: uri | undefined, value: string, commandValueMapping: IStringDictionary<string> | undefined, resolvedVariables?: Map<string, string>): Promise<string> {\n\t\t// loop through all variables occurrences in 'value'\n\t\treturn replaceAsync(value, AbstractVariableResolverService.VARIABLE_REGEXP, async (match: string, variable: string) => {\n\t\t\t// disallow attempted nesting, see #77289. This doesn't exclude variables that resolve to other variables.\n\t\t\tif (variable.includes(AbstractVariableResolverService.VARIABLE_LHS)) {\n\t\t\t\treturn match;\n\t\t\t}\n\n\t\t\tlet resolvedValue = await this.evaluateSingleVariable(environment, match, variable, folderUri, commandValueMapping);\n\n\t\t\tresolvedVariables?.set(variable, resolvedValue);\n\n\t\t\tif ((resolvedValue !== match) && types.isString(resolvedValue) && resolvedValue.match(AbstractVariableResolverService.VARIABLE_REGEXP)) {\n\t\t\t\tresolvedValue = await this.resolveString(environment, folderUri, resolvedValue, commandValueMapping, resolvedVariables);\n\t\t\t}\n\n\t\t\treturn resolvedValue;\n\t\t});\n\t}\n\n\tprivate fsPath(displayUri: uri): string {\n\t\treturn this._labelService ? this._labelService.getUriLabel(displayUri, { noPrefix: true }) : displayUri.fsPath;\n\t}\n\n\tprivate async evaluateSingleVariable(environment: Environment, match: string, variable: string, folderUri: uri | undefined, commandValueMapping: IStringDictionary<string> | undefined): Promise<string> {\n\n\t\t// try to separate variable arguments from variable name\n\t\tlet argument: string | undefined;\n\t\tconst parts = variable.split(':');\n\t\tif (parts.length > 1) {\n\t\t\tvariable = parts[0];\n\t\t\targument = parts[1];\n\t\t}\n\n\t\t// common error handling for all variables that require an open editor\n\t\tconst getFilePath = (): string => {\n\n\t\t\tconst filePath = this._context.getFilePath();\n\t\t\tif (filePath) {\n\t\t\t\treturn filePath;\n\t\t\t}\n\t\t\tthrow new Error(localize('canNotResolveFile', \"Variable {0} can not be resolved. Please open an editor.\", match));\n\t\t};\n\n\t\t// common error handling for all variables that require an open editor\n\t\tconst getFolderPathForFile = (): string => {\n\n\t\t\tconst filePath = getFilePath();\t\t// throws error if no editor open\n\t\t\tif (this._context.getWorkspaceFolderPathForFile) {\n\t\t\t\tconst folderPath = this._context.getWorkspaceFolderPathForFile();\n\t\t\t\tif (folderPath) {\n\t\t\t\t\treturn folderPath;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthrow new Error(localize('canNotResolveFolderForFile', \"Variable {0}: can not find workspace folder of '{1}'.\", match, paths.basename(filePath)));\n\t\t};\n\n\t\t// common error handling for all variables that require an open folder and accept a folder name argument\n\t\tconst getFolderUri = (): uri => {\n\n\t\t\tif (argument) {\n\t\t\t\tconst folder = this._context.getFolderUri(argument);\n\t\t\t\tif (folder) {\n\t\t\t\t\treturn folder;\n\t\t\t\t}\n\t\t\t\tthrow new Error(localize('canNotFindFolder', \"Variable {0} can not be resolved. No such folder '{1}'.\", match, argument));\n\t\t\t}\n\n\t\t\tif (folderUri) {\n\t\t\t\treturn folderUri;\n\t\t\t}\n\n\t\t\tif (this._context.getWorkspaceFolderCount() > 1) {\n\t\t\t\tthrow new Error(localize('canNotResolveWorkspaceFolderMultiRoot', \"Variable {0} can not be resolved in a multi folder workspace. Scope this variable using ':' and a workspace folder name.\", match));\n\t\t\t}\n\t\t\tthrow new Error(localize('canNotResolveWorkspaceFolder', \"Variable {0} can not be resolved. Please open a folder.\", match));\n\t\t};\n\n\n\t\tswitch (variable) {\n\n\t\t\tcase 'env':\n\t\t\t\tif (argument) {\n\t\t\t\t\tif (environment.env) {\n\t\t\t\t\t\t// Depending on the source of the environment, on Windows, the values may all be lowercase.\n\t\t\t\t\t\tconst env = environment.env[isWindows ? argument.toLowerCase() : argument];\n\t\t\t\t\t\tif (types.isString(env)) {\n\t\t\t\t\t\t\treturn env;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// For `env` we should do the same as a normal shell does - evaluates undefined envs to an empty string #46436\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\t\t\t\tthrow new Error(localize('missingEnvVarName', \"Variable {0} can not be resolved because no environment variable name is given.\", match));\n\n\t\t\tcase 'config':\n\t\t\t\tif (argument) {\n\t\t\t\t\tconst config = this._context.getConfigurationValue(folderUri, argument);\n\t\t\t\t\tif (types.isUndefinedOrNull(config)) {\n\t\t\t\t\t\tthrow new Error(localize('configNotFound', \"Variable {0} can not be resolved because setting '{1}' not found.\", match, argument));\n\t\t\t\t\t}\n\t\t\t\t\tif (types.isObject(config)) {\n\t\t\t\t\t\tthrow new Error(localize('configNoString', \"Variable {0} can not be resolved because '{1}' is a structured value.\", match, argument));\n\t\t\t\t\t}\n\t\t\t\t\treturn config;\n\t\t\t\t}\n\t\t\t\tthrow new Error(localize('missingConfigName', \"Variable {0} can not be resolved because no settings name is given.\", match));\n\n\t\t\tcase 'command':\n\t\t\t\treturn this.resolveFromMap(match, argument, commandValueMapping, 'command');\n\n\t\t\tcase 'input':\n\t\t\t\treturn this.resolveFromMap(match, argument, commandValueMapping, 'input');\n\n\t\t\tcase 'extensionInstallFolder':\n\t\t\t\tif (argument) {\n\t\t\t\t\tconst ext = await this._context.getExtension(argument);\n\t\t\t\t\tif (!ext) {\n\t\t\t\t\t\tthrow new Error(localize('extensionNotInstalled', \"Variable {0} can not be resolved because the extension {1} is not installed.\", match, argument));\n\t\t\t\t\t}\n\t\t\t\t\treturn this.fsPath(ext.extensionLocation);\n\t\t\t\t}\n\t\t\t\tthrow new Error(localize('missingExtensionName', \"Variable {0} can not be resolved because no extension name is given.\", match));\n\n\t\t\tdefault: {\n\n\t\t\t\tswitch (variable) {\n\t\t\t\t\tcase 'workspaceRoot':\n\t\t\t\t\tcase 'workspaceFolder':\n\t\t\t\t\t\treturn normalizeDriveLetter(this.fsPath(getFolderUri()));\n\n\t\t\t\t\tcase 'cwd':\n\t\t\t\t\t\treturn ((folderUri || argument) ? normalizeDriveLetter(this.fsPath(getFolderUri())) : process.cwd());\n\n\t\t\t\t\tcase 'workspaceRootFolderName':\n\t\t\t\t\tcase 'workspaceFolderBasename':\n\t\t\t\t\t\treturn paths.basename(this.fsPath(getFolderUri()));\n\n\t\t\t\t\tcase 'userHome': {\n\t\t\t\t\t\tif (environment.userHome) {\n\t\t\t\t\t\t\treturn environment.userHome;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthrow new Error(localize('canNotResolveUserHome', \"Variable {0} can not be resolved. UserHome path is not defined\", match));\n\t\t\t\t\t}\n\n\t\t\t\t\tcase 'lineNumber': {\n\t\t\t\t\t\tconst lineNumber = this._context.getLineNumber();\n\t\t\t\t\t\tif (lineNumber) {\n\t\t\t\t\t\t\treturn lineNumber;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthrow new Error(localize('canNotResolveLineNumber', \"Variable {0} can not be resolved. Make sure to have a line selected in the active editor.\", match));\n\t\t\t\t\t}\n\t\t\t\t\tcase 'selectedText': {\n\t\t\t\t\t\tconst selectedText = this._context.getSelectedText();\n\t\t\t\t\t\tif (selectedText) {\n\t\t\t\t\t\t\treturn selectedText;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthrow new Error(localize('canNotResolveSelectedText', \"Variable {0} can not be resolved. Make sure to have some text selected in the active editor.\", match));\n\t\t\t\t\t}\n\t\t\t\t\tcase 'file':\n\t\t\t\t\t\treturn getFilePath();\n\n\t\t\t\t\tcase 'fileWorkspaceFolder':\n\t\t\t\t\t\treturn getFolderPathForFile();\n\n\t\t\t\t\tcase 'relativeFile':\n\t\t\t\t\t\tif (folderUri || argument) {\n\t\t\t\t\t\t\treturn paths.relative(this.fsPath(getFolderUri()), getFilePath());\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn getFilePath();\n\n\t\t\t\t\tcase 'relativeFileDirname': {\n\t\t\t\t\t\tconst dirname = paths.dirname(getFilePath());\n\t\t\t\t\t\tif (folderUri || argument) {\n\t\t\t\t\t\t\tconst relative = paths.relative(this.fsPath(getFolderUri()), dirname);\n\t\t\t\t\t\t\treturn relative.length === 0 ? '.' : relative;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn dirname;\n\t\t\t\t\t}\n\t\t\t\t\tcase 'fileDirname':\n\t\t\t\t\t\treturn paths.dirname(getFilePath());\n\n\t\t\t\t\tcase 'fileExtname':\n\t\t\t\t\t\treturn paths.extname(getFilePath());\n\n\t\t\t\t\tcase 'fileBasename':\n\t\t\t\t\t\treturn paths.basename(getFilePath());\n\n\t\t\t\t\tcase 'fileBasenameNoExtension': {\n\t\t\t\t\t\tconst basename = paths.basename(getFilePath());\n\t\t\t\t\t\treturn (basename.slice(0, basename.length - paths.extname(basename).length));\n\t\t\t\t\t}\n\t\t\t\t\tcase 'fileDirnameBasename':\n\t\t\t\t\t\treturn paths.basename(paths.dirname(getFilePath()));\n\n\t\t\t\t\tcase 'execPath': {\n\t\t\t\t\t\tconst ep = this._context.getExecPath();\n\t\t\t\t\t\tif (ep) {\n\t\t\t\t\t\t\treturn ep;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn match;\n\t\t\t\t\t}\n\t\t\t\t\tcase 'execInstallFolder': {\n\t\t\t\t\t\tconst ar = this._context.getAppRoot();\n\t\t\t\t\t\tif (ar) {\n\t\t\t\t\t\t\treturn ar;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn match;\n\t\t\t\t\t}\n\t\t\t\t\tcase 'pathSeparator':\n\t\t\t\t\t\treturn paths.sep;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst key = argument ? `${variable}:${argument}` : variable;\n\t\t\t\t\t\t\treturn this.resolveFromMap(match, key, commandValueMapping, undefined);\n\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\treturn match;\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate resolveFromMap(match: string, argument: string | undefined, commandValueMapping: IStringDictionary<string> | undefined, prefix: string | undefined): string {\n\t\tif (argument && commandValueMapping) {\n\t\t\tconst v = (prefix === undefined) ? commandValueMapping[argument] : commandValueMapping[prefix + ':' + argument];\n\t\t\tif (typeof v === 'string') {\n\t\t\t\treturn v;\n\t\t\t}\n\t\t\tthrow new Error(localize('noValueForCommand', \"Variable {0} can not be resolved because the command has no value.\", match));\n\t\t}\n\t\treturn match;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Event } from 'vs/base/common/event';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { IEditorPane, GroupIdentifier, EditorInputWithOptions, CloseDirection, IEditorPartOptions, IEditorPartOptionsChangeEvent, EditorsOrder, IVisibleEditorPane, IEditorCloseEvent, IUntypedEditorInput, isEditorInput, IEditorWillMoveEvent, IEditorWillOpenEvent, IMatchEditorOptions, IActiveEditorChangeEvent, IFindEditorOptions } from 'vs/workbench/common/editor';\nimport { EditorInput } from 'vs/workbench/common/editor/editorInput';\nimport { IEditorOptions } from 'vs/platform/editor/common/editor';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { IDimension } from 'vs/editor/common/core/dimension';\nimport { IDisposable } from 'vs/base/common/lifecycle';\nimport { IContextKeyService } from 'vs/platform/contextkey/common/contextkey';\nimport { URI } from 'vs/base/common/uri';\nimport { IGroupModelChangeEvent } from 'vs/workbench/common/editor/editorGroupModel';\n\nexport const IEditorGroupsService = createDecorator<IEditorGroupsService>('editorGroupsService');\n\nexport const enum GroupDirection {\n\tUP,\n\tDOWN,\n\tLEFT,\n\tRIGHT\n}\n\nexport const enum GroupOrientation {\n\tHORIZONTAL,\n\tVERTICAL\n}\n\nexport const enum GroupLocation {\n\tFIRST,\n\tLAST,\n\tNEXT,\n\tPREVIOUS\n}\n\nexport interface IFindGroupScope {\n\tdirection?: GroupDirection;\n\tlocation?: GroupLocation;\n}\n\nexport const enum GroupsArrangement {\n\n\t/**\n\t * Make the current active group consume the maximum\n\t * amount of space possible.\n\t */\n\tMAXIMIZE,\n\n\t/**\n\t * Size all groups evenly.\n\t */\n\tEVEN,\n\n\t/**\n\t * Will behave like MINIMIZE_OTHERS if the active\n\t * group is not already maximized and EVEN otherwise\n\t */\n\tTOGGLE\n}\n\nexport interface GroupLayoutArgument {\n\tsize?: number;\n\tgroups?: GroupLayoutArgument[];\n}\n\nexport interface EditorGroupLayout {\n\torientation: GroupOrientation;\n\tgroups: GroupLayoutArgument[];\n}\n\nexport interface IAddGroupOptions {\n\tactivate?: boolean;\n}\n\nexport const enum MergeGroupMode {\n\tCOPY_EDITORS,\n\tMOVE_EDITORS\n}\n\nexport interface IMergeGroupOptions {\n\tmode?: MergeGroupMode;\n\tindex?: number;\n}\n\nexport interface ICloseEditorOptions {\n\tpreserveFocus?: boolean;\n}\n\nexport type ICloseEditorsFilter = {\n\texcept?: EditorInput;\n\tdirection?: CloseDirection;\n\tsavedOnly?: boolean;\n\texcludeSticky?: boolean;\n};\n\nexport interface ICloseAllEditorsOptions {\n\texcludeSticky?: boolean;\n}\n\nexport interface IEditorReplacement {\n\teditor: EditorInput;\n\treplacement: EditorInput;\n\toptions?: IEditorOptions;\n\n\t/**\n\t * Skips asking the user for confirmation and doesn't\n\t * save the document. Only use this if you really need to!\n\t */\n\tforceReplaceDirty?: boolean;\n}\n\nexport function isEditorReplacement(replacement: unknown): replacement is IEditorReplacement {\n\tconst candidate = replacement as IEditorReplacement | undefined;\n\n\treturn isEditorInput(candidate?.editor) && isEditorInput(candidate?.replacement);\n}\n\nexport const enum GroupsOrder {\n\n\t/**\n\t * Groups sorted by creation order (oldest one first)\n\t */\n\tCREATION_TIME,\n\n\t/**\n\t * Groups sorted by most recent activity (most recent active first)\n\t */\n\tMOST_RECENTLY_ACTIVE,\n\n\t/**\n\t * Groups sorted by grid widget order\n\t */\n\tGRID_APPEARANCE\n}\n\nexport interface IEditorSideGroup {\n\n\t/**\n\t * Open an editor in this group.\n\t *\n\t * @returns a promise that resolves around an IEditor instance unless\n\t * the call failed, or the editor was not opened as active editor.\n\t */\n\topenEditor(editor: EditorInput, options?: IEditorOptions): Promise<IEditorPane | undefined>;\n}\n\nexport interface IEditorGroupsService {\n\n\treadonly _serviceBrand: undefined;\n\n\t/**\n\t * An event for when the active editor group changes. The active editor\n\t * group is the default location for new editors to open.\n\t */\n\treadonly onDidChangeActiveGroup: Event<IEditorGroup>;\n\n\t/**\n\t * An event for when a new group was added.\n\t */\n\treadonly onDidAddGroup: Event<IEditorGroup>;\n\n\t/**\n\t * An event for when a group was removed.\n\t */\n\treadonly onDidRemoveGroup: Event<IEditorGroup>;\n\n\t/**\n\t * An event for when a group was moved.\n\t */\n\treadonly onDidMoveGroup: Event<IEditorGroup>;\n\n\t/**\n\t * An event for when a group gets activated.\n\t */\n\treadonly onDidActivateGroup: Event<IEditorGroup>;\n\n\t/**\n\t * An event for when the group container is layed out.\n\t */\n\treadonly onDidLayout: Event<IDimension>;\n\n\t/**\n\t * An event for when the group container is scrolled.\n\t */\n\treadonly onDidScroll: Event<void>;\n\n\t/**\n\t * An event for when the index of a group changes.\n\t */\n\treadonly onDidChangeGroupIndex: Event<IEditorGroup>;\n\n\t/**\n\t * An event for when the locked state of a group changes.\n\t */\n\treadonly onDidChangeGroupLocked: Event<IEditorGroup>;\n\n\t/**\n\t * The size of the editor groups area.\n\t */\n\treadonly contentDimension: IDimension;\n\n\t/**\n\t * An active group is the default location for new editors to open.\n\t */\n\treadonly activeGroup: IEditorGroup;\n\n\t/**\n\t * A side group allows a subset of methods on a group that is either\n\t * created to the side or picked if already there.\n\t */\n\treadonly sideGroup: IEditorSideGroup;\n\n\t/**\n\t * All groups that are currently visible in the editor area in the\n\t * order of their creation (oldest first).\n\t */\n\treadonly groups: readonly IEditorGroup[];\n\n\t/**\n\t * The number of editor groups that are currently opened.\n\t */\n\treadonly count: number;\n\n\t/**\n\t * The current layout orientation of the root group.\n\t */\n\treadonly orientation: GroupOrientation;\n\n\t/**\n\t * A property that indicates when groups have been created\n\t * and are ready to be used.\n\t */\n\treadonly isReady: boolean;\n\n\t/**\n\t * A promise that resolves when groups have been created\n\t * and are ready to be used.\n\t *\n\t * Await this promise to safely work on the editor groups model\n\t * (for example, install editor group listeners).\n\t *\n\t * Use the `whenRestored` property to await visible editors\n\t * having fully resolved.\n\t */\n\treadonly whenReady: Promise<void>;\n\n\t/**\n\t * A promise that resolves when groups have been restored.\n\t *\n\t * For groups with active editor, the promise will resolve\n\t * when the visible editor has finished to resolve.\n\t *\n\t * Use the `whenReady` property to not await editors to\n\t * resolve.\n\t */\n\treadonly whenRestored: Promise<void>;\n\n\t/**\n\t * Find out if the editor group service has UI state to restore\n\t * from a previous session.\n\t */\n\treadonly hasRestorableState: boolean;\n\n\t/**\n\t * Get all groups that are currently visible in the editor area.\n\t *\n\t * @param order the order of the editors to use\n\t */\n\tgetGroups(order: GroupsOrder): readonly IEditorGroup[];\n\n\t/**\n\t * Allows to convert a group identifier to a group.\n\t */\n\tgetGroup(identifier: GroupIdentifier): IEditorGroup | undefined;\n\n\t/**\n\t * Set a group as active. An active group is the default location for new editors to open.\n\t */\n\tactivateGroup(group: IEditorGroup | GroupIdentifier): IEditorGroup;\n\n\t/**\n\t * Returns the size of a group.\n\t */\n\tgetSize(group: IEditorGroup | GroupIdentifier): { width: number; height: number };\n\n\t/**\n\t * Sets the size of a group.\n\t */\n\tsetSize(group: IEditorGroup | GroupIdentifier, size: { width: number; height: number }): void;\n\n\t/**\n\t * Arrange all groups according to the provided arrangement.\n\t */\n\tarrangeGroups(arrangement: GroupsArrangement): void;\n\n\t/**\n\t * Applies the provided layout by either moving existing groups or creating new groups.\n\t */\n\tapplyLayout(layout: EditorGroupLayout): void;\n\n\t/**\n\t * Enable or disable centered editor layout.\n\t */\n\tcenterLayout(active: boolean): void;\n\n\t/**\n\t * Find out if the editor layout is currently centered.\n\t */\n\tisLayoutCentered(): boolean;\n\n\t/**\n\t * Sets the orientation of the root group to be either vertical or horizontal.\n\t */\n\tsetGroupOrientation(orientation: GroupOrientation): void;\n\n\t/**\n\t * Find a groupd in a specific scope:\n\t * * `GroupLocation.FIRST`: the first group\n\t * * `GroupLocation.LAST`: the last group\n\t * * `GroupLocation.NEXT`: the next group from either the active one or `source`\n\t * * `GroupLocation.PREVIOUS`: the previous group from either the active one or `source`\n\t * * `GroupDirection.UP`: the next group above the active one or `source`\n\t * * `GroupDirection.DOWN`: the next group below the active one or `source`\n\t * * `GroupDirection.LEFT`: the next group to the left of the active one or `source`\n\t * * `GroupDirection.RIGHT`: the next group to the right of the active one or `source`\n\t *\n\t * @param scope the scope of the group to search in\n\t * @param source optional source to search from\n\t * @param wrap optionally wrap around if reaching the edge of groups\n\t */\n\tfindGroup(scope: IFindGroupScope, source?: IEditorGroup | GroupIdentifier, wrap?: boolean): IEditorGroup | undefined;\n\n\t/**\n\t * Add a new group to the editor area. A new group is added by splitting a provided one in\n\t * one of the four directions.\n\t *\n\t * @param location the group from which to split to add a new group\n\t * @param direction the direction of where to split to\n\t * @param options configure the newly group with options\n\t */\n\taddGroup(location: IEditorGroup | GroupIdentifier, direction: GroupDirection, options?: IAddGroupOptions): IEditorGroup;\n\n\t/**\n\t * Remove a group from the editor area.\n\t */\n\tremoveGroup(group: IEditorGroup | GroupIdentifier): void;\n\n\t/**\n\t * Move a group to a new group in the editor area.\n\t *\n\t * @param group the group to move\n\t * @param location the group from which to split to add the moved group\n\t * @param direction the direction of where to split to\n\t */\n\tmoveGroup(group: IEditorGroup | GroupIdentifier, location: IEditorGroup | GroupIdentifier, direction: GroupDirection): IEditorGroup;\n\n\t/**\n\t * Merge the editors of a group into a target group. By default, all editors will\n\t * move and the source group will close. This behaviour can be configured via the\n\t * `IMergeGroupOptions` options.\n\t *\n\t * @param group the group to merge\n\t * @param target the target group to merge into\n\t * @param options controls how the merge should be performed. by default all editors\n\t * will be moved over to the target and the source group will close. Configure to\n\t * `MOVE_EDITORS_KEEP_GROUP` to prevent the source group from closing. Set to\n\t * `COPY_EDITORS` to copy the editors into the target instead of moding them.\n\t */\n\tmergeGroup(group: IEditorGroup | GroupIdentifier, target: IEditorGroup | GroupIdentifier, options?: IMergeGroupOptions): IEditorGroup;\n\n\t/**\n\t * Merge all editor groups into the active one.\n\t */\n\tmergeAllGroups(): IEditorGroup;\n\n\t/**\n\t * Copy a group to a new group in the editor area.\n\t *\n\t * @param group the group to copy\n\t * @param location the group from which to split to add the copied group\n\t * @param direction the direction of where to split to\n\t */\n\tcopyGroup(group: IEditorGroup | GroupIdentifier, location: IEditorGroup | GroupIdentifier, direction: GroupDirection): IEditorGroup;\n\n\t/**\n\t * Access the options of the editor part.\n\t */\n\treadonly partOptions: IEditorPartOptions;\n\n\t/**\n\t * An event that notifies when editor part options change.\n\t */\n\treadonly onDidChangeEditorPartOptions: Event<IEditorPartOptionsChangeEvent>;\n\n\t/**\n\t * Enforce editor part options temporarily.\n\t */\n\tenforcePartOptions(options: IEditorPartOptions): IDisposable;\n}\n\nexport const enum OpenEditorContext {\n\tNEW_EDITOR = 1,\n\tMOVE_EDITOR = 2,\n\tCOPY_EDITOR = 3\n}\n\nexport interface IEditorGroup {\n\n\t/**\n\t * An event which fires whenever the underlying group model changes.\n\t */\n\treadonly onDidModelChange: Event<IGroupModelChangeEvent>;\n\n\t/**\n\t * An event that is fired when the group gets disposed.\n\t */\n\treadonly onWillDispose: Event<void>;\n\n\t/**\n\t * An event that is fired when the active editor in the group changed.\n\t */\n\treadonly onDidActiveEditorChange: Event<IActiveEditorChangeEvent>;\n\n\t/**\n\t * An event that is fired when an editor is about to close.\n\t */\n\treadonly onWillCloseEditor: Event<IEditorCloseEvent>;\n\n\t/**\n\t * An event that is fired when an editor is closed.\n\t */\n\treadonly onDidCloseEditor: Event<IEditorCloseEvent>;\n\n\t/**\n\t * An event that is fired when an editor is about to move to\n\t * a different group.\n\t */\n\treadonly onWillMoveEditor: Event<IEditorWillMoveEvent>;\n\n\t/**\n\t * An event that is fired when an editor is about to be opened\n\t * in the group.\n\t */\n\treadonly onWillOpenEditor: Event<IEditorWillOpenEvent>;\n\n\t/**\n\t * A unique identifier of this group that remains identical even if the\n\t * group is moved to different locations.\n\t */\n\treadonly id: GroupIdentifier;\n\n\t/**\n\t * A number that indicates the position of this group in the visual\n\t * order of groups from left to right and top to bottom. The lowest\n\t * index will likely be top-left while the largest index in most\n\t * cases should be bottom-right, but that depends on the grid.\n\t */\n\treadonly index: number;\n\n\t/**\n\t * A human readable label for the group. This label can change depending\n\t * on the layout of all editor groups. Clients should listen on the\n\t * `onDidGroupModelChange` event to react to that.\n\t */\n\treadonly label: string;\n\n\t/**\n\t * A human readable label for the group to be used by screen readers.\n\t */\n\treadonly ariaLabel: string;\n\n\t/**\n\t * The active editor pane is the currently visible editor pane of the group.\n\t */\n\treadonly activeEditorPane: IVisibleEditorPane | undefined;\n\n\t/**\n\t * The active editor is the currently visible editor of the group\n\t * within the current active editor pane.\n\t */\n\treadonly activeEditor: EditorInput | null;\n\n\t/**\n\t * The editor in the group that is in preview mode if any. There can\n\t * only ever be one editor in preview mode.\n\t */\n\treadonly previewEditor: EditorInput | null;\n\n\t/**\n\t * The number of opened editors in this group.\n\t */\n\treadonly count: number;\n\n\t/**\n\t * Whether the group has editors or not.\n\t */\n\treadonly isEmpty: boolean;\n\n\t/**\n\t * Whether this editor group is locked or not. Locked editor groups\n\t * will only be considered for editors to open in when the group is\n\t * explicitly provided for the editor.\n\t *\n\t * Note: editor group locking only applies when more than one group\n\t * is opened.\n\t */\n\treadonly isLocked: boolean;\n\n\t/**\n\t * The number of sticky editors in this group.\n\t */\n\treadonly stickyCount: number;\n\n\t/**\n\t * All opened editors in the group in sequential order of their appearance.\n\t */\n\treadonly editors: readonly EditorInput[];\n\n\t/**\n\t * The scoped context key service for this group.\n\t */\n\treadonly scopedContextKeyService: IContextKeyService;\n\n\t/**\n\t * Get all editors that are currently opened in the group.\n\t *\n\t * @param order the order of the editors to use\n\t * @param options options to select only specific editors as instructed\n\t */\n\tgetEditors(order: EditorsOrder, options?: { excludeSticky?: boolean }): readonly EditorInput[];\n\n\t/**\n\t * Finds all editors for the given resource that are currently\n\t * opened in the group. This method will return an entry for\n\t * each editor that reports a `resource` that matches the\n\t * provided one.\n\t *\n\t * @param resource the resource of the editor to find\n\t * @param options whether to support side by side editors or not\n\t */\n\tfindEditors(resource: URI, options?: IFindEditorOptions): readonly EditorInput[];\n\n\t/**\n\t * Returns the editor at a specific index of the group.\n\t */\n\tgetEditorByIndex(index: number): EditorInput | undefined;\n\n\t/**\n\t * Returns the index of the editor in the group or -1 if not opened.\n\t */\n\tgetIndexOfEditor(editor: EditorInput): number;\n\n\t/**\n\t * Whether the editor is the first in the group.\n\t */\n\tisFirst(editor: EditorInput): boolean;\n\n\t/**\n\t * Whether the editor is the last in the group.\n\t */\n\tisLast(editor: EditorInput): boolean;\n\n\t/**\n\t * Open an editor in this group.\n\t *\n\t * @returns a promise that resolves around an IEditor instance unless\n\t * the call failed, or the editor was not opened as active editor.\n\t */\n\topenEditor(editor: EditorInput, options?: IEditorOptions): Promise<IEditorPane | undefined>;\n\n\t/**\n\t * Opens editors in this group.\n\t *\n\t * @returns a promise that resolves around an IEditor instance unless\n\t * the call failed, or the editor was not opened as active editor. Since\n\t * a group can only ever have one active editor, even if many editors are\n\t * opened, the result will only be one editor.\n\t */\n\topenEditors(editors: EditorInputWithOptions[]): Promise<IEditorPane | undefined>;\n\n\t/**\n\t * Find out if the provided editor is pinned in the group.\n\t */\n\tisPinned(editorOrIndex: EditorInput | number): boolean;\n\n\t/**\n\t * Find out if the provided editor or index of editor is sticky in the group.\n\t */\n\tisSticky(editorOrIndex: EditorInput | number): boolean;\n\n\t/**\n\t * Find out if the provided editor is active in the group.\n\t */\n\tisActive(editor: EditorInput | IUntypedEditorInput): boolean;\n\n\t/**\n\t * Find out if a certain editor is included in the group.\n\t *\n\t * @param candidate the editor to find\n\t * @param options fine tune how to match editors\n\t */\n\tcontains(candidate: EditorInput | IUntypedEditorInput, options?: IMatchEditorOptions): boolean;\n\n\t/**\n\t * Move an editor from this group either within this group or to another group.\n\t */\n\tmoveEditor(editor: EditorInput, target: IEditorGroup, options?: IEditorOptions): void;\n\n\t/**\n\t * Move editors from this group either within this group or to another group.\n\t */\n\tmoveEditors(editors: EditorInputWithOptions[], target: IEditorGroup): void;\n\n\t/**\n\t * Copy an editor from this group to another group.\n\t *\n\t * Note: It is currently not supported to show the same editor more than once in the same group.\n\t */\n\tcopyEditor(editor: EditorInput, target: IEditorGroup, options?: IEditorOptions): void;\n\n\t/**\n\t * Copy editors from this group to another group.\n\t *\n\t * Note: It is currently not supported to show the same editor more than once in the same group.\n\t */\n\tcopyEditors(editors: EditorInputWithOptions[], target: IEditorGroup): void;\n\n\t/**\n\t * Close an editor from the group. This may trigger a confirmation dialog if\n\t * the editor is dirty and thus returns a promise as value.\n\t *\n\t * @param editor the editor to close, or the currently active editor\n\t * if unspecified.\n\t *\n\t * @returns a promise when the editor is closed or not. If `true`, the editor\n\t * is closed and if `false` there was a veto closing the editor, e.g. when it\n\t * is dirty.\n\t */\n\tcloseEditor(editor?: EditorInput, options?: ICloseEditorOptions): Promise<boolean>;\n\n\t/**\n\t * Closes specific editors in this group. This may trigger a confirmation dialog if\n\t * there are dirty editors and thus returns a promise as value.\n\t *\n\t * @returns a promise whether the editors were closed or not. If `true`, the editors\n\t * were closed and if `false` there was a veto closing the editors, e.g. when one\n\t * is dirty.\n\t */\n\tcloseEditors(editors: EditorInput[] | ICloseEditorsFilter, options?: ICloseEditorOptions): Promise<boolean>;\n\n\t/**\n\t * Closes all editors from the group. This may trigger a confirmation dialog if\n\t * there are dirty editors and thus returns a promise as value.\n\t *\n\t * @returns a promise when all editors are closed.\n\t */\n\tcloseAllEditors(options?: ICloseAllEditorsOptions): Promise<boolean>;\n\n\t/**\n\t * Replaces editors in this group with the provided replacement.\n\t *\n\t * @param editors the editors to replace\n\t *\n\t * @returns a promise that is resolved when the replaced active\n\t * editor (if any) has finished loading.\n\t */\n\treplaceEditors(editors: IEditorReplacement[]): Promise<void>;\n\n\t/**\n\t * Set an editor to be pinned. A pinned editor is not replaced\n\t * when another editor opens at the same location.\n\t *\n\t * @param editor the editor to pin, or the currently active editor\n\t * if unspecified.\n\t */\n\tpinEditor(editor?: EditorInput): void;\n\n\t/**\n\t * Set an editor to be sticky. A sticky editor is showing in the beginning\n\t * of the tab stripe and will not be impacted by close operations.\n\t *\n\t * @param editor the editor to make sticky, or the currently active editor\n\t * if unspecified.\n\t */\n\tstickEditor(editor?: EditorInput): void;\n\n\t/**\n\t * Set an editor to be non-sticky and thus moves back to a location after\n\t * sticky editors and can be closed normally.\n\t *\n\t * @param editor the editor to make unsticky, or the currently active editor\n\t * if unspecified.\n\t */\n\tunstickEditor(editor?: EditorInput): void;\n\n\t/**\n\t * Whether this editor group should be locked or not.\n\t *\n\t * See {@linkcode IEditorGroup.isLocked `isLocked`}\n\t */\n\tlock(locked: boolean): void;\n\n\t/**\n\t * Move keyboard focus into the group.\n\t */\n\tfocus(): void;\n}\n\nexport function isEditorGroup(obj: unknown): obj is IEditorGroup {\n\tconst group = obj as IEditorGroup | undefined;\n\n\treturn !!group && typeof group.id === 'number' && Array.isArray(group.editors);\n}\n\n//#region Editor Group Helpers\n\nexport function preferredSideBySideGroupDirection(configurationService: IConfigurationService): GroupDirection.DOWN | GroupDirection.RIGHT {\n\tconst openSideBySideDirection = configurationService.getValue('workbench.editor.openSideBySideDirection');\n\n\tif (openSideBySideDirection === 'down') {\n\t\treturn GroupDirection.DOWN;\n\t}\n\n\treturn GroupDirection.RIGHT;\n}\n\n//#endregion\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { IResourceEditorInput, IEditorOptions, IResourceEditorInputIdentifier, ITextResourceEditorInput } from 'vs/platform/editor/common/editor';\nimport { IEditorPane, GroupIdentifier, IUntitledTextResourceEditorInput, IResourceDiffEditorInput, ITextDiffEditorPane, IEditorIdentifier, ISaveOptions, IRevertOptions, EditorsOrder, IVisibleEditorPane, IEditorCloseEvent, IUntypedEditorInput, IFindEditorOptions } from 'vs/workbench/common/editor';\nimport { EditorInput } from 'vs/workbench/common/editor/editorInput';\nimport { Event } from 'vs/base/common/event';\nimport { IEditor, IDiffEditor } from 'vs/editor/common/editorCommon';\nimport { ICloseEditorOptions, IEditorGroup, isEditorGroup } from 'vs/workbench/services/editor/common/editorGroupsService';\nimport { URI } from 'vs/base/common/uri';\nimport { IGroupModelChangeEvent } from 'vs/workbench/common/editor/editorGroupModel';\n\nexport const IEditorService = createDecorator<IEditorService>('editorService');\n\n/**\n * Open an editor in the currently active group.\n */\nexport const ACTIVE_GROUP = -1;\nexport type ACTIVE_GROUP_TYPE = typeof ACTIVE_GROUP;\n\n/**\n * Open an editor to the side of the active group.\n */\nexport const SIDE_GROUP = -2;\nexport type SIDE_GROUP_TYPE = typeof SIDE_GROUP;\n\nexport type PreferredGroup = IEditorGroup | GroupIdentifier | SIDE_GROUP_TYPE | ACTIVE_GROUP_TYPE;\n\nexport function isPreferredGroup(obj: unknown): obj is PreferredGroup {\n\tconst candidate = obj as PreferredGroup | undefined;\n\n\treturn typeof obj === 'number' || isEditorGroup(candidate);\n}\n\nexport interface ISaveEditorsOptions extends ISaveOptions {\n\n\t/**\n\t * If true, will ask for a location of the editor to save to.\n\t */\n\treadonly saveAs?: boolean;\n}\n\nexport interface IUntypedEditorReplacement {\n\n\t/**\n\t * The editor to replace.\n\t */\n\treadonly editor: EditorInput;\n\n\t/**\n\t * The replacement for the editor.\n\t */\n\treadonly replacement: IUntypedEditorInput;\n\n\t/**\n\t * Skips asking the user for confirmation and doesn't\n\t * save the document. Only use this if you really need to!\n\t*/\n\tforceReplaceDirty?: boolean;\n}\n\nexport interface IBaseSaveRevertAllEditorOptions {\n\n\t/**\n\t * Whether to include untitled editors as well.\n\t */\n\treadonly includeUntitled?: boolean;\n\n\t/**\n\t * Whether to exclude sticky editors.\n\t */\n\treadonly excludeSticky?: boolean;\n}\n\nexport interface ISaveAllEditorsOptions extends ISaveEditorsOptions, IBaseSaveRevertAllEditorOptions { }\n\nexport interface IRevertAllEditorsOptions extends IRevertOptions, IBaseSaveRevertAllEditorOptions { }\n\nexport interface IOpenEditorsOptions {\n\n\t/**\n\t * Whether to validate trust when opening editors\n\t * that are potentially not inside the workspace.\n\t */\n\treadonly validateTrust?: boolean;\n}\n\nexport interface IEditorsChangeEvent {\n\t/**\n\t * The group which had the editor change\n\t */\n\tgroupId: GroupIdentifier;\n\t/*\n\t * The event fired from the model\n\t */\n\tevent: IGroupModelChangeEvent;\n}\n\nexport interface IEditorService {\n\n\treadonly _serviceBrand: undefined;\n\n\t/**\n\t * Emitted when the currently active editor changes.\n\t *\n\t * @see {@link IEditorService.activeEditorPane}\n\t */\n\treadonly onDidActiveEditorChange: Event<void>;\n\n\t/**\n\t * Emitted when any of the current visible editors changes.\n\t *\n\t * @see {@link IEditorService.visibleEditorPanes}\n\t */\n\treadonly onDidVisibleEditorsChange: Event<void>;\n\n\t/**\n\t * An aggregated event for any change to any editor across\n\t * all groups.\n\t */\n\treadonly onDidEditorsChange: Event<IEditorsChangeEvent>;\n\n\t/**\n\t * Emitted when an editor is closed.\n\t */\n\treadonly onDidCloseEditor: Event<IEditorCloseEvent>;\n\n\t/**\n\t * The currently active editor pane or `undefined` if none. The editor pane is\n\t * the workbench container for editors of any kind.\n\t *\n\t * @see {@link IEditorService.activeEditor} for access to the active editor input\n\t */\n\treadonly activeEditorPane: IVisibleEditorPane | undefined;\n\n\t/**\n\t * The currently active editor or `undefined` if none. An editor is active when it is\n\t * located in the currently active editor group. It will be `undefined` if the active\n\t * editor group has no editors open.\n\t */\n\treadonly activeEditor: EditorInput | undefined;\n\n\t/**\n\t * The currently active text editor control or `undefined` if there is currently no active\n\t * editor or the active editor widget is neither a text nor a diff editor.\n\t *\n\t * @see {@link IEditorService.activeEditor}\n\t */\n\treadonly activeTextEditorControl: IEditor | IDiffEditor | undefined;\n\n\t/**\n\t * The currently active text editor language id or `undefined` if there is currently no active\n\t * editor or the active editor control is neither a text nor a diff editor. If the active\n\t * editor is a diff editor, the modified side's language id will be taken.\n\t */\n\treadonly activeTextEditorLanguageId: string | undefined;\n\n\t/**\n\t * All editor panes that are currently visible across all editor groups.\n\t *\n\t * @see {@link IEditorService.visibleEditors} for access to the visible editor inputs\n\t */\n\treadonly visibleEditorPanes: readonly IVisibleEditorPane[];\n\n\t/**\n\t * All editors that are currently visible. An editor is visible when it is opened in an\n\t * editor group and active in that group. Multiple editor groups can be opened at the same time.\n\t */\n\treadonly visibleEditors: readonly EditorInput[];\n\n\t/**\n\t * All text editor widgets that are currently visible across all editor groups. A text editor\n\t * widget is either a text or a diff editor.\n\t */\n\treadonly visibleTextEditorControls: readonly (IEditor | IDiffEditor)[];\n\n\t/**\n\t * All editors that are opened across all editor groups in sequential order\n\t * of appearance.\n\t *\n\t * This includes active as well as inactive editors in each editor group.\n\t */\n\treadonly editors: readonly EditorInput[];\n\n\t/**\n\t * The total number of editors that are opened either inactive or active.\n\t */\n\treadonly count: number;\n\n\t/**\n\t * All editors that are opened across all editor groups with their group\n\t * identifier.\n\t *\n\t * @param order the order of the editors to use\n\t * @param options whether to exclude sticky editors or not\n\t */\n\tgetEditors(order: EditorsOrder, options?: { excludeSticky?: boolean }): readonly IEditorIdentifier[];\n\n\t/**\n\t * Open an editor in an editor group.\n\t *\n\t * @param editor the editor to open\n\t * @param options the options to use for the editor\n\t * @param group the target group. If unspecified, the editor will open in the currently\n\t * active group. Use `SIDE_GROUP_TYPE` to open the editor in a new editor group to the side\n\t * of the currently active group.\n\t *\n\t * @returns the editor that opened or `undefined` if the operation failed or the editor was not\n\t * opened to be active.\n\t */\n\topenEditor(editor: IResourceEditorInput, group?: IEditorGroup | GroupIdentifier | SIDE_GROUP_TYPE | ACTIVE_GROUP_TYPE): Promise<IEditorPane | undefined>;\n\topenEditor(editor: ITextResourceEditorInput | IUntitledTextResourceEditorInput, group?: IEditorGroup | GroupIdentifier | SIDE_GROUP_TYPE | ACTIVE_GROUP_TYPE): Promise<IEditorPane | undefined>;\n\topenEditor(editor: IResourceDiffEditorInput, group?: IEditorGroup | GroupIdentifier | SIDE_GROUP_TYPE | ACTIVE_GROUP_TYPE): Promise<ITextDiffEditorPane | undefined>;\n\topenEditor(editor: IUntypedEditorInput, group?: IEditorGroup | GroupIdentifier | SIDE_GROUP_TYPE | ACTIVE_GROUP_TYPE): Promise<IEditorPane | undefined>;\n\n\t/**\n\t * @deprecated using this method is a sign that your editor has not adopted the editor\n\t * resolver yet. Please use `IEditorResolverService.registerEditor` to make your editor\n\t * known to the workbench and then use untyped editor inputs for opening:\n\t *\n\t * ```ts\n\t * editorService.openEditor({ resource });\n\t * ```\n\t *\n\t * If you already have an `EditorInput` in hand and must use it for opening, use `group.openEditor`\n\t * instead, via `IEditorGroupService`.\n\t */\n\topenEditor(editor: EditorInput, options?: IEditorOptions, group?: IEditorGroup | GroupIdentifier | SIDE_GROUP_TYPE | ACTIVE_GROUP_TYPE): Promise<IEditorPane | undefined>;\n\n\t/**\n\t * Open editors in an editor group.\n\t *\n\t * @param editors the editors to open with associated options\n\t * @param group the target group. If unspecified, the editor will open in the currently\n\t * active group. Use `SIDE_GROUP_TYPE` to open the editor in a new editor group to the side\n\t * of the currently active group.\n\t *\n\t * @returns the editors that opened. The array can be empty or have less elements for editors\n\t * that failed to open or were instructed to open as inactive.\n\t */\n\topenEditors(editors: IUntypedEditorInput[], group?: IEditorGroup | GroupIdentifier | SIDE_GROUP_TYPE | ACTIVE_GROUP_TYPE, options?: IOpenEditorsOptions): Promise<readonly IEditorPane[]>;\n\n\t/**\n\t * Replaces editors in an editor group with the provided replacement.\n\t *\n\t * @param replacements the editors to replace\n\t * @param group the editor group\n\t *\n\t * @returns a promise that is resolved when the replaced active\n\t * editor (if any) has finished loading.\n\t */\n\treplaceEditors(replacements: IUntypedEditorReplacement[], group: IEditorGroup | GroupIdentifier): Promise<void>;\n\n\t/**\n\t * Find out if the provided editor is opened in any editor group.\n\t *\n\t * Note: An editor can be opened but not actively visible.\n\t *\n\t * Note: This method will return `true` if a side by side editor\n\t * is opened where the `primary` editor matches too.\n\t */\n\tisOpened(editor: IResourceEditorInputIdentifier): boolean;\n\n\t/**\n\t * Find out if the provided editor is visible in any editor group.\n\t */\n\tisVisible(editor: EditorInput): boolean;\n\n\t/**\n\t * Close an editor in a specific editor group.\n\t */\n\tcloseEditor(editor: IEditorIdentifier, options?: ICloseEditorOptions): Promise<void>;\n\n\t/**\n\t * Close multiple editors in specific editor groups.\n\t */\n\tcloseEditors(editors: readonly IEditorIdentifier[], options?: ICloseEditorOptions): Promise<void>;\n\n\t/**\n\t * This method will return an entry for each editor that reports\n\t * a `resource` that matches the provided one in the group or\n\t * across all groups.\n\t *\n\t * It is possible that multiple editors are returned in case the\n\t * same resource is opened in different editors. To find the specific\n\t * editor, use the `IResourceEditorInputIdentifier` as input.\n\t */\n\tfindEditors(resource: URI, options?: IFindEditorOptions): readonly IEditorIdentifier[];\n\tfindEditors(editor: IResourceEditorInputIdentifier, options?: IFindEditorOptions): readonly IEditorIdentifier[];\n\n\t/**\n\t * Save the provided list of editors.\n\t *\n\t * @returns `true` if all editors saved and `false` otherwise.\n\t */\n\tsave(editors: IEditorIdentifier | IEditorIdentifier[], options?: ISaveEditorsOptions): Promise<boolean>;\n\n\t/**\n\t * Save all editors.\n\t *\n\t * @returns `true` if all editors saved and `false` otherwise.\n\t */\n\tsaveAll(options?: ISaveAllEditorsOptions): Promise<boolean>;\n\n\t/**\n\t * Reverts the provided list of editors.\n\t *\n\t * @returns `true` if all editors reverted and `false` otherwise.\n\t */\n\trevert(editors: IEditorIdentifier | IEditorIdentifier[], options?: IRevertOptions): Promise<boolean>;\n\n\t/**\n\t * Reverts all editors.\n\t *\n\t * @returns `true` if all editors reverted and `false` otherwise.\n\t */\n\trevertAll(options?: IRevertAllEditorsOptions): Promise<boolean>;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { asArray, coalesce, isNonEmptyArray } from 'vs/base/common/arrays';\nimport { VSBuffer } from 'vs/base/common/buffer';\nimport * as htmlContent from 'vs/base/common/htmlContent';\nimport { DisposableStore } from 'vs/base/common/lifecycle';\nimport { ResourceSet } from 'vs/base/common/map';\nimport { marked } from 'vs/base/common/marked/marked';\nimport { parse } from 'vs/base/common/marshalling';\nimport { cloneAndChange } from 'vs/base/common/objects';\nimport { isDefined, isEmptyObject, isNumber, isString, isUndefinedOrNull, withNullAsUndefined } from 'vs/base/common/types';\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { IURITransformer } from 'vs/base/common/uriIpc';\nimport { RenderLineNumbersType } from 'vs/editor/common/config/editorOptions';\nimport { IPosition } from 'vs/editor/common/core/position';\nimport * as editorRange from 'vs/editor/common/core/range';\nimport { ISelection } from 'vs/editor/common/core/selection';\nimport { IContentDecorationRenderOptions, IDecorationOptions, IDecorationRenderOptions, IThemeDecorationRenderOptions } from 'vs/editor/common/editorCommon';\nimport * as languages from 'vs/editor/common/languages';\nimport * as encodedTokenAttributes from 'vs/editor/common/encodedTokenAttributes';\nimport * as languageSelector from 'vs/editor/common/languageSelector';\nimport { EndOfLineSequence, TrackedRangeStickiness } from 'vs/editor/common/model';\nimport { EditorResolution, ITextEditorOptions } from 'vs/platform/editor/common/editor';\nimport { IMarkerData, IRelatedInformation, MarkerSeverity, MarkerTag } from 'vs/platform/markers/common/markers';\nimport { ProgressLocation as MainProgressLocation } from 'vs/platform/progress/common/progress';\nimport * as extHostProtocol from 'vs/workbench/api/common/extHost.protocol';\nimport { getPrivateApiFor } from 'vs/workbench/api/common/extHostTestingPrivateApi';\nimport { SaveReason } from 'vs/workbench/common/editor';\nimport { IViewBadge } from 'vs/workbench/common/views';\nimport * as notebooks from 'vs/workbench/contrib/notebook/common/notebookCommon';\nimport { ICellRange } from 'vs/workbench/contrib/notebook/common/notebookRange';\nimport * as search from 'vs/workbench/contrib/search/common/search';\nimport { TestId } from 'vs/workbench/contrib/testing/common/testId';\nimport { CoverageDetails, denamespaceTestTag, DetailType, ICoveredCount, IFileCoverage, ISerializedTestResults, ITestErrorMessage, ITestItem, ITestTag, namespaceTestTag, TestMessageType, TestResultItem } from 'vs/workbench/contrib/testing/common/testTypes';\nimport { EditorGroupColumn } from 'vs/workbench/services/editor/common/editorGroupColumn';\nimport { ACTIVE_GROUP, SIDE_GROUP } from 'vs/workbench/services/editor/common/editorService';\nimport type * as vscode from 'vscode';\nimport * as types from './extHostTypes';\nimport { once } from 'vs/base/common/functional';\nimport { VSDataTransfer } from 'vs/base/common/dataTransfer';\n\nexport namespace Command {\n\n\texport interface ICommandsConverter {\n\t\tfromInternal(command: extHostProtocol.ICommandDto): vscode.Command | undefined;\n\t\ttoInternal(command: vscode.Command | undefined, disposables: DisposableStore): extHostProtocol.ICommandDto | undefined;\n\t}\n}\n\nexport interface PositionLike {\n\tline: number;\n\tcharacter: number;\n}\n\nexport interface RangeLike {\n\tstart: PositionLike;\n\tend: PositionLike;\n}\n\nexport interface SelectionLike extends RangeLike {\n\tanchor: PositionLike;\n\tactive: PositionLike;\n}\nexport namespace Selection {\n\n\texport function to(selection: ISelection): types.Selection {\n\t\tconst { selectionStartLineNumber, selectionStartColumn, positionLineNumber, positionColumn } = selection;\n\t\tconst start = new types.Position(selectionStartLineNumber - 1, selectionStartColumn - 1);\n\t\tconst end = new types.Position(positionLineNumber - 1, positionColumn - 1);\n\t\treturn new types.Selection(start, end);\n\t}\n\n\texport function from(selection: SelectionLike): ISelection {\n\t\tconst { anchor, active } = selection;\n\t\treturn {\n\t\t\tselectionStartLineNumber: anchor.line + 1,\n\t\t\tselectionStartColumn: anchor.character + 1,\n\t\t\tpositionLineNumber: active.line + 1,\n\t\t\tpositionColumn: active.character + 1\n\t\t};\n\t}\n}\nexport namespace Range {\n\n\texport function from(range: undefined): undefined;\n\texport function from(range: RangeLike): editorRange.IRange;\n\texport function from(range: RangeLike | undefined): editorRange.IRange | undefined;\n\texport function from(range: RangeLike | undefined): editorRange.IRange | undefined {\n\t\tif (!range) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst { start, end } = range;\n\t\treturn {\n\t\t\tstartLineNumber: start.line + 1,\n\t\t\tstartColumn: start.character + 1,\n\t\t\tendLineNumber: end.line + 1,\n\t\t\tendColumn: end.character + 1\n\t\t};\n\t}\n\n\texport function to(range: undefined): types.Range;\n\texport function to(range: editorRange.IRange): types.Range;\n\texport function to(range: editorRange.IRange | undefined): types.Range | undefined;\n\texport function to(range: editorRange.IRange | undefined): types.Range | undefined {\n\t\tif (!range) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst { startLineNumber, startColumn, endLineNumber, endColumn } = range;\n\t\treturn new types.Range(startLineNumber - 1, startColumn - 1, endLineNumber - 1, endColumn - 1);\n\t}\n}\n\nexport namespace TokenType {\n\texport function to(type: encodedTokenAttributes.StandardTokenType): types.StandardTokenType {\n\t\tswitch (type) {\n\t\t\tcase encodedTokenAttributes.StandardTokenType.Comment: return types.StandardTokenType.Comment;\n\t\t\tcase encodedTokenAttributes.StandardTokenType.Other: return types.StandardTokenType.Other;\n\t\t\tcase encodedTokenAttributes.StandardTokenType.RegEx: return types.StandardTokenType.RegEx;\n\t\t\tcase encodedTokenAttributes.StandardTokenType.String: return types.StandardTokenType.String;\n\t\t}\n\t}\n}\n\nexport namespace Position {\n\texport function to(position: IPosition): types.Position {\n\t\treturn new types.Position(position.lineNumber - 1, position.column - 1);\n\t}\n\texport function from(position: types.Position | vscode.Position): IPosition {\n\t\treturn { lineNumber: position.line + 1, column: position.character + 1 };\n\t}\n}\n\nexport namespace DocumentSelector {\n\n\texport function from(value: vscode.DocumentSelector, uriTransformer?: IURITransformer): extHostProtocol.IDocumentFilterDto[] {\n\t\treturn coalesce(asArray(value).map(sel => _doTransformDocumentSelector(sel, uriTransformer)));\n\t}\n\n\tfunction _doTransformDocumentSelector(selector: string | vscode.DocumentFilter, uriTransformer: IURITransformer | undefined): extHostProtocol.IDocumentFilterDto | undefined {\n\t\tif (typeof selector === 'string') {\n\t\t\treturn {\n\t\t\t\t$serialized: true,\n\t\t\t\tlanguage: selector\n\t\t\t};\n\t\t}\n\n\t\tif (selector) {\n\t\t\treturn {\n\t\t\t\t$serialized: true,\n\t\t\t\tlanguage: selector.language,\n\t\t\t\tscheme: _transformScheme(selector.scheme, uriTransformer),\n\t\t\t\tpattern: GlobPattern.from(selector.pattern) ?? undefined,\n\t\t\t\texclusive: selector.exclusive,\n\t\t\t\tnotebookType: selector.notebookType\n\t\t\t};\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tfunction _transformScheme(scheme: string | undefined, uriTransformer: IURITransformer | undefined): string | undefined {\n\t\tif (uriTransformer && typeof scheme === 'string') {\n\t\t\treturn uriTransformer.transformOutgoingScheme(scheme);\n\t\t}\n\t\treturn scheme;\n\t}\n}\n\nexport namespace DiagnosticTag {\n\texport function from(value: vscode.DiagnosticTag): MarkerTag | undefined {\n\t\tswitch (value) {\n\t\t\tcase types.DiagnosticTag.Unnecessary:\n\t\t\t\treturn MarkerTag.Unnecessary;\n\t\t\tcase types.DiagnosticTag.Deprecated:\n\t\t\t\treturn MarkerTag.Deprecated;\n\t\t}\n\t\treturn undefined;\n\t}\n\texport function to(value: MarkerTag): vscode.DiagnosticTag | undefined {\n\t\tswitch (value) {\n\t\t\tcase MarkerTag.Unnecessary:\n\t\t\t\treturn types.DiagnosticTag.Unnecessary;\n\t\t\tcase MarkerTag.Deprecated:\n\t\t\t\treturn types.DiagnosticTag.Deprecated;\n\t\t\tdefault:\n\t\t\t\treturn undefined;\n\t\t}\n\t}\n}\n\nexport namespace Diagnostic {\n\texport function from(value: vscode.Diagnostic): IMarkerData {\n\t\tlet code: string | { value: string; target: URI } | undefined;\n\n\t\tif (value.code) {\n\t\t\tif (isString(value.code) || isNumber(value.code)) {\n\t\t\t\tcode = String(value.code);\n\t\t\t} else {\n\t\t\t\tcode = {\n\t\t\t\t\tvalue: String(value.code.value),\n\t\t\t\t\ttarget: value.code.target,\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\t...Range.from(value.range),\n\t\t\tmessage: value.message,\n\t\t\tsource: value.source,\n\t\t\tcode,\n\t\t\tseverity: DiagnosticSeverity.from(value.severity),\n\t\t\trelatedInformation: value.relatedInformation && value.relatedInformation.map(DiagnosticRelatedInformation.from),\n\t\t\ttags: Array.isArray(value.tags) ? coalesce(value.tags.map(DiagnosticTag.from)) : undefined,\n\t\t};\n\t}\n\n\texport function to(value: IMarkerData): vscode.Diagnostic {\n\t\tconst res = new types.Diagnostic(Range.to(value), value.message, DiagnosticSeverity.to(value.severity));\n\t\tres.source = value.source;\n\t\tres.code = isString(value.code) ? value.code : value.code?.value;\n\t\tres.relatedInformation = value.relatedInformation && value.relatedInformation.map(DiagnosticRelatedInformation.to);\n\t\tres.tags = value.tags && coalesce(value.tags.map(DiagnosticTag.to));\n\t\treturn res;\n\t}\n}\n\nexport namespace DiagnosticRelatedInformation {\n\texport function from(value: vscode.DiagnosticRelatedInformation): IRelatedInformation {\n\t\treturn {\n\t\t\t...Range.from(value.location.range),\n\t\t\tmessage: value.message,\n\t\t\tresource: value.location.uri\n\t\t};\n\t}\n\texport function to(value: IRelatedInformation): types.DiagnosticRelatedInformation {\n\t\treturn new types.DiagnosticRelatedInformation(new types.Location(value.resource, Range.to(value)), value.message);\n\t}\n}\nexport namespace DiagnosticSeverity {\n\n\texport function from(value: number): MarkerSeverity {\n\t\tswitch (value) {\n\t\t\tcase types.DiagnosticSeverity.Error:\n\t\t\t\treturn MarkerSeverity.Error;\n\t\t\tcase types.DiagnosticSeverity.Warning:\n\t\t\t\treturn MarkerSeverity.Warning;\n\t\t\tcase types.DiagnosticSeverity.Information:\n\t\t\t\treturn MarkerSeverity.Info;\n\t\t\tcase types.DiagnosticSeverity.Hint:\n\t\t\t\treturn MarkerSeverity.Hint;\n\t\t}\n\t\treturn MarkerSeverity.Error;\n\t}\n\n\texport function to(value: MarkerSeverity): types.DiagnosticSeverity {\n\t\tswitch (value) {\n\t\t\tcase MarkerSeverity.Info:\n\t\t\t\treturn types.DiagnosticSeverity.Information;\n\t\t\tcase MarkerSeverity.Warning:\n\t\t\t\treturn types.DiagnosticSeverity.Warning;\n\t\t\tcase MarkerSeverity.Error:\n\t\t\t\treturn types.DiagnosticSeverity.Error;\n\t\t\tcase MarkerSeverity.Hint:\n\t\t\t\treturn types.DiagnosticSeverity.Hint;\n\t\t\tdefault:\n\t\t\t\treturn types.DiagnosticSeverity.Error;\n\t\t}\n\t}\n}\n\nexport namespace ViewColumn {\n\texport function from(column?: vscode.ViewColumn): EditorGroupColumn {\n\t\tif (typeof column === 'number' && column >= types.ViewColumn.One) {\n\t\t\treturn column - 1; // adjust zero index (ViewColumn.ONE => 0)\n\t\t}\n\n\t\tif (column === types.ViewColumn.Beside) {\n\t\t\treturn SIDE_GROUP;\n\t\t}\n\n\t\treturn ACTIVE_GROUP; // default is always the active group\n\t}\n\n\texport function to(position: EditorGroupColumn): vscode.ViewColumn {\n\t\tif (typeof position === 'number' && position >= 0) {\n\t\t\treturn position + 1; // adjust to index (ViewColumn.ONE => 1)\n\t\t}\n\n\t\tthrow new Error(`invalid 'EditorGroupColumn'`);\n\t}\n}\n\nfunction isDecorationOptions(something: any): something is vscode.DecorationOptions {\n\treturn (typeof something.range !== 'undefined');\n}\n\nexport function isDecorationOptionsArr(something: vscode.Range[] | vscode.DecorationOptions[]): something is vscode.DecorationOptions[] {\n\tif (something.length === 0) {\n\t\treturn true;\n\t}\n\treturn isDecorationOptions(something[0]) ? true : false;\n}\n\nexport namespace MarkdownString {\n\n\texport function fromMany(markup: (vscode.MarkdownString | vscode.MarkedString)[]): htmlContent.IMarkdownString[] {\n\t\treturn markup.map(MarkdownString.from);\n\t}\n\n\tinterface Codeblock {\n\t\tlanguage: string;\n\t\tvalue: string;\n\t}\n\n\tfunction isCodeblock(thing: any): thing is Codeblock {\n\t\treturn thing && typeof thing === 'object'\n\t\t\t&& typeof (<Codeblock>thing).language === 'string'\n\t\t\t&& typeof (<Codeblock>thing).value === 'string';\n\t}\n\n\texport function from(markup: vscode.MarkdownString | vscode.MarkedString): htmlContent.IMarkdownString {\n\t\tlet res: htmlContent.IMarkdownString;\n\t\tif (isCodeblock(markup)) {\n\t\t\tconst { language, value } = markup;\n\t\t\tres = { value: '```' + language + '\\n' + value + '\\n```\\n' };\n\t\t} else if (types.MarkdownString.isMarkdownString(markup)) {\n\t\t\tres = { value: markup.value, isTrusted: markup.isTrusted, supportThemeIcons: markup.supportThemeIcons, supportHtml: markup.supportHtml, baseUri: markup.baseUri };\n\t\t} else if (typeof markup === 'string') {\n\t\t\tres = { value: markup };\n\t\t} else {\n\t\t\tres = { value: '' };\n\t\t}\n\n\t\t// extract uris into a separate object\n\t\tconst resUris: { [href: string]: UriComponents } = Object.create(null);\n\t\tres.uris = resUris;\n\n\t\tconst collectUri = (href: string): string => {\n\t\t\ttry {\n\t\t\t\tlet uri = URI.parse(href, true);\n\t\t\t\turi = uri.with({ query: _uriMassage(uri.query, resUris) });\n\t\t\t\tresUris[href] = uri;\n\t\t\t} catch (e) {\n\t\t\t\t// ignore\n\t\t\t}\n\t\t\treturn '';\n\t\t};\n\t\tconst renderer = new marked.Renderer();\n\t\trenderer.link = collectUri;\n\t\trenderer.image = href => typeof href === 'string' ? collectUri(htmlContent.parseHrefAndDimensions(href).href) : '';\n\n\t\tmarked(res.value, { renderer });\n\n\t\treturn res;\n\t}\n\n\tfunction _uriMassage(part: string, bucket: { [n: string]: UriComponents }): string {\n\t\tif (!part) {\n\t\t\treturn part;\n\t\t}\n\t\tlet data: any;\n\t\ttry {\n\t\t\tdata = parse(part);\n\t\t} catch (e) {\n\t\t\t// ignore\n\t\t}\n\t\tif (!data) {\n\t\t\treturn part;\n\t\t}\n\t\tlet changed = false;\n\t\tdata = cloneAndChange(data, value => {\n\t\t\tif (URI.isUri(value)) {\n\t\t\t\tconst key = `__uri_${Math.random().toString(16).slice(2, 8)}`;\n\t\t\t\tbucket[key] = value;\n\t\t\t\tchanged = true;\n\t\t\t\treturn key;\n\t\t\t} else {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t});\n\n\t\tif (!changed) {\n\t\t\treturn part;\n\t\t}\n\n\t\treturn JSON.stringify(data);\n\t}\n\n\texport function to(value: htmlContent.IMarkdownString): vscode.MarkdownString {\n\t\tconst result = new types.MarkdownString(value.value, value.supportThemeIcons);\n\t\tresult.isTrusted = value.isTrusted;\n\t\tresult.supportHtml = value.supportHtml;\n\t\tresult.baseUri = value.baseUri ? URI.from(value.baseUri) : undefined;\n\t\treturn result;\n\t}\n\n\texport function fromStrict(value: string | vscode.MarkdownString | undefined | null): undefined | string | htmlContent.IMarkdownString {\n\t\tif (!value) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn typeof value === 'string' ? value : MarkdownString.from(value);\n\t}\n}\n\nexport function fromRangeOrRangeWithMessage(ranges: vscode.Range[] | vscode.DecorationOptions[]): IDecorationOptions[] {\n\tif (isDecorationOptionsArr(ranges)) {\n\t\treturn ranges.map((r): IDecorationOptions => {\n\t\t\treturn {\n\t\t\t\trange: Range.from(r.range),\n\t\t\t\thoverMessage: Array.isArray(r.hoverMessage)\n\t\t\t\t\t? MarkdownString.fromMany(r.hoverMessage)\n\t\t\t\t\t: (r.hoverMessage ? MarkdownString.from(r.hoverMessage) : undefined),\n\t\t\t\trenderOptions: <any> /* URI vs Uri */r.renderOptions\n\t\t\t};\n\t\t});\n\t} else {\n\t\treturn ranges.map((r): IDecorationOptions => {\n\t\t\treturn {\n\t\t\t\trange: Range.from(r)\n\t\t\t};\n\t\t});\n\t}\n}\n\nexport function pathOrURIToURI(value: string | URI): URI {\n\tif (typeof value === 'undefined') {\n\t\treturn value;\n\t}\n\tif (typeof value === 'string') {\n\t\treturn URI.file(value);\n\t} else {\n\t\treturn value;\n\t}\n}\n\nexport namespace ThemableDecorationAttachmentRenderOptions {\n\texport function from(options: vscode.ThemableDecorationAttachmentRenderOptions): IContentDecorationRenderOptions {\n\t\tif (typeof options === 'undefined') {\n\t\t\treturn options;\n\t\t}\n\t\treturn {\n\t\t\tcontentText: options.contentText,\n\t\t\tcontentIconPath: options.contentIconPath ? pathOrURIToURI(options.contentIconPath) : undefined,\n\t\t\tborder: options.border,\n\t\t\tborderColor: <string | types.ThemeColor>options.borderColor,\n\t\t\tfontStyle: options.fontStyle,\n\t\t\tfontWeight: options.fontWeight,\n\t\t\ttextDecoration: options.textDecoration,\n\t\t\tcolor: <string | types.ThemeColor>options.color,\n\t\t\tbackgroundColor: <string | types.ThemeColor>options.backgroundColor,\n\t\t\tmargin: options.margin,\n\t\t\twidth: options.width,\n\t\t\theight: options.height,\n\t\t};\n\t}\n}\n\nexport namespace ThemableDecorationRenderOptions {\n\texport function from(options: vscode.ThemableDecorationRenderOptions): IThemeDecorationRenderOptions {\n\t\tif (typeof options === 'undefined') {\n\t\t\treturn options;\n\t\t}\n\t\treturn {\n\t\t\tbackgroundColor: <string | types.ThemeColor>options.backgroundColor,\n\t\t\toutline: options.outline,\n\t\t\toutlineColor: <string | types.ThemeColor>options.outlineColor,\n\t\t\toutlineStyle: options.outlineStyle,\n\t\t\toutlineWidth: options.outlineWidth,\n\t\t\tborder: options.border,\n\t\t\tborderColor: <string | types.ThemeColor>options.borderColor,\n\t\t\tborderRadius: options.borderRadius,\n\t\t\tborderSpacing: options.borderSpacing,\n\t\t\tborderStyle: options.borderStyle,\n\t\t\tborderWidth: options.borderWidth,\n\t\t\tfontStyle: options.fontStyle,\n\t\t\tfontWeight: options.fontWeight,\n\t\t\ttextDecoration: options.textDecoration,\n\t\t\tcursor: options.cursor,\n\t\t\tcolor: <string | types.ThemeColor>options.color,\n\t\t\topacity: options.opacity,\n\t\t\tletterSpacing: options.letterSpacing,\n\t\t\tgutterIconPath: options.gutterIconPath ? pathOrURIToURI(options.gutterIconPath) : undefined,\n\t\t\tgutterIconSize: options.gutterIconSize,\n\t\t\toverviewRulerColor: <string | types.ThemeColor>options.overviewRulerColor,\n\t\t\tbefore: options.before ? ThemableDecorationAttachmentRenderOptions.from(options.before) : undefined,\n\t\t\tafter: options.after ? ThemableDecorationAttachmentRenderOptions.from(options.after) : undefined,\n\t\t};\n\t}\n}\n\nexport namespace DecorationRangeBehavior {\n\texport function from(value: types.DecorationRangeBehavior): TrackedRangeStickiness {\n\t\tif (typeof value === 'undefined') {\n\t\t\treturn value;\n\t\t}\n\t\tswitch (value) {\n\t\t\tcase types.DecorationRangeBehavior.OpenOpen:\n\t\t\t\treturn TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges;\n\t\t\tcase types.DecorationRangeBehavior.ClosedClosed:\n\t\t\t\treturn TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges;\n\t\t\tcase types.DecorationRangeBehavior.OpenClosed:\n\t\t\t\treturn TrackedRangeStickiness.GrowsOnlyWhenTypingBefore;\n\t\t\tcase types.DecorationRangeBehavior.ClosedOpen:\n\t\t\t\treturn TrackedRangeStickiness.GrowsOnlyWhenTypingAfter;\n\t\t}\n\t}\n}\n\nexport namespace DecorationRenderOptions {\n\texport function from(options: vscode.DecorationRenderOptions): IDecorationRenderOptions {\n\t\treturn {\n\t\t\tisWholeLine: options.isWholeLine,\n\t\t\trangeBehavior: options.rangeBehavior ? DecorationRangeBehavior.from(options.rangeBehavior) : undefined,\n\t\t\toverviewRulerLane: options.overviewRulerLane,\n\t\t\tlight: options.light ? ThemableDecorationRenderOptions.from(options.light) : undefined,\n\t\t\tdark: options.dark ? ThemableDecorationRenderOptions.from(options.dark) : undefined,\n\n\t\t\tbackgroundColor: <string | types.ThemeColor>options.backgroundColor,\n\t\t\toutline: options.outline,\n\t\t\toutlineColor: <string | types.ThemeColor>options.outlineColor,\n\t\t\toutlineStyle: options.outlineStyle,\n\t\t\toutlineWidth: options.outlineWidth,\n\t\t\tborder: options.border,\n\t\t\tborderColor: <string | types.ThemeColor>options.borderColor,\n\t\t\tborderRadius: options.borderRadius,\n\t\t\tborderSpacing: options.borderSpacing,\n\t\t\tborderStyle: options.borderStyle,\n\t\t\tborderWidth: options.borderWidth,\n\t\t\tfontStyle: options.fontStyle,\n\t\t\tfontWeight: options.fontWeight,\n\t\t\ttextDecoration: options.textDecoration,\n\t\t\tcursor: options.cursor,\n\t\t\tcolor: <string | types.ThemeColor>options.color,\n\t\t\topacity: options.opacity,\n\t\t\tletterSpacing: options.letterSpacing,\n\t\t\tgutterIconPath: options.gutterIconPath ? pathOrURIToURI(options.gutterIconPath) : undefined,\n\t\t\tgutterIconSize: options.gutterIconSize,\n\t\t\toverviewRulerColor: <string | types.ThemeColor>options.overviewRulerColor,\n\t\t\tbefore: options.before ? ThemableDecorationAttachmentRenderOptions.from(options.before) : undefined,\n\t\t\tafter: options.after ? ThemableDecorationAttachmentRenderOptions.from(options.after) : undefined,\n\t\t};\n\t}\n}\n\nexport namespace TextEdit {\n\n\texport function from(edit: vscode.TextEdit): languages.TextEdit {\n\t\treturn <languages.TextEdit>{\n\t\t\ttext: edit.newText,\n\t\t\teol: edit.newEol && EndOfLine.from(edit.newEol),\n\t\t\trange: Range.from(edit.range)\n\t\t};\n\t}\n\n\texport function to(edit: languages.TextEdit): types.TextEdit {\n\t\tconst result = new types.TextEdit(Range.to(edit.range), edit.text);\n\t\tresult.newEol = (typeof edit.eol === 'undefined' ? undefined : EndOfLine.to(edit.eol))!;\n\t\treturn result;\n\t}\n}\n\nexport namespace WorkspaceEdit {\n\n\texport interface IVersionInformationProvider {\n\t\tgetTextDocumentVersion(uri: URI): number | undefined;\n\t\tgetNotebookDocumentVersion(uri: URI): number | undefined;\n\t}\n\n\texport function from(value: vscode.WorkspaceEdit, versionInfo?: IVersionInformationProvider, allowSnippetTextEdit?: boolean): extHostProtocol.IWorkspaceEditDto {\n\t\tconst result: extHostProtocol.IWorkspaceEditDto = {\n\t\t\tedits: []\n\t\t};\n\n\t\tif (value instanceof types.WorkspaceEdit) {\n\n\t\t\t// collect all files that are to be created so that their version\n\t\t\t// information (in case they exist as text model already) can be ignored\n\t\t\tconst toCreate = new ResourceSet();\n\t\t\tfor (const entry of value._allEntries()) {\n\t\t\t\tif (entry._type === types.FileEditType.File && URI.isUri(entry.to) && entry.from === undefined) {\n\t\t\t\t\ttoCreate.add(entry.to);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (const entry of value._allEntries()) {\n\n\t\t\t\tif (entry._type === types.FileEditType.File) {\n\t\t\t\t\t// file operation\n\t\t\t\t\tresult.edits.push(<languages.IWorkspaceFileEdit>{\n\t\t\t\t\t\toldResource: entry.from,\n\t\t\t\t\t\tnewResource: entry.to,\n\t\t\t\t\t\toptions: entry.options,\n\t\t\t\t\t\tmetadata: entry.metadata\n\t\t\t\t\t});\n\n\t\t\t\t} else if (entry._type === types.FileEditType.Text) {\n\t\t\t\t\t// text edits\n\t\t\t\t\tresult.edits.push(<languages.IWorkspaceTextEdit>{\n\t\t\t\t\t\tresource: entry.uri,\n\t\t\t\t\t\ttextEdit: TextEdit.from(entry.edit),\n\t\t\t\t\t\tversionId: !toCreate.has(entry.uri) ? versionInfo?.getTextDocumentVersion(entry.uri) : undefined,\n\t\t\t\t\t\tmetadata: entry.metadata\n\t\t\t\t\t});\n\t\t\t\t} else if (entry._type === types.FileEditType.Snippet) {\n\t\t\t\t\t// snippet text edits\n\t\t\t\t\tif (!allowSnippetTextEdit) {\n\t\t\t\t\t\tconsole.warn(`DROPPING snippet text edit because proposal IS NOT ENABLED`, entry);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tresult.edits.push(<languages.IWorkspaceTextEdit>{\n\t\t\t\t\t\tresource: entry.uri,\n\t\t\t\t\t\ttextEdit: {\n\t\t\t\t\t\t\trange: Range.from(entry.range),\n\t\t\t\t\t\t\ttext: entry.edit.value,\n\t\t\t\t\t\t\tinsertAsSnippet: true\n\t\t\t\t\t\t},\n\t\t\t\t\t\tversionId: !toCreate.has(entry.uri) ? versionInfo?.getTextDocumentVersion(entry.uri) : undefined,\n\t\t\t\t\t\tmetadata: entry.metadata\n\t\t\t\t\t});\n\n\t\t\t\t} else if (entry._type === types.FileEditType.Cell) {\n\t\t\t\t\t// cell edit\n\t\t\t\t\tresult.edits.push(<notebooks.IWorkspaceNotebookCellEdit>{\n\t\t\t\t\t\tmetadata: entry.metadata,\n\t\t\t\t\t\tresource: entry.uri,\n\t\t\t\t\t\tcellEdit: entry.edit,\n\t\t\t\t\t\tnotebookMetadata: entry.notebookMetadata,\n\t\t\t\t\t\tnotebookVersionId: versionInfo?.getNotebookDocumentVersion(entry.uri)\n\t\t\t\t\t});\n\n\t\t\t\t} else if (entry._type === types.FileEditType.CellReplace) {\n\t\t\t\t\t// cell replace\n\t\t\t\t\tresult.edits.push(<extHostProtocol.IWorkspaceCellEditDto>{\n\t\t\t\t\t\tmetadata: entry.metadata,\n\t\t\t\t\t\tresource: entry.uri,\n\t\t\t\t\t\tnotebookVersionId: versionInfo?.getNotebookDocumentVersion(entry.uri),\n\t\t\t\t\t\tcellEdit: {\n\t\t\t\t\t\t\teditType: notebooks.CellEditType.Replace,\n\t\t\t\t\t\t\tindex: entry.index,\n\t\t\t\t\t\t\tcount: entry.count,\n\t\t\t\t\t\t\tcells: entry.cells.map(NotebookCellData.from)\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\texport function to(value: extHostProtocol.IWorkspaceEditDto) {\n\t\tconst result = new types.WorkspaceEdit();\n\t\tfor (const edit of value.edits) {\n\t\t\tif ((<extHostProtocol.IWorkspaceTextEditDto>edit).textEdit) {\n\t\t\t\tresult.replace(\n\t\t\t\t\tURI.revive((<extHostProtocol.IWorkspaceTextEditDto>edit).resource),\n\t\t\t\t\tRange.to((<extHostProtocol.IWorkspaceTextEditDto>edit).textEdit.range),\n\t\t\t\t\t(<extHostProtocol.IWorkspaceTextEditDto>edit).textEdit.text\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tresult.renameFile(\n\t\t\t\t\tURI.revive((<extHostProtocol.IWorkspaceFileEditDto>edit).oldResource!),\n\t\t\t\t\tURI.revive((<extHostProtocol.IWorkspaceFileEditDto>edit).newResource!),\n\t\t\t\t\t(<extHostProtocol.IWorkspaceFileEditDto>edit).options\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n}\n\n\nexport namespace SymbolKind {\n\n\tconst _fromMapping: { [kind: number]: languages.SymbolKind } = Object.create(null);\n\t_fromMapping[types.SymbolKind.File] = languages.SymbolKind.File;\n\t_fromMapping[types.SymbolKind.Module] = languages.SymbolKind.Module;\n\t_fromMapping[types.SymbolKind.Namespace] = languages.SymbolKind.Namespace;\n\t_fromMapping[types.SymbolKind.Package] = languages.SymbolKind.Package;\n\t_fromMapping[types.SymbolKind.Class] = languages.SymbolKind.Class;\n\t_fromMapping[types.SymbolKind.Method] = languages.SymbolKind.Method;\n\t_fromMapping[types.SymbolKind.Property] = languages.SymbolKind.Property;\n\t_fromMapping[types.SymbolKind.Field] = languages.SymbolKind.Field;\n\t_fromMapping[types.SymbolKind.Constructor] = languages.SymbolKind.Constructor;\n\t_fromMapping[types.SymbolKind.Enum] = languages.SymbolKind.Enum;\n\t_fromMapping[types.SymbolKind.Interface] = languages.SymbolKind.Interface;\n\t_fromMapping[types.SymbolKind.Function] = languages.SymbolKind.Function;\n\t_fromMapping[types.SymbolKind.Variable] = languages.SymbolKind.Variable;\n\t_fromMapping[types.SymbolKind.Constant] = languages.SymbolKind.Constant;\n\t_fromMapping[types.SymbolKind.String] = languages.SymbolKind.String;\n\t_fromMapping[types.SymbolKind.Number] = languages.SymbolKind.Number;\n\t_fromMapping[types.SymbolKind.Boolean] = languages.SymbolKind.Boolean;\n\t_fromMapping[types.SymbolKind.Array] = languages.SymbolKind.Array;\n\t_fromMapping[types.SymbolKind.Object] = languages.SymbolKind.Object;\n\t_fromMapping[types.SymbolKind.Key] = languages.SymbolKind.Key;\n\t_fromMapping[types.SymbolKind.Null] = languages.SymbolKind.Null;\n\t_fromMapping[types.SymbolKind.EnumMember] = languages.SymbolKind.EnumMember;\n\t_fromMapping[types.SymbolKind.Struct] = languages.SymbolKind.Struct;\n\t_fromMapping[types.SymbolKind.Event] = languages.SymbolKind.Event;\n\t_fromMapping[types.SymbolKind.Operator] = languages.SymbolKind.Operator;\n\t_fromMapping[types.SymbolKind.TypeParameter] = languages.SymbolKind.TypeParameter;\n\n\texport function from(kind: vscode.SymbolKind): languages.SymbolKind {\n\t\treturn typeof _fromMapping[kind] === 'number' ? _fromMapping[kind] : languages.SymbolKind.Property;\n\t}\n\n\texport function to(kind: languages.SymbolKind): vscode.SymbolKind {\n\t\tfor (const k in _fromMapping) {\n\t\t\tif (_fromMapping[k] === kind) {\n\t\t\t\treturn Number(k);\n\t\t\t}\n\t\t}\n\t\treturn types.SymbolKind.Property;\n\t}\n}\n\nexport namespace SymbolTag {\n\n\texport function from(kind: types.SymbolTag): languages.SymbolTag {\n\t\tswitch (kind) {\n\t\t\tcase types.SymbolTag.Deprecated: return languages.SymbolTag.Deprecated;\n\t\t}\n\t}\n\n\texport function to(kind: languages.SymbolTag): types.SymbolTag {\n\t\tswitch (kind) {\n\t\t\tcase languages.SymbolTag.Deprecated: return types.SymbolTag.Deprecated;\n\t\t}\n\t}\n}\n\nexport namespace WorkspaceSymbol {\n\texport function from(info: vscode.SymbolInformation): search.IWorkspaceSymbol {\n\t\treturn <search.IWorkspaceSymbol>{\n\t\t\tname: info.name,\n\t\t\tkind: SymbolKind.from(info.kind),\n\t\t\ttags: info.tags && info.tags.map(SymbolTag.from),\n\t\t\tcontainerName: info.containerName,\n\t\t\tlocation: location.from(info.location)\n\t\t};\n\t}\n\texport function to(info: search.IWorkspaceSymbol): types.SymbolInformation {\n\t\tconst result = new types.SymbolInformation(\n\t\t\tinfo.name,\n\t\t\tSymbolKind.to(info.kind),\n\t\t\tinfo.containerName,\n\t\t\tlocation.to(info.location)\n\t\t);\n\t\tresult.tags = info.tags && info.tags.map(SymbolTag.to);\n\t\treturn result;\n\t}\n}\n\nexport namespace DocumentSymbol {\n\texport function from(info: vscode.DocumentSymbol): languages.DocumentSymbol {\n\t\tconst result: languages.DocumentSymbol = {\n\t\t\tname: info.name || '!!MISSING: name!!',\n\t\t\tdetail: info.detail,\n\t\t\trange: Range.from(info.range),\n\t\t\tselectionRange: Range.from(info.selectionRange),\n\t\t\tkind: SymbolKind.from(info.kind),\n\t\t\ttags: info.tags?.map(SymbolTag.from) ?? []\n\t\t};\n\t\tif (info.children) {\n\t\t\tresult.children = info.children.map(from);\n\t\t}\n\t\treturn result;\n\t}\n\texport function to(info: languages.DocumentSymbol): vscode.DocumentSymbol {\n\t\tconst result = new types.DocumentSymbol(\n\t\t\tinfo.name,\n\t\t\tinfo.detail,\n\t\t\tSymbolKind.to(info.kind),\n\t\t\tRange.to(info.range),\n\t\t\tRange.to(info.selectionRange),\n\t\t);\n\t\tif (isNonEmptyArray(info.tags)) {\n\t\t\tresult.tags = info.tags.map(SymbolTag.to);\n\t\t}\n\t\tif (info.children) {\n\t\t\tresult.children = info.children.map(to) as any;\n\t\t}\n\t\treturn result;\n\t}\n}\n\nexport namespace CallHierarchyItem {\n\n\texport function to(item: extHostProtocol.ICallHierarchyItemDto): types.CallHierarchyItem {\n\t\tconst result = new types.CallHierarchyItem(\n\t\t\tSymbolKind.to(item.kind),\n\t\t\titem.name,\n\t\t\titem.detail || '',\n\t\t\tURI.revive(item.uri),\n\t\t\tRange.to(item.range),\n\t\t\tRange.to(item.selectionRange)\n\t\t);\n\n\t\tresult._sessionId = item._sessionId;\n\t\tresult._itemId = item._itemId;\n\n\t\treturn result;\n\t}\n\n\texport function from(item: vscode.CallHierarchyItem, sessionId?: string, itemId?: string): extHostProtocol.ICallHierarchyItemDto {\n\n\t\tsessionId = sessionId ?? (<types.CallHierarchyItem>item)._sessionId;\n\t\titemId = itemId ?? (<types.CallHierarchyItem>item)._itemId;\n\n\t\tif (sessionId === undefined || itemId === undefined) {\n\t\t\tthrow new Error('invalid item');\n\t\t}\n\n\t\treturn {\n\t\t\t_sessionId: sessionId,\n\t\t\t_itemId: itemId,\n\t\t\tname: item.name,\n\t\t\tdetail: item.detail,\n\t\t\tkind: SymbolKind.from(item.kind),\n\t\t\turi: item.uri,\n\t\t\trange: Range.from(item.range),\n\t\t\tselectionRange: Range.from(item.selectionRange),\n\t\t\ttags: item.tags?.map(SymbolTag.from)\n\t\t};\n\t}\n}\n\nexport namespace CallHierarchyIncomingCall {\n\n\texport function to(item: extHostProtocol.IIncomingCallDto): types.CallHierarchyIncomingCall {\n\t\treturn new types.CallHierarchyIncomingCall(\n\t\t\tCallHierarchyItem.to(item.from),\n\t\t\titem.fromRanges.map(r => Range.to(r))\n\t\t);\n\t}\n}\n\nexport namespace CallHierarchyOutgoingCall {\n\n\texport function to(item: extHostProtocol.IOutgoingCallDto): types.CallHierarchyOutgoingCall {\n\t\treturn new types.CallHierarchyOutgoingCall(\n\t\t\tCallHierarchyItem.to(item.to),\n\t\t\titem.fromRanges.map(r => Range.to(r))\n\t\t);\n\t}\n}\n\n\nexport namespace location {\n\texport function from(value: vscode.Location): languages.Location {\n\t\treturn {\n\t\t\trange: value.range && Range.from(value.range),\n\t\t\turi: value.uri\n\t\t};\n\t}\n\n\texport function to(value: extHostProtocol.ILocationDto): types.Location {\n\t\treturn new types.Location(URI.revive(value.uri), Range.to(value.range));\n\t}\n}\n\nexport namespace DefinitionLink {\n\texport function from(value: vscode.Location | vscode.DefinitionLink): languages.LocationLink {\n\t\tconst definitionLink = <vscode.DefinitionLink>value;\n\t\tconst location = <vscode.Location>value;\n\t\treturn {\n\t\t\toriginSelectionRange: definitionLink.originSelectionRange\n\t\t\t\t? Range.from(definitionLink.originSelectionRange)\n\t\t\t\t: undefined,\n\t\t\turi: definitionLink.targetUri ? definitionLink.targetUri : location.uri,\n\t\t\trange: Range.from(definitionLink.targetRange ? definitionLink.targetRange : location.range),\n\t\t\ttargetSelectionRange: definitionLink.targetSelectionRange\n\t\t\t\t? Range.from(definitionLink.targetSelectionRange)\n\t\t\t\t: undefined,\n\t\t};\n\t}\n\texport function to(value: extHostProtocol.ILocationLinkDto): vscode.LocationLink {\n\t\treturn {\n\t\t\ttargetUri: URI.revive(value.uri),\n\t\t\ttargetRange: Range.to(value.range),\n\t\t\ttargetSelectionRange: value.targetSelectionRange\n\t\t\t\t? Range.to(value.targetSelectionRange)\n\t\t\t\t: undefined,\n\t\t\toriginSelectionRange: value.originSelectionRange\n\t\t\t\t? Range.to(value.originSelectionRange)\n\t\t\t\t: undefined\n\t\t};\n\t}\n}\n\nexport namespace Hover {\n\texport function from(hover: vscode.Hover): languages.Hover {\n\t\treturn <languages.Hover>{\n\t\t\trange: Range.from(hover.range),\n\t\t\tcontents: MarkdownString.fromMany(hover.contents)\n\t\t};\n\t}\n\n\texport function to(info: languages.Hover): types.Hover {\n\t\treturn new types.Hover(info.contents.map(MarkdownString.to), Range.to(info.range));\n\t}\n}\n\nexport namespace EvaluatableExpression {\n\texport function from(expression: vscode.EvaluatableExpression): languages.EvaluatableExpression {\n\t\treturn <languages.EvaluatableExpression>{\n\t\t\trange: Range.from(expression.range),\n\t\t\texpression: expression.expression\n\t\t};\n\t}\n\n\texport function to(info: languages.EvaluatableExpression): types.EvaluatableExpression {\n\t\treturn new types.EvaluatableExpression(Range.to(info.range), info.expression);\n\t}\n}\n\nexport namespace InlineValue {\n\texport function from(inlineValue: vscode.InlineValue): languages.InlineValue {\n\t\tif (inlineValue instanceof types.InlineValueText) {\n\t\t\treturn <languages.InlineValueText>{\n\t\t\t\ttype: 'text',\n\t\t\t\trange: Range.from(inlineValue.range),\n\t\t\t\ttext: inlineValue.text\n\t\t\t};\n\t\t} else if (inlineValue instanceof types.InlineValueVariableLookup) {\n\t\t\treturn <languages.InlineValueVariableLookup>{\n\t\t\t\ttype: 'variable',\n\t\t\t\trange: Range.from(inlineValue.range),\n\t\t\t\tvariableName: inlineValue.variableName,\n\t\t\t\tcaseSensitiveLookup: inlineValue.caseSensitiveLookup\n\t\t\t};\n\t\t} else if (inlineValue instanceof types.InlineValueEvaluatableExpression) {\n\t\t\treturn <languages.InlineValueExpression>{\n\t\t\t\ttype: 'expression',\n\t\t\t\trange: Range.from(inlineValue.range),\n\t\t\t\texpression: inlineValue.expression\n\t\t\t};\n\t\t} else {\n\t\t\tthrow new Error(`Unknown 'InlineValue' type`);\n\t\t}\n\t}\n\n\texport function to(inlineValue: languages.InlineValue): vscode.InlineValue {\n\t\tswitch (inlineValue.type) {\n\t\t\tcase 'text':\n\t\t\t\treturn <vscode.InlineValueText>{\n\t\t\t\t\trange: Range.to(inlineValue.range),\n\t\t\t\t\ttext: inlineValue.text\n\t\t\t\t};\n\t\t\tcase 'variable':\n\t\t\t\treturn <vscode.InlineValueVariableLookup>{\n\t\t\t\t\trange: Range.to(inlineValue.range),\n\t\t\t\t\tvariableName: inlineValue.variableName,\n\t\t\t\t\tcaseSensitiveLookup: inlineValue.caseSensitiveLookup\n\t\t\t\t};\n\t\t\tcase 'expression':\n\t\t\t\treturn <vscode.InlineValueEvaluatableExpression>{\n\t\t\t\t\trange: Range.to(inlineValue.range),\n\t\t\t\t\texpression: inlineValue.expression\n\t\t\t\t};\n\t\t}\n\t}\n}\n\nexport namespace InlineValueContext {\n\texport function from(inlineValueContext: vscode.InlineValueContext): extHostProtocol.IInlineValueContextDto {\n\t\treturn <extHostProtocol.IInlineValueContextDto>{\n\t\t\tframeId: inlineValueContext.frameId,\n\t\t\tstoppedLocation: Range.from(inlineValueContext.stoppedLocation)\n\t\t};\n\t}\n\n\texport function to(inlineValueContext: extHostProtocol.IInlineValueContextDto): types.InlineValueContext {\n\t\treturn new types.InlineValueContext(inlineValueContext.frameId, Range.to(inlineValueContext.stoppedLocation));\n\t}\n}\n\nexport namespace DocumentHighlight {\n\texport function from(documentHighlight: vscode.DocumentHighlight): languages.DocumentHighlight {\n\t\treturn {\n\t\t\trange: Range.from(documentHighlight.range),\n\t\t\tkind: documentHighlight.kind\n\t\t};\n\t}\n\texport function to(occurrence: languages.DocumentHighlight): types.DocumentHighlight {\n\t\treturn new types.DocumentHighlight(Range.to(occurrence.range), occurrence.kind);\n\t}\n}\n\nexport namespace CompletionTriggerKind {\n\texport function to(kind: languages.CompletionTriggerKind) {\n\t\tswitch (kind) {\n\t\t\tcase languages.CompletionTriggerKind.TriggerCharacter:\n\t\t\t\treturn types.CompletionTriggerKind.TriggerCharacter;\n\t\t\tcase languages.CompletionTriggerKind.TriggerForIncompleteCompletions:\n\t\t\t\treturn types.CompletionTriggerKind.TriggerForIncompleteCompletions;\n\t\t\tcase languages.CompletionTriggerKind.Invoke:\n\t\t\tdefault:\n\t\t\t\treturn types.CompletionTriggerKind.Invoke;\n\t\t}\n\t}\n}\n\nexport namespace CompletionContext {\n\texport function to(context: languages.CompletionContext): types.CompletionContext {\n\t\treturn {\n\t\t\ttriggerKind: CompletionTriggerKind.to(context.triggerKind),\n\t\t\ttriggerCharacter: context.triggerCharacter\n\t\t};\n\t}\n}\n\nexport namespace CompletionItemTag {\n\n\texport function from(kind: types.CompletionItemTag): languages.CompletionItemTag {\n\t\tswitch (kind) {\n\t\t\tcase types.CompletionItemTag.Deprecated: return languages.CompletionItemTag.Deprecated;\n\t\t}\n\t}\n\n\texport function to(kind: languages.CompletionItemTag): types.CompletionItemTag {\n\t\tswitch (kind) {\n\t\t\tcase languages.CompletionItemTag.Deprecated: return types.CompletionItemTag.Deprecated;\n\t\t}\n\t}\n}\n\nexport namespace CompletionItemKind {\n\n\tconst _from = new Map<types.CompletionItemKind, languages.CompletionItemKind>([\n\t\t[types.CompletionItemKind.Method, languages.CompletionItemKind.Method],\n\t\t[types.CompletionItemKind.Function, languages.CompletionItemKind.Function],\n\t\t[types.CompletionItemKind.Constructor, languages.CompletionItemKind.Constructor],\n\t\t[types.CompletionItemKind.Field, languages.CompletionItemKind.Field],\n\t\t[types.CompletionItemKind.Variable, languages.CompletionItemKind.Variable],\n\t\t[types.CompletionItemKind.Class, languages.CompletionItemKind.Class],\n\t\t[types.CompletionItemKind.Interface, languages.CompletionItemKind.Interface],\n\t\t[types.CompletionItemKind.Struct, languages.CompletionItemKind.Struct],\n\t\t[types.CompletionItemKind.Module, languages.CompletionItemKind.Module],\n\t\t[types.CompletionItemKind.Property, languages.CompletionItemKind.Property],\n\t\t[types.CompletionItemKind.Unit, languages.CompletionItemKind.Unit],\n\t\t[types.CompletionItemKind.Value, languages.CompletionItemKind.Value],\n\t\t[types.CompletionItemKind.Constant, languages.CompletionItemKind.Constant],\n\t\t[types.CompletionItemKind.Enum, languages.CompletionItemKind.Enum],\n\t\t[types.CompletionItemKind.EnumMember, languages.CompletionItemKind.EnumMember],\n\t\t[types.CompletionItemKind.Keyword, languages.CompletionItemKind.Keyword],\n\t\t[types.CompletionItemKind.Snippet, languages.CompletionItemKind.Snippet],\n\t\t[types.CompletionItemKind.Text, languages.CompletionItemKind.Text],\n\t\t[types.CompletionItemKind.Color, languages.CompletionItemKind.Color],\n\t\t[types.CompletionItemKind.File, languages.CompletionItemKind.File],\n\t\t[types.CompletionItemKind.Reference, languages.CompletionItemKind.Reference],\n\t\t[types.CompletionItemKind.Folder, languages.CompletionItemKind.Folder],\n\t\t[types.CompletionItemKind.Event, languages.CompletionItemKind.Event],\n\t\t[types.CompletionItemKind.Operator, languages.CompletionItemKind.Operator],\n\t\t[types.CompletionItemKind.TypeParameter, languages.CompletionItemKind.TypeParameter],\n\t\t[types.CompletionItemKind.Issue, languages.CompletionItemKind.Issue],\n\t\t[types.CompletionItemKind.User, languages.CompletionItemKind.User],\n\t]);\n\n\texport function from(kind: types.CompletionItemKind): languages.CompletionItemKind {\n\t\treturn _from.get(kind) ?? languages.CompletionItemKind.Property;\n\t}\n\n\tconst _to = new Map<languages.CompletionItemKind, types.CompletionItemKind>([\n\t\t[languages.CompletionItemKind.Method, types.CompletionItemKind.Method],\n\t\t[languages.CompletionItemKind.Function, types.CompletionItemKind.Function],\n\t\t[languages.CompletionItemKind.Constructor, types.CompletionItemKind.Constructor],\n\t\t[languages.CompletionItemKind.Field, types.CompletionItemKind.Field],\n\t\t[languages.CompletionItemKind.Variable, types.CompletionItemKind.Variable],\n\t\t[languages.CompletionItemKind.Class, types.CompletionItemKind.Class],\n\t\t[languages.CompletionItemKind.Interface, types.CompletionItemKind.Interface],\n\t\t[languages.CompletionItemKind.Struct, types.CompletionItemKind.Struct],\n\t\t[languages.CompletionItemKind.Module, types.CompletionItemKind.Module],\n\t\t[languages.CompletionItemKind.Property, types.CompletionItemKind.Property],\n\t\t[languages.CompletionItemKind.Unit, types.CompletionItemKind.Unit],\n\t\t[languages.CompletionItemKind.Value, types.CompletionItemKind.Value],\n\t\t[languages.CompletionItemKind.Constant, types.CompletionItemKind.Constant],\n\t\t[languages.CompletionItemKind.Enum, types.CompletionItemKind.Enum],\n\t\t[languages.CompletionItemKind.EnumMember, types.CompletionItemKind.EnumMember],\n\t\t[languages.CompletionItemKind.Keyword, types.CompletionItemKind.Keyword],\n\t\t[languages.CompletionItemKind.Snippet, types.CompletionItemKind.Snippet],\n\t\t[languages.CompletionItemKind.Text, types.CompletionItemKind.Text],\n\t\t[languages.CompletionItemKind.Color, types.CompletionItemKind.Color],\n\t\t[languages.CompletionItemKind.File, types.CompletionItemKind.File],\n\t\t[languages.CompletionItemKind.Reference, types.CompletionItemKind.Reference],\n\t\t[languages.CompletionItemKind.Folder, types.CompletionItemKind.Folder],\n\t\t[languages.CompletionItemKind.Event, types.CompletionItemKind.Event],\n\t\t[languages.CompletionItemKind.Operator, types.CompletionItemKind.Operator],\n\t\t[languages.CompletionItemKind.TypeParameter, types.CompletionItemKind.TypeParameter],\n\t\t[languages.CompletionItemKind.User, types.CompletionItemKind.User],\n\t\t[languages.CompletionItemKind.Issue, types.CompletionItemKind.Issue],\n\t]);\n\n\texport function to(kind: languages.CompletionItemKind): types.CompletionItemKind {\n\t\treturn _to.get(kind) ?? types.CompletionItemKind.Property;\n\t}\n}\n\nexport namespace CompletionItem {\n\n\texport function to(suggestion: languages.CompletionItem, converter?: Command.ICommandsConverter): types.CompletionItem {\n\n\t\tconst result = new types.CompletionItem(suggestion.label);\n\t\tresult.insertText = suggestion.insertText;\n\t\tresult.kind = CompletionItemKind.to(suggestion.kind);\n\t\tresult.tags = suggestion.tags?.map(CompletionItemTag.to);\n\t\tresult.detail = suggestion.detail;\n\t\tresult.documentation = htmlContent.isMarkdownString(suggestion.documentation) ? MarkdownString.to(suggestion.documentation) : suggestion.documentation;\n\t\tresult.sortText = suggestion.sortText;\n\t\tresult.filterText = suggestion.filterText;\n\t\tresult.preselect = suggestion.preselect;\n\t\tresult.commitCharacters = suggestion.commitCharacters;\n\n\t\t// range\n\t\tif (editorRange.Range.isIRange(suggestion.range)) {\n\t\t\tresult.range = Range.to(suggestion.range);\n\t\t} else if (typeof suggestion.range === 'object') {\n\t\t\tresult.range = { inserting: Range.to(suggestion.range.insert), replacing: Range.to(suggestion.range.replace) };\n\t\t}\n\n\t\tresult.keepWhitespace = typeof suggestion.insertTextRules === 'undefined' ? false : Boolean(suggestion.insertTextRules & languages.CompletionItemInsertTextRule.KeepWhitespace);\n\t\t// 'insertText'-logic\n\t\tif (typeof suggestion.insertTextRules !== 'undefined' && suggestion.insertTextRules & languages.CompletionItemInsertTextRule.InsertAsSnippet) {\n\t\t\tresult.insertText = new types.SnippetString(suggestion.insertText);\n\t\t} else {\n\t\t\tresult.insertText = suggestion.insertText;\n\t\t\tresult.textEdit = result.range instanceof types.Range ? new types.TextEdit(result.range, result.insertText) : undefined;\n\t\t}\n\t\tif (suggestion.additionalTextEdits && suggestion.additionalTextEdits.length > 0) {\n\t\t\tresult.additionalTextEdits = suggestion.additionalTextEdits.map(e => TextEdit.to(e as languages.TextEdit));\n\t\t}\n\t\tresult.command = converter && suggestion.command ? converter.fromInternal(suggestion.command) : undefined;\n\n\t\treturn result;\n\t}\n}\n\nexport namespace ParameterInformation {\n\texport function from(info: types.ParameterInformation): languages.ParameterInformation {\n\t\treturn {\n\t\t\tlabel: info.label,\n\t\t\tdocumentation: MarkdownString.fromStrict(info.documentation)\n\t\t};\n\t}\n\texport function to(info: languages.ParameterInformation): types.ParameterInformation {\n\t\treturn {\n\t\t\tlabel: info.label,\n\t\t\tdocumentation: htmlContent.isMarkdownString(info.documentation) ? MarkdownString.to(info.documentation) : info.documentation\n\t\t};\n\t}\n}\n\nexport namespace SignatureInformation {\n\n\texport function from(info: types.SignatureInformation): languages.SignatureInformation {\n\t\treturn {\n\t\t\tlabel: info.label,\n\t\t\tdocumentation: MarkdownString.fromStrict(info.documentation),\n\t\t\tparameters: Array.isArray(info.parameters) ? info.parameters.map(ParameterInformation.from) : [],\n\t\t\tactiveParameter: info.activeParameter,\n\t\t};\n\t}\n\n\texport function to(info: languages.SignatureInformation): types.SignatureInformation {\n\t\treturn {\n\t\t\tlabel: info.label,\n\t\t\tdocumentation: htmlContent.isMarkdownString(info.documentation) ? MarkdownString.to(info.documentation) : info.documentation,\n\t\t\tparameters: Array.isArray(info.parameters) ? info.parameters.map(ParameterInformation.to) : [],\n\t\t\tactiveParameter: info.activeParameter,\n\t\t};\n\t}\n}\n\nexport namespace SignatureHelp {\n\n\texport function from(help: types.SignatureHelp): languages.SignatureHelp {\n\t\treturn {\n\t\t\tactiveSignature: help.activeSignature,\n\t\t\tactiveParameter: help.activeParameter,\n\t\t\tsignatures: Array.isArray(help.signatures) ? help.signatures.map(SignatureInformation.from) : [],\n\t\t};\n\t}\n\n\texport function to(help: languages.SignatureHelp): types.SignatureHelp {\n\t\treturn {\n\t\t\tactiveSignature: help.activeSignature,\n\t\t\tactiveParameter: help.activeParameter,\n\t\t\tsignatures: Array.isArray(help.signatures) ? help.signatures.map(SignatureInformation.to) : [],\n\t\t};\n\t}\n}\n\nexport namespace InlayHint {\n\n\texport function to(converter: Command.ICommandsConverter, hint: languages.InlayHint): vscode.InlayHint {\n\t\tconst res = new types.InlayHint(\n\t\t\tPosition.to(hint.position),\n\t\t\ttypeof hint.label === 'string' ? hint.label : hint.label.map(InlayHintLabelPart.to.bind(undefined, converter)),\n\t\t\thint.kind && InlayHintKind.to(hint.kind)\n\t\t);\n\t\tres.textEdits = hint.textEdits && hint.textEdits.map(TextEdit.to);\n\t\tres.tooltip = htmlContent.isMarkdownString(hint.tooltip) ? MarkdownString.to(hint.tooltip) : hint.tooltip;\n\t\tres.paddingLeft = hint.paddingLeft;\n\t\tres.paddingRight = hint.paddingRight;\n\t\treturn res;\n\t}\n}\n\nexport namespace InlayHintLabelPart {\n\n\texport function to(converter: Command.ICommandsConverter, part: languages.InlayHintLabelPart): types.InlayHintLabelPart {\n\t\tconst result = new types.InlayHintLabelPart(part.label);\n\t\tresult.tooltip = htmlContent.isMarkdownString(part.tooltip)\n\t\t\t? MarkdownString.to(part.tooltip)\n\t\t\t: part.tooltip;\n\t\tif (languages.Command.is(part.command)) {\n\t\t\tresult.command = converter.fromInternal(part.command);\n\t\t}\n\t\tif (part.location) {\n\t\t\tresult.location = location.to(part.location);\n\t\t}\n\t\treturn result;\n\t}\n}\n\nexport namespace InlayHintKind {\n\texport function from(kind: vscode.InlayHintKind): languages.InlayHintKind {\n\t\treturn kind;\n\t}\n\texport function to(kind: languages.InlayHintKind): vscode.InlayHintKind {\n\t\treturn kind;\n\t}\n}\n\nexport namespace DocumentLink {\n\n\texport function from(link: vscode.DocumentLink): languages.ILink {\n\t\treturn {\n\t\t\trange: Range.from(link.range),\n\t\t\turl: link.target,\n\t\t\ttooltip: link.tooltip\n\t\t};\n\t}\n\n\texport function to(link: languages.ILink): vscode.DocumentLink {\n\t\tlet target: URI | undefined = undefined;\n\t\tif (link.url) {\n\t\t\ttry {\n\t\t\t\ttarget = typeof link.url === 'string' ? URI.parse(link.url, true) : URI.revive(link.url);\n\t\t\t} catch (err) {\n\t\t\t\t// ignore\n\t\t\t}\n\t\t}\n\t\treturn new types.DocumentLink(Range.to(link.range), target);\n\t}\n}\n\nexport namespace ColorPresentation {\n\texport function to(colorPresentation: languages.IColorPresentation): types.ColorPresentation {\n\t\tconst cp = new types.ColorPresentation(colorPresentation.label);\n\t\tif (colorPresentation.textEdit) {\n\t\t\tcp.textEdit = TextEdit.to(colorPresentation.textEdit);\n\t\t}\n\t\tif (colorPresentation.additionalTextEdits) {\n\t\t\tcp.additionalTextEdits = colorPresentation.additionalTextEdits.map(value => TextEdit.to(value));\n\t\t}\n\t\treturn cp;\n\t}\n\n\texport function from(colorPresentation: vscode.ColorPresentation): languages.IColorPresentation {\n\t\treturn {\n\t\t\tlabel: colorPresentation.label,\n\t\t\ttextEdit: colorPresentation.textEdit ? TextEdit.from(colorPresentation.textEdit) : undefined,\n\t\t\tadditionalTextEdits: colorPresentation.additionalTextEdits ? colorPresentation.additionalTextEdits.map(value => TextEdit.from(value)) : undefined\n\t\t};\n\t}\n}\n\nexport namespace Color {\n\texport function to(c: [number, number, number, number]): types.Color {\n\t\treturn new types.Color(c[0], c[1], c[2], c[3]);\n\t}\n\texport function from(color: types.Color): [number, number, number, number] {\n\t\treturn [color.red, color.green, color.blue, color.alpha];\n\t}\n}\n\n\nexport namespace SelectionRange {\n\texport function from(obj: vscode.SelectionRange): languages.SelectionRange {\n\t\treturn { range: Range.from(obj.range) };\n\t}\n\n\texport function to(obj: languages.SelectionRange): vscode.SelectionRange {\n\t\treturn new types.SelectionRange(Range.to(obj.range));\n\t}\n}\n\nexport namespace TextDocumentSaveReason {\n\n\texport function to(reason: SaveReason): vscode.TextDocumentSaveReason {\n\t\tswitch (reason) {\n\t\t\tcase SaveReason.AUTO:\n\t\t\t\treturn types.TextDocumentSaveReason.AfterDelay;\n\t\t\tcase SaveReason.EXPLICIT:\n\t\t\t\treturn types.TextDocumentSaveReason.Manual;\n\t\t\tcase SaveReason.FOCUS_CHANGE:\n\t\t\tcase SaveReason.WINDOW_CHANGE:\n\t\t\t\treturn types.TextDocumentSaveReason.FocusOut;\n\t\t}\n\t}\n}\n\nexport namespace TextEditorLineNumbersStyle {\n\texport function from(style: vscode.TextEditorLineNumbersStyle): RenderLineNumbersType {\n\t\tswitch (style) {\n\t\t\tcase types.TextEditorLineNumbersStyle.Off:\n\t\t\t\treturn RenderLineNumbersType.Off;\n\t\t\tcase types.TextEditorLineNumbersStyle.Relative:\n\t\t\t\treturn RenderLineNumbersType.Relative;\n\t\t\tcase types.TextEditorLineNumbersStyle.On:\n\t\t\tdefault:\n\t\t\t\treturn RenderLineNumbersType.On;\n\t\t}\n\t}\n\texport function to(style: RenderLineNumbersType): vscode.TextEditorLineNumbersStyle {\n\t\tswitch (style) {\n\t\t\tcase RenderLineNumbersType.Off:\n\t\t\t\treturn types.TextEditorLineNumbersStyle.Off;\n\t\t\tcase RenderLineNumbersType.Relative:\n\t\t\t\treturn types.TextEditorLineNumbersStyle.Relative;\n\t\t\tcase RenderLineNumbersType.On:\n\t\t\tdefault:\n\t\t\t\treturn types.TextEditorLineNumbersStyle.On;\n\t\t}\n\t}\n}\n\nexport namespace EndOfLine {\n\n\texport function from(eol: vscode.EndOfLine): EndOfLineSequence | undefined {\n\t\tif (eol === types.EndOfLine.CRLF) {\n\t\t\treturn EndOfLineSequence.CRLF;\n\t\t} else if (eol === types.EndOfLine.LF) {\n\t\t\treturn EndOfLineSequence.LF;\n\t\t}\n\t\treturn undefined;\n\t}\n\n\texport function to(eol: EndOfLineSequence): vscode.EndOfLine | undefined {\n\t\tif (eol === EndOfLineSequence.CRLF) {\n\t\t\treturn types.EndOfLine.CRLF;\n\t\t} else if (eol === EndOfLineSequence.LF) {\n\t\t\treturn types.EndOfLine.LF;\n\t\t}\n\t\treturn undefined;\n\t}\n}\n\nexport namespace ProgressLocation {\n\texport function from(loc: vscode.ProgressLocation | { viewId: string }): MainProgressLocation | string {\n\t\tif (typeof loc === 'object') {\n\t\t\treturn loc.viewId;\n\t\t}\n\n\t\tswitch (loc) {\n\t\t\tcase types.ProgressLocation.SourceControl: return MainProgressLocation.Scm;\n\t\t\tcase types.ProgressLocation.Window: return MainProgressLocation.Window;\n\t\t\tcase types.ProgressLocation.Notification: return MainProgressLocation.Notification;\n\t\t}\n\t\tthrow new Error(`Unknown 'ProgressLocation'`);\n\t}\n}\n\nexport namespace FoldingRange {\n\texport function from(r: vscode.FoldingRange): languages.FoldingRange {\n\t\tconst range: languages.FoldingRange = { start: r.start + 1, end: r.end + 1 };\n\t\tif (r.kind) {\n\t\t\trange.kind = FoldingRangeKind.from(r.kind);\n\t\t}\n\t\treturn range;\n\t}\n}\n\nexport namespace FoldingRangeKind {\n\texport function from(kind: vscode.FoldingRangeKind | undefined): languages.FoldingRangeKind | undefined {\n\t\tif (kind) {\n\t\t\tswitch (kind) {\n\t\t\t\tcase types.FoldingRangeKind.Comment:\n\t\t\t\t\treturn languages.FoldingRangeKind.Comment;\n\t\t\t\tcase types.FoldingRangeKind.Imports:\n\t\t\t\t\treturn languages.FoldingRangeKind.Imports;\n\t\t\t\tcase types.FoldingRangeKind.Region:\n\t\t\t\t\treturn languages.FoldingRangeKind.Region;\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n}\n\nexport interface TextEditorOpenOptions extends vscode.TextDocumentShowOptions {\n\tbackground?: boolean;\n\toverride?: boolean;\n}\n\nexport namespace TextEditorOpenOptions {\n\n\texport function from(options?: TextEditorOpenOptions): ITextEditorOptions | undefined {\n\t\tif (options) {\n\t\t\treturn {\n\t\t\t\tpinned: typeof options.preview === 'boolean' ? !options.preview : undefined,\n\t\t\t\tinactive: options.background,\n\t\t\t\tpreserveFocus: options.preserveFocus,\n\t\t\t\tselection: typeof options.selection === 'object' ? Range.from(options.selection) : undefined,\n\t\t\t\toverride: typeof options.override === 'boolean' ? EditorResolution.DISABLED : undefined\n\t\t\t};\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n}\n\nexport namespace GlobPattern {\n\n\texport function from(pattern: vscode.GlobPattern): string | extHostProtocol.IRelativePatternDto;\n\texport function from(pattern: undefined): undefined;\n\texport function from(pattern: null): null;\n\texport function from(pattern: vscode.GlobPattern | undefined | null): string | extHostProtocol.IRelativePatternDto | undefined | null;\n\texport function from(pattern: vscode.GlobPattern | undefined | null): string | extHostProtocol.IRelativePatternDto | undefined | null {\n\t\tif (pattern instanceof types.RelativePattern) {\n\t\t\treturn pattern.toJSON();\n\t\t}\n\n\t\tif (typeof pattern === 'string') {\n\t\t\treturn pattern;\n\t\t}\n\n\t\t// This is slightly bogus because we declare this method to accept\n\t\t// `vscode.GlobPattern` which can be `vscode.RelativePattern` class,\n\t\t// but given we cannot enforce classes from our vscode.d.ts, we have\n\t\t// to probe for objects too\n\t\t// Refs: https://github.com/microsoft/vscode/issues/140771\n\t\tif (isRelativePatternShape(pattern) || isLegacyRelativePatternShape(pattern)) {\n\t\t\treturn new types.RelativePattern(pattern.baseUri ?? pattern.base, pattern.pattern).toJSON();\n\t\t}\n\n\t\treturn pattern; // preserve `undefined` and `null`\n\t}\n\n\tfunction isRelativePatternShape(obj: unknown): obj is { base: string; baseUri: URI; pattern: string } {\n\t\tconst rp = obj as { base: string; baseUri: URI; pattern: string } | undefined | null;\n\t\tif (!rp) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn URI.isUri(rp.baseUri) && typeof rp.pattern === 'string';\n\t}\n\n\tfunction isLegacyRelativePatternShape(obj: unknown): obj is { base: string; pattern: string } {\n\n\t\t// Before 1.64.x, `RelativePattern` did not have any `baseUri: Uri`\n\t\t// property. To preserve backwards compatibility with older extensions\n\t\t// we allow this old format when creating the `vscode.RelativePattern`.\n\n\t\tconst rp = obj as { base: string; pattern: string } | undefined | null;\n\t\tif (!rp) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn typeof rp.base === 'string' && typeof rp.pattern === 'string';\n\t}\n\n\texport function to(pattern: string | extHostProtocol.IRelativePatternDto): vscode.GlobPattern {\n\t\tif (typeof pattern === 'string') {\n\t\t\treturn pattern;\n\t\t}\n\n\t\treturn new types.RelativePattern(URI.revive(pattern.baseUri), pattern.pattern);\n\t}\n}\n\nexport namespace LanguageSelector {\n\n\texport function from(selector: undefined): undefined;\n\texport function from(selector: vscode.DocumentSelector): languageSelector.LanguageSelector;\n\texport function from(selector: vscode.DocumentSelector | undefined): languageSelector.LanguageSelector | undefined;\n\texport function from(selector: vscode.DocumentSelector | undefined): languageSelector.LanguageSelector | undefined {\n\t\tif (!selector) {\n\t\t\treturn undefined;\n\t\t} else if (Array.isArray(selector)) {\n\t\t\treturn <languageSelector.LanguageSelector>selector.map(from);\n\t\t} else if (typeof selector === 'string') {\n\t\t\treturn selector;\n\t\t} else {\n\t\t\tconst filter = selector as vscode.DocumentFilter; // TODO: microsoft/TypeScript#42768\n\t\t\treturn <languageSelector.LanguageFilter>{\n\t\t\t\tlanguage: filter.language,\n\t\t\t\tscheme: filter.scheme,\n\t\t\t\tpattern: GlobPattern.from(filter.pattern),\n\t\t\t\texclusive: filter.exclusive,\n\t\t\t\tnotebookType: filter.notebookType\n\t\t\t};\n\t\t}\n\t}\n}\n\nexport namespace NotebookRange {\n\n\texport function from(range: vscode.NotebookRange): ICellRange {\n\t\treturn { start: range.start, end: range.end };\n\t}\n\n\texport function to(range: ICellRange): types.NotebookRange {\n\t\treturn new types.NotebookRange(range.start, range.end);\n\t}\n}\n\nexport namespace NotebookCellExecutionSummary {\n\texport function to(data: notebooks.NotebookCellInternalMetadata): vscode.NotebookCellExecutionSummary {\n\t\treturn {\n\t\t\ttiming: typeof data.runStartTime === 'number' && typeof data.runEndTime === 'number' ? { startTime: data.runStartTime, endTime: data.runEndTime } : undefined,\n\t\t\texecutionOrder: data.executionOrder,\n\t\t\tsuccess: data.lastRunSuccess\n\t\t};\n\t}\n\n\texport function from(data: vscode.NotebookCellExecutionSummary): Partial<notebooks.NotebookCellInternalMetadata> {\n\t\treturn {\n\t\t\tlastRunSuccess: data.success,\n\t\t\trunStartTime: data.timing?.startTime,\n\t\t\trunEndTime: data.timing?.endTime,\n\t\t\texecutionOrder: data.executionOrder\n\t\t};\n\t}\n}\n\nexport namespace NotebookCellExecutionState {\n\texport function to(state: notebooks.NotebookCellExecutionState): vscode.NotebookCellExecutionState {\n\t\tif (state === notebooks.NotebookCellExecutionState.Executing) {\n\t\t\treturn types.NotebookCellExecutionState.Executing;\n\t\t} else if (state === notebooks.NotebookCellExecutionState.Pending) {\n\t\t\treturn types.NotebookCellExecutionState.Pending;\n\t\t} else if (state === notebooks.NotebookCellExecutionState.Unconfirmed) {\n\t\t\treturn types.NotebookCellExecutionState.Pending;\n\t\t} else {\n\t\t\tthrow new Error(`Unknown state: ${state}`);\n\t\t}\n\t}\n}\n\nexport namespace NotebookCellKind {\n\texport function from(data: vscode.NotebookCellKind): notebooks.CellKind {\n\t\tswitch (data) {\n\t\t\tcase types.NotebookCellKind.Markup:\n\t\t\t\treturn notebooks.CellKind.Markup;\n\t\t\tcase types.NotebookCellKind.Code:\n\t\t\tdefault:\n\t\t\t\treturn notebooks.CellKind.Code;\n\t\t}\n\t}\n\n\texport function to(data: notebooks.CellKind): vscode.NotebookCellKind {\n\t\tswitch (data) {\n\t\t\tcase notebooks.CellKind.Markup:\n\t\t\t\treturn types.NotebookCellKind.Markup;\n\t\t\tcase notebooks.CellKind.Code:\n\t\t\tdefault:\n\t\t\t\treturn types.NotebookCellKind.Code;\n\t\t}\n\t}\n}\n\nexport namespace NotebookData {\n\n\texport function from(data: vscode.NotebookData): extHostProtocol.NotebookDataDto {\n\t\tconst res: extHostProtocol.NotebookDataDto = {\n\t\t\tmetadata: data.metadata ?? Object.create(null),\n\t\t\tcells: [],\n\t\t};\n\t\tfor (const cell of data.cells) {\n\t\t\ttypes.NotebookCellData.validate(cell);\n\t\t\tres.cells.push(NotebookCellData.from(cell));\n\t\t}\n\t\treturn res;\n\t}\n\n\texport function to(data: extHostProtocol.NotebookDataDto): vscode.NotebookData {\n\t\tconst res = new types.NotebookData(\n\t\t\tdata.cells.map(NotebookCellData.to),\n\t\t);\n\t\tif (!isEmptyObject(data.metadata)) {\n\t\t\tres.metadata = data.metadata;\n\t\t}\n\t\treturn res;\n\t}\n}\n\nexport namespace NotebookCellData {\n\n\texport function from(data: vscode.NotebookCellData): extHostProtocol.NotebookCellDataDto {\n\t\treturn {\n\t\t\tcellKind: NotebookCellKind.from(data.kind),\n\t\t\tlanguage: data.languageId,\n\t\t\tmime: data.mime,\n\t\t\tsource: data.value,\n\t\t\tmetadata: data.metadata,\n\t\t\tinternalMetadata: NotebookCellExecutionSummary.from(data.executionSummary ?? {}),\n\t\t\toutputs: data.outputs ? data.outputs.map(NotebookCellOutput.from) : []\n\t\t};\n\t}\n\n\texport function to(data: extHostProtocol.NotebookCellDataDto): vscode.NotebookCellData {\n\t\treturn new types.NotebookCellData(\n\t\t\tNotebookCellKind.to(data.cellKind),\n\t\t\tdata.source,\n\t\t\tdata.language,\n\t\t\tdata.mime,\n\t\t\tdata.outputs ? data.outputs.map(NotebookCellOutput.to) : undefined,\n\t\t\tdata.metadata,\n\t\t\tdata.internalMetadata ? NotebookCellExecutionSummary.to(data.internalMetadata) : undefined\n\t\t);\n\t}\n}\n\nexport namespace NotebookCellOutputItem {\n\texport function from(item: types.NotebookCellOutputItem): extHostProtocol.NotebookOutputItemDto {\n\t\treturn {\n\t\t\tmime: item.mime,\n\t\t\tvalueBytes: VSBuffer.wrap(item.data),\n\t\t};\n\t}\n\n\texport function to(item: extHostProtocol.NotebookOutputItemDto): types.NotebookCellOutputItem {\n\t\treturn new types.NotebookCellOutputItem(item.valueBytes.buffer, item.mime);\n\t}\n}\n\nexport namespace NotebookCellOutput {\n\texport function from(output: vscode.NotebookCellOutput): extHostProtocol.NotebookOutputDto {\n\t\treturn {\n\t\t\toutputId: output.id,\n\t\t\titems: output.items.map(NotebookCellOutputItem.from),\n\t\t\tmetadata: output.metadata\n\t\t};\n\t}\n\n\texport function to(output: extHostProtocol.NotebookOutputDto): vscode.NotebookCellOutput {\n\t\tconst items = output.items.map(NotebookCellOutputItem.to);\n\t\treturn new types.NotebookCellOutput(items, output.outputId, output.metadata);\n\t}\n}\n\n\nexport namespace NotebookExclusiveDocumentPattern {\n\texport function from(pattern: { include: vscode.GlobPattern | undefined; exclude: vscode.GlobPattern | undefined }): { include: string | extHostProtocol.IRelativePatternDto | undefined; exclude: string | extHostProtocol.IRelativePatternDto | undefined };\n\texport function from(pattern: vscode.GlobPattern): string | extHostProtocol.IRelativePatternDto;\n\texport function from(pattern: undefined): undefined;\n\texport function from(pattern: { include: vscode.GlobPattern | undefined | null; exclude: vscode.GlobPattern | undefined } | vscode.GlobPattern | undefined): string | extHostProtocol.IRelativePatternDto | { include: string | extHostProtocol.IRelativePatternDto | undefined; exclude: string | extHostProtocol.IRelativePatternDto | undefined } | undefined;\n\texport function from(pattern: { include: vscode.GlobPattern | undefined | null; exclude: vscode.GlobPattern | undefined } | vscode.GlobPattern | undefined): string | extHostProtocol.IRelativePatternDto | { include: string | extHostProtocol.IRelativePatternDto | undefined; exclude: string | extHostProtocol.IRelativePatternDto | undefined } | undefined {\n\t\tif (isExclusivePattern(pattern)) {\n\t\t\treturn {\n\t\t\t\tinclude: withNullAsUndefined(GlobPattern.from(pattern.include)),\n\t\t\t\texclude: withNullAsUndefined(GlobPattern.from(pattern.exclude))\n\t\t\t};\n\t\t}\n\n\t\treturn withNullAsUndefined(GlobPattern.from(pattern));\n\t}\n\n\texport function to(pattern: string | extHostProtocol.IRelativePatternDto | { include: string | extHostProtocol.IRelativePatternDto; exclude: string | extHostProtocol.IRelativePatternDto }): { include: vscode.GlobPattern; exclude: vscode.GlobPattern } | vscode.GlobPattern {\n\t\tif (isExclusivePattern(pattern)) {\n\t\t\treturn {\n\t\t\t\tinclude: GlobPattern.to(pattern.include),\n\t\t\t\texclude: GlobPattern.to(pattern.exclude)\n\t\t\t};\n\t\t}\n\n\t\treturn GlobPattern.to(pattern);\n\t}\n\n\tfunction isExclusivePattern<T>(obj: any): obj is { include?: T; exclude?: T } {\n\t\tconst ep = obj as { include?: T; exclude?: T } | undefined | null;\n\t\tif (!ep) {\n\t\t\treturn false;\n\t\t}\n\t\treturn !isUndefinedOrNull(ep.include) && !isUndefinedOrNull(ep.exclude);\n\t}\n}\n\nexport namespace NotebookStatusBarItem {\n\texport function from(item: vscode.NotebookCellStatusBarItem, commandsConverter: Command.ICommandsConverter, disposables: DisposableStore): notebooks.INotebookCellStatusBarItem {\n\t\tconst command = typeof item.command === 'string' ? { title: '', command: item.command } : item.command;\n\t\treturn {\n\t\t\talignment: item.alignment === types.NotebookCellStatusBarAlignment.Left ? notebooks.CellStatusbarAlignment.Left : notebooks.CellStatusbarAlignment.Right,\n\t\t\tcommand: commandsConverter.toInternal(command, disposables), // TODO@roblou\n\t\t\ttext: item.text,\n\t\t\ttooltip: item.tooltip,\n\t\t\taccessibilityInformation: item.accessibilityInformation,\n\t\t\tpriority: item.priority\n\t\t};\n\t}\n}\n\nexport namespace NotebookDocumentContentOptions {\n\texport function from(options: vscode.NotebookDocumentContentOptions | undefined): notebooks.TransientOptions {\n\t\treturn {\n\t\t\ttransientOutputs: options?.transientOutputs ?? false,\n\t\t\ttransientCellMetadata: options?.transientCellMetadata ?? {},\n\t\t\ttransientDocumentMetadata: options?.transientDocumentMetadata ?? {}\n\t\t};\n\t}\n}\n\nexport namespace NotebookRendererScript {\n\texport function from(preload: vscode.NotebookRendererScript): { uri: UriComponents; provides: string[] } {\n\t\treturn {\n\t\t\turi: preload.uri,\n\t\t\tprovides: preload.provides\n\t\t};\n\t}\n\texport function to(preload: { uri: UriComponents; provides: string[] }): vscode.NotebookRendererScript {\n\t\treturn new types.NotebookRendererScript(URI.revive(preload.uri), preload.provides);\n\t}\n}\n\nexport namespace TestMessage {\n\texport function from(message: vscode.TestMessage): ITestErrorMessage.Serialized {\n\t\treturn {\n\t\t\tmessage: MarkdownString.fromStrict(message.message) || '',\n\t\t\ttype: TestMessageType.Error,\n\t\t\texpected: message.expectedOutput,\n\t\t\tactual: message.actualOutput,\n\t\t\tlocation: message.location && ({ range: Range.from(message.location.range), uri: message.location.uri }),\n\t\t};\n\t}\n\n\texport function to(item: ITestErrorMessage.Serialized): vscode.TestMessage {\n\t\tconst message = new types.TestMessage(typeof item.message === 'string' ? item.message : MarkdownString.to(item.message));\n\t\tmessage.actualOutput = item.actual;\n\t\tmessage.expectedOutput = item.expected;\n\t\tmessage.location = item.location ? location.to(item.location) : undefined;\n\t\treturn message;\n\t}\n}\n\nexport namespace TestTag {\n\texport const namespace = namespaceTestTag;\n\n\texport const denamespace = denamespaceTestTag;\n}\n\nexport namespace TestItem {\n\texport type Raw = vscode.TestItem;\n\n\texport function from(item: vscode.TestItem): ITestItem {\n\t\tconst ctrlId = getPrivateApiFor(item).controllerId;\n\t\treturn {\n\t\t\textId: TestId.fromExtHostTestItem(item, ctrlId).toString(),\n\t\t\tlabel: item.label,\n\t\t\turi: URI.revive(item.uri),\n\t\t\tbusy: false,\n\t\t\ttags: item.tags.map(t => TestTag.namespace(ctrlId, t.id)),\n\t\t\trange: editorRange.Range.lift(Range.from(item.range)),\n\t\t\tdescription: item.description || null,\n\t\t\tsortText: item.sortText || null,\n\t\t\terror: item.error ? (MarkdownString.fromStrict(item.error) || null) : null,\n\t\t};\n\t}\n\n\texport function toPlain(item: ITestItem.Serialized): vscode.TestItem {\n\t\treturn {\n\t\t\tparent: undefined,\n\t\t\terror: undefined,\n\t\t\tid: TestId.fromString(item.extId).localId,\n\t\t\tlabel: item.label,\n\t\t\turi: URI.revive(item.uri),\n\t\t\ttags: (item.tags || []).map(t => {\n\t\t\t\tconst { tagId } = TestTag.denamespace(t);\n\t\t\t\treturn new types.TestTag(tagId);\n\t\t\t}),\n\t\t\tchildren: {\n\t\t\t\tadd: () => { },\n\t\t\t\tdelete: () => { },\n\t\t\t\tforEach: () => { },\n\t\t\t\t*[Symbol.iterator]() { },\n\t\t\t\tget: () => undefined,\n\t\t\t\treplace: () => { },\n\t\t\t\tsize: 0,\n\t\t\t},\n\t\t\trange: Range.to(item.range || undefined),\n\t\t\tcanResolveChildren: false,\n\t\t\tbusy: false,\n\t\t\tdescription: item.description || undefined,\n\t\t\tsortText: item.sortText || undefined,\n\t\t};\n\t}\n}\n\nexport namespace TestTag {\n\texport function from(tag: vscode.TestTag): ITestTag {\n\t\treturn { id: tag.id };\n\t}\n\n\texport function to(tag: ITestTag): vscode.TestTag {\n\t\treturn new types.TestTag(tag.id);\n\t}\n}\n\nexport namespace TestResults {\n\tconst convertTestResultItem = (item: TestResultItem.Serialized, byInternalId: Map<string, TestResultItem.Serialized>): vscode.TestResultSnapshot => {\n\t\tconst snapshot: vscode.TestResultSnapshot = ({\n\t\t\t...TestItem.toPlain(item.item),\n\t\t\tparent: undefined,\n\t\t\ttaskStates: item.tasks.map(t => ({\n\t\t\t\tstate: t.state as number as types.TestResultState,\n\t\t\t\tduration: t.duration,\n\t\t\t\tmessages: t.messages\n\t\t\t\t\t.filter((m): m is ITestErrorMessage.Serialized => m.type === TestMessageType.Error)\n\t\t\t\t\t.map(TestMessage.to),\n\t\t\t})),\n\t\t\tchildren: item.children\n\t\t\t\t.map(c => byInternalId.get(c))\n\t\t\t\t.filter(isDefined)\n\t\t\t\t.map(c => convertTestResultItem(c, byInternalId))\n\t\t});\n\n\t\tfor (const child of snapshot.children) {\n\t\t\t(child as any).parent = snapshot;\n\t\t}\n\n\t\treturn snapshot;\n\t};\n\n\texport function to(serialized: ISerializedTestResults): vscode.TestRunResult {\n\t\tconst roots: TestResultItem.Serialized[] = [];\n\t\tconst byInternalId = new Map<string, TestResultItem.Serialized>();\n\t\tfor (const item of serialized.items) {\n\t\t\tbyInternalId.set(item.item.extId, item);\n\t\t\tif (serialized.request.targets.some(t => t.controllerId === item.controllerId && t.testIds.includes(item.item.extId))) {\n\t\t\t\troots.push(item);\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tcompletedAt: serialized.completedAt,\n\t\t\tresults: roots.map(r => convertTestResultItem(r, byInternalId)),\n\t\t};\n\t}\n}\n\nexport namespace TestCoverage {\n\tfunction fromCoveredCount(count: vscode.CoveredCount): ICoveredCount {\n\t\treturn { covered: count.covered, total: count.covered };\n\t}\n\n\tfunction fromLocation(location: vscode.Range | vscode.Position) {\n\t\treturn 'line' in location ? Position.from(location) : Range.from(location);\n\t}\n\n\texport function fromDetailed(coverage: vscode.DetailedCoverage): CoverageDetails {\n\t\tif ('branches' in coverage) {\n\t\t\treturn {\n\t\t\t\tcount: coverage.executionCount,\n\t\t\t\tlocation: fromLocation(coverage.location),\n\t\t\t\ttype: DetailType.Statement,\n\t\t\t\tbranches: coverage.branches.length\n\t\t\t\t\t? coverage.branches.map(b => ({ count: b.executionCount, location: b.location && fromLocation(b.location) }))\n\t\t\t\t\t: undefined,\n\t\t\t};\n\t\t} else {\n\t\t\treturn {\n\t\t\t\ttype: DetailType.Function,\n\t\t\t\tcount: coverage.executionCount,\n\t\t\t\tlocation: fromLocation(coverage.location),\n\t\t\t};\n\t\t}\n\t}\n\n\texport function fromFile(coverage: vscode.FileCoverage): IFileCoverage {\n\t\treturn {\n\t\t\turi: coverage.uri,\n\t\t\tstatement: fromCoveredCount(coverage.statementCoverage),\n\t\t\tbranch: coverage.branchCoverage && fromCoveredCount(coverage.branchCoverage),\n\t\t\tfunction: coverage.functionCoverage && fromCoveredCount(coverage.functionCoverage),\n\t\t\tdetails: coverage.detailedCoverage?.map(fromDetailed),\n\t\t};\n\t}\n}\n\nexport namespace CodeActionTriggerKind {\n\n\texport function to(value: languages.CodeActionTriggerType): types.CodeActionTriggerKind {\n\t\tswitch (value) {\n\t\t\tcase languages.CodeActionTriggerType.Invoke:\n\t\t\t\treturn types.CodeActionTriggerKind.Invoke;\n\n\t\t\tcase languages.CodeActionTriggerType.Auto:\n\t\t\t\treturn types.CodeActionTriggerKind.Automatic;\n\t\t}\n\t}\n}\n\nexport namespace TypeHierarchyItem {\n\n\texport function to(item: extHostProtocol.ITypeHierarchyItemDto): types.TypeHierarchyItem {\n\t\tconst result = new types.TypeHierarchyItem(\n\t\t\tSymbolKind.to(item.kind),\n\t\t\titem.name,\n\t\t\titem.detail || '',\n\t\t\tURI.revive(item.uri),\n\t\t\tRange.to(item.range),\n\t\t\tRange.to(item.selectionRange)\n\t\t);\n\n\t\tresult._sessionId = item._sessionId;\n\t\tresult._itemId = item._itemId;\n\n\t\treturn result;\n\t}\n\n\texport function from(item: vscode.TypeHierarchyItem, sessionId?: string, itemId?: string): extHostProtocol.ITypeHierarchyItemDto {\n\n\t\tsessionId = sessionId ?? (<types.TypeHierarchyItem>item)._sessionId;\n\t\titemId = itemId ?? (<types.TypeHierarchyItem>item)._itemId;\n\n\t\tif (sessionId === undefined || itemId === undefined) {\n\t\t\tthrow new Error('invalid item');\n\t\t}\n\n\t\treturn {\n\t\t\t_sessionId: sessionId,\n\t\t\t_itemId: itemId,\n\t\t\tkind: SymbolKind.from(item.kind),\n\t\t\tname: item.name,\n\t\t\tdetail: item.detail ?? '',\n\t\t\turi: item.uri,\n\t\t\trange: Range.from(item.range),\n\t\t\tselectionRange: Range.from(item.selectionRange),\n\t\t\ttags: item.tags?.map(SymbolTag.from)\n\t\t};\n\t}\n}\n\nexport namespace ViewBadge {\n\texport function from(badge: vscode.ViewBadge | undefined): IViewBadge | undefined {\n\t\tif (!badge) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn {\n\t\t\tvalue: badge.value,\n\t\t\ttooltip: badge.tooltip\n\t\t};\n\t}\n}\n\nexport namespace DataTransferItem {\n\texport function toDataTransferItem(item: extHostProtocol.DataTransferItemDTO, resolveFileData: () => Promise<Uint8Array>): types.DataTransferItem {\n\t\tconst file = item.fileData;\n\t\tif (file) {\n\t\t\treturn new class extends types.DataTransferItem {\n\t\t\t\toverride asFile(): vscode.DataTransferFile {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tname: file.name,\n\t\t\t\t\t\turi: URI.revive(file.uri),\n\t\t\t\t\t\tdata: once(() => resolveFileData()),\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}('');\n\t\t} else {\n\t\t\treturn new types.DataTransferItem(item.asString);\n\t\t}\n\t}\n}\n\nexport namespace DataTransfer {\n\texport function toDataTransfer(value: extHostProtocol.DataTransferDTO, resolveFileData: (dataItemIndex: number) => Promise<Uint8Array>): types.DataTransfer {\n\t\tconst init = value.items.map(([type, item], index) => {\n\t\t\treturn [type, DataTransferItem.toDataTransferItem(item, () => resolveFileData(index))] as const;\n\t\t});\n\t\treturn new types.DataTransfer(init);\n\t}\n\n\texport async function toDataTransferDTO(value: vscode.DataTransfer | VSDataTransfer): Promise<extHostProtocol.DataTransferDTO> {\n\t\tconst newDTO: extHostProtocol.DataTransferDTO = { items: [] };\n\n\t\tconst promises: Promise<any>[] = [];\n\t\tvalue.forEach((value, key) => {\n\t\t\tpromises.push((async () => {\n\t\t\t\tconst stringValue = await value.asString();\n\t\t\t\tconst fileValue = value.asFile();\n\t\t\t\tnewDTO.items.push([key, {\n\t\t\t\t\tasString: stringValue,\n\t\t\t\t\tfileData: fileValue ? { name: fileValue.name, uri: fileValue.uri } : undefined,\n\t\t\t\t}]);\n\t\t\t})());\n\t\t});\n\n\t\tawait Promise.all(promises);\n\n\t\treturn newDTO;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Event } from 'vs/base/common/event';\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { illegalState } from 'vs/base/common/errors';\nimport { ExtHostDocumentSaveParticipantShape, IWorkspaceEditDto, MainThreadBulkEditsShape } from 'vs/workbench/api/common/extHost.protocol';\nimport { TextEdit } from 'vs/workbench/api/common/extHostTypes';\nimport { Range, TextDocumentSaveReason, EndOfLine } from 'vs/workbench/api/common/extHostTypeConverters';\nimport { ExtHostDocuments } from 'vs/workbench/api/common/extHostDocuments';\nimport { SaveReason } from 'vs/workbench/common/editor';\nimport type * as vscode from 'vscode';\nimport { LinkedList } from 'vs/base/common/linkedList';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\n\ntype Listener = [Function, any, IExtensionDescription];\n\nexport class ExtHostDocumentSaveParticipant implements ExtHostDocumentSaveParticipantShape {\n\n\tprivate readonly _callbacks = new LinkedList<Listener>();\n\tprivate readonly _badListeners = new WeakMap<Function, number>();\n\n\tconstructor(\n\t\tprivate readonly _logService: ILogService,\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _mainThreadBulkEdits: MainThreadBulkEditsShape,\n\t\tprivate readonly _thresholds: { timeout: number; errors: number } = { timeout: 1500, errors: 3 }\n\t) {\n\t\t//\n\t}\n\n\tdispose(): void {\n\t\tthis._callbacks.clear();\n\t}\n\n\tgetOnWillSaveTextDocumentEvent(extension: IExtensionDescription): Event<vscode.TextDocumentWillSaveEvent> {\n\t\treturn (listener, thisArg, disposables) => {\n\t\t\tconst remove = this._callbacks.push([listener, thisArg, extension]);\n\t\t\tconst result = { dispose: remove };\n\t\t\tif (Array.isArray(disposables)) {\n\t\t\t\tdisposables.push(result);\n\t\t\t}\n\t\t\treturn result;\n\t\t};\n\t}\n\n\tasync $participateInSave(data: UriComponents, reason: SaveReason): Promise<boolean[]> {\n\t\tconst resource = URI.revive(data);\n\n\t\tlet didTimeout = false;\n\t\tconst didTimeoutHandle = setTimeout(() => didTimeout = true, this._thresholds.timeout);\n\n\t\tconst results: boolean[] = [];\n\t\ttry {\n\t\t\tfor (const listener of [...this._callbacks]) { // copy to prevent concurrent modifications\n\t\t\t\tif (didTimeout) {\n\t\t\t\t\t// timeout - no more listeners\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tconst document = this._documents.getDocument(resource);\n\t\t\t\tconst success = await this._deliverEventAsyncAndBlameBadListeners(listener, <any>{ document, reason: TextDocumentSaveReason.to(reason) });\n\t\t\t\tresults.push(success);\n\t\t\t}\n\t\t} finally {\n\t\t\tclearTimeout(didTimeoutHandle);\n\t\t}\n\t\treturn results;\n\t}\n\n\tprivate _deliverEventAsyncAndBlameBadListeners([listener, thisArg, extension]: Listener, stubEvent: vscode.TextDocumentWillSaveEvent): Promise<any> {\n\t\tconst errors = this._badListeners.get(listener);\n\t\tif (typeof errors === 'number' && errors > this._thresholds.errors) {\n\t\t\t// bad listener - ignore\n\t\t\treturn Promise.resolve(false);\n\t\t}\n\n\t\treturn this._deliverEventAsync(extension, listener, thisArg, stubEvent).then(() => {\n\t\t\t// don't send result across the wire\n\t\t\treturn true;\n\n\t\t}, err => {\n\n\t\t\tthis._logService.error(`onWillSaveTextDocument-listener from extension '${extension.identifier.value}' threw ERROR`);\n\t\t\tthis._logService.error(err);\n\n\t\t\tif (!(err instanceof Error) || (<Error>err).message !== 'concurrent_edits') {\n\t\t\t\tconst errors = this._badListeners.get(listener);\n\t\t\t\tthis._badListeners.set(listener, !errors ? 1 : errors + 1);\n\n\t\t\t\tif (typeof errors === 'number' && errors > this._thresholds.errors) {\n\t\t\t\t\tthis._logService.info(`onWillSaveTextDocument-listener from extension '${extension.identifier.value}' will now be IGNORED because of timeouts and/or errors`);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\t}\n\n\tprivate _deliverEventAsync(extension: IExtensionDescription, listener: Function, thisArg: any, stubEvent: vscode.TextDocumentWillSaveEvent): Promise<any> {\n\n\t\tconst promises: Promise<vscode.TextEdit[]>[] = [];\n\n\t\tconst t1 = Date.now();\n\t\tconst { document, reason } = stubEvent;\n\t\tconst { version } = document;\n\n\t\tconst event = Object.freeze<vscode.TextDocumentWillSaveEvent>({\n\t\t\tdocument,\n\t\t\treason,\n\t\t\twaitUntil(p: Promise<any | vscode.TextEdit[]>) {\n\t\t\t\tif (Object.isFrozen(promises)) {\n\t\t\t\t\tthrow illegalState('waitUntil can not be called async');\n\t\t\t\t}\n\t\t\t\tpromises.push(Promise.resolve(p));\n\t\t\t}\n\t\t});\n\n\t\ttry {\n\t\t\t// fire event\n\t\t\tlistener.apply(thisArg, [event]);\n\t\t} catch (err) {\n\t\t\treturn Promise.reject(err);\n\t\t}\n\n\t\t// freeze promises after event call\n\t\tObject.freeze(promises);\n\n\t\treturn new Promise<vscode.TextEdit[][]>((resolve, reject) => {\n\t\t\t// join on all listener promises, reject after timeout\n\t\t\tconst handle = setTimeout(() => reject(new Error('timeout')), this._thresholds.timeout);\n\n\t\t\treturn Promise.all(promises).then(edits => {\n\t\t\t\tthis._logService.debug(`onWillSaveTextDocument-listener from extension '${extension.identifier.value}' finished after ${(Date.now() - t1)}ms`);\n\t\t\t\tclearTimeout(handle);\n\t\t\t\tresolve(edits);\n\t\t\t}).catch(err => {\n\t\t\t\tclearTimeout(handle);\n\t\t\t\treject(err);\n\t\t\t});\n\n\t\t}).then(values => {\n\t\t\tconst dto: IWorkspaceEditDto = { edits: [] };\n\t\t\tfor (const value of values) {\n\t\t\t\tif (Array.isArray(value) && (<vscode.TextEdit[]>value).every(e => e instanceof TextEdit)) {\n\t\t\t\t\tfor (const { newText, newEol, range } of value) {\n\t\t\t\t\t\tdto.edits.push({\n\t\t\t\t\t\t\tresource: document.uri,\n\t\t\t\t\t\t\tversionId: undefined,\n\t\t\t\t\t\t\ttextEdit: {\n\t\t\t\t\t\t\t\trange: range && Range.from(range),\n\t\t\t\t\t\t\t\ttext: newText,\n\t\t\t\t\t\t\t\teol: newEol && EndOfLine.from(newEol),\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// apply edits if any and if document\n\t\t\t// didn't change somehow in the meantime\n\t\t\tif (dto.edits.length === 0) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tif (version === document.version) {\n\t\t\t\treturn this._mainThreadBulkEdits.$tryApplyWorkspaceEdit(dto);\n\t\t\t}\n\n\t\t\treturn Promise.reject(new Error('concurrent_edits'));\n\t\t});\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Schemas } from 'vs/base/common/network';\nimport { URI } from 'vs/base/common/uri';\nimport * as extHostProtocol from 'vs/workbench/api/common/extHost.protocol';\nimport { ExtHostDocuments } from 'vs/workbench/api/common/extHostDocuments';\nimport { ExtHostDocumentsAndEditors, IExtHostModelAddedData } from 'vs/workbench/api/common/extHostDocumentsAndEditors';\nimport * as extHostTypeConverters from 'vs/workbench/api/common/extHostTypeConverters';\nimport { NotebookRange } from 'vs/workbench/api/common/extHostTypes';\nimport * as notebookCommon from 'vs/workbench/contrib/notebook/common/notebookCommon';\nimport * as vscode from 'vscode';\n\nclass RawContentChangeEvent {\n\n\tconstructor(\n\t\treadonly start: number,\n\t\treadonly deletedCount: number,\n\t\treadonly deletedItems: vscode.NotebookCell[],\n\t\treadonly items: ExtHostCell[]\n\t) { }\n\n\tasApiEvent(): vscode.NotebookDocumentContentChange {\n\t\treturn {\n\t\t\trange: new NotebookRange(this.start, this.start + this.deletedCount),\n\t\t\taddedCells: this.items.map(cell => cell.apiCell),\n\t\t\tremovedCells: this.deletedItems,\n\t\t};\n\t}\n}\n\nexport class ExtHostCell {\n\n\tstatic asModelAddData(notebook: vscode.NotebookDocument, cell: extHostProtocol.NotebookCellDto): IExtHostModelAddedData {\n\t\treturn {\n\t\t\tEOL: cell.eol,\n\t\t\tlines: cell.source,\n\t\t\tlanguageId: cell.language,\n\t\t\turi: cell.uri,\n\t\t\tisDirty: false,\n\t\t\tversionId: 1,\n\t\t\tnotebook\n\t\t};\n\t}\n\n\tprivate _outputs: vscode.NotebookCellOutput[];\n\tprivate _metadata: Readonly<notebookCommon.NotebookCellMetadata>;\n\tprivate _previousResult: Readonly<vscode.NotebookCellExecutionSummary | undefined>;\n\n\tprivate _internalMetadata: notebookCommon.NotebookCellInternalMetadata;\n\treadonly handle: number;\n\treadonly uri: URI;\n\treadonly cellKind: notebookCommon.CellKind;\n\n\tprivate _apiCell: vscode.NotebookCell | undefined;\n\tprivate _mime: string | undefined;\n\n\tconstructor(\n\t\treadonly notebook: ExtHostNotebookDocument,\n\t\tprivate readonly _extHostDocument: ExtHostDocumentsAndEditors,\n\t\tprivate readonly _cellData: extHostProtocol.NotebookCellDto,\n\t) {\n\t\tthis.handle = _cellData.handle;\n\t\tthis.uri = URI.revive(_cellData.uri);\n\t\tthis.cellKind = _cellData.cellKind;\n\t\tthis._outputs = _cellData.outputs.map(extHostTypeConverters.NotebookCellOutput.to);\n\t\tthis._internalMetadata = _cellData.internalMetadata ?? {};\n\t\tthis._metadata = Object.freeze(_cellData.metadata ?? {});\n\t\tthis._previousResult = Object.freeze(extHostTypeConverters.NotebookCellExecutionSummary.to(_cellData.internalMetadata ?? {}));\n\t}\n\n\tget internalMetadata(): notebookCommon.NotebookCellInternalMetadata {\n\t\treturn this._internalMetadata;\n\t}\n\n\tget apiCell(): vscode.NotebookCell {\n\t\tif (!this._apiCell) {\n\t\t\tconst that = this;\n\t\t\tconst data = this._extHostDocument.getDocument(this.uri);\n\t\t\tif (!data) {\n\t\t\t\tthrow new Error(`MISSING extHostDocument for notebook cell: ${this.uri}`);\n\t\t\t}\n\t\t\tconst apiCell: vscode.NotebookCell = {\n\t\t\t\tget index() { return that.notebook.getCellIndex(that); },\n\t\t\t\tnotebook: that.notebook.apiNotebook,\n\t\t\t\tkind: extHostTypeConverters.NotebookCellKind.to(this._cellData.cellKind),\n\t\t\t\tdocument: data.document,\n\t\t\t\tget mime() { return that._mime; },\n\t\t\t\tset mime(value: string | undefined) { that._mime = value; },\n\t\t\t\tget outputs() { return that._outputs.slice(0); },\n\t\t\t\tget metadata() { return that._metadata; },\n\t\t\t\tget executionSummary() { return that._previousResult; }\n\t\t\t};\n\t\t\tthis._apiCell = Object.freeze(apiCell);\n\t\t}\n\t\treturn this._apiCell;\n\t}\n\n\tsetOutputs(newOutputs: extHostProtocol.NotebookOutputDto[]): void {\n\t\tthis._outputs = newOutputs.map(extHostTypeConverters.NotebookCellOutput.to);\n\t}\n\n\tsetOutputItems(outputId: string, append: boolean, newOutputItems: extHostProtocol.NotebookOutputItemDto[]) {\n\t\tconst newItems = newOutputItems.map(extHostTypeConverters.NotebookCellOutputItem.to);\n\t\tconst output = this._outputs.find(op => op.id === outputId);\n\t\tif (output) {\n\t\t\tif (!append) {\n\t\t\t\toutput.items.length = 0;\n\t\t\t}\n\t\t\toutput.items.push(...newItems);\n\t\t}\n\t}\n\n\tsetMetadata(newMetadata: notebookCommon.NotebookCellMetadata): void {\n\t\tthis._metadata = Object.freeze(newMetadata);\n\t}\n\n\tsetInternalMetadata(newInternalMetadata: notebookCommon.NotebookCellInternalMetadata): void {\n\t\tthis._internalMetadata = newInternalMetadata;\n\t\tthis._previousResult = Object.freeze(extHostTypeConverters.NotebookCellExecutionSummary.to(newInternalMetadata));\n\t}\n\n\tsetMime(newMime: string | undefined) {\n\n\t}\n}\n\n\nexport class ExtHostNotebookDocument {\n\n\tprivate static _handlePool: number = 0;\n\treadonly handle = ExtHostNotebookDocument._handlePool++;\n\n\tprivate readonly _cells: ExtHostCell[] = [];\n\n\tprivate readonly _notebookType: string;\n\n\tprivate _notebook: vscode.NotebookDocument | undefined;\n\tprivate _metadata: Record<string, any>;\n\tprivate _versionId: number = 0;\n\tprivate _isDirty: boolean = false;\n\tprivate _backup?: vscode.NotebookDocumentBackup;\n\tprivate _disposed: boolean = false;\n\n\tconstructor(\n\t\tprivate readonly _proxy: extHostProtocol.MainThreadNotebookDocumentsShape,\n\t\tprivate readonly _textDocumentsAndEditors: ExtHostDocumentsAndEditors,\n\t\tprivate readonly _textDocuments: ExtHostDocuments,\n\t\treadonly uri: URI,\n\t\tdata: extHostProtocol.INotebookModelAddedData\n\t) {\n\t\tthis._notebookType = data.viewType;\n\t\tthis._metadata = Object.freeze(data.metadata ?? Object.create(null));\n\t\tthis._spliceNotebookCells([[0, 0, data.cells]], true /* init -> no event*/, undefined);\n\t\tthis._versionId = data.versionId;\n\t}\n\n\tdispose() {\n\t\tthis._disposed = true;\n\t}\n\n\tget apiNotebook(): vscode.NotebookDocument {\n\t\tif (!this._notebook) {\n\t\t\tconst that = this;\n\t\t\tconst apiObject: vscode.NotebookDocument = {\n\t\t\t\tget uri() { return that.uri; },\n\t\t\t\tget version() { return that._versionId; },\n\t\t\t\tget notebookType() { return that._notebookType; },\n\t\t\t\tget isDirty() { return that._isDirty; },\n\t\t\t\tget isUntitled() { return that.uri.scheme === Schemas.untitled; },\n\t\t\t\tget isClosed() { return that._disposed; },\n\t\t\t\tget metadata() { return that._metadata; },\n\t\t\t\tget cellCount() { return that._cells.length; },\n\t\t\t\tcellAt(index) {\n\t\t\t\t\tindex = that._validateIndex(index);\n\t\t\t\t\treturn that._cells[index].apiCell;\n\t\t\t\t},\n\t\t\t\tgetCells(range) {\n\t\t\t\t\tconst cells = range ? that._getCells(range) : that._cells;\n\t\t\t\t\treturn cells.map(cell => cell.apiCell);\n\t\t\t\t},\n\t\t\t\tsave() {\n\t\t\t\t\treturn that._save();\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._notebook = Object.freeze(apiObject);\n\t\t}\n\t\treturn this._notebook;\n\t}\n\n\tupdateBackup(backup: vscode.NotebookDocumentBackup): void {\n\t\tthis._backup?.delete();\n\t\tthis._backup = backup;\n\t}\n\n\tdisposeBackup(): void {\n\t\tthis._backup?.delete();\n\t\tthis._backup = undefined;\n\t}\n\n\tacceptDocumentPropertiesChanged(data: extHostProtocol.INotebookDocumentPropertiesChangeData) {\n\t\tif (data.metadata) {\n\t\t\tthis._metadata = Object.freeze({ ...this._metadata, ...data.metadata });\n\t\t}\n\t}\n\n\tacceptDirty(isDirty: boolean): void {\n\t\tthis._isDirty = isDirty;\n\t}\n\n\tacceptModelChanged(event: extHostProtocol.NotebookCellsChangedEventDto, isDirty: boolean, newMetadata: notebookCommon.NotebookDocumentMetadata | undefined): vscode.NotebookDocumentChangeEvent {\n\t\tthis._versionId = event.versionId;\n\t\tthis._isDirty = isDirty;\n\t\tthis.acceptDocumentPropertiesChanged({ metadata: newMetadata });\n\n\t\tconst result = {\n\t\t\tnotebook: this.apiNotebook,\n\t\t\tmetadata: newMetadata,\n\t\t\tcellChanges: <vscode.NotebookDocumentCellChange[]>[],\n\t\t\tcontentChanges: <vscode.NotebookDocumentContentChange[]>[],\n\t\t};\n\n\t\ttype RelaxedCellChange = Partial<vscode.NotebookDocumentCellChange> & { cell: vscode.NotebookCell };\n\t\tconst relaxedCellChanges: RelaxedCellChange[] = [];\n\n\t\t// -- apply change and populate content changes\n\n\t\tfor (const rawEvent of event.rawEvents) {\n\t\t\tif (rawEvent.kind === notebookCommon.NotebookCellsChangeType.ModelChange) {\n\t\t\t\tthis._spliceNotebookCells(rawEvent.changes, false, result.contentChanges);\n\n\t\t\t} else if (rawEvent.kind === notebookCommon.NotebookCellsChangeType.Move) {\n\t\t\t\tthis._moveCell(rawEvent.index, rawEvent.newIdx, result.contentChanges);\n\n\t\t\t} else if (rawEvent.kind === notebookCommon.NotebookCellsChangeType.Output) {\n\t\t\t\tthis._setCellOutputs(rawEvent.index, rawEvent.outputs);\n\t\t\t\trelaxedCellChanges.push({ cell: this._cells[rawEvent.index].apiCell, outputs: this._cells[rawEvent.index].apiCell.outputs });\n\n\t\t\t} else if (rawEvent.kind === notebookCommon.NotebookCellsChangeType.OutputItem) {\n\t\t\t\tthis._setCellOutputItems(rawEvent.index, rawEvent.outputId, rawEvent.append, rawEvent.outputItems);\n\t\t\t\trelaxedCellChanges.push({ cell: this._cells[rawEvent.index].apiCell, outputs: this._cells[rawEvent.index].apiCell.outputs });\n\n\t\t\t} else if (rawEvent.kind === notebookCommon.NotebookCellsChangeType.ChangeCellLanguage) {\n\t\t\t\tthis._changeCellLanguage(rawEvent.index, rawEvent.language);\n\t\t\t\trelaxedCellChanges.push({ cell: this._cells[rawEvent.index].apiCell, document: this._cells[rawEvent.index].apiCell.document });\n\n\t\t\t} else if (rawEvent.kind === notebookCommon.NotebookCellsChangeType.ChangeCellContent) {\n\t\t\t\trelaxedCellChanges.push({ cell: this._cells[rawEvent.index].apiCell, document: this._cells[rawEvent.index].apiCell.document });\n\n\t\t\t} else if (rawEvent.kind === notebookCommon.NotebookCellsChangeType.ChangeCellMime) {\n\t\t\t\tthis._changeCellMime(rawEvent.index, rawEvent.mime);\n\t\t\t} else if (rawEvent.kind === notebookCommon.NotebookCellsChangeType.ChangeCellMetadata) {\n\t\t\t\tthis._changeCellMetadata(rawEvent.index, rawEvent.metadata);\n\t\t\t\trelaxedCellChanges.push({ cell: this._cells[rawEvent.index].apiCell, metadata: this._cells[rawEvent.index].apiCell.metadata });\n\n\t\t\t} else if (rawEvent.kind === notebookCommon.NotebookCellsChangeType.ChangeCellInternalMetadata) {\n\t\t\t\tthis._changeCellInternalMetadata(rawEvent.index, rawEvent.internalMetadata);\n\t\t\t\trelaxedCellChanges.push({ cell: this._cells[rawEvent.index].apiCell, executionSummary: this._cells[rawEvent.index].apiCell.executionSummary });\n\t\t\t}\n\t\t}\n\n\t\t// -- compact cellChanges\n\n\t\tconst map = new Map<vscode.NotebookCell, number>();\n\t\tfor (let i = 0; i < relaxedCellChanges.length; i++) {\n\t\t\tconst relaxedCellChange = relaxedCellChanges[i];\n\t\t\tconst existing = map.get(relaxedCellChange.cell);\n\t\t\tif (existing === undefined) {\n\t\t\t\tconst newLen = result.cellChanges.push({\n\t\t\t\t\tdocument: undefined,\n\t\t\t\t\texecutionSummary: undefined,\n\t\t\t\t\tmetadata: undefined,\n\t\t\t\t\toutputs: undefined,\n\t\t\t\t\t...relaxedCellChange,\n\t\t\t\t});\n\t\t\t\tmap.set(relaxedCellChange.cell, newLen - 1);\n\t\t\t} else {\n\t\t\t\tresult.cellChanges[existing] = {\n\t\t\t\t\t...result.cellChanges[existing],\n\t\t\t\t\t...relaxedCellChange\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\t// Freeze event properties so handlers cannot accidentally modify them\n\t\tObject.freeze(result);\n\t\tObject.freeze(result.cellChanges);\n\t\tObject.freeze(result.contentChanges);\n\n\t\treturn result;\n\t}\n\n\tprivate _validateIndex(index: number): number {\n\t\tindex = index | 0;\n\t\tif (index < 0) {\n\t\t\treturn 0;\n\t\t} else if (index >= this._cells.length) {\n\t\t\treturn this._cells.length - 1;\n\t\t} else {\n\t\t\treturn index;\n\t\t}\n\t}\n\n\tprivate _validateRange(range: vscode.NotebookRange): vscode.NotebookRange {\n\t\tlet start = range.start | 0;\n\t\tlet end = range.end | 0;\n\t\tif (start < 0) {\n\t\t\tstart = 0;\n\t\t}\n\t\tif (end > this._cells.length) {\n\t\t\tend = this._cells.length;\n\t\t}\n\t\treturn range.with({ start, end });\n\t}\n\n\tprivate _getCells(range: vscode.NotebookRange): ExtHostCell[] {\n\t\trange = this._validateRange(range);\n\t\tconst result: ExtHostCell[] = [];\n\t\tfor (let i = range.start; i < range.end; i++) {\n\t\t\tresult.push(this._cells[i]);\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate async _save(): Promise<boolean> {\n\t\tif (this._disposed) {\n\t\t\treturn Promise.reject(new Error('Notebook has been closed'));\n\t\t}\n\t\treturn this._proxy.$trySaveNotebook(this.uri);\n\t}\n\n\tprivate _spliceNotebookCells(splices: notebookCommon.NotebookCellTextModelSplice<extHostProtocol.NotebookCellDto>[], initialization: boolean, bucket: vscode.NotebookDocumentContentChange[] | undefined): void {\n\t\tif (this._disposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst contentChangeEvents: RawContentChangeEvent[] = [];\n\t\tconst addedCellDocuments: IExtHostModelAddedData[] = [];\n\t\tconst removedCellDocuments: URI[] = [];\n\n\t\tsplices.reverse().forEach(splice => {\n\t\t\tconst cellDtos = splice[2];\n\t\t\tconst newCells = cellDtos.map(cell => {\n\n\t\t\t\tconst extCell = new ExtHostCell(this, this._textDocumentsAndEditors, cell);\n\t\t\t\tif (!initialization) {\n\t\t\t\t\taddedCellDocuments.push(ExtHostCell.asModelAddData(this.apiNotebook, cell));\n\t\t\t\t}\n\t\t\t\treturn extCell;\n\t\t\t});\n\n\t\t\tconst changeEvent = new RawContentChangeEvent(splice[0], splice[1], [], newCells);\n\t\t\tconst deletedItems = this._cells.splice(splice[0], splice[1], ...newCells);\n\t\t\tfor (const cell of deletedItems) {\n\t\t\t\tremovedCellDocuments.push(cell.uri);\n\t\t\t\tchangeEvent.deletedItems.push(cell.apiCell);\n\t\t\t}\n\t\t\tcontentChangeEvents.push(changeEvent);\n\t\t});\n\n\t\tthis._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({\n\t\t\taddedDocuments: addedCellDocuments,\n\t\t\tremovedDocuments: removedCellDocuments\n\t\t});\n\n\t\tif (bucket) {\n\t\t\tfor (const changeEvent of contentChangeEvents) {\n\t\t\t\tbucket.push(changeEvent.asApiEvent());\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _moveCell(index: number, newIdx: number, bucket: vscode.NotebookDocumentContentChange[]): void {\n\t\tconst cells = this._cells.splice(index, 1);\n\t\tthis._cells.splice(newIdx, 0, ...cells);\n\t\tconst changes = [\n\t\t\tnew RawContentChangeEvent(index, 1, cells.map(c => c.apiCell), []),\n\t\t\tnew RawContentChangeEvent(newIdx, 0, [], cells)\n\t\t];\n\t\tfor (const change of changes) {\n\t\t\tbucket.push(change.asApiEvent());\n\t\t}\n\t}\n\n\tprivate _setCellOutputs(index: number, outputs: extHostProtocol.NotebookOutputDto[]): void {\n\t\tconst cell = this._cells[index];\n\t\tcell.setOutputs(outputs);\n\t}\n\n\tprivate _setCellOutputItems(index: number, outputId: string, append: boolean, outputItems: extHostProtocol.NotebookOutputItemDto[]): void {\n\t\tconst cell = this._cells[index];\n\t\tcell.setOutputItems(outputId, append, outputItems);\n\t}\n\n\tprivate _changeCellLanguage(index: number, newLanguageId: string): void {\n\t\tconst cell = this._cells[index];\n\t\tif (cell.apiCell.document.languageId !== newLanguageId) {\n\t\t\tthis._textDocuments.$acceptModelLanguageChanged(cell.uri, newLanguageId);\n\t\t}\n\t}\n\n\tprivate _changeCellMime(index: number, newMime: string | undefined): void {\n\t\tconst cell = this._cells[index];\n\t\tcell.apiCell.mime = newMime;\n\t}\n\n\tprivate _changeCellMetadata(index: number, newMetadata: notebookCommon.NotebookCellMetadata): void {\n\t\tconst cell = this._cells[index];\n\t\tcell.setMetadata(newMetadata);\n\t}\n\n\tprivate _changeCellInternalMetadata(index: number, newInternalMetadata: notebookCommon.NotebookCellInternalMetadata): void {\n\t\tconst cell = this._cells[index];\n\t\tcell.setInternalMetadata(newInternalMetadata);\n\t}\n\n\tgetCellFromApiCell(apiCell: vscode.NotebookCell): ExtHostCell | undefined {\n\t\treturn this._cells.find(cell => cell.apiCell === apiCell);\n\t}\n\n\tgetCellFromIndex(index: number): ExtHostCell | undefined {\n\t\treturn this._cells[index];\n\t}\n\n\tgetCell(cellHandle: number): ExtHostCell | undefined {\n\t\treturn this._cells.find(cell => cell.handle === cellHandle);\n\t}\n\n\tgetCellIndex(cell: ExtHostCell): number {\n\t\treturn this._cells.indexOf(cell);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ICellEditOperationDto, MainThreadNotebookEditorsShape } from 'vs/workbench/api/common/extHost.protocol';\nimport * as extHostTypes from 'vs/workbench/api/common/extHostTypes';\nimport * as extHostConverter from 'vs/workbench/api/common/extHostTypeConverters';\nimport { CellEditType } from 'vs/workbench/contrib/notebook/common/notebookCommon';\nimport * as vscode from 'vscode';\nimport { ExtHostNotebookDocument } from './extHostNotebookDocument';\nimport { illegalArgument } from 'vs/base/common/errors';\n\ninterface INotebookEditData {\n\tdocumentVersionId: number;\n\tcellEdits: ICellEditOperationDto[];\n}\n\nclass NotebookEditorCellEditBuilder implements vscode.NotebookEditorEdit {\n\n\tprivate readonly _documentVersionId: number;\n\n\tprivate _finalized: boolean = false;\n\tprivate _collectedEdits: ICellEditOperationDto[] = [];\n\n\tconstructor(documentVersionId: number) {\n\t\tthis._documentVersionId = documentVersionId;\n\t}\n\n\tfinalize(): INotebookEditData {\n\t\tthis._finalized = true;\n\t\treturn {\n\t\t\tdocumentVersionId: this._documentVersionId,\n\t\t\tcellEdits: this._collectedEdits\n\t\t};\n\t}\n\n\tprivate _throwIfFinalized() {\n\t\tif (this._finalized) {\n\t\t\tthrow new Error('Edit is only valid while callback runs');\n\t\t}\n\t}\n\n\treplaceMetadata(value: { [key: string]: any }): void {\n\t\tthis._throwIfFinalized();\n\t\tthis._collectedEdits.push({\n\t\t\teditType: CellEditType.DocumentMetadata,\n\t\t\tmetadata: value\n\t\t});\n\t}\n\n\treplaceCellMetadata(index: number, metadata: Record<string, any>): void {\n\t\tthis._throwIfFinalized();\n\t\tthis._collectedEdits.push({\n\t\t\teditType: CellEditType.PartialMetadata,\n\t\t\tindex,\n\t\t\tmetadata\n\t\t});\n\t}\n\n\treplaceCells(from: number, to: number, cells: vscode.NotebookCellData[]): void {\n\t\tthis._throwIfFinalized();\n\t\tif (from === to && cells.length === 0) {\n\t\t\treturn;\n\t\t}\n\t\tthis._collectedEdits.push({\n\t\t\teditType: CellEditType.Replace,\n\t\t\tindex: from,\n\t\t\tcount: to - from,\n\t\t\tcells: cells.map(extHostConverter.NotebookCellData.from)\n\t\t});\n\t}\n}\n\nexport class ExtHostNotebookEditor {\n\n\tpublic static readonly apiEditorsToExtHost = new WeakMap<vscode.NotebookEditor, ExtHostNotebookEditor>();\n\n\tprivate _selections: vscode.NotebookRange[] = [];\n\tprivate _visibleRanges: vscode.NotebookRange[] = [];\n\tprivate _viewColumn?: vscode.ViewColumn;\n\n\tprivate _visible: boolean = false;\n\n\tprivate _editor?: vscode.NotebookEditor;\n\n\tconstructor(\n\t\treadonly id: string,\n\t\tprivate readonly _proxy: MainThreadNotebookEditorsShape,\n\t\treadonly notebookData: ExtHostNotebookDocument,\n\t\tvisibleRanges: vscode.NotebookRange[],\n\t\tselections: vscode.NotebookRange[],\n\t\tviewColumn: vscode.ViewColumn | undefined\n\t) {\n\t\tthis._selections = selections;\n\t\tthis._visibleRanges = visibleRanges;\n\t\tthis._viewColumn = viewColumn;\n\t}\n\n\tget apiEditor(): vscode.NotebookEditor {\n\t\tif (!this._editor) {\n\t\t\tconst that = this;\n\t\t\tthis._editor = {\n\t\t\t\tget document() {\n\t\t\t\t\treturn that.notebookData.apiNotebook;\n\t\t\t\t},\n\t\t\t\tget notebook() {\n\t\t\t\t\treturn that.notebookData.apiNotebook;\n\t\t\t\t},\n\t\t\t\tget selection() {\n\t\t\t\t\treturn that._selections[0];\n\t\t\t\t},\n\t\t\t\tset selection(selection: vscode.NotebookRange) {\n\t\t\t\t\tthis.selections = [selection];\n\t\t\t\t},\n\t\t\t\tget selections() {\n\t\t\t\t\treturn that._selections;\n\t\t\t\t},\n\t\t\t\tset selections(value: vscode.NotebookRange[]) {\n\t\t\t\t\tif (!Array.isArray(value) || !value.every(extHostTypes.NotebookRange.isNotebookRange)) {\n\t\t\t\t\t\tthrow illegalArgument('selections');\n\t\t\t\t\t}\n\t\t\t\t\tthat._selections = value;\n\t\t\t\t\tthat._trySetSelections(value);\n\t\t\t\t},\n\t\t\t\tget visibleRanges() {\n\t\t\t\t\treturn that._visibleRanges;\n\t\t\t\t},\n\t\t\t\trevealRange(range, revealType) {\n\t\t\t\t\tthat._proxy.$tryRevealRange(\n\t\t\t\t\t\tthat.id,\n\t\t\t\t\t\textHostConverter.NotebookRange.from(range),\n\t\t\t\t\t\trevealType ?? extHostTypes.NotebookEditorRevealType.Default\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tget viewColumn() {\n\t\t\t\t\treturn that._viewColumn;\n\t\t\t\t},\n\t\t\t\tedit(callback) {\n\t\t\t\t\tconst edit = new NotebookEditorCellEditBuilder(this.document.version);\n\t\t\t\t\tcallback(edit);\n\t\t\t\t\treturn that._applyEdit(edit.finalize());\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tExtHostNotebookEditor.apiEditorsToExtHost.set(this._editor, this);\n\t\t}\n\t\treturn this._editor;\n\t}\n\n\tget visible(): boolean {\n\t\treturn this._visible;\n\t}\n\n\t_acceptVisibility(value: boolean) {\n\t\tthis._visible = value;\n\t}\n\n\t_acceptVisibleRanges(value: vscode.NotebookRange[]): void {\n\t\tthis._visibleRanges = value;\n\t}\n\n\t_acceptSelections(selections: vscode.NotebookRange[]): void {\n\t\tthis._selections = selections;\n\t}\n\n\tprivate _trySetSelections(value: vscode.NotebookRange[]): void {\n\t\tthis._proxy.$trySetSelections(this.id, value.map(extHostConverter.NotebookRange.from));\n\t}\n\n\t_acceptViewColumn(value: vscode.ViewColumn | undefined) {\n\t\tthis._viewColumn = value;\n\t}\n\n\tprivate _applyEdit(editData: INotebookEditData): Promise<boolean> {\n\n\t\t// return when there is nothing to do\n\t\tif (editData.cellEdits.length === 0) {\n\t\t\treturn Promise.resolve(true);\n\t\t}\n\n\t\tconst compressedEdits: ICellEditOperationDto[] = [];\n\t\tlet compressedEditsIndex = -1;\n\n\t\tfor (let i = 0; i < editData.cellEdits.length; i++) {\n\t\t\tif (compressedEditsIndex < 0) {\n\t\t\t\tcompressedEdits.push(editData.cellEdits[i]);\n\t\t\t\tcompressedEditsIndex++;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst prevIndex = compressedEditsIndex;\n\t\t\tconst prev = compressedEdits[prevIndex];\n\n\t\t\tconst edit = editData.cellEdits[i];\n\t\t\tif (prev.editType === CellEditType.Replace && edit.editType === CellEditType.Replace) {\n\t\t\t\tif (prev.index === edit.index) {\n\t\t\t\t\tprev.cells.push(...(editData.cellEdits[i] as any).cells);\n\t\t\t\t\tprev.count += (editData.cellEdits[i] as any).count;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcompressedEdits.push(editData.cellEdits[i]);\n\t\t\tcompressedEditsIndex++;\n\t\t}\n\n\t\treturn this._proxy.$tryApplyEdits(this.id, editData.documentVersionId, compressedEdits);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter } from 'vs/base/common/event';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { ExtHostNotebookEditorsShape, INotebookEditorPropertiesChangeData, INotebookEditorViewColumnInfo } from 'vs/workbench/api/common/extHost.protocol';\nimport { ExtHostNotebookController } from 'vs/workbench/api/common/extHostNotebook';\nimport * as typeConverters from 'vs/workbench/api/common/extHostTypeConverters';\nimport type * as vscode from 'vscode';\n\n\nexport class ExtHostNotebookEditors implements ExtHostNotebookEditorsShape {\n\n\tprivate readonly _onDidChangeNotebookEditorSelection = new Emitter<vscode.NotebookEditorSelectionChangeEvent>();\n\tprivate readonly _onDidChangeNotebookEditorVisibleRanges = new Emitter<vscode.NotebookEditorVisibleRangesChangeEvent>();\n\n\treadonly onDidChangeNotebookEditorSelection = this._onDidChangeNotebookEditorSelection.event;\n\treadonly onDidChangeNotebookEditorVisibleRanges = this._onDidChangeNotebookEditorVisibleRanges.event;\n\n\tconstructor(\n\t\t@ILogService private readonly _logService: ILogService,\n\t\tprivate readonly _notebooksAndEditors: ExtHostNotebookController,\n\t) { }\n\n\t$acceptEditorPropertiesChanged(id: string, data: INotebookEditorPropertiesChangeData): void {\n\t\tthis._logService.debug('ExtHostNotebook#$acceptEditorPropertiesChanged', id, data);\n\t\tconst editor = this._notebooksAndEditors.getEditorById(id);\n\t\t// ONE: make all state updates\n\t\tif (data.visibleRanges) {\n\t\t\teditor._acceptVisibleRanges(data.visibleRanges.ranges.map(typeConverters.NotebookRange.to));\n\t\t}\n\t\tif (data.selections) {\n\t\t\teditor._acceptSelections(data.selections.selections.map(typeConverters.NotebookRange.to));\n\t\t}\n\n\t\t// TWO: send all events after states have been updated\n\t\tif (data.visibleRanges) {\n\t\t\tthis._onDidChangeNotebookEditorVisibleRanges.fire({\n\t\t\t\tnotebookEditor: editor.apiEditor,\n\t\t\t\tvisibleRanges: editor.apiEditor.visibleRanges\n\t\t\t});\n\t\t}\n\t\tif (data.selections) {\n\t\t\tthis._onDidChangeNotebookEditorSelection.fire(Object.freeze({\n\t\t\t\tnotebookEditor: editor.apiEditor,\n\t\t\t\tselections: editor.apiEditor.selections\n\t\t\t}));\n\t\t}\n\t}\n\n\t$acceptEditorViewColumns(data: INotebookEditorViewColumnInfo): void {\n\t\tfor (const id in data) {\n\t\t\tconst editor = this._notebooksAndEditors.getEditorById(id);\n\t\t\teditor._acceptViewColumn(typeConverters.ViewColumn.to(data[id]));\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ProgressOptions } from 'vscode';\nimport { MainThreadProgressShape, ExtHostProgressShape } from './extHost.protocol';\nimport { ProgressLocation } from './extHostTypeConverters';\nimport { Progress, IProgressStep } from 'vs/platform/progress/common/progress';\nimport { localize } from 'vs/nls';\nimport { CancellationTokenSource, CancellationToken } from 'vs/base/common/cancellation';\nimport { throttle } from 'vs/base/common/decorators';\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { onUnexpectedExternalError } from 'vs/base/common/errors';\n\nexport class ExtHostProgress implements ExtHostProgressShape {\n\n\tprivate _proxy: MainThreadProgressShape;\n\tprivate _handles: number = 0;\n\tprivate _mapHandleToCancellationSource: Map<number, CancellationTokenSource> = new Map();\n\n\tconstructor(proxy: MainThreadProgressShape) {\n\t\tthis._proxy = proxy;\n\t}\n\n\tasync withProgress<R>(extension: IExtensionDescription, options: ProgressOptions, task: (progress: Progress<IProgressStep>, token: CancellationToken) => Thenable<R>): Promise<R> {\n\t\tconst handle = this._handles++;\n\t\tconst { title, location, cancellable } = options;\n\t\tconst source = { label: localize('extensionSource', \"{0} (Extension)\", extension.displayName || extension.name), id: extension.identifier.value };\n\n\t\tthis._proxy.$startProgress(handle, { location: ProgressLocation.from(location), title, source, cancellable }, !extension.isUnderDevelopment ? extension.identifier.value : undefined).catch(onUnexpectedExternalError);\n\t\treturn this._withProgress(handle, task, !!cancellable);\n\t}\n\n\tprivate _withProgress<R>(handle: number, task: (progress: Progress<IProgressStep>, token: CancellationToken) => Thenable<R>, cancellable: boolean): Thenable<R> {\n\t\tlet source: CancellationTokenSource | undefined;\n\t\tif (cancellable) {\n\t\t\tsource = new CancellationTokenSource();\n\t\t\tthis._mapHandleToCancellationSource.set(handle, source);\n\t\t}\n\n\t\tconst progressEnd = (handle: number): void => {\n\t\t\tthis._proxy.$progressEnd(handle);\n\t\t\tthis._mapHandleToCancellationSource.delete(handle);\n\t\t\tif (source) {\n\t\t\t\tsource.dispose();\n\t\t\t}\n\t\t};\n\n\t\tlet p: Thenable<R>;\n\n\t\ttry {\n\t\t\tp = task(new ProgressCallback(this._proxy, handle), cancellable && source ? source.token : CancellationToken.None);\n\t\t} catch (err) {\n\t\t\tprogressEnd(handle);\n\t\t\tthrow err;\n\t\t}\n\n\t\tp.then(result => progressEnd(handle), err => progressEnd(handle));\n\t\treturn p;\n\t}\n\n\tpublic $acceptProgressCanceled(handle: number): void {\n\t\tconst source = this._mapHandleToCancellationSource.get(handle);\n\t\tif (source) {\n\t\t\tsource.cancel();\n\t\t\tthis._mapHandleToCancellationSource.delete(handle);\n\t\t}\n\t}\n}\n\nfunction mergeProgress(result: IProgressStep, currentValue: IProgressStep): IProgressStep {\n\tresult.message = currentValue.message;\n\tif (typeof currentValue.increment === 'number') {\n\t\tif (typeof result.increment === 'number') {\n\t\t\tresult.increment += currentValue.increment;\n\t\t} else {\n\t\t\tresult.increment = currentValue.increment;\n\t\t}\n\t}\n\n\treturn result;\n}\n\nclass ProgressCallback extends Progress<IProgressStep> {\n\tconstructor(private _proxy: MainThreadProgressShape, private _handle: number) {\n\t\tsuper(p => this.throttledReport(p));\n\t}\n\n\t@throttle(100, (result: IProgressStep, currentValue: IProgressStep) => mergeProgress(result, currentValue), () => Object.create(null))\n\tthrottledReport(p: IProgressStep): void {\n\t\tthis._proxy.$progressReport(this._handle, p);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as editorRange from 'vs/editor/common/core/range';\nimport { createPrivateApiFor, getPrivateApiFor, IExtHostTestItemApi } from 'vs/workbench/api/common/extHostTestingPrivateApi';\nimport { TestId, TestIdPathParts } from 'vs/workbench/contrib/testing/common/testId';\nimport { createTestItemChildren, ExtHostTestItemEvent, ITestChildrenLike, ITestItemApi, ITestItemChildren, TestItemCollection, TestItemEventOp } from 'vs/workbench/contrib/testing/common/testItemCollection';\nimport { denamespaceTestTag, ITestItem, ITestItemContext } from 'vs/workbench/contrib/testing/common/testTypes';\nimport type * as vscode from 'vscode';\nimport * as Convert from 'vs/workbench/api/common/extHostTypeConverters';\nimport { URI } from 'vs/base/common/uri';\n\nconst testItemPropAccessor = <K extends keyof vscode.TestItem>(\n\tapi: IExtHostTestItemApi,\n\tdefaultValue: vscode.TestItem[K],\n\tequals: (a: vscode.TestItem[K], b: vscode.TestItem[K]) => boolean,\n\ttoUpdate: (newValue: vscode.TestItem[K], oldValue: vscode.TestItem[K]) => ExtHostTestItemEvent,\n) => {\n\tlet value = defaultValue;\n\treturn {\n\t\tenumerable: true,\n\t\tconfigurable: false,\n\t\tget() {\n\t\t\treturn value;\n\t\t},\n\t\tset(newValue: vscode.TestItem[K]) {\n\t\t\tif (!equals(value, newValue)) {\n\t\t\t\tconst oldValue = value;\n\t\t\t\tvalue = newValue;\n\t\t\t\tapi.listener?.(toUpdate(newValue, oldValue));\n\t\t\t}\n\t\t},\n\t};\n};\n\ntype WritableProps = Pick<vscode.TestItem, 'range' | 'label' | 'description' | 'sortText' | 'canResolveChildren' | 'busy' | 'error' | 'tags'>;\n\nconst strictEqualComparator = <T>(a: T, b: T) => a === b;\n\nconst propComparators: { [K in keyof Required<WritableProps>]: (a: vscode.TestItem[K], b: vscode.TestItem[K]) => boolean } = {\n\trange: (a, b) => {\n\t\tif (a === b) { return true; }\n\t\tif (!a || !b) { return false; }\n\t\treturn a.isEqual(b);\n\t},\n\tlabel: strictEqualComparator,\n\tdescription: strictEqualComparator,\n\tsortText: strictEqualComparator,\n\tbusy: strictEqualComparator,\n\terror: strictEqualComparator,\n\tcanResolveChildren: strictEqualComparator,\n\ttags: (a, b) => {\n\t\tif (a.length !== b.length) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (a.some(t1 => !b.find(t2 => t1.id === t2.id))) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t},\n};\n\nconst evSetProps = <T>(fn: (newValue: T) => Partial<ITestItem>): (newValue: T) => ExtHostTestItemEvent =>\n\tv => ({ op: TestItemEventOp.SetProp, update: fn(v) });\n\nconst makePropDescriptors = (api: IExtHostTestItemApi, label: string): { [K in keyof Required<WritableProps>]: PropertyDescriptor } => ({\n\trange: testItemPropAccessor<'range'>(api, undefined, propComparators.range, evSetProps(r => ({ range: editorRange.Range.lift(Convert.Range.from(r)) }))),\n\tlabel: testItemPropAccessor<'label'>(api, label, propComparators.label, evSetProps(label => ({ label }))),\n\tdescription: testItemPropAccessor<'description'>(api, undefined, propComparators.description, evSetProps(description => ({ description }))),\n\tsortText: testItemPropAccessor<'sortText'>(api, undefined, propComparators.sortText, evSetProps(sortText => ({ sortText }))),\n\tcanResolveChildren: testItemPropAccessor<'canResolveChildren'>(api, false, propComparators.canResolveChildren, state => ({\n\t\top: TestItemEventOp.UpdateCanResolveChildren,\n\t\tstate,\n\t})),\n\tbusy: testItemPropAccessor<'busy'>(api, false, propComparators.busy, evSetProps(busy => ({ busy }))),\n\terror: testItemPropAccessor<'error'>(api, undefined, propComparators.error, evSetProps(error => ({ error: Convert.MarkdownString.fromStrict(error) || null }))),\n\ttags: testItemPropAccessor<'tags'>(api, [], propComparators.tags, (current, previous) => ({\n\t\top: TestItemEventOp.SetTags,\n\t\tnew: current.map(Convert.TestTag.from),\n\t\told: previous.map(Convert.TestTag.from),\n\t})),\n});\n\nconst toItemFromPlain = (item: ITestItem.Serialized): TestItemImpl => {\n\tconst testId = TestId.fromString(item.extId);\n\tconst testItem = new TestItemImpl(testId.controllerId, testId.localId, item.label, URI.revive(item.uri) || undefined);\n\ttestItem.range = Convert.Range.to(item.range || undefined);\n\ttestItem.description = item.description || undefined;\n\ttestItem.sortText = item.sortText || undefined;\n\ttestItem.tags = item.tags.map(t => Convert.TestTag.to({ id: denamespaceTestTag(t).tagId }));\n\treturn testItem;\n};\n\nexport const toItemFromContext = (context: ITestItemContext): TestItemImpl => {\n\tlet node: TestItemImpl | undefined;\n\tfor (const test of context.tests) {\n\t\tconst next = toItemFromPlain(test.item);\n\t\tgetPrivateApiFor(next).parent = node;\n\t\tnode = next;\n\t}\n\n\treturn node!;\n};\n\nexport class TestItemImpl implements vscode.TestItem {\n\tpublic readonly id!: string;\n\tpublic readonly uri!: vscode.Uri | undefined;\n\tpublic readonly children!: ITestItemChildren<vscode.TestItem>;\n\tpublic readonly parent!: TestItemImpl | undefined;\n\n\tpublic range!: vscode.Range | undefined;\n\tpublic description!: string | undefined;\n\tpublic sortText!: string | undefined;\n\tpublic label!: string;\n\tpublic error!: string | vscode.MarkdownString;\n\tpublic busy!: boolean;\n\tpublic canResolveChildren!: boolean;\n\tpublic tags!: readonly vscode.TestTag[];\n\n\t/**\n\t * Note that data is deprecated and here for back-compat only\n\t */\n\tconstructor(controllerId: string, id: string, label: string, uri: vscode.Uri | undefined) {\n\t\tif (id.includes(TestIdPathParts.Delimiter)) {\n\t\t\tthrow new Error(`Test IDs may not include the ${JSON.stringify(id)} symbol`);\n\t\t}\n\n\t\tconst api = createPrivateApiFor(this, controllerId);\n\t\tObject.defineProperties(this, {\n\t\t\tid: {\n\t\t\t\tvalue: id,\n\t\t\t\tenumerable: true,\n\t\t\t\twritable: false,\n\t\t\t},\n\t\t\turi: {\n\t\t\t\tvalue: uri,\n\t\t\t\tenumerable: true,\n\t\t\t\twritable: false,\n\t\t\t},\n\t\t\tparent: {\n\t\t\t\tenumerable: false,\n\t\t\t\tget() {\n\t\t\t\t\treturn api.parent instanceof TestItemRootImpl ? undefined : api.parent;\n\t\t\t\t},\n\t\t\t},\n\t\t\tchildren: {\n\t\t\t\tvalue: createTestItemChildren(api, getPrivateApiFor, TestItemImpl),\n\t\t\t\tenumerable: true,\n\t\t\t\twritable: false,\n\t\t\t},\n\t\t\t...makePropDescriptors(api, label),\n\t\t});\n\t}\n}\n\nexport class TestItemRootImpl extends TestItemImpl {\n\tconstructor(controllerId: string, label: string) {\n\t\tsuper(controllerId, controllerId, label, undefined);\n\t}\n}\n\nexport class ExtHostTestItemCollection extends TestItemCollection<TestItemImpl> {\n\tconstructor(controllerId: string, controllerLabel: string) {\n\t\tsuper({\n\t\t\tcontrollerId,\n\t\t\tgetApiFor: getPrivateApiFor as (impl: TestItemImpl) => ITestItemApi<TestItemImpl>,\n\t\t\tgetChildren: (item) => item.children as ITestChildrenLike<TestItemImpl>,\n\t\t\troot: new TestItemRootImpl(controllerId, controllerLabel),\n\t\t\ttoITestItem: Convert.TestItem.from,\n\t\t});\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ok } from 'vs/base/common/assert';\nimport { illegalArgument, readonly } from 'vs/base/common/errors';\nimport { IdGenerator } from 'vs/base/common/idGenerator';\nimport { TextEditorCursorStyle } from 'vs/editor/common/config/editorOptions';\nimport { IRange } from 'vs/editor/common/core/range';\nimport { ISingleEditOperation } from 'vs/editor/common/core/editOperation';\nimport { IResolvedTextEditorConfiguration, ITextEditorConfigurationUpdate, MainThreadTextEditorsShape } from 'vs/workbench/api/common/extHost.protocol';\nimport * as TypeConverters from 'vs/workbench/api/common/extHostTypeConverters';\nimport { EndOfLine, Position, Range, Selection, SnippetString, TextEditorLineNumbersStyle, TextEditorRevealType } from 'vs/workbench/api/common/extHostTypes';\nimport type * as vscode from 'vscode';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { Lazy } from 'vs/base/common/lazy';\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\n\nexport class TextEditorDecorationType {\n\n\tprivate static readonly _Keys = new IdGenerator('TextEditorDecorationType');\n\n\treadonly value: vscode.TextEditorDecorationType;\n\n\tconstructor(proxy: MainThreadTextEditorsShape, extension: IExtensionDescription, options: vscode.DecorationRenderOptions) {\n\t\tconst key = TextEditorDecorationType._Keys.nextId();\n\t\tproxy.$registerTextEditorDecorationType(extension.identifier, key, TypeConverters.DecorationRenderOptions.from(options));\n\t\tthis.value = Object.freeze({\n\t\t\tkey,\n\t\t\tdispose() {\n\t\t\t\tproxy.$removeTextEditorDecorationType(key);\n\t\t\t}\n\t\t});\n\t}\n\n}\n\nexport interface ITextEditOperation {\n\trange: vscode.Range;\n\ttext: string | null;\n\tforceMoveMarkers: boolean;\n}\n\nexport interface IEditData {\n\tdocumentVersionId: number;\n\tedits: ITextEditOperation[];\n\tsetEndOfLine: EndOfLine | undefined;\n\tundoStopBefore: boolean;\n\tundoStopAfter: boolean;\n}\n\nexport class TextEditorEdit {\n\n\tprivate readonly _document: vscode.TextDocument;\n\tprivate readonly _documentVersionId: number;\n\tprivate readonly _undoStopBefore: boolean;\n\tprivate readonly _undoStopAfter: boolean;\n\tprivate _collectedEdits: ITextEditOperation[] = [];\n\tprivate _setEndOfLine: EndOfLine | undefined = undefined;\n\tprivate _finalized: boolean = false;\n\n\tconstructor(document: vscode.TextDocument, options: { undoStopBefore: boolean; undoStopAfter: boolean }) {\n\t\tthis._document = document;\n\t\tthis._documentVersionId = document.version;\n\t\tthis._undoStopBefore = options.undoStopBefore;\n\t\tthis._undoStopAfter = options.undoStopAfter;\n\t}\n\n\tfinalize(): IEditData {\n\t\tthis._finalized = true;\n\t\treturn {\n\t\t\tdocumentVersionId: this._documentVersionId,\n\t\t\tedits: this._collectedEdits,\n\t\t\tsetEndOfLine: this._setEndOfLine,\n\t\t\tundoStopBefore: this._undoStopBefore,\n\t\t\tundoStopAfter: this._undoStopAfter\n\t\t};\n\t}\n\n\tprivate _throwIfFinalized() {\n\t\tif (this._finalized) {\n\t\t\tthrow new Error('Edit is only valid while callback runs');\n\t\t}\n\t}\n\n\treplace(location: Position | Range | Selection, value: string): void {\n\t\tthis._throwIfFinalized();\n\t\tlet range: Range | null = null;\n\n\t\tif (location instanceof Position) {\n\t\t\trange = new Range(location, location);\n\t\t} else if (location instanceof Range) {\n\t\t\trange = location;\n\t\t} else {\n\t\t\tthrow new Error('Unrecognized location');\n\t\t}\n\n\t\tthis._pushEdit(range, value, false);\n\t}\n\n\tinsert(location: Position, value: string): void {\n\t\tthis._throwIfFinalized();\n\t\tthis._pushEdit(new Range(location, location), value, true);\n\t}\n\n\tdelete(location: Range | Selection): void {\n\t\tthis._throwIfFinalized();\n\t\tlet range: Range | null = null;\n\n\t\tif (location instanceof Range) {\n\t\t\trange = location;\n\t\t} else {\n\t\t\tthrow new Error('Unrecognized location');\n\t\t}\n\n\t\tthis._pushEdit(range, null, true);\n\t}\n\n\tprivate _pushEdit(range: Range, text: string | null, forceMoveMarkers: boolean): void {\n\t\tconst validRange = this._document.validateRange(range);\n\t\tthis._collectedEdits.push({\n\t\t\trange: validRange,\n\t\t\ttext: text,\n\t\t\tforceMoveMarkers: forceMoveMarkers\n\t\t});\n\t}\n\n\tsetEndOfLine(endOfLine: EndOfLine): void {\n\t\tthis._throwIfFinalized();\n\t\tif (endOfLine !== EndOfLine.LF && endOfLine !== EndOfLine.CRLF) {\n\t\t\tthrow illegalArgument('endOfLine');\n\t\t}\n\n\t\tthis._setEndOfLine = endOfLine;\n\t}\n}\n\nexport class ExtHostTextEditorOptions {\n\n\tprivate _proxy: MainThreadTextEditorsShape;\n\tprivate _id: string;\n\tprivate _logService: ILogService;\n\n\tprivate _tabSize!: number;\n\tprivate _insertSpaces!: boolean;\n\tprivate _cursorStyle!: TextEditorCursorStyle;\n\tprivate _lineNumbers!: TextEditorLineNumbersStyle;\n\n\treadonly value: vscode.TextEditorOptions;\n\n\tconstructor(proxy: MainThreadTextEditorsShape, id: string, source: IResolvedTextEditorConfiguration, logService: ILogService) {\n\t\tthis._proxy = proxy;\n\t\tthis._id = id;\n\t\tthis._accept(source);\n\t\tthis._logService = logService;\n\n\t\tconst that = this;\n\n\t\tthis.value = {\n\t\t\tget tabSize(): number | string {\n\t\t\t\treturn that._tabSize;\n\t\t\t},\n\t\t\tset tabSize(value: number | string) {\n\t\t\t\tthat._setTabSize(value);\n\t\t\t},\n\t\t\tget insertSpaces(): boolean | string {\n\t\t\t\treturn that._insertSpaces;\n\t\t\t},\n\t\t\tset insertSpaces(value: boolean | string) {\n\t\t\t\tthat._setInsertSpaces(value);\n\t\t\t},\n\t\t\tget cursorStyle(): TextEditorCursorStyle {\n\t\t\t\treturn that._cursorStyle;\n\t\t\t},\n\t\t\tset cursorStyle(value: TextEditorCursorStyle) {\n\t\t\t\tthat._setCursorStyle(value);\n\t\t\t},\n\t\t\tget lineNumbers(): TextEditorLineNumbersStyle {\n\t\t\t\treturn that._lineNumbers;\n\t\t\t},\n\t\t\tset lineNumbers(value: TextEditorLineNumbersStyle) {\n\t\t\t\tthat._setLineNumbers(value);\n\t\t\t}\n\t\t};\n\t}\n\n\tpublic _accept(source: IResolvedTextEditorConfiguration): void {\n\t\tthis._tabSize = source.tabSize;\n\t\tthis._insertSpaces = source.insertSpaces;\n\t\tthis._cursorStyle = source.cursorStyle;\n\t\tthis._lineNumbers = TypeConverters.TextEditorLineNumbersStyle.to(source.lineNumbers);\n\t}\n\n\t// --- internal: tabSize\n\n\tprivate _validateTabSize(value: number | string): number | 'auto' | null {\n\t\tif (value === 'auto') {\n\t\t\treturn 'auto';\n\t\t}\n\t\tif (typeof value === 'number') {\n\t\t\tconst r = Math.floor(value);\n\t\t\treturn (r > 0 ? r : null);\n\t\t}\n\t\tif (typeof value === 'string') {\n\t\t\tconst r = parseInt(value, 10);\n\t\t\tif (isNaN(r)) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn (r > 0 ? r : null);\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate _setTabSize(value: number | string) {\n\t\tconst tabSize = this._validateTabSize(value);\n\t\tif (tabSize === null) {\n\t\t\t// ignore invalid call\n\t\t\treturn;\n\t\t}\n\t\tif (typeof tabSize === 'number') {\n\t\t\tif (this._tabSize === tabSize) {\n\t\t\t\t// nothing to do\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// reflect the new tabSize value immediately\n\t\t\tthis._tabSize = tabSize;\n\t\t}\n\t\tthis._warnOnError('setTabSize', this._proxy.$trySetOptions(this._id, {\n\t\t\ttabSize: tabSize\n\t\t}));\n\t}\n\n\t// --- internal: insert spaces\n\n\tprivate _validateInsertSpaces(value: boolean | string): boolean | 'auto' {\n\t\tif (value === 'auto') {\n\t\t\treturn 'auto';\n\t\t}\n\t\treturn (value === 'false' ? false : Boolean(value));\n\t}\n\n\tprivate _setInsertSpaces(value: boolean | string) {\n\t\tconst insertSpaces = this._validateInsertSpaces(value);\n\t\tif (typeof insertSpaces === 'boolean') {\n\t\t\tif (this._insertSpaces === insertSpaces) {\n\t\t\t\t// nothing to do\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// reflect the new insertSpaces value immediately\n\t\t\tthis._insertSpaces = insertSpaces;\n\t\t}\n\t\tthis._warnOnError('setInsertSpaces', this._proxy.$trySetOptions(this._id, {\n\t\t\tinsertSpaces: insertSpaces\n\t\t}));\n\t}\n\n\t// --- internal: cursor style\n\n\tprivate _setCursorStyle(value: TextEditorCursorStyle) {\n\t\tif (this._cursorStyle === value) {\n\t\t\t// nothing to do\n\t\t\treturn;\n\t\t}\n\t\tthis._cursorStyle = value;\n\t\tthis._warnOnError('setCursorStyle', this._proxy.$trySetOptions(this._id, {\n\t\t\tcursorStyle: value\n\t\t}));\n\t}\n\n\t// --- internal: line number\n\n\tprivate _setLineNumbers(value: TextEditorLineNumbersStyle) {\n\t\tif (this._lineNumbers === value) {\n\t\t\t// nothing to do\n\t\t\treturn;\n\t\t}\n\t\tthis._lineNumbers = value;\n\t\tthis._warnOnError('setLineNumbers', this._proxy.$trySetOptions(this._id, {\n\t\t\tlineNumbers: TypeConverters.TextEditorLineNumbersStyle.from(value)\n\t\t}));\n\t}\n\n\tpublic assign(newOptions: vscode.TextEditorOptions) {\n\t\tconst bulkConfigurationUpdate: ITextEditorConfigurationUpdate = {};\n\t\tlet hasUpdate = false;\n\n\t\tif (typeof newOptions.tabSize !== 'undefined') {\n\t\t\tconst tabSize = this._validateTabSize(newOptions.tabSize);\n\t\t\tif (tabSize === 'auto') {\n\t\t\t\thasUpdate = true;\n\t\t\t\tbulkConfigurationUpdate.tabSize = tabSize;\n\t\t\t} else if (typeof tabSize === 'number' && this._tabSize !== tabSize) {\n\t\t\t\t// reflect the new tabSize value immediately\n\t\t\t\tthis._tabSize = tabSize;\n\t\t\t\thasUpdate = true;\n\t\t\t\tbulkConfigurationUpdate.tabSize = tabSize;\n\t\t\t}\n\t\t}\n\n\t\t// if (typeof newOptions.indentSize !== 'undefined') {\n\t\t// \tconst indentSize = this._validateIndentSize(newOptions.indentSize);\n\t\t// \tif (indentSize === 'tabSize') {\n\t\t// \t\thasUpdate = true;\n\t\t// \t\tbulkConfigurationUpdate.indentSize = indentSize;\n\t\t// \t} else if (typeof indentSize === 'number' && this._indentSize !== indentSize) {\n\t\t// \t\t// reflect the new indentSize value immediately\n\t\t// \t\tthis._indentSize = indentSize;\n\t\t// \t\thasUpdate = true;\n\t\t// \t\tbulkConfigurationUpdate.indentSize = indentSize;\n\t\t// \t}\n\t\t// }\n\n\t\tif (typeof newOptions.insertSpaces !== 'undefined') {\n\t\t\tconst insertSpaces = this._validateInsertSpaces(newOptions.insertSpaces);\n\t\t\tif (insertSpaces === 'auto') {\n\t\t\t\thasUpdate = true;\n\t\t\t\tbulkConfigurationUpdate.insertSpaces = insertSpaces;\n\t\t\t} else if (this._insertSpaces !== insertSpaces) {\n\t\t\t\t// reflect the new insertSpaces value immediately\n\t\t\t\tthis._insertSpaces = insertSpaces;\n\t\t\t\thasUpdate = true;\n\t\t\t\tbulkConfigurationUpdate.insertSpaces = insertSpaces;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof newOptions.cursorStyle !== 'undefined') {\n\t\t\tif (this._cursorStyle !== newOptions.cursorStyle) {\n\t\t\t\tthis._cursorStyle = newOptions.cursorStyle;\n\t\t\t\thasUpdate = true;\n\t\t\t\tbulkConfigurationUpdate.cursorStyle = newOptions.cursorStyle;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof newOptions.lineNumbers !== 'undefined') {\n\t\t\tif (this._lineNumbers !== newOptions.lineNumbers) {\n\t\t\t\tthis._lineNumbers = newOptions.lineNumbers;\n\t\t\t\thasUpdate = true;\n\t\t\t\tbulkConfigurationUpdate.lineNumbers = TypeConverters.TextEditorLineNumbersStyle.from(newOptions.lineNumbers);\n\t\t\t}\n\t\t}\n\n\t\tif (hasUpdate) {\n\t\t\tthis._warnOnError('setOptions', this._proxy.$trySetOptions(this._id, bulkConfigurationUpdate));\n\t\t}\n\t}\n\n\tprivate _warnOnError(action: string, promise: Promise<any>): void {\n\t\tpromise.catch(err => {\n\t\t\tthis._logService.warn(`ExtHostTextEditorOptions '${action}' failed:'`);\n\t\t\tthis._logService.warn(err);\n\t\t});\n\t}\n}\n\nexport class ExtHostTextEditor {\n\n\tprivate _selections: Selection[];\n\tprivate _options: ExtHostTextEditorOptions;\n\tprivate _visibleRanges: Range[];\n\tprivate _viewColumn: vscode.ViewColumn | undefined;\n\tprivate _disposed: boolean = false;\n\tprivate _hasDecorationsForKey = new Set<string>();\n\n\treadonly value: vscode.TextEditor;\n\n\tconstructor(\n\t\treadonly id: string,\n\t\tprivate readonly _proxy: MainThreadTextEditorsShape,\n\t\tprivate readonly _logService: ILogService,\n\t\tdocument: Lazy<vscode.TextDocument>,\n\t\tselections: Selection[], options: IResolvedTextEditorConfiguration,\n\t\tvisibleRanges: Range[], viewColumn: vscode.ViewColumn | undefined\n\t) {\n\t\tthis._selections = selections;\n\t\tthis._options = new ExtHostTextEditorOptions(this._proxy, this.id, options, _logService);\n\t\tthis._visibleRanges = visibleRanges;\n\t\tthis._viewColumn = viewColumn;\n\n\t\tconst that = this;\n\n\t\tthis.value = Object.freeze({\n\t\t\tget document(): vscode.TextDocument {\n\t\t\t\treturn document.getValue();\n\t\t\t},\n\t\t\tset document(_value) {\n\t\t\t\tthrow readonly('document');\n\t\t\t},\n\t\t\t// --- selection\n\t\t\tget selection(): Selection {\n\t\t\t\treturn that._selections && that._selections[0];\n\t\t\t},\n\t\t\tset selection(value: Selection) {\n\t\t\t\tif (!(value instanceof Selection)) {\n\t\t\t\t\tthrow illegalArgument('selection');\n\t\t\t\t}\n\t\t\t\tthat._selections = [value];\n\t\t\t\tthat._trySetSelection();\n\t\t\t},\n\t\t\tget selections(): Selection[] {\n\t\t\t\treturn that._selections;\n\t\t\t},\n\t\t\tset selections(value: Selection[]) {\n\t\t\t\tif (!Array.isArray(value) || value.some(a => !(a instanceof Selection))) {\n\t\t\t\t\tthrow illegalArgument('selections');\n\t\t\t\t}\n\t\t\t\tthat._selections = value;\n\t\t\t\tthat._trySetSelection();\n\t\t\t},\n\t\t\t// --- visible ranges\n\t\t\tget visibleRanges(): Range[] {\n\t\t\t\treturn that._visibleRanges;\n\t\t\t},\n\t\t\tset visibleRanges(_value: Range[]) {\n\t\t\t\tthrow readonly('visibleRanges');\n\t\t\t},\n\t\t\t// --- options\n\t\t\tget options(): vscode.TextEditorOptions {\n\t\t\t\treturn that._options.value;\n\t\t\t},\n\t\t\tset options(value: vscode.TextEditorOptions) {\n\t\t\t\tif (!that._disposed) {\n\t\t\t\t\tthat._options.assign(value);\n\t\t\t\t}\n\t\t\t},\n\t\t\t// --- view column\n\t\t\tget viewColumn(): vscode.ViewColumn | undefined {\n\t\t\t\treturn that._viewColumn;\n\t\t\t},\n\t\t\tset viewColumn(_value) {\n\t\t\t\tthrow readonly('viewColumn');\n\t\t\t},\n\t\t\t// --- edit\n\t\t\tedit(callback: (edit: TextEditorEdit) => void, options: { undoStopBefore: boolean; undoStopAfter: boolean } = { undoStopBefore: true, undoStopAfter: true }): Promise<boolean> {\n\t\t\t\tif (that._disposed) {\n\t\t\t\t\treturn Promise.reject(new Error('TextEditor#edit not possible on closed editors'));\n\t\t\t\t}\n\t\t\t\tconst edit = new TextEditorEdit(document.getValue(), options);\n\t\t\t\tcallback(edit);\n\t\t\t\treturn that._applyEdit(edit);\n\t\t\t},\n\t\t\t// --- snippet edit\n\t\t\tinsertSnippet(snippet: SnippetString, where?: Position | readonly Position[] | Range | readonly Range[], options: { undoStopBefore: boolean; undoStopAfter: boolean } = { undoStopBefore: true, undoStopAfter: true }): Promise<boolean> {\n\t\t\t\tif (that._disposed) {\n\t\t\t\t\treturn Promise.reject(new Error('TextEditor#insertSnippet not possible on closed editors'));\n\t\t\t\t}\n\t\t\t\tlet ranges: IRange[];\n\n\t\t\t\tif (!where || (Array.isArray(where) && where.length === 0)) {\n\t\t\t\t\tranges = that._selections.map(range => TypeConverters.Range.from(range));\n\n\t\t\t\t} else if (where instanceof Position) {\n\t\t\t\t\tconst { lineNumber, column } = TypeConverters.Position.from(where);\n\t\t\t\t\tranges = [{ startLineNumber: lineNumber, startColumn: column, endLineNumber: lineNumber, endColumn: column }];\n\n\t\t\t\t} else if (where instanceof Range) {\n\t\t\t\t\tranges = [TypeConverters.Range.from(where)];\n\t\t\t\t} else {\n\t\t\t\t\tranges = [];\n\t\t\t\t\tfor (const posOrRange of where) {\n\t\t\t\t\t\tif (posOrRange instanceof Range) {\n\t\t\t\t\t\t\tranges.push(TypeConverters.Range.from(posOrRange));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst { lineNumber, column } = TypeConverters.Position.from(posOrRange);\n\t\t\t\t\t\t\tranges.push({ startLineNumber: lineNumber, startColumn: column, endLineNumber: lineNumber, endColumn: column });\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn _proxy.$tryInsertSnippet(id, document.getValue().version, snippet.value, ranges, options);\n\t\t\t},\n\t\t\tsetDecorations(decorationType: vscode.TextEditorDecorationType, ranges: Range[] | vscode.DecorationOptions[]): void {\n\t\t\t\tconst willBeEmpty = (ranges.length === 0);\n\t\t\t\tif (willBeEmpty && !that._hasDecorationsForKey.has(decorationType.key)) {\n\t\t\t\t\t// avoid no-op call to the renderer\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (willBeEmpty) {\n\t\t\t\t\tthat._hasDecorationsForKey.delete(decorationType.key);\n\t\t\t\t} else {\n\t\t\t\t\tthat._hasDecorationsForKey.add(decorationType.key);\n\t\t\t\t}\n\t\t\t\tthat._runOnProxy(() => {\n\t\t\t\t\tif (TypeConverters.isDecorationOptionsArr(ranges)) {\n\t\t\t\t\t\treturn _proxy.$trySetDecorations(\n\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\tdecorationType.key,\n\t\t\t\t\t\t\tTypeConverters.fromRangeOrRangeWithMessage(ranges)\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst _ranges: number[] = new Array<number>(4 * ranges.length);\n\t\t\t\t\t\tfor (let i = 0, len = ranges.length; i < len; i++) {\n\t\t\t\t\t\t\tconst range = ranges[i];\n\t\t\t\t\t\t\t_ranges[4 * i] = range.start.line + 1;\n\t\t\t\t\t\t\t_ranges[4 * i + 1] = range.start.character + 1;\n\t\t\t\t\t\t\t_ranges[4 * i + 2] = range.end.line + 1;\n\t\t\t\t\t\t\t_ranges[4 * i + 3] = range.end.character + 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn _proxy.$trySetDecorationsFast(\n\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\tdecorationType.key,\n\t\t\t\t\t\t\t_ranges\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\trevealRange(range: Range, revealType: vscode.TextEditorRevealType): void {\n\t\t\t\tthat._runOnProxy(() => _proxy.$tryRevealRange(\n\t\t\t\t\tid,\n\t\t\t\t\tTypeConverters.Range.from(range),\n\t\t\t\t\t(revealType || TextEditorRevealType.Default)\n\t\t\t\t));\n\t\t\t},\n\t\t\tshow(column: vscode.ViewColumn) {\n\t\t\t\t_proxy.$tryShowEditor(id, TypeConverters.ViewColumn.from(column));\n\t\t\t},\n\t\t\thide() {\n\t\t\t\t_proxy.$tryHideEditor(id);\n\t\t\t}\n\t\t});\n\t}\n\n\tdispose() {\n\t\tok(!this._disposed);\n\t\tthis._disposed = true;\n\t}\n\n\t// --- incoming: extension host MUST accept what the renderer says\n\n\t_acceptOptions(options: IResolvedTextEditorConfiguration): void {\n\t\tok(!this._disposed);\n\t\tthis._options._accept(options);\n\t}\n\n\t_acceptVisibleRanges(value: Range[]): void {\n\t\tok(!this._disposed);\n\t\tthis._visibleRanges = value;\n\t}\n\n\t_acceptViewColumn(value: vscode.ViewColumn) {\n\t\tok(!this._disposed);\n\t\tthis._viewColumn = value;\n\t}\n\n\t_acceptSelections(selections: Selection[]): void {\n\t\tok(!this._disposed);\n\t\tthis._selections = selections;\n\t}\n\n\tprivate async _trySetSelection(): Promise<vscode.TextEditor | null | undefined> {\n\t\tconst selection = this._selections.map(TypeConverters.Selection.from);\n\t\tawait this._runOnProxy(() => this._proxy.$trySetSelections(this.id, selection));\n\t\treturn this.value;\n\t}\n\n\tprivate _applyEdit(editBuilder: TextEditorEdit): Promise<boolean> {\n\t\tconst editData = editBuilder.finalize();\n\n\t\t// return when there is nothing to do\n\t\tif (editData.edits.length === 0 && !editData.setEndOfLine) {\n\t\t\treturn Promise.resolve(true);\n\t\t}\n\n\t\t// check that the edits are not overlapping (i.e. illegal)\n\t\tconst editRanges = editData.edits.map(edit => edit.range);\n\n\t\t// sort ascending (by end and then by start)\n\t\teditRanges.sort((a, b) => {\n\t\t\tif (a.end.line === b.end.line) {\n\t\t\t\tif (a.end.character === b.end.character) {\n\t\t\t\t\tif (a.start.line === b.start.line) {\n\t\t\t\t\t\treturn a.start.character - b.start.character;\n\t\t\t\t\t}\n\t\t\t\t\treturn a.start.line - b.start.line;\n\t\t\t\t}\n\t\t\t\treturn a.end.character - b.end.character;\n\t\t\t}\n\t\t\treturn a.end.line - b.end.line;\n\t\t});\n\n\t\t// check that no edits are overlapping\n\t\tfor (let i = 0, count = editRanges.length - 1; i < count; i++) {\n\t\t\tconst rangeEnd = editRanges[i].end;\n\t\t\tconst nextRangeStart = editRanges[i + 1].start;\n\n\t\t\tif (nextRangeStart.isBefore(rangeEnd)) {\n\t\t\t\t// overlapping ranges\n\t\t\t\treturn Promise.reject(\n\t\t\t\t\tnew Error('Overlapping ranges are not allowed!')\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\t// prepare data for serialization\n\t\tconst edits = editData.edits.map((edit): ISingleEditOperation => {\n\t\t\treturn {\n\t\t\t\trange: TypeConverters.Range.from(edit.range),\n\t\t\t\ttext: edit.text,\n\t\t\t\tforceMoveMarkers: edit.forceMoveMarkers\n\t\t\t};\n\t\t});\n\n\t\treturn this._proxy.$tryApplyEdits(this.id, editData.documentVersionId, edits, {\n\t\t\tsetEndOfLine: typeof editData.setEndOfLine === 'number' ? TypeConverters.EndOfLine.from(editData.setEndOfLine) : undefined,\n\t\t\tundoStopBefore: editData.undoStopBefore,\n\t\t\tundoStopAfter: editData.undoStopAfter\n\t\t});\n\t}\n\tprivate _runOnProxy(callback: () => Promise<any>): Promise<ExtHostTextEditor | undefined | null> {\n\t\tif (this._disposed) {\n\t\t\tthis._logService.warn('TextEditor is closed/disposed');\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\treturn callback().then(() => this, err => {\n\t\t\tif (!(err instanceof Error && err.name === 'DISPOSED')) {\n\t\t\t\tthis._logService.warn(err);\n\t\t\t}\n\t\t\treturn null;\n\t\t});\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { refineServiceDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { IPath } from 'vs/platform/window/common/window';\nimport { IEnvironmentService } from 'vs/platform/environment/common/environment';\nimport { URI } from 'vs/base/common/uri';\n\nexport const IWorkbenchEnvironmentService = refineServiceDecorator<IEnvironmentService, IWorkbenchEnvironmentService>(IEnvironmentService);\n\n/**\n * A workbench specific environment service that is only present in workbench\n * layer.\n */\nexport interface IWorkbenchEnvironmentService extends IEnvironmentService {\n\n\t// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n\t// NOTE: KEEP THIS INTERFACE AS SMALL AS POSSIBLE. AS SUCH:\n\t//       PUT NON-WEB PROPERTIES INTO THE NATIVE WORKBENCH\n\t//       ENVIRONMENT SERVICE\n\t// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n\n\t// --- Paths\n\treadonly logFile: URI;\n\treadonly extHostLogsPath: URI;\n\n\t// --- Extensions\n\treadonly extensionEnabledProposedApi?: string[];\n\n\t// --- Config\n\treadonly remoteAuthority?: string;\n\treadonly skipReleaseNotes: boolean;\n\treadonly skipWelcome: boolean;\n\treadonly disableWorkspaceTrust: boolean;\n\treadonly webviewExternalEndpoint: string;\n\n\t// --- Development\n\treadonly debugRenderer: boolean;\n\treadonly logExtensionHostCommunication?: boolean;\n\treadonly enableSmokeTestDriver?: boolean;\n\n\t// --- Editors to open\n\treadonly filesToOpenOrCreate?: IPath[] | undefined;\n\treadonly filesToDiff?: IPath[] | undefined;\n\treadonly filesToMerge?: IPath[] | undefined;\n\n\t// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n\t// NOTE: KEEP THIS INTERFACE AS SMALL AS POSSIBLE. AS SUCH:\n\t//       - PUT NON-WEB PROPERTIES INTO NATIVE WB ENV SERVICE\n\t// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ExtensionIdentifier, IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { Emitter } from 'vs/base/common/event';\nimport * as path from 'vs/base/common/path';\n\nexport class DeltaExtensionsResult {\n\tconstructor(\n\t\tpublic readonly removedDueToLooping: IExtensionDescription[]\n\t) { }\n}\n\nexport class ExtensionDescriptionRegistry {\n\tprivate readonly _onDidChange = new Emitter<void>();\n\tpublic readonly onDidChange = this._onDidChange.event;\n\n\tprivate _extensionDescriptions: IExtensionDescription[];\n\tprivate _extensionsMap!: Map<string, IExtensionDescription>;\n\tprivate _extensionsArr!: IExtensionDescription[];\n\tprivate _activationMap!: Map<string, IExtensionDescription[]>;\n\n\tconstructor(extensionDescriptions: IExtensionDescription[]) {\n\t\tthis._extensionDescriptions = extensionDescriptions;\n\t\tthis._initialize();\n\t}\n\n\tprivate _initialize(): void {\n\t\t// Ensure extensions are stored in the order: builtin, user, under development\n\t\tthis._extensionDescriptions.sort(extensionCmp);\n\n\t\tthis._extensionsMap = new Map<string, IExtensionDescription>();\n\t\tthis._extensionsArr = [];\n\t\tthis._activationMap = new Map<string, IExtensionDescription[]>();\n\n\t\tfor (const extensionDescription of this._extensionDescriptions) {\n\t\t\tif (this._extensionsMap.has(ExtensionIdentifier.toKey(extensionDescription.identifier))) {\n\t\t\t\t// No overwriting allowed!\n\t\t\t\tconsole.error('Extension `' + extensionDescription.identifier.value + '` is already registered');\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tthis._extensionsMap.set(ExtensionIdentifier.toKey(extensionDescription.identifier), extensionDescription);\n\t\t\tthis._extensionsArr.push(extensionDescription);\n\n\t\t\tif (Array.isArray(extensionDescription.activationEvents)) {\n\t\t\t\tfor (let activationEvent of extensionDescription.activationEvents) {\n\t\t\t\t\t// TODO@joao: there's no easy way to contribute this\n\t\t\t\t\tif (activationEvent === 'onUri') {\n\t\t\t\t\t\tactivationEvent = `onUri:${ExtensionIdentifier.toKey(extensionDescription.identifier)}`;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this._activationMap.has(activationEvent)) {\n\t\t\t\t\t\tthis._activationMap.set(activationEvent, []);\n\t\t\t\t\t}\n\t\t\t\t\tthis._activationMap.get(activationEvent)!.push(extensionDescription);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic set(extensionDescriptions: IExtensionDescription[]) {\n\t\tthis._extensionDescriptions = extensionDescriptions;\n\t\tthis._initialize();\n\t\tthis._onDidChange.fire(undefined);\n\t}\n\n\tpublic deltaExtensions(toAdd: IExtensionDescription[], toRemove: ExtensionIdentifier[]): DeltaExtensionsResult {\n\t\t// It is possible that an extension is removed, only to be added again at a different version\n\t\t// so we will first handle removals\n\t\tthis._extensionDescriptions = removeExtensions(this._extensionDescriptions, toRemove);\n\n\t\t// Then, handle the extensions to add\n\t\tthis._extensionDescriptions = this._extensionDescriptions.concat(toAdd);\n\n\t\t// Immediately remove looping extensions!\n\t\tconst looping = ExtensionDescriptionRegistry._findLoopingExtensions(this._extensionDescriptions);\n\t\tthis._extensionDescriptions = removeExtensions(this._extensionDescriptions, looping.map(ext => ext.identifier));\n\n\t\tthis._initialize();\n\t\tthis._onDidChange.fire(undefined);\n\t\treturn new DeltaExtensionsResult(looping);\n\t}\n\n\tprivate static _findLoopingExtensions(extensionDescriptions: IExtensionDescription[]): IExtensionDescription[] {\n\t\tconst G = new class {\n\n\t\t\tprivate _arcs = new Map<string, string[]>();\n\t\t\tprivate _nodesSet = new Set<string>();\n\t\t\tprivate _nodesArr: string[] = [];\n\n\t\t\taddNode(id: string): void {\n\t\t\t\tif (!this._nodesSet.has(id)) {\n\t\t\t\t\tthis._nodesSet.add(id);\n\t\t\t\t\tthis._nodesArr.push(id);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\taddArc(from: string, to: string): void {\n\t\t\t\tthis.addNode(from);\n\t\t\t\tthis.addNode(to);\n\t\t\t\tif (this._arcs.has(from)) {\n\t\t\t\t\tthis._arcs.get(from)!.push(to);\n\t\t\t\t} else {\n\t\t\t\t\tthis._arcs.set(from, [to]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tgetArcs(id: string): string[] {\n\t\t\t\tif (this._arcs.has(id)) {\n\t\t\t\t\treturn this._arcs.get(id)!;\n\t\t\t\t}\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\thasOnlyGoodArcs(id: string, good: Set<string>): boolean {\n\t\t\t\tconst dependencies = G.getArcs(id);\n\t\t\t\tfor (let i = 0; i < dependencies.length; i++) {\n\t\t\t\t\tif (!good.has(dependencies[i])) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tgetNodes(): string[] {\n\t\t\t\treturn this._nodesArr;\n\t\t\t}\n\t\t};\n\n\t\tconst descs = new Map<string, IExtensionDescription>();\n\t\tfor (const extensionDescription of extensionDescriptions) {\n\t\t\tconst extensionId = ExtensionIdentifier.toKey(extensionDescription.identifier);\n\t\t\tdescs.set(extensionId, extensionDescription);\n\t\t\tif (extensionDescription.extensionDependencies) {\n\t\t\t\tfor (const _depId of extensionDescription.extensionDependencies) {\n\t\t\t\t\tconst depId = ExtensionIdentifier.toKey(_depId);\n\t\t\t\t\tG.addArc(extensionId, depId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// initialize with all extensions with no dependencies.\n\t\tconst good = new Set<string>();\n\t\tG.getNodes().filter(id => G.getArcs(id).length === 0).forEach(id => good.add(id));\n\n\t\t// all other extensions will be processed below.\n\t\tconst nodes = G.getNodes().filter(id => !good.has(id));\n\n\t\tlet madeProgress: boolean;\n\t\tdo {\n\t\t\tmadeProgress = false;\n\n\t\t\t// find one extension which has only good deps\n\t\t\tfor (let i = 0; i < nodes.length; i++) {\n\t\t\t\tconst id = nodes[i];\n\n\t\t\t\tif (G.hasOnlyGoodArcs(id, good)) {\n\t\t\t\t\tnodes.splice(i, 1);\n\t\t\t\t\ti--;\n\t\t\t\t\tgood.add(id);\n\t\t\t\t\tmadeProgress = true;\n\t\t\t\t}\n\t\t\t}\n\t\t} while (madeProgress);\n\n\t\t// The remaining nodes are bad and have loops\n\t\treturn nodes.map(id => descs.get(id)!);\n\t}\n\n\tpublic containsActivationEvent(activationEvent: string): boolean {\n\t\treturn this._activationMap.has(activationEvent);\n\t}\n\n\tpublic containsExtension(extensionId: ExtensionIdentifier): boolean {\n\t\treturn this._extensionsMap.has(ExtensionIdentifier.toKey(extensionId));\n\t}\n\n\tpublic getExtensionDescriptionsForActivationEvent(activationEvent: string): IExtensionDescription[] {\n\t\tconst extensions = this._activationMap.get(activationEvent);\n\t\treturn extensions ? extensions.slice(0) : [];\n\t}\n\n\tpublic getAllExtensionDescriptions(): IExtensionDescription[] {\n\t\treturn this._extensionsArr.slice(0);\n\t}\n\n\tpublic getExtensionDescription(extensionId: ExtensionIdentifier | string): IExtensionDescription | undefined {\n\t\tconst extension = this._extensionsMap.get(ExtensionIdentifier.toKey(extensionId));\n\t\treturn extension ? extension : undefined;\n\t}\n\n\tpublic getExtensionDescriptionByUUID(uuid: string): IExtensionDescription | undefined {\n\t\tfor (const extensionDescription of this._extensionsArr) {\n\t\t\tif (extensionDescription.uuid === uuid) {\n\t\t\t\treturn extensionDescription;\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tpublic getExtensionDescriptionByIdOrUUID(extensionId: ExtensionIdentifier | string, uuid: string | undefined): IExtensionDescription | undefined {\n\t\treturn (\n\t\t\tthis.getExtensionDescription(extensionId)\n\t\t\t?? (uuid ? this.getExtensionDescriptionByUUID(uuid) : undefined)\n\t\t);\n\t}\n}\n\nconst enum SortBucket {\n\tBuiltin = 0,\n\tUser = 1,\n\tDev = 2\n}\n\n/**\n * Ensure that:\n * - first are builtin extensions\n * - second are user extensions\n * - third are extensions under development\n *\n * In each bucket, extensions must be sorted alphabetically by their folder name.\n */\nfunction extensionCmp(a: IExtensionDescription, b: IExtensionDescription): number {\n\tconst aSortBucket = (a.isBuiltin ? SortBucket.Builtin : a.isUnderDevelopment ? SortBucket.Dev : SortBucket.User);\n\tconst bSortBucket = (b.isBuiltin ? SortBucket.Builtin : b.isUnderDevelopment ? SortBucket.Dev : SortBucket.User);\n\tif (aSortBucket !== bSortBucket) {\n\t\treturn aSortBucket - bSortBucket;\n\t}\n\tconst aLastSegment = path.posix.basename(a.extensionLocation.path);\n\tconst bLastSegment = path.posix.basename(b.extensionLocation.path);\n\tif (aLastSegment < bLastSegment) {\n\t\treturn -1;\n\t}\n\tif (aLastSegment > bLastSegment) {\n\t\treturn 1;\n\t}\n\treturn 0;\n}\n\nfunction removeExtensions(arr: IExtensionDescription[], toRemove: ExtensionIdentifier[]): IExtensionDescription[] {\n\tconst toRemoveSet = new Set<string>();\n\ttoRemove.forEach(extensionId => toRemoveSet.add(ExtensionIdentifier.toKey(extensionId)));\n\treturn arr.filter(extension => !toRemoveSet.has(ExtensionIdentifier.toKey(extension.identifier)));\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { VSBuffer } from 'vs/base/common/buffer';\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { ExtensionIdentifier, IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { LogLevel } from 'vs/platform/log/common/log';\nimport { IRemoteConnectionData } from 'vs/platform/remote/common/remoteAuthorityResolver';\nimport { ITelemetryInfo } from 'vs/platform/telemetry/common/telemetry';\n\nexport interface IExtensionDescriptionDelta {\n\treadonly toRemove: ExtensionIdentifier[];\n\treadonly toAdd: IExtensionDescription[];\n\treadonly myToRemove: ExtensionIdentifier[];\n\treadonly myToAdd: ExtensionIdentifier[];\n}\n\nexport interface IExtensionHostInitData {\n\tversion: string;\n\tcommit?: string;\n\t/**\n\t * When set to `0`, no polling for the parent process still running will happen.\n\t */\n\tparentPid: number | 0;\n\tenvironment: IEnvironment;\n\tworkspace?: IStaticWorkspaceData | null;\n\tallExtensions: IExtensionDescription[];\n\tmyExtensions: ExtensionIdentifier[];\n\ttelemetryInfo: ITelemetryInfo;\n\tlogLevel: LogLevel;\n\tlogsLocation: URI;\n\tlogFile: URI;\n\tautoStart: boolean;\n\tremote: { isRemote: boolean; authority: string | undefined; connectionData: IRemoteConnectionData | null };\n\tconsoleForward: { includeStack: boolean; logNative: boolean };\n\tuiKind: UIKind;\n\tmessagePorts?: ReadonlyMap<string, MessagePortLike>;\n}\n\nexport interface IEnvironment {\n\tisExtensionDevelopmentDebug: boolean;\n\tappName: string;\n\tappHost: string;\n\tappRoot?: URI;\n\tappLanguage: string;\n\tappUriScheme: string;\n\textensionDevelopmentLocationURI?: URI[];\n\textensionTestsLocationURI?: URI;\n\tglobalStorageHome: URI;\n\tworkspaceStorageHome: URI;\n\tuseHostProxy?: boolean;\n\tskipWorkspaceStorageLock?: boolean;\n}\n\nexport interface IStaticWorkspaceData {\n\tid: string;\n\tname: string;\n\ttransient?: boolean;\n\tconfiguration?: UriComponents | null;\n\tisUntitled?: boolean | null;\n}\n\nexport interface MessagePortLike {\n\tpostMessage(message: any, transfer?: any[]): void;\n\taddEventListener(type: 'message', listener: (e: any) => any): void;\n\tremoveEventListener(type: 'message', listener: (e: any) => any): void;\n\tstart(): void;\n}\n\nexport enum UIKind {\n\tDesktop = 1,\n\tWeb = 2\n}\n\nexport const enum ExtensionHostExitCode {\n\t// nodejs uses codes 1-13 and exit codes >128 are signal exits\n\tVersionMismatch = 55,\n\tUnexpectedError = 81,\n}\n\nexport interface IExtHostReadyMessage {\n\ttype: 'VSCODE_EXTHOST_IPC_READY';\n}\n\nexport interface IExtHostSocketMessage {\n\ttype: 'VSCODE_EXTHOST_IPC_SOCKET';\n\tinitialDataChunk: string;\n\tskipWebSocketFrames: boolean;\n\tpermessageDeflate: boolean;\n\tinflateBytes: string;\n}\n\nexport interface IExtHostReduceGraceTimeMessage {\n\ttype: 'VSCODE_EXTHOST_IPC_REDUCE_GRACE_TIME';\n}\n\nexport const enum MessageType {\n\tInitialized,\n\tReady,\n\tTerminate\n}\n\nexport function createMessageOfType(type: MessageType): VSBuffer {\n\tconst result = VSBuffer.alloc(1);\n\n\tswitch (type) {\n\t\tcase MessageType.Initialized: result.writeUInt8(1, 0); break;\n\t\tcase MessageType.Ready: result.writeUInt8(2, 0); break;\n\t\tcase MessageType.Terminate: result.writeUInt8(3, 0); break;\n\t}\n\n\treturn result;\n}\n\nexport function isMessageOfType(message: VSBuffer, type: MessageType): boolean {\n\tif (message.byteLength !== 1) {\n\t\treturn false;\n\t}\n\n\tswitch (message.readUInt8(0)) {\n\t\tcase 1: return type === MessageType.Initialized;\n\t\tcase 2: return type === MessageType.Ready;\n\t\tcase 3: return type === MessageType.Terminate;\n\t\tdefault: return false;\n\t}\n}\n\nexport const enum NativeLogMarkers {\n\tStart = 'START_NATIVE_LOG',\n\tEnd = 'END_NATIVE_LOG',\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Event } from 'vs/base/common/event';\nimport Severity from 'vs/base/common/severity';\nimport { URI } from 'vs/base/common/uri';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { IExtensionPoint } from 'vs/workbench/services/extensions/common/extensionsRegistry';\nimport { ExtensionIdentifier, IExtension, ExtensionType, IExtensionDescription, IExtensionContributions, TargetPlatform } from 'vs/platform/extensions/common/extensions';\nimport { getExtensionId, getGalleryExtensionId } from 'vs/platform/extensionManagement/common/extensionManagementUtil';\nimport { IMessagePassingProtocol } from 'vs/base/parts/ipc/common/ipc';\nimport { ApiProposalName } from 'vs/workbench/services/extensions/common/extensionsApiProposals';\nimport { IV8Profile } from 'vs/platform/profiling/common/profiling';\nimport { IExtensionDescriptionDelta } from 'vs/workbench/services/extensions/common/extensionHostProtocol';\n\nexport const nullExtensionDescription = Object.freeze<IExtensionDescription>({\n\tidentifier: new ExtensionIdentifier('nullExtensionDescription'),\n\tname: 'Null Extension Description',\n\tversion: '0.0.0',\n\tpublisher: 'vscode',\n\tengines: { vscode: '' },\n\textensionLocation: URI.parse('void:location'),\n\tisBuiltin: false,\n\ttargetPlatform: TargetPlatform.UNDEFINED,\n\tisUserBuiltin: false,\n\tisUnderDevelopment: false,\n});\n\nexport type WebWorkerExtHostConfigValue = boolean | 'auto';\nexport const webWorkerExtHostConfig = 'extensions.webWorker';\n\nexport const IExtensionService = createDecorator<IExtensionService>('extensionService');\n\nexport interface IMessage {\n\ttype: Severity;\n\tmessage: string;\n\textensionId: ExtensionIdentifier;\n\textensionPointId: string;\n}\n\nexport class LocalProcessRunningLocation {\n\tpublic readonly kind = ExtensionHostKind.LocalProcess;\n\tconstructor(\n\t\tpublic readonly affinity: number\n\t) { }\n\tpublic equals(other: ExtensionRunningLocation) {\n\t\treturn (this.kind === other.kind && this.affinity === other.affinity);\n\t}\n\tpublic asString(): string {\n\t\tif (this.affinity === 0) {\n\t\t\treturn 'LocalProcess';\n\t\t}\n\t\treturn `LocalProcess${this.affinity}`;\n\t}\n}\nexport class LocalWebWorkerRunningLocation {\n\tpublic readonly kind = ExtensionHostKind.LocalWebWorker;\n\tpublic readonly affinity = 0;\n\tpublic equals(other: ExtensionRunningLocation) {\n\t\treturn (this.kind === other.kind);\n\t}\n\tpublic asString(): string {\n\t\treturn 'LocalWebWorker';\n\t}\n}\nexport class RemoteRunningLocation {\n\tpublic readonly kind = ExtensionHostKind.Remote;\n\tpublic readonly affinity = 0;\n\tpublic equals(other: ExtensionRunningLocation) {\n\t\treturn (this.kind === other.kind);\n\t}\n\tpublic asString(): string {\n\t\treturn 'Remote';\n\t}\n}\nexport type ExtensionRunningLocation = LocalProcessRunningLocation | LocalWebWorkerRunningLocation | RemoteRunningLocation;\n\nexport interface IExtensionsStatus {\n\tmessages: IMessage[];\n\tactivationTimes: ActivationTimes | undefined;\n\truntimeErrors: Error[];\n\trunningLocation: ExtensionRunningLocation | null;\n}\n\nexport class MissingExtensionDependency {\n\tconstructor(readonly dependency: string) { }\n}\n\n/**\n * e.g.\n * ```\n * {\n *    startTime: 1511954813493000,\n *    endTime: 1511954835590000,\n *    deltas: [ 100, 1500, 123456, 1500, 100000 ],\n *    ids: [ 'idle', 'self', 'extension1', 'self', 'idle' ]\n * }\n * ```\n */\nexport interface IExtensionHostProfile {\n\t/**\n\t * Profiling start timestamp in microseconds.\n\t */\n\tstartTime: number;\n\t/**\n\t * Profiling end timestamp in microseconds.\n\t */\n\tendTime: number;\n\t/**\n\t * Duration of segment in microseconds.\n\t */\n\tdeltas: number[];\n\t/**\n\t * Segment identifier: extension id or one of the four known strings.\n\t */\n\tids: ProfileSegmentId[];\n\n\t/**\n\t * Get the information as a .cpuprofile.\n\t */\n\tdata: IV8Profile;\n\n\t/**\n\t * Get the aggregated time per segmentId\n\t */\n\tgetAggregatedTimes(): Map<ProfileSegmentId, number>;\n}\n\nexport const enum ExtensionHostKind {\n\tLocalProcess = 1,\n\tLocalWebWorker = 2,\n\tRemote = 3\n}\n\nexport function extensionHostKindToString(kind: ExtensionHostKind | null): string {\n\tif (kind === null) {\n\t\treturn 'None';\n\t}\n\tswitch (kind) {\n\t\tcase ExtensionHostKind.LocalProcess: return 'LocalProcess';\n\t\tcase ExtensionHostKind.LocalWebWorker: return 'LocalWebWorker';\n\t\tcase ExtensionHostKind.Remote: return 'Remote';\n\t}\n}\n\nexport interface IExtensionHost {\n\treadonly runningLocation: ExtensionRunningLocation;\n\treadonly remoteAuthority: string | null;\n\treadonly lazyStart: boolean;\n\t/**\n\t * A collection of extensions which includes information about which\n\t * extension will execute or is executing on this extension host.\n\t * **NOTE**: this will reflect extensions correctly only after `start()` resolves.\n\t */\n\treadonly extensions: ExtensionHostExtensions;\n\treadonly onExit: Event<[number, string | null]>;\n\n\tstart(): Promise<IMessagePassingProtocol>;\n\tgetInspectPort(): number | undefined;\n\tenableInspectPort(): Promise<boolean>;\n\tdispose(): void;\n}\n\nexport class ExtensionHostExtensions {\n\n\tprivate _allExtensions: IExtensionDescription[];\n\tprivate _myExtensions: ExtensionIdentifier[];\n\n\tconstructor() {\n\t\tthis._allExtensions = [];\n\t\tthis._myExtensions = [];\n\t}\n\n\tpublic toDelta(): IExtensionDescriptionDelta {\n\t\treturn {\n\t\t\ttoRemove: [],\n\t\t\ttoAdd: this._allExtensions,\n\t\t\tmyToRemove: [],\n\t\t\tmyToAdd: this._myExtensions\n\t\t};\n\t}\n\n\tpublic set(allExtensions: IExtensionDescription[], myExtensions: ExtensionIdentifier[]): IExtensionDescriptionDelta {\n\t\tconst toRemove: ExtensionIdentifier[] = [];\n\t\tconst toAdd: IExtensionDescription[] = [];\n\t\tconst myToRemove: ExtensionIdentifier[] = [];\n\t\tconst myToAdd: ExtensionIdentifier[] = [];\n\n\t\tconst oldExtensionsMap = extensionDescriptionArrayToMap(this._allExtensions);\n\t\tconst newExtensionsMap = extensionDescriptionArrayToMap(allExtensions);\n\t\tconst extensionsAreTheSame = (a: IExtensionDescription, b: IExtensionDescription) => {\n\t\t\treturn (\n\t\t\t\t(a.extensionLocation.toString() === b.extensionLocation.toString())\n\t\t\t\t|| (a.isBuiltin === b.isBuiltin)\n\t\t\t\t|| (a.isUserBuiltin === b.isUserBuiltin)\n\t\t\t\t|| (a.isUnderDevelopment === b.isUnderDevelopment)\n\t\t\t);\n\t\t};\n\n\t\tfor (const oldExtension of this._allExtensions) {\n\t\t\tconst newExtension = newExtensionsMap.get(ExtensionIdentifier.toKey(oldExtension.identifier));\n\t\t\tif (!newExtension) {\n\t\t\t\ttoRemove.push(oldExtension.identifier);\n\t\t\t\toldExtensionsMap.delete(ExtensionIdentifier.toKey(oldExtension.identifier));\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (!extensionsAreTheSame(oldExtension, newExtension)) {\n\t\t\t\t// The new extension is different than the old one\n\t\t\t\t// (e.g. maybe it executes in a different location)\n\t\t\t\ttoRemove.push(oldExtension.identifier);\n\t\t\t\toldExtensionsMap.delete(ExtensionIdentifier.toKey(oldExtension.identifier));\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\tfor (const newExtension of allExtensions) {\n\t\t\tconst oldExtension = oldExtensionsMap.get(ExtensionIdentifier.toKey(newExtension.identifier));\n\t\t\tif (!oldExtension) {\n\t\t\t\ttoAdd.push(newExtension);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (!extensionsAreTheSame(oldExtension, newExtension)) {\n\t\t\t\t// The new extension is different than the old one\n\t\t\t\t// (e.g. maybe it executes in a different location)\n\t\t\t\ttoRemove.push(oldExtension.identifier);\n\t\t\t\toldExtensionsMap.delete(ExtensionIdentifier.toKey(oldExtension.identifier));\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\tconst myOldExtensionsSet = extensionIdentifiersArrayToSet(this._myExtensions);\n\t\tconst myNewExtensionsSet = extensionIdentifiersArrayToSet(myExtensions);\n\t\tfor (const oldExtensionId of this._myExtensions) {\n\t\t\tif (!myNewExtensionsSet.has(ExtensionIdentifier.toKey(oldExtensionId))) {\n\t\t\t\tmyToRemove.push(oldExtensionId);\n\t\t\t}\n\t\t}\n\t\tfor (const newExtensionId of myExtensions) {\n\t\t\tif (!myOldExtensionsSet.has(ExtensionIdentifier.toKey(newExtensionId))) {\n\t\t\t\tmyToAdd.push(newExtensionId);\n\t\t\t}\n\t\t}\n\n\t\tconst delta = { toRemove, toAdd, myToRemove, myToAdd };\n\t\tthis.delta(delta);\n\t\treturn delta;\n\t}\n\n\tpublic delta(extensionsDelta: IExtensionDescriptionDelta): void {\n\t\tconst { toRemove, toAdd, myToRemove, myToAdd } = extensionsDelta;\n\t\t// First handle removals\n\t\tconst toRemoveSet = extensionIdentifiersArrayToSet(toRemove);\n\t\tconst myToRemoveSet = extensionIdentifiersArrayToSet(myToRemove);\n\t\tfor (let i = 0; i < this._allExtensions.length; i++) {\n\t\t\tif (toRemoveSet.has(ExtensionIdentifier.toKey(this._allExtensions[i].identifier))) {\n\t\t\t\tthis._allExtensions.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t\tfor (let i = 0; i < this._myExtensions.length; i++) {\n\t\t\tif (myToRemoveSet.has(ExtensionIdentifier.toKey(this._myExtensions[i]))) {\n\t\t\t\tthis._myExtensions.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t\t// Then handle additions\n\t\tfor (const extension of toAdd) {\n\t\t\tthis._allExtensions.push(extension);\n\t\t}\n\t\tfor (const extensionId of myToAdd) {\n\t\t\tthis._myExtensions.push(extensionId);\n\t\t}\n\t}\n\n\tpublic containsExtension(extensionId: ExtensionIdentifier): boolean {\n\t\tfor (const myExtensionId of this._myExtensions) {\n\t\t\tif (ExtensionIdentifier.equals(myExtensionId, extensionId)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n\nexport class ExtensionIdentifierSet implements Set<ExtensionIdentifier> {\n\n\treadonly [Symbol.toStringTag]: string = 'ExtensionIdentifierSet';\n\n\tprivate readonly _map = new Map<string, ExtensionIdentifier>();\n\tprivate readonly _toKey = ExtensionIdentifier.toKey;\n\n\tconstructor(values?: Iterable<ExtensionIdentifier>) {\n\t\tif (values) {\n\t\t\tfor (const value of values) {\n\t\t\t\tthis.add(value);\n\t\t\t}\n\t\t}\n\t}\n\n\tget size(): number {\n\t\treturn this._map.size;\n\t}\n\n\tadd(value: ExtensionIdentifier): this {\n\t\tthis._map.set(this._toKey(value), value);\n\t\treturn this;\n\t}\n\n\tclear(): void {\n\t\tthis._map.clear();\n\t}\n\n\tdelete(value: ExtensionIdentifier): boolean {\n\t\treturn this._map.delete(this._toKey(value));\n\t}\n\n\thas(value: ExtensionIdentifier): boolean {\n\t\treturn this._map.has(this._toKey(value));\n\t}\n\n\tforEach(callbackfn: (value: ExtensionIdentifier, value2: ExtensionIdentifier, set: Set<ExtensionIdentifier>) => void, thisArg?: any): void {\n\t\tthis._map.forEach(value => callbackfn.call(thisArg, value, value, this));\n\t}\n\n\t*entries(): IterableIterator<[ExtensionIdentifier, ExtensionIdentifier]> {\n\t\tfor (const [_key, value] of this._map) {\n\t\t\tyield [value, value];\n\t\t}\n\t}\n\n\tkeys(): IterableIterator<ExtensionIdentifier> {\n\t\treturn this._map.values();\n\t}\n\n\tvalues(): IterableIterator<ExtensionIdentifier> {\n\t\treturn this._map.values();\n\t}\n\n\t[Symbol.iterator](): IterableIterator<ExtensionIdentifier> {\n\t\treturn this._map.values();\n\t}\n}\n\nexport function extensionIdentifiersArrayToSet(extensionIds: ExtensionIdentifier[]): Set<string> {\n\tconst result = new Set<string>();\n\tfor (const extensionId of extensionIds) {\n\t\tresult.add(ExtensionIdentifier.toKey(extensionId));\n\t}\n\treturn result;\n}\n\nfunction extensionDescriptionArrayToMap(extensions: IExtensionDescription[]): Map<string, IExtensionDescription> {\n\tconst result = new Map<string, IExtensionDescription>();\n\tfor (const extension of extensions) {\n\t\tresult.set(ExtensionIdentifier.toKey(extension.identifier), extension);\n\t}\n\treturn result;\n}\n\nexport function isProposedApiEnabled(extension: IExtensionDescription, proposal: ApiProposalName): boolean {\n\tif (!extension.enabledApiProposals) {\n\t\treturn false;\n\t}\n\treturn extension.enabledApiProposals.includes(proposal);\n}\n\nexport function checkProposedApiEnabled(extension: IExtensionDescription, proposal: ApiProposalName): void {\n\tif (!isProposedApiEnabled(extension, proposal)) {\n\t\tthrow new Error(`Extension '${extension.identifier.value}' CANNOT use API proposal: ${proposal}.\\nIts package.json#enabledApiProposals-property declares: ${extension.enabledApiProposals?.join(', ') ?? '[]'} but NOT ${proposal}.\\n The missing proposal MUST be added and you must start in extension development mode or use the following command line switch: --enable-proposed-api ${extension.identifier.value}`);\n\t}\n}\n\n\n/**\n * Extension id or one of the four known program states.\n */\nexport type ProfileSegmentId = string | 'idle' | 'program' | 'gc' | 'self';\n\nexport interface ExtensionActivationReason {\n\treadonly startup: boolean;\n\treadonly extensionId: ExtensionIdentifier;\n\treadonly activationEvent: string;\n}\n\nexport class ActivationTimes {\n\tconstructor(\n\t\tpublic readonly codeLoadingTime: number,\n\t\tpublic readonly activateCallTime: number,\n\t\tpublic readonly activateResolvedTime: number,\n\t\tpublic readonly activationReason: ExtensionActivationReason\n\t) {\n\t}\n}\n\nexport class ExtensionPointContribution<T> {\n\treadonly description: IExtensionDescription;\n\treadonly value: T;\n\n\tconstructor(description: IExtensionDescription, value: T) {\n\t\tthis.description = description;\n\t\tthis.value = value;\n\t}\n}\n\nexport const ExtensionHostLogFileName = 'exthost';\n\nexport interface IWillActivateEvent {\n\treadonly event: string;\n\treadonly activation: Promise<void>;\n}\n\nexport interface IResponsiveStateChangeEvent {\n\textensionHostId: string;\n\textensionHostKind: ExtensionHostKind;\n\tisResponsive: boolean;\n}\n\nexport const enum ActivationKind {\n\tNormal = 0,\n\tImmediate = 1\n}\n\nexport interface IExtensionService {\n\treadonly _serviceBrand: undefined;\n\n\t/**\n\t * An event emitted when extensions are registered after their extension points got handled.\n\t *\n\t * This event will also fire on startup to signal the installed extensions.\n\t *\n\t * @returns the extensions that got registered\n\t */\n\tonDidRegisterExtensions: Event<void>;\n\n\t/**\n\t * @event\n\t * Fired when extensions status changes.\n\t * The event contains the ids of the extensions that have changed.\n\t */\n\tonDidChangeExtensionsStatus: Event<ExtensionIdentifier[]>;\n\n\t/**\n\t * Fired when the available extensions change (i.e. when extensions are added or removed).\n\t */\n\tonDidChangeExtensions: Event<void>;\n\n\t/**\n\t * An event that is fired when activation happens.\n\t */\n\tonWillActivateByEvent: Event<IWillActivateEvent>;\n\n\t/**\n\t * An event that is fired when an extension host changes its\n\t * responsive-state.\n\t */\n\tonDidChangeResponsiveChange: Event<IResponsiveStateChangeEvent>;\n\n\t/**\n\t * Send an activation event and activate interested extensions.\n\t *\n\t * This will wait for the normal startup of the extension host(s).\n\t *\n\t * In extraordinary circumstances, if the activation event needs to activate\n\t * one or more extensions before the normal startup is finished, then you can use\n\t * `ActivationKind.Immediate`. Please do not use this flag unless really necessary\n\t * and you understand all consequences.\n\t */\n\tactivateByEvent(activationEvent: string, activationKind?: ActivationKind): Promise<void>;\n\n\t/**\n\t * Determine if `activateByEvent(activationEvent)` has resolved already.\n\t *\n\t * i.e. the activation event is finished and all interested extensions are already active.\n\t */\n\tactivationEventIsDone(activationEvent: string): boolean;\n\n\t/**\n\t * An promise that resolves when the installed extensions are registered after\n\t * their extension points got handled.\n\t */\n\twhenInstalledExtensionsRegistered(): Promise<boolean>;\n\n\t/**\n\t * Return all registered extensions\n\t */\n\tgetExtensions(): Promise<IExtensionDescription[]>;\n\n\t/**\n\t * Return a specific extension\n\t * @param id An extension id\n\t */\n\tgetExtension(id: string): Promise<IExtensionDescription | undefined>;\n\n\t/**\n\t * Returns `true` if the given extension can be added. Otherwise `false`.\n\t * @param extension An extension\n\t */\n\tcanAddExtension(extension: IExtensionDescription): boolean;\n\n\t/**\n\t * Returns `true` if the given extension can be removed. Otherwise `false`.\n\t * @param extension An extension\n\t */\n\tcanRemoveExtension(extension: IExtensionDescription): boolean;\n\n\t/**\n\t * Read all contributions to an extension point.\n\t */\n\treadExtensionPointContributions<T extends IExtensionContributions[keyof IExtensionContributions]>(extPoint: IExtensionPoint<T>): Promise<ExtensionPointContribution<T>[]>;\n\n\t/**\n\t * Get information about extensions status.\n\t */\n\tgetExtensionsStatus(): { [id: string]: IExtensionsStatus };\n\n\t/**\n\t * Return the inspect port or `0` for a certain extension host.\n\t * `0` means inspection is not possible.\n\t */\n\tgetInspectPort(extensionHostId: string, tryEnableInspector: boolean): Promise<number>;\n\n\t/**\n\t * Return the inspect ports (if inspection is possible) for extension hosts of kind `extensionHostKind`.\n\t */\n\tgetInspectPorts(extensionHostKind: ExtensionHostKind, tryEnableInspector: boolean): Promise<number[]>;\n\n\t/**\n\t * Stops the extension hosts.\n\t */\n\tstopExtensionHosts(): void;\n\n\t/**\n\t * Restarts the extension host.\n\t */\n\trestartExtensionHost(): Promise<void>;\n\n\t/**\n\t * Starts the extension hosts.\n\t */\n\tstartExtensionHosts(): Promise<void>;\n\n\t/**\n\t * Modify the environment of the remote extension host\n\t * @param env New properties for the remote extension host\n\t */\n\tsetRemoteEnvironment(env: { [key: string]: string | null }): Promise<void>;\n\n\t/**\n\t * Please do not use!\n\t * (This is public such that the extension host process can coordinate with and call back in the IExtensionService)\n\t */\n\t_activateById(extensionId: ExtensionIdentifier, reason: ExtensionActivationReason): Promise<void>;\n}\n\nexport interface IInternalExtensionService {\n\t_activateById(extensionId: ExtensionIdentifier, reason: ExtensionActivationReason): Promise<void>;\n\t_onWillActivateExtension(extensionId: ExtensionIdentifier): void;\n\t_onDidActivateExtension(extensionId: ExtensionIdentifier, codeLoadingTime: number, activateCallTime: number, activateResolvedTime: number, activationReason: ExtensionActivationReason): void;\n\t_onDidActivateExtensionError(extensionId: ExtensionIdentifier, error: Error): void;\n\t_onExtensionRuntimeError(extensionId: ExtensionIdentifier, err: Error): void;\n}\n\nexport interface ProfileSession {\n\tstop(): Promise<IExtensionHostProfile>;\n}\n\nexport function toExtension(extensionDescription: IExtensionDescription): IExtension {\n\treturn {\n\t\ttype: extensionDescription.isBuiltin ? ExtensionType.System : ExtensionType.User,\n\t\tisBuiltin: extensionDescription.isBuiltin || extensionDescription.isUserBuiltin,\n\t\tidentifier: { id: getGalleryExtensionId(extensionDescription.publisher, extensionDescription.name), uuid: extensionDescription.uuid },\n\t\tmanifest: extensionDescription,\n\t\tlocation: extensionDescription.extensionLocation,\n\t\ttargetPlatform: extensionDescription.targetPlatform,\n\t\tvalidations: [],\n\t\tisValid: true\n\t};\n}\n\nexport function toExtensionDescription(extension: IExtension, isUnderDevelopment?: boolean): IExtensionDescription {\n\treturn {\n\t\tidentifier: new ExtensionIdentifier(getExtensionId(extension.manifest.publisher, extension.manifest.name)),\n\t\tisBuiltin: extension.type === ExtensionType.System,\n\t\tisUserBuiltin: extension.type === ExtensionType.User && extension.isBuiltin,\n\t\tisUnderDevelopment: !!isUnderDevelopment,\n\t\textensionLocation: extension.location,\n\t\t...extension.manifest,\n\t\tuuid: extension.identifier.uuid,\n\t\ttargetPlatform: extension.targetPlatform\n\t};\n}\n\n\nexport class NullExtensionService implements IExtensionService {\n\tdeclare readonly _serviceBrand: undefined;\n\tonDidRegisterExtensions: Event<void> = Event.None;\n\tonDidChangeExtensionsStatus: Event<ExtensionIdentifier[]> = Event.None;\n\tonDidChangeExtensions: Event<void> = Event.None;\n\tonWillActivateByEvent: Event<IWillActivateEvent> = Event.None;\n\tonDidChangeResponsiveChange: Event<IResponsiveStateChangeEvent> = Event.None;\n\tactivateByEvent(_activationEvent: string): Promise<void> { return Promise.resolve(undefined); }\n\tactivationEventIsDone(_activationEvent: string): boolean { return false; }\n\twhenInstalledExtensionsRegistered(): Promise<boolean> { return Promise.resolve(true); }\n\tgetExtensions(): Promise<IExtensionDescription[]> { return Promise.resolve([]); }\n\tgetExtension() { return Promise.resolve(undefined); }\n\treadExtensionPointContributions<T>(_extPoint: IExtensionPoint<T>): Promise<ExtensionPointContribution<T>[]> { return Promise.resolve(Object.create(null)); }\n\tgetExtensionsStatus(): { [id: string]: IExtensionsStatus } { return Object.create(null); }\n\tgetInspectPort(_extensionHostId: string, _tryEnableInspector: boolean): Promise<number> { return Promise.resolve(0); }\n\tgetInspectPorts(_extensionHostKind: ExtensionHostKind, _tryEnableInspector: boolean): Promise<number[]> { return Promise.resolve([]); }\n\tstopExtensionHosts(): void { }\n\tasync restartExtensionHost(): Promise<void> { }\n\tasync startExtensionHosts(): Promise<void> { }\n\tasync setRemoteEnvironment(_env: { [key: string]: string | null }): Promise<void> { }\n\tcanAddExtension(): boolean { return false; }\n\tcanRemoveExtension(): boolean { return false; }\n\t_activateById(_extensionId: ExtensionIdentifier, _reason: ExtensionActivationReason): Promise<void> { return Promise.resolve(); }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type * as vscode from 'vscode';\nimport * as errors from 'vs/base/common/errors';\nimport { IDisposable } from 'vs/base/common/lifecycle';\nimport { ExtensionDescriptionRegistry } from 'vs/workbench/services/extensions/common/extensionDescriptionRegistry';\nimport { ExtensionIdentifier } from 'vs/platform/extensions/common/extensions';\nimport { ExtensionActivationReason, MissingExtensionDependency } from 'vs/workbench/services/extensions/common/extensions';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { Barrier } from 'vs/base/common/async';\n\n/**\n * Represents the source code (module) of an extension.\n */\nexport interface IExtensionModule {\n\tactivate?(ctx: vscode.ExtensionContext): Promise<IExtensionAPI>;\n\tdeactivate?(): void;\n}\n\n/**\n * Represents the API of an extension (return value of `activate`).\n */\nexport interface IExtensionAPI {\n\t// _extensionAPIBrand: any;\n}\n\nexport type ExtensionActivationTimesFragment = {\n\tstartup?: { classification: 'SystemMetaData'; purpose: 'PerformanceAndHealth'; isMeasurement: true; comment: 'Activation occurred during startup' };\n\tcodeLoadingTime?: { classification: 'SystemMetaData'; purpose: 'PerformanceAndHealth'; isMeasurement: true; comment: 'Time it took to load the extension\\'s code' };\n\tactivateCallTime?: { classification: 'SystemMetaData'; purpose: 'PerformanceAndHealth'; isMeasurement: true; comment: 'Time it took to call activate' };\n\tactivateResolvedTime?: { classification: 'SystemMetaData'; purpose: 'PerformanceAndHealth'; isMeasurement: true; comment: 'Time it took for async-activation to finish' };\n};\n\nexport class ExtensionActivationTimes {\n\n\tpublic static readonly NONE = new ExtensionActivationTimes(false, -1, -1, -1);\n\n\tpublic readonly startup: boolean;\n\tpublic readonly codeLoadingTime: number;\n\tpublic readonly activateCallTime: number;\n\tpublic readonly activateResolvedTime: number;\n\n\tconstructor(startup: boolean, codeLoadingTime: number, activateCallTime: number, activateResolvedTime: number) {\n\t\tthis.startup = startup;\n\t\tthis.codeLoadingTime = codeLoadingTime;\n\t\tthis.activateCallTime = activateCallTime;\n\t\tthis.activateResolvedTime = activateResolvedTime;\n\t}\n}\n\nexport class ExtensionActivationTimesBuilder {\n\n\tprivate readonly _startup: boolean;\n\tprivate _codeLoadingStart: number;\n\tprivate _codeLoadingStop: number;\n\tprivate _activateCallStart: number;\n\tprivate _activateCallStop: number;\n\tprivate _activateResolveStart: number;\n\tprivate _activateResolveStop: number;\n\n\tconstructor(startup: boolean) {\n\t\tthis._startup = startup;\n\t\tthis._codeLoadingStart = -1;\n\t\tthis._codeLoadingStop = -1;\n\t\tthis._activateCallStart = -1;\n\t\tthis._activateCallStop = -1;\n\t\tthis._activateResolveStart = -1;\n\t\tthis._activateResolveStop = -1;\n\t}\n\n\tprivate _delta(start: number, stop: number): number {\n\t\tif (start === -1 || stop === -1) {\n\t\t\treturn -1;\n\t\t}\n\t\treturn stop - start;\n\t}\n\n\tpublic build(): ExtensionActivationTimes {\n\t\treturn new ExtensionActivationTimes(\n\t\t\tthis._startup,\n\t\t\tthis._delta(this._codeLoadingStart, this._codeLoadingStop),\n\t\t\tthis._delta(this._activateCallStart, this._activateCallStop),\n\t\t\tthis._delta(this._activateResolveStart, this._activateResolveStop)\n\t\t);\n\t}\n\n\tpublic codeLoadingStart(): void {\n\t\tthis._codeLoadingStart = Date.now();\n\t}\n\n\tpublic codeLoadingStop(): void {\n\t\tthis._codeLoadingStop = Date.now();\n\t}\n\n\tpublic activateCallStart(): void {\n\t\tthis._activateCallStart = Date.now();\n\t}\n\n\tpublic activateCallStop(): void {\n\t\tthis._activateCallStop = Date.now();\n\t}\n\n\tpublic activateResolveStart(): void {\n\t\tthis._activateResolveStart = Date.now();\n\t}\n\n\tpublic activateResolveStop(): void {\n\t\tthis._activateResolveStop = Date.now();\n\t}\n}\n\nexport class ActivatedExtension {\n\n\tpublic readonly activationFailed: boolean;\n\tpublic readonly activationFailedError: Error | null;\n\tpublic readonly activationTimes: ExtensionActivationTimes;\n\tpublic readonly module: IExtensionModule;\n\tpublic readonly exports: IExtensionAPI | undefined;\n\tpublic readonly subscriptions: IDisposable[];\n\n\tconstructor(\n\t\tactivationFailed: boolean,\n\t\tactivationFailedError: Error | null,\n\t\tactivationTimes: ExtensionActivationTimes,\n\t\tmodule: IExtensionModule,\n\t\texports: IExtensionAPI | undefined,\n\t\tsubscriptions: IDisposable[]\n\t) {\n\t\tthis.activationFailed = activationFailed;\n\t\tthis.activationFailedError = activationFailedError;\n\t\tthis.activationTimes = activationTimes;\n\t\tthis.module = module;\n\t\tthis.exports = exports;\n\t\tthis.subscriptions = subscriptions;\n\t}\n}\n\nexport class EmptyExtension extends ActivatedExtension {\n\tconstructor(activationTimes: ExtensionActivationTimes) {\n\t\tsuper(false, null, activationTimes, { activate: undefined, deactivate: undefined }, undefined, []);\n\t}\n}\n\nexport class HostExtension extends ActivatedExtension {\n\tconstructor() {\n\t\tsuper(false, null, ExtensionActivationTimes.NONE, { activate: undefined, deactivate: undefined }, undefined, []);\n\t}\n}\n\nexport class FailedExtension extends ActivatedExtension {\n\tconstructor(activationError: Error) {\n\t\tsuper(true, activationError, ExtensionActivationTimes.NONE, { activate: undefined, deactivate: undefined }, undefined, []);\n\t}\n}\n\nexport interface IExtensionsActivatorHost {\n\tonExtensionActivationError(extensionId: ExtensionIdentifier, error: Error | null, missingExtensionDependency: MissingExtensionDependency | null): void;\n\tactualActivateExtension(extensionId: ExtensionIdentifier, reason: ExtensionActivationReason): Promise<ActivatedExtension>;\n}\n\ntype ActivationIdAndReason = { id: ExtensionIdentifier; reason: ExtensionActivationReason };\n\nexport class ExtensionsActivator implements IDisposable {\n\n\tprivate readonly _registry: ExtensionDescriptionRegistry;\n\tprivate readonly _resolvedExtensionsSet: Set<string>;\n\tprivate readonly _externalExtensionsMap: Map<string, ExtensionIdentifier>;\n\tprivate readonly _host: IExtensionsActivatorHost;\n\tprivate readonly _operations: Map<string, ActivationOperation>;\n\t/**\n\t * A map of already activated events to speed things up if the same activation event is triggered multiple times.\n\t */\n\tprivate readonly _alreadyActivatedEvents: { [activationEvent: string]: boolean };\n\n\tconstructor(\n\t\tregistry: ExtensionDescriptionRegistry,\n\t\tresolvedExtensions: ExtensionIdentifier[],\n\t\texternalExtensions: ExtensionIdentifier[],\n\t\thost: IExtensionsActivatorHost,\n\t\t@ILogService private readonly _logService: ILogService\n\t) {\n\t\tthis._registry = registry;\n\t\tthis._resolvedExtensionsSet = new Set<string>();\n\t\tresolvedExtensions.forEach((extensionId) => this._resolvedExtensionsSet.add(ExtensionIdentifier.toKey(extensionId)));\n\t\tthis._externalExtensionsMap = new Map<string, ExtensionIdentifier>();\n\t\texternalExtensions.forEach((extensionId) => this._externalExtensionsMap.set(ExtensionIdentifier.toKey(extensionId), extensionId));\n\t\tthis._host = host;\n\t\tthis._operations = new Map<string, ActivationOperation>();\n\t\tthis._alreadyActivatedEvents = Object.create(null);\n\t}\n\n\tpublic dispose(): void {\n\t\tfor (const [_, op] of this._operations) {\n\t\t\top.dispose();\n\t\t}\n\t}\n\n\tpublic isActivated(extensionId: ExtensionIdentifier): boolean {\n\t\tconst op = this._operations.get(ExtensionIdentifier.toKey(extensionId));\n\t\treturn Boolean(op && op.value);\n\t}\n\n\tpublic getActivatedExtension(extensionId: ExtensionIdentifier): ActivatedExtension {\n\t\tconst op = this._operations.get(ExtensionIdentifier.toKey(extensionId));\n\t\tif (!op || !op.value) {\n\t\t\tthrow new Error(`Extension '${extensionId.value}' is not known or not activated`);\n\t\t}\n\t\treturn op.value;\n\t}\n\n\tpublic async activateByEvent(activationEvent: string, startup: boolean): Promise<void> {\n\t\tif (this._alreadyActivatedEvents[activationEvent]) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst activateExtensions = this._registry.getExtensionDescriptionsForActivationEvent(activationEvent);\n\t\tawait this._activateExtensions(activateExtensions.map(e => ({\n\t\t\tid: e.identifier,\n\t\t\treason: { startup, extensionId: e.identifier, activationEvent }\n\t\t})));\n\n\t\tthis._alreadyActivatedEvents[activationEvent] = true;\n\t}\n\n\tpublic activateById(extensionId: ExtensionIdentifier, reason: ExtensionActivationReason): Promise<void> {\n\t\tconst desc = this._registry.getExtensionDescription(extensionId);\n\t\tif (!desc) {\n\t\t\tthrow new Error(`Extension '${extensionId}' is not known`);\n\t\t}\n\t\treturn this._activateExtensions([{ id: desc.identifier, reason }]);\n\t}\n\n\tprivate async _activateExtensions(extensions: ActivationIdAndReason[]): Promise<void> {\n\t\tconst operations = extensions\n\t\t\t.filter((p) => !this.isActivated(p.id))\n\t\t\t.map(ext => this._handleActivationRequest(ext));\n\t\tawait Promise.all(operations.map(op => op.wait()));\n\t}\n\n\t/**\n\t * Handle semantics related to dependencies for `currentExtension`.\n\t * We don't need to worry about dependency loops because they are handled by the registry.\n\t */\n\tprivate _handleActivationRequest(currentActivation: ActivationIdAndReason): ActivationOperation {\n\t\tif (this._operations.has(ExtensionIdentifier.toKey(currentActivation.id))) {\n\t\t\treturn this._operations.get(ExtensionIdentifier.toKey(currentActivation.id))!;\n\t\t}\n\n\t\tif (this._externalExtensionsMap.has(ExtensionIdentifier.toKey(currentActivation.id))) {\n\t\t\treturn this._createAndSaveOperation(currentActivation, null, [], null);\n\t\t}\n\n\t\tconst currentExtension = this._registry.getExtensionDescription(currentActivation.id);\n\t\tif (!currentExtension) {\n\t\t\t// Error condition 0: unknown extension\n\t\t\tconst error = new Error(`Cannot activate unknown extension '${currentActivation.id.value}'`);\n\t\t\tconst result = this._createAndSaveOperation(currentActivation, null, [], new FailedExtension(error));\n\t\t\tthis._host.onExtensionActivationError(\n\t\t\t\tcurrentActivation.id,\n\t\t\t\terror,\n\t\t\t\tnew MissingExtensionDependency(currentActivation.id.value)\n\t\t\t);\n\t\t\treturn result;\n\t\t}\n\n\t\tconst deps: ActivationOperation[] = [];\n\t\tconst depIds = (typeof currentExtension.extensionDependencies === 'undefined' ? [] : currentExtension.extensionDependencies);\n\t\tfor (const depId of depIds) {\n\n\t\t\tif (this._resolvedExtensionsSet.has(ExtensionIdentifier.toKey(depId))) {\n\t\t\t\t// This dependency is already resolved\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst dep = this._operations.get(ExtensionIdentifier.toKey(depId));\n\t\t\tif (dep) {\n\t\t\t\tdeps.push(dep);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (this._externalExtensionsMap.has(ExtensionIdentifier.toKey(depId))) {\n\t\t\t\t// must first wait for the dependency to activate\n\t\t\t\tdeps.push(this._handleActivationRequest({\n\t\t\t\t\tid: this._externalExtensionsMap.get(ExtensionIdentifier.toKey(depId))!,\n\t\t\t\t\treason: currentActivation.reason\n\t\t\t\t}));\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst depDesc = this._registry.getExtensionDescription(depId);\n\t\t\tif (depDesc) {\n\t\t\t\tif (!depDesc.main && !depDesc.browser) {\n\t\t\t\t\t// this dependency does not need to activate because it is descriptive only\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// must first wait for the dependency to activate\n\t\t\t\tdeps.push(this._handleActivationRequest({\n\t\t\t\t\tid: depDesc.identifier,\n\t\t\t\t\treason: currentActivation.reason\n\t\t\t\t}));\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Error condition 1: unknown dependency\n\t\t\tconst currentExtensionFriendlyName = currentExtension.displayName || currentExtension.identifier.value;\n\t\t\tconst error = new Error(`Cannot activate the '${currentExtensionFriendlyName}' extension because it depends on unknown extension '${depId}'`);\n\t\t\tconst result = this._createAndSaveOperation(currentActivation, currentExtension.displayName, [], new FailedExtension(error));\n\t\t\tthis._host.onExtensionActivationError(\n\t\t\t\tcurrentExtension.identifier,\n\t\t\t\terror,\n\t\t\t\tnew MissingExtensionDependency(depId)\n\t\t\t);\n\t\t\treturn result;\n\t\t}\n\n\t\treturn this._createAndSaveOperation(currentActivation, currentExtension.displayName, deps, null);\n\t}\n\n\tprivate _createAndSaveOperation(activation: ActivationIdAndReason, displayName: string | null | undefined, deps: ActivationOperation[], value: ActivatedExtension | null): ActivationOperation {\n\t\tconst operation = new ActivationOperation(activation.id, displayName, activation.reason, deps, value, this._host, this._logService);\n\t\tthis._operations.set(ExtensionIdentifier.toKey(activation.id), operation);\n\t\treturn operation;\n\t}\n}\n\nclass ActivationOperation {\n\n\tprivate readonly _barrier = new Barrier();\n\tprivate _isDisposed = false;\n\n\tpublic get value(): ActivatedExtension | null {\n\t\treturn this._value;\n\t}\n\n\tpublic get friendlyName(): string {\n\t\treturn this._displayName || this._id.value;\n\t}\n\n\tconstructor(\n\t\tprivate readonly _id: ExtensionIdentifier,\n\t\tprivate readonly _displayName: string | null | undefined,\n\t\tprivate readonly _reason: ExtensionActivationReason,\n\t\tprivate readonly _deps: ActivationOperation[],\n\t\tprivate _value: ActivatedExtension | null,\n\t\tprivate readonly _host: IExtensionsActivatorHost,\n\t\t@ILogService private readonly _logService: ILogService\n\t) {\n\t\tthis._initialize();\n\t}\n\n\tpublic dispose(): void {\n\t\tthis._isDisposed = true;\n\t}\n\n\tpublic wait() {\n\t\treturn this._barrier.wait();\n\t}\n\n\tprivate async _initialize(): Promise<void> {\n\t\tawait this._waitForDepsThenActivate();\n\t\tthis._barrier.open();\n\t}\n\n\tprivate async _waitForDepsThenActivate(): Promise<void> {\n\t\tif (this._value) {\n\t\t\t// this operation is already finished\n\t\t\treturn;\n\t\t}\n\n\t\twhile (this._deps.length > 0) {\n\t\t\t// remove completed deps\n\t\t\tfor (let i = 0; i < this._deps.length; i++) {\n\t\t\t\tconst dep = this._deps[i];\n\n\t\t\t\tif (dep.value && !dep.value.activationFailed) {\n\t\t\t\t\t// the dependency is already activated OK\n\t\t\t\t\tthis._deps.splice(i, 1);\n\t\t\t\t\ti--;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (dep.value && dep.value.activationFailed) {\n\t\t\t\t\t// Error condition 2: a dependency has already failed activation\n\t\t\t\t\tconst error = new Error(`Cannot activate the '${this.friendlyName}' extension because its dependency '${dep.friendlyName}' failed to activate`);\n\t\t\t\t\t(<any>error).detail = dep.value.activationFailedError;\n\t\t\t\t\tthis._value = new FailedExtension(error);\n\t\t\t\t\tthis._host.onExtensionActivationError(this._id, error, null);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this._deps.length > 0) {\n\t\t\t\t// wait for one dependency\n\t\t\t\tawait Promise.race(this._deps.map(dep => dep.wait()));\n\t\t\t}\n\t\t}\n\n\t\tawait this._activate();\n\t}\n\n\tprivate async _activate(): Promise<void> {\n\t\ttry {\n\t\t\tthis._value = await this._host.actualActivateExtension(this._id, this._reason);\n\t\t} catch (err) {\n\n\t\t\tconst error = new Error();\n\t\t\tif (err && err.name) {\n\t\t\t\terror.name = err.name;\n\t\t\t}\n\t\t\tif (err && err.message) {\n\t\t\t\terror.message = `Activating extension '${this._id.value}' failed: ${err.message}.`;\n\t\t\t} else {\n\t\t\t\terror.message = `Activating extension '${this._id.value}' failed: ${err}.`;\n\t\t\t}\n\t\t\tif (err && err.stack) {\n\t\t\t\terror.stack = err.stack;\n\t\t\t}\n\n\t\t\t// Treat the extension as being empty\n\t\t\tthis._value = new FailedExtension(error);\n\n\t\t\tif (this._isDisposed && errors.isCancellationError(err)) {\n\t\t\t\t// It is expected for ongoing activations to fail if the extension host is going down\n\t\t\t\t// So simply ignore and don't log canceled errors in this case\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._host.onExtensionActivationError(this._id, error, null);\n\t\t\tthis._logService.error(`Activating extension ${this._id.value} failed due to an error:`);\n\t\t\tthis._logService.error(err);\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ILoggerService, LogService } from 'vs/platform/log/common/log';\nimport { IExtHostInitDataService } from 'vs/workbench/api/common/extHostInitDataService';\nimport { ExtensionHostLogFileName } from 'vs/workbench/services/extensions/common/extensions';\n\nexport class ExtHostLogService extends LogService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tconstructor(\n\t\t@ILoggerService loggerService: ILoggerService,\n\t\t@IExtHostInitDataService initData: IExtHostInitDataService,\n\t) {\n\t\tsuper(loggerService.createLogger(initData.logFile, { name: ExtensionHostLogFileName }));\n\t}\n\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n// THIS IS A GENERATED FILE. DO NOT EDIT DIRECTLY.\n\nexport const allApiProposals = Object.freeze({\n\tauthSession: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authSession.d.ts',\n\tbadges: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.badges.d.ts',\n\tcommentsResolvedState: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentsResolvedState.d.ts',\n\tcontribEditSessions: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditSessions.d.ts',\n\tcontribLabelFormatterWorkspaceTooltip: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribLabelFormatterWorkspaceTooltip.d.ts',\n\tcontribMenuBarHome: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMenuBarHome.d.ts',\n\tcontribMergeEditorToolbar: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMergeEditorToolbar.d.ts',\n\tcontribRemoteHelp: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribRemoteHelp.d.ts',\n\tcontribShareMenu: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribShareMenu.d.ts',\n\tcontribViewSize: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewSize.d.ts',\n\tcontribViewsRemote: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsRemote.d.ts',\n\tcontribViewsWelcome: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsWelcome.d.ts',\n\tcontribWebviewContext: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribWebviewContext.d.ts',\n\tcustomEditorMove: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.customEditorMove.d.ts',\n\tdiffCommand: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffCommand.d.ts',\n\tdocumentFiltersExclusive: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.documentFiltersExclusive.d.ts',\n\tdocumentPaste: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.documentPaste.d.ts',\n\teditorInsets: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorInsets.d.ts',\n\textensionRuntime: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionRuntime.d.ts',\n\textensionsAny: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionsAny.d.ts',\n\texternalUriOpener: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.externalUriOpener.d.ts',\n\tfileSearchProvider: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProvider.d.ts',\n\tfindTextInFiles: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFiles.d.ts',\n\tfsChunks: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fsChunks.d.ts',\n\tidToken: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.idToken.d.ts',\n\tinlineCompletionsAdditions: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineCompletionsAdditions.d.ts',\n\tinlineCompletionsNew: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineCompletionsNew.d.ts',\n\tinteractiveWindow: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactiveWindow.d.ts',\n\tipc: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.ipc.d.ts',\n\tnotebookCellExecutionState: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookCellExecutionState.d.ts',\n\tnotebookContentProvider: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookContentProvider.d.ts',\n\tnotebookControllerKind: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookControllerKind.d.ts',\n\tnotebookDebugOptions: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookDebugOptions.d.ts',\n\tnotebookDeprecated: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookDeprecated.d.ts',\n\tnotebookEditor: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookEditor.d.ts',\n\tnotebookEditorEdit: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookEditorEdit.d.ts',\n\tnotebookKernelSource: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookKernelSource.d.ts',\n\tnotebookLiveShare: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookLiveShare.d.ts',\n\tnotebookMessaging: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMessaging.d.ts',\n\tnotebookMime: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMime.d.ts',\n\tnotebookWorkspaceEdit: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookWorkspaceEdit.d.ts',\n\tportsAttributes: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.portsAttributes.d.ts',\n\tquickPickSortByLabel: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickSortByLabel.d.ts',\n\tresolvers: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.resolvers.d.ts',\n\tscmActionButton: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmActionButton.d.ts',\n\tscmSelectedProvider: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmSelectedProvider.d.ts',\n\tscmValidation: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmValidation.d.ts',\n\tsnippetWorkspaceEdit: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.snippetWorkspaceEdit.d.ts',\n\ttabInputTextMerge: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputTextMerge.d.ts',\n\ttaskPresentationGroup: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.taskPresentationGroup.d.ts',\n\ttelemetry: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.telemetry.d.ts',\n\tterminalDataWriteEvent: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDataWriteEvent.d.ts',\n\tterminalDimensions: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDimensions.d.ts',\n\tterminalExitReason: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalExitReason.d.ts',\n\ttestCoverage: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testCoverage.d.ts',\n\ttestObserver: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testObserver.d.ts',\n\ttextSearchProvider: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProvider.d.ts',\n\ttimeline: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.timeline.d.ts',\n\ttokenInformation: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tokenInformation.d.ts',\n\ttreeViewReveal: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewReveal.d.ts',\n\tworkspaceTrust: 'https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.workspaceTrust.d.ts'\n});\nexport type ApiProposalName = keyof typeof allApiProposals;\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from 'vs/nls';\nimport { onUnexpectedError } from 'vs/base/common/errors';\nimport { IJSONSchema } from 'vs/base/common/jsonSchema';\nimport Severity from 'vs/base/common/severity';\nimport { EXTENSION_IDENTIFIER_PATTERN } from 'vs/platform/extensionManagement/common/extensionManagement';\nimport { Extensions, IJSONContributionRegistry } from 'vs/platform/jsonschemas/common/jsonContributionRegistry';\nimport { Registry } from 'vs/platform/registry/common/platform';\nimport { IMessage } from 'vs/workbench/services/extensions/common/extensions';\nimport { ExtensionIdentifier, IExtensionDescription, EXTENSION_CATEGORIES } from 'vs/platform/extensions/common/extensions';\nimport { ExtensionKind } from 'vs/platform/environment/common/environment';\nimport { allApiProposals } from 'vs/workbench/services/extensions/common/extensionsApiProposals';\nimport { productSchemaId } from 'vs/platform/product/common/productService';\n\nconst schemaRegistry = Registry.as<IJSONContributionRegistry>(Extensions.JSONContribution);\n\nexport class ExtensionMessageCollector {\n\n\tprivate readonly _messageHandler: (msg: IMessage) => void;\n\tprivate readonly _extension: IExtensionDescription;\n\tprivate readonly _extensionPointId: string;\n\n\tconstructor(\n\t\tmessageHandler: (msg: IMessage) => void,\n\t\textension: IExtensionDescription,\n\t\textensionPointId: string\n\t) {\n\t\tthis._messageHandler = messageHandler;\n\t\tthis._extension = extension;\n\t\tthis._extensionPointId = extensionPointId;\n\t}\n\n\tprivate _msg(type: Severity, message: string): void {\n\t\tthis._messageHandler({\n\t\t\ttype: type,\n\t\t\tmessage: message,\n\t\t\textensionId: this._extension.identifier,\n\t\t\textensionPointId: this._extensionPointId\n\t\t});\n\t}\n\n\tpublic error(message: string): void {\n\t\tthis._msg(Severity.Error, message);\n\t}\n\n\tpublic warn(message: string): void {\n\t\tthis._msg(Severity.Warning, message);\n\t}\n\n\tpublic info(message: string): void {\n\t\tthis._msg(Severity.Info, message);\n\t}\n}\n\nexport interface IExtensionPointUser<T> {\n\tdescription: IExtensionDescription;\n\tvalue: T;\n\tcollector: ExtensionMessageCollector;\n}\n\nexport type IExtensionPointHandler<T> = (extensions: readonly IExtensionPointUser<T>[], delta: ExtensionPointUserDelta<T>) => void;\n\nexport interface IExtensionPoint<T> {\n\treadonly name: string;\n\tsetHandler(handler: IExtensionPointHandler<T>): void;\n\treadonly defaultExtensionKind: ExtensionKind[] | undefined;\n}\n\nexport class ExtensionPointUserDelta<T> {\n\n\tprivate static _toSet<T>(arr: readonly IExtensionPointUser<T>[]): Set<string> {\n\t\tconst result = new Set<string>();\n\t\tfor (let i = 0, len = arr.length; i < len; i++) {\n\t\t\tresult.add(ExtensionIdentifier.toKey(arr[i].description.identifier));\n\t\t}\n\t\treturn result;\n\t}\n\n\tpublic static compute<T>(previous: readonly IExtensionPointUser<T>[] | null, current: readonly IExtensionPointUser<T>[]): ExtensionPointUserDelta<T> {\n\t\tif (!previous || !previous.length) {\n\t\t\treturn new ExtensionPointUserDelta<T>(current, []);\n\t\t}\n\t\tif (!current || !current.length) {\n\t\t\treturn new ExtensionPointUserDelta<T>([], previous);\n\t\t}\n\n\t\tconst previousSet = this._toSet(previous);\n\t\tconst currentSet = this._toSet(current);\n\n\t\tconst added = current.filter(user => !previousSet.has(ExtensionIdentifier.toKey(user.description.identifier)));\n\t\tconst removed = previous.filter(user => !currentSet.has(ExtensionIdentifier.toKey(user.description.identifier)));\n\n\t\treturn new ExtensionPointUserDelta<T>(added, removed);\n\t}\n\n\tconstructor(\n\t\tpublic readonly added: readonly IExtensionPointUser<T>[],\n\t\tpublic readonly removed: readonly IExtensionPointUser<T>[],\n\t) { }\n}\n\nexport class ExtensionPoint<T> implements IExtensionPoint<T> {\n\n\tpublic readonly name: string;\n\tpublic readonly defaultExtensionKind: ExtensionKind[] | undefined;\n\n\tprivate _handler: IExtensionPointHandler<T> | null;\n\tprivate _users: IExtensionPointUser<T>[] | null;\n\tprivate _delta: ExtensionPointUserDelta<T> | null;\n\n\tconstructor(name: string, defaultExtensionKind: ExtensionKind[] | undefined) {\n\t\tthis.name = name;\n\t\tthis.defaultExtensionKind = defaultExtensionKind;\n\t\tthis._handler = null;\n\t\tthis._users = null;\n\t\tthis._delta = null;\n\t}\n\n\tsetHandler(handler: IExtensionPointHandler<T>): void {\n\t\tif (this._handler !== null) {\n\t\t\tthrow new Error('Handler already set!');\n\t\t}\n\t\tthis._handler = handler;\n\t\tthis._handle();\n\t}\n\n\tacceptUsers(users: IExtensionPointUser<T>[]): void {\n\t\tthis._delta = ExtensionPointUserDelta.compute(this._users, users);\n\t\tthis._users = users;\n\t\tthis._handle();\n\t}\n\n\tprivate _handle(): void {\n\t\tif (this._handler === null || this._users === null || this._delta === null) {\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tthis._handler(this._users, this._delta);\n\t\t} catch (err) {\n\t\t\tonUnexpectedError(err);\n\t\t}\n\t}\n}\n\nconst extensionKindSchema: IJSONSchema = {\n\ttype: 'string',\n\tenum: [\n\t\t'ui',\n\t\t'workspace'\n\t],\n\tenumDescriptions: [\n\t\tnls.localize('ui', \"UI extension kind. In a remote window, such extensions are enabled only when available on the local machine.\"),\n\t\tnls.localize('workspace', \"Workspace extension kind. In a remote window, such extensions are enabled only when available on the remote.\"),\n\t],\n};\n\nconst schemaId = 'vscode://schemas/vscode-extensions';\nexport const schema: IJSONSchema = {\n\tproperties: {\n\t\tengines: {\n\t\t\ttype: 'object',\n\t\t\tdescription: nls.localize('vscode.extension.engines', \"Engine compatibility.\"),\n\t\t\tproperties: {\n\t\t\t\t'vscode': {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tdescription: nls.localize('vscode.extension.engines.vscode', 'For VS Code extensions, specifies the VS Code version that the extension is compatible with. Cannot be *. For example: ^0.10.5 indicates compatibility with a minimum VS Code version of 0.10.5.'),\n\t\t\t\t\tdefault: '^1.22.0',\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tpublisher: {\n\t\t\tdescription: nls.localize('vscode.extension.publisher', 'The publisher of the VS Code extension.'),\n\t\t\ttype: 'string'\n\t\t},\n\t\tdisplayName: {\n\t\t\tdescription: nls.localize('vscode.extension.displayName', 'The display name for the extension used in the VS Code gallery.'),\n\t\t\ttype: 'string'\n\t\t},\n\t\tcategories: {\n\t\t\tdescription: nls.localize('vscode.extension.categories', 'The categories used by the VS Code gallery to categorize the extension.'),\n\t\t\ttype: 'array',\n\t\t\tuniqueItems: true,\n\t\t\titems: {\n\t\t\t\toneOf: [{\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tenum: EXTENSION_CATEGORIES,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tconst: 'Languages',\n\t\t\t\t\tdeprecationMessage: nls.localize('vscode.extension.category.languages.deprecated', 'Use \\'Programming  Languages\\' instead'),\n\t\t\t\t}]\n\t\t\t}\n\t\t},\n\t\tgalleryBanner: {\n\t\t\ttype: 'object',\n\t\t\tdescription: nls.localize('vscode.extension.galleryBanner', 'Banner used in the VS Code marketplace.'),\n\t\t\tproperties: {\n\t\t\t\tcolor: {\n\t\t\t\t\tdescription: nls.localize('vscode.extension.galleryBanner.color', 'The banner color on the VS Code marketplace page header.'),\n\t\t\t\t\ttype: 'string'\n\t\t\t\t},\n\t\t\t\ttheme: {\n\t\t\t\t\tdescription: nls.localize('vscode.extension.galleryBanner.theme', 'The color theme for the font used in the banner.'),\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tenum: ['dark', 'light']\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tcontributes: {\n\t\t\tdescription: nls.localize('vscode.extension.contributes', 'All contributions of the VS Code extension represented by this package.'),\n\t\t\ttype: 'object',\n\t\t\tproperties: {\n\t\t\t\t// extensions will fill in\n\t\t\t} as { [key: string]: any },\n\t\t\tdefault: {}\n\t\t},\n\t\tpreview: {\n\t\t\ttype: 'boolean',\n\t\t\tdescription: nls.localize('vscode.extension.preview', 'Sets the extension to be flagged as a Preview in the Marketplace.'),\n\t\t},\n\t\tenableProposedApi: {\n\t\t\ttype: 'boolean',\n\t\t\tdeprecationMessage: nls.localize('vscode.extension.enableProposedApi.deprecated', 'Use `enabledApiProposals` instead.'),\n\t\t},\n\t\tenabledApiProposals: {\n\t\t\tmarkdownDescription: nls.localize('vscode.extension.enabledApiProposals', 'Enable API proposals to try them out. Only valid **during development**. Extensions **cannot be published** with this property. For more details visit: https://code.visualstudio.com/api/advanced-topics/using-proposed-api'),\n\t\t\ttype: 'array',\n\t\t\tuniqueItems: true,\n\t\t\titems: {\n\t\t\t\ttype: 'string',\n\t\t\t\tenum: Object.keys(allApiProposals),\n\t\t\t\tmarkdownEnumDescriptions: Object.values(allApiProposals)\n\t\t\t}\n\t\t},\n\t\tactivationEvents: {\n\t\t\tdescription: nls.localize('vscode.extension.activationEvents', 'Activation events for the VS Code extension.'),\n\t\t\ttype: 'array',\n\t\t\titems: {\n\t\t\t\ttype: 'string',\n\t\t\t\tdefaultSnippets: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'onWebviewPanel',\n\t\t\t\t\t\tdescription: nls.localize('vscode.extension.activationEvents.onWebviewPanel', 'An activation event emmited when a webview is loaded of a certain viewType'),\n\t\t\t\t\t\tbody: 'onWebviewPanel:viewType'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'onLanguage',\n\t\t\t\t\t\tdescription: nls.localize('vscode.extension.activationEvents.onLanguage', 'An activation event emitted whenever a file that resolves to the specified language gets opened.'),\n\t\t\t\t\t\tbody: 'onLanguage:${1:languageId}'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'onCommand',\n\t\t\t\t\t\tdescription: nls.localize('vscode.extension.activationEvents.onCommand', 'An activation event emitted whenever the specified command gets invoked.'),\n\t\t\t\t\t\tbody: 'onCommand:${2:commandId}'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'onDebug',\n\t\t\t\t\t\tdescription: nls.localize('vscode.extension.activationEvents.onDebug', 'An activation event emitted whenever a user is about to start debugging or about to setup debug configurations.'),\n\t\t\t\t\t\tbody: 'onDebug'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'onDebugInitialConfigurations',\n\t\t\t\t\t\tdescription: nls.localize('vscode.extension.activationEvents.onDebugInitialConfigurations', 'An activation event emitted whenever a \"launch.json\" needs to be created (and all provideDebugConfigurations methods need to be called).'),\n\t\t\t\t\t\tbody: 'onDebugInitialConfigurations'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'onDebugDynamicConfigurations',\n\t\t\t\t\t\tdescription: nls.localize('vscode.extension.activationEvents.onDebugDynamicConfigurations', 'An activation event emitted whenever a list of all debug configurations needs to be created (and all provideDebugConfigurations methods for the \"dynamic\" scope need to be called).'),\n\t\t\t\t\t\tbody: 'onDebugDynamicConfigurations'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'onDebugResolve',\n\t\t\t\t\t\tdescription: nls.localize('vscode.extension.activationEvents.onDebugResolve', 'An activation event emitted whenever a debug session with the specific type is about to be launched (and a corresponding resolveDebugConfiguration method needs to be called).'),\n\t\t\t\t\t\tbody: 'onDebugResolve:${6:type}'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'onDebugAdapterProtocolTracker',\n\t\t\t\t\t\tdescription: nls.localize('vscode.extension.activationEvents.onDebugAdapterProtocolTracker', 'An activation event emitted whenever a debug session with the specific type is about to be launched and a debug protocol tracker might be needed.'),\n\t\t\t\t\t\tbody: 'onDebugAdapterProtocolTracker:${6:type}'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'workspaceContains',\n\t\t\t\t\t\tdescription: nls.localize('vscode.extension.activationEvents.workspaceContains', 'An activation event emitted whenever a folder is opened that contains at least a file matching the specified glob pattern.'),\n\t\t\t\t\t\tbody: 'workspaceContains:${4:filePattern}'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'onStartupFinished',\n\t\t\t\t\t\tdescription: nls.localize('vscode.extension.activationEvents.onStartupFinished', 'An activation event emitted after the start-up finished (after all `*` activated extensions have finished activating).'),\n\t\t\t\t\t\tbody: 'onStartupFinished'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'onTaskType',\n\t\t\t\t\t\tdescription: nls.localize('vscode.extension.activationEvents.onTaskType', 'An activation event emitted whenever tasks of a certain type need to be listed or resolved.'),\n\t\t\t\t\t\tbody: 'onTaskType:${1:taskType}'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'onFileSystem',\n\t\t\t\t\t\tdescription: nls.localize('vscode.extension.activationEvents.onFileSystem', 'An activation event emitted whenever a file or folder is accessed with the given scheme.'),\n\t\t\t\t\t\tbody: 'onFileSystem:${1:scheme}'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'onSearch',\n\t\t\t\t\t\tdescription: nls.localize('vscode.extension.activationEvents.onSearch', 'An activation event emitted whenever a search is started in the folder with the given scheme.'),\n\t\t\t\t\t\tbody: 'onSearch:${7:scheme}'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'onView',\n\t\t\t\t\t\tbody: 'onView:${5:viewId}',\n\t\t\t\t\t\tdescription: nls.localize('vscode.extension.activationEvents.onView', 'An activation event emitted whenever the specified view is expanded.'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'onIdentity',\n\t\t\t\t\t\tbody: 'onIdentity:${8:identity}',\n\t\t\t\t\t\tdescription: nls.localize('vscode.extension.activationEvents.onIdentity', 'An activation event emitted whenever the specified user identity.'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'onUri',\n\t\t\t\t\t\tbody: 'onUri',\n\t\t\t\t\t\tdescription: nls.localize('vscode.extension.activationEvents.onUri', 'An activation event emitted whenever a system-wide Uri directed towards this extension is open.'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'onOpenExternalUri',\n\t\t\t\t\t\tbody: 'onOpenExternalUri',\n\t\t\t\t\t\tdescription: nls.localize('vscode.extension.activationEvents.onOpenExternalUri', 'An activation event emitted whenever a external uri (such as an http or https link) is being opened.'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'onCustomEditor',\n\t\t\t\t\t\tbody: 'onCustomEditor:${9:viewType}',\n\t\t\t\t\t\tdescription: nls.localize('vscode.extension.activationEvents.onCustomEditor', 'An activation event emitted whenever the specified custom editor becomes visible.'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'onNotebook',\n\t\t\t\t\t\tbody: 'onNotebook:${1:type}',\n\t\t\t\t\t\tdescription: nls.localize('vscode.extension.activationEvents.onNotebook', 'An activation event emitted whenever the specified notebook document is opened.'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'onAuthenticationRequest',\n\t\t\t\t\t\tbody: 'onAuthenticationRequest:${11:authenticationProviderId}',\n\t\t\t\t\t\tdescription: nls.localize('vscode.extension.activationEvents.onAuthenticationRequest', 'An activation event emitted whenever sessions are requested from the specified authentication provider.')\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'onRenderer',\n\t\t\t\t\t\tdescription: nls.localize('vscode.extension.activationEvents.onRenderer', 'An activation event emitted whenever a notebook output renderer is used.'),\n\t\t\t\t\t\tbody: 'onRenderer:${11:rendererId}'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'onTerminalProfile',\n\t\t\t\t\t\tbody: 'onTerminalProfile:${1:terminalId}',\n\t\t\t\t\t\tdescription: nls.localize('vscode.extension.activationEvents.onTerminalProfile', 'An activation event emitted when a specific terminal profile is launched.'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'onWalkthrough',\n\t\t\t\t\t\tbody: 'onWalkthrough:${1:walkthroughID}',\n\t\t\t\t\t\tdescription: nls.localize('vscode.extension.activationEvents.onWalkthrough', 'An activation event emitted when a specified walkthrough is opened.'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: '*',\n\t\t\t\t\t\tdescription: nls.localize('vscode.extension.activationEvents.star', 'An activation event emitted on VS Code startup. To ensure a great end user experience, please use this activation event in your extension only when no other activation events combination works in your use-case.'),\n\t\t\t\t\t\tbody: '*'\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t}\n\t\t},\n\t\tbadges: {\n\t\t\ttype: 'array',\n\t\t\tdescription: nls.localize('vscode.extension.badges', 'Array of badges to display in the sidebar of the Marketplace\\'s extension page.'),\n\t\t\titems: {\n\t\t\t\ttype: 'object',\n\t\t\t\trequired: ['url', 'href', 'description'],\n\t\t\t\tproperties: {\n\t\t\t\t\turl: {\n\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\tdescription: nls.localize('vscode.extension.badges.url', 'Badge image URL.')\n\t\t\t\t\t},\n\t\t\t\t\thref: {\n\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\tdescription: nls.localize('vscode.extension.badges.href', 'Badge link.')\n\t\t\t\t\t},\n\t\t\t\t\tdescription: {\n\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\tdescription: nls.localize('vscode.extension.badges.description', 'Badge description.')\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tmarkdown: {\n\t\t\ttype: 'string',\n\t\t\tdescription: nls.localize('vscode.extension.markdown', \"Controls the Markdown rendering engine used in the Marketplace. Either github (default) or standard.\"),\n\t\t\tenum: ['github', 'standard'],\n\t\t\tdefault: 'github'\n\t\t},\n\t\tqna: {\n\t\t\tdefault: 'marketplace',\n\t\t\tdescription: nls.localize('vscode.extension.qna', \"Controls the Q&A link in the Marketplace. Set to marketplace to enable the default Marketplace Q & A site. Set to a string to provide the URL of a custom Q & A site. Set to false to disable Q & A altogether.\"),\n\t\t\tanyOf: [\n\t\t\t\t{\n\t\t\t\t\ttype: ['string', 'boolean'],\n\t\t\t\t\tenum: ['marketplace', false]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttype: 'string'\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\textensionDependencies: {\n\t\t\tdescription: nls.localize('vscode.extension.extensionDependencies', 'Dependencies to other extensions. The identifier of an extension is always ${publisher}.${name}. For example: vscode.csharp.'),\n\t\t\ttype: 'array',\n\t\t\tuniqueItems: true,\n\t\t\titems: {\n\t\t\t\ttype: 'string',\n\t\t\t\tpattern: EXTENSION_IDENTIFIER_PATTERN\n\t\t\t}\n\t\t},\n\t\textensionPack: {\n\t\t\tdescription: nls.localize('vscode.extension.contributes.extensionPack', \"A set of extensions that can be installed together. The identifier of an extension is always ${publisher}.${name}. For example: vscode.csharp.\"),\n\t\t\ttype: 'array',\n\t\t\tuniqueItems: true,\n\t\t\titems: {\n\t\t\t\ttype: 'string',\n\t\t\t\tpattern: EXTENSION_IDENTIFIER_PATTERN\n\t\t\t}\n\t\t},\n\t\textensionKind: {\n\t\t\tdescription: nls.localize('extensionKind', \"Define the kind of an extension. `ui` extensions are installed and run on the local machine while `workspace` extensions run on the remote.\"),\n\t\t\ttype: 'array',\n\t\t\titems: extensionKindSchema,\n\t\t\tdefault: ['workspace'],\n\t\t\tdefaultSnippets: [\n\t\t\t\t{\n\t\t\t\t\tbody: ['ui'],\n\t\t\t\t\tdescription: nls.localize('extensionKind.ui', \"Define an extension which can run only on the local machine when connected to remote window.\")\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tbody: ['workspace'],\n\t\t\t\t\tdescription: nls.localize('extensionKind.workspace', \"Define an extension which can run only on the remote machine when connected remote window.\")\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tbody: ['ui', 'workspace'],\n\t\t\t\t\tdescription: nls.localize('extensionKind.ui-workspace', \"Define an extension which can run on either side, with a preference towards running on the local machine.\")\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tbody: ['workspace', 'ui'],\n\t\t\t\t\tdescription: nls.localize('extensionKind.workspace-ui', \"Define an extension which can run on either side, with a preference towards running on the remote machine.\")\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tbody: [],\n\t\t\t\t\tdescription: nls.localize('extensionKind.empty', \"Define an extension which cannot run in a remote context, neither on the local, nor on the remote machine.\")\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\tcapabilities: {\n\t\t\tdescription: nls.localize('vscode.extension.capabilities', \"Declare the set of supported capabilities by the extension.\"),\n\t\t\ttype: 'object',\n\t\t\tproperties: {\n\t\t\t\tvirtualWorkspaces: {\n\t\t\t\t\tdescription: nls.localize('vscode.extension.capabilities.virtualWorkspaces', \"Declares whether the extension should be enabled in virtual workspaces. A virtual workspace is a workspace which is not backed by any on-disk resources. When false, this extension will be automatically disabled in virtual workspaces. Default is true.\"),\n\t\t\t\t\ttype: ['boolean', 'object'],\n\t\t\t\t\tdefaultSnippets: [\n\t\t\t\t\t\t{ label: 'limited', body: { supported: '${1:limited}', description: '${2}' } },\n\t\t\t\t\t\t{ label: 'false', body: { supported: false, description: '${2}' } },\n\t\t\t\t\t],\n\t\t\t\t\tdefault: true.valueOf,\n\t\t\t\t\tproperties: {\n\t\t\t\t\t\tsupported: {\n\t\t\t\t\t\t\tmarkdownDescription: nls.localize('vscode.extension.capabilities.virtualWorkspaces.supported', \"Declares the level of support for virtual workspaces by the extension.\"),\n\t\t\t\t\t\t\ttype: ['string', 'boolean'],\n\t\t\t\t\t\t\tenum: ['limited', true, false],\n\t\t\t\t\t\t\tenumDescriptions: [\n\t\t\t\t\t\t\t\tnls.localize('vscode.extension.capabilities.virtualWorkspaces.supported.limited', \"The extension will be enabled in virtual workspaces with some functionality disabled.\"),\n\t\t\t\t\t\t\t\tnls.localize('vscode.extension.capabilities.virtualWorkspaces.supported.true', \"The extension will be enabled in virtual workspaces with all functionality enabled.\"),\n\t\t\t\t\t\t\t\tnls.localize('vscode.extension.capabilities.virtualWorkspaces.supported.false', \"The extension will not be enabled in virtual workspaces.\"),\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\tdescription: {\n\t\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\t\tmarkdownDescription: nls.localize('vscode.extension.capabilities.virtualWorkspaces.description', \"A description of how virtual workspaces affects the extensions behavior and why it is needed. This only applies when `supported` is not `true`.\"),\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tuntrustedWorkspaces: {\n\t\t\t\t\tdescription: nls.localize('vscode.extension.capabilities.untrustedWorkspaces', 'Declares how the extension should be handled in untrusted workspaces.'),\n\t\t\t\t\ttype: 'object',\n\t\t\t\t\trequired: ['supported'],\n\t\t\t\t\tdefaultSnippets: [\n\t\t\t\t\t\t{ body: { supported: '${1:limited}', description: '${2}' } },\n\t\t\t\t\t],\n\t\t\t\t\tproperties: {\n\t\t\t\t\t\tsupported: {\n\t\t\t\t\t\t\tmarkdownDescription: nls.localize('vscode.extension.capabilities.untrustedWorkspaces.supported', \"Declares the level of support for untrusted workspaces by the extension.\"),\n\t\t\t\t\t\t\ttype: ['string', 'boolean'],\n\t\t\t\t\t\t\tenum: ['limited', true, false],\n\t\t\t\t\t\t\tenumDescriptions: [\n\t\t\t\t\t\t\t\tnls.localize('vscode.extension.capabilities.untrustedWorkspaces.supported.limited', \"The extension will be enabled in untrusted workspaces with some functionality disabled.\"),\n\t\t\t\t\t\t\t\tnls.localize('vscode.extension.capabilities.untrustedWorkspaces.supported.true', \"The extension will be enabled in untrusted workspaces with all functionality enabled.\"),\n\t\t\t\t\t\t\t\tnls.localize('vscode.extension.capabilities.untrustedWorkspaces.supported.false', \"The extension will not be enabled in untrusted workspaces.\"),\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\trestrictedConfigurations: {\n\t\t\t\t\t\t\tdescription: nls.localize('vscode.extension.capabilities.untrustedWorkspaces.restrictedConfigurations', \"A list of configuration keys contributed by the extension that should not use workspace values in untrusted workspaces.\"),\n\t\t\t\t\t\t\ttype: 'array',\n\t\t\t\t\t\t\titems: {\n\t\t\t\t\t\t\t\ttype: 'string'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tdescription: {\n\t\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\t\tmarkdownDescription: nls.localize('vscode.extension.capabilities.untrustedWorkspaces.description', \"A description of how workspace trust affects the extensions behavior and why it is needed. This only applies when `supported` is not `true`.\"),\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tsponsor: {\n\t\t\tdescription: nls.localize('vscode.extension.contributes.sponsor', \"Specify the location from where users can sponsor your extension.\"),\n\t\t\ttype: 'object',\n\t\t\tdefaultSnippets: [\n\t\t\t\t{ body: { url: '${1:https:}' } },\n\t\t\t],\n\t\t\tproperties: {\n\t\t\t\t'url': {\n\t\t\t\t\tdescription: nls.localize('vscode.extension.contributes.sponsor.url', \"URL from where users can sponsor your extension. It must be a valid URL with a HTTP or HTTPS protocol. Example value: https://github.com/sponsors/nvaccess\"),\n\t\t\t\t\ttype: 'string',\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tscripts: {\n\t\t\ttype: 'object',\n\t\t\tproperties: {\n\t\t\t\t'vscode:prepublish': {\n\t\t\t\t\tdescription: nls.localize('vscode.extension.scripts.prepublish', 'Script executed before the package is published as a VS Code extension.'),\n\t\t\t\t\ttype: 'string'\n\t\t\t\t},\n\t\t\t\t'vscode:uninstall': {\n\t\t\t\t\tdescription: nls.localize('vscode.extension.scripts.uninstall', 'Uninstall hook for VS Code extension. Script that gets executed when the extension is completely uninstalled from VS Code which is when VS Code is restarted (shutdown and start) after the extension is uninstalled. Only Node scripts are supported.'),\n\t\t\t\t\ttype: 'string'\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\ticon: {\n\t\t\ttype: 'string',\n\t\t\tdescription: nls.localize('vscode.extension.icon', 'The path to a 128x128 pixel icon.')\n\t\t}\n\t}\n};\n\nexport interface IExtensionPointDescriptor {\n\textensionPoint: string;\n\tdeps?: IExtensionPoint<any>[];\n\tjsonSchema: IJSONSchema;\n\tdefaultExtensionKind?: ExtensionKind[];\n}\n\nexport class ExtensionsRegistryImpl {\n\n\tprivate readonly _extensionPoints = new Map<string, ExtensionPoint<any>>();\n\n\tpublic registerExtensionPoint<T>(desc: IExtensionPointDescriptor): IExtensionPoint<T> {\n\t\tif (this._extensionPoints.has(desc.extensionPoint)) {\n\t\t\tthrow new Error('Duplicate extension point: ' + desc.extensionPoint);\n\t\t}\n\t\tconst result = new ExtensionPoint<T>(desc.extensionPoint, desc.defaultExtensionKind);\n\t\tthis._extensionPoints.set(desc.extensionPoint, result);\n\n\t\tschema.properties!['contributes'].properties![desc.extensionPoint] = desc.jsonSchema;\n\t\tschemaRegistry.registerSchema(schemaId, schema);\n\n\t\treturn result;\n\t}\n\n\tpublic getExtensionPoints(): ExtensionPoint<any>[] {\n\t\treturn Array.from(this._extensionPoints.values());\n\t}\n}\n\nconst PRExtensions = {\n\tExtensionsRegistry: 'ExtensionsRegistry'\n};\nRegistry.add(PRExtensions.ExtensionsRegistry, new ExtensionsRegistryImpl());\nexport const ExtensionsRegistry: ExtensionsRegistryImpl = Registry.as(PRExtensions.ExtensionsRegistry);\n\nschemaRegistry.registerSchema(schemaId, schema);\n\n\nschemaRegistry.registerSchema(productSchemaId, {\n\tproperties: {\n\t\textensionEnabledApiProposals: {\n\t\t\tdescription: nls.localize('product.extensionEnabledApiProposals', \"API proposals that the respective extensions can freely use.\"),\n\t\t\ttype: 'object',\n\t\t\tproperties: {},\n\t\t\tadditionalProperties: {\n\t\t\t\tanyOf: [{\n\t\t\t\t\ttype: 'array',\n\t\t\t\t\tuniqueItems: true,\n\t\t\t\t\titems: {\n\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\tenum: Object.keys(allApiProposals),\n\t\t\t\t\t\tmarkdownEnumDescriptions: Object.values(allApiProposals)\n\t\t\t\t\t}\n\t\t\t\t}]\n\t\t\t}\n\t\t}\n\t}\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from 'vs/nls';\nimport { IJSONSchema, IJSONSchemaMap } from 'vs/base/common/jsonSchema';\nimport { IStringDictionary } from 'vs/base/common/collections';\nimport * as Types from 'vs/base/common/types';\nimport * as Objects from 'vs/base/common/objects';\n\nimport { ExtensionsRegistry, ExtensionMessageCollector } from 'vs/workbench/services/extensions/common/extensionsRegistry';\n\nimport * as Tasks from 'vs/workbench/contrib/tasks/common/tasks';\nimport { ExtensionIdentifier } from 'vs/platform/extensions/common/extensions';\nimport { ContextKeyExpr } from 'vs/platform/contextkey/common/contextkey';\nimport { Emitter, Event } from 'vs/base/common/event';\n\n\nconst taskDefinitionSchema: IJSONSchema = {\n\ttype: 'object',\n\tadditionalProperties: false,\n\tproperties: {\n\t\ttype: {\n\t\t\ttype: 'string',\n\t\t\tdescription: nls.localize('TaskDefinition.description', 'The actual task type. Please note that types starting with a \\'$\\' are reserved for internal usage.')\n\t\t},\n\t\trequired: {\n\t\t\ttype: 'array',\n\t\t\titems: {\n\t\t\t\ttype: 'string'\n\t\t\t}\n\t\t},\n\t\tproperties: {\n\t\t\ttype: 'object',\n\t\t\tdescription: nls.localize('TaskDefinition.properties', 'Additional properties of the task type'),\n\t\t\tadditionalProperties: {\n\t\t\t\t$ref: 'http://json-schema.org/draft-07/schema#'\n\t\t\t}\n\t\t},\n\t\twhen: {\n\t\t\ttype: 'string',\n\t\t\tmarkdownDescription: nls.localize('TaskDefinition.when', 'Condition which must be true to enable this type of task. Consider using `shellExecutionSupported`, `processExecutionSupported`, and `customExecutionSupported` as appropriate for this task definition. See the [API documentation](https://code.visualstudio.com/api/extension-guides/task-provider#when-clause) for more information.'),\n\t\t\tdefault: ''\n\t\t}\n\t}\n};\n\nnamespace Configuration {\n\texport interface ITaskDefinition {\n\t\ttype?: string;\n\t\trequired?: string[];\n\t\tproperties?: IJSONSchemaMap;\n\t\twhen?: string;\n\t}\n\n\texport function from(value: ITaskDefinition, extensionId: ExtensionIdentifier, messageCollector: ExtensionMessageCollector): Tasks.ITaskDefinition | undefined {\n\t\tif (!value) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst taskType = Types.isString(value.type) ? value.type : undefined;\n\t\tif (!taskType || taskType.length === 0) {\n\t\t\tmessageCollector.error(nls.localize('TaskTypeConfiguration.noType', 'The task type configuration is missing the required \\'taskType\\' property'));\n\t\t\treturn undefined;\n\t\t}\n\t\tconst required: string[] = [];\n\t\tif (Array.isArray(value.required)) {\n\t\t\tfor (const element of value.required) {\n\t\t\t\tif (Types.isString(element)) {\n\t\t\t\t\trequired.push(element);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn {\n\t\t\textensionId: extensionId.value,\n\t\t\ttaskType, required: required,\n\t\t\tproperties: value.properties ? Objects.deepClone(value.properties) : {},\n\t\t\twhen: value.when ? ContextKeyExpr.deserialize(value.when) : undefined\n\t\t};\n\t}\n}\n\n\nconst taskDefinitionsExtPoint = ExtensionsRegistry.registerExtensionPoint<Configuration.ITaskDefinition[]>({\n\textensionPoint: 'taskDefinitions',\n\tjsonSchema: {\n\t\tdescription: nls.localize('TaskDefinitionExtPoint', 'Contributes task kinds'),\n\t\ttype: 'array',\n\t\titems: taskDefinitionSchema\n\t}\n});\n\nexport interface ITaskDefinitionRegistry {\n\tonReady(): Promise<void>;\n\n\tget(key: string): Tasks.ITaskDefinition;\n\tall(): Tasks.ITaskDefinition[];\n\tgetJsonSchema(): IJSONSchema;\n\tonDefinitionsChanged: Event<void>;\n}\n\nexport class TaskDefinitionRegistryImpl implements ITaskDefinitionRegistry {\n\n\tprivate taskTypes: IStringDictionary<Tasks.ITaskDefinition>;\n\tprivate readyPromise: Promise<void>;\n\tprivate _schema: IJSONSchema | undefined;\n\tprivate _onDefinitionsChanged: Emitter<void> = new Emitter();\n\tpublic onDefinitionsChanged: Event<void> = this._onDefinitionsChanged.event;\n\n\tconstructor() {\n\t\tthis.taskTypes = Object.create(null);\n\t\tthis.readyPromise = new Promise<void>((resolve, reject) => {\n\t\t\ttaskDefinitionsExtPoint.setHandler((extensions, delta) => {\n\t\t\t\tthis._schema = undefined;\n\t\t\t\ttry {\n\t\t\t\t\tfor (const extension of delta.removed) {\n\t\t\t\t\t\tconst taskTypes = extension.value;\n\t\t\t\t\t\tfor (const taskType of taskTypes) {\n\t\t\t\t\t\t\tif (this.taskTypes && taskType.type && this.taskTypes[taskType.type]) {\n\t\t\t\t\t\t\t\tdelete this.taskTypes[taskType.type];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfor (const extension of delta.added) {\n\t\t\t\t\t\tconst taskTypes = extension.value;\n\t\t\t\t\t\tfor (const taskType of taskTypes) {\n\t\t\t\t\t\t\tconst type = Configuration.from(taskType, extension.description.identifier, extension.collector);\n\t\t\t\t\t\t\tif (type) {\n\t\t\t\t\t\t\t\tthis.taskTypes[type.taskType] = type;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif ((delta.removed.length > 0) || (delta.added.length > 0)) {\n\t\t\t\t\t\tthis._onDefinitionsChanged.fire();\n\t\t\t\t\t}\n\t\t\t\t} catch (error) {\n\t\t\t\t}\n\t\t\t\tresolve(undefined);\n\t\t\t});\n\t\t});\n\t}\n\n\tpublic onReady(): Promise<void> {\n\t\treturn this.readyPromise;\n\t}\n\n\tpublic get(key: string): Tasks.ITaskDefinition {\n\t\treturn this.taskTypes[key];\n\t}\n\n\tpublic all(): Tasks.ITaskDefinition[] {\n\t\treturn Object.keys(this.taskTypes).map(key => this.taskTypes[key]);\n\t}\n\n\tpublic getJsonSchema(): IJSONSchema {\n\t\tif (this._schema === undefined) {\n\t\t\tconst schemas: IJSONSchema[] = [];\n\t\t\tfor (const definition of this.all()) {\n\t\t\t\tconst schema: IJSONSchema = {\n\t\t\t\t\ttype: 'object',\n\t\t\t\t\tadditionalProperties: false\n\t\t\t\t};\n\t\t\t\tif (definition.required.length > 0) {\n\t\t\t\t\tschema.required = definition.required.slice(0);\n\t\t\t\t}\n\t\t\t\tif (definition.properties !== undefined) {\n\t\t\t\t\tschema.properties = Objects.deepClone(definition.properties);\n\t\t\t\t} else {\n\t\t\t\t\tschema.properties = Object.create(null);\n\t\t\t\t}\n\t\t\t\tschema.properties!.type = {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tenum: [definition.taskType]\n\t\t\t\t};\n\t\t\t\tschemas.push(schema);\n\t\t\t}\n\t\t\tthis._schema = { oneOf: schemas };\n\t\t}\n\t\treturn this._schema;\n\t}\n}\n\nexport const TaskDefinitionRegistry: ITaskDefinitionRegistry = new TaskDefinitionRegistryImpl();\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from 'vs/nls';\nimport * as Types from 'vs/base/common/types';\nimport * as resources from 'vs/base/common/resources';\nimport { IJSONSchemaMap } from 'vs/base/common/jsonSchema';\nimport * as Objects from 'vs/base/common/objects';\nimport { UriComponents, URI } from 'vs/base/common/uri';\n\nimport { ProblemMatcher } from 'vs/workbench/contrib/tasks/common/problemMatcher';\nimport { IWorkspaceFolder, IWorkspace } from 'vs/platform/workspace/common/workspace';\nimport { RawContextKey, ContextKeyExpression } from 'vs/platform/contextkey/common/contextkey';\nimport { TaskDefinitionRegistry } from 'vs/workbench/contrib/tasks/common/taskDefinitionRegistry';\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { ConfigurationTarget } from 'vs/platform/configuration/common/configuration';\n\n\nexport const USER_TASKS_GROUP_KEY = 'settings';\n\nexport const TASK_RUNNING_STATE = new RawContextKey<boolean>('taskRunning', false, nls.localize('tasks.taskRunningContext', \"Whether a task is currently running.\"));\nexport const TASKS_CATEGORY = { value: nls.localize('tasksCategory', \"Tasks\"), original: 'Tasks' };\n\nexport enum ShellQuoting {\n\t/**\n\t * Use character escaping.\n\t */\n\tEscape = 1,\n\n\t/**\n\t * Use strong quoting\n\t */\n\tStrong = 2,\n\n\t/**\n\t * Use weak quoting.\n\t */\n\tWeak = 3,\n}\n\nexport const CUSTOMIZED_TASK_TYPE = '$customized';\n\nexport namespace ShellQuoting {\n\texport function from(this: void, value: string): ShellQuoting {\n\t\tif (!value) {\n\t\t\treturn ShellQuoting.Strong;\n\t\t}\n\t\tswitch (value.toLowerCase()) {\n\t\t\tcase 'escape':\n\t\t\t\treturn ShellQuoting.Escape;\n\t\t\tcase 'strong':\n\t\t\t\treturn ShellQuoting.Strong;\n\t\t\tcase 'weak':\n\t\t\t\treturn ShellQuoting.Weak;\n\t\t\tdefault:\n\t\t\t\treturn ShellQuoting.Strong;\n\t\t}\n\t}\n}\n\nexport interface IShellQuotingOptions {\n\t/**\n\t * The character used to do character escaping.\n\t */\n\tescape?: string | {\n\t\tescapeChar: string;\n\t\tcharsToEscape: string;\n\t};\n\n\t/**\n\t * The character used for string quoting.\n\t */\n\tstrong?: string;\n\n\t/**\n\t * The character used for weak quoting.\n\t */\n\tweak?: string;\n}\n\nexport interface IShellConfiguration {\n\t/**\n\t * The shell executable.\n\t */\n\texecutable?: string;\n\n\t/**\n\t * The arguments to be passed to the shell executable.\n\t */\n\targs?: string[];\n\n\t/**\n\t * Which kind of quotes the shell supports.\n\t */\n\tquoting?: IShellQuotingOptions;\n}\n\nexport interface CommandOptions {\n\n\t/**\n\t * The shell to use if the task is a shell command.\n\t */\n\tshell?: IShellConfiguration;\n\n\t/**\n\t * The current working directory of the executed program or shell.\n\t * If omitted VSCode's current workspace root is used.\n\t */\n\tcwd?: string;\n\n\t/**\n\t * The environment of the executed program or shell. If omitted\n\t * the parent process' environment is used.\n\t */\n\tenv?: { [key: string]: string };\n}\n\nexport namespace CommandOptions {\n\texport const defaults: CommandOptions = { cwd: '${workspaceFolder}' };\n}\n\nexport enum RevealKind {\n\t/**\n\t * Always brings the terminal to front if the task is executed.\n\t */\n\tAlways = 1,\n\n\t/**\n\t * Only brings the terminal to front if a problem is detected executing the task\n\t * e.g. the task couldn't be started,\n\t * the task ended with an exit code other than zero,\n\t * or the problem matcher found an error.\n\t */\n\tSilent = 2,\n\n\t/**\n\t * The terminal never comes to front when the task is executed.\n\t */\n\tNever = 3\n}\n\nexport namespace RevealKind {\n\texport function fromString(this: void, value: string): RevealKind {\n\t\tswitch (value.toLowerCase()) {\n\t\t\tcase 'always':\n\t\t\t\treturn RevealKind.Always;\n\t\t\tcase 'silent':\n\t\t\t\treturn RevealKind.Silent;\n\t\t\tcase 'never':\n\t\t\t\treturn RevealKind.Never;\n\t\t\tdefault:\n\t\t\t\treturn RevealKind.Always;\n\t\t}\n\t}\n}\n\nexport enum RevealProblemKind {\n\t/**\n\t * Never reveals the problems panel when this task is executed.\n\t */\n\tNever = 1,\n\n\n\t/**\n\t * Only reveals the problems panel if a problem is found.\n\t */\n\tOnProblem = 2,\n\n\t/**\n\t * Never reveals the problems panel when this task is executed.\n\t */\n\tAlways = 3\n}\n\nexport namespace RevealProblemKind {\n\texport function fromString(this: void, value: string): RevealProblemKind {\n\t\tswitch (value.toLowerCase()) {\n\t\t\tcase 'always':\n\t\t\t\treturn RevealProblemKind.Always;\n\t\t\tcase 'never':\n\t\t\t\treturn RevealProblemKind.Never;\n\t\t\tcase 'onproblem':\n\t\t\t\treturn RevealProblemKind.OnProblem;\n\t\t\tdefault:\n\t\t\t\treturn RevealProblemKind.OnProblem;\n\t\t}\n\t}\n}\n\nexport enum PanelKind {\n\n\t/**\n\t * Shares a panel with other tasks. This is the default.\n\t */\n\tShared = 1,\n\n\t/**\n\t * Uses a dedicated panel for this tasks. The panel is not\n\t * shared with other tasks.\n\t */\n\tDedicated = 2,\n\n\t/**\n\t * Creates a new panel whenever this task is executed.\n\t */\n\tNew = 3\n}\n\nexport namespace PanelKind {\n\texport function fromString(value: string): PanelKind {\n\t\tswitch (value.toLowerCase()) {\n\t\t\tcase 'shared':\n\t\t\t\treturn PanelKind.Shared;\n\t\t\tcase 'dedicated':\n\t\t\t\treturn PanelKind.Dedicated;\n\t\t\tcase 'new':\n\t\t\t\treturn PanelKind.New;\n\t\t\tdefault:\n\t\t\t\treturn PanelKind.Shared;\n\t\t}\n\t}\n}\n\nexport interface IPresentationOptions {\n\t/**\n\t * Controls whether the task output is reveal in the user interface.\n\t * Defaults to `RevealKind.Always`.\n\t */\n\treveal: RevealKind;\n\n\t/**\n\t * Controls whether the problems pane is revealed when running this task or not.\n\t * Defaults to `RevealProblemKind.Never`.\n\t */\n\trevealProblems: RevealProblemKind;\n\n\t/**\n\t * Controls whether the command associated with the task is echoed\n\t * in the user interface.\n\t */\n\techo: boolean;\n\n\t/**\n\t * Controls whether the panel showing the task output is taking focus.\n\t */\n\tfocus: boolean;\n\n\t/**\n\t * Controls if the task panel is used for this task only (dedicated),\n\t * shared between tasks (shared) or if a new panel is created on\n\t * every task execution (new). Defaults to `TaskInstanceKind.Shared`\n\t */\n\tpanel: PanelKind;\n\n\t/**\n\t * Controls whether to show the \"Terminal will be reused by tasks, press any key to close it\" message.\n\t */\n\tshowReuseMessage: boolean;\n\n\t/**\n\t * Controls whether to clear the terminal before executing the task.\n\t */\n\tclear: boolean;\n\n\t/**\n\t * Controls whether the task is executed in a specific terminal group using split panes.\n\t */\n\tgroup?: string;\n\n\t/**\n\t * Controls whether the terminal that the task runs in is closed when the task completes.\n\t */\n\tclose?: boolean;\n}\n\nexport namespace PresentationOptions {\n\texport const defaults: IPresentationOptions = {\n\t\techo: true, reveal: RevealKind.Always, revealProblems: RevealProblemKind.Never, focus: false, panel: PanelKind.Shared, showReuseMessage: true, clear: false\n\t};\n}\n\nexport enum RuntimeType {\n\tShell = 1,\n\tProcess = 2,\n\tCustomExecution = 3\n}\n\nexport namespace RuntimeType {\n\texport function fromString(value: string): RuntimeType {\n\t\tswitch (value.toLowerCase()) {\n\t\t\tcase 'shell':\n\t\t\t\treturn RuntimeType.Shell;\n\t\t\tcase 'process':\n\t\t\t\treturn RuntimeType.Process;\n\t\t\tcase 'customExecution':\n\t\t\t\treturn RuntimeType.CustomExecution;\n\t\t\tdefault:\n\t\t\t\treturn RuntimeType.Process;\n\t\t}\n\t}\n\texport function toString(value: RuntimeType): string {\n\t\tswitch (value) {\n\t\t\tcase RuntimeType.Shell: return 'shell';\n\t\t\tcase RuntimeType.Process: return 'process';\n\t\t\tcase RuntimeType.CustomExecution: return 'customExecution';\n\t\t\tdefault: return 'process';\n\t\t}\n\t}\n}\n\nexport interface IQuotedString {\n\tvalue: string;\n\tquoting: ShellQuoting;\n}\n\nexport type CommandString = string | IQuotedString;\n\nexport namespace CommandString {\n\texport function value(value: CommandString): string {\n\t\tif (Types.isString(value)) {\n\t\t\treturn value;\n\t\t} else {\n\t\t\treturn value.value;\n\t\t}\n\t}\n}\n\nexport interface ICommandConfiguration {\n\n\t/**\n\t * The task type\n\t */\n\truntime?: RuntimeType;\n\n\t/**\n\t * The command to execute\n\t */\n\tname?: CommandString;\n\n\t/**\n\t * Additional command options.\n\t */\n\toptions?: CommandOptions;\n\n\t/**\n\t * Command arguments.\n\t */\n\targs?: CommandString[];\n\n\t/**\n\t * The task selector if needed.\n\t */\n\ttaskSelector?: string;\n\n\t/**\n\t * Whether to suppress the task name when merging global args\n\t *\n\t */\n\tsuppressTaskName?: boolean;\n\n\t/**\n\t * Describes how the task is presented in the UI.\n\t */\n\tpresentation?: IPresentationOptions;\n}\n\nexport namespace TaskGroup {\n\texport const Clean: TaskGroup = { _id: 'clean', isDefault: false };\n\n\texport const Build: TaskGroup = { _id: 'build', isDefault: false };\n\n\texport const Rebuild: TaskGroup = { _id: 'rebuild', isDefault: false };\n\n\texport const Test: TaskGroup = { _id: 'test', isDefault: false };\n\n\texport function is(value: any): value is string {\n\t\treturn value === Clean._id || value === Build._id || value === Rebuild._id || value === Test._id;\n\t}\n\n\texport function from(value: string | TaskGroup | undefined): TaskGroup | undefined {\n\t\tif (value === undefined) {\n\t\t\treturn undefined;\n\t\t} else if (Types.isString(value)) {\n\t\t\tif (is(value)) {\n\t\t\t\treturn { _id: value, isDefault: false };\n\t\t\t}\n\t\t\treturn undefined;\n\t\t} else {\n\t\t\treturn value;\n\t\t}\n\t}\n}\n\nexport interface TaskGroup {\n\t_id: string;\n\tisDefault?: boolean | string;\n}\n\nexport const enum TaskScope {\n\tGlobal = 1,\n\tWorkspace = 2,\n\tFolder = 3\n}\n\nexport namespace TaskSourceKind {\n\texport const Workspace: 'workspace' = 'workspace';\n\texport const Extension: 'extension' = 'extension';\n\texport const InMemory: 'inMemory' = 'inMemory';\n\texport const WorkspaceFile: 'workspaceFile' = 'workspaceFile';\n\texport const User: 'user' = 'user';\n\n\texport function toConfigurationTarget(kind: string): ConfigurationTarget {\n\t\tswitch (kind) {\n\t\t\tcase TaskSourceKind.User: return ConfigurationTarget.USER;\n\t\t\tcase TaskSourceKind.WorkspaceFile: return ConfigurationTarget.WORKSPACE;\n\t\t\tdefault: return ConfigurationTarget.WORKSPACE_FOLDER;\n\t\t}\n\t}\n}\n\nexport interface ITaskSourceConfigElement {\n\tworkspaceFolder?: IWorkspaceFolder;\n\tworkspace?: IWorkspace;\n\tfile: string;\n\tindex: number;\n\telement: any;\n}\n\ninterface IBaseTaskSource {\n\treadonly kind: string;\n\treadonly label: string;\n}\n\nexport interface IWorkspaceTaskSource extends IBaseTaskSource {\n\treadonly kind: 'workspace';\n\treadonly config: ITaskSourceConfigElement;\n\treadonly customizes?: KeyedTaskIdentifier;\n}\n\nexport interface IExtensionTaskSource extends IBaseTaskSource {\n\treadonly kind: 'extension';\n\treadonly extension?: string;\n\treadonly scope: TaskScope;\n\treadonly workspaceFolder: IWorkspaceFolder | undefined;\n}\n\nexport interface IExtensionTaskSourceTransfer {\n\t__workspaceFolder: UriComponents;\n\t__definition: { type: string;[name: string]: any };\n}\n\nexport interface IInMemoryTaskSource extends IBaseTaskSource {\n\treadonly kind: 'inMemory';\n}\n\nexport interface IUserTaskSource extends IBaseTaskSource {\n\treadonly kind: 'user';\n\treadonly config: ITaskSourceConfigElement;\n\treadonly customizes?: KeyedTaskIdentifier;\n}\n\nexport interface WorkspaceFileTaskSource extends IBaseTaskSource {\n\treadonly kind: 'workspaceFile';\n\treadonly config: ITaskSourceConfigElement;\n\treadonly customizes?: KeyedTaskIdentifier;\n}\n\nexport type TaskSource = IWorkspaceTaskSource | IExtensionTaskSource | IInMemoryTaskSource | IUserTaskSource | WorkspaceFileTaskSource;\nexport type FileBasedTaskSource = IWorkspaceTaskSource | IUserTaskSource | WorkspaceFileTaskSource;\nexport interface ITaskIdentifier {\n\ttype: string;\n\t[name: string]: any;\n}\n\nexport interface KeyedTaskIdentifier extends ITaskIdentifier {\n\t_key: string;\n}\n\nexport interface ITaskDependency {\n\turi: URI | string;\n\ttask: string | KeyedTaskIdentifier | undefined;\n}\n\nexport const enum DependsOrder {\n\tparallel = 'parallel',\n\tsequence = 'sequence'\n}\n\nexport interface IConfigurationProperties {\n\n\t/**\n\t * The task's name\n\t */\n\tname?: string;\n\n\t/**\n\t * The task's name\n\t */\n\tidentifier?: string;\n\n\t/**\n\t * The task's group;\n\t */\n\tgroup?: string | TaskGroup;\n\n\t/**\n\t * The presentation options\n\t */\n\tpresentation?: IPresentationOptions;\n\n\t/**\n\t * The command options;\n\t */\n\toptions?: CommandOptions;\n\n\t/**\n\t * Whether the task is a background task or not.\n\t */\n\tisBackground?: boolean;\n\n\t/**\n\t * Whether the task should prompt on close for confirmation if running.\n\t */\n\tpromptOnClose?: boolean;\n\n\t/**\n\t * The other tasks this task depends on.\n\t */\n\tdependsOn?: ITaskDependency[];\n\n\t/**\n\t * The order the dependsOn tasks should be executed in.\n\t */\n\tdependsOrder?: DependsOrder;\n\n\t/**\n\t * A description of the task.\n\t */\n\tdetail?: string;\n\n\t/**\n\t * The problem watchers to use for this task\n\t */\n\tproblemMatchers?: Array<string | ProblemMatcher>;\n\n\t/**\n\t * The icon for this task in the terminal tabs list\n\t */\n\ticon?: { id?: string; color?: string };\n\n\t/**\n\t * Do not show this task in the run task quickpick\n\t */\n\thide?: boolean;\n}\n\nexport enum RunOnOptions {\n\tdefault = 1,\n\tfolderOpen = 2\n}\n\nexport interface IRunOptions {\n\treevaluateOnRerun?: boolean;\n\trunOn?: RunOnOptions;\n\tinstanceLimit?: number;\n}\n\nexport namespace RunOptions {\n\texport const defaults: IRunOptions = { reevaluateOnRerun: true, runOn: RunOnOptions.default, instanceLimit: 1 };\n}\n\nexport abstract class CommonTask {\n\n\t/**\n\t * The task's internal id\n\t */\n\treadonly _id: string;\n\n\t/**\n\t * The cached label.\n\t */\n\t_label: string = '';\n\n\ttype?: string;\n\n\trunOptions: IRunOptions;\n\n\tconfigurationProperties: IConfigurationProperties;\n\n\t_source: IBaseTaskSource;\n\n\tprivate _taskLoadMessages: string[] | undefined;\n\n\tprotected constructor(id: string, label: string | undefined, type: string | undefined, runOptions: IRunOptions,\n\t\tconfigurationProperties: IConfigurationProperties, source: IBaseTaskSource) {\n\t\tthis._id = id;\n\t\tif (label) {\n\t\t\tthis._label = label;\n\t\t}\n\t\tif (type) {\n\t\t\tthis.type = type;\n\t\t}\n\t\tthis.runOptions = runOptions;\n\t\tthis.configurationProperties = configurationProperties;\n\t\tthis._source = source;\n\t}\n\n\tpublic getDefinition(useSource?: boolean): KeyedTaskIdentifier | undefined {\n\t\treturn undefined;\n\t}\n\n\tpublic getMapKey(): string {\n\t\treturn this._id;\n\t}\n\n\tpublic getRecentlyUsedKey(): string | undefined {\n\t\treturn undefined;\n\t}\n\n\tprotected abstract getFolderId(): string | undefined;\n\n\tpublic getCommonTaskId(): string {\n\t\tinterface IRecentTaskKey {\n\t\t\tfolder: string | undefined;\n\t\t\tid: string;\n\t\t}\n\n\t\tconst key: IRecentTaskKey = { folder: this.getFolderId(), id: this._id };\n\t\treturn JSON.stringify(key);\n\t}\n\n\tpublic clone(): Task {\n\t\treturn this.fromObject(Object.assign({}, <any>this));\n\t}\n\n\tprotected abstract fromObject(object: any): Task;\n\n\tpublic getWorkspaceFolder(): IWorkspaceFolder | undefined {\n\t\treturn undefined;\n\t}\n\n\tpublic getWorkspaceFileName(): string | undefined {\n\t\treturn undefined;\n\t}\n\n\tpublic getTelemetryKind(): string {\n\t\treturn 'unknown';\n\t}\n\n\tpublic matches(key: string | KeyedTaskIdentifier | undefined, compareId: boolean = false): boolean {\n\t\tif (key === undefined) {\n\t\t\treturn false;\n\t\t}\n\t\tif (Types.isString(key)) {\n\t\t\treturn key === this._label || key === this.configurationProperties.identifier || (compareId && key === this._id);\n\t\t}\n\t\tconst identifier = this.getDefinition(true);\n\t\treturn identifier !== undefined && identifier._key === key._key;\n\t}\n\n\tpublic getQualifiedLabel(): string {\n\t\tconst workspaceFolder = this.getWorkspaceFolder();\n\t\tif (workspaceFolder) {\n\t\t\treturn `${this._label} (${workspaceFolder.name})`;\n\t\t} else {\n\t\t\treturn this._label;\n\t\t}\n\t}\n\n\tpublic getTaskExecution(): ITaskExecution {\n\t\tconst result: ITaskExecution = {\n\t\t\tid: this._id,\n\t\t\ttask: <any>this\n\t\t};\n\t\treturn result;\n\t}\n\n\tpublic addTaskLoadMessages(messages: string[] | undefined) {\n\t\tif (this._taskLoadMessages === undefined) {\n\t\t\tthis._taskLoadMessages = [];\n\t\t}\n\t\tif (messages) {\n\t\t\tthis._taskLoadMessages = this._taskLoadMessages.concat(messages);\n\t\t}\n\t}\n\n\tget taskLoadMessages(): string[] | undefined {\n\t\treturn this._taskLoadMessages;\n\t}\n}\n\n/**\n * For tasks of type shell or process, this is created upon parse\n * of the tasks.json or workspace file.\n * For ContributedTasks of all other types, this is the result of\n * resolving a ConfiguringTask.\n */\nexport class CustomTask extends CommonTask {\n\n\toverride type!: '$customized'; // CUSTOMIZED_TASK_TYPE\n\n\tinstance: number | undefined;\n\n\t/**\n\t * Indicated the source of the task (e.g. tasks.json or extension)\n\t */\n\toverride _source: FileBasedTaskSource;\n\n\thasDefinedMatchers: boolean;\n\n\t/**\n\t * The command configuration\n\t */\n\tcommand: ICommandConfiguration = {};\n\n\tpublic constructor(id: string, source: FileBasedTaskSource, label: string, type: string, command: ICommandConfiguration | undefined,\n\t\thasDefinedMatchers: boolean, runOptions: IRunOptions, configurationProperties: IConfigurationProperties) {\n\t\tsuper(id, label, undefined, runOptions, configurationProperties, source);\n\t\tthis._source = source;\n\t\tthis.hasDefinedMatchers = hasDefinedMatchers;\n\t\tif (command) {\n\t\t\tthis.command = command;\n\t\t}\n\t}\n\n\tpublic override clone(): CustomTask {\n\t\treturn new CustomTask(this._id, this._source, this._label, this.type, this.command, this.hasDefinedMatchers, this.runOptions, this.configurationProperties);\n\t}\n\n\tpublic customizes(): KeyedTaskIdentifier | undefined {\n\t\tif (this._source && this._source.customizes) {\n\t\t\treturn this._source.customizes;\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tpublic override getDefinition(useSource: boolean = false): KeyedTaskIdentifier {\n\t\tif (useSource && this._source.customizes !== undefined) {\n\t\t\treturn this._source.customizes;\n\t\t} else {\n\t\t\tlet type: string;\n\t\t\tconst commandRuntime = this.command ? this.command.runtime : undefined;\n\t\t\tswitch (commandRuntime) {\n\t\t\t\tcase RuntimeType.Shell:\n\t\t\t\t\ttype = 'shell';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase RuntimeType.Process:\n\t\t\t\t\ttype = 'process';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase RuntimeType.CustomExecution:\n\t\t\t\t\ttype = 'customExecution';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase undefined:\n\t\t\t\t\ttype = '$composite';\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new Error('Unexpected task runtime');\n\t\t\t}\n\n\t\t\tconst result: KeyedTaskIdentifier = {\n\t\t\t\ttype,\n\t\t\t\t_key: this._id,\n\t\t\t\tid: this._id\n\t\t\t};\n\t\t\treturn result;\n\t\t}\n\t}\n\n\tpublic static is(value: any): value is CustomTask {\n\t\treturn value instanceof CustomTask;\n\t}\n\n\tpublic override getMapKey(): string {\n\t\tconst workspaceFolder = this._source.config.workspaceFolder;\n\t\treturn workspaceFolder ? `${workspaceFolder.uri.toString()}|${this._id}|${this.instance}` : `${this._id}|${this.instance}`;\n\t}\n\n\tprotected getFolderId(): string | undefined {\n\t\treturn this._source.kind === TaskSourceKind.User ? USER_TASKS_GROUP_KEY : this._source.config.workspaceFolder?.uri.toString();\n\t}\n\n\tpublic override getCommonTaskId(): string {\n\t\treturn this._source.customizes ? super.getCommonTaskId() : (this.getRecentlyUsedKey() ?? super.getCommonTaskId());\n\t}\n\n\tpublic override getRecentlyUsedKey(): string | undefined {\n\t\tinterface ICustomKey {\n\t\t\ttype: string;\n\t\t\tfolder: string;\n\t\t\tid: string;\n\t\t}\n\t\tconst workspaceFolder = this.getFolderId();\n\t\tif (!workspaceFolder) {\n\t\t\treturn undefined;\n\t\t}\n\t\tlet id: string = this.configurationProperties.identifier!;\n\t\tif (this._source.kind !== TaskSourceKind.Workspace) {\n\t\t\tid += this._source.kind;\n\t\t}\n\t\tconst key: ICustomKey = { type: CUSTOMIZED_TASK_TYPE, folder: workspaceFolder, id };\n\t\treturn JSON.stringify(key);\n\t}\n\n\tpublic override getWorkspaceFolder(): IWorkspaceFolder | undefined {\n\t\treturn this._source.config.workspaceFolder;\n\t}\n\n\tpublic override getWorkspaceFileName(): string | undefined {\n\t\treturn (this._source.config.workspace && this._source.config.workspace.configuration) ? resources.basename(this._source.config.workspace.configuration) : undefined;\n\t}\n\n\tpublic override getTelemetryKind(): string {\n\t\tif (this._source.customizes) {\n\t\t\treturn 'workspace>extension';\n\t\t} else {\n\t\t\treturn 'workspace';\n\t\t}\n\t}\n\n\tprotected fromObject(object: CustomTask): CustomTask {\n\t\treturn new CustomTask(object._id, object._source, object._label, object.type, object.command, object.hasDefinedMatchers, object.runOptions, object.configurationProperties);\n\t}\n}\n\n/**\n * After a contributed task has been parsed, but before\n * the task has been resolved via the extension, its properties\n * are stored in this\n */\nexport class ConfiguringTask extends CommonTask {\n\n\t/**\n\t * Indicated the source of the task (e.g. tasks.json or extension)\n\t */\n\toverride _source: FileBasedTaskSource;\n\n\tconfigures: KeyedTaskIdentifier;\n\n\tpublic constructor(id: string, source: FileBasedTaskSource, label: string | undefined, type: string | undefined,\n\t\tconfigures: KeyedTaskIdentifier, runOptions: IRunOptions, configurationProperties: IConfigurationProperties) {\n\t\tsuper(id, label, type, runOptions, configurationProperties, source);\n\t\tthis._source = source;\n\t\tthis.configures = configures;\n\t}\n\n\tpublic static is(value: any): value is ConfiguringTask {\n\t\treturn value instanceof ConfiguringTask;\n\t}\n\n\tprotected fromObject(object: any): Task {\n\t\treturn object;\n\t}\n\n\tpublic override getDefinition(): KeyedTaskIdentifier {\n\t\treturn this.configures;\n\t}\n\n\tpublic override getWorkspaceFileName(): string | undefined {\n\t\treturn (this._source.config.workspace && this._source.config.workspace.configuration) ? resources.basename(this._source.config.workspace.configuration) : undefined;\n\t}\n\n\tpublic override getWorkspaceFolder(): IWorkspaceFolder | undefined {\n\t\treturn this._source.config.workspaceFolder;\n\t}\n\n\tprotected getFolderId(): string | undefined {\n\t\treturn this._source.kind === TaskSourceKind.User ? USER_TASKS_GROUP_KEY : this._source.config.workspaceFolder?.uri.toString();\n\t}\n\n\tpublic override getRecentlyUsedKey(): string | undefined {\n\t\tinterface ICustomKey {\n\t\t\ttype: string;\n\t\t\tfolder: string;\n\t\t\tid: string;\n\t\t}\n\t\tconst workspaceFolder = this.getFolderId();\n\t\tif (!workspaceFolder) {\n\t\t\treturn undefined;\n\t\t}\n\t\tlet id: string = this.configurationProperties.identifier!;\n\t\tif (this._source.kind !== TaskSourceKind.Workspace) {\n\t\t\tid += this._source.kind;\n\t\t}\n\t\tconst key: ICustomKey = { type: CUSTOMIZED_TASK_TYPE, folder: workspaceFolder, id };\n\t\treturn JSON.stringify(key);\n\t}\n}\n\n/**\n * A task from an extension created via resolveTask or provideTask\n */\nexport class ContributedTask extends CommonTask {\n\n\t/**\n\t * Indicated the source of the task (e.g. tasks.json or extension)\n\t * Set in the super constructor\n\t */\n\toverride _source!: IExtensionTaskSource;\n\n\tinstance: number | undefined;\n\n\tdefines: KeyedTaskIdentifier;\n\n\thasDefinedMatchers: boolean;\n\n\t/**\n\t * The command configuration\n\t */\n\tcommand: ICommandConfiguration;\n\n\t/**\n\t * The icon for the task\n\t */\n\ticon: { id?: string; color?: string } | undefined;\n\n\t/**\n\t * Don't show the task in the run task quickpick\n\t */\n\thide?: boolean;\n\n\tpublic constructor(id: string, source: IExtensionTaskSource, label: string, type: string | undefined, defines: KeyedTaskIdentifier,\n\t\tcommand: ICommandConfiguration, hasDefinedMatchers: boolean, runOptions: IRunOptions,\n\t\tconfigurationProperties: IConfigurationProperties) {\n\t\tsuper(id, label, type, runOptions, configurationProperties, source);\n\t\tthis.defines = defines;\n\t\tthis.hasDefinedMatchers = hasDefinedMatchers;\n\t\tthis.command = command;\n\t\tthis.icon = configurationProperties.icon;\n\t\tthis.hide = configurationProperties.hide;\n\t}\n\n\tpublic override clone(): ContributedTask {\n\t\treturn new ContributedTask(this._id, this._source, this._label, this.type, this.defines, this.command, this.hasDefinedMatchers, this.runOptions, this.configurationProperties);\n\t}\n\n\tpublic override getDefinition(): KeyedTaskIdentifier {\n\t\treturn this.defines;\n\t}\n\n\tpublic static is(value: any): value is ContributedTask {\n\t\treturn value instanceof ContributedTask;\n\t}\n\n\tpublic override getMapKey(): string {\n\t\tconst workspaceFolder = this._source.workspaceFolder;\n\t\treturn workspaceFolder\n\t\t\t? `${this._source.scope.toString()}|${workspaceFolder.uri.toString()}|${this._id}|${this.instance}`\n\t\t\t: `${this._source.scope.toString()}|${this._id}|${this.instance}`;\n\t}\n\n\tprotected getFolderId(): string | undefined {\n\t\tif (this._source.scope === TaskScope.Folder && this._source.workspaceFolder) {\n\t\t\treturn this._source.workspaceFolder.uri.toString();\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tpublic override getRecentlyUsedKey(): string | undefined {\n\t\tinterface IContributedKey {\n\t\t\ttype: string;\n\t\t\tscope: number;\n\t\t\tfolder?: string;\n\t\t\tid: string;\n\t\t}\n\n\t\tconst key: IContributedKey = { type: 'contributed', scope: this._source.scope, id: this._id };\n\t\tkey.folder = this.getFolderId();\n\t\treturn JSON.stringify(key);\n\t}\n\n\tpublic override getWorkspaceFolder(): IWorkspaceFolder | undefined {\n\t\treturn this._source.workspaceFolder;\n\t}\n\n\tpublic override getTelemetryKind(): string {\n\t\treturn 'extension';\n\t}\n\n\tprotected fromObject(object: ContributedTask): ContributedTask {\n\t\treturn new ContributedTask(object._id, object._source, object._label, object.type, object.defines, object.command, object.hasDefinedMatchers, object.runOptions, object.configurationProperties);\n\t}\n}\n\nexport class InMemoryTask extends CommonTask {\n\t/**\n\t * Indicated the source of the task (e.g. tasks.json or extension)\n\t */\n\toverride _source: IInMemoryTaskSource;\n\n\tinstance: number | undefined;\n\n\toverride type!: 'inMemory';\n\n\tpublic constructor(id: string, source: IInMemoryTaskSource, label: string, type: string,\n\t\trunOptions: IRunOptions, configurationProperties: IConfigurationProperties) {\n\t\tsuper(id, label, type, runOptions, configurationProperties, source);\n\t\tthis._source = source;\n\t}\n\n\tpublic override clone(): InMemoryTask {\n\t\treturn new InMemoryTask(this._id, this._source, this._label, this.type, this.runOptions, this.configurationProperties);\n\t}\n\n\tpublic static is(value: any): value is InMemoryTask {\n\t\treturn value instanceof InMemoryTask;\n\t}\n\n\tpublic override getTelemetryKind(): string {\n\t\treturn 'composite';\n\t}\n\n\tpublic override getMapKey(): string {\n\t\treturn `${this._id}|${this.instance}`;\n\t}\n\n\tprotected getFolderId(): undefined {\n\t\treturn undefined;\n\t}\n\n\tprotected fromObject(object: InMemoryTask): InMemoryTask {\n\t\treturn new InMemoryTask(object._id, object._source, object._label, object.type, object.runOptions, object.configurationProperties);\n\t}\n}\n\nexport type Task = CustomTask | ContributedTask | InMemoryTask;\n\nexport interface ITaskExecution {\n\tid: string;\n\ttask: Task;\n}\n\nexport enum ExecutionEngine {\n\tProcess = 1,\n\tTerminal = 2\n}\n\nexport namespace ExecutionEngine {\n\texport const _default: ExecutionEngine = ExecutionEngine.Terminal;\n}\n\nexport const enum JsonSchemaVersion {\n\tV0_1_0 = 1,\n\tV2_0_0 = 2\n}\n\nexport interface ITaskSet {\n\ttasks: Task[];\n\textension?: IExtensionDescription;\n}\n\nexport interface ITaskDefinition {\n\textensionId: string;\n\ttaskType: string;\n\trequired: string[];\n\tproperties: IJSONSchemaMap;\n\twhen?: ContextKeyExpression;\n}\n\nexport class TaskSorter {\n\n\tprivate _order: Map<string, number> = new Map();\n\n\tconstructor(workspaceFolders: IWorkspaceFolder[]) {\n\t\tfor (let i = 0; i < workspaceFolders.length; i++) {\n\t\t\tthis._order.set(workspaceFolders[i].uri.toString(), i);\n\t\t}\n\t}\n\n\tpublic compare(a: Task | ConfiguringTask, b: Task | ConfiguringTask): number {\n\t\tconst aw = a.getWorkspaceFolder();\n\t\tconst bw = b.getWorkspaceFolder();\n\t\tif (aw && bw) {\n\t\t\tlet ai = this._order.get(aw.uri.toString());\n\t\t\tai = ai === undefined ? 0 : ai + 1;\n\t\t\tlet bi = this._order.get(bw.uri.toString());\n\t\t\tbi = bi === undefined ? 0 : bi + 1;\n\t\t\tif (ai === bi) {\n\t\t\t\treturn a._label.localeCompare(b._label);\n\t\t\t} else {\n\t\t\t\treturn ai - bi;\n\t\t\t}\n\t\t} else if (!aw && bw) {\n\t\t\treturn -1;\n\t\t} else if (aw && !bw) {\n\t\t\treturn +1;\n\t\t} else {\n\t\t\treturn 0;\n\t\t}\n\t}\n}\n\nexport const enum TaskEventKind {\n\tDependsOnStarted = 'dependsOnStarted',\n\tAcquiredInput = 'acquiredInput',\n\tStart = 'start',\n\tProcessStarted = 'processStarted',\n\tActive = 'active',\n\tInactive = 'inactive',\n\tChanged = 'changed',\n\tTerminated = 'terminated',\n\tProcessEnded = 'processEnded',\n\tEnd = 'end'\n}\n\n\nexport const enum TaskRunType {\n\tSingleRun = 'singleRun',\n\tBackground = 'background'\n}\n\nexport interface ITaskEvent {\n\tkind: TaskEventKind;\n\ttaskId?: string;\n\ttaskName?: string;\n\trunType?: TaskRunType;\n\tgroup?: string | TaskGroup;\n\tprocessId?: number;\n\texitCode?: number;\n\tterminalId?: number;\n\t__task?: Task;\n\tresolvedVariables?: Map<string, string>;\n}\n\nexport const enum TaskRunSource {\n\tSystem,\n\tUser,\n\tFolderOpen,\n\tConfigurationChange,\n\tReconnect\n}\n\nexport namespace TaskEvent {\n\texport function create(kind: TaskEventKind.ProcessStarted | TaskEventKind.ProcessEnded, task: Task, processIdOrExitCode?: number): ITaskEvent;\n\texport function create(kind: TaskEventKind.Start, task: Task, terminalId?: number, resolvedVariables?: Map<string, string>): ITaskEvent;\n\texport function create(kind: TaskEventKind.AcquiredInput | TaskEventKind.DependsOnStarted | TaskEventKind.Start | TaskEventKind.Active | TaskEventKind.Inactive | TaskEventKind.Terminated | TaskEventKind.End, task: Task): ITaskEvent;\n\texport function create(kind: TaskEventKind.Changed): ITaskEvent;\n\texport function create(kind: TaskEventKind, task?: Task, processIdOrExitCodeOrTerminalId?: number, resolvedVariables?: Map<string, string>): ITaskEvent {\n\t\tif (task) {\n\t\t\tconst result: ITaskEvent = {\n\t\t\t\tkind: kind,\n\t\t\t\ttaskId: task._id,\n\t\t\t\ttaskName: task.configurationProperties.name,\n\t\t\t\trunType: task.configurationProperties.isBackground ? TaskRunType.Background : TaskRunType.SingleRun,\n\t\t\t\tgroup: task.configurationProperties.group,\n\t\t\t\tprocessId: undefined as number | undefined,\n\t\t\t\texitCode: undefined as number | undefined,\n\t\t\t\tterminalId: undefined as number | undefined,\n\t\t\t\t__task: task,\n\t\t\t};\n\t\t\tif (kind === TaskEventKind.Start) {\n\t\t\t\tresult.terminalId = processIdOrExitCodeOrTerminalId;\n\t\t\t\tresult.resolvedVariables = resolvedVariables;\n\t\t\t} else if (kind === TaskEventKind.ProcessStarted) {\n\t\t\t\tresult.processId = processIdOrExitCodeOrTerminalId;\n\t\t\t} else if (kind === TaskEventKind.ProcessEnded) {\n\t\t\t\tresult.exitCode = processIdOrExitCodeOrTerminalId;\n\t\t\t}\n\t\t\treturn Object.freeze(result);\n\t\t} else {\n\t\t\treturn Object.freeze({ kind: TaskEventKind.Changed });\n\t\t}\n\t}\n}\n\nexport namespace KeyedTaskIdentifier {\n\tfunction sortedStringify(literal: any): string {\n\t\tconst keys = Object.keys(literal).sort();\n\t\tlet result: string = '';\n\t\tfor (const key of keys) {\n\t\t\tlet stringified = literal[key];\n\t\t\tif (stringified instanceof Object) {\n\t\t\t\tstringified = sortedStringify(stringified);\n\t\t\t} else if (typeof stringified === 'string') {\n\t\t\t\tstringified = stringified.replace(/,/g, ',,');\n\t\t\t}\n\t\t\tresult += key + ',' + stringified + ',';\n\t\t}\n\t\treturn result;\n\t}\n\texport function create(value: ITaskIdentifier): KeyedTaskIdentifier {\n\t\tconst resultKey = sortedStringify(value);\n\t\tconst result = { _key: resultKey, type: value.taskType };\n\t\tObject.assign(result, value);\n\t\treturn result;\n\t}\n}\n\nexport const enum TaskSettingId {\n\tAutoDetect = 'task.autoDetect',\n\tSaveBeforeRun = 'task.saveBeforeRun',\n\tShowDecorations = 'task.showDecorations',\n\tProblemMatchersNeverPrompt = 'task.problemMatchers.neverPrompt',\n\tSlowProviderWarning = 'task.slowProviderWarning',\n\tQuickOpenHistory = 'task.quickOpen.history',\n\tQuickOpenDetail = 'task.quickOpen.detail',\n\tQuickOpenSkip = 'task.quickOpen.skip',\n\tQuickOpenShowAll = 'task.quickOpen.showAll',\n\tAllowAutomaticTasks = 'task.allowAutomaticTasks',\n\tReconnection = 'task.experimental.reconnection'\n}\n\nexport const enum TasksSchemaProperties {\n\tTasks = 'tasks',\n\tSuppressTaskName = 'tasks.suppressTaskName',\n\tWindows = 'tasks.windows',\n\tOsx = 'tasks.osx',\n\tLinux = 'tasks.linux',\n\tShowOutput = 'tasks.showOutput',\n\tIsShellCommand = 'tasks.isShellCommand',\n\tServiceTestSetting = 'tasks.service.testSetting',\n}\n\nexport namespace TaskDefinition {\n\texport function createTaskIdentifier(external: ITaskIdentifier, reporter: { error(message: string): void }): KeyedTaskIdentifier | undefined {\n\t\tconst definition = TaskDefinitionRegistry.get(external.type);\n\t\tif (definition === undefined) {\n\t\t\t// We have no task definition so we can't sanitize the literal. Take it as is\n\t\t\tconst copy = Objects.deepClone(external);\n\t\t\tdelete copy._key;\n\t\t\treturn KeyedTaskIdentifier.create(copy);\n\t\t}\n\n\t\tconst literal: { type: string;[name: string]: any } = Object.create(null);\n\t\tliteral.type = definition.taskType;\n\t\tconst required: Set<string> = new Set();\n\t\tdefinition.required.forEach(element => required.add(element));\n\n\t\tconst properties = definition.properties;\n\t\tfor (const property of Object.keys(properties)) {\n\t\t\tconst value = external[property];\n\t\t\tif (value !== undefined && value !== null) {\n\t\t\t\tliteral[property] = value;\n\t\t\t} else if (required.has(property)) {\n\t\t\t\tconst schema = properties[property];\n\t\t\t\tif (schema.default !== undefined) {\n\t\t\t\t\tliteral[property] = Objects.deepClone(schema.default);\n\t\t\t\t} else {\n\t\t\t\t\tswitch (schema.type) {\n\t\t\t\t\t\tcase 'boolean':\n\t\t\t\t\t\t\tliteral[property] = false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'number':\n\t\t\t\t\t\tcase 'integer':\n\t\t\t\t\t\t\tliteral[property] = 0;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'string':\n\t\t\t\t\t\t\tliteral[property] = '';\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\treporter.error(nls.localize(\n\t\t\t\t\t\t\t\t'TaskDefinition.missingRequiredProperty',\n\t\t\t\t\t\t\t\t'Error: the task identifier \\'{0}\\' is missing the required property \\'{1}\\'. The task identifier will be ignored.', JSON.stringify(external, undefined, 0), property\n\t\t\t\t\t\t\t));\n\t\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn KeyedTaskIdentifier.create(literal);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationError, onUnexpectedError } from 'vs/base/common/errors';\n\nexport class LazyPromise implements Promise<any> {\n\n\tprivate _actual: Promise<any> | null;\n\tprivate _actualOk: ((value?: any) => any) | null;\n\tprivate _actualErr: ((err?: any) => any) | null;\n\n\tprivate _hasValue: boolean;\n\tprivate _value: any;\n\n\tprotected _hasErr: boolean;\n\tprotected _err: any;\n\n\tconstructor() {\n\t\tthis._actual = null;\n\t\tthis._actualOk = null;\n\t\tthis._actualErr = null;\n\t\tthis._hasValue = false;\n\t\tthis._value = null;\n\t\tthis._hasErr = false;\n\t\tthis._err = null;\n\t}\n\n\tget [Symbol.toStringTag](): string {\n\t\treturn this.toString();\n\t}\n\n\tprivate _ensureActual(): Promise<any> {\n\t\tif (!this._actual) {\n\t\t\tthis._actual = new Promise<any>((c, e) => {\n\t\t\t\tthis._actualOk = c;\n\t\t\t\tthis._actualErr = e;\n\n\t\t\t\tif (this._hasValue) {\n\t\t\t\t\tthis._actualOk(this._value);\n\t\t\t\t}\n\n\t\t\t\tif (this._hasErr) {\n\t\t\t\t\tthis._actualErr(this._err);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn this._actual;\n\t}\n\n\tpublic resolveOk(value: any): void {\n\t\tif (this._hasValue || this._hasErr) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._hasValue = true;\n\t\tthis._value = value;\n\n\t\tif (this._actual) {\n\t\t\tthis._actualOk!(value);\n\t\t}\n\t}\n\n\tpublic resolveErr(err: any): void {\n\t\tif (this._hasValue || this._hasErr) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._hasErr = true;\n\t\tthis._err = err;\n\n\t\tif (this._actual) {\n\t\t\tthis._actualErr!(err);\n\t\t} else {\n\t\t\t// If nobody's listening at this point, it is safe to assume they never will,\n\t\t\t// since resolving this promise is always \"async\"\n\t\t\tonUnexpectedError(err);\n\t\t}\n\t}\n\n\tpublic then(success: any, error: any): any {\n\t\treturn this._ensureActual().then(success, error);\n\t}\n\n\tpublic catch(error: any): any {\n\t\treturn this._ensureActual().then(undefined, error);\n\t}\n\n\tpublic finally(callback: () => void): any {\n\t\treturn this._ensureActual().finally(callback);\n\t}\n}\n\nexport class CanceledLazyPromise extends LazyPromise {\n\tconstructor() {\n\t\tsuper();\n\t\tthis._hasErr = true;\n\t\tthis._err = new CancellationError();\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type { VSBuffer } from 'vs/base/common/buffer';\nimport type { CancellationToken } from 'vs/base/common/cancellation';\n\nexport interface IRPCProtocol {\n\t/**\n\t * Returns a proxy to an object addressable/named in the extension host process or in the renderer process.\n\t */\n\tgetProxy<T>(identifier: ProxyIdentifier<T>): Proxied<T>;\n\n\t/**\n\t * Register manually created instance.\n\t */\n\tset<T, R extends T>(identifier: ProxyIdentifier<T>, instance: R): R;\n\n\t/**\n\t * Assert these identifiers are already registered via `.set`.\n\t */\n\tassertRegistered(identifiers: ProxyIdentifier<any>[]): void;\n\n\t/**\n\t * Wait for the write buffer (if applicable) to become empty.\n\t */\n\tdrain(): Promise<void>;\n\n\tdispose(): void;\n}\n\nexport class ProxyIdentifier<T> {\n\tpublic static count = 0;\n\t_proxyIdentifierBrand: void = undefined;\n\n\tpublic readonly sid: string;\n\tpublic readonly nid: number;\n\n\tconstructor(sid: string) {\n\t\tthis.sid = sid;\n\t\tthis.nid = (++ProxyIdentifier.count);\n\t}\n}\n\nconst identifiers: ProxyIdentifier<any>[] = [];\n\nexport function createProxyIdentifier<T>(identifier: string): ProxyIdentifier<T> {\n\tconst result = new ProxyIdentifier<T>(identifier);\n\tidentifiers[result.nid] = result;\n\treturn result;\n}\n\n/**\n * Mapped-type that replaces all JSONable-types with their toJSON-result type\n */\nexport type Dto<T> = T extends { toJSON(): infer U }\n\t? U\n\t: T extends VSBuffer // VSBuffer is understood by rpc-logic\n\t? T\n\t: T extends CancellationToken // CancellationToken is understood by rpc-logic\n\t? T\n\t: T extends Function // functions are dropped during JSON-stringify\n\t? never\n\t: T extends object // recurse\n\t? { [k in keyof T]: Dto<T[k]>; }\n\t: T;\n\nexport type Proxied<T> = { [K in keyof T]: T[K] extends (...args: infer A) => infer R\n\t? (...args: { [K in keyof A]: Dto<A[K]> }) => Promise<Dto<Awaited<R>>>\n\t: never\n};\n\nexport function getStringIdentifierForProxy(nid: number): string {\n\treturn identifiers[nid].sid;\n}\n\n/**\n * Marks the object as containing buffers that should be serialized more efficiently.\n */\nexport class SerializableObjectWithBuffers<T> {\n\tconstructor(\n\t\tpublic readonly value: T\n\t) { }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { VSBuffer } from 'vs/base/common/buffer';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { IRemoteConsoleLog } from 'vs/base/common/console';\nimport { SerializedError } from 'vs/base/common/errors';\nimport { IRelativePattern } from 'vs/base/common/glob';\nimport { IMarkdownString } from 'vs/base/common/htmlContent';\nimport { IDisposable } from 'vs/base/common/lifecycle';\nimport { revive } from 'vs/base/common/marshalling';\nimport * as performance from 'vs/base/common/performance';\nimport Severity from 'vs/base/common/severity';\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { RenderLineNumbersType, TextEditorCursorStyle } from 'vs/editor/common/config/editorOptions';\nimport { ISingleEditOperation } from 'vs/editor/common/core/editOperation';\nimport { IPosition } from 'vs/editor/common/core/position';\nimport { IRange } from 'vs/editor/common/core/range';\nimport { ISelection, Selection } from 'vs/editor/common/core/selection';\nimport { ILineChange } from 'vs/editor/common/diff/diffComputer';\nimport * as editorCommon from 'vs/editor/common/editorCommon';\nimport * as languages from 'vs/editor/common/languages';\nimport { StandardTokenType } from 'vs/editor/common/encodedTokenAttributes';\nimport { CharacterPair, CommentRule, EnterAction } from 'vs/editor/common/languages/languageConfiguration';\nimport { EndOfLineSequence } from 'vs/editor/common/model';\nimport { IModelChangedEvent } from 'vs/editor/common/model/mirrorTextModel';\nimport { IAccessibilityInformation } from 'vs/platform/accessibility/common/accessibility';\nimport { ConfigurationTarget, IConfigurationChange, IConfigurationData, IConfigurationOverrides } from 'vs/platform/configuration/common/configuration';\nimport { ConfigurationScope } from 'vs/platform/configuration/common/configurationRegistry';\nimport { IExtensionIdWithVersion } from 'vs/platform/extensionManagement/common/extensionStorage';\nimport { ExtensionIdentifier, IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport * as files from 'vs/platform/files/common/files';\nimport { ResourceLabelFormatter } from 'vs/platform/label/common/label';\nimport { ILoggerOptions, LogLevel } from 'vs/platform/log/common/log';\nimport { IMarkerData } from 'vs/platform/markers/common/markers';\nimport { IProgressOptions, IProgressStep } from 'vs/platform/progress/common/progress';\nimport * as quickInput from 'vs/platform/quickinput/common/quickInput';\nimport { IRemoteConnectionData, TunnelDescription } from 'vs/platform/remote/common/remoteAuthorityResolver';\nimport { ClassifiedEvent, GDPRClassification, StrictPropertyCheck } from 'vs/platform/telemetry/common/gdprTypings';\nimport { TelemetryLevel } from 'vs/platform/telemetry/common/telemetry';\nimport { ICreateContributedTerminalProfileOptions, IProcessProperty, IShellLaunchConfigDto, ITerminalEnvironment, ITerminalLaunchError, ITerminalProfile, TerminalExitReason, TerminalLocation } from 'vs/platform/terminal/common/terminal';\nimport { ThemeColor, ThemeIcon } from 'vs/platform/theme/common/themeService';\nimport { ProvidedPortAttributes, TunnelCreationOptions, TunnelOptions, TunnelPrivacyId, TunnelProviderFeatures } from 'vs/platform/tunnel/common/tunnel';\nimport { WorkspaceTrustRequestOptions } from 'vs/platform/workspace/common/workspaceTrust';\nimport * as tasks from 'vs/workbench/api/common/shared/tasks';\nimport { SaveReason } from 'vs/workbench/common/editor';\nimport { IRevealOptions, ITreeItem, IViewBadge } from 'vs/workbench/common/views';\nimport { CallHierarchyItem } from 'vs/workbench/contrib/callHierarchy/common/callHierarchy';\nimport { DebugConfigurationProviderTriggerKind, IAdapterDescriptor, IConfig, IDebugSessionReplMode } from 'vs/workbench/contrib/debug/common/debug';\nimport * as notebookCommon from 'vs/workbench/contrib/notebook/common/notebookCommon';\nimport { CellExecutionUpdateType } from 'vs/workbench/contrib/notebook/common/notebookExecutionService';\nimport { ICellExecutionComplete, ICellExecutionStateUpdate } from 'vs/workbench/contrib/notebook/common/notebookExecutionStateService';\nimport { ICellRange } from 'vs/workbench/contrib/notebook/common/notebookRange';\nimport { OutputChannelUpdateMode } from 'vs/workbench/services/output/common/output';\nimport { InputValidationType } from 'vs/workbench/contrib/scm/common/scm';\nimport { IWorkspaceSymbol } from 'vs/workbench/contrib/search/common/search';\nimport { ISerializableEnvironmentVariableCollection } from 'vs/workbench/contrib/terminal/common/environmentVariable';\nimport { CoverageDetails, ExtensionRunTestsRequest, IFileCoverage, ISerializedTestResults, ITestItem, ITestMessage, ITestRunProfile, ITestRunTask, ResolvedTestRunRequest, RunTestForControllerRequest, TestResultState, TestsDiffOp } from 'vs/workbench/contrib/testing/common/testTypes';\nimport { Timeline, TimelineChangeEvent, TimelineOptions, TimelineProviderDescriptor } from 'vs/workbench/contrib/timeline/common/timeline';\nimport { TypeHierarchyItem } from 'vs/workbench/contrib/typeHierarchy/common/typeHierarchy';\nimport { AuthenticationProviderInformation, AuthenticationSession, AuthenticationSessionsChangeEvent } from 'vs/workbench/services/authentication/common/authentication';\nimport { EditorGroupColumn } from 'vs/workbench/services/editor/common/editorGroupColumn';\nimport { IExtensionDescriptionDelta, IStaticWorkspaceData } from 'vs/workbench/services/extensions/common/extensionHostProtocol';\nimport { IResolveAuthorityResult } from 'vs/workbench/services/extensions/common/extensionHostProxy';\nimport { ActivationKind, ExtensionActivationReason, MissingExtensionDependency } from 'vs/workbench/services/extensions/common/extensions';\nimport { createProxyIdentifier, Dto, IRPCProtocol, SerializableObjectWithBuffers } from 'vs/workbench/services/extensions/common/proxyIdentifier';\nimport { ILanguageStatus } from 'vs/workbench/services/languageStatus/common/languageStatusService';\nimport { CandidatePort } from 'vs/workbench/services/remote/common/remoteExplorerService';\nimport { ITextQueryBuilderOptions } from 'vs/workbench/services/search/common/queryBuilder';\nimport * as search from 'vs/workbench/services/search/common/search';\n\nexport interface IWorkspaceData extends IStaticWorkspaceData {\n\tfolders: { uri: UriComponents; name: string; index: number }[];\n}\n\nexport interface IConfigurationInitData extends IConfigurationData {\n\tconfigurationScopes: [string, ConfigurationScope | undefined][];\n}\n\nexport interface IMainContext extends IRPCProtocol {\n}\n\n// --- main thread\n\nexport interface MainThreadClipboardShape extends IDisposable {\n\t$readText(): Promise<string>;\n\t$writeText(value: string): Promise<void>;\n}\n\nexport interface MainThreadCommandsShape extends IDisposable {\n\t$registerCommand(id: string): void;\n\t$unregisterCommand(id: string): void;\n\t$fireCommandActivationEvent(id: string): void;\n\t$executeCommand(id: string, args: any[] | SerializableObjectWithBuffers<any[]>, retry: boolean): Promise<unknown | undefined>;\n\t$getCommands(): Promise<string[]>;\n}\n\nexport interface CommentProviderFeatures {\n\treactionGroup?: languages.CommentReaction[];\n\treactionHandler?: boolean;\n\toptions?: languages.CommentOptions;\n}\n\nexport interface CommentChanges {\n\treadonly uniqueIdInThread: number;\n\treadonly body: string | IMarkdownString;\n\treadonly userName: string;\n\treadonly userIconPath?: string;\n\treadonly contextValue?: string;\n\treadonly commentReactions?: languages.CommentReaction[];\n\treadonly label?: string;\n\treadonly mode?: languages.CommentMode;\n\treadonly timestamp?: string;\n}\n\nexport type CommentThreadChanges<T = IRange> = Partial<{\n\trange: T;\n\tlabel: string;\n\tcontextValue: string | null;\n\tcomments: CommentChanges[];\n\tcollapseState: languages.CommentThreadCollapsibleState;\n\tcanReply: boolean;\n\tstate: languages.CommentThreadState;\n\tisTemplate: boolean;\n}>;\n\nexport interface MainThreadCommentsShape extends IDisposable {\n\t$registerCommentController(handle: number, id: string, label: string): void;\n\t$unregisterCommentController(handle: number): void;\n\t$updateCommentControllerFeatures(handle: number, features: CommentProviderFeatures): void;\n\t$createCommentThread(handle: number, commentThreadHandle: number, threadId: string, resource: UriComponents, range: IRange | ICellRange, extensionId: ExtensionIdentifier, isTemplate: boolean): languages.CommentThread<IRange | ICellRange> | undefined;\n\t$updateCommentThread(handle: number, commentThreadHandle: number, threadId: string, resource: UriComponents, changes: CommentThreadChanges): void;\n\t$deleteCommentThread(handle: number, commentThreadHandle: number): void;\n\t$updateCommentingRanges(handle: number): void;\n}\n\nexport interface MainThreadAuthenticationShape extends IDisposable {\n\t$registerAuthenticationProvider(id: string, label: string, supportsMultipleAccounts: boolean): void;\n\t$unregisterAuthenticationProvider(id: string): void;\n\t$ensureProvider(id: string): Promise<void>;\n\t$sendDidChangeSessions(providerId: string, event: AuthenticationSessionsChangeEvent): void;\n\t$getSession(providerId: string, scopes: readonly string[], extensionId: string, extensionName: string, options: { createIfNone?: boolean; forceNewSession?: boolean | { detail: string }; clearSessionPreference?: boolean }): Promise<AuthenticationSession | undefined>;\n\t$removeSession(providerId: string, sessionId: string): Promise<void>;\n}\n\nexport interface MainThreadSecretStateShape extends IDisposable {\n\t$getPassword(extensionId: string, key: string): Promise<string | undefined>;\n\t$setPassword(extensionId: string, key: string, value: string): Promise<void>;\n\t$deletePassword(extensionId: string, key: string): Promise<void>;\n}\n\nexport interface MainThreadConfigurationShape extends IDisposable {\n\t$updateConfigurationOption(target: ConfigurationTarget | null, key: string, value: any, overrides: IConfigurationOverrides | undefined, scopeToLanguage: boolean | undefined): Promise<void>;\n\t$removeConfigurationOption(target: ConfigurationTarget | null, key: string, overrides: IConfigurationOverrides | undefined, scopeToLanguage: boolean | undefined): Promise<void>;\n}\n\nexport interface MainThreadDiagnosticsShape extends IDisposable {\n\t$changeMany(owner: string, entries: [UriComponents, IMarkerData[] | undefined][]): void;\n\t$clear(owner: string): void;\n}\n\nexport interface MainThreadDialogOpenOptions {\n\tdefaultUri?: UriComponents;\n\topenLabel?: string;\n\tcanSelectFiles?: boolean;\n\tcanSelectFolders?: boolean;\n\tcanSelectMany?: boolean;\n\tfilters?: { [name: string]: string[] };\n\ttitle?: string;\n}\n\nexport interface MainThreadDialogSaveOptions {\n\tdefaultUri?: UriComponents;\n\tsaveLabel?: string;\n\tfilters?: { [name: string]: string[] };\n\ttitle?: string;\n}\n\nexport interface MainThreadDiaglogsShape extends IDisposable {\n\t$showOpenDialog(options?: MainThreadDialogOpenOptions): Promise<UriComponents[] | undefined>;\n\t$showSaveDialog(options?: MainThreadDialogSaveOptions): Promise<UriComponents | undefined>;\n}\n\nexport interface MainThreadDecorationsShape extends IDisposable {\n\t$registerDecorationProvider(handle: number, label: string): void;\n\t$unregisterDecorationProvider(handle: number): void;\n\t$onDidChange(handle: number, resources: UriComponents[] | null): void;\n}\n\nexport interface MainThreadDocumentContentProvidersShape extends IDisposable {\n\t$registerTextContentProvider(handle: number, scheme: string): void;\n\t$unregisterTextContentProvider(handle: number): void;\n\t$onVirtualDocumentChange(uri: UriComponents, value: string): void;\n}\n\nexport interface MainThreadDocumentsShape extends IDisposable {\n\t$tryCreateDocument(options?: { language?: string; content?: string }): Promise<UriComponents>;\n\t$tryOpenDocument(uri: UriComponents): Promise<UriComponents>;\n\t$trySaveDocument(uri: UriComponents): Promise<boolean>;\n}\n\nexport interface ITextEditorConfigurationUpdate {\n\ttabSize?: number | 'auto';\n\tinsertSpaces?: boolean | 'auto';\n\tcursorStyle?: TextEditorCursorStyle;\n\tlineNumbers?: RenderLineNumbersType;\n}\n\nexport interface IResolvedTextEditorConfiguration {\n\ttabSize: number;\n\tinsertSpaces: boolean;\n\tcursorStyle: TextEditorCursorStyle;\n\tlineNumbers: RenderLineNumbersType;\n}\n\nexport enum TextEditorRevealType {\n\tDefault = 0,\n\tInCenter = 1,\n\tInCenterIfOutsideViewport = 2,\n\tAtTop = 3\n}\n\nexport interface IUndoStopOptions {\n\tundoStopBefore: boolean;\n\tundoStopAfter: boolean;\n}\n\nexport interface IApplyEditsOptions extends IUndoStopOptions {\n\tsetEndOfLine?: EndOfLineSequence;\n}\n\nexport interface ITextDocumentShowOptions {\n\tposition?: EditorGroupColumn;\n\tpreserveFocus?: boolean;\n\tpinned?: boolean;\n\tselection?: IRange;\n}\n\nexport interface MainThreadBulkEditsShape extends IDisposable {\n\t$tryApplyWorkspaceEdit(workspaceEditDto: IWorkspaceEditDto, undoRedoGroupId?: number): Promise<boolean>;\n}\n\nexport interface MainThreadTextEditorsShape extends IDisposable {\n\t$tryShowTextDocument(resource: UriComponents, options: ITextDocumentShowOptions): Promise<string | undefined>;\n\t$registerTextEditorDecorationType(extensionId: ExtensionIdentifier, key: string, options: editorCommon.IDecorationRenderOptions): void;\n\t$removeTextEditorDecorationType(key: string): void;\n\t$tryShowEditor(id: string, position: EditorGroupColumn): Promise<void>;\n\t$tryHideEditor(id: string): Promise<void>;\n\t$trySetOptions(id: string, options: ITextEditorConfigurationUpdate): Promise<void>;\n\t$trySetDecorations(id: string, key: string, ranges: editorCommon.IDecorationOptions[]): Promise<void>;\n\t$trySetDecorationsFast(id: string, key: string, ranges: number[]): Promise<void>;\n\t$tryRevealRange(id: string, range: IRange, revealType: TextEditorRevealType): Promise<void>;\n\t$trySetSelections(id: string, selections: ISelection[]): Promise<void>;\n\t$tryApplyEdits(id: string, modelVersionId: number, edits: ISingleEditOperation[], opts: IApplyEditsOptions): Promise<boolean>;\n\t$tryInsertSnippet(id: string, modelVersionId: number, template: string, selections: readonly IRange[], opts: IUndoStopOptions): Promise<boolean>;\n\t$getDiffInformation(id: string): Promise<ILineChange[]>;\n}\n\nexport interface MainThreadTreeViewsShape extends IDisposable {\n\t$registerTreeViewDataProvider(treeViewId: string, options: { showCollapseAll: boolean; canSelectMany: boolean; dropMimeTypes: readonly string[]; dragMimeTypes: readonly string[]; hasHandleDrag: boolean; hasHandleDrop: boolean }): Promise<void>;\n\t$refresh(treeViewId: string, itemsToRefresh?: { [treeItemHandle: string]: ITreeItem }): Promise<void>;\n\t$reveal(treeViewId: string, itemInfo: { item: ITreeItem; parentChain: ITreeItem[] } | undefined, options: IRevealOptions): Promise<void>;\n\t$setMessage(treeViewId: string, message: string): void;\n\t$setTitle(treeViewId: string, title: string, description: string | undefined): void;\n\t$setBadge(treeViewId: string, badge: IViewBadge | undefined): void;\n\t$resolveDropFileData(destinationViewId: string, requestId: number, dataItemIndex: number): Promise<VSBuffer>;\n}\n\nexport interface MainThreadDownloadServiceShape extends IDisposable {\n\t$download(uri: UriComponents, to: UriComponents): Promise<void>;\n}\n\nexport interface MainThreadErrorsShape extends IDisposable {\n\t$onUnexpectedError(err: any | SerializedError): void;\n}\n\nexport interface MainThreadConsoleShape extends IDisposable {\n\t$logExtensionHostMessage(msg: IRemoteConsoleLog): void;\n}\n\nexport interface MainThreadKeytarShape extends IDisposable {\n\t$getPassword(service: string, account: string): Promise<string | null>;\n\t$setPassword(service: string, account: string, password: string): Promise<void>;\n\t$deletePassword(service: string, account: string): Promise<boolean>;\n\t$findPassword(service: string): Promise<string | null>;\n\t$findCredentials(service: string): Promise<Array<{ account: string; password: string }>>;\n}\n\nexport interface IRegExpDto {\n\tpattern: string;\n\tflags?: string;\n}\nexport interface IIndentationRuleDto {\n\tdecreaseIndentPattern: IRegExpDto;\n\tincreaseIndentPattern: IRegExpDto;\n\tindentNextLinePattern?: IRegExpDto;\n\tunIndentedLinePattern?: IRegExpDto;\n}\nexport interface IOnEnterRuleDto {\n\tbeforeText: IRegExpDto;\n\tafterText?: IRegExpDto;\n\tpreviousLineText?: IRegExpDto;\n\taction: EnterAction;\n}\nexport interface ILanguageConfigurationDto {\n\tcomments?: CommentRule;\n\tbrackets?: CharacterPair[];\n\twordPattern?: IRegExpDto;\n\tindentationRules?: IIndentationRuleDto;\n\tonEnterRules?: IOnEnterRuleDto[];\n\t__electricCharacterSupport?: {\n\t\tbrackets?: any;\n\t\tdocComment?: {\n\t\t\tscope: string;\n\t\t\topen: string;\n\t\t\tlineStart: string;\n\t\t\tclose?: string;\n\t\t};\n\t};\n\t__characterPairSupport?: {\n\t\tautoClosingPairs: {\n\t\t\topen: string;\n\t\t\tclose: string;\n\t\t\tnotIn?: string[];\n\t\t}[];\n\t};\n}\n\nexport type GlobPattern = string | IRelativePattern;\n\nexport interface IRelativePatternDto extends IRelativePattern {\n\tbaseUri: UriComponents;\n}\n\nexport interface IDocumentFilterDto {\n\t$serialized: true;\n\tlanguage?: string;\n\tscheme?: string;\n\tpattern?: string | IRelativePattern;\n\texclusive?: boolean;\n\tnotebookType?: string;\n}\n\nexport interface ISignatureHelpProviderMetadataDto {\n\treadonly triggerCharacters: readonly string[];\n\treadonly retriggerCharacters: readonly string[];\n}\n\nexport interface IdentifiableInlineCompletions extends languages.InlineCompletions<IdentifiableInlineCompletion> {\n\tpid: number;\n}\n\nexport interface IdentifiableInlineCompletion extends languages.InlineCompletion {\n\tidx: number;\n}\n\nexport interface MainThreadLanguageFeaturesShape extends IDisposable {\n\t$unregister(handle: number): void;\n\t$registerDocumentSymbolProvider(handle: number, selector: IDocumentFilterDto[], label: string): void;\n\t$registerCodeLensSupport(handle: number, selector: IDocumentFilterDto[], eventHandle: number | undefined): void;\n\t$emitCodeLensEvent(eventHandle: number, event?: any): void;\n\t$registerDefinitionSupport(handle: number, selector: IDocumentFilterDto[]): void;\n\t$registerDeclarationSupport(handle: number, selector: IDocumentFilterDto[]): void;\n\t$registerImplementationSupport(handle: number, selector: IDocumentFilterDto[]): void;\n\t$registerTypeDefinitionSupport(handle: number, selector: IDocumentFilterDto[]): void;\n\t$registerHoverProvider(handle: number, selector: IDocumentFilterDto[]): void;\n\t$registerEvaluatableExpressionProvider(handle: number, selector: IDocumentFilterDto[]): void;\n\t$registerInlineValuesProvider(handle: number, selector: IDocumentFilterDto[], eventHandle: number | undefined): void;\n\t$emitInlineValuesEvent(eventHandle: number, event?: any): void;\n\t$registerDocumentHighlightProvider(handle: number, selector: IDocumentFilterDto[]): void;\n\t$registerLinkedEditingRangeProvider(handle: number, selector: IDocumentFilterDto[]): void;\n\t$registerReferenceSupport(handle: number, selector: IDocumentFilterDto[]): void;\n\t$registerQuickFixSupport(handle: number, selector: IDocumentFilterDto[], metadata: ICodeActionProviderMetadataDto, displayName: string, supportsResolve: boolean): void;\n\t$registerPasteEditProvider(handle: number, selector: IDocumentFilterDto[], supportsCopy: boolean, pasteMimeTypes: readonly string[]): void;\n\t$registerDocumentFormattingSupport(handle: number, selector: IDocumentFilterDto[], extensionId: ExtensionIdentifier, displayName: string): void;\n\t$registerRangeFormattingSupport(handle: number, selector: IDocumentFilterDto[], extensionId: ExtensionIdentifier, displayName: string): void;\n\t$registerOnTypeFormattingSupport(handle: number, selector: IDocumentFilterDto[], autoFormatTriggerCharacters: string[], extensionId: ExtensionIdentifier): void;\n\t$registerNavigateTypeSupport(handle: number, supportsResolve: boolean): void;\n\t$registerRenameSupport(handle: number, selector: IDocumentFilterDto[], supportsResolveInitialValues: boolean): void;\n\t$registerDocumentSemanticTokensProvider(handle: number, selector: IDocumentFilterDto[], legend: languages.SemanticTokensLegend, eventHandle: number | undefined): void;\n\t$emitDocumentSemanticTokensEvent(eventHandle: number): void;\n\t$registerDocumentRangeSemanticTokensProvider(handle: number, selector: IDocumentFilterDto[], legend: languages.SemanticTokensLegend): void;\n\t$registerCompletionsProvider(handle: number, selector: IDocumentFilterDto[], triggerCharacters: string[], supportsResolveDetails: boolean, displayName: string): void;\n\t$registerInlineCompletionsSupport(handle: number, selector: IDocumentFilterDto[], supportsHandleDidShowCompletionItem: boolean): void;\n\t$registerSignatureHelpProvider(handle: number, selector: IDocumentFilterDto[], metadata: ISignatureHelpProviderMetadataDto): void;\n\t$registerInlayHintsProvider(handle: number, selector: IDocumentFilterDto[], supportsResolve: boolean, eventHandle: number | undefined, displayName: string | undefined): void;\n\t$emitInlayHintsEvent(eventHandle: number): void;\n\t$registerDocumentLinkProvider(handle: number, selector: IDocumentFilterDto[], supportsResolve: boolean): void;\n\t$registerDocumentColorProvider(handle: number, selector: IDocumentFilterDto[]): void;\n\t$registerFoldingRangeProvider(handle: number, selector: IDocumentFilterDto[], eventHandle: number | undefined): void;\n\t$emitFoldingRangeEvent(eventHandle: number, event?: any): void;\n\t$registerSelectionRangeProvider(handle: number, selector: IDocumentFilterDto[]): void;\n\t$registerCallHierarchyProvider(handle: number, selector: IDocumentFilterDto[]): void;\n\t$registerTypeHierarchyProvider(handle: number, selector: IDocumentFilterDto[]): void;\n\t$registerDocumentOnDropEditProvider(handle: number, selector: IDocumentFilterDto[]): void;\n\t$resolvePasteFileData(handle: number, requestId: number, dataIndex: number): Promise<VSBuffer>;\n\t$resolveDocumentOnDropFileData(handle: number, requestId: number, dataIndex: number): Promise<VSBuffer>;\n\t$setLanguageConfiguration(handle: number, languageId: string, configuration: ILanguageConfigurationDto): void;\n}\n\nexport interface MainThreadLanguagesShape extends IDisposable {\n\t$changeLanguage(resource: UriComponents, languageId: string): Promise<void>;\n\t$tokensAtPosition(resource: UriComponents, position: IPosition): Promise<undefined | { type: StandardTokenType; range: IRange }>;\n\t$setLanguageStatus(handle: number, status: ILanguageStatus): void;\n\t$removeLanguageStatus(handle: number): void;\n}\n\nexport interface MainThreadMessageOptions {\n\tsource?: { identifier: ExtensionIdentifier; label: string };\n\tmodal?: boolean;\n\tdetail?: string;\n\tuseCustom?: boolean;\n}\n\nexport interface MainThreadMessageServiceShape extends IDisposable {\n\t$showMessage(severity: Severity, message: string, options: MainThreadMessageOptions, commands: { title: string; isCloseAffordance: boolean; handle: number }[]): Promise<number | undefined>;\n}\n\nexport interface MainThreadOutputServiceShape extends IDisposable {\n\t$register(label: string, log: boolean, file: UriComponents, languageId: string | undefined, extensionId: string): Promise<string>;\n\t$update(channelId: string, mode: OutputChannelUpdateMode, till?: number): Promise<void>;\n\t$reveal(channelId: string, preserveFocus: boolean): Promise<void>;\n\t$close(channelId: string): Promise<void>;\n\t$dispose(channelId: string): Promise<void>;\n}\n\nexport interface MainThreadProgressShape extends IDisposable {\n\n\t$startProgress(handle: number, options: IProgressOptions, extensionId?: string): Promise<void>;\n\t$progressReport(handle: number, message: IProgressStep): void;\n\t$progressEnd(handle: number): void;\n}\n\n/**\n * A terminal that is created on the extension host side is temporarily assigned\n * a UUID by the extension host that created it. Once the renderer side has assigned\n * a real numeric id, the numeric id will be used.\n *\n * All other terminals (that are not created on the extension host side) always\n * use the numeric id.\n */\nexport type ExtHostTerminalIdentifier = number | string;\n\nexport interface TerminalLaunchConfig {\n\tname?: string;\n\tshellPath?: string;\n\tshellArgs?: string[] | string;\n\tcwd?: string | UriComponents;\n\tenv?: ITerminalEnvironment;\n\ticon?: URI | { light: URI; dark: URI } | ThemeIcon;\n\tcolor?: string;\n\tinitialText?: string;\n\twaitOnExit?: boolean;\n\tstrictEnv?: boolean;\n\thideFromUser?: boolean;\n\tisExtensionCustomPtyTerminal?: boolean;\n\tisFeatureTerminal?: boolean;\n\tisExtensionOwnedTerminal?: boolean;\n\tuseShellEnvironment?: boolean;\n\tlocation?: TerminalLocation | { viewColumn: number; preserveFocus?: boolean } | { parentTerminal: ExtHostTerminalIdentifier } | { splitActiveTerminal: boolean };\n\tisTransient?: boolean;\n}\n\nexport interface MainThreadTerminalServiceShape extends IDisposable {\n\t$createTerminal(extHostTerminalId: string, config: TerminalLaunchConfig): Promise<void>;\n\t$dispose(id: ExtHostTerminalIdentifier): void;\n\t$hide(id: ExtHostTerminalIdentifier): void;\n\t$sendText(id: ExtHostTerminalIdentifier, text: string, addNewLine: boolean): void;\n\t$show(id: ExtHostTerminalIdentifier, preserveFocus: boolean): void;\n\t$startSendingDataEvents(): void;\n\t$stopSendingDataEvents(): void;\n\t$startLinkProvider(): void;\n\t$stopLinkProvider(): void;\n\t$registerProcessSupport(isSupported: boolean): void;\n\t$registerProfileProvider(id: string, extensionIdentifier: string): void;\n\t$unregisterProfileProvider(id: string): void;\n\t$setEnvironmentVariableCollection(extensionIdentifier: string, persistent: boolean, collection: ISerializableEnvironmentVariableCollection | undefined): void;\n\n\t// Process\n\t$sendProcessData(terminalId: number, data: string): void;\n\t$sendProcessReady(terminalId: number, pid: number, cwd: string): void;\n\t$sendProcessProperty(terminalId: number, property: IProcessProperty<any>): void;\n\t$sendProcessExit(terminalId: number, exitCode: number | undefined): void;\n}\n\nexport type TransferQuickPickItemOrSeparator = TransferQuickPickItem | quickInput.IQuickPickSeparator;\nexport interface TransferQuickPickItem {\n\thandle: number;\n\n\t// shared properties from IQuickPickItem\n\ttype?: 'item';\n\tlabel: string;\n\tdescription?: string;\n\tdetail?: string;\n\tpicked?: boolean;\n\talwaysShow?: boolean;\n\tbuttons?: TransferQuickInputButton[];\n}\n\nexport interface TransferQuickInputButton extends quickInput.IQuickInputButton {\n\thandle: number;\n}\n\nexport type TransferQuickInput = TransferQuickPick | TransferInputBox;\n\nexport interface BaseTransferQuickInput {\n\n\t[key: string]: any;\n\n\tid: number;\n\n\ttitle?: string;\n\n\ttype?: 'quickPick' | 'inputBox';\n\n\tenabled?: boolean;\n\n\tbusy?: boolean;\n\n\tvisible?: boolean;\n}\n\nexport interface TransferQuickPick extends BaseTransferQuickInput {\n\n\ttype?: 'quickPick';\n\n\tvalue?: string;\n\n\tplaceholder?: string;\n\n\tbuttons?: TransferQuickInputButton[];\n\n\titems?: TransferQuickPickItemOrSeparator[];\n\n\tactiveItems?: number[];\n\n\tselectedItems?: number[];\n\n\tcanSelectMany?: boolean;\n\n\tignoreFocusOut?: boolean;\n\n\tmatchOnDescription?: boolean;\n\n\tmatchOnDetail?: boolean;\n\n\tsortByLabel?: boolean;\n}\n\nexport interface TransferInputBox extends BaseTransferQuickInput {\n\n\ttype?: 'inputBox';\n\n\tvalue?: string;\n\n\tplaceholder?: string;\n\n\tpassword?: boolean;\n\n\tbuttons?: TransferQuickInputButton[];\n\n\tprompt?: string;\n\n\tvalidationMessage?: string;\n}\n\nexport interface IInputBoxOptions {\n\ttitle?: string;\n\tvalue?: string;\n\tvalueSelection?: [number, number];\n\tprompt?: string;\n\tplaceHolder?: string;\n\tpassword?: boolean;\n\tignoreFocusOut?: boolean;\n}\n\nexport interface MainThreadQuickOpenShape extends IDisposable {\n\t$show(instance: number, options: quickInput.IPickOptions<TransferQuickPickItem>, token: CancellationToken): Promise<number | number[] | undefined>;\n\t$setItems(instance: number, items: TransferQuickPickItemOrSeparator[]): Promise<void>;\n\t$setError(instance: number, error: Error): Promise<void>;\n\t$input(options: IInputBoxOptions | undefined, validateInput: boolean, token: CancellationToken): Promise<string | undefined>;\n\t$createOrUpdate(params: TransferQuickInput): Promise<void>;\n\t$dispose(id: number): Promise<void>;\n}\n\nexport interface MainThreadStatusBarShape extends IDisposable {\n\t$setEntry(id: number, statusId: string, statusName: string, text: string, tooltip: IMarkdownString | string | undefined, command: ICommandDto | undefined, color: string | ThemeColor | undefined, backgroundColor: string | ThemeColor | undefined, alignLeft: boolean, priority: number | undefined, accessibilityInformation: IAccessibilityInformation | undefined): void;\n\t$dispose(id: number): void;\n}\n\nexport interface MainThreadStorageShape extends IDisposable {\n\t$initializeExtensionStorage(shared: boolean, extensionId: string): Promise<object | undefined>;\n\t$setValue(shared: boolean, extensionId: string, value: object): Promise<void>;\n\t$registerExtensionStorageKeysToSync(extension: IExtensionIdWithVersion, keys: string[]): void;\n}\n\nexport interface MainThreadTelemetryShape extends IDisposable {\n\t$publicLog(eventName: string, data?: any): void;\n\t$publicLog2<E extends ClassifiedEvent<T> = never, T extends GDPRClassification<T> = never>(eventName: string, data?: StrictPropertyCheck<T, E>): void;\n}\n\nexport interface MainThreadEditorInsetsShape extends IDisposable {\n\t$createEditorInset(handle: number, id: string, uri: UriComponents, line: number, height: number, options: IWebviewContentOptions, extensionId: ExtensionIdentifier, extensionLocation: UriComponents): Promise<void>;\n\t$disposeEditorInset(handle: number): void;\n\n\t$setHtml(handle: number, value: string): void;\n\t$setOptions(handle: number, options: IWebviewContentOptions): void;\n\t$postMessage(handle: number, value: any): Promise<boolean>;\n}\n\nexport interface ExtHostEditorInsetsShape {\n\t$onDidDispose(handle: number): void;\n\t$onDidReceiveMessage(handle: number, message: any): void;\n}\n\n//#region --- tabs model\n\nexport const enum TabInputKind {\n\tUnknownInput,\n\tTextInput,\n\tTextDiffInput,\n\tTextMergeInput,\n\tNotebookInput,\n\tNotebookDiffInput,\n\tCustomEditorInput,\n\tWebviewEditorInput,\n\tTerminalEditorInput,\n\tInteractiveEditorInput,\n}\n\nexport const enum TabModelOperationKind {\n\tTAB_OPEN,\n\tTAB_CLOSE,\n\tTAB_UPDATE,\n\tTAB_MOVE\n}\n\nexport interface UnknownInputDto {\n\tkind: TabInputKind.UnknownInput;\n}\n\nexport interface TextInputDto {\n\tkind: TabInputKind.TextInput;\n\turi: UriComponents;\n}\n\nexport interface TextDiffInputDto {\n\tkind: TabInputKind.TextDiffInput;\n\toriginal: UriComponents;\n\tmodified: UriComponents;\n}\n\nexport interface TextMergeInputDto {\n\tkind: TabInputKind.TextMergeInput;\n\tbase: UriComponents;\n\tinput1: UriComponents;\n\tinput2: UriComponents;\n\tresult: UriComponents;\n}\n\nexport interface NotebookInputDto {\n\tkind: TabInputKind.NotebookInput;\n\tnotebookType: string;\n\turi: UriComponents;\n}\n\nexport interface NotebookDiffInputDto {\n\tkind: TabInputKind.NotebookDiffInput;\n\tnotebookType: string;\n\toriginal: UriComponents;\n\tmodified: UriComponents;\n}\n\nexport interface CustomInputDto {\n\tkind: TabInputKind.CustomEditorInput;\n\tviewType: string;\n\turi: UriComponents;\n}\n\nexport interface WebviewInputDto {\n\tkind: TabInputKind.WebviewEditorInput;\n\tviewType: string;\n}\n\nexport interface InteractiveEditorInputDto {\n\tkind: TabInputKind.InteractiveEditorInput;\n\turi: UriComponents;\n\tinputBoxUri: UriComponents;\n}\n\nexport interface TabInputDto {\n\tkind: TabInputKind.TerminalEditorInput;\n}\n\nexport type AnyInputDto = UnknownInputDto | TextInputDto | TextDiffInputDto | TextMergeInputDto | NotebookInputDto | NotebookDiffInputDto | CustomInputDto | WebviewInputDto | InteractiveEditorInputDto | TabInputDto;\n\nexport interface MainThreadEditorTabsShape extends IDisposable {\n\t// manage tabs: move, close, rearrange etc\n\t$moveTab(tabId: string, index: number, viewColumn: EditorGroupColumn, preserveFocus?: boolean): void;\n\t$closeTab(tabIds: string[], preserveFocus?: boolean): Promise<boolean>;\n\t$closeGroup(groupIds: number[], preservceFocus?: boolean): Promise<boolean>;\n}\n\nexport interface IEditorTabGroupDto {\n\tisActive: boolean;\n\tviewColumn: EditorGroupColumn;\n\t// Decided not to go with simple index here due to opening and closing causing index shifts\n\t// This allows us to patch the model without having to do full rebuilds\n\ttabs: IEditorTabDto[];\n\tgroupId: number;\n}\n\nexport interface TabOperation {\n\treadonly kind: TabModelOperationKind.TAB_OPEN | TabModelOperationKind.TAB_CLOSE | TabModelOperationKind.TAB_UPDATE | TabModelOperationKind.TAB_MOVE;\n\t// TODO @lramos15 Possibly get rid of index for tab update, it's only needed for open and close\n\treadonly index: number;\n\treadonly tabDto: IEditorTabDto;\n\treadonly groupId: number;\n\treadonly oldIndex?: number;\n}\n\nexport interface IEditorTabDto {\n\tid: string;\n\tlabel: string;\n\tinput: AnyInputDto;\n\teditorId?: string;\n\tisActive: boolean;\n\tisPinned: boolean;\n\tisPreview: boolean;\n\tisDirty: boolean;\n}\n\nexport interface IExtHostEditorTabsShape {\n\t// Accepts a whole new model\n\t$acceptEditorTabModel(tabGroups: IEditorTabGroupDto[]): void;\n\t// Only when group property changes (not the tabs inside)\n\t$acceptTabGroupUpdate(groupDto: IEditorTabGroupDto): void;\n\t// When a tab is added, removed, or updated\n\t$acceptTabOperation(operation: TabOperation): void;\n}\n\n//#endregion\n\nexport type WebviewHandle = string;\n\nexport interface WebviewPanelShowOptions {\n\treadonly viewColumn?: EditorGroupColumn;\n\treadonly preserveFocus?: boolean;\n}\n\nexport interface WebviewExtensionDescription {\n\treadonly id: ExtensionIdentifier;\n\treadonly location: UriComponents;\n}\n\nexport enum WebviewEditorCapabilities {\n\tEditable,\n\tSupportsHotExit,\n}\n\nexport interface IWebviewPortMapping {\n\treadonly webviewPort: number;\n\treadonly extensionHostPort: number;\n}\n\nexport interface IWebviewContentOptions {\n\treadonly enableScripts?: boolean;\n\treadonly enableForms?: boolean;\n\treadonly enableCommandUris?: boolean;\n\treadonly localResourceRoots?: readonly UriComponents[];\n\treadonly portMapping?: readonly IWebviewPortMapping[];\n}\n\nexport interface IWebviewPanelOptions {\n\treadonly enableFindWidget?: boolean;\n\treadonly retainContextWhenHidden?: boolean;\n}\n\nexport interface CustomTextEditorCapabilities {\n\treadonly supportsMove?: boolean;\n}\n\nexport const enum WebviewMessageArrayBufferViewType {\n\tInt8Array = 1,\n\tUint8Array = 2,\n\tUint8ClampedArray = 3,\n\tInt16Array = 4,\n\tUint16Array = 5,\n\tInt32Array = 6,\n\tUint32Array = 7,\n\tFloat32Array = 8,\n\tFloat64Array = 9,\n\tBigInt64Array = 10,\n\tBigUint64Array = 11,\n}\n\nexport interface WebviewMessageArrayBufferReference {\n\treadonly $$vscode_array_buffer_reference$$: true;\n\n\treadonly index: number;\n\n\t/**\n\t * Tracks if the reference is to a view instead of directly to an ArrayBuffer.\n\t */\n\treadonly view?: {\n\t\treadonly type: WebviewMessageArrayBufferViewType;\n\t\treadonly byteLength: number;\n\t\treadonly byteOffset: number;\n\t};\n}\n\nexport interface MainThreadWebviewsShape extends IDisposable {\n\t$setHtml(handle: WebviewHandle, value: string): void;\n\t$setOptions(handle: WebviewHandle, options: IWebviewContentOptions): void;\n\t$postMessage(handle: WebviewHandle, value: string, ...buffers: VSBuffer[]): Promise<boolean>;\n}\n\nexport interface IWebviewIconPath {\n\treadonly light: UriComponents;\n\treadonly dark: UriComponents;\n}\n\nexport interface IWebviewInitData {\n\treadonly title: string;\n\treadonly webviewOptions: IWebviewContentOptions;\n\treadonly panelOptions: IWebviewPanelOptions;\n\treadonly serializeBuffersForPostMessage: boolean;\n}\n\nexport interface MainThreadWebviewPanelsShape extends IDisposable {\n\t$createWebviewPanel(\n\t\textension: WebviewExtensionDescription,\n\t\thandle: WebviewHandle,\n\t\tviewType: string,\n\t\tinitData: IWebviewInitData,\n\t\tshowOptions: WebviewPanelShowOptions,\n\t): void;\n\t$disposeWebview(handle: WebviewHandle): void;\n\t$reveal(handle: WebviewHandle, showOptions: WebviewPanelShowOptions): void;\n\t$setTitle(handle: WebviewHandle, value: string): void;\n\t$setIconPath(handle: WebviewHandle, value: IWebviewIconPath | undefined): void;\n\n\t$registerSerializer(viewType: string, options: { serializeBuffersForPostMessage: boolean }): void;\n\t$unregisterSerializer(viewType: string): void;\n}\n\nexport interface MainThreadCustomEditorsShape extends IDisposable {\n\t$registerTextEditorProvider(extension: WebviewExtensionDescription, viewType: string, options: IWebviewPanelOptions, capabilities: CustomTextEditorCapabilities, serializeBuffersForPostMessage: boolean): void;\n\t$registerCustomEditorProvider(extension: WebviewExtensionDescription, viewType: string, options: IWebviewPanelOptions, supportsMultipleEditorsPerDocument: boolean, serializeBuffersForPostMessage: boolean): void;\n\t$unregisterEditorProvider(viewType: string): void;\n\n\t$onDidEdit(resource: UriComponents, viewType: string, editId: number, label: string | undefined): void;\n\t$onContentChange(resource: UriComponents, viewType: string): void;\n}\n\nexport interface MainThreadWebviewViewsShape extends IDisposable {\n\t$registerWebviewViewProvider(extension: WebviewExtensionDescription, viewType: string, options: { retainContextWhenHidden?: boolean; serializeBuffersForPostMessage: boolean }): void;\n\t$unregisterWebviewViewProvider(viewType: string): void;\n\n\t$setWebviewViewTitle(handle: WebviewHandle, value: string | undefined): void;\n\t$setWebviewViewDescription(handle: WebviewHandle, value: string | undefined): void;\n\t$setWebviewViewBadge(handle: WebviewHandle, badge: IViewBadge | undefined): void;\n\n\t$show(handle: WebviewHandle, preserveFocus: boolean): void;\n}\n\nexport interface WebviewPanelViewStateData {\n\t[handle: string]: {\n\t\treadonly active: boolean;\n\t\treadonly visible: boolean;\n\t\treadonly position: EditorGroupColumn;\n\t};\n}\n\nexport interface ExtHostWebviewsShape {\n\t$onMessage(handle: WebviewHandle, jsonSerializedMessage: string, buffers: SerializableObjectWithBuffers<VSBuffer[]>): void;\n\t$onMissingCsp(handle: WebviewHandle, extensionId: string): void;\n}\n\nexport interface ExtHostWebviewPanelsShape {\n\t$onDidChangeWebviewPanelViewStates(newState: WebviewPanelViewStateData): void;\n\t$onDidDisposeWebviewPanel(handle: WebviewHandle): Promise<void>;\n\t$deserializeWebviewPanel(\n\t\tnewWebviewHandle: WebviewHandle,\n\t\tviewType: string,\n\t\tinitData: {\n\t\t\ttitle: string;\n\t\t\tstate: any;\n\t\t\twebviewOptions: IWebviewContentOptions;\n\t\t\tpanelOptions: IWebviewPanelOptions;\n\t\t\tactive: boolean;\n\t\t},\n\t\tposition: EditorGroupColumn,\n\t): Promise<void>;\n}\n\nexport interface ExtHostCustomEditorsShape {\n\t$resolveWebviewEditor(\n\t\tresource: UriComponents,\n\t\tnewWebviewHandle: WebviewHandle,\n\t\tviewType: string,\n\t\tinitData: {\n\t\t\ttitle: string;\n\t\t\twebviewOptions: IWebviewContentOptions;\n\t\t\tpanelOptions: IWebviewPanelOptions;\n\t\t},\n\t\tposition: EditorGroupColumn,\n\t\tcancellation: CancellationToken\n\t): Promise<void>;\n\t$createCustomDocument(resource: UriComponents, viewType: string, backupId: string | undefined, untitledDocumentData: VSBuffer | undefined, cancellation: CancellationToken): Promise<{ editable: boolean }>;\n\t$disposeCustomDocument(resource: UriComponents, viewType: string): Promise<void>;\n\n\t$undo(resource: UriComponents, viewType: string, editId: number, isDirty: boolean): Promise<void>;\n\t$redo(resource: UriComponents, viewType: string, editId: number, isDirty: boolean): Promise<void>;\n\t$revert(resource: UriComponents, viewType: string, cancellation: CancellationToken): Promise<void>;\n\t$disposeEdits(resourceComponents: UriComponents, viewType: string, editIds: number[]): void;\n\n\t$onSave(resource: UriComponents, viewType: string, cancellation: CancellationToken): Promise<void>;\n\t$onSaveAs(resource: UriComponents, viewType: string, targetResource: UriComponents, cancellation: CancellationToken): Promise<void>;\n\n\t$backup(resource: UriComponents, viewType: string, cancellation: CancellationToken): Promise<string>;\n\n\t$onMoveCustomEditor(handle: WebviewHandle, newResource: UriComponents, viewType: string): Promise<void>;\n}\n\nexport interface ExtHostWebviewViewsShape {\n\t$resolveWebviewView(webviewHandle: WebviewHandle, viewType: string, title: string | undefined, state: any, cancellation: CancellationToken): Promise<void>;\n\n\t$onDidChangeWebviewViewVisibility(webviewHandle: WebviewHandle, visible: boolean): void;\n\n\t$disposeWebviewView(webviewHandle: WebviewHandle): void;\n}\n\nexport enum CellOutputKind {\n\tText = 1,\n\tError = 2,\n\tRich = 3\n}\n\nexport enum NotebookEditorRevealType {\n\tDefault = 0,\n\tInCenter = 1,\n\tInCenterIfOutsideViewport = 2,\n\tAtTop = 3\n}\n\nexport interface INotebookDocumentShowOptions {\n\tposition?: EditorGroupColumn;\n\tpreserveFocus?: boolean;\n\tpinned?: boolean;\n\tselections?: ICellRange[];\n}\n\nexport type INotebookCellStatusBarEntryDto = Dto<notebookCommon.INotebookCellStatusBarItem>;\n\nexport interface INotebookCellStatusBarListDto {\n\titems: INotebookCellStatusBarEntryDto[];\n\tcacheId: number;\n}\n\nexport interface MainThreadNotebookShape extends IDisposable {\n\t$registerNotebookProvider(extension: notebookCommon.NotebookExtensionDescription, viewType: string, options: notebookCommon.TransientOptions, registration: notebookCommon.INotebookContributionData | undefined): Promise<void>;\n\t$updateNotebookProviderOptions(viewType: string, options?: { transientOutputs: boolean; transientCellMetadata: notebookCommon.TransientCellMetadata; transientDocumentMetadata: notebookCommon.TransientDocumentMetadata }): Promise<void>;\n\t$unregisterNotebookProvider(viewType: string): Promise<void>;\n\n\t$registerNotebookSerializer(handle: number, extension: notebookCommon.NotebookExtensionDescription, viewType: string, options: notebookCommon.TransientOptions, registration: notebookCommon.INotebookContributionData | undefined): void;\n\t$unregisterNotebookSerializer(handle: number): void;\n\n\t$registerNotebookCellStatusBarItemProvider(handle: number, eventHandle: number | undefined, viewType: string): Promise<void>;\n\t$unregisterNotebookCellStatusBarItemProvider(handle: number, eventHandle: number | undefined): Promise<void>;\n\t$emitCellStatusBarEvent(eventHandle: number): void;\n}\n\nexport interface MainThreadNotebookEditorsShape extends IDisposable {\n\t$tryShowNotebookDocument(uriComponents: UriComponents, viewType: string, options: INotebookDocumentShowOptions): Promise<string>;\n\t$tryRevealRange(id: string, range: ICellRange, revealType: NotebookEditorRevealType): Promise<void>;\n\t$trySetSelections(id: string, range: ICellRange[]): void;\n\t$tryApplyEdits(editorId: string, modelVersionId: number, cellEdits: ICellEditOperationDto[]): Promise<boolean>;\n}\n\nexport interface MainThreadNotebookDocumentsShape extends IDisposable {\n\t$tryCreateNotebook(options: { viewType: string; content?: NotebookDataDto }): Promise<UriComponents>;\n\t$tryOpenNotebook(uriComponents: UriComponents): Promise<UriComponents>;\n\t$trySaveNotebook(uri: UriComponents): Promise<boolean>;\n}\n\nexport interface INotebookKernelDto2 {\n\tid: string;\n\tnotebookType: string;\n\textensionId: ExtensionIdentifier;\n\textensionLocation: UriComponents;\n\tlabel: string;\n\tdetail?: string;\n\tdescription?: string;\n\tkind?: string;\n\tsupportedLanguages?: string[];\n\tsupportsInterrupt?: boolean;\n\tsupportsExecutionOrder?: boolean;\n\tpreloads?: { uri: UriComponents; provides: string[] }[];\n}\n\nexport interface INotebookProxyKernelDto {\n\tid: string;\n\tnotebookType: string;\n\textensionId: ExtensionIdentifier;\n\textensionLocation: UriComponents;\n\tlabel: string;\n\tdetail?: string;\n\tdescription?: string;\n\tkind?: string;\n}\n\nexport interface ICellExecuteOutputEditDto {\n\teditType: CellExecutionUpdateType.Output;\n\tcellHandle: number;\n\tappend?: boolean;\n\toutputs: NotebookOutputDto[];\n}\n\nexport interface ICellExecuteOutputItemEditDto {\n\teditType: CellExecutionUpdateType.OutputItems;\n\tappend?: boolean;\n\toutputId: string;\n\titems: NotebookOutputItemDto[];\n}\n\nexport interface ICellExecutionStateUpdateDto extends ICellExecutionStateUpdate {\n}\n\nexport interface ICellExecutionCompleteDto extends ICellExecutionComplete {\n}\n\nexport type ICellExecuteUpdateDto = ICellExecuteOutputEditDto | ICellExecuteOutputItemEditDto | ICellExecutionStateUpdateDto;\n\nexport interface MainThreadNotebookKernelsShape extends IDisposable {\n\t$postMessage(handle: number, editorId: string | undefined, message: any): Promise<boolean>;\n\t$addKernel(handle: number, data: INotebookKernelDto2): Promise<void>;\n\t$updateKernel(handle: number, data: Partial<INotebookKernelDto2>): void;\n\t$removeKernel(handle: number): void;\n\t$updateNotebookPriority(handle: number, uri: UriComponents, value: number | undefined): void;\n\n\t$createExecution(handle: number, controllerId: string, uri: UriComponents, cellHandle: number): void;\n\t$updateExecution(handle: number, data: SerializableObjectWithBuffers<ICellExecuteUpdateDto[]>): void;\n\t$completeExecution(handle: number, data: SerializableObjectWithBuffers<ICellExecutionCompleteDto>): void;\n}\n\nexport interface MainThreadNotebookRenderersShape extends IDisposable {\n\t$postMessage(editorId: string | undefined, rendererId: string, message: unknown): Promise<boolean>;\n}\n\nexport interface MainThreadInteractiveShape extends IDisposable {\n}\n\nexport interface MainThreadUrlsShape extends IDisposable {\n\t$registerUriHandler(handle: number, extensionId: ExtensionIdentifier): Promise<void>;\n\t$unregisterUriHandler(handle: number): Promise<void>;\n\t$createAppUri(uri: UriComponents): Promise<UriComponents>;\n}\n\nexport interface ExtHostUrlsShape {\n\t$handleExternalUri(handle: number, uri: UriComponents): Promise<void>;\n}\n\nexport interface MainThreadUriOpenersShape extends IDisposable {\n\t$registerUriOpener(id: string, schemes: readonly string[], extensionId: ExtensionIdentifier, label: string): Promise<void>;\n\t$unregisterUriOpener(id: string): Promise<void>;\n}\n\nexport interface ExtHostUriOpenersShape {\n\t$canOpenUri(id: string, uri: UriComponents, token: CancellationToken): Promise<languages.ExternalUriOpenerPriority>;\n\t$openUri(id: string, context: { resolvedUri: UriComponents; sourceUri: UriComponents }, token: CancellationToken): Promise<void>;\n}\n\nexport interface ITextSearchComplete {\n\tlimitHit?: boolean;\n}\n\nexport interface MainThreadWorkspaceShape extends IDisposable {\n\t$startFileSearch(includePattern: string | null, includeFolder: UriComponents | null, excludePatternOrDisregardExcludes: string | false | null, maxResults: number | null, token: CancellationToken): Promise<UriComponents[] | null>;\n\t$startTextSearch(query: search.IPatternInfo, folder: UriComponents | null, options: ITextQueryBuilderOptions, requestId: number, token: CancellationToken): Promise<ITextSearchComplete | null>;\n\t$checkExists(folders: readonly UriComponents[], includes: string[], token: CancellationToken): Promise<boolean>;\n\t$saveAll(includeUntitled?: boolean): Promise<boolean>;\n\t$updateWorkspaceFolders(extensionName: string, index: number, deleteCount: number, workspaceFoldersToAdd: { uri: UriComponents; name?: string }[]): Promise<void>;\n\t$resolveProxy(url: string): Promise<string | undefined>;\n\t$requestWorkspaceTrust(options?: WorkspaceTrustRequestOptions): Promise<boolean | undefined>;\n}\n\nexport interface IFileChangeDto {\n\tresource: UriComponents;\n\ttype: files.FileChangeType;\n}\n\nexport interface MainThreadFileSystemShape extends IDisposable {\n\t$registerFileSystemProvider(handle: number, scheme: string, capabilities: files.FileSystemProviderCapabilities): Promise<void>;\n\t$unregisterProvider(handle: number): void;\n\t$onFileSystemChange(handle: number, resource: IFileChangeDto[]): void;\n\n\t$stat(uri: UriComponents): Promise<files.IStat>;\n\t$readdir(resource: UriComponents): Promise<[string, files.FileType][]>;\n\t$readFile(resource: UriComponents): Promise<VSBuffer>;\n\t$writeFile(resource: UriComponents, content: VSBuffer): Promise<void>;\n\t$rename(resource: UriComponents, target: UriComponents, opts: files.IFileOverwriteOptions): Promise<void>;\n\t$copy(resource: UriComponents, target: UriComponents, opts: files.IFileOverwriteOptions): Promise<void>;\n\t$mkdir(resource: UriComponents): Promise<void>;\n\t$delete(resource: UriComponents, opts: files.IFileDeleteOptions): Promise<void>;\n\n\t$watch(extensionId: string, session: number, resource: UriComponents, opts: files.IWatchOptions): void;\n\t$unwatch(session: number): void;\n\n\t$ensureActivation(scheme: string): Promise<void>;\n}\n\nexport interface MainThreadLabelServiceShape extends IDisposable {\n\t$registerResourceLabelFormatter(handle: number, formatter: ResourceLabelFormatter): void;\n\t$unregisterResourceLabelFormatter(handle: number): void;\n}\n\nexport interface MainThreadSearchShape extends IDisposable {\n\t$registerFileSearchProvider(handle: number, scheme: string): void;\n\t$registerTextSearchProvider(handle: number, scheme: string): void;\n\t$unregisterProvider(handle: number): void;\n\t$handleFileMatch(handle: number, session: number, data: UriComponents[]): void;\n\t$handleTextMatch(handle: number, session: number, data: search.IRawFileMatch2[]): void;\n\t$handleTelemetry(eventName: string, data: any): void;\n}\n\nexport interface MainThreadTaskShape extends IDisposable {\n\t$createTaskId(task: tasks.ITaskDTO): Promise<string>;\n\t$registerTaskProvider(handle: number, type: string): Promise<void>;\n\t$unregisterTaskProvider(handle: number): Promise<void>;\n\t$fetchTasks(filter?: tasks.ITaskFilterDTO): Promise<tasks.ITaskDTO[]>;\n\t$getTaskExecution(value: tasks.ITaskHandleDTO | tasks.ITaskDTO): Promise<tasks.ITaskExecutionDTO>;\n\t$executeTask(task: tasks.ITaskHandleDTO | tasks.ITaskDTO): Promise<tasks.ITaskExecutionDTO>;\n\t$terminateTask(id: string): Promise<void>;\n\t$registerTaskSystem(scheme: string, info: tasks.ITaskSystemInfoDTO): void;\n\t$customExecutionComplete(id: string, result?: number): Promise<void>;\n\t$registerSupportedExecutions(custom?: boolean, shell?: boolean, process?: boolean): Promise<void>;\n}\n\nexport interface MainThreadExtensionServiceShape extends IDisposable {\n\t$getExtension(extensionId: string): Promise<Dto<IExtensionDescription> | undefined>;\n\t$activateExtension(extensionId: ExtensionIdentifier, reason: ExtensionActivationReason): Promise<void>;\n\t$onWillActivateExtension(extensionId: ExtensionIdentifier): Promise<void>;\n\t$onDidActivateExtension(extensionId: ExtensionIdentifier, codeLoadingTime: number, activateCallTime: number, activateResolvedTime: number, activationReason: ExtensionActivationReason): void;\n\t$onExtensionActivationError(extensionId: ExtensionIdentifier, error: SerializedError, missingExtensionDependency: MissingExtensionDependency | null): Promise<void>;\n\t$onExtensionRuntimeError(extensionId: ExtensionIdentifier, error: SerializedError): void;\n\t$setPerformanceMarks(marks: performance.PerformanceMark[]): Promise<void>;\n\t$asBrowserUri(uri: UriComponents): Promise<UriComponents>;\n}\n\nexport interface SCMProviderFeatures {\n\thasQuickDiffProvider?: boolean;\n\tcount?: number;\n\tcommitTemplate?: string;\n\tacceptInputCommand?: languages.Command;\n\tactionButton?: SCMActionButtonDto | null;\n\tstatusBarCommands?: ICommandDto[];\n}\n\nexport interface SCMActionButtonDto {\n\tcommand: ICommandDto;\n\tsecondaryCommands?: ICommandDto[][];\n\tdescription?: string;\n\tenabled: boolean;\n}\n\nexport interface SCMGroupFeatures {\n\thideWhenEmpty?: boolean;\n}\n\nexport type SCMRawResource = [\n\tnumber /*handle*/,\n\tUriComponents /*resourceUri*/,\n\t[UriComponents | ThemeIcon | undefined, UriComponents | ThemeIcon | undefined] /*icons: light, dark*/,\n\tstring /*tooltip*/,\n\tboolean /*strike through*/,\n\tboolean /*faded*/,\n\tstring /*context value*/,\n\tICommandDto | undefined /*command*/\n];\n\nexport type SCMRawResourceSplice = [\n\tnumber /* start */,\n\tnumber /* delete count */,\n\tSCMRawResource[]\n];\n\nexport type SCMRawResourceSplices = [\n\tnumber, /*handle*/\n\tSCMRawResourceSplice[]\n];\n\nexport interface MainThreadSCMShape extends IDisposable {\n\t$registerSourceControl(handle: number, id: string, label: string, rootUri: UriComponents | undefined): void;\n\t$updateSourceControl(handle: number, features: SCMProviderFeatures): void;\n\t$unregisterSourceControl(handle: number): void;\n\n\t$registerGroups(sourceControlHandle: number, groups: [number /*handle*/, string /*id*/, string /*label*/, SCMGroupFeatures][], splices: SCMRawResourceSplices[]): void;\n\t$updateGroup(sourceControlHandle: number, handle: number, features: SCMGroupFeatures): void;\n\t$updateGroupLabel(sourceControlHandle: number, handle: number, label: string): void;\n\t$unregisterGroup(sourceControlHandle: number, handle: number): void;\n\n\t$spliceResourceStates(sourceControlHandle: number, splices: SCMRawResourceSplices[]): void;\n\n\t$setInputBoxValue(sourceControlHandle: number, value: string): void;\n\t$setInputBoxPlaceholder(sourceControlHandle: number, placeholder: string): void;\n\t$setInputBoxEnablement(sourceControlHandle: number, enabled: boolean): void;\n\t$setInputBoxVisibility(sourceControlHandle: number, visible: boolean): void;\n\t$showValidationMessage(sourceControlHandle: number, message: string | IMarkdownString, type: InputValidationType): void;\n\t$setValidationProviderIsEnabled(sourceControlHandle: number, enabled: boolean): void;\n}\n\nexport type DebugSessionUUID = string;\n\nexport interface IDebugConfiguration {\n\ttype: string;\n\tname: string;\n\trequest: string;\n\t[key: string]: any;\n}\n\nexport interface IStartDebuggingOptions {\n\tparentSessionID?: DebugSessionUUID;\n\tlifecycleManagedByParent?: boolean;\n\trepl?: IDebugSessionReplMode;\n\tnoDebug?: boolean;\n\tcompact?: boolean;\n\tdebugUI?: {\n\t\tsimple?: boolean;\n\t};\n\tsuppressSaveBeforeStart?: boolean;\n}\n\nexport interface MainThreadDebugServiceShape extends IDisposable {\n\t$registerDebugTypes(debugTypes: string[]): void;\n\t$sessionCached(sessionID: string): void;\n\t$acceptDAMessage(handle: number, message: DebugProtocol.ProtocolMessage): void;\n\t$acceptDAError(handle: number, name: string, message: string, stack: string | undefined): void;\n\t$acceptDAExit(handle: number, code: number | undefined, signal: string | undefined): void;\n\t$registerDebugConfigurationProvider(type: string, triggerKind: DebugConfigurationProviderTriggerKind, hasProvideMethod: boolean, hasResolveMethod: boolean, hasResolve2Method: boolean, handle: number): Promise<void>;\n\t$registerDebugAdapterDescriptorFactory(type: string, handle: number): Promise<void>;\n\t$unregisterDebugConfigurationProvider(handle: number): void;\n\t$unregisterDebugAdapterDescriptorFactory(handle: number): void;\n\t$startDebugging(folder: UriComponents | undefined, nameOrConfig: string | IDebugConfiguration, options: IStartDebuggingOptions): Promise<boolean>;\n\t$stopDebugging(sessionId: DebugSessionUUID | undefined): Promise<void>;\n\t$setDebugSessionName(id: DebugSessionUUID, name: string): void;\n\t$customDebugAdapterRequest(id: DebugSessionUUID, command: string, args: any): Promise<any>;\n\t$getDebugProtocolBreakpoint(id: DebugSessionUUID, breakpoinId: string): Promise<DebugProtocol.Breakpoint | undefined>;\n\t$appendDebugConsole(value: string): void;\n\t$startBreakpointEvents(): void;\n\t$registerBreakpoints(breakpoints: Array<ISourceMultiBreakpointDto | IFunctionBreakpointDto | IDataBreakpointDto>): Promise<void>;\n\t$unregisterBreakpoints(breakpointIds: string[], functionBreakpointIds: string[], dataBreakpointIds: string[]): Promise<void>;\n}\n\nexport interface IOpenUriOptions {\n\treadonly allowTunneling?: boolean;\n\treadonly allowContributedOpeners?: boolean | string;\n}\n\nexport interface MainThreadWindowShape extends IDisposable {\n\t$getWindowVisibility(): Promise<boolean>;\n\t$openUri(uri: UriComponents, uriString: string | undefined, options: IOpenUriOptions): Promise<boolean>;\n\t$asExternalUri(uri: UriComponents, options: IOpenUriOptions): Promise<UriComponents>;\n}\n\nexport enum CandidatePortSource {\n\tNone = 0,\n\tProcess = 1,\n\tOutput = 2\n}\n\nexport interface PortAttributesProviderSelector {\n\tpid?: number;\n\tportRange?: [number, number];\n\tcommandMatcher?: RegExp;\n}\n\nexport interface MainThreadTunnelServiceShape extends IDisposable {\n\t$openTunnel(tunnelOptions: TunnelOptions, source: string | undefined): Promise<TunnelDto | undefined>;\n\t$closeTunnel(remote: { host: string; port: number }): Promise<void>;\n\t$getTunnels(): Promise<TunnelDescription[]>;\n\t$setTunnelProvider(features?: TunnelProviderFeatures): Promise<void>;\n\t$setRemoteTunnelService(processId: number): Promise<void>;\n\t$setCandidateFilter(): Promise<void>;\n\t$onFoundNewCandidates(candidates: CandidatePort[]): Promise<void>;\n\t$setCandidatePortSource(source: CandidatePortSource): Promise<void>;\n\t$registerPortsAttributesProvider(selector: PortAttributesProviderSelector, providerHandle: number): Promise<void>;\n\t$unregisterPortsAttributesProvider(providerHandle: number): Promise<void>;\n}\n\nexport interface MainThreadTimelineShape extends IDisposable {\n\t$registerTimelineProvider(provider: TimelineProviderDescriptor): void;\n\t$unregisterTimelineProvider(source: string): void;\n\t$emitTimelineChangeEvent(e: TimelineChangeEvent | undefined): void;\n}\n\n// -- extension host\n\nexport interface ICommandHandlerDescriptionDto {\n\treadonly description: string;\n\treadonly args: ReadonlyArray<{\n\t\treadonly name: string;\n\t\treadonly isOptional?: boolean;\n\t\treadonly description?: string;\n\t}>;\n\treadonly returns?: string;\n}\n\nexport interface ExtHostCommandsShape {\n\t$executeContributedCommand(id: string, ...args: any[]): Promise<unknown>;\n\t$getContributedCommandHandlerDescriptions(): Promise<{ [id: string]: string | ICommandHandlerDescriptionDto }>;\n}\n\nexport interface ExtHostConfigurationShape {\n\t$initializeConfiguration(data: IConfigurationInitData): void;\n\t$acceptConfigurationChanged(data: IConfigurationInitData, change: IConfigurationChange): void;\n}\n\nexport interface ExtHostDiagnosticsShape {\n\t$acceptMarkersChange(data: [UriComponents, IMarkerData[]][]): void;\n}\n\nexport interface ExtHostDocumentContentProvidersShape {\n\t$provideTextDocumentContent(handle: number, uri: UriComponents): Promise<string | null | undefined>;\n}\n\nexport interface IModelAddedData {\n\turi: UriComponents;\n\tversionId: number;\n\tlines: string[];\n\tEOL: string;\n\tlanguageId: string;\n\tisDirty: boolean;\n}\nexport interface ExtHostDocumentsShape {\n\t$acceptModelLanguageChanged(strURL: UriComponents, newLanguageId: string): void;\n\t$acceptModelSaved(strURL: UriComponents): void;\n\t$acceptDirtyStateChanged(strURL: UriComponents, isDirty: boolean): void;\n\t$acceptModelChanged(strURL: UriComponents, e: IModelChangedEvent, isDirty: boolean): void;\n}\n\nexport interface ExtHostDocumentSaveParticipantShape {\n\t$participateInSave(resource: UriComponents, reason: SaveReason): Promise<boolean[]>;\n}\n\nexport interface ITextEditorAddData {\n\tid: string;\n\tdocumentUri: UriComponents;\n\toptions: IResolvedTextEditorConfiguration;\n\tselections: ISelection[];\n\tvisibleRanges: IRange[];\n\teditorPosition: EditorGroupColumn | undefined;\n}\nexport interface ITextEditorPositionData {\n\t[id: string]: EditorGroupColumn;\n}\nexport interface IEditorPropertiesChangeData {\n\toptions: IResolvedTextEditorConfiguration | null;\n\tselections: ISelectionChangeEvent | null;\n\tvisibleRanges: IRange[] | null;\n}\nexport interface ISelectionChangeEvent {\n\tselections: Selection[];\n\tsource?: string;\n}\n\nexport interface ExtHostEditorsShape {\n\t$acceptEditorPropertiesChanged(id: string, props: IEditorPropertiesChangeData): void;\n\t$acceptEditorPositionData(data: ITextEditorPositionData): void;\n}\n\nexport interface IDocumentsAndEditorsDelta {\n\tremovedDocuments?: UriComponents[];\n\taddedDocuments?: IModelAddedData[];\n\tremovedEditors?: string[];\n\taddedEditors?: ITextEditorAddData[];\n\tnewActiveEditor?: string | null;\n}\n\nexport interface ExtHostDocumentsAndEditorsShape {\n\t$acceptDocumentsAndEditorsDelta(delta: IDocumentsAndEditorsDelta): void;\n}\n\nexport interface IDataTransferFileDTO {\n\treadonly name: string;\n\treadonly uri?: UriComponents;\n}\n\nexport interface DataTransferItemDTO {\n\treadonly asString: string;\n\treadonly fileData: IDataTransferFileDTO | undefined;\n}\n\nexport interface DataTransferDTO {\n\treadonly items: Array<[/* type */string, DataTransferItemDTO]>;\n}\n\nexport interface ExtHostTreeViewsShape {\n\t$getChildren(treeViewId: string, treeItemHandle?: string): Promise<ITreeItem[] | undefined>;\n\t$handleDrop(destinationViewId: string, requestId: number, treeDataTransfer: DataTransferDTO, targetHandle: string | undefined, token: CancellationToken, operationUuid?: string, sourceViewId?: string, sourceTreeItemHandles?: string[]): Promise<void>;\n\t$handleDrag(sourceViewId: string, sourceTreeItemHandles: string[], operationUuid: string, token: CancellationToken): Promise<DataTransferDTO | undefined>;\n\t$setExpanded(treeViewId: string, treeItemHandle: string, expanded: boolean): void;\n\t$setSelection(treeViewId: string, treeItemHandles: string[]): void;\n\t$setVisible(treeViewId: string, visible: boolean): void;\n\t$hasResolve(treeViewId: string): Promise<boolean>;\n\t$resolve(treeViewId: string, treeItemHandle: string, token: CancellationToken): Promise<ITreeItem | undefined>;\n}\n\nexport interface ExtHostWorkspaceShape {\n\t$initializeWorkspace(workspace: IWorkspaceData | null, trusted: boolean): void;\n\t$acceptWorkspaceData(workspace: IWorkspaceData | null): void;\n\t$handleTextSearchResult(result: search.IRawFileMatch2, requestId: number): void;\n\t$onDidGrantWorkspaceTrust(): void;\n}\n\nexport interface ExtHostFileSystemInfoShape {\n\t$acceptProviderInfos(uri: UriComponents, capabilities: number | null): void;\n}\n\nexport interface ExtHostFileSystemShape {\n\t$stat(handle: number, resource: UriComponents): Promise<files.IStat>;\n\t$readdir(handle: number, resource: UriComponents): Promise<[string, files.FileType][]>;\n\t$readFile(handle: number, resource: UriComponents): Promise<VSBuffer>;\n\t$writeFile(handle: number, resource: UriComponents, content: VSBuffer, opts: files.IFileWriteOptions): Promise<void>;\n\t$rename(handle: number, resource: UriComponents, target: UriComponents, opts: files.IFileOverwriteOptions): Promise<void>;\n\t$copy(handle: number, resource: UriComponents, target: UriComponents, opts: files.IFileOverwriteOptions): Promise<void>;\n\t$mkdir(handle: number, resource: UriComponents): Promise<void>;\n\t$delete(handle: number, resource: UriComponents, opts: files.IFileDeleteOptions): Promise<void>;\n\t$watch(handle: number, session: number, resource: UriComponents, opts: files.IWatchOptions): void;\n\t$unwatch(handle: number, session: number): void;\n\t$open(handle: number, resource: UriComponents, opts: files.IFileOpenOptions): Promise<number>;\n\t$close(handle: number, fd: number): Promise<void>;\n\t$read(handle: number, fd: number, pos: number, length: number): Promise<VSBuffer>;\n\t$write(handle: number, fd: number, pos: number, data: VSBuffer): Promise<number>;\n}\n\nexport interface ExtHostLabelServiceShape {\n\t$registerResourceLabelFormatter(formatter: ResourceLabelFormatter): IDisposable;\n}\n\nexport interface ExtHostAuthenticationShape {\n\t$getSessions(id: string, scopes?: string[]): Promise<ReadonlyArray<AuthenticationSession>>;\n\t$createSession(id: string, scopes: string[]): Promise<AuthenticationSession>;\n\t$removeSession(id: string, sessionId: string): Promise<void>;\n\t$onDidChangeAuthenticationSessions(id: string, label: string): Promise<void>;\n\t$setProviders(providers: AuthenticationProviderInformation[]): Promise<void>;\n}\n\nexport interface ExtHostSecretStateShape {\n\t$onDidChangePassword(e: { extensionId: string; key: string }): Promise<void>;\n}\n\nexport interface ExtHostSearchShape {\n\t$enableExtensionHostSearch(): void;\n\t$provideFileSearchResults(handle: number, session: number, query: search.IRawQuery, token: CancellationToken): Promise<search.ISearchCompleteStats>;\n\t$provideTextSearchResults(handle: number, session: number, query: search.IRawTextQuery, token: CancellationToken): Promise<search.ISearchCompleteStats>;\n\t$clearCache(cacheKey: string): Promise<void>;\n}\n\nexport interface ExtHostExtensionServiceShape {\n\t$resolveAuthority(remoteAuthority: string, resolveAttempt: number): Promise<IResolveAuthorityResult>;\n\t/**\n\t * Returns `null` if no resolver for `remoteAuthority` is found.\n\t */\n\t$getCanonicalURI(remoteAuthority: string, uri: UriComponents): Promise<UriComponents | null>;\n\t$startExtensionHost(extensionsDelta: IExtensionDescriptionDelta): Promise<void>;\n\t$extensionTestsExecute(): Promise<number>;\n\t$activateByEvent(activationEvent: string, activationKind: ActivationKind): Promise<void>;\n\t$activate(extensionId: ExtensionIdentifier, reason: ExtensionActivationReason): Promise<boolean>;\n\t$setRemoteEnvironment(env: { [key: string]: string | null }): Promise<void>;\n\t$updateRemoteConnectionData(connectionData: IRemoteConnectionData): Promise<void>;\n\n\t$deltaExtensions(extensionsDelta: IExtensionDescriptionDelta): Promise<void>;\n\n\t$test_latency(n: number): Promise<number>;\n\t$test_up(b: VSBuffer): Promise<number>;\n\t$test_down(size: number): Promise<VSBuffer>;\n}\n\nexport interface FileSystemEvents {\n\tcreated: UriComponents[];\n\tchanged: UriComponents[];\n\tdeleted: UriComponents[];\n}\n\nexport interface SourceTargetPair {\n\tsource?: UriComponents;\n\ttarget: UriComponents;\n}\n\nexport interface IWillRunFileOperationParticipation {\n\tedit: IWorkspaceEditDto;\n\textensionNames: string[];\n}\n\nexport interface ExtHostFileSystemEventServiceShape {\n\t$onFileEvent(events: FileSystemEvents): void;\n\t$onWillRunFileOperation(operation: files.FileOperation, files: readonly SourceTargetPair[], timeout: number, token: CancellationToken): Promise<IWillRunFileOperationParticipation | undefined>;\n\t$onDidRunFileOperation(operation: files.FileOperation, files: readonly SourceTargetPair[]): void;\n}\n\nexport interface ExtHostLanguagesShape {\n\t$acceptLanguageIds(ids: string[]): void;\n}\n\nexport interface ExtHostHeapServiceShape {\n\t$onGarbageCollection(ids: number[]): void;\n}\nexport interface IRawColorInfo {\n\tcolor: [number, number, number, number];\n\trange: IRange;\n}\n\nexport class IdObject {\n\t_id?: number;\n\tprivate static _n = 0;\n\tstatic mixin<T extends object>(object: T): T & IdObject {\n\t\t(<any>object)._id = IdObject._n++;\n\t\treturn <any>object;\n\t}\n}\n\nexport const enum ISuggestDataDtoField {\n\tlabel = 'a',\n\tkind = 'b',\n\tdetail = 'c',\n\tdocumentation = 'd',\n\tsortText = 'e',\n\tfilterText = 'f',\n\tpreselect = 'g',\n\tinsertText = 'h',\n\tinsertTextRules = 'i',\n\trange = 'j',\n\tcommitCharacters = 'k',\n\tadditionalTextEdits = 'l',\n\tcommand = 'm',\n\tkindModifier = 'n',\n}\n\nexport interface ISuggestDataDto {\n\t[ISuggestDataDtoField.label]: string | languages.CompletionItemLabel;\n\t[ISuggestDataDtoField.kind]?: languages.CompletionItemKind;\n\t[ISuggestDataDtoField.detail]?: string;\n\t[ISuggestDataDtoField.documentation]?: string | IMarkdownString;\n\t[ISuggestDataDtoField.sortText]?: string;\n\t[ISuggestDataDtoField.filterText]?: string;\n\t[ISuggestDataDtoField.preselect]?: true;\n\t[ISuggestDataDtoField.insertText]?: string;\n\t[ISuggestDataDtoField.insertTextRules]?: languages.CompletionItemInsertTextRule;\n\t[ISuggestDataDtoField.range]?: IRange | { insert: IRange; replace: IRange };\n\t[ISuggestDataDtoField.commitCharacters]?: string[];\n\t[ISuggestDataDtoField.additionalTextEdits]?: ISingleEditOperation[];\n\t[ISuggestDataDtoField.command]?: languages.Command;\n\t[ISuggestDataDtoField.kindModifier]?: languages.CompletionItemTag[];\n\t// not-standard\n\tx?: ChainedCacheId;\n}\n\nexport const enum ISuggestResultDtoField {\n\tdefaultRanges = 'a',\n\tcompletions = 'b',\n\tisIncomplete = 'c',\n\tduration = 'd',\n}\n\nexport interface ISuggestResultDto {\n\t[ISuggestResultDtoField.defaultRanges]: { insert: IRange; replace: IRange };\n\t[ISuggestResultDtoField.completions]: ISuggestDataDto[];\n\t[ISuggestResultDtoField.isIncomplete]: undefined | true;\n\t[ISuggestResultDtoField.duration]: number;\n\tx?: number;\n}\n\nexport interface ISignatureHelpDto {\n\tid: CacheId;\n\tsignatures: languages.SignatureInformation[];\n\tactiveSignature: number;\n\tactiveParameter: number;\n}\n\nexport interface ISignatureHelpContextDto {\n\treadonly triggerKind: languages.SignatureHelpTriggerKind;\n\treadonly triggerCharacter: string | undefined;\n\treadonly isRetrigger: boolean;\n\treadonly activeSignatureHelp: ISignatureHelpDto | undefined;\n}\n\nexport type IInlayHintDto = CachedSessionItem<Dto<languages.InlayHint>>;\n\nexport type IInlayHintsDto = CachedSession<{ hints: IInlayHintDto[] }>;\n\nexport type ILocationDto = Dto<languages.Location>;\nexport type ILocationLinkDto = Dto<languages.LocationLink>;\n\nexport type IWorkspaceSymbolDto = CachedSessionItem<Dto<IWorkspaceSymbol>>;\nexport type IWorkspaceSymbolsDto = CachedSession<{ symbols: IWorkspaceSymbolDto[] }>;\n\nexport interface IWorkspaceEditEntryMetadataDto {\n\tneedsConfirmation: boolean;\n\tlabel: string;\n\tdescription?: string;\n\ticonPath?: { id: string } | UriComponents | { light: UriComponents; dark: UriComponents };\n}\n\n\nexport type ICellEditOperationDto =\n\tnotebookCommon.ICellPartialMetadataEdit\n\t| notebookCommon.IDocumentMetadataEdit\n\t| {\n\t\teditType: notebookCommon.CellEditType.Replace;\n\t\tindex: number;\n\t\tcount: number;\n\t\tcells: NotebookCellDataDto[];\n\t};\n\nexport type IWorkspaceCellEditDto = Dto<Omit<notebookCommon.IWorkspaceNotebookCellEdit, 'cellEdit'>> & { cellEdit: ICellEditOperationDto };\n\nexport type IWorkspaceFileEditDto = Dto<languages.IWorkspaceFileEdit>;\n\nexport type IWorkspaceTextEditDto = Dto<languages.IWorkspaceTextEdit>;\n\nexport interface IWorkspaceEditDto {\n\tedits: Array<IWorkspaceFileEditDto | IWorkspaceTextEditDto | IWorkspaceCellEditDto>;\n}\n\nexport function reviveWorkspaceEditDto(data: IWorkspaceEditDto | undefined): languages.WorkspaceEdit | undefined {\n\tif (data && data.edits) {\n\t\trevive<languages.WorkspaceEdit>(data);\n\t}\n\treturn <languages.WorkspaceEdit>data;\n}\n\nexport type ICommandDto = { $ident?: number } & languages.Command;\n\nexport interface ICodeActionDto {\n\tcacheId?: ChainedCacheId;\n\ttitle: string;\n\tedit?: IWorkspaceEditDto;\n\tdiagnostics?: Dto<IMarkerData[]>;\n\tcommand?: ICommandDto;\n\tkind?: string;\n\tisPreferred?: boolean;\n\tdisabled?: string;\n}\n\nexport interface ICodeActionListDto {\n\tcacheId: CacheId;\n\tactions: ReadonlyArray<ICodeActionDto>;\n}\n\nexport interface ICodeActionProviderMetadataDto {\n\treadonly providedKinds?: readonly string[];\n\treadonly documentation?: ReadonlyArray<{ readonly kind: string; readonly command: ICommandDto }>;\n}\n\nexport type CacheId = number;\nexport type ChainedCacheId = [CacheId, CacheId];\n\ntype CachedSessionItem<T> = T & { cacheId?: ChainedCacheId };\ntype CachedSession<T> = T & { cacheId?: CacheId };\n\nexport type ILinksListDto = CachedSession<{ links: ILinkDto[] }>;\nexport type ILinkDto = CachedSessionItem<Dto<languages.ILink>>;\n\nexport type ICodeLensListDto = CachedSession<{ lenses: ICodeLensDto[] }>;\nexport type ICodeLensDto = CachedSessionItem<Dto<languages.CodeLens>>;\n\nexport type ICallHierarchyItemDto = Dto<CallHierarchyItem>;\n\nexport interface IIncomingCallDto {\n\tfrom: ICallHierarchyItemDto;\n\tfromRanges: IRange[];\n}\n\nexport interface IOutgoingCallDto {\n\tfromRanges: IRange[];\n\tto: ICallHierarchyItemDto;\n}\n\nexport interface ILanguageWordDefinitionDto {\n\tlanguageId: string;\n\tregexSource: string;\n\tregexFlags: string;\n}\n\nexport interface ILinkedEditingRangesDto {\n\tranges: IRange[];\n\twordPattern?: IRegExpDto;\n}\n\nexport interface IInlineValueContextDto {\n\tframeId: number;\n\tstoppedLocation: IRange;\n}\n\nexport type ITypeHierarchyItemDto = Dto<TypeHierarchyItem>;\n\nexport interface IPasteEditDto {\n\tinsertText: string | { snippet: string };\n\tadditionalEdit?: IWorkspaceEditDto;\n}\n\nexport interface IDocumentOnDropEditDto {\n\tinsertText: string | { snippet: string };\n\tadditionalEdit?: IWorkspaceEditDto;\n}\n\nexport interface ExtHostLanguageFeaturesShape {\n\t$provideDocumentSymbols(handle: number, resource: UriComponents, token: CancellationToken): Promise<languages.DocumentSymbol[] | undefined>;\n\t$provideCodeLenses(handle: number, resource: UriComponents, token: CancellationToken): Promise<ICodeLensListDto | undefined>;\n\t$resolveCodeLens(handle: number, symbol: ICodeLensDto, token: CancellationToken): Promise<ICodeLensDto | undefined>;\n\t$releaseCodeLenses(handle: number, id: number): void;\n\t$provideDefinition(handle: number, resource: UriComponents, position: IPosition, token: CancellationToken): Promise<ILocationLinkDto[]>;\n\t$provideDeclaration(handle: number, resource: UriComponents, position: IPosition, token: CancellationToken): Promise<ILocationLinkDto[]>;\n\t$provideImplementation(handle: number, resource: UriComponents, position: IPosition, token: CancellationToken): Promise<ILocationLinkDto[]>;\n\t$provideTypeDefinition(handle: number, resource: UriComponents, position: IPosition, token: CancellationToken): Promise<ILocationLinkDto[]>;\n\t$provideHover(handle: number, resource: UriComponents, position: IPosition, token: CancellationToken): Promise<languages.Hover | undefined>;\n\t$provideEvaluatableExpression(handle: number, resource: UriComponents, position: IPosition, token: CancellationToken): Promise<languages.EvaluatableExpression | undefined>;\n\t$provideInlineValues(handle: number, resource: UriComponents, range: IRange, context: languages.InlineValueContext, token: CancellationToken): Promise<languages.InlineValue[] | undefined>;\n\t$provideDocumentHighlights(handle: number, resource: UriComponents, position: IPosition, token: CancellationToken): Promise<languages.DocumentHighlight[] | undefined>;\n\t$provideLinkedEditingRanges(handle: number, resource: UriComponents, position: IPosition, token: CancellationToken): Promise<ILinkedEditingRangesDto | undefined>;\n\t$provideReferences(handle: number, resource: UriComponents, position: IPosition, context: languages.ReferenceContext, token: CancellationToken): Promise<ILocationDto[] | undefined>;\n\t$provideCodeActions(handle: number, resource: UriComponents, rangeOrSelection: IRange | ISelection, context: languages.CodeActionContext, token: CancellationToken): Promise<ICodeActionListDto | undefined>;\n\t$resolveCodeAction(handle: number, id: ChainedCacheId, token: CancellationToken): Promise<IWorkspaceEditDto | undefined>;\n\t$releaseCodeActions(handle: number, cacheId: number): void;\n\t$prepareDocumentPaste(handle: number, uri: UriComponents, ranges: readonly IRange[], dataTransfer: DataTransferDTO, token: CancellationToken): Promise<DataTransferDTO | undefined>;\n\t$providePasteEdits(handle: number, requestId: number, uri: UriComponents, ranges: IRange[], dataTransfer: DataTransferDTO, token: CancellationToken): Promise<IPasteEditDto | undefined>;\n\t$provideDocumentFormattingEdits(handle: number, resource: UriComponents, options: languages.FormattingOptions, token: CancellationToken): Promise<ISingleEditOperation[] | undefined>;\n\t$provideDocumentRangeFormattingEdits(handle: number, resource: UriComponents, range: IRange, options: languages.FormattingOptions, token: CancellationToken): Promise<ISingleEditOperation[] | undefined>;\n\t$provideOnTypeFormattingEdits(handle: number, resource: UriComponents, position: IPosition, ch: string, options: languages.FormattingOptions, token: CancellationToken): Promise<ISingleEditOperation[] | undefined>;\n\t$provideWorkspaceSymbols(handle: number, search: string, token: CancellationToken): Promise<IWorkspaceSymbolsDto>;\n\t$resolveWorkspaceSymbol(handle: number, symbol: IWorkspaceSymbolDto, token: CancellationToken): Promise<IWorkspaceSymbolDto | undefined>;\n\t$releaseWorkspaceSymbols(handle: number, id: number): void;\n\t$provideRenameEdits(handle: number, resource: UriComponents, position: IPosition, newName: string, token: CancellationToken): Promise<IWorkspaceEditDto & { rejectReason?: string } | undefined>;\n\t$resolveRenameLocation(handle: number, resource: UriComponents, position: IPosition, token: CancellationToken): Promise<languages.RenameLocation | undefined>;\n\t$provideDocumentSemanticTokens(handle: number, resource: UriComponents, previousResultId: number, token: CancellationToken): Promise<VSBuffer | null>;\n\t$releaseDocumentSemanticTokens(handle: number, semanticColoringResultId: number): void;\n\t$provideDocumentRangeSemanticTokens(handle: number, resource: UriComponents, range: IRange, token: CancellationToken): Promise<VSBuffer | null>;\n\t$provideCompletionItems(handle: number, resource: UriComponents, position: IPosition, context: languages.CompletionContext, token: CancellationToken): Promise<ISuggestResultDto | undefined>;\n\t$resolveCompletionItem(handle: number, id: ChainedCacheId, token: CancellationToken): Promise<ISuggestDataDto | undefined>;\n\t$releaseCompletionItems(handle: number, id: number): void;\n\t$provideInlineCompletions(handle: number, resource: UriComponents, position: IPosition, context: languages.InlineCompletionContext, token: CancellationToken): Promise<IdentifiableInlineCompletions | undefined>;\n\t$handleInlineCompletionDidShow(handle: number, pid: number, idx: number): void;\n\t$freeInlineCompletionsList(handle: number, pid: number): void;\n\t$provideSignatureHelp(handle: number, resource: UriComponents, position: IPosition, context: languages.SignatureHelpContext, token: CancellationToken): Promise<ISignatureHelpDto | undefined>;\n\t$releaseSignatureHelp(handle: number, id: number): void;\n\t$provideInlayHints(handle: number, resource: UriComponents, range: IRange, token: CancellationToken): Promise<IInlayHintsDto | undefined>;\n\t$resolveInlayHint(handle: number, id: ChainedCacheId, token: CancellationToken): Promise<IInlayHintDto | undefined>;\n\t$releaseInlayHints(handle: number, id: number): void;\n\t$provideDocumentLinks(handle: number, resource: UriComponents, token: CancellationToken): Promise<ILinksListDto | undefined>;\n\t$resolveDocumentLink(handle: number, id: ChainedCacheId, token: CancellationToken): Promise<ILinkDto | undefined>;\n\t$releaseDocumentLinks(handle: number, id: number): void;\n\t$provideDocumentColors(handle: number, resource: UriComponents, token: CancellationToken): Promise<IRawColorInfo[]>;\n\t$provideColorPresentations(handle: number, resource: UriComponents, colorInfo: IRawColorInfo, token: CancellationToken): Promise<languages.IColorPresentation[] | undefined>;\n\t$provideFoldingRanges(handle: number, resource: UriComponents, context: languages.FoldingContext, token: CancellationToken): Promise<languages.FoldingRange[] | undefined>;\n\t$provideSelectionRanges(handle: number, resource: UriComponents, positions: IPosition[], token: CancellationToken): Promise<languages.SelectionRange[][]>;\n\t$prepareCallHierarchy(handle: number, resource: UriComponents, position: IPosition, token: CancellationToken): Promise<ICallHierarchyItemDto[] | undefined>;\n\t$provideCallHierarchyIncomingCalls(handle: number, sessionId: string, itemId: string, token: CancellationToken): Promise<IIncomingCallDto[] | undefined>;\n\t$provideCallHierarchyOutgoingCalls(handle: number, sessionId: string, itemId: string, token: CancellationToken): Promise<IOutgoingCallDto[] | undefined>;\n\t$releaseCallHierarchy(handle: number, sessionId: string): void;\n\t$setWordDefinitions(wordDefinitions: ILanguageWordDefinitionDto[]): void;\n\t$prepareTypeHierarchy(handle: number, resource: UriComponents, position: IPosition, token: CancellationToken): Promise<ITypeHierarchyItemDto[] | undefined>;\n\t$provideTypeHierarchySupertypes(handle: number, sessionId: string, itemId: string, token: CancellationToken): Promise<ITypeHierarchyItemDto[] | undefined>;\n\t$provideTypeHierarchySubtypes(handle: number, sessionId: string, itemId: string, token: CancellationToken): Promise<ITypeHierarchyItemDto[] | undefined>;\n\t$releaseTypeHierarchy(handle: number, sessionId: string): void;\n\t$provideDocumentOnDropEdits(handle: number, requestId: number, resource: UriComponents, position: IPosition, dataTransferDto: DataTransferDTO, token: CancellationToken): Promise<IDocumentOnDropEditDto | undefined>;\n}\n\nexport interface ExtHostQuickOpenShape {\n\t$onItemSelected(handle: number): void;\n\t$validateInput(input: string): Promise<string | { content: string; severity: Severity } | null | undefined>;\n\t$onDidChangeActive(sessionId: number, handles: number[]): void;\n\t$onDidChangeSelection(sessionId: number, handles: number[]): void;\n\t$onDidAccept(sessionId: number): void;\n\t$onDidChangeValue(sessionId: number, value: string): void;\n\t$onDidTriggerButton(sessionId: number, handle: number): void;\n\t$onDidTriggerItemButton(sessionId: number, itemHandle: number, buttonHandle: number): void;\n\t$onDidHide(sessionId: number): void;\n}\n\nexport interface ExtHostTelemetryShape {\n\t$initializeTelemetryLevel(level: TelemetryLevel, productConfig?: { usage: boolean; error: boolean }): void;\n\t$onDidChangeTelemetryLevel(level: TelemetryLevel): void;\n}\n\nexport interface ITerminalLinkDto {\n\t/** The ID of the link to enable activation and disposal. */\n\tid: number;\n\t/** The startIndex of the link in the line. */\n\tstartIndex: number;\n\t/** The length of the link in the line. */\n\tlength: number;\n\t/** The descriptive label for what the link does when activated. */\n\tlabel?: string;\n}\n\nexport interface ITerminalDimensionsDto {\n\tcolumns: number;\n\trows: number;\n}\n\nexport interface ExtHostTerminalServiceShape {\n\t$acceptTerminalClosed(id: number, exitCode: number | undefined, exitReason: TerminalExitReason): void;\n\t$acceptTerminalOpened(id: number, extHostTerminalId: string | undefined, name: string, shellLaunchConfig: IShellLaunchConfigDto): void;\n\t$acceptActiveTerminalChanged(id: number | null): void;\n\t$acceptTerminalProcessId(id: number, processId: number): void;\n\t$acceptTerminalProcessData(id: number, data: string): void;\n\t$acceptTerminalTitleChange(id: number, name: string): void;\n\t$acceptTerminalDimensions(id: number, cols: number, rows: number): void;\n\t$acceptTerminalMaximumDimensions(id: number, cols: number, rows: number): void;\n\t$acceptTerminalInteraction(id: number): void;\n\t$startExtensionTerminal(id: number, initialDimensions: ITerminalDimensionsDto | undefined): Promise<ITerminalLaunchError | undefined>;\n\t$acceptProcessAckDataEvent(id: number, charCount: number): void;\n\t$acceptProcessInput(id: number, data: string): void;\n\t$acceptProcessResize(id: number, cols: number, rows: number): void;\n\t$acceptProcessShutdown(id: number, immediate: boolean): void;\n\t$acceptProcessRequestInitialCwd(id: number): void;\n\t$acceptProcessRequestCwd(id: number): void;\n\t$acceptProcessRequestLatency(id: number): Promise<number>;\n\t$provideLinks(id: number, line: string): Promise<ITerminalLinkDto[]>;\n\t$activateLink(id: number, linkId: number): void;\n\t$initEnvironmentVariableCollections(collections: [string, ISerializableEnvironmentVariableCollection][]): void;\n\t$acceptDefaultProfile(profile: ITerminalProfile, automationProfile: ITerminalProfile): void;\n\t$createContributedProfileTerminal(id: string, options: ICreateContributedTerminalProfileOptions): Promise<void>;\n}\n\nexport interface ExtHostSCMShape {\n\t$provideOriginalResource(sourceControlHandle: number, uri: UriComponents, token: CancellationToken): Promise<UriComponents | null>;\n\t$onInputBoxValueChange(sourceControlHandle: number, value: string): void;\n\t$executeResourceCommand(sourceControlHandle: number, groupHandle: number, handle: number, preserveFocus: boolean): Promise<void>;\n\t$validateInput(sourceControlHandle: number, value: string, cursorPosition: number): Promise<[string | IMarkdownString, number] | undefined>;\n\t$setSelectedSourceControl(selectedSourceControlHandle: number | undefined): Promise<void>;\n}\n\nexport interface ExtHostTaskShape {\n\t$provideTasks(handle: number, validTypes: { [key: string]: boolean }): Promise<tasks.ITaskSetDTO>;\n\t$resolveTask(handle: number, taskDTO: tasks.ITaskDTO): Promise<tasks.ITaskDTO | undefined>;\n\t$onDidStartTask(execution: tasks.ITaskExecutionDTO, terminalId: number, resolvedDefinition: tasks.ITaskDefinitionDTO): void;\n\t$onDidStartTaskProcess(value: tasks.ITaskProcessStartedDTO): void;\n\t$onDidEndTaskProcess(value: tasks.ITaskProcessEndedDTO): void;\n\t$OnDidEndTask(execution: tasks.ITaskExecutionDTO): void;\n\t$resolveVariables(workspaceFolder: UriComponents, toResolve: { process?: { name: string; cwd?: string }; variables: string[] }): Promise<{ process?: string; variables: { [key: string]: string } }>;\n\t$jsonTasksSupported(): Promise<boolean>;\n\t$findExecutable(command: string, cwd?: string, paths?: string[]): Promise<string | undefined>;\n}\n\nexport interface IBreakpointDto {\n\ttype: string;\n\tid?: string;\n\tenabled: boolean;\n\tcondition?: string;\n\thitCondition?: string;\n\tlogMessage?: string;\n}\n\nexport interface IFunctionBreakpointDto extends IBreakpointDto {\n\ttype: 'function';\n\tfunctionName: string;\n}\n\nexport interface IDataBreakpointDto extends IBreakpointDto {\n\ttype: 'data';\n\tdataId: string;\n\tcanPersist: boolean;\n\tlabel: string;\n\taccessTypes?: DebugProtocol.DataBreakpointAccessType[];\n\taccessType: DebugProtocol.DataBreakpointAccessType;\n}\n\nexport interface ISourceBreakpointDto extends IBreakpointDto {\n\ttype: 'source';\n\turi: UriComponents;\n\tline: number;\n\tcharacter: number;\n}\n\nexport interface IBreakpointsDeltaDto {\n\tadded?: Array<ISourceBreakpointDto | IFunctionBreakpointDto | IDataBreakpointDto>;\n\tremoved?: string[];\n\tchanged?: Array<ISourceBreakpointDto | IFunctionBreakpointDto | IDataBreakpointDto>;\n}\n\nexport interface ISourceMultiBreakpointDto {\n\ttype: 'sourceMulti';\n\turi: UriComponents;\n\tlines: {\n\t\tid: string;\n\t\tenabled: boolean;\n\t\tcondition?: string;\n\t\thitCondition?: string;\n\t\tlogMessage?: string;\n\t\tline: number;\n\t\tcharacter: number;\n\t}[];\n}\n\nexport interface IDebugSessionFullDto {\n\tid: DebugSessionUUID;\n\ttype: string;\n\tname: string;\n\tparent: DebugSessionUUID | undefined;\n\tfolderUri: UriComponents | undefined;\n\tconfiguration: IConfig;\n}\n\nexport type IDebugSessionDto = IDebugSessionFullDto | DebugSessionUUID;\n\nexport interface ExtHostDebugServiceShape {\n\t$substituteVariables(folder: UriComponents | undefined, config: IConfig): Promise<IConfig>;\n\t$runInTerminal(args: DebugProtocol.RunInTerminalRequestArguments, sessionId: string): Promise<number | undefined>;\n\t$startDASession(handle: number, session: IDebugSessionDto): Promise<void>;\n\t$stopDASession(handle: number): Promise<void>;\n\t$sendDAMessage(handle: number, message: DebugProtocol.ProtocolMessage): void;\n\t$resolveDebugConfiguration(handle: number, folder: UriComponents | undefined, debugConfiguration: IConfig, token: CancellationToken): Promise<IConfig | null | undefined>;\n\t$resolveDebugConfigurationWithSubstitutedVariables(handle: number, folder: UriComponents | undefined, debugConfiguration: IConfig, token: CancellationToken): Promise<IConfig | null | undefined>;\n\t$provideDebugConfigurations(handle: number, folder: UriComponents | undefined, token: CancellationToken): Promise<IConfig[]>;\n\t$provideDebugAdapter(handle: number, session: IDebugSessionDto): Promise<Dto<IAdapterDescriptor>>;\n\t$acceptDebugSessionStarted(session: IDebugSessionDto): void;\n\t$acceptDebugSessionTerminated(session: IDebugSessionDto): void;\n\t$acceptDebugSessionActiveChanged(session: IDebugSessionDto | undefined): void;\n\t$acceptDebugSessionCustomEvent(session: IDebugSessionDto, event: any): void;\n\t$acceptBreakpointsDelta(delta: IBreakpointsDeltaDto): void;\n\t$acceptDebugSessionNameChanged(session: IDebugSessionDto, name: string): void;\n}\n\n\nexport interface DecorationRequest {\n\treadonly id: number;\n\treadonly uri: UriComponents;\n}\n\nexport type DecorationData = [boolean, string, string, ThemeColor];\nexport type DecorationReply = { [id: number]: DecorationData };\n\nexport interface ExtHostDecorationsShape {\n\t$provideDecorations(handle: number, requests: DecorationRequest[], token: CancellationToken): Promise<DecorationReply>;\n}\n\nexport interface ExtHostWindowShape {\n\t$onDidChangeWindowFocus(value: boolean): void;\n}\n\nexport interface ExtHostLogLevelServiceShape {\n\t$setLevel(level: LogLevel): void;\n}\n\nexport interface MainThreadLoggerShape {\n\t$log(file: UriComponents, messages: [LogLevel, string][]): void;\n\t$createLogger(file: UriComponents, options?: ILoggerOptions): Promise<void>;\n}\n\nexport interface ExtHostOutputServiceShape {\n\t$setVisibleChannel(channelId: string | null): void;\n}\n\nexport interface ExtHostProgressShape {\n\t$acceptProgressCanceled(handle: number): void;\n}\n\nexport interface ExtHostCommentsShape {\n\t$createCommentThreadTemplate(commentControllerHandle: number, uriComponents: UriComponents, range: IRange): void;\n\t$updateCommentThreadTemplate(commentControllerHandle: number, threadHandle: number, range: IRange): Promise<void>;\n\t$deleteCommentThread(commentControllerHandle: number, commentThreadHandle: number): void;\n\t$provideCommentingRanges(commentControllerHandle: number, uriComponents: UriComponents, token: CancellationToken): Promise<IRange[] | undefined>;\n\t$toggleReaction(commentControllerHandle: number, threadHandle: number, uri: UriComponents, comment: languages.Comment, reaction: languages.CommentReaction): Promise<void>;\n}\n\nexport interface INotebookSelectionChangeEvent {\n\tselections: ICellRange[];\n}\n\nexport interface INotebookVisibleRangesEvent {\n\tranges: ICellRange[];\n}\n\nexport interface INotebookEditorPropertiesChangeData {\n\tvisibleRanges?: INotebookVisibleRangesEvent;\n\tselections?: INotebookSelectionChangeEvent;\n}\n\nexport interface INotebookDocumentPropertiesChangeData {\n\tmetadata?: notebookCommon.NotebookDocumentMetadata;\n}\n\nexport interface INotebookModelAddedData {\n\turi: UriComponents;\n\tversionId: number;\n\tcells: NotebookCellDto[];\n\tviewType: string;\n\tmetadata?: notebookCommon.NotebookDocumentMetadata;\n}\n\nexport interface INotebookEditorAddData {\n\tid: string;\n\tdocumentUri: UriComponents;\n\tselections: ICellRange[];\n\tvisibleRanges: ICellRange[];\n\tviewColumn?: number;\n}\n\nexport interface INotebookDocumentsAndEditorsDelta {\n\tremovedDocuments?: UriComponents[];\n\taddedDocuments?: INotebookModelAddedData[];\n\tremovedEditors?: string[];\n\taddedEditors?: INotebookEditorAddData[];\n\tnewActiveEditor?: string | null;\n\tvisibleEditors?: string[];\n}\n\nexport interface NotebookOutputItemDto {\n\treadonly mime: string;\n\treadonly valueBytes: VSBuffer;\n}\n\nexport interface NotebookOutputDto {\n\titems: NotebookOutputItemDto[];\n\toutputId: string;\n\tmetadata?: Record<string, any>;\n}\n\nexport interface NotebookCellDataDto {\n\tsource: string;\n\tlanguage: string;\n\tmime: string | undefined;\n\tcellKind: notebookCommon.CellKind;\n\toutputs: NotebookOutputDto[];\n\tmetadata?: notebookCommon.NotebookCellMetadata;\n\tinternalMetadata?: notebookCommon.NotebookCellInternalMetadata;\n}\n\nexport interface NotebookDataDto {\n\treadonly cells: NotebookCellDataDto[];\n\treadonly metadata: notebookCommon.NotebookDocumentMetadata;\n}\n\nexport interface NotebookCellDto {\n\thandle: number;\n\turi: UriComponents;\n\teol: string;\n\tsource: string[];\n\tlanguage: string;\n\tmime?: string;\n\tcellKind: notebookCommon.CellKind;\n\toutputs: NotebookOutputDto[];\n\tmetadata?: notebookCommon.NotebookCellMetadata;\n\tinternalMetadata?: notebookCommon.NotebookCellInternalMetadata;\n}\n\nexport interface ExtHostNotebookShape extends ExtHostNotebookDocumentsAndEditorsShape {\n\t$provideNotebookCellStatusBarItems(handle: number, uri: UriComponents, index: number, token: CancellationToken): Promise<INotebookCellStatusBarListDto | undefined>;\n\t$releaseNotebookCellStatusBarItems(id: number): void;\n\n\t$openNotebook(viewType: string, uri: UriComponents, backupId: string | undefined, untitledDocumentData: VSBuffer | undefined, token: CancellationToken): Promise<SerializableObjectWithBuffers<NotebookDataDto>>;\n\t$saveNotebook(viewType: string, uri: UriComponents, token: CancellationToken): Promise<boolean>;\n\t$saveNotebookAs(viewType: string, uri: UriComponents, target: UriComponents, token: CancellationToken): Promise<boolean>;\n\t$backupNotebook(viewType: string, uri: UriComponents, cancellation: CancellationToken): Promise<string>;\n\n\t$dataToNotebook(handle: number, data: VSBuffer, token: CancellationToken): Promise<SerializableObjectWithBuffers<NotebookDataDto>>;\n\t$notebookToData(handle: number, data: SerializableObjectWithBuffers<NotebookDataDto>, token: CancellationToken): Promise<VSBuffer>;\n}\n\nexport interface ExtHostNotebookRenderersShape {\n\t$postRendererMessage(editorId: string, rendererId: string, message: unknown): void;\n}\n\nexport interface ExtHostNotebookDocumentsAndEditorsShape {\n\t$acceptDocumentAndEditorsDelta(delta: SerializableObjectWithBuffers<INotebookDocumentsAndEditorsDelta>): void;\n}\n\nexport type NotebookRawContentEventDto =\n\t// notebookCommon.NotebookCellsInitializeEvent<NotebookCellDto>\n\t| {\n\n\t\treadonly kind: notebookCommon.NotebookCellsChangeType.ModelChange;\n\t\treadonly changes: notebookCommon.NotebookCellTextModelSplice<NotebookCellDto>[];\n\t}\n\t| {\n\t\treadonly kind: notebookCommon.NotebookCellsChangeType.Move;\n\t\treadonly index: number;\n\t\treadonly length: number;\n\t\treadonly newIdx: number;\n\t}\n\t| {\n\t\treadonly kind: notebookCommon.NotebookCellsChangeType.Output;\n\t\treadonly index: number;\n\t\treadonly outputs: NotebookOutputDto[];\n\t}\n\t| {\n\t\treadonly kind: notebookCommon.NotebookCellsChangeType.OutputItem;\n\t\treadonly index: number;\n\t\treadonly outputId: string;\n\t\treadonly outputItems: NotebookOutputItemDto[];\n\t\treadonly append: boolean;\n\t}\n\t| notebookCommon.NotebookCellsChangeLanguageEvent\n\t| notebookCommon.NotebookCellsChangeMimeEvent\n\t| notebookCommon.NotebookCellsChangeMetadataEvent\n\t| notebookCommon.NotebookCellsChangeInternalMetadataEvent\n\t// | notebookCommon.NotebookDocumentChangeMetadataEvent\n\t| notebookCommon.NotebookCellContentChangeEvent\n\t// | notebookCommon.NotebookDocumentUnknownChangeEvent\n\t;\n\nexport type NotebookCellsChangedEventDto = {\n\treadonly rawEvents: NotebookRawContentEventDto[];\n\treadonly versionId: number;\n};\n\nexport interface ExtHostNotebookDocumentsShape {\n\t$acceptModelChanged(uriComponents: UriComponents, event: SerializableObjectWithBuffers<NotebookCellsChangedEventDto>, isDirty: boolean, newMetadata?: notebookCommon.NotebookDocumentMetadata): void;\n\t$acceptDirtyStateChanged(uriComponents: UriComponents, isDirty: boolean): void;\n\t$acceptModelSaved(uriComponents: UriComponents): void;\n}\n\nexport type INotebookEditorViewColumnInfo = Record<string, number>;\n\nexport interface ExtHostNotebookEditorsShape {\n\t$acceptEditorPropertiesChanged(id: string, data: INotebookEditorPropertiesChangeData): void;\n\t$acceptEditorViewColumns(data: INotebookEditorViewColumnInfo): void;\n}\n\nexport interface ExtHostNotebookKernelsShape {\n\t$acceptNotebookAssociation(handle: number, uri: UriComponents, value: boolean): void;\n\t$executeCells(handle: number, uri: UriComponents, handles: number[]): Promise<void>;\n\t$cancelCells(handle: number, uri: UriComponents, handles: number[]): Promise<void>;\n\t$acceptKernelMessageFromRenderer(handle: number, editorId: string, message: any): void;\n\t$cellExecutionChanged(uri: UriComponents, cellHandle: number, state: notebookCommon.NotebookCellExecutionState | undefined): void;\n}\n\nexport interface ExtHostInteractiveShape {\n\t$willAddInteractiveDocument(uri: UriComponents, eol: string, languageId: string, notebookUri: UriComponents): void;\n\t$willRemoveInteractiveDocument(uri: UriComponents, notebookUri: UriComponents): void;\n}\n\nexport interface ExtHostStorageShape {\n\t$acceptValue(shared: boolean, extensionId: string, value: object | undefined): void;\n}\n\nexport interface ExtHostThemingShape {\n\t$onColorThemeChange(themeType: string): void;\n}\n\nexport interface MainThreadThemingShape extends IDisposable {\n}\n\nexport interface TunnelDto {\n\tremoteAddress: { port: number; host: string };\n\tlocalAddress: { port: number; host: string } | string;\n\tpublic: boolean;\n\tprivacy: TunnelPrivacyId | string;\n\tprotocol: string | undefined;\n}\n\n\nexport interface ExtHostTunnelServiceShape {\n\t$forwardPort(tunnelOptions: TunnelOptions, tunnelCreationOptions: TunnelCreationOptions): Promise<TunnelDto | undefined>;\n\t$closeTunnel(remote: { host: string; port: number }, silent?: boolean): Promise<void>;\n\t$onDidTunnelsChange(): Promise<void>;\n\t$registerCandidateFinder(enable: boolean): Promise<void>;\n\t$applyCandidateFilter(candidates: CandidatePort[]): Promise<CandidatePort[]>;\n\t$providePortAttributes(handles: number[], ports: number[], pid: number | undefined, commandline: string | undefined, cancellationToken: CancellationToken): Promise<ProvidedPortAttributes[]>;\n}\n\nexport interface ExtHostTimelineShape {\n\t$getTimeline(source: string, uri: UriComponents, options: TimelineOptions, token: CancellationToken): Promise<Dto<Timeline> | undefined>;\n}\n\nexport const enum ExtHostTestingResource {\n\tWorkspace,\n\tTextDocument\n}\n\nexport interface ExtHostTestingShape {\n\t$runControllerTests(req: RunTestForControllerRequest, token: CancellationToken): Promise<void>;\n\t$cancelExtensionTestRun(runId: string | undefined): void;\n\t/** Handles a diff of tests, as a result of a subscribeToDiffs() call */\n\t$acceptDiff(diff: TestsDiffOp.Serialized[]): void;\n\t/** Publishes that a test run finished. */\n\t$publishTestResults(results: ISerializedTestResults[]): void;\n\t/** Expands a test item's children, by the given number of levels. */\n\t$expandTest(testId: string, levels: number): Promise<void>;\n\t/** Requests file coverage for a test run. Errors if not available. */\n\t$provideFileCoverage(runId: string, taskId: string, token: CancellationToken): Promise<Dto<IFileCoverage[]>>;\n\t/**\n\t * Requests coverage details for the file index in coverage data for the run.\n\t * Requires file coverage to have been previously requested via $provideFileCoverage.\n\t */\n\t$resolveFileCoverage(runId: string, taskId: string, fileIndex: number, token: CancellationToken): Promise<CoverageDetails[]>;\n\t/** Configures a test run config. */\n\t$configureRunProfile(controllerId: string, configId: number): void;\n\t/** Asks the controller to refresh its tests */\n\t$refreshTests(controllerId: string, token: CancellationToken): Promise<void>;\n}\n\nexport interface ITestControllerPatch {\n\tlabel?: string;\n\tcanRefresh?: boolean;\n}\n\nexport interface MainThreadTestingShape {\n\t// --- test lifecycle:\n\n\t/** Registers that there's a test controller with the given ID */\n\t$registerTestController(controllerId: string, label: string, canRefresh: boolean): void;\n\t/** Updates the label of an existing test controller. */\n\t$updateController(controllerId: string, patch: ITestControllerPatch): void;\n\t/** Diposes of the test controller with the given ID */\n\t$unregisterTestController(controllerId: string): void;\n\t/** Requests tests published to VS Code. */\n\t$subscribeToDiffs(): void;\n\t/** Stops requesting tests published to VS Code. */\n\t$unsubscribeFromDiffs(): void;\n\t/** Publishes that new tests were available on the given source. */\n\t$publishDiff(controllerId: string, diff: TestsDiffOp.Serialized[]): void;\n\n\t// --- test run configurations:\n\n\t/** Called when a new test run configuration is available */\n\t$publishTestRunProfile(config: ITestRunProfile): void;\n\t/** Updates an existing test run configuration */\n\t$updateTestRunConfig(controllerId: string, configId: number, update: Partial<ITestRunProfile>): void;\n\t/** Removes a previously-published test run config */\n\t$removeTestProfile(controllerId: string, configId: number): void;\n\n\n\t// --- test run handling:\n\n\t/** Request by an extension to run tests. */\n\t$runTests(req: ResolvedTestRunRequest, token: CancellationToken): Promise<string>;\n\t/**\n\t * Adds tests to the run. The tests are given in descending depth. The first\n\t * item will be a previously-known test, or a test root.\n\t */\n\t$addTestsToRun(controllerId: string, runId: string, tests: ITestItem.Serialized[]): void;\n\t/** Updates the state of a test run in the given run. */\n\t$updateTestStateInRun(runId: string, taskId: string, testId: string, state: TestResultState, duration?: number): void;\n\t/** Appends a message to a test in the run. */\n\t$appendTestMessagesInRun(runId: string, taskId: string, testId: string, messages: ITestMessage.Serialized[]): void;\n\t/** Appends raw output to the test run.. */\n\t$appendOutputToRun(runId: string, taskId: string, output: VSBuffer, location?: ILocationDto, testId?: string): void;\n\t/** Triggered when coverage is added to test results. */\n\t$signalCoverageAvailable(runId: string, taskId: string): void;\n\t/** Signals a task in a test run started. */\n\t$startedTestRunTask(runId: string, task: ITestRunTask): void;\n\t/** Signals a task in a test run ended. */\n\t$finishedTestRunTask(runId: string, taskId: string): void;\n\t/** Start a new extension-provided test run. */\n\t$startedExtensionTestRun(req: ExtensionRunTestsRequest): void;\n\t/** Signals that an extension-provided test run finished. */\n\t$finishedExtensionTestRun(runId: string): void;\n}\n\n// --- proxy identifiers\n\nexport const MainContext = {\n\tMainThreadAuthentication: createProxyIdentifier<MainThreadAuthenticationShape>('MainThreadAuthentication'),\n\tMainThreadBulkEdits: createProxyIdentifier<MainThreadBulkEditsShape>('MainThreadBulkEdits'),\n\tMainThreadClipboard: createProxyIdentifier<MainThreadClipboardShape>('MainThreadClipboard'),\n\tMainThreadCommands: createProxyIdentifier<MainThreadCommandsShape>('MainThreadCommands'),\n\tMainThreadComments: createProxyIdentifier<MainThreadCommentsShape>('MainThreadComments'),\n\tMainThreadConfiguration: createProxyIdentifier<MainThreadConfigurationShape>('MainThreadConfiguration'),\n\tMainThreadConsole: createProxyIdentifier<MainThreadConsoleShape>('MainThreadConsole'),\n\tMainThreadDebugService: createProxyIdentifier<MainThreadDebugServiceShape>('MainThreadDebugService'),\n\tMainThreadDecorations: createProxyIdentifier<MainThreadDecorationsShape>('MainThreadDecorations'),\n\tMainThreadDiagnostics: createProxyIdentifier<MainThreadDiagnosticsShape>('MainThreadDiagnostics'),\n\tMainThreadDialogs: createProxyIdentifier<MainThreadDiaglogsShape>('MainThreadDiaglogs'),\n\tMainThreadDocuments: createProxyIdentifier<MainThreadDocumentsShape>('MainThreadDocuments'),\n\tMainThreadDocumentContentProviders: createProxyIdentifier<MainThreadDocumentContentProvidersShape>('MainThreadDocumentContentProviders'),\n\tMainThreadTextEditors: createProxyIdentifier<MainThreadTextEditorsShape>('MainThreadTextEditors'),\n\tMainThreadEditorInsets: createProxyIdentifier<MainThreadEditorInsetsShape>('MainThreadEditorInsets'),\n\tMainThreadEditorTabs: createProxyIdentifier<MainThreadEditorTabsShape>('MainThreadEditorTabs'),\n\tMainThreadErrors: createProxyIdentifier<MainThreadErrorsShape>('MainThreadErrors'),\n\tMainThreadTreeViews: createProxyIdentifier<MainThreadTreeViewsShape>('MainThreadTreeViews'),\n\tMainThreadDownloadService: createProxyIdentifier<MainThreadDownloadServiceShape>('MainThreadDownloadService'),\n\tMainThreadKeytar: createProxyIdentifier<MainThreadKeytarShape>('MainThreadKeytar'),\n\tMainThreadLanguageFeatures: createProxyIdentifier<MainThreadLanguageFeaturesShape>('MainThreadLanguageFeatures'),\n\tMainThreadLanguages: createProxyIdentifier<MainThreadLanguagesShape>('MainThreadLanguages'),\n\tMainThreadLogger: createProxyIdentifier<MainThreadLoggerShape>('MainThreadLogger'),\n\tMainThreadMessageService: createProxyIdentifier<MainThreadMessageServiceShape>('MainThreadMessageService'),\n\tMainThreadOutputService: createProxyIdentifier<MainThreadOutputServiceShape>('MainThreadOutputService'),\n\tMainThreadProgress: createProxyIdentifier<MainThreadProgressShape>('MainThreadProgress'),\n\tMainThreadQuickOpen: createProxyIdentifier<MainThreadQuickOpenShape>('MainThreadQuickOpen'),\n\tMainThreadStatusBar: createProxyIdentifier<MainThreadStatusBarShape>('MainThreadStatusBar'),\n\tMainThreadSecretState: createProxyIdentifier<MainThreadSecretStateShape>('MainThreadSecretState'),\n\tMainThreadStorage: createProxyIdentifier<MainThreadStorageShape>('MainThreadStorage'),\n\tMainThreadTelemetry: createProxyIdentifier<MainThreadTelemetryShape>('MainThreadTelemetry'),\n\tMainThreadTerminalService: createProxyIdentifier<MainThreadTerminalServiceShape>('MainThreadTerminalService'),\n\tMainThreadWebviews: createProxyIdentifier<MainThreadWebviewsShape>('MainThreadWebviews'),\n\tMainThreadWebviewPanels: createProxyIdentifier<MainThreadWebviewPanelsShape>('MainThreadWebviewPanels'),\n\tMainThreadWebviewViews: createProxyIdentifier<MainThreadWebviewViewsShape>('MainThreadWebviewViews'),\n\tMainThreadCustomEditors: createProxyIdentifier<MainThreadCustomEditorsShape>('MainThreadCustomEditors'),\n\tMainThreadUrls: createProxyIdentifier<MainThreadUrlsShape>('MainThreadUrls'),\n\tMainThreadUriOpeners: createProxyIdentifier<MainThreadUriOpenersShape>('MainThreadUriOpeners'),\n\tMainThreadWorkspace: createProxyIdentifier<MainThreadWorkspaceShape>('MainThreadWorkspace'),\n\tMainThreadFileSystem: createProxyIdentifier<MainThreadFileSystemShape>('MainThreadFileSystem'),\n\tMainThreadExtensionService: createProxyIdentifier<MainThreadExtensionServiceShape>('MainThreadExtensionService'),\n\tMainThreadSCM: createProxyIdentifier<MainThreadSCMShape>('MainThreadSCM'),\n\tMainThreadSearch: createProxyIdentifier<MainThreadSearchShape>('MainThreadSearch'),\n\tMainThreadTask: createProxyIdentifier<MainThreadTaskShape>('MainThreadTask'),\n\tMainThreadWindow: createProxyIdentifier<MainThreadWindowShape>('MainThreadWindow'),\n\tMainThreadLabelService: createProxyIdentifier<MainThreadLabelServiceShape>('MainThreadLabelService'),\n\tMainThreadNotebook: createProxyIdentifier<MainThreadNotebookShape>('MainThreadNotebook'),\n\tMainThreadNotebookDocuments: createProxyIdentifier<MainThreadNotebookDocumentsShape>('MainThreadNotebookDocumentsShape'),\n\tMainThreadNotebookEditors: createProxyIdentifier<MainThreadNotebookEditorsShape>('MainThreadNotebookEditorsShape'),\n\tMainThreadNotebookKernels: createProxyIdentifier<MainThreadNotebookKernelsShape>('MainThreadNotebookKernels'),\n\tMainThreadNotebookRenderers: createProxyIdentifier<MainThreadNotebookRenderersShape>('MainThreadNotebookRenderers'),\n\tMainThreadInteractive: createProxyIdentifier<MainThreadInteractiveShape>('MainThreadInteractive'),\n\tMainThreadTheming: createProxyIdentifier<MainThreadThemingShape>('MainThreadTheming'),\n\tMainThreadTunnelService: createProxyIdentifier<MainThreadTunnelServiceShape>('MainThreadTunnelService'),\n\tMainThreadTimeline: createProxyIdentifier<MainThreadTimelineShape>('MainThreadTimeline'),\n\tMainThreadTesting: createProxyIdentifier<MainThreadTestingShape>('MainThreadTesting'),\n};\n\nexport const ExtHostContext = {\n\tExtHostCommands: createProxyIdentifier<ExtHostCommandsShape>('ExtHostCommands'),\n\tExtHostConfiguration: createProxyIdentifier<ExtHostConfigurationShape>('ExtHostConfiguration'),\n\tExtHostDiagnostics: createProxyIdentifier<ExtHostDiagnosticsShape>('ExtHostDiagnostics'),\n\tExtHostDebugService: createProxyIdentifier<ExtHostDebugServiceShape>('ExtHostDebugService'),\n\tExtHostDecorations: createProxyIdentifier<ExtHostDecorationsShape>('ExtHostDecorations'),\n\tExtHostDocumentsAndEditors: createProxyIdentifier<ExtHostDocumentsAndEditorsShape>('ExtHostDocumentsAndEditors'),\n\tExtHostDocuments: createProxyIdentifier<ExtHostDocumentsShape>('ExtHostDocuments'),\n\tExtHostDocumentContentProviders: createProxyIdentifier<ExtHostDocumentContentProvidersShape>('ExtHostDocumentContentProviders'),\n\tExtHostDocumentSaveParticipant: createProxyIdentifier<ExtHostDocumentSaveParticipantShape>('ExtHostDocumentSaveParticipant'),\n\tExtHostEditors: createProxyIdentifier<ExtHostEditorsShape>('ExtHostEditors'),\n\tExtHostTreeViews: createProxyIdentifier<ExtHostTreeViewsShape>('ExtHostTreeViews'),\n\tExtHostFileSystem: createProxyIdentifier<ExtHostFileSystemShape>('ExtHostFileSystem'),\n\tExtHostFileSystemInfo: createProxyIdentifier<ExtHostFileSystemInfoShape>('ExtHostFileSystemInfo'),\n\tExtHostFileSystemEventService: createProxyIdentifier<ExtHostFileSystemEventServiceShape>('ExtHostFileSystemEventService'),\n\tExtHostLanguages: createProxyIdentifier<ExtHostLanguagesShape>('ExtHostLanguages'),\n\tExtHostLanguageFeatures: createProxyIdentifier<ExtHostLanguageFeaturesShape>('ExtHostLanguageFeatures'),\n\tExtHostQuickOpen: createProxyIdentifier<ExtHostQuickOpenShape>('ExtHostQuickOpen'),\n\tExtHostExtensionService: createProxyIdentifier<ExtHostExtensionServiceShape>('ExtHostExtensionService'),\n\tExtHostLogLevelServiceShape: createProxyIdentifier<ExtHostLogLevelServiceShape>('ExtHostLogLevelServiceShape'),\n\tExtHostTerminalService: createProxyIdentifier<ExtHostTerminalServiceShape>('ExtHostTerminalService'),\n\tExtHostSCM: createProxyIdentifier<ExtHostSCMShape>('ExtHostSCM'),\n\tExtHostSearch: createProxyIdentifier<ExtHostSearchShape>('ExtHostSearch'),\n\tExtHostTask: createProxyIdentifier<ExtHostTaskShape>('ExtHostTask'),\n\tExtHostWorkspace: createProxyIdentifier<ExtHostWorkspaceShape>('ExtHostWorkspace'),\n\tExtHostWindow: createProxyIdentifier<ExtHostWindowShape>('ExtHostWindow'),\n\tExtHostWebviews: createProxyIdentifier<ExtHostWebviewsShape>('ExtHostWebviews'),\n\tExtHostWebviewPanels: createProxyIdentifier<ExtHostWebviewPanelsShape>('ExtHostWebviewPanels'),\n\tExtHostCustomEditors: createProxyIdentifier<ExtHostCustomEditorsShape>('ExtHostCustomEditors'),\n\tExtHostWebviewViews: createProxyIdentifier<ExtHostWebviewViewsShape>('ExtHostWebviewViews'),\n\tExtHostEditorInsets: createProxyIdentifier<ExtHostEditorInsetsShape>('ExtHostEditorInsets'),\n\tExtHostEditorTabs: createProxyIdentifier<IExtHostEditorTabsShape>('ExtHostEditorTabs'),\n\tExtHostProgress: createProxyIdentifier<ExtHostProgressShape>('ExtHostProgress'),\n\tExtHostComments: createProxyIdentifier<ExtHostCommentsShape>('ExtHostComments'),\n\tExtHostSecretState: createProxyIdentifier<ExtHostSecretStateShape>('ExtHostSecretState'),\n\tExtHostStorage: createProxyIdentifier<ExtHostStorageShape>('ExtHostStorage'),\n\tExtHostUrls: createProxyIdentifier<ExtHostUrlsShape>('ExtHostUrls'),\n\tExtHostUriOpeners: createProxyIdentifier<ExtHostUriOpenersShape>('ExtHostUriOpeners'),\n\tExtHostOutputService: createProxyIdentifier<ExtHostOutputServiceShape>('ExtHostOutputService'),\n\tExtHosLabelService: createProxyIdentifier<ExtHostLabelServiceShape>('ExtHostLabelService'),\n\tExtHostNotebook: createProxyIdentifier<ExtHostNotebookShape>('ExtHostNotebook'),\n\tExtHostNotebookDocuments: createProxyIdentifier<ExtHostNotebookDocumentsShape>('ExtHostNotebookDocuments'),\n\tExtHostNotebookEditors: createProxyIdentifier<ExtHostNotebookEditorsShape>('ExtHostNotebookEditors'),\n\tExtHostNotebookKernels: createProxyIdentifier<ExtHostNotebookKernelsShape>('ExtHostNotebookKernels'),\n\tExtHostNotebookRenderers: createProxyIdentifier<ExtHostNotebookRenderersShape>('ExtHostNotebookRenderers'),\n\tExtHostInteractive: createProxyIdentifier<ExtHostInteractiveShape>('ExtHostInteractive'),\n\tExtHostTheming: createProxyIdentifier<ExtHostThemingShape>('ExtHostTheming'),\n\tExtHostTunnelService: createProxyIdentifier<ExtHostTunnelServiceShape>('ExtHostTunnelService'),\n\tExtHostAuthentication: createProxyIdentifier<ExtHostAuthenticationShape>('ExtHostAuthentication'),\n\tExtHostTimeline: createProxyIdentifier<ExtHostTimelineShape>('ExtHostTimeline'),\n\tExtHostTesting: createProxyIdentifier<ExtHostTestingShape>('ExtHostTesting'),\n\tExtHostTelemetry: createProxyIdentifier<ExtHostTelemetryShape>('ExtHostTelemetry'),\n};\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ExtHostSecretStateShape, MainContext, MainThreadSecretStateShape } from 'vs/workbench/api/common/extHost.protocol';\nimport { Emitter } from 'vs/base/common/event';\nimport { IExtHostRpcService } from 'vs/workbench/api/common/extHostRpcService';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\n\nexport class ExtHostSecretState implements ExtHostSecretStateShape {\n\tprivate _proxy: MainThreadSecretStateShape;\n\tprivate _onDidChangePassword = new Emitter<{ extensionId: string; key: string }>();\n\treadonly onDidChangePassword = this._onDidChangePassword.event;\n\n\tconstructor(mainContext: IExtHostRpcService) {\n\t\tthis._proxy = mainContext.getProxy(MainContext.MainThreadSecretState);\n\t}\n\n\tasync $onDidChangePassword(e: { extensionId: string; key: string }): Promise<void> {\n\t\tthis._onDidChangePassword.fire(e);\n\t}\n\n\tget(extensionId: string, key: string): Promise<string | undefined> {\n\t\treturn this._proxy.$getPassword(extensionId, key);\n\t}\n\n\tstore(extensionId: string, key: string, value: string): Promise<void> {\n\t\treturn this._proxy.$setPassword(extensionId, key, value);\n\t}\n\n\tdelete(extensionId: string, key: string): Promise<void> {\n\t\treturn this._proxy.$deletePassword(extensionId, key);\n\t}\n}\n\nexport interface IExtHostSecretState extends ExtHostSecretState { }\nexport const IExtHostSecretState = createDecorator<IExtHostSecretState>('IExtHostSecretState');\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport * as extHostProtocol from 'vs/workbench/api/common/extHost.protocol';\nimport { IExtHostRpcService } from 'vs/workbench/api/common/extHostRpcService';\n\nexport interface IExtHostApiDeprecationService {\n\treadonly _serviceBrand: undefined;\n\n\treport(apiId: string, extension: IExtensionDescription, migrationSuggestion: string): void;\n}\n\nexport const IExtHostApiDeprecationService = createDecorator<IExtHostApiDeprecationService>('IExtHostApiDeprecationService');\n\nexport class ExtHostApiDeprecationService implements IExtHostApiDeprecationService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate readonly _reportedUsages = new Set<string>();\n\tprivate readonly _telemetryShape: extHostProtocol.MainThreadTelemetryShape;\n\n\tconstructor(\n\t\t@IExtHostRpcService rpc: IExtHostRpcService,\n\t\t@ILogService private readonly _extHostLogService: ILogService,\n\t) {\n\t\tthis._telemetryShape = rpc.getProxy(extHostProtocol.MainContext.MainThreadTelemetry);\n\t}\n\n\tpublic report(apiId: string, extension: IExtensionDescription, migrationSuggestion: string): void {\n\t\tconst key = this.getUsageKey(apiId, extension);\n\t\tif (this._reportedUsages.has(key)) {\n\t\t\treturn;\n\t\t}\n\t\tthis._reportedUsages.add(key);\n\n\t\tif (extension.isUnderDevelopment) {\n\t\t\tthis._extHostLogService.warn(`[Deprecation Warning] '${apiId}' is deprecated. ${migrationSuggestion}`);\n\t\t}\n\n\t\ttype DeprecationTelemetry = {\n\t\t\textensionId: string;\n\t\t\tapiId: string;\n\t\t};\n\t\ttype DeprecationTelemetryMeta = {\n\t\t\textensionId: { classification: 'SystemMetaData'; purpose: 'PerformanceAndHealth'; comment: 'The id of the extension that is using the deprecated API' };\n\t\t\tapiId: { classification: 'SystemMetaData'; purpose: 'PerformanceAndHealth'; comment: 'The id of the deprecated API' };\n\t\t\towner: 'mjbvz';\n\t\t\tcomment: 'Helps us gain insights on extensions using deprecated API so we can assist in migration to new API';\n\t\t};\n\t\tthis._telemetryShape.$publicLog2<DeprecationTelemetry, DeprecationTelemetryMeta>('extHostDeprecatedApiUsage', {\n\t\t\textensionId: extension.identifier.value,\n\t\t\tapiId: apiId,\n\t\t});\n\t}\n\n\tprivate getUsageKey(apiId: string, extension: IExtensionDescription): string {\n\t\treturn `${apiId}-${extension.identifier.value}`;\n\t}\n}\n\n\nexport const NullApiDeprecationService = Object.freeze(new class implements IExtHostApiDeprecationService {\n\tdeclare readonly _serviceBrand: undefined;\n\n\tpublic report(_apiId: string, _extension: IExtensionDescription, _warningMessage: string): void {\n\t\t// noop\n\t}\n}());\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type * as vscode from 'vscode';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { IMainContext, MainContext, MainThreadAuthenticationShape, ExtHostAuthenticationShape } from 'vs/workbench/api/common/extHost.protocol';\nimport { Disposable } from 'vs/workbench/api/common/extHostTypes';\nimport { IExtensionDescription, ExtensionIdentifier } from 'vs/platform/extensions/common/extensions';\n\ninterface GetSessionsRequest {\n\tscopes: string;\n\tproviderId: string;\n\tresult: Promise<vscode.AuthenticationSession | undefined>;\n}\n\ninterface ProviderWithMetadata {\n\tlabel: string;\n\tprovider: vscode.AuthenticationProvider;\n\toptions: vscode.AuthenticationProviderOptions;\n}\n\nexport class ExtHostAuthentication implements ExtHostAuthenticationShape {\n\tprivate _proxy: MainThreadAuthenticationShape;\n\tprivate _authenticationProviders: Map<string, ProviderWithMetadata> = new Map<string, ProviderWithMetadata>();\n\n\tprivate _providers: vscode.AuthenticationProviderInformation[] = [];\n\n\tprivate _onDidChangeSessions = new Emitter<vscode.AuthenticationSessionsChangeEvent>();\n\treadonly onDidChangeSessions: Event<vscode.AuthenticationSessionsChangeEvent> = this._onDidChangeSessions.event;\n\n\tprivate _inFlightRequests = new Map<string, GetSessionsRequest[]>();\n\n\tconstructor(mainContext: IMainContext) {\n\t\tthis._proxy = mainContext.getProxy(MainContext.MainThreadAuthentication);\n\t}\n\n\t$setProviders(providers: vscode.AuthenticationProviderInformation[]): Promise<void> {\n\t\tthis._providers = providers;\n\t\treturn Promise.resolve();\n\t}\n\n\tasync getSession(requestingExtension: IExtensionDescription, providerId: string, scopes: readonly string[], options: vscode.AuthenticationGetSessionOptions & ({ createIfNone: true } | { forceNewSession: true } | { forceNewSession: { detail: string } })): Promise<vscode.AuthenticationSession>;\n\tasync getSession(requestingExtension: IExtensionDescription, providerId: string, scopes: readonly string[], options: vscode.AuthenticationGetSessionOptions & { forceNewSession: true }): Promise<vscode.AuthenticationSession>;\n\tasync getSession(requestingExtension: IExtensionDescription, providerId: string, scopes: readonly string[], options: vscode.AuthenticationGetSessionOptions & { forceNewSession: { detail: string } }): Promise<vscode.AuthenticationSession>;\n\tasync getSession(requestingExtension: IExtensionDescription, providerId: string, scopes: readonly string[], options: vscode.AuthenticationGetSessionOptions): Promise<vscode.AuthenticationSession | undefined>;\n\tasync getSession(requestingExtension: IExtensionDescription, providerId: string, scopes: readonly string[], options: vscode.AuthenticationGetSessionOptions = {}): Promise<vscode.AuthenticationSession | undefined> {\n\t\tconst extensionId = ExtensionIdentifier.toKey(requestingExtension.identifier);\n\t\tconst inFlightRequests = this._inFlightRequests.get(extensionId) || [];\n\t\tconst sortedScopes = [...scopes].sort().join(' ');\n\t\tlet inFlightRequest: GetSessionsRequest | undefined = inFlightRequests.find(request => request.providerId === providerId && request.scopes === sortedScopes);\n\n\t\tif (inFlightRequest) {\n\t\t\treturn inFlightRequest.result;\n\t\t} else {\n\t\t\tconst session = this._getSession(requestingExtension, extensionId, providerId, scopes, options);\n\t\t\tinFlightRequest = {\n\t\t\t\tproviderId,\n\t\t\t\tscopes: sortedScopes,\n\t\t\t\tresult: session\n\t\t\t};\n\n\t\t\tinFlightRequests.push(inFlightRequest);\n\t\t\tthis._inFlightRequests.set(extensionId, inFlightRequests);\n\n\t\t\ttry {\n\t\t\t\tawait session;\n\t\t\t} finally {\n\t\t\t\tconst requestIndex = inFlightRequests.findIndex(request => request.providerId === providerId && request.scopes === sortedScopes);\n\t\t\t\tif (requestIndex > -1) {\n\t\t\t\t\tinFlightRequests.splice(requestIndex);\n\t\t\t\t\tthis._inFlightRequests.set(extensionId, inFlightRequests);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn session;\n\t\t}\n\t}\n\n\tprivate async _getSession(requestingExtension: IExtensionDescription, extensionId: string, providerId: string, scopes: readonly string[], options: vscode.AuthenticationGetSessionOptions = {}): Promise<vscode.AuthenticationSession | undefined> {\n\t\tawait this._proxy.$ensureProvider(providerId);\n\t\tconst extensionName = requestingExtension.displayName || requestingExtension.name;\n\t\treturn this._proxy.$getSession(providerId, scopes, extensionId, extensionName, options);\n\t}\n\n\tasync removeSession(providerId: string, sessionId: string): Promise<void> {\n\t\tconst providerData = this._authenticationProviders.get(providerId);\n\t\tif (!providerData) {\n\t\t\treturn this._proxy.$removeSession(providerId, sessionId);\n\t\t}\n\n\t\treturn providerData.provider.removeSession(sessionId);\n\t}\n\n\tregisterAuthenticationProvider(id: string, label: string, provider: vscode.AuthenticationProvider, options?: vscode.AuthenticationProviderOptions): vscode.Disposable {\n\t\tif (this._authenticationProviders.get(id)) {\n\t\t\tthrow new Error(`An authentication provider with id '${id}' is already registered.`);\n\t\t}\n\n\t\tthis._authenticationProviders.set(id, { label, provider, options: options ?? { supportsMultipleAccounts: false } });\n\n\t\tif (!this._providers.find(p => p.id === id)) {\n\t\t\tthis._providers.push({\n\t\t\t\tid: id,\n\t\t\t\tlabel: label\n\t\t\t});\n\t\t}\n\n\t\tconst listener = provider.onDidChangeSessions(e => {\n\t\t\tthis._proxy.$sendDidChangeSessions(id, {\n\t\t\t\tadded: e.added ?? [],\n\t\t\t\tchanged: e.changed ?? [],\n\t\t\t\tremoved: e.removed ?? []\n\t\t\t});\n\t\t});\n\n\t\tthis._proxy.$registerAuthenticationProvider(id, label, options?.supportsMultipleAccounts ?? false);\n\n\t\treturn new Disposable(() => {\n\t\t\tlistener.dispose();\n\t\t\tthis._authenticationProviders.delete(id);\n\n\t\t\tconst i = this._providers.findIndex(p => p.id === id);\n\t\t\tif (i > -1) {\n\t\t\t\tthis._providers.splice(i);\n\t\t\t}\n\n\t\t\tthis._proxy.$unregisterAuthenticationProvider(id);\n\t\t});\n\t}\n\n\t$createSession(providerId: string, scopes: string[]): Promise<vscode.AuthenticationSession> {\n\t\tconst providerData = this._authenticationProviders.get(providerId);\n\t\tif (providerData) {\n\t\t\treturn Promise.resolve(providerData.provider.createSession(scopes));\n\t\t}\n\n\t\tthrow new Error(`Unable to find authentication provider with handle: ${providerId}`);\n\t}\n\n\t$removeSession(providerId: string, sessionId: string): Promise<void> {\n\t\tconst providerData = this._authenticationProviders.get(providerId);\n\t\tif (providerData) {\n\t\t\treturn Promise.resolve(providerData.provider.removeSession(sessionId));\n\t\t}\n\n\t\tthrow new Error(`Unable to find authentication provider with handle: ${providerId}`);\n\t}\n\n\t$getSessions(providerId: string, scopes?: string[]): Promise<ReadonlyArray<vscode.AuthenticationSession>> {\n\t\tconst providerData = this._authenticationProviders.get(providerId);\n\t\tif (providerData) {\n\t\t\treturn Promise.resolve(providerData.provider.getSessions(scopes));\n\t\t}\n\n\t\tthrow new Error(`Unable to find authentication provider with handle: ${providerId}`);\n\t}\n\n\t$onDidChangeAuthenticationSessions(id: string, label: string) {\n\t\tthis._onDidChangeSessions.fire({ provider: { id, label } });\n\t\treturn Promise.resolve();\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { MainContext, MainThreadBulkEditsShape } from 'vs/workbench/api/common/extHost.protocol';\nimport { ExtHostDocumentsAndEditors } from 'vs/workbench/api/common/extHostDocumentsAndEditors';\nimport { IExtHostRpcService } from 'vs/workbench/api/common/extHostRpcService';\nimport { WorkspaceEdit } from 'vs/workbench/api/common/extHostTypeConverters';\nimport { isProposedApiEnabled } from 'vs/workbench/services/extensions/common/extensions';\nimport type * as vscode from 'vscode';\n\nexport class ExtHostBulkEdits {\n\n\tprivate readonly _proxy: MainThreadBulkEditsShape;\n\tprivate readonly _versionInformationProvider: WorkspaceEdit.IVersionInformationProvider;\n\n\tconstructor(\n\t\t@IExtHostRpcService extHostRpc: IExtHostRpcService,\n\t\textHostDocumentsAndEditors: ExtHostDocumentsAndEditors,\n\t) {\n\t\tthis._proxy = extHostRpc.getProxy(MainContext.MainThreadBulkEdits);\n\n\t\tthis._versionInformationProvider = {\n\t\t\tgetTextDocumentVersion: uri => extHostDocumentsAndEditors.getDocument(uri)?.version,\n\t\t\tgetNotebookDocumentVersion: () => undefined\n\t\t};\n\t}\n\n\tapplyWorkspaceEdit(edit: vscode.WorkspaceEdit, extension: IExtensionDescription): Promise<boolean> {\n\t\tconst allowSnippetTextEdit = isProposedApiEnabled(extension, 'snippetWorkspaceEdit');\n\t\tconst dto = WorkspaceEdit.from(edit, this._versionInformationProvider, allowSnippetTextEdit);\n\t\treturn this._proxy.$tryApplyWorkspaceEdit(dto);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IMainContext, MainContext } from 'vs/workbench/api/common/extHost.protocol';\nimport type * as vscode from 'vscode';\n\nexport class ExtHostClipboard {\n\n\treadonly value: vscode.Clipboard;\n\n\tconstructor(mainContext: IMainContext) {\n\t\tconst proxy = mainContext.getProxy(MainContext.MainThreadClipboard);\n\t\tthis.value = Object.freeze({\n\t\t\treadText() {\n\t\t\t\treturn proxy.$readText();\n\t\t\t},\n\t\t\twriteText(value: string) {\n\t\t\t\treturn proxy.$writeText(value);\n\t\t\t}\n\t\t});\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { validateConstraint } from 'vs/base/common/types';\nimport { ICommandHandlerDescription } from 'vs/platform/commands/common/commands';\nimport * as extHostTypes from 'vs/workbench/api/common/extHostTypes';\nimport * as extHostTypeConverter from 'vs/workbench/api/common/extHostTypeConverters';\nimport { cloneAndChange } from 'vs/base/common/objects';\nimport { MainContext, MainThreadCommandsShape, ExtHostCommandsShape, ICommandDto, ICommandHandlerDescriptionDto, MainThreadTelemetryShape } from './extHost.protocol';\nimport { isNonEmptyArray } from 'vs/base/common/arrays';\nimport * as languages from 'vs/editor/common/languages';\nimport type * as vscode from 'vscode';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { revive } from 'vs/base/common/marshalling';\nimport { IRange, Range } from 'vs/editor/common/core/range';\nimport { IPosition, Position } from 'vs/editor/common/core/position';\nimport { URI } from 'vs/base/common/uri';\nimport { DisposableStore, toDisposable } from 'vs/base/common/lifecycle';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { IExtHostRpcService } from 'vs/workbench/api/common/extHostRpcService';\nimport { ISelection } from 'vs/editor/common/core/selection';\nimport { TestItemImpl } from 'vs/workbench/api/common/extHostTestItem';\nimport { VSBuffer } from 'vs/base/common/buffer';\nimport { SerializableObjectWithBuffers } from 'vs/workbench/services/extensions/common/proxyIdentifier';\nimport { toErrorMessage } from 'vs/base/common/errorMessage';\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\n\ninterface CommandHandler {\n\tcallback: Function;\n\tthisArg: any;\n\tdescription?: ICommandHandlerDescription;\n\textension?: IExtensionDescription;\n}\n\nexport interface ArgumentProcessor {\n\tprocessArgument(arg: any): any;\n}\n\nexport class ExtHostCommands implements ExtHostCommandsShape {\n\n\treadonly _serviceBrand: undefined;\n\n\t#proxy: MainThreadCommandsShape;\n\n\tprivate readonly _commands = new Map<string, CommandHandler>();\n\tprivate readonly _apiCommands = new Map<string, ApiCommand>();\n\t#telemetry: MainThreadTelemetryShape;\n\n\tprivate readonly _logService: ILogService;\n\tprivate readonly _argumentProcessors: ArgumentProcessor[];\n\n\treadonly converter: CommandsConverter;\n\n\tconstructor(\n\t\t@IExtHostRpcService extHostRpc: IExtHostRpcService,\n\t\t@ILogService logService: ILogService\n\t) {\n\t\tthis.#proxy = extHostRpc.getProxy(MainContext.MainThreadCommands);\n\t\tthis._logService = logService;\n\t\tthis.#telemetry = extHostRpc.getProxy(MainContext.MainThreadTelemetry);\n\t\tthis.converter = new CommandsConverter(\n\t\t\tthis,\n\t\t\tid => {\n\t\t\t\t// API commands that have no return type (void) can be\n\t\t\t\t// converted to their internal command and don't need\n\t\t\t\t// any indirection commands\n\t\t\t\tconst candidate = this._apiCommands.get(id);\n\t\t\t\treturn candidate?.result === ApiCommandResult.Void\n\t\t\t\t\t? candidate : undefined;\n\t\t\t},\n\t\t\tlogService\n\t\t);\n\t\tthis._argumentProcessors = [\n\t\t\t{\n\t\t\t\tprocessArgument(a) {\n\t\t\t\t\t// URI, Regex\n\t\t\t\t\treturn revive(a);\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tprocessArgument(arg) {\n\t\t\t\t\treturn cloneAndChange(arg, function (obj) {\n\t\t\t\t\t\t// Reverse of https://github.com/microsoft/vscode/blob/1f28c5fc681f4c01226460b6d1c7e91b8acb4a5b/src/vs/workbench/api/node/extHostCommands.ts#L112-L127\n\t\t\t\t\t\tif (Range.isIRange(obj)) {\n\t\t\t\t\t\t\treturn extHostTypeConverter.Range.to(obj);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (Position.isIPosition(obj)) {\n\t\t\t\t\t\t\treturn extHostTypeConverter.Position.to(obj);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (Range.isIRange((obj as languages.Location).range) && URI.isUri((obj as languages.Location).uri)) {\n\t\t\t\t\t\t\treturn extHostTypeConverter.location.to(obj);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (obj instanceof VSBuffer) {\n\t\t\t\t\t\t\treturn obj.buffer.buffer;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!Array.isArray(obj)) {\n\t\t\t\t\t\t\treturn obj;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t}\n\n\tregisterArgumentProcessor(processor: ArgumentProcessor): void {\n\t\tthis._argumentProcessors.push(processor);\n\t}\n\n\tregisterApiCommand(apiCommand: ApiCommand): extHostTypes.Disposable {\n\n\n\t\tconst registration = this.registerCommand(false, apiCommand.id, async (...apiArgs) => {\n\n\t\t\tconst internalArgs = apiCommand.args.map((arg, i) => {\n\t\t\t\tif (!arg.validate(apiArgs[i])) {\n\t\t\t\t\tthrow new Error(`Invalid argument '${arg.name}' when running '${apiCommand.id}', received: ${apiArgs[i]}`);\n\t\t\t\t}\n\t\t\t\treturn arg.convert(apiArgs[i]);\n\t\t\t});\n\n\t\t\tconst internalResult = await this.executeCommand(apiCommand.internalId, ...internalArgs);\n\t\t\treturn apiCommand.result.convert(internalResult, apiArgs, this.converter);\n\t\t}, undefined, {\n\t\t\tdescription: apiCommand.description,\n\t\t\targs: apiCommand.args,\n\t\t\treturns: apiCommand.result.description\n\t\t});\n\n\t\tthis._apiCommands.set(apiCommand.id, apiCommand);\n\n\t\treturn new extHostTypes.Disposable(() => {\n\t\t\tregistration.dispose();\n\t\t\tthis._apiCommands.delete(apiCommand.id);\n\t\t});\n\t}\n\n\tregisterCommand(global: boolean, id: string, callback: <T>(...args: any[]) => T | Thenable<T>, thisArg?: any, description?: ICommandHandlerDescription, extension?: IExtensionDescription): extHostTypes.Disposable {\n\t\tthis._logService.trace('ExtHostCommands#registerCommand', id);\n\n\t\tif (!id.trim().length) {\n\t\t\tthrow new Error('invalid id');\n\t\t}\n\n\t\tif (this._commands.has(id)) {\n\t\t\tthrow new Error(`command '${id}' already exists`);\n\t\t}\n\n\t\tthis._commands.set(id, { callback, thisArg, description, extension });\n\t\tif (global) {\n\t\t\tthis.#proxy.$registerCommand(id);\n\t\t}\n\n\t\treturn new extHostTypes.Disposable(() => {\n\t\t\tif (this._commands.delete(id)) {\n\t\t\t\tif (global) {\n\t\t\t\t\tthis.#proxy.$unregisterCommand(id);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\texecuteCommand<T>(id: string, ...args: any[]): Promise<T> {\n\t\tthis._logService.trace('ExtHostCommands#executeCommand', id);\n\t\treturn this._doExecuteCommand(id, args, true);\n\t}\n\n\tprivate async _doExecuteCommand<T>(id: string, args: any[], retry: boolean): Promise<T> {\n\n\t\tif (this._commands.has(id)) {\n\t\t\t// - We stay inside the extension host and support\n\t\t\t// \t to pass any kind of parameters around.\n\t\t\t// - We still emit the corresponding activation event\n\t\t\t//   BUT we don't await that event\n\t\t\tthis.#proxy.$fireCommandActivationEvent(id);\n\t\t\treturn this._executeContributedCommand<T>(id, args, false);\n\n\t\t} else {\n\t\t\t// automagically convert some argument types\n\t\t\tlet hasBuffers = false;\n\t\t\tconst toArgs = cloneAndChange(args, function (value) {\n\t\t\t\tif (value instanceof extHostTypes.Position) {\n\t\t\t\t\treturn extHostTypeConverter.Position.from(value);\n\t\t\t\t} else if (value instanceof extHostTypes.Range) {\n\t\t\t\t\treturn extHostTypeConverter.Range.from(value);\n\t\t\t\t} else if (value instanceof extHostTypes.Location) {\n\t\t\t\t\treturn extHostTypeConverter.location.from(value);\n\t\t\t\t} else if (extHostTypes.NotebookRange.isNotebookRange(value)) {\n\t\t\t\t\treturn extHostTypeConverter.NotebookRange.from(value);\n\t\t\t\t} else if (value instanceof ArrayBuffer) {\n\t\t\t\t\thasBuffers = true;\n\t\t\t\t\treturn VSBuffer.wrap(new Uint8Array(value));\n\t\t\t\t} else if (value instanceof Uint8Array) {\n\t\t\t\t\thasBuffers = true;\n\t\t\t\t\treturn VSBuffer.wrap(value);\n\t\t\t\t} else if (value instanceof VSBuffer) {\n\t\t\t\t\thasBuffers = true;\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\t\t\t\tif (!Array.isArray(value)) {\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\ttry {\n\t\t\t\tconst result = await this.#proxy.$executeCommand(id, hasBuffers ? new SerializableObjectWithBuffers(toArgs) : toArgs, retry);\n\t\t\t\treturn revive<any>(result);\n\t\t\t} catch (e) {\n\t\t\t\t// Rerun the command when it wasn't known, had arguments, and when retry\n\t\t\t\t// is enabled. We do this because the command might be registered inside\n\t\t\t\t// the extension host now and can therefore accept the arguments as-is.\n\t\t\t\tif (e instanceof Error && e.message === '$executeCommand:retry') {\n\t\t\t\t\treturn this._doExecuteCommand(id, args, false);\n\t\t\t\t} else {\n\t\t\t\t\tthrow e;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate async _executeContributedCommand<T = unknown>(id: string, args: any[], annotateError: boolean): Promise<T> {\n\t\tconst command = this._commands.get(id);\n\t\tif (!command) {\n\t\t\tthrow new Error('Unknown command');\n\t\t}\n\t\tthis._reportTelemetry(command, id);\n\t\tconst { callback, thisArg, description } = command;\n\t\tif (description) {\n\t\t\tfor (let i = 0; i < description.args.length; i++) {\n\t\t\t\ttry {\n\t\t\t\t\tvalidateConstraint(args[i], description.args[i].constraint);\n\t\t\t\t} catch (err) {\n\t\t\t\t\tthrow new Error(`Running the contributed command: '${id}' failed. Illegal argument '${description.args[i].name}' - ${description.args[i].description}`);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\ttry {\n\t\t\treturn await callback.apply(thisArg, args);\n\t\t} catch (err) {\n\t\t\t// The indirection-command from the converter can fail when invoking the actual\n\t\t\t// command and in that case it is better to blame the correct command\n\t\t\tif (id === this.converter.delegatingCommandId) {\n\t\t\t\tconst actual = this.converter.getActualCommand(...args);\n\t\t\t\tif (actual) {\n\t\t\t\t\tid = actual.command;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._logService.error(err, id, command.extension?.identifier);\n\n\t\t\tif (!annotateError) {\n\t\t\t\tthrow err;\n\t\t\t}\n\n\t\t\tthrow new class CommandError extends Error {\n\t\t\t\treadonly id = id;\n\t\t\t\treadonly source = command!.extension?.displayName ?? command!.extension?.name;\n\t\t\t\tconstructor() {\n\t\t\t\t\tsuper(toErrorMessage(err));\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n\n\tprivate _reportTelemetry(command: CommandHandler, id: string) {\n\t\tif (!command.extension || command.extension.isBuiltin) {\n\t\t\treturn;\n\t\t}\n\t\ttype ExtensionActionTelemetry = {\n\t\t\textensionId: string;\n\t\t\tid: string;\n\t\t};\n\t\ttype ExtensionActionTelemetryMeta = {\n\t\t\textensionId: { classification: 'SystemMetaData'; purpose: 'FeatureInsight'; comment: 'The id of the extension handling the command, informing which extensions provide most-used functionality.' };\n\t\t\tid: { classification: 'SystemMetaData'; purpose: 'FeatureInsight'; comment: 'The id of the command, to understand which specific extension features are most popular.' };\n\t\t\towner: 'digitarald';\n\t\t\tcomment: 'Used to gain insight on the most popular commands used from extensions';\n\t\t};\n\t\tthis.#telemetry.$publicLog2<ExtensionActionTelemetry, ExtensionActionTelemetryMeta>('Extension:ActionExecuted', {\n\t\t\textensionId: command.extension.identifier.value,\n\t\t\tid: id,\n\t\t});\n\t}\n\n\t$executeContributedCommand(id: string, ...args: any[]): Promise<unknown> {\n\t\tthis._logService.trace('ExtHostCommands#$executeContributedCommand', id);\n\n\t\tif (!this._commands.has(id)) {\n\t\t\treturn Promise.reject(new Error(`Contributed command '${id}' does not exist.`));\n\t\t} else {\n\t\t\targs = args.map(arg => this._argumentProcessors.reduce((r, p) => p.processArgument(r), arg));\n\t\t\treturn this._executeContributedCommand(id, args, true);\n\t\t}\n\t}\n\n\tgetCommands(filterUnderscoreCommands: boolean = false): Promise<string[]> {\n\t\tthis._logService.trace('ExtHostCommands#getCommands', filterUnderscoreCommands);\n\n\t\treturn this.#proxy.$getCommands().then(result => {\n\t\t\tif (filterUnderscoreCommands) {\n\t\t\t\tresult = result.filter(command => command[0] !== '_');\n\t\t\t}\n\t\t\treturn result;\n\t\t});\n\t}\n\n\t$getContributedCommandHandlerDescriptions(): Promise<{ [id: string]: string | ICommandHandlerDescriptionDto }> {\n\t\tconst result: { [id: string]: string | ICommandHandlerDescription } = Object.create(null);\n\t\tfor (const [id, command] of this._commands) {\n\t\t\tconst { description } = command;\n\t\t\tif (description) {\n\t\t\t\tresult[id] = description;\n\t\t\t}\n\t\t}\n\t\treturn Promise.resolve(result);\n\t}\n}\n\nexport interface IExtHostCommands extends ExtHostCommands { }\nexport const IExtHostCommands = createDecorator<IExtHostCommands>('IExtHostCommands');\n\nexport class CommandsConverter implements extHostTypeConverter.Command.ICommandsConverter {\n\n\treadonly delegatingCommandId: string = `_vscode_delegate_cmd_${Date.now().toString(36)}`;\n\tprivate readonly _cache = new Map<number, vscode.Command>();\n\tprivate _cachIdPool = 0;\n\n\t// --- conversion between internal and api commands\n\tconstructor(\n\t\tprivate readonly _commands: ExtHostCommands,\n\t\tprivate readonly _lookupApiCommand: (id: string) => ApiCommand | undefined,\n\t\tprivate readonly _logService: ILogService\n\t) {\n\t\tthis._commands.registerCommand(true, this.delegatingCommandId, this._executeConvertedCommand, this);\n\t}\n\n\ttoInternal(command: vscode.Command, disposables: DisposableStore): ICommandDto;\n\ttoInternal(command: vscode.Command | undefined, disposables: DisposableStore): ICommandDto | undefined;\n\ttoInternal(command: vscode.Command | undefined, disposables: DisposableStore): ICommandDto | undefined {\n\n\t\tif (!command) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst result: ICommandDto = {\n\t\t\t$ident: undefined,\n\t\t\tid: command.command,\n\t\t\ttitle: command.title,\n\t\t\ttooltip: command.tooltip\n\t\t};\n\n\t\tif (!command.command) {\n\t\t\t// falsy command id -> return converted command but don't attempt any\n\t\t\t// argument or API-command dance since this command won't run anyways\n\t\t\treturn result;\n\t\t}\n\n\t\tconst apiCommand = this._lookupApiCommand(command.command);\n\t\tif (apiCommand) {\n\t\t\t// API command with return-value can be converted inplace\n\t\t\tresult.id = apiCommand.internalId;\n\t\t\tresult.arguments = apiCommand.args.map((arg, i) => arg.convert(command.arguments && command.arguments[i]));\n\n\n\t\t} else if (isNonEmptyArray(command.arguments)) {\n\t\t\t// we have a contributed command with arguments. that\n\t\t\t// means we don't want to send the arguments around\n\n\t\t\tconst id = ++this._cachIdPool;\n\t\t\tthis._cache.set(id, command);\n\t\t\tdisposables.add(toDisposable(() => {\n\t\t\t\tthis._cache.delete(id);\n\t\t\t\tthis._logService.trace('CommandsConverter#DISPOSE', id);\n\t\t\t}));\n\t\t\tresult.$ident = id;\n\n\t\t\tresult.id = this.delegatingCommandId;\n\t\t\tresult.arguments = [id];\n\n\t\t\tthis._logService.trace('CommandsConverter#CREATE', command.command, id);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tfromInternal(command: ICommandDto): vscode.Command | undefined {\n\n\t\tif (typeof command.$ident === 'number') {\n\t\t\treturn this._cache.get(command.$ident);\n\n\t\t} else {\n\t\t\treturn {\n\t\t\t\tcommand: command.id,\n\t\t\t\ttitle: command.title,\n\t\t\t\targuments: command.arguments\n\t\t\t};\n\t\t}\n\t}\n\n\n\tgetActualCommand(...args: any[]): vscode.Command | undefined {\n\t\treturn this._cache.get(args[0]);\n\t}\n\n\tprivate _executeConvertedCommand<R>(...args: any[]): Promise<R> {\n\t\tconst actualCmd = this.getActualCommand(...args);\n\t\tthis._logService.trace('CommandsConverter#EXECUTE', args[0], actualCmd ? actualCmd.command : 'MISSING');\n\n\t\tif (!actualCmd) {\n\t\t\treturn Promise.reject('actual command NOT FOUND');\n\t\t}\n\t\treturn this._commands.executeCommand(actualCmd.command, ...(actualCmd.arguments || []));\n\t}\n\n}\n\n\nexport class ApiCommandArgument<V, O = V> {\n\n\tstatic readonly Uri = new ApiCommandArgument<URI>('uri', 'Uri of a text document', v => URI.isUri(v), v => v);\n\tstatic readonly Position = new ApiCommandArgument<extHostTypes.Position, IPosition>('position', 'A position in a text document', v => extHostTypes.Position.isPosition(v), extHostTypeConverter.Position.from);\n\tstatic readonly Range = new ApiCommandArgument<extHostTypes.Range, IRange>('range', 'A range in a text document', v => extHostTypes.Range.isRange(v), extHostTypeConverter.Range.from);\n\tstatic readonly Selection = new ApiCommandArgument<extHostTypes.Selection, ISelection>('selection', 'A selection in a text document', v => extHostTypes.Selection.isSelection(v), extHostTypeConverter.Selection.from);\n\tstatic readonly Number = new ApiCommandArgument<number>('number', '', v => typeof v === 'number', v => v);\n\tstatic readonly String = new ApiCommandArgument<string>('string', '', v => typeof v === 'string', v => v);\n\n\tstatic readonly CallHierarchyItem = new ApiCommandArgument('item', 'A call hierarchy item', v => v instanceof extHostTypes.CallHierarchyItem, extHostTypeConverter.CallHierarchyItem.from);\n\tstatic readonly TypeHierarchyItem = new ApiCommandArgument('item', 'A type hierarchy item', v => v instanceof extHostTypes.TypeHierarchyItem, extHostTypeConverter.TypeHierarchyItem.from);\n\tstatic readonly TestItem = new ApiCommandArgument('testItem', 'A VS Code TestItem', v => v instanceof TestItemImpl, extHostTypeConverter.TestItem.from);\n\n\tconstructor(\n\t\treadonly name: string,\n\t\treadonly description: string,\n\t\treadonly validate: (v: V) => boolean,\n\t\treadonly convert: (v: V) => O\n\t) { }\n\n\toptional(): ApiCommandArgument<V | undefined | null, O | undefined | null> {\n\t\treturn new ApiCommandArgument(\n\t\t\tthis.name, `(optional) ${this.description}`,\n\t\t\tvalue => value === undefined || value === null || this.validate(value),\n\t\t\tvalue => value === undefined ? undefined : value === null ? null : this.convert(value)\n\t\t);\n\t}\n\n\twith(name: string | undefined, description: string | undefined): ApiCommandArgument<V, O> {\n\t\treturn new ApiCommandArgument(name ?? this.name, description ?? this.description, this.validate, this.convert);\n\t}\n}\n\nexport class ApiCommandResult<V, O = V> {\n\n\tstatic readonly Void = new ApiCommandResult<void, void>('no result', v => v);\n\n\tconstructor(\n\t\treadonly description: string,\n\t\treadonly convert: (v: V, apiArgs: any[], cmdConverter: CommandsConverter) => O\n\t) { }\n}\n\nexport class ApiCommand {\n\n\tconstructor(\n\t\treadonly id: string,\n\t\treadonly internalId: string,\n\t\treadonly description: string,\n\t\treadonly args: ApiCommandArgument<any, any>[],\n\t\treadonly result: ApiCommandResult<any, any>\n\t) { }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { URI } from 'vs/base/common/uri';\nimport type * as vscode from 'vscode';\nimport * as typeConverters from 'vs/workbench/api/common/extHostTypeConverters';\nimport * as types from 'vs/workbench/api/common/extHostTypes';\nimport { IRawColorInfo, IWorkspaceEditDto, ICallHierarchyItemDto, IIncomingCallDto, IOutgoingCallDto, ITypeHierarchyItemDto } from 'vs/workbench/api/common/extHost.protocol';\nimport * as languages from 'vs/editor/common/languages';\nimport * as search from 'vs/workbench/contrib/search/common/search';\nimport { ApiCommand, ApiCommandArgument, ApiCommandResult, ExtHostCommands } from 'vs/workbench/api/common/extHostCommands';\nimport { CustomCodeAction } from 'vs/workbench/api/common/extHostLanguageFeatures';\nimport { isFalsyOrEmpty } from 'vs/base/common/arrays';\nimport { IRange } from 'vs/editor/common/core/range';\nimport { IPosition } from 'vs/editor/common/core/position';\nimport { TransientCellMetadata, TransientDocumentMetadata } from 'vs/workbench/contrib/notebook/common/notebookCommon';\nimport { ITextEditorOptions } from 'vs/platform/editor/common/editor';\nimport { VSBuffer } from 'vs/base/common/buffer';\nimport { decodeSemanticTokensDto } from 'vs/editor/common/services/semanticTokensDto';\nimport { matchesSomeScheme } from 'vs/platform/opener/common/opener';\nimport { Schemas } from 'vs/base/common/network';\n\n//#region --- NEW world\n\nconst newCommands: ApiCommand[] = [\n\t// -- document highlights\n\tnew ApiCommand(\n\t\t'vscode.executeDocumentHighlights', '_executeDocumentHighlights', 'Execute document highlight provider.',\n\t\t[ApiCommandArgument.Uri, ApiCommandArgument.Position],\n\t\tnew ApiCommandResult<languages.DocumentHighlight[], types.DocumentHighlight[] | undefined>('A promise that resolves to an array of DocumentHighlight-instances.', tryMapWith(typeConverters.DocumentHighlight.to))\n\t),\n\t// -- document symbols\n\tnew ApiCommand(\n\t\t'vscode.executeDocumentSymbolProvider', '_executeDocumentSymbolProvider', 'Execute document symbol provider.',\n\t\t[ApiCommandArgument.Uri],\n\t\tnew ApiCommandResult<languages.DocumentSymbol[], vscode.SymbolInformation[] | undefined>('A promise that resolves to an array of SymbolInformation and DocumentSymbol instances.', (value, apiArgs) => {\n\n\t\t\tif (isFalsyOrEmpty(value)) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\tclass MergedInfo extends types.SymbolInformation implements vscode.DocumentSymbol {\n\t\t\t\tstatic to(symbol: languages.DocumentSymbol): MergedInfo {\n\t\t\t\t\tconst res = new MergedInfo(\n\t\t\t\t\t\tsymbol.name,\n\t\t\t\t\t\ttypeConverters.SymbolKind.to(symbol.kind),\n\t\t\t\t\t\tsymbol.containerName || '',\n\t\t\t\t\t\tnew types.Location(apiArgs[0], typeConverters.Range.to(symbol.range))\n\t\t\t\t\t);\n\t\t\t\t\tres.detail = symbol.detail;\n\t\t\t\t\tres.range = res.location.range;\n\t\t\t\t\tres.selectionRange = typeConverters.Range.to(symbol.selectionRange);\n\t\t\t\t\tres.children = symbol.children ? symbol.children.map(MergedInfo.to) : [];\n\t\t\t\t\treturn res;\n\t\t\t\t}\n\n\t\t\t\tdetail!: string;\n\t\t\t\trange!: vscode.Range;\n\t\t\t\tselectionRange!: vscode.Range;\n\t\t\t\tchildren!: vscode.DocumentSymbol[];\n\t\t\t\toverride containerName!: string;\n\t\t\t}\n\t\t\treturn value.map(MergedInfo.to);\n\n\t\t})\n\t),\n\t// -- formatting\n\tnew ApiCommand(\n\t\t'vscode.executeFormatDocumentProvider', '_executeFormatDocumentProvider', 'Execute document format provider.',\n\t\t[ApiCommandArgument.Uri, new ApiCommandArgument('options', 'Formatting options', _ => true, v => v)],\n\t\tnew ApiCommandResult<languages.TextEdit[], types.TextEdit[] | undefined>('A promise that resolves to an array of TextEdits.', tryMapWith(typeConverters.TextEdit.to))\n\t),\n\tnew ApiCommand(\n\t\t'vscode.executeFormatRangeProvider', '_executeFormatRangeProvider', 'Execute range format provider.',\n\t\t[ApiCommandArgument.Uri, ApiCommandArgument.Range, new ApiCommandArgument('options', 'Formatting options', _ => true, v => v)],\n\t\tnew ApiCommandResult<languages.TextEdit[], types.TextEdit[] | undefined>('A promise that resolves to an array of TextEdits.', tryMapWith(typeConverters.TextEdit.to))\n\t),\n\tnew ApiCommand(\n\t\t'vscode.executeFormatOnTypeProvider', '_executeFormatOnTypeProvider', 'Execute format on type provider.',\n\t\t[ApiCommandArgument.Uri, ApiCommandArgument.Position, new ApiCommandArgument('ch', 'Trigger character', v => typeof v === 'string', v => v), new ApiCommandArgument('options', 'Formatting options', _ => true, v => v)],\n\t\tnew ApiCommandResult<languages.TextEdit[], types.TextEdit[] | undefined>('A promise that resolves to an array of TextEdits.', tryMapWith(typeConverters.TextEdit.to))\n\t),\n\t// -- go to symbol (definition, type definition, declaration, impl, references)\n\tnew ApiCommand(\n\t\t'vscode.executeDefinitionProvider', '_executeDefinitionProvider', 'Execute all definition providers.',\n\t\t[ApiCommandArgument.Uri, ApiCommandArgument.Position],\n\t\tnew ApiCommandResult<(languages.Location | languages.LocationLink)[], (types.Location | vscode.LocationLink)[] | undefined>('A promise that resolves to an array of Location or LocationLink instances.', mapLocationOrLocationLink)\n\t),\n\tnew ApiCommand(\n\t\t'vscode.executeTypeDefinitionProvider', '_executeTypeDefinitionProvider', 'Execute all type definition providers.',\n\t\t[ApiCommandArgument.Uri, ApiCommandArgument.Position],\n\t\tnew ApiCommandResult<(languages.Location | languages.LocationLink)[], (types.Location | vscode.LocationLink)[] | undefined>('A promise that resolves to an array of Location or LocationLink instances.', mapLocationOrLocationLink)\n\t),\n\tnew ApiCommand(\n\t\t'vscode.executeDeclarationProvider', '_executeDeclarationProvider', 'Execute all declaration providers.',\n\t\t[ApiCommandArgument.Uri, ApiCommandArgument.Position],\n\t\tnew ApiCommandResult<(languages.Location | languages.LocationLink)[], (types.Location | vscode.LocationLink)[] | undefined>('A promise that resolves to an array of Location or LocationLink instances.', mapLocationOrLocationLink)\n\t),\n\tnew ApiCommand(\n\t\t'vscode.executeImplementationProvider', '_executeImplementationProvider', 'Execute all implementation providers.',\n\t\t[ApiCommandArgument.Uri, ApiCommandArgument.Position],\n\t\tnew ApiCommandResult<(languages.Location | languages.LocationLink)[], (types.Location | vscode.LocationLink)[] | undefined>('A promise that resolves to an array of Location or LocationLink instances.', mapLocationOrLocationLink)\n\t),\n\tnew ApiCommand(\n\t\t'vscode.executeReferenceProvider', '_executeReferenceProvider', 'Execute all reference providers.',\n\t\t[ApiCommandArgument.Uri, ApiCommandArgument.Position],\n\t\tnew ApiCommandResult<languages.Location[], types.Location[] | undefined>('A promise that resolves to an array of Location-instances.', tryMapWith(typeConverters.location.to))\n\t),\n\t// -- hover\n\tnew ApiCommand(\n\t\t'vscode.executeHoverProvider', '_executeHoverProvider', 'Execute all hover providers.',\n\t\t[ApiCommandArgument.Uri, ApiCommandArgument.Position],\n\t\tnew ApiCommandResult<languages.Hover[], types.Hover[] | undefined>('A promise that resolves to an array of Hover-instances.', tryMapWith(typeConverters.Hover.to))\n\t),\n\t// -- selection range\n\tnew ApiCommand(\n\t\t'vscode.executeSelectionRangeProvider', '_executeSelectionRangeProvider', 'Execute selection range provider.',\n\t\t[ApiCommandArgument.Uri, new ApiCommandArgument<types.Position[], IPosition[]>('position', 'A position in a text document', v => Array.isArray(v) && v.every(v => types.Position.isPosition(v)), v => v.map(typeConverters.Position.from))],\n\t\tnew ApiCommandResult<IRange[][], types.SelectionRange[]>('A promise that resolves to an array of ranges.', result => {\n\t\t\treturn result.map(ranges => {\n\t\t\t\tlet node: types.SelectionRange | undefined;\n\t\t\t\tfor (const range of ranges.reverse()) {\n\t\t\t\t\tnode = new types.SelectionRange(typeConverters.Range.to(range), node);\n\t\t\t\t}\n\t\t\t\treturn node!;\n\t\t\t});\n\t\t})\n\t),\n\t// -- symbol search\n\tnew ApiCommand(\n\t\t'vscode.executeWorkspaceSymbolProvider', '_executeWorkspaceSymbolProvider', 'Execute all workspace symbol providers.',\n\t\t[ApiCommandArgument.String.with('query', 'Search string')],\n\t\tnew ApiCommandResult<search.IWorkspaceSymbol[], types.SymbolInformation[]>('A promise that resolves to an array of SymbolInformation-instances.', value => {\n\t\t\treturn value.map(typeConverters.WorkspaceSymbol.to);\n\t\t})\n\t),\n\t// --- call hierarchy\n\tnew ApiCommand(\n\t\t'vscode.prepareCallHierarchy', '_executePrepareCallHierarchy', 'Prepare call hierarchy at a position inside a document',\n\t\t[ApiCommandArgument.Uri, ApiCommandArgument.Position],\n\t\tnew ApiCommandResult<ICallHierarchyItemDto[], types.CallHierarchyItem[]>('A CallHierarchyItem or undefined', v => v.map(typeConverters.CallHierarchyItem.to))\n\t),\n\tnew ApiCommand(\n\t\t'vscode.provideIncomingCalls', '_executeProvideIncomingCalls', 'Compute incoming calls for an item',\n\t\t[ApiCommandArgument.CallHierarchyItem],\n\t\tnew ApiCommandResult<IIncomingCallDto[], types.CallHierarchyIncomingCall[]>('A CallHierarchyItem or undefined', v => v.map(typeConverters.CallHierarchyIncomingCall.to))\n\t),\n\tnew ApiCommand(\n\t\t'vscode.provideOutgoingCalls', '_executeProvideOutgoingCalls', 'Compute outgoing calls for an item',\n\t\t[ApiCommandArgument.CallHierarchyItem],\n\t\tnew ApiCommandResult<IOutgoingCallDto[], types.CallHierarchyOutgoingCall[]>('A CallHierarchyItem or undefined', v => v.map(typeConverters.CallHierarchyOutgoingCall.to))\n\t),\n\t// --- rename\n\tnew ApiCommand(\n\t\t'vscode.prepareRename', '_executePrepareRename', 'Execute the prepareRename of rename provider.',\n\t\t[ApiCommandArgument.Uri, ApiCommandArgument.Position],\n\t\tnew ApiCommandResult<languages.RenameLocation, { range: types.Range; placeholder: string } | undefined>('A promise that resolves to a range and placeholder text.', value => {\n\t\t\tif (!value) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\treturn {\n\t\t\t\trange: typeConverters.Range.to(value.range),\n\t\t\t\tplaceholder: value.text\n\t\t\t};\n\t\t})\n\t),\n\tnew ApiCommand(\n\t\t'vscode.executeDocumentRenameProvider', '_executeDocumentRenameProvider', 'Execute rename provider.',\n\t\t[ApiCommandArgument.Uri, ApiCommandArgument.Position, ApiCommandArgument.String.with('newName', 'The new symbol name')],\n\t\tnew ApiCommandResult<IWorkspaceEditDto & { rejectReason?: string }, types.WorkspaceEdit | undefined>('A promise that resolves to a WorkspaceEdit.', value => {\n\t\t\tif (!value) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\tif (value.rejectReason) {\n\t\t\t\tthrow new Error(value.rejectReason);\n\t\t\t}\n\t\t\treturn typeConverters.WorkspaceEdit.to(value);\n\t\t})\n\t),\n\t// --- links\n\tnew ApiCommand(\n\t\t'vscode.executeLinkProvider', '_executeLinkProvider', 'Execute document link provider.',\n\t\t[ApiCommandArgument.Uri, ApiCommandArgument.Number.with('linkResolveCount', 'Number of links that should be resolved, only when links are unresolved.').optional()],\n\t\tnew ApiCommandResult<languages.ILink[], vscode.DocumentLink[]>('A promise that resolves to an array of DocumentLink-instances.', value => value.map(typeConverters.DocumentLink.to))\n\t),\n\t// --- semantic tokens\n\tnew ApiCommand(\n\t\t'vscode.provideDocumentSemanticTokensLegend', '_provideDocumentSemanticTokensLegend', 'Provide semantic tokens legend for a document',\n\t\t[ApiCommandArgument.Uri],\n\t\tnew ApiCommandResult<languages.SemanticTokensLegend, types.SemanticTokensLegend | undefined>('A promise that resolves to SemanticTokensLegend.', value => {\n\t\t\tif (!value) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\treturn new types.SemanticTokensLegend(value.tokenTypes, value.tokenModifiers);\n\t\t})\n\t),\n\tnew ApiCommand(\n\t\t'vscode.provideDocumentSemanticTokens', '_provideDocumentSemanticTokens', 'Provide semantic tokens for a document',\n\t\t[ApiCommandArgument.Uri],\n\t\tnew ApiCommandResult<VSBuffer, types.SemanticTokens | undefined>('A promise that resolves to SemanticTokens.', value => {\n\t\t\tif (!value) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\tconst semanticTokensDto = decodeSemanticTokensDto(value);\n\t\t\tif (semanticTokensDto.type !== 'full') {\n\t\t\t\t// only accepting full semantic tokens from provideDocumentSemanticTokens\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\treturn new types.SemanticTokens(semanticTokensDto.data, undefined);\n\t\t})\n\t),\n\tnew ApiCommand(\n\t\t'vscode.provideDocumentRangeSemanticTokensLegend', '_provideDocumentRangeSemanticTokensLegend', 'Provide semantic tokens legend for a document range',\n\t\t[ApiCommandArgument.Uri, ApiCommandArgument.Range.optional()],\n\t\tnew ApiCommandResult<languages.SemanticTokensLegend, types.SemanticTokensLegend | undefined>('A promise that resolves to SemanticTokensLegend.', value => {\n\t\t\tif (!value) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\treturn new types.SemanticTokensLegend(value.tokenTypes, value.tokenModifiers);\n\t\t})\n\t),\n\tnew ApiCommand(\n\t\t'vscode.provideDocumentRangeSemanticTokens', '_provideDocumentRangeSemanticTokens', 'Provide semantic tokens for a document range',\n\t\t[ApiCommandArgument.Uri, ApiCommandArgument.Range],\n\t\tnew ApiCommandResult<VSBuffer, types.SemanticTokens | undefined>('A promise that resolves to SemanticTokens.', value => {\n\t\t\tif (!value) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\tconst semanticTokensDto = decodeSemanticTokensDto(value);\n\t\t\tif (semanticTokensDto.type !== 'full') {\n\t\t\t\t// only accepting full semantic tokens from provideDocumentRangeSemanticTokens\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\treturn new types.SemanticTokens(semanticTokensDto.data, undefined);\n\t\t})\n\t),\n\t// --- completions\n\tnew ApiCommand(\n\t\t'vscode.executeCompletionItemProvider', '_executeCompletionItemProvider', 'Execute completion item provider.',\n\t\t[\n\t\t\tApiCommandArgument.Uri,\n\t\t\tApiCommandArgument.Position,\n\t\t\tApiCommandArgument.String.with('triggerCharacter', 'Trigger completion when the user types the character, like `,` or `(`').optional(),\n\t\t\tApiCommandArgument.Number.with('itemResolveCount', 'Number of completions to resolve (too large numbers slow down completions)').optional()\n\t\t],\n\t\tnew ApiCommandResult<languages.CompletionList, vscode.CompletionList>('A promise that resolves to a CompletionList-instance.', (value, _args, converter) => {\n\t\t\tif (!value) {\n\t\t\t\treturn new types.CompletionList([]);\n\t\t\t}\n\t\t\tconst items = value.suggestions.map(suggestion => typeConverters.CompletionItem.to(suggestion, converter));\n\t\t\treturn new types.CompletionList(items, value.incomplete);\n\t\t})\n\t),\n\t// --- signature help\n\tnew ApiCommand(\n\t\t'vscode.executeSignatureHelpProvider', '_executeSignatureHelpProvider', 'Execute signature help provider.',\n\t\t[ApiCommandArgument.Uri, ApiCommandArgument.Position, ApiCommandArgument.String.with('triggerCharacter', 'Trigger signature help when the user types the character, like `,` or `(`').optional()],\n\t\tnew ApiCommandResult<languages.SignatureHelp, vscode.SignatureHelp | undefined>('A promise that resolves to SignatureHelp.', value => {\n\t\t\tif (value) {\n\t\t\t\treturn typeConverters.SignatureHelp.to(value);\n\t\t\t}\n\t\t\treturn undefined;\n\t\t})\n\t),\n\t// --- code lens\n\tnew ApiCommand(\n\t\t'vscode.executeCodeLensProvider', '_executeCodeLensProvider', 'Execute code lens provider.',\n\t\t[ApiCommandArgument.Uri, ApiCommandArgument.Number.with('itemResolveCount', 'Number of lenses that should be resolved and returned. Will only return resolved lenses, will impact performance)').optional()],\n\t\tnew ApiCommandResult<languages.CodeLens[], vscode.CodeLens[] | undefined>('A promise that resolves to an array of CodeLens-instances.', (value, _args, converter) => {\n\t\t\treturn tryMapWith<languages.CodeLens, vscode.CodeLens>(item => {\n\t\t\t\treturn new types.CodeLens(typeConverters.Range.to(item.range), item.command && converter.fromInternal(item.command));\n\t\t\t})(value);\n\t\t})\n\t),\n\t// --- code actions\n\tnew ApiCommand(\n\t\t'vscode.executeCodeActionProvider', '_executeCodeActionProvider', 'Execute code action provider.',\n\t\t[\n\t\t\tApiCommandArgument.Uri,\n\t\t\tnew ApiCommandArgument('rangeOrSelection', 'Range in a text document. Some refactoring provider requires Selection object.', v => types.Range.isRange(v), v => types.Selection.isSelection(v) ? typeConverters.Selection.from(v) : typeConverters.Range.from(v)),\n\t\t\tApiCommandArgument.String.with('kind', 'Code action kind to return code actions for').optional(),\n\t\t\tApiCommandArgument.Number.with('itemResolveCount', 'Number of code actions to resolve (too large numbers slow down code actions)').optional()\n\t\t],\n\t\tnew ApiCommandResult<CustomCodeAction[], (vscode.CodeAction | vscode.Command | undefined)[] | undefined>('A promise that resolves to an array of Command-instances.', (value, _args, converter) => {\n\t\t\treturn tryMapWith<CustomCodeAction, vscode.CodeAction | vscode.Command | undefined>((codeAction) => {\n\t\t\t\tif (codeAction._isSynthetic) {\n\t\t\t\t\tif (!codeAction.command) {\n\t\t\t\t\t\tthrow new Error('Synthetic code actions must have a command');\n\t\t\t\t\t}\n\t\t\t\t\treturn converter.fromInternal(codeAction.command);\n\t\t\t\t} else {\n\t\t\t\t\tconst ret = new types.CodeAction(\n\t\t\t\t\t\tcodeAction.title,\n\t\t\t\t\t\tcodeAction.kind ? new types.CodeActionKind(codeAction.kind) : undefined\n\t\t\t\t\t);\n\t\t\t\t\tif (codeAction.edit) {\n\t\t\t\t\t\tret.edit = typeConverters.WorkspaceEdit.to(codeAction.edit);\n\t\t\t\t\t}\n\t\t\t\t\tif (codeAction.command) {\n\t\t\t\t\t\tret.command = converter.fromInternal(codeAction.command);\n\t\t\t\t\t}\n\t\t\t\t\tret.isPreferred = codeAction.isPreferred;\n\t\t\t\t\treturn ret;\n\t\t\t\t}\n\t\t\t})(value);\n\t\t})\n\t),\n\t// --- colors\n\tnew ApiCommand(\n\t\t'vscode.executeDocumentColorProvider', '_executeDocumentColorProvider', 'Execute document color provider.',\n\t\t[ApiCommandArgument.Uri],\n\t\tnew ApiCommandResult<IRawColorInfo[], vscode.ColorInformation[]>('A promise that resolves to an array of ColorInformation objects.', result => {\n\t\t\tif (result) {\n\t\t\t\treturn result.map(ci => new types.ColorInformation(typeConverters.Range.to(ci.range), typeConverters.Color.to(ci.color)));\n\t\t\t}\n\t\t\treturn [];\n\t\t})\n\t),\n\tnew ApiCommand(\n\t\t'vscode.executeColorPresentationProvider', '_executeColorPresentationProvider', 'Execute color presentation provider.',\n\t\t[\n\t\t\tnew ApiCommandArgument<types.Color, [number, number, number, number]>('color', 'The color to show and insert', v => v instanceof types.Color, typeConverters.Color.from),\n\t\t\tnew ApiCommandArgument<{ uri: URI; range: types.Range }, { uri: URI; range: IRange }>('context', 'Context object with uri and range', _v => true, v => ({ uri: v.uri, range: typeConverters.Range.from(v.range) })),\n\t\t],\n\t\tnew ApiCommandResult<languages.IColorPresentation[], types.ColorPresentation[]>('A promise that resolves to an array of ColorPresentation objects.', result => {\n\t\t\tif (result) {\n\t\t\t\treturn result.map(typeConverters.ColorPresentation.to);\n\t\t\t}\n\t\t\treturn [];\n\t\t})\n\t),\n\t// --- inline hints\n\tnew ApiCommand(\n\t\t'vscode.executeInlayHintProvider', '_executeInlayHintProvider', 'Execute inlay hints provider',\n\t\t[ApiCommandArgument.Uri, ApiCommandArgument.Range],\n\t\tnew ApiCommandResult<languages.InlayHint[], vscode.InlayHint[]>('A promise that resolves to an array of Inlay objects', (result, args, converter) => {\n\t\t\treturn result.map(typeConverters.InlayHint.to.bind(undefined, converter));\n\t\t})\n\t),\n\t// --- notebooks\n\tnew ApiCommand(\n\t\t'vscode.resolveNotebookContentProviders', '_resolveNotebookContentProvider', 'Resolve Notebook Content Providers',\n\t\t[\n\t\t\t// new ApiCommandArgument<string, string>('viewType', '', v => typeof v === 'string', v => v),\n\t\t\t// new ApiCommandArgument<string, string>('displayName', '', v => typeof v === 'string', v => v),\n\t\t\t// new ApiCommandArgument<object, object>('options', '', v => typeof v === 'object', v => v),\n\t\t],\n\t\tnew ApiCommandResult<{\n\t\t\tviewType: string;\n\t\t\tdisplayName: string;\n\t\t\toptions: { transientOutputs: boolean; transientCellMetadata: TransientCellMetadata; transientDocumentMetadata: TransientDocumentMetadata };\n\t\t\tfilenamePattern: (vscode.GlobPattern | { include: vscode.GlobPattern; exclude: vscode.GlobPattern })[];\n\t\t}[], {\n\t\t\tviewType: string;\n\t\t\tdisplayName: string;\n\t\t\tfilenamePattern: (vscode.GlobPattern | { include: vscode.GlobPattern; exclude: vscode.GlobPattern })[];\n\t\t\toptions: vscode.NotebookDocumentContentOptions;\n\t\t}[] | undefined>('A promise that resolves to an array of NotebookContentProvider static info objects.', tryMapWith(item => {\n\t\t\treturn {\n\t\t\t\tviewType: item.viewType,\n\t\t\t\tdisplayName: item.displayName,\n\t\t\t\toptions: {\n\t\t\t\t\ttransientOutputs: item.options.transientOutputs,\n\t\t\t\t\ttransientCellMetadata: item.options.transientCellMetadata,\n\t\t\t\t\ttransientDocumentMetadata: item.options.transientDocumentMetadata\n\t\t\t\t},\n\t\t\t\tfilenamePattern: item.filenamePattern.map(pattern => typeConverters.NotebookExclusiveDocumentPattern.to(pattern))\n\t\t\t};\n\t\t}))\n\t),\n\t// --- debug support\n\tnew ApiCommand(\n\t\t'vscode.executeInlineValueProvider', '_executeInlineValueProvider', 'Execute inline value provider',\n\t\t[ApiCommandArgument.Uri, ApiCommandArgument.Range],\n\t\tnew ApiCommandResult<languages.InlineValue[], vscode.InlineValue[]>('A promise that resolves to an array of InlineValue objects', result => {\n\t\t\treturn result.map(typeConverters.InlineValue.to);\n\t\t})\n\t),\n\t// --- open'ish commands\n\tnew ApiCommand(\n\t\t'vscode.open', '_workbench.open', 'Opens the provided resource in the editor. Can be a text or binary file, or an http(s) URL. If you need more control over the options for opening a text file, use vscode.window.showTextDocument instead.',\n\t\t[\n\t\t\tnew ApiCommandArgument<URI | string>('uriOrString', 'Uri-instance or string (only http/https)', v => URI.isUri(v) || (typeof v === 'string' && matchesSomeScheme(v, Schemas.http, Schemas.https)), v => v),\n\t\t\tnew ApiCommandArgument<vscode.ViewColumn | typeConverters.TextEditorOpenOptions | undefined, [vscode.ViewColumn?, ITextEditorOptions?] | undefined>('columnOrOptions', 'Either the column in which to open or editor options, see vscode.TextDocumentShowOptions',\n\t\t\t\tv => v === undefined || typeof v === 'number' || typeof v === 'object',\n\t\t\t\tv => !v ? v : typeof v === 'number' ? [typeConverters.ViewColumn.from(v), undefined] : [typeConverters.ViewColumn.from(v.viewColumn), typeConverters.TextEditorOpenOptions.from(v)]\n\t\t\t).optional(),\n\t\t\tApiCommandArgument.String.with('label', '').optional()\n\t\t],\n\t\tApiCommandResult.Void\n\t),\n\tnew ApiCommand(\n\t\t'vscode.openWith', '_workbench.openWith', 'Opens the provided resource with a specific editor.',\n\t\t[\n\t\t\tApiCommandArgument.Uri.with('resource', 'Resource to open'),\n\t\t\tApiCommandArgument.String.with('viewId', 'Custom editor view id or \\'default\\' to use VS Code\\'s default editor'),\n\t\t\tnew ApiCommandArgument<vscode.ViewColumn | typeConverters.TextEditorOpenOptions | undefined, [vscode.ViewColumn?, ITextEditorOptions?] | undefined>('columnOrOptions', 'Either the column in which to open or editor options, see vscode.TextDocumentShowOptions',\n\t\t\t\tv => v === undefined || typeof v === 'number' || typeof v === 'object',\n\t\t\t\tv => !v ? v : typeof v === 'number' ? [typeConverters.ViewColumn.from(v), undefined] : [typeConverters.ViewColumn.from(v.viewColumn), typeConverters.TextEditorOpenOptions.from(v)],\n\t\t\t).optional()\n\t\t],\n\t\tApiCommandResult.Void\n\t),\n\tnew ApiCommand(\n\t\t'vscode.diff', '_workbench.diff', 'Opens the provided resources in the diff editor to compare their contents.',\n\t\t[\n\t\t\tApiCommandArgument.Uri.with('left', 'Left-hand side resource of the diff editor'),\n\t\t\tApiCommandArgument.Uri.with('right', 'Right-hand side resource of the diff editor'),\n\t\t\tApiCommandArgument.String.with('title', 'Human readable title for the diff editor').optional(),\n\t\t\tnew ApiCommandArgument<typeConverters.TextEditorOpenOptions | undefined, [number?, ITextEditorOptions?] | undefined>('columnOrOptions', 'Either the column in which to open or editor options, see vscode.TextDocumentShowOptions',\n\t\t\t\tv => v === undefined || typeof v === 'object',\n\t\t\t\tv => v && [typeConverters.ViewColumn.from(v.viewColumn), typeConverters.TextEditorOpenOptions.from(v)]\n\t\t\t).optional(),\n\t\t],\n\t\tApiCommandResult.Void\n\t),\n\t// --- type hierarchy\n\tnew ApiCommand(\n\t\t'vscode.prepareTypeHierarchy', '_executePrepareTypeHierarchy', 'Prepare type hierarchy at a position inside a document',\n\t\t[ApiCommandArgument.Uri, ApiCommandArgument.Position],\n\t\tnew ApiCommandResult<ITypeHierarchyItemDto[], types.TypeHierarchyItem[]>('A TypeHierarchyItem or undefined', v => v.map(typeConverters.TypeHierarchyItem.to))\n\t),\n\tnew ApiCommand(\n\t\t'vscode.provideSupertypes', '_executeProvideSupertypes', 'Compute supertypes for an item',\n\t\t[ApiCommandArgument.TypeHierarchyItem],\n\t\tnew ApiCommandResult<ITypeHierarchyItemDto[], types.TypeHierarchyItem[]>('A TypeHierarchyItem or undefined', v => v.map(typeConverters.TypeHierarchyItem.to))\n\t),\n\tnew ApiCommand(\n\t\t'vscode.provideSubtypes', '_executeProvideSubtypes', 'Compute subtypes for an item',\n\t\t[ApiCommandArgument.TypeHierarchyItem],\n\t\tnew ApiCommandResult<ITypeHierarchyItemDto[], types.TypeHierarchyItem[]>('A TypeHierarchyItem or undefined', v => v.map(typeConverters.TypeHierarchyItem.to))\n\t),\n\t// --- testing\n\tnew ApiCommand(\n\t\t'vscode.revealTestInExplorer', '_revealTestInExplorer', 'Reveals a test instance in the explorer',\n\t\t[ApiCommandArgument.TestItem],\n\t\tApiCommandResult.Void\n\t),\n\t// --- continue edit session\n\tnew ApiCommand(\n\t\t'vscode.experimental.editSession.continue', '_workbench.experimental.editSessions.actions.continueEditSession', 'Continue the current edit session in a different workspace',\n\t\t[ApiCommandArgument.Uri.with('workspaceUri', 'The target workspace to continue the current edit session in')],\n\t\tApiCommandResult.Void\n\t)\n];\n\n//#endregion\n\n\n//#region OLD world\n\nexport class ExtHostApiCommands {\n\n\tstatic register(commands: ExtHostCommands) {\n\t\tnewCommands.forEach(commands.registerApiCommand, commands);\n\t}\n\n}\n\nfunction tryMapWith<T, R>(f: (x: T) => R) {\n\treturn (value: T[]) => {\n\t\tif (Array.isArray(value)) {\n\t\t\treturn value.map(f);\n\t\t}\n\t\treturn undefined;\n\t};\n}\n\nfunction mapLocationOrLocationLink(values: (languages.Location | languages.LocationLink)[]): (types.Location | vscode.LocationLink)[] | undefined {\n\tif (!Array.isArray(values)) {\n\t\treturn undefined;\n\t}\n\tconst result: (types.Location | vscode.LocationLink)[] = [];\n\tfor (const item of values) {\n\t\tif (languages.isLocationLink(item)) {\n\t\t\tresult.push(typeConverters.DefinitionLink.to(item));\n\t\t} else {\n\t\t\tresult.push(typeConverters.location.to(item));\n\t\t}\n\t}\n\treturn result;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { asPromise } from 'vs/base/common/async';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { debounce } from 'vs/base/common/decorators';\nimport { Emitter } from 'vs/base/common/event';\nimport { DisposableStore, IDisposable, MutableDisposable } from 'vs/base/common/lifecycle';\nimport { MarshalledId } from 'vs/base/common/marshallingIds';\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { IRange } from 'vs/editor/common/core/range';\nimport * as languages from 'vs/editor/common/languages';\nimport { ExtensionIdentifier, IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { ExtHostDocuments } from 'vs/workbench/api/common/extHostDocuments';\nimport * as extHostTypeConverter from 'vs/workbench/api/common/extHostTypeConverters';\nimport * as types from 'vs/workbench/api/common/extHostTypes';\nimport { checkProposedApiEnabled } from 'vs/workbench/services/extensions/common/extensions';\nimport type * as vscode from 'vscode';\nimport { ExtHostCommentsShape, IMainContext, MainContext, CommentThreadChanges, CommentChanges } from './extHost.protocol';\nimport { ExtHostCommands } from './extHostCommands';\n\ntype ProviderHandle = number;\n\nexport interface ExtHostComments {\n\tcreateCommentController(extension: IExtensionDescription, id: string, label: string): vscode.CommentController;\n}\n\nexport function createExtHostComments(mainContext: IMainContext, commands: ExtHostCommands, documents: ExtHostDocuments): ExtHostCommentsShape & ExtHostComments {\n\tconst proxy = mainContext.getProxy(MainContext.MainThreadComments);\n\n\tclass ExtHostCommentsImpl implements ExtHostCommentsShape, ExtHostComments, IDisposable {\n\n\t\tprivate static handlePool = 0;\n\n\n\t\tprivate _commentControllers: Map<ProviderHandle, ExtHostCommentController> = new Map<ProviderHandle, ExtHostCommentController>();\n\n\t\tprivate _commentControllersByExtension: Map<string, ExtHostCommentController[]> = new Map<string, ExtHostCommentController[]>();\n\n\n\t\tconstructor(\n\t\t) {\n\t\t\tcommands.registerArgumentProcessor({\n\t\t\t\tprocessArgument: arg => {\n\t\t\t\t\tif (arg && arg.$mid === MarshalledId.CommentController) {\n\t\t\t\t\t\tconst commentController = this._commentControllers.get(arg.handle);\n\n\t\t\t\t\t\tif (!commentController) {\n\t\t\t\t\t\t\treturn arg;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn commentController.value;\n\t\t\t\t\t} else if (arg && arg.$mid === MarshalledId.CommentThread) {\n\t\t\t\t\t\tconst commentController = this._commentControllers.get(arg.commentControlHandle);\n\n\t\t\t\t\t\tif (!commentController) {\n\t\t\t\t\t\t\treturn arg;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst commentThread = commentController.getCommentThread(arg.commentThreadHandle);\n\n\t\t\t\t\t\tif (!commentThread) {\n\t\t\t\t\t\t\treturn arg;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn commentThread.value;\n\t\t\t\t\t} else if (arg && arg.$mid === MarshalledId.CommentThreadReply) {\n\t\t\t\t\t\tconst commentController = this._commentControllers.get(arg.thread.commentControlHandle);\n\n\t\t\t\t\t\tif (!commentController) {\n\t\t\t\t\t\t\treturn arg;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst commentThread = commentController.getCommentThread(arg.thread.commentThreadHandle);\n\n\t\t\t\t\t\tif (!commentThread) {\n\t\t\t\t\t\t\treturn arg;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tthread: commentThread.value,\n\t\t\t\t\t\t\ttext: arg.text\n\t\t\t\t\t\t};\n\t\t\t\t\t} else if (arg && arg.$mid === MarshalledId.CommentNode) {\n\t\t\t\t\t\tconst commentController = this._commentControllers.get(arg.thread.commentControlHandle);\n\n\t\t\t\t\t\tif (!commentController) {\n\t\t\t\t\t\t\treturn arg;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst commentThread = commentController.getCommentThread(arg.thread.commentThreadHandle);\n\n\t\t\t\t\t\tif (!commentThread) {\n\t\t\t\t\t\t\treturn arg;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst commentUniqueId = arg.commentUniqueId;\n\n\t\t\t\t\t\tconst comment = commentThread.getCommentByUniqueId(commentUniqueId);\n\n\t\t\t\t\t\tif (!comment) {\n\t\t\t\t\t\t\treturn arg;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn comment;\n\n\t\t\t\t\t} else if (arg && arg.$mid === MarshalledId.CommentThreadNode) {\n\t\t\t\t\t\tconst commentController = this._commentControllers.get(arg.thread.commentControlHandle);\n\n\t\t\t\t\t\tif (!commentController) {\n\t\t\t\t\t\t\treturn arg;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst commentThread = commentController.getCommentThread(arg.thread.commentThreadHandle);\n\n\t\t\t\t\t\tif (!commentThread) {\n\t\t\t\t\t\t\treturn arg;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst body = arg.text;\n\t\t\t\t\t\tconst commentUniqueId = arg.commentUniqueId;\n\n\t\t\t\t\t\tconst comment = commentThread.getCommentByUniqueId(commentUniqueId);\n\n\t\t\t\t\t\tif (!comment) {\n\t\t\t\t\t\t\treturn arg;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcomment.body = body;\n\t\t\t\t\t\treturn comment;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn arg;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tcreateCommentController(extension: IExtensionDescription, id: string, label: string): vscode.CommentController {\n\t\t\tconst handle = ExtHostCommentsImpl.handlePool++;\n\t\t\tconst commentController = new ExtHostCommentController(extension, handle, id, label);\n\t\t\tthis._commentControllers.set(commentController.handle, commentController);\n\n\t\t\tconst commentControllers = this._commentControllersByExtension.get(ExtensionIdentifier.toKey(extension.identifier)) || [];\n\t\t\tcommentControllers.push(commentController);\n\t\t\tthis._commentControllersByExtension.set(ExtensionIdentifier.toKey(extension.identifier), commentControllers);\n\n\t\t\treturn commentController.value;\n\t\t}\n\n\t\t$createCommentThreadTemplate(commentControllerHandle: number, uriComponents: UriComponents, range: IRange): void {\n\t\t\tconst commentController = this._commentControllers.get(commentControllerHandle);\n\n\t\t\tif (!commentController) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcommentController.$createCommentThreadTemplate(uriComponents, range);\n\t\t}\n\n\t\tasync $updateCommentThreadTemplate(commentControllerHandle: number, threadHandle: number, range: IRange) {\n\t\t\tconst commentController = this._commentControllers.get(commentControllerHandle);\n\n\t\t\tif (!commentController) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcommentController.$updateCommentThreadTemplate(threadHandle, range);\n\t\t}\n\n\t\t$deleteCommentThread(commentControllerHandle: number, commentThreadHandle: number) {\n\t\t\tconst commentController = this._commentControllers.get(commentControllerHandle);\n\n\t\t\tcommentController?.$deleteCommentThread(commentThreadHandle);\n\t\t}\n\n\t\t$provideCommentingRanges(commentControllerHandle: number, uriComponents: UriComponents, token: CancellationToken): Promise<IRange[] | undefined> {\n\t\t\tconst commentController = this._commentControllers.get(commentControllerHandle);\n\n\t\t\tif (!commentController || !commentController.commentingRangeProvider) {\n\t\t\t\treturn Promise.resolve(undefined);\n\t\t\t}\n\n\t\t\tconst document = documents.getDocument(URI.revive(uriComponents));\n\t\t\treturn asPromise(() => {\n\t\t\t\treturn commentController.commentingRangeProvider!.provideCommentingRanges(document, token);\n\t\t\t}).then(ranges => ranges ? ranges.map(x => extHostTypeConverter.Range.from(x)) : undefined);\n\t\t}\n\n\t\t$toggleReaction(commentControllerHandle: number, threadHandle: number, uri: UriComponents, comment: languages.Comment, reaction: languages.CommentReaction): Promise<void> {\n\t\t\tconst commentController = this._commentControllers.get(commentControllerHandle);\n\n\t\t\tif (!commentController || !commentController.reactionHandler) {\n\t\t\t\treturn Promise.resolve(undefined);\n\t\t\t}\n\n\t\t\treturn asPromise(() => {\n\t\t\t\tconst commentThread = commentController.getCommentThread(threadHandle);\n\t\t\t\tif (commentThread) {\n\t\t\t\t\tconst vscodeComment = commentThread.getCommentByUniqueId(comment.uniqueIdInThread);\n\n\t\t\t\t\tif (commentController !== undefined && vscodeComment) {\n\t\t\t\t\t\tif (commentController.reactionHandler) {\n\t\t\t\t\t\t\treturn commentController.reactionHandler(vscodeComment, convertFromReaction(reaction));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn Promise.resolve(undefined);\n\t\t\t});\n\t\t}\n\t\tdispose() {\n\n\t\t}\n\t}\n\ttype CommentThreadModification = Partial<{\n\t\trange: vscode.Range;\n\t\tlabel: string | undefined;\n\t\tcontextValue: string | undefined;\n\t\tcomments: vscode.Comment[];\n\t\tcollapsibleState: vscode.CommentThreadCollapsibleState;\n\t\tcanReply: boolean;\n\t\tstate: vscode.CommentThreadState;\n\t\tisTemplate: boolean;\n\t}>;\n\n\tclass ExtHostCommentThread implements vscode.CommentThread {\n\t\tprivate static _handlePool: number = 0;\n\t\treadonly handle = ExtHostCommentThread._handlePool++;\n\t\tpublic commentHandle: number = 0;\n\n\t\tprivate modifications: CommentThreadModification = Object.create(null);\n\n\t\tset threadId(id: string) {\n\t\t\tthis._id = id;\n\t\t}\n\n\t\tget threadId(): string {\n\t\t\treturn this._id!;\n\t\t}\n\n\t\tget id(): string {\n\t\t\treturn this._id!;\n\t\t}\n\n\t\tget resource(): vscode.Uri {\n\t\t\treturn this._uri;\n\t\t}\n\n\t\tget uri(): vscode.Uri {\n\t\t\treturn this._uri;\n\t\t}\n\n\t\tprivate readonly _onDidUpdateCommentThread = new Emitter<void>();\n\t\treadonly onDidUpdateCommentThread = this._onDidUpdateCommentThread.event;\n\n\t\tset range(range: vscode.Range) {\n\t\t\tif (!range.isEqual(this._range)) {\n\t\t\t\tthis._range = range;\n\t\t\t\tthis.modifications.range = range;\n\t\t\t\tthis._onDidUpdateCommentThread.fire();\n\t\t\t}\n\t\t}\n\n\t\tget range(): vscode.Range {\n\t\t\treturn this._range;\n\t\t}\n\n\t\tprivate _canReply: boolean = true;\n\n\t\tset canReply(state: boolean) {\n\t\t\tif (this._canReply !== state) {\n\t\t\t\tthis._canReply = state;\n\t\t\t\tthis.modifications.canReply = state;\n\t\t\t\tthis._onDidUpdateCommentThread.fire();\n\t\t\t}\n\t\t}\n\t\tget canReply() {\n\t\t\treturn this._canReply;\n\t\t}\n\n\t\tprivate _label: string | undefined;\n\n\t\tget label(): string | undefined {\n\t\t\treturn this._label;\n\t\t}\n\n\t\tset label(label: string | undefined) {\n\t\t\tthis._label = label;\n\t\t\tthis.modifications.label = label;\n\t\t\tthis._onDidUpdateCommentThread.fire();\n\t\t}\n\n\t\tprivate _contextValue: string | undefined;\n\n\t\tget contextValue(): string | undefined {\n\t\t\treturn this._contextValue;\n\t\t}\n\n\t\tset contextValue(context: string | undefined) {\n\t\t\tthis._contextValue = context;\n\t\t\tthis.modifications.contextValue = context;\n\t\t\tthis._onDidUpdateCommentThread.fire();\n\t\t}\n\n\t\tget comments(): vscode.Comment[] {\n\t\t\treturn this._comments;\n\t\t}\n\n\t\tset comments(newComments: vscode.Comment[]) {\n\t\t\tthis._comments = newComments;\n\t\t\tthis.modifications.comments = newComments;\n\t\t\tthis._onDidUpdateCommentThread.fire();\n\t\t}\n\n\t\tprivate _collapseState?: vscode.CommentThreadCollapsibleState;\n\n\t\tget collapsibleState(): vscode.CommentThreadCollapsibleState {\n\t\t\treturn this._collapseState!;\n\t\t}\n\n\t\tset collapsibleState(newState: vscode.CommentThreadCollapsibleState) {\n\t\t\tthis._collapseState = newState;\n\t\t\tthis.modifications.collapsibleState = newState;\n\t\t\tthis._onDidUpdateCommentThread.fire();\n\t\t}\n\n\t\tprivate _state?: vscode.CommentThreadState;\n\n\t\tget state(): vscode.CommentThreadState {\n\t\t\tcheckProposedApiEnabled(this.extensionDescription, 'commentsResolvedState');\n\t\t\treturn this._state!;\n\t\t}\n\n\t\tset state(newState: vscode.CommentThreadState) {\n\t\t\tcheckProposedApiEnabled(this.extensionDescription, 'commentsResolvedState');\n\t\t\tthis._state = newState;\n\t\t\tthis.modifications.state = newState;\n\t\t\tthis._onDidUpdateCommentThread.fire();\n\t\t}\n\n\t\tprivate _localDisposables: types.Disposable[];\n\n\t\tprivate _isDiposed: boolean;\n\n\t\tpublic get isDisposed(): boolean {\n\t\t\treturn this._isDiposed;\n\t\t}\n\n\t\tprivate _commentsMap: Map<vscode.Comment, number> = new Map<vscode.Comment, number>();\n\n\t\tprivate _acceptInputDisposables = new MutableDisposable<DisposableStore>();\n\n\t\treadonly value: vscode.CommentThread;\n\n\t\tconstructor(\n\t\t\tcommentControllerId: string,\n\t\t\tprivate _commentControllerHandle: number,\n\t\t\tprivate _id: string | undefined,\n\t\t\tprivate _uri: vscode.Uri,\n\t\t\tprivate _range: vscode.Range,\n\t\t\tprivate _comments: vscode.Comment[],\n\t\t\tpublic readonly extensionDescription: IExtensionDescription,\n\t\t\tprivate _isTemplate: boolean\n\t\t) {\n\t\t\tthis._acceptInputDisposables.value = new DisposableStore();\n\n\t\t\tif (this._id === undefined) {\n\t\t\t\tthis._id = `${commentControllerId}.${this.handle}`;\n\t\t\t}\n\n\t\t\tproxy.$createCommentThread(\n\t\t\t\t_commentControllerHandle,\n\t\t\t\tthis.handle,\n\t\t\t\tthis._id,\n\t\t\t\tthis._uri,\n\t\t\t\textHostTypeConverter.Range.from(this._range),\n\t\t\t\textensionDescription.identifier,\n\t\t\t\tthis._isTemplate\n\t\t\t);\n\n\t\t\tthis._localDisposables = [];\n\t\t\tthis._isDiposed = false;\n\n\t\t\tthis._localDisposables.push(this.onDidUpdateCommentThread(() => {\n\t\t\t\tthis.eventuallyUpdateCommentThread();\n\t\t\t}));\n\n\t\t\t// set up comments after ctor to batch update events.\n\t\t\tthis.comments = _comments;\n\n\t\t\tthis._localDisposables.push({\n\t\t\t\tdispose: () => {\n\t\t\t\t\tproxy.$deleteCommentThread(\n\t\t\t\t\t\t_commentControllerHandle,\n\t\t\t\t\t\tthis.handle\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst that = this;\n\t\t\tthis.value = {\n\t\t\t\tget uri() { return that.uri; },\n\t\t\t\tget range() { return that.range; },\n\t\t\t\tset range(value: vscode.Range) { that.range = value; },\n\t\t\t\tget comments() { return that.comments; },\n\t\t\t\tset comments(value: vscode.Comment[]) { that.comments = value; },\n\t\t\t\tget collapsibleState() { return that.collapsibleState; },\n\t\t\t\tset collapsibleState(value: vscode.CommentThreadCollapsibleState) { that.collapsibleState = value; },\n\t\t\t\tget canReply() { return that.canReply; },\n\t\t\t\tset canReply(state: boolean) { that.canReply = state; },\n\t\t\t\tget contextValue() { return that.contextValue; },\n\t\t\t\tset contextValue(value: string | undefined) { that.contextValue = value; },\n\t\t\t\tget label() { return that.label; },\n\t\t\t\tset label(value: string | undefined) { that.label = value; },\n\t\t\t\tget state() { return that.state; },\n\t\t\t\tset state(value: vscode.CommentThreadState) { that.state = value; },\n\t\t\t\tdispose: () => {\n\t\t\t\t\tthat.dispose();\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\tprivate updateIsTemplate() {\n\t\t\tif (this._isTemplate) {\n\t\t\t\tthis._isTemplate = false;\n\t\t\t\tthis.modifications.isTemplate = false;\n\t\t\t}\n\t\t}\n\n\t\t@debounce(100)\n\t\teventuallyUpdateCommentThread(): void {\n\t\t\tif (this._isDiposed) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.updateIsTemplate();\n\n\t\t\tif (!this._acceptInputDisposables.value) {\n\t\t\t\tthis._acceptInputDisposables.value = new DisposableStore();\n\t\t\t}\n\n\t\t\tconst modified = (value: keyof CommentThreadModification): boolean =>\n\t\t\t\tObject.prototype.hasOwnProperty.call(this.modifications, value);\n\n\t\t\tconst formattedModifications: CommentThreadChanges = {};\n\t\t\tif (modified('range')) {\n\t\t\t\tformattedModifications.range = extHostTypeConverter.Range.from(this._range);\n\t\t\t}\n\t\t\tif (modified('label')) {\n\t\t\t\tformattedModifications.label = this.label;\n\t\t\t}\n\t\t\tif (modified('contextValue')) {\n\t\t\t\t/*\n\t\t\t\t * null -> cleared contextValue\n\t\t\t\t * undefined -> no change\n\t\t\t\t */\n\t\t\t\tformattedModifications.contextValue = this.contextValue ?? null;\n\t\t\t}\n\t\t\tif (modified('comments')) {\n\t\t\t\tformattedModifications.comments =\n\t\t\t\t\tthis._comments.map(cmt => convertToDTOComment(this, cmt, this._commentsMap));\n\t\t\t}\n\t\t\tif (modified('collapsibleState')) {\n\t\t\t\tformattedModifications.collapseState = convertToCollapsibleState(this._collapseState);\n\t\t\t}\n\t\t\tif (modified('canReply')) {\n\t\t\t\tformattedModifications.canReply = this.canReply;\n\t\t\t}\n\t\t\tif (modified('state')) {\n\t\t\t\tformattedModifications.state = convertToState(this._state);\n\t\t\t}\n\t\t\tif (modified('isTemplate')) {\n\t\t\t\tformattedModifications.isTemplate = this._isTemplate;\n\t\t\t}\n\t\t\tthis.modifications = {};\n\n\t\t\tproxy.$updateCommentThread(\n\t\t\t\tthis._commentControllerHandle,\n\t\t\t\tthis.handle,\n\t\t\t\tthis._id!,\n\t\t\t\tthis._uri,\n\t\t\t\tformattedModifications\n\t\t\t);\n\t\t}\n\n\t\tgetCommentByUniqueId(uniqueId: number): vscode.Comment | undefined {\n\t\t\tfor (const key of this._commentsMap) {\n\t\t\t\tconst comment = key[0];\n\t\t\t\tconst id = key[1];\n\t\t\t\tif (uniqueId === id) {\n\t\t\t\t\treturn comment;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tdispose() {\n\t\t\tthis._isDiposed = true;\n\t\t\tthis._acceptInputDisposables.dispose();\n\t\t\tthis._localDisposables.forEach(disposable => disposable.dispose());\n\t\t}\n\t}\n\n\ttype ReactionHandler = (comment: vscode.Comment, reaction: vscode.CommentReaction) => Promise<void>;\n\n\tclass ExtHostCommentController {\n\t\tget id(): string {\n\t\t\treturn this._id;\n\t\t}\n\n\t\tget label(): string {\n\t\t\treturn this._label;\n\t\t}\n\n\t\tpublic get handle(): number {\n\t\t\treturn this._handle;\n\t\t}\n\n\t\tprivate _threads: Map<number, ExtHostCommentThread> = new Map<number, ExtHostCommentThread>();\n\n\t\tprivate _commentingRangeProvider?: vscode.CommentingRangeProvider;\n\t\tget commentingRangeProvider(): vscode.CommentingRangeProvider | undefined {\n\t\t\treturn this._commentingRangeProvider;\n\t\t}\n\n\t\tset commentingRangeProvider(provider: vscode.CommentingRangeProvider | undefined) {\n\t\t\tthis._commentingRangeProvider = provider;\n\t\t\tproxy.$updateCommentingRanges(this.handle);\n\t\t}\n\n\t\tprivate _reactionHandler?: ReactionHandler;\n\n\t\tget reactionHandler(): ReactionHandler | undefined {\n\t\t\treturn this._reactionHandler;\n\t\t}\n\n\t\tset reactionHandler(handler: ReactionHandler | undefined) {\n\t\t\tthis._reactionHandler = handler;\n\n\t\t\tproxy.$updateCommentControllerFeatures(this.handle, { reactionHandler: !!handler });\n\t\t}\n\n\t\tprivate _options: languages.CommentOptions | undefined;\n\n\t\tget options() {\n\t\t\treturn this._options;\n\t\t}\n\n\t\tset options(options: languages.CommentOptions | undefined) {\n\t\t\tthis._options = options;\n\n\t\t\tproxy.$updateCommentControllerFeatures(this.handle, { options: this._options });\n\t\t}\n\n\n\t\tprivate _localDisposables: types.Disposable[];\n\t\treadonly value: vscode.CommentController;\n\n\t\tconstructor(\n\t\t\tprivate _extension: IExtensionDescription,\n\t\t\tprivate _handle: number,\n\t\t\tprivate _id: string,\n\t\t\tprivate _label: string\n\t\t) {\n\t\t\tproxy.$registerCommentController(this.handle, _id, _label);\n\n\t\t\tconst that = this;\n\t\t\tthis.value = Object.freeze({\n\t\t\t\tid: that.id,\n\t\t\t\tlabel: that.label,\n\t\t\t\tget options() { return that.options; },\n\t\t\t\tset options(options: vscode.CommentOptions | undefined) { that.options = options; },\n\t\t\t\tget commentingRangeProvider(): vscode.CommentingRangeProvider | undefined { return that.commentingRangeProvider; },\n\t\t\t\tset commentingRangeProvider(commentingRangeProvider: vscode.CommentingRangeProvider | undefined) { that.commentingRangeProvider = commentingRangeProvider; },\n\t\t\t\tget reactionHandler(): ReactionHandler | undefined { return that.reactionHandler; },\n\t\t\t\tset reactionHandler(handler: ReactionHandler | undefined) { that.reactionHandler = handler; },\n\t\t\t\tcreateCommentThread(uri: vscode.Uri, range: vscode.Range, comments: vscode.Comment[]): vscode.CommentThread {\n\t\t\t\t\treturn that.createCommentThread(uri, range, comments).value;\n\t\t\t\t},\n\t\t\t\tdispose: () => { that.dispose(); },\n\t\t\t});\n\n\t\t\tthis._localDisposables = [];\n\t\t\tthis._localDisposables.push({\n\t\t\t\tdispose: () => {\n\t\t\t\t\tproxy.$unregisterCommentController(this.handle);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tcreateCommentThread(resource: vscode.Uri, range: vscode.Range, comments: vscode.Comment[]): ExtHostCommentThread;\n\t\tcreateCommentThread(arg0: vscode.Uri | string, arg1: vscode.Uri | vscode.Range, arg2: vscode.Range | vscode.Comment[], arg3?: vscode.Comment[]): vscode.CommentThread {\n\t\t\tif (typeof arg0 === 'string') {\n\t\t\t\tconst commentThread = new ExtHostCommentThread(this.id, this.handle, arg0, arg1 as vscode.Uri, arg2 as vscode.Range, arg3 as vscode.Comment[], this._extension, false);\n\t\t\t\tthis._threads.set(commentThread.handle, commentThread);\n\t\t\t\treturn commentThread;\n\t\t\t} else {\n\t\t\t\tconst commentThread = new ExtHostCommentThread(this.id, this.handle, undefined, arg0 as vscode.Uri, arg1 as vscode.Range, arg2 as vscode.Comment[], this._extension, false);\n\t\t\t\tthis._threads.set(commentThread.handle, commentThread);\n\t\t\t\treturn commentThread;\n\t\t\t}\n\t\t}\n\n\t\t$createCommentThreadTemplate(uriComponents: UriComponents, range: IRange): ExtHostCommentThread {\n\t\t\tconst commentThread = new ExtHostCommentThread(this.id, this.handle, undefined, URI.revive(uriComponents), extHostTypeConverter.Range.to(range), [], this._extension, true);\n\t\t\tcommentThread.collapsibleState = languages.CommentThreadCollapsibleState.Expanded;\n\t\t\tthis._threads.set(commentThread.handle, commentThread);\n\t\t\treturn commentThread;\n\t\t}\n\n\t\t$updateCommentThreadTemplate(threadHandle: number, range: IRange): void {\n\t\t\tconst thread = this._threads.get(threadHandle);\n\t\t\tif (thread) {\n\t\t\t\tthread.range = extHostTypeConverter.Range.to(range);\n\t\t\t}\n\t\t}\n\n\t\t$deleteCommentThread(threadHandle: number): void {\n\t\t\tconst thread = this._threads.get(threadHandle);\n\n\t\t\tif (thread) {\n\t\t\t\tthread.dispose();\n\t\t\t}\n\n\t\t\tthis._threads.delete(threadHandle);\n\t\t}\n\n\t\tgetCommentThread(handle: number): ExtHostCommentThread | undefined {\n\t\t\treturn this._threads.get(handle);\n\t\t}\n\n\t\tdispose(): void {\n\t\t\tthis._threads.forEach(value => {\n\t\t\t\tvalue.dispose();\n\t\t\t});\n\n\t\t\tthis._localDisposables.forEach(disposable => disposable.dispose());\n\t\t}\n\t}\n\n\tfunction convertToDTOComment(thread: ExtHostCommentThread, vscodeComment: vscode.Comment, commentsMap: Map<vscode.Comment, number>): CommentChanges {\n\t\tlet commentUniqueId = commentsMap.get(vscodeComment)!;\n\t\tif (!commentUniqueId) {\n\t\t\tcommentUniqueId = ++thread.commentHandle;\n\t\t\tcommentsMap.set(vscodeComment, commentUniqueId);\n\t\t}\n\n\t\tconst iconPath = vscodeComment.author && vscodeComment.author.iconPath ? vscodeComment.author.iconPath.toString() : undefined;\n\n\t\treturn {\n\t\t\tmode: vscodeComment.mode,\n\t\t\tcontextValue: vscodeComment.contextValue,\n\t\t\tuniqueIdInThread: commentUniqueId,\n\t\t\tbody: (typeof vscodeComment.body === 'string') ? vscodeComment.body : extHostTypeConverter.MarkdownString.from(vscodeComment.body),\n\t\t\tuserName: vscodeComment.author.name,\n\t\t\tuserIconPath: iconPath,\n\t\t\tlabel: vscodeComment.label,\n\t\t\tcommentReactions: vscodeComment.reactions ? vscodeComment.reactions.map(reaction => convertToReaction(reaction)) : undefined,\n\t\t\ttimestamp: vscodeComment.timestamp?.toJSON()\n\t\t};\n\t}\n\n\tfunction convertToReaction(reaction: vscode.CommentReaction): languages.CommentReaction {\n\t\treturn {\n\t\t\tlabel: reaction.label,\n\t\t\ticonPath: reaction.iconPath ? extHostTypeConverter.pathOrURIToURI(reaction.iconPath) : undefined,\n\t\t\tcount: reaction.count,\n\t\t\thasReacted: reaction.authorHasReacted,\n\t\t};\n\t}\n\n\tfunction convertFromReaction(reaction: languages.CommentReaction): vscode.CommentReaction {\n\t\treturn {\n\t\t\tlabel: reaction.label || '',\n\t\t\tcount: reaction.count || 0,\n\t\t\ticonPath: reaction.iconPath ? URI.revive(reaction.iconPath) : '',\n\t\t\tauthorHasReacted: reaction.hasReacted || false\n\t\t};\n\t}\n\n\tfunction convertToCollapsibleState(kind: vscode.CommentThreadCollapsibleState | undefined): languages.CommentThreadCollapsibleState {\n\t\tif (kind !== undefined) {\n\t\t\tswitch (kind) {\n\t\t\t\tcase types.CommentThreadCollapsibleState.Expanded:\n\t\t\t\t\treturn languages.CommentThreadCollapsibleState.Expanded;\n\t\t\t\tcase types.CommentThreadCollapsibleState.Collapsed:\n\t\t\t\t\treturn languages.CommentThreadCollapsibleState.Collapsed;\n\t\t\t}\n\t\t}\n\t\treturn languages.CommentThreadCollapsibleState.Collapsed;\n\t}\n\n\tfunction convertToState(kind: vscode.CommentThreadState | undefined): languages.CommentThreadState {\n\t\tif (kind !== undefined) {\n\t\t\tswitch (kind) {\n\t\t\t\tcase types.CommentThreadState.Unresolved:\n\t\t\t\t\treturn languages.CommentThreadState.Unresolved;\n\t\t\t\tcase types.CommentThreadState.Resolved:\n\t\t\t\t\treturn languages.CommentThreadState.Resolved;\n\t\t\t}\n\t\t}\n\t\treturn languages.CommentThreadState.Unresolved;\n\t}\n\n\treturn new ExtHostCommentsImpl();\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IStackArgument } from 'vs/base/common/console';\nimport { safeStringify } from 'vs/base/common/objects';\nimport { MainContext, MainThreadConsoleShape } from 'vs/workbench/api/common/extHost.protocol';\nimport { IExtHostInitDataService } from 'vs/workbench/api/common/extHostInitDataService';\nimport { IExtHostRpcService } from 'vs/workbench/api/common/extHostRpcService';\n\nexport abstract class AbstractExtHostConsoleForwarder {\n\n\tprivate readonly _mainThreadConsole: MainThreadConsoleShape;\n\tprivate readonly _includeStack: boolean;\n\tprivate readonly _logNative: boolean;\n\n\tconstructor(\n\t\t@IExtHostRpcService extHostRpc: IExtHostRpcService,\n\t\t@IExtHostInitDataService initData: IExtHostInitDataService,\n\t) {\n\t\tthis._mainThreadConsole = extHostRpc.getProxy(MainContext.MainThreadConsole);\n\t\tthis._includeStack = initData.consoleForward.includeStack;\n\t\tthis._logNative = initData.consoleForward.logNative;\n\n\t\t// Pass console logging to the outside so that we have it in the main side if told so\n\t\tthis._wrapConsoleMethod('info', 'log');\n\t\tthis._wrapConsoleMethod('log', 'log');\n\t\tthis._wrapConsoleMethod('warn', 'warn');\n\t\tthis._wrapConsoleMethod('error', 'error');\n\t}\n\n\t/**\n\t * Wraps a console message so that it is transmitted to the renderer. If\n\t * native logging is turned on, the original console message will be written\n\t * as well. This is needed since the console methods are \"magic\" in V8 and\n\t * are the only methods that allow later introspection of logged variables.\n\t *\n\t * The wrapped property is not defined with `writable: false` to avoid\n\t * throwing errors, but rather a no-op setting. See https://github.com/microsoft/vscode-extension-telemetry/issues/88\n\t */\n\tprivate _wrapConsoleMethod(method: 'log' | 'info' | 'warn' | 'error', severity: 'log' | 'warn' | 'error') {\n\t\tconst that = this;\n\t\tconst original = console[method];\n\n\t\tObject.defineProperty(console, method, {\n\t\t\tset: () => { },\n\t\t\tget: () => function () {\n\t\t\t\tthat._handleConsoleCall(method, severity, original, arguments);\n\t\t\t},\n\t\t});\n\t}\n\n\tprivate _handleConsoleCall(method: 'log' | 'info' | 'warn' | 'error', severity: 'log' | 'warn' | 'error', original: (...args: any[]) => void, args: IArguments): void {\n\t\tthis._mainThreadConsole.$logExtensionHostMessage({\n\t\t\ttype: '__$console',\n\t\t\tseverity,\n\t\t\targuments: safeStringifyArgumentsToArray(args, this._includeStack)\n\t\t});\n\t\tif (this._logNative) {\n\t\t\tthis._nativeConsoleLogMessage(method, original, args);\n\t\t}\n\t}\n\n\tprotected abstract _nativeConsoleLogMessage(method: 'log' | 'info' | 'warn' | 'error', original: (...args: any[]) => void, args: IArguments): void;\n\n}\n\nconst MAX_LENGTH = 100000;\n\n/**\n * Prevent circular stringify and convert arguments to real array\n */\nfunction safeStringifyArgumentsToArray(args: IArguments, includeStack: boolean): string {\n\tconst argsArray = [];\n\n\t// Massage some arguments with special treatment\n\tif (args.length) {\n\t\tfor (let i = 0; i < args.length; i++) {\n\t\t\tlet arg = args[i];\n\n\t\t\t// Any argument of type 'undefined' needs to be specially treated because\n\t\t\t// JSON.stringify will simply ignore those. We replace them with the string\n\t\t\t// 'undefined' which is not 100% right, but good enough to be logged to console\n\t\t\tif (typeof arg === 'undefined') {\n\t\t\t\targ = 'undefined';\n\t\t\t}\n\n\t\t\t// Any argument that is an Error will be changed to be just the error stack/message\n\t\t\t// itself because currently cannot serialize the error over entirely.\n\t\t\telse if (arg instanceof Error) {\n\t\t\t\tconst errorObj = arg;\n\t\t\t\tif (errorObj.stack) {\n\t\t\t\t\targ = errorObj.stack;\n\t\t\t\t} else {\n\t\t\t\t\targ = errorObj.toString();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\targsArray.push(arg);\n\t\t}\n\t}\n\n\t// Add the stack trace as payload if we are told so. We remove the message and the 2 top frames\n\t// to start the stacktrace where the console message was being written\n\tif (includeStack) {\n\t\tconst stack = new Error().stack;\n\t\tif (stack) {\n\t\t\targsArray.push({ __$stack: stack.split('\\n').slice(3).join('\\n') } as IStackArgument);\n\t\t}\n\t}\n\n\ttry {\n\t\tconst res = safeStringify(argsArray);\n\n\t\tif (res.length > MAX_LENGTH) {\n\t\t\treturn 'Output omitted for a large object that exceeds the limits';\n\t\t}\n\n\t\treturn res;\n\t} catch (error) {\n\t\treturn `Output omitted for an object that cannot be inspected ('${error.toString()}')`;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type * as vscode from 'vscode';\nimport { URI } from 'vs/base/common/uri';\nimport { MainContext, ExtHostDecorationsShape, MainThreadDecorationsShape, DecorationData, DecorationRequest, DecorationReply } from 'vs/workbench/api/common/extHost.protocol';\nimport { Disposable, FileDecoration } from 'vs/workbench/api/common/extHostTypes';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { ExtensionIdentifier } from 'vs/platform/extensions/common/extensions';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { IExtHostRpcService } from 'vs/workbench/api/common/extHostRpcService';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { asArray, groupBy } from 'vs/base/common/arrays';\nimport { compare, count } from 'vs/base/common/strings';\nimport { dirname } from 'vs/base/common/path';\n\ninterface ProviderData {\n\tprovider: vscode.FileDecorationProvider;\n\textensionId: ExtensionIdentifier;\n}\n\nexport class ExtHostDecorations implements ExtHostDecorationsShape {\n\n\tprivate static _handlePool = 0;\n\tprivate static _maxEventSize = 250;\n\n\treadonly _serviceBrand: undefined;\n\tprivate readonly _provider = new Map<number, ProviderData>();\n\tprivate readonly _proxy: MainThreadDecorationsShape;\n\n\tconstructor(\n\t\t@IExtHostRpcService extHostRpc: IExtHostRpcService,\n\t\t@ILogService private readonly _logService: ILogService,\n\t) {\n\t\tthis._proxy = extHostRpc.getProxy(MainContext.MainThreadDecorations);\n\t}\n\n\tregisterFileDecorationProvider(provider: vscode.FileDecorationProvider, extensionId: ExtensionIdentifier): vscode.Disposable {\n\t\tconst handle = ExtHostDecorations._handlePool++;\n\t\tthis._provider.set(handle, { provider, extensionId });\n\t\tthis._proxy.$registerDecorationProvider(handle, extensionId.value);\n\n\t\tconst listener = provider.onDidChangeFileDecorations && provider.onDidChangeFileDecorations(e => {\n\t\t\tif (!e) {\n\t\t\t\tthis._proxy.$onDidChange(handle, null);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst array = asArray(e);\n\t\t\tif (array.length <= ExtHostDecorations._maxEventSize) {\n\t\t\t\tthis._proxy.$onDidChange(handle, array);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// too many resources per event. pick one resource per folder, starting\n\t\t\t// with parent folders\n\t\t\tthis._logService.warn('[Decorations] CAPPING events from decorations provider', extensionId.value, array.length);\n\t\t\tconst mapped = array.map(uri => ({ uri, rank: count(uri.path, '/') }));\n\t\t\tconst groups = groupBy(mapped, (a, b) => a.rank - b.rank || compare(a.uri.path, b.uri.path));\n\t\t\tconst picked: URI[] = [];\n\t\t\touter: for (const uris of groups) {\n\t\t\t\tlet lastDirname: string | undefined;\n\t\t\t\tfor (const obj of uris) {\n\t\t\t\t\tconst myDirname = dirname(obj.uri.path);\n\t\t\t\t\tif (lastDirname !== myDirname) {\n\t\t\t\t\t\tlastDirname = myDirname;\n\t\t\t\t\t\tif (picked.push(obj.uri) >= ExtHostDecorations._maxEventSize) {\n\t\t\t\t\t\t\tbreak outer;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._proxy.$onDidChange(handle, picked);\n\t\t});\n\n\t\treturn new Disposable(() => {\n\t\t\tlistener?.dispose();\n\t\t\tthis._proxy.$unregisterDecorationProvider(handle);\n\t\t\tthis._provider.delete(handle);\n\t\t});\n\t}\n\n\tasync $provideDecorations(handle: number, requests: DecorationRequest[], token: CancellationToken): Promise<DecorationReply> {\n\n\t\tif (!this._provider.has(handle)) {\n\t\t\t// might have been unregistered in the meantime\n\t\t\treturn Object.create(null);\n\t\t}\n\n\t\tconst result: DecorationReply = Object.create(null);\n\t\tconst { provider, extensionId } = this._provider.get(handle)!;\n\n\t\tawait Promise.all(requests.map(async request => {\n\t\t\ttry {\n\t\t\t\tconst { uri, id } = request;\n\t\t\t\tconst data = await Promise.resolve(provider.provideFileDecoration(URI.revive(uri), token));\n\t\t\t\tif (!data) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\ttry {\n\t\t\t\t\tFileDecoration.validate(data);\n\t\t\t\t\tresult[id] = <DecorationData>[data.propagate, data.tooltip, data.badge, data.color];\n\t\t\t\t} catch (e) {\n\t\t\t\t\tthis._logService.warn(`INVALID decoration from extension '${extensionId.value}': ${e}`);\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t\tthis._logService.error(err);\n\t\t\t}\n\t\t}));\n\n\t\treturn result;\n\t}\n}\n\nexport const IExtHostDecorations = createDecorator<IExtHostDecorations>('IExtHostDecorations');\nexport interface IExtHostDecorations extends ExtHostDecorations { }\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { localize } from 'vs/nls';\nimport { IMarkerData, MarkerSeverity } from 'vs/platform/markers/common/markers';\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport type * as vscode from 'vscode';\nimport { MainContext, MainThreadDiagnosticsShape, ExtHostDiagnosticsShape, IMainContext } from './extHost.protocol';\nimport { DiagnosticSeverity } from './extHostTypes';\nimport * as converter from './extHostTypeConverters';\nimport { Event, Emitter, DebounceEmitter } from 'vs/base/common/event';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { ResourceMap } from 'vs/base/common/map';\nimport { ExtensionIdentifier } from 'vs/platform/extensions/common/extensions';\nimport { IExtHostFileSystemInfo } from 'vs/workbench/api/common/extHostFileSystemInfo';\nimport { IExtUri } from 'vs/base/common/resources';\n\nexport class DiagnosticCollection implements vscode.DiagnosticCollection {\n\n\treadonly #proxy: MainThreadDiagnosticsShape | undefined;\n\treadonly #onDidChangeDiagnostics: Emitter<vscode.Uri[]>;\n\treadonly #data: ResourceMap<vscode.Diagnostic[]>;\n\n\tprivate _isDisposed = false;\n\n\tconstructor(\n\t\tprivate readonly _name: string,\n\t\tprivate readonly _owner: string,\n\t\tprivate readonly _maxDiagnosticsPerFile: number,\n\t\textUri: IExtUri,\n\t\tproxy: MainThreadDiagnosticsShape | undefined,\n\t\tonDidChangeDiagnostics: Emitter<vscode.Uri[]>\n\t) {\n\t\tthis.#data = new ResourceMap(uri => extUri.getComparisonKey(uri));\n\t\tthis.#proxy = proxy;\n\t\tthis.#onDidChangeDiagnostics = onDidChangeDiagnostics;\n\t}\n\n\tdispose(): void {\n\t\tif (!this._isDisposed) {\n\t\t\tthis.#onDidChangeDiagnostics.fire([...this.#data.keys()]);\n\t\t\tthis.#proxy?.$clear(this._owner);\n\t\t\tthis.#data.clear();\n\t\t\tthis._isDisposed = true;\n\t\t}\n\t}\n\n\tget name(): string {\n\t\tthis._checkDisposed();\n\t\treturn this._name;\n\t}\n\n\tset(uri: vscode.Uri, diagnostics: ReadonlyArray<vscode.Diagnostic>): void;\n\tset(entries: ReadonlyArray<[vscode.Uri, ReadonlyArray<vscode.Diagnostic>]>): void;\n\tset(first: vscode.Uri | ReadonlyArray<[vscode.Uri, ReadonlyArray<vscode.Diagnostic>]>, diagnostics?: ReadonlyArray<vscode.Diagnostic>) {\n\n\t\tif (!first) {\n\t\t\t// this set-call is a clear-call\n\t\t\tthis.clear();\n\t\t\treturn;\n\t\t}\n\n\t\t// the actual implementation for #set\n\n\t\tthis._checkDisposed();\n\t\tlet toSync: vscode.Uri[] = [];\n\n\t\tif (URI.isUri(first)) {\n\n\t\t\tif (!diagnostics) {\n\t\t\t\t// remove this entry\n\t\t\t\tthis.delete(first);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// update single row\n\t\t\tthis.#data.set(first, diagnostics.slice());\n\t\t\ttoSync = [first];\n\n\t\t} else if (Array.isArray(first)) {\n\t\t\t// update many rows\n\t\t\ttoSync = [];\n\t\t\tlet lastUri: vscode.Uri | undefined;\n\n\t\t\t// ensure stable-sort\n\t\t\tfirst = [...first].sort(DiagnosticCollection._compareIndexedTuplesByUri);\n\n\t\t\tfor (const tuple of first) {\n\t\t\t\tconst [uri, diagnostics] = tuple;\n\t\t\t\tif (!lastUri || uri.toString() !== lastUri.toString()) {\n\t\t\t\t\tif (lastUri && this.#data.get(lastUri)!.length === 0) {\n\t\t\t\t\t\tthis.#data.delete(lastUri);\n\t\t\t\t\t}\n\t\t\t\t\tlastUri = uri;\n\t\t\t\t\ttoSync.push(uri);\n\t\t\t\t\tthis.#data.set(uri, []);\n\t\t\t\t}\n\n\t\t\t\tif (!diagnostics) {\n\t\t\t\t\t// [Uri, undefined] means clear this\n\t\t\t\t\tconst currentDiagnostics = this.#data.get(uri);\n\t\t\t\t\tif (currentDiagnostics) {\n\t\t\t\t\t\tcurrentDiagnostics.length = 0;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst currentDiagnostics = this.#data.get(uri);\n\t\t\t\t\tcurrentDiagnostics?.push(...diagnostics);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// send event for extensions\n\t\tthis.#onDidChangeDiagnostics.fire(toSync);\n\n\t\t// compute change and send to main side\n\t\tif (!this.#proxy) {\n\t\t\treturn;\n\t\t}\n\t\tconst entries: [URI, IMarkerData[]][] = [];\n\t\tfor (const uri of toSync) {\n\t\t\tlet marker: IMarkerData[] = [];\n\t\t\tconst diagnostics = this.#data.get(uri);\n\t\t\tif (diagnostics) {\n\n\t\t\t\t// no more than N diagnostics per file\n\t\t\t\tif (diagnostics.length > this._maxDiagnosticsPerFile) {\n\t\t\t\t\tmarker = [];\n\t\t\t\t\tconst order = [DiagnosticSeverity.Error, DiagnosticSeverity.Warning, DiagnosticSeverity.Information, DiagnosticSeverity.Hint];\n\t\t\t\t\torderLoop: for (let i = 0; i < 4; i++) {\n\t\t\t\t\t\tfor (const diagnostic of diagnostics) {\n\t\t\t\t\t\t\tif (diagnostic.severity === order[i]) {\n\t\t\t\t\t\t\t\tconst len = marker.push(converter.Diagnostic.from(diagnostic));\n\t\t\t\t\t\t\t\tif (len === this._maxDiagnosticsPerFile) {\n\t\t\t\t\t\t\t\t\tbreak orderLoop;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// add 'signal' marker for showing omitted errors/warnings\n\t\t\t\t\tmarker.push({\n\t\t\t\t\t\tseverity: MarkerSeverity.Info,\n\t\t\t\t\t\tmessage: localize({ key: 'limitHit', comment: ['amount of errors/warning skipped due to limits'] }, \"Not showing {0} further errors and warnings.\", diagnostics.length - this._maxDiagnosticsPerFile),\n\t\t\t\t\t\tstartLineNumber: marker[marker.length - 1].startLineNumber,\n\t\t\t\t\t\tstartColumn: marker[marker.length - 1].startColumn,\n\t\t\t\t\t\tendLineNumber: marker[marker.length - 1].endLineNumber,\n\t\t\t\t\t\tendColumn: marker[marker.length - 1].endColumn\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tmarker = diagnostics.map(diag => converter.Diagnostic.from(diag));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tentries.push([uri, marker]);\n\t\t}\n\t\tthis.#proxy.$changeMany(this._owner, entries);\n\t}\n\n\tdelete(uri: vscode.Uri): void {\n\t\tthis._checkDisposed();\n\t\tthis.#onDidChangeDiagnostics.fire([uri]);\n\t\tthis.#data.delete(uri);\n\t\tthis.#proxy?.$changeMany(this._owner, [[uri, undefined]]);\n\t}\n\n\tclear(): void {\n\t\tthis._checkDisposed();\n\t\tthis.#onDidChangeDiagnostics.fire([...this.#data.keys()]);\n\t\tthis.#data.clear();\n\t\tthis.#proxy?.$clear(this._owner);\n\t}\n\n\tforEach(callback: (uri: URI, diagnostics: ReadonlyArray<vscode.Diagnostic>, collection: DiagnosticCollection) => any, thisArg?: any): void {\n\t\tthis._checkDisposed();\n\t\tfor (const [uri, values] of this) {\n\t\t\tcallback.call(thisArg, uri, values, this);\n\t\t}\n\t}\n\n\t*[Symbol.iterator](): IterableIterator<[uri: vscode.Uri, diagnostics: readonly vscode.Diagnostic[]]> {\n\t\tthis._checkDisposed();\n\t\tfor (const uri of this.#data.keys()) {\n\t\t\tyield [uri, this.get(uri)];\n\t\t}\n\t}\n\n\tget(uri: URI): ReadonlyArray<vscode.Diagnostic> {\n\t\tthis._checkDisposed();\n\t\tconst result = this.#data.get(uri);\n\t\tif (Array.isArray(result)) {\n\t\t\treturn Object.freeze(result.slice(0));\n\t\t}\n\t\treturn [];\n\t}\n\n\thas(uri: URI): boolean {\n\t\tthis._checkDisposed();\n\t\treturn Array.isArray(this.#data.get(uri));\n\t}\n\n\tprivate _checkDisposed() {\n\t\tif (this._isDisposed) {\n\t\t\tthrow new Error('illegal state - object is disposed');\n\t\t}\n\t}\n\n\tprivate static _compareIndexedTuplesByUri(a: [vscode.Uri, readonly vscode.Diagnostic[]], b: [vscode.Uri, readonly vscode.Diagnostic[]]): number {\n\t\tif (a[0].toString() < b[0].toString()) {\n\t\t\treturn -1;\n\t\t} else if (a[0].toString() > b[0].toString()) {\n\t\t\treturn 1;\n\t\t} else {\n\t\t\treturn 0;\n\t\t}\n\t}\n}\n\nexport class ExtHostDiagnostics implements ExtHostDiagnosticsShape {\n\n\tprivate static _idPool: number = 0;\n\tprivate static readonly _maxDiagnosticsPerFile: number = 1000;\n\n\tprivate readonly _proxy: MainThreadDiagnosticsShape;\n\tprivate readonly _collections = new Map<string, DiagnosticCollection>();\n\tprivate readonly _onDidChangeDiagnostics = new DebounceEmitter<vscode.Uri[]>({ merge: all => all.flat(), delay: 50 });\n\n\tstatic _mapper(last: vscode.Uri[]): { uris: readonly vscode.Uri[] } {\n\t\tconst map = new ResourceMap<vscode.Uri>();\n\t\tfor (const uri of last) {\n\t\t\tmap.set(uri, uri);\n\t\t}\n\t\treturn { uris: Object.freeze(Array.from(map.values())) };\n\t}\n\n\treadonly onDidChangeDiagnostics: Event<vscode.DiagnosticChangeEvent> = Event.map(this._onDidChangeDiagnostics.event, ExtHostDiagnostics._mapper);\n\n\tconstructor(\n\t\tmainContext: IMainContext,\n\t\t@ILogService private readonly _logService: ILogService,\n\t\t@IExtHostFileSystemInfo private readonly _fileSystemInfoService: IExtHostFileSystemInfo,\n\t) {\n\t\tthis._proxy = mainContext.getProxy(MainContext.MainThreadDiagnostics);\n\t}\n\n\tcreateDiagnosticCollection(extensionId: ExtensionIdentifier, name?: string): vscode.DiagnosticCollection {\n\n\t\tconst { _collections, _proxy, _onDidChangeDiagnostics, _logService, _fileSystemInfoService } = this;\n\n\t\tconst loggingProxy = new class implements MainThreadDiagnosticsShape {\n\t\t\t$changeMany(owner: string, entries: [UriComponents, IMarkerData[] | undefined][]): void {\n\t\t\t\t_proxy.$changeMany(owner, entries);\n\t\t\t\t_logService.trace('[DiagnosticCollection] change many (extension, owner, uris)', extensionId.value, owner, entries.length === 0 ? 'CLEARING' : entries);\n\t\t\t}\n\t\t\t$clear(owner: string): void {\n\t\t\t\t_proxy.$clear(owner);\n\t\t\t\t_logService.trace('[DiagnosticCollection] remove all (extension, owner)', extensionId.value, owner);\n\t\t\t}\n\t\t\tdispose(): void {\n\t\t\t\t_proxy.dispose();\n\t\t\t}\n\t\t};\n\n\n\t\tlet owner: string;\n\t\tif (!name) {\n\t\t\tname = '_generated_diagnostic_collection_name_#' + ExtHostDiagnostics._idPool++;\n\t\t\towner = name;\n\t\t} else if (!_collections.has(name)) {\n\t\t\towner = name;\n\t\t} else {\n\t\t\tthis._logService.warn(`DiagnosticCollection with name '${name}' does already exist.`);\n\t\t\tdo {\n\t\t\t\towner = name + ExtHostDiagnostics._idPool++;\n\t\t\t} while (_collections.has(owner));\n\t\t}\n\n\t\tconst result = new class extends DiagnosticCollection {\n\t\t\tconstructor() {\n\t\t\t\tsuper(name!, owner, ExtHostDiagnostics._maxDiagnosticsPerFile, _fileSystemInfoService.extUri, loggingProxy, _onDidChangeDiagnostics);\n\t\t\t\t_collections.set(owner, this);\n\t\t\t}\n\t\t\toverride dispose() {\n\t\t\t\tsuper.dispose();\n\t\t\t\t_collections.delete(owner);\n\t\t\t}\n\t\t};\n\n\t\treturn result;\n\t}\n\n\tgetDiagnostics(resource: vscode.Uri): ReadonlyArray<vscode.Diagnostic>;\n\tgetDiagnostics(): ReadonlyArray<[vscode.Uri, ReadonlyArray<vscode.Diagnostic>]>;\n\tgetDiagnostics(resource?: vscode.Uri): ReadonlyArray<vscode.Diagnostic> | ReadonlyArray<[vscode.Uri, ReadonlyArray<vscode.Diagnostic>]>;\n\tgetDiagnostics(resource?: vscode.Uri): ReadonlyArray<vscode.Diagnostic> | ReadonlyArray<[vscode.Uri, ReadonlyArray<vscode.Diagnostic>]> {\n\t\tif (resource) {\n\t\t\treturn this._getDiagnostics(resource);\n\t\t} else {\n\t\t\tconst index = new Map<string, number>();\n\t\t\tconst res: [vscode.Uri, vscode.Diagnostic[]][] = [];\n\t\t\tfor (const collection of this._collections.values()) {\n\t\t\t\tcollection.forEach((uri, diagnostics) => {\n\t\t\t\t\tlet idx = index.get(uri.toString());\n\t\t\t\t\tif (typeof idx === 'undefined') {\n\t\t\t\t\t\tidx = res.length;\n\t\t\t\t\t\tindex.set(uri.toString(), idx);\n\t\t\t\t\t\tres.push([uri, []]);\n\t\t\t\t\t}\n\t\t\t\t\tres[idx][1] = res[idx][1].concat(...diagnostics);\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn res;\n\t\t}\n\t}\n\n\tprivate _getDiagnostics(resource: vscode.Uri): ReadonlyArray<vscode.Diagnostic> {\n\t\tlet res: vscode.Diagnostic[] = [];\n\t\tfor (const collection of this._collections.values()) {\n\t\t\tif (collection.has(resource)) {\n\t\t\t\tres = res.concat(collection.get(resource));\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t}\n\n\tprivate _mirrorCollection: vscode.DiagnosticCollection | undefined;\n\n\t$acceptMarkersChange(data: [UriComponents, IMarkerData[]][]): void {\n\n\t\tif (!this._mirrorCollection) {\n\t\t\tconst name = '_generated_mirror';\n\t\t\tconst collection = new DiagnosticCollection(name, name, ExtHostDiagnostics._maxDiagnosticsPerFile, this._fileSystemInfoService.extUri, undefined, this._onDidChangeDiagnostics);\n\t\t\tthis._collections.set(name, collection);\n\t\t\tthis._mirrorCollection = collection;\n\t\t}\n\n\t\tfor (const [uri, markers] of data) {\n\t\t\tthis._mirrorCollection.set(URI.revive(uri), markers.map(converter.Diagnostic.to));\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type * as vscode from 'vscode';\nimport { URI } from 'vs/base/common/uri';\nimport { MainContext, MainThreadDiaglogsShape, IMainContext } from 'vs/workbench/api/common/extHost.protocol';\n\nexport class ExtHostDialogs {\n\n\tprivate readonly _proxy: MainThreadDiaglogsShape;\n\n\tconstructor(mainContext: IMainContext) {\n\t\tthis._proxy = mainContext.getProxy(MainContext.MainThreadDialogs);\n\t}\n\n\tshowOpenDialog(options?: vscode.OpenDialogOptions): Promise<URI[] | undefined> {\n\t\treturn this._proxy.$showOpenDialog(options).then(filepaths => {\n\t\t\treturn filepaths ? filepaths.map(p => URI.revive(p)) : undefined;\n\t\t});\n\t}\n\n\tshowSaveDialog(options?: vscode.SaveDialogOptions): Promise<URI | undefined> {\n\t\treturn this._proxy.$showSaveDialog(options).then(filepath => {\n\t\t\treturn filepath ? URI.revive(filepath) : undefined;\n\t\t});\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { onUnexpectedError } from 'vs/base/common/errors';\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { IDisposable } from 'vs/base/common/lifecycle';\nimport { Disposable } from 'vs/workbench/api/common/extHostTypes';\nimport type * as vscode from 'vscode';\nimport { MainContext, ExtHostDocumentContentProvidersShape, MainThreadDocumentContentProvidersShape, IMainContext } from './extHost.protocol';\nimport { ExtHostDocumentsAndEditors } from './extHostDocumentsAndEditors';\nimport { Schemas } from 'vs/base/common/network';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { splitLines } from 'vs/base/common/strings';\n\nexport class ExtHostDocumentContentProvider implements ExtHostDocumentContentProvidersShape {\n\n\tprivate static _handlePool = 0;\n\n\tprivate readonly _documentContentProviders = new Map<number, vscode.TextDocumentContentProvider>();\n\tprivate readonly _proxy: MainThreadDocumentContentProvidersShape;\n\n\tconstructor(\n\t\tmainContext: IMainContext,\n\t\tprivate readonly _documentsAndEditors: ExtHostDocumentsAndEditors,\n\t\tprivate readonly _logService: ILogService,\n\t) {\n\t\tthis._proxy = mainContext.getProxy(MainContext.MainThreadDocumentContentProviders);\n\t}\n\n\tregisterTextDocumentContentProvider(scheme: string, provider: vscode.TextDocumentContentProvider): vscode.Disposable {\n\t\t// todo@remote\n\t\t// check with scheme from fs-providers!\n\t\tif (Object.keys(Schemas).indexOf(scheme) >= 0) {\n\t\t\tthrow new Error(`scheme '${scheme}' already registered`);\n\t\t}\n\n\t\tconst handle = ExtHostDocumentContentProvider._handlePool++;\n\n\t\tthis._documentContentProviders.set(handle, provider);\n\t\tthis._proxy.$registerTextContentProvider(handle, scheme);\n\n\t\tlet subscription: IDisposable | undefined;\n\t\tif (typeof provider.onDidChange === 'function') {\n\t\t\tsubscription = provider.onDidChange(uri => {\n\t\t\t\tif (uri.scheme !== scheme) {\n\t\t\t\t\tthis._logService.warn(`Provider for scheme '${scheme}' is firing event for schema '${uri.scheme}' which will be IGNORED`);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (this._documentsAndEditors.getDocument(uri)) {\n\t\t\t\t\tthis.$provideTextDocumentContent(handle, uri).then(value => {\n\t\t\t\t\t\tif (!value && typeof value !== 'string') {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst document = this._documentsAndEditors.getDocument(uri);\n\t\t\t\t\t\tif (!document) {\n\t\t\t\t\t\t\t// disposed in the meantime\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// create lines and compare\n\t\t\t\t\t\tconst lines = splitLines(value);\n\n\t\t\t\t\t\t// broadcast event when content changed\n\t\t\t\t\t\tif (!document.equalLines(lines)) {\n\t\t\t\t\t\t\treturn this._proxy.$onVirtualDocumentChange(uri, value);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}, onUnexpectedError);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn new Disposable(() => {\n\t\t\tif (this._documentContentProviders.delete(handle)) {\n\t\t\t\tthis._proxy.$unregisterTextContentProvider(handle);\n\t\t\t}\n\t\t\tif (subscription) {\n\t\t\t\tsubscription.dispose();\n\t\t\t\tsubscription = undefined;\n\t\t\t}\n\t\t});\n\t}\n\n\t$provideTextDocumentContent(handle: number, uri: UriComponents): Promise<string | null | undefined> {\n\t\tconst provider = this._documentContentProviders.get(handle);\n\t\tif (!provider) {\n\t\t\treturn Promise.reject(new Error(`unsupported uri-scheme: ${uri.scheme}`));\n\t\t}\n\t\treturn Promise.resolve(provider.provideTextDocumentContent(URI.revive(uri), CancellationToken.None));\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { DisposableStore } from 'vs/base/common/lifecycle';\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { IModelChangedEvent } from 'vs/editor/common/model/mirrorTextModel';\nimport { ExtHostDocumentsShape, IMainContext, MainContext, MainThreadDocumentsShape } from 'vs/workbench/api/common/extHost.protocol';\nimport { ExtHostDocumentData, setWordDefinitionFor } from 'vs/workbench/api/common/extHostDocumentData';\nimport { ExtHostDocumentsAndEditors } from 'vs/workbench/api/common/extHostDocumentsAndEditors';\nimport * as TypeConverters from 'vs/workbench/api/common/extHostTypeConverters';\nimport type * as vscode from 'vscode';\nimport { assertIsDefined } from 'vs/base/common/types';\nimport { deepFreeze } from 'vs/base/common/objects';\nimport { TextDocumentChangeReason } from 'vs/workbench/api/common/extHostTypes';\n\nexport class ExtHostDocuments implements ExtHostDocumentsShape {\n\n\tprivate readonly _onDidAddDocument = new Emitter<vscode.TextDocument>();\n\tprivate readonly _onDidRemoveDocument = new Emitter<vscode.TextDocument>();\n\tprivate readonly _onDidChangeDocument = new Emitter<vscode.TextDocumentChangeEvent>();\n\tprivate readonly _onDidSaveDocument = new Emitter<vscode.TextDocument>();\n\n\treadonly onDidAddDocument: Event<vscode.TextDocument> = this._onDidAddDocument.event;\n\treadonly onDidRemoveDocument: Event<vscode.TextDocument> = this._onDidRemoveDocument.event;\n\treadonly onDidChangeDocument: Event<vscode.TextDocumentChangeEvent> = this._onDidChangeDocument.event;\n\treadonly onDidSaveDocument: Event<vscode.TextDocument> = this._onDidSaveDocument.event;\n\n\tprivate readonly _toDispose = new DisposableStore();\n\tprivate _proxy: MainThreadDocumentsShape;\n\tprivate _documentsAndEditors: ExtHostDocumentsAndEditors;\n\tprivate _documentLoader = new Map<string, Promise<ExtHostDocumentData>>();\n\n\tconstructor(mainContext: IMainContext, documentsAndEditors: ExtHostDocumentsAndEditors) {\n\t\tthis._proxy = mainContext.getProxy(MainContext.MainThreadDocuments);\n\t\tthis._documentsAndEditors = documentsAndEditors;\n\n\t\tthis._documentsAndEditors.onDidRemoveDocuments(documents => {\n\t\t\tfor (const data of documents) {\n\t\t\t\tthis._onDidRemoveDocument.fire(data.document);\n\t\t\t}\n\t\t}, undefined, this._toDispose);\n\t\tthis._documentsAndEditors.onDidAddDocuments(documents => {\n\t\t\tfor (const data of documents) {\n\t\t\t\tthis._onDidAddDocument.fire(data.document);\n\t\t\t}\n\t\t}, undefined, this._toDispose);\n\t}\n\n\tpublic dispose(): void {\n\t\tthis._toDispose.dispose();\n\t}\n\n\tpublic getAllDocumentData(): ExtHostDocumentData[] {\n\t\treturn [...this._documentsAndEditors.allDocuments()];\n\t}\n\n\tpublic getDocumentData(resource: vscode.Uri): ExtHostDocumentData | undefined {\n\t\tif (!resource) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst data = this._documentsAndEditors.getDocument(resource);\n\t\tif (data) {\n\t\t\treturn data;\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tpublic getDocument(resource: vscode.Uri): vscode.TextDocument {\n\t\tconst data = this.getDocumentData(resource);\n\t\tif (!data?.document) {\n\t\t\tthrow new Error(`Unable to retrieve document from URI '${resource}'`);\n\t\t}\n\t\treturn data.document;\n\t}\n\n\tpublic ensureDocumentData(uri: URI): Promise<ExtHostDocumentData> {\n\n\t\tconst cached = this._documentsAndEditors.getDocument(uri);\n\t\tif (cached) {\n\t\t\treturn Promise.resolve(cached);\n\t\t}\n\n\t\tlet promise = this._documentLoader.get(uri.toString());\n\t\tif (!promise) {\n\t\t\tpromise = this._proxy.$tryOpenDocument(uri).then(uriData => {\n\t\t\t\tthis._documentLoader.delete(uri.toString());\n\t\t\t\tconst canonicalUri = URI.revive(uriData);\n\t\t\t\treturn assertIsDefined(this._documentsAndEditors.getDocument(canonicalUri));\n\t\t\t}, err => {\n\t\t\t\tthis._documentLoader.delete(uri.toString());\n\t\t\t\treturn Promise.reject(err);\n\t\t\t});\n\t\t\tthis._documentLoader.set(uri.toString(), promise);\n\t\t}\n\n\t\treturn promise;\n\t}\n\n\tpublic createDocumentData(options?: { language?: string; content?: string }): Promise<URI> {\n\t\treturn this._proxy.$tryCreateDocument(options).then(data => URI.revive(data));\n\t}\n\n\tpublic $acceptModelLanguageChanged(uriComponents: UriComponents, newLanguageId: string): void {\n\t\tconst uri = URI.revive(uriComponents);\n\t\tconst data = this._documentsAndEditors.getDocument(uri);\n\t\tif (!data) {\n\t\t\tthrow new Error('unknown document');\n\t\t}\n\t\t// Treat a language change as a remove + add\n\n\t\tthis._onDidRemoveDocument.fire(data.document);\n\t\tdata._acceptLanguageId(newLanguageId);\n\t\tthis._onDidAddDocument.fire(data.document);\n\t}\n\n\tpublic $acceptModelSaved(uriComponents: UriComponents): void {\n\t\tconst uri = URI.revive(uriComponents);\n\t\tconst data = this._documentsAndEditors.getDocument(uri);\n\t\tif (!data) {\n\t\t\tthrow new Error('unknown document');\n\t\t}\n\t\tthis.$acceptDirtyStateChanged(uriComponents, false);\n\t\tthis._onDidSaveDocument.fire(data.document);\n\t}\n\n\tpublic $acceptDirtyStateChanged(uriComponents: UriComponents, isDirty: boolean): void {\n\t\tconst uri = URI.revive(uriComponents);\n\t\tconst data = this._documentsAndEditors.getDocument(uri);\n\t\tif (!data) {\n\t\t\tthrow new Error('unknown document');\n\t\t}\n\t\tdata._acceptIsDirty(isDirty);\n\t\tthis._onDidChangeDocument.fire({\n\t\t\tdocument: data.document,\n\t\t\tcontentChanges: [],\n\t\t\treason: undefined\n\t\t});\n\t}\n\n\tpublic $acceptModelChanged(uriComponents: UriComponents, events: IModelChangedEvent, isDirty: boolean): void {\n\t\tconst uri = URI.revive(uriComponents);\n\t\tconst data = this._documentsAndEditors.getDocument(uri);\n\t\tif (!data) {\n\t\t\tthrow new Error('unknown document');\n\t\t}\n\t\tdata._acceptIsDirty(isDirty);\n\t\tdata.onEvents(events);\n\n\t\tlet reason: vscode.TextDocumentChangeReason | undefined = undefined;\n\t\tif (events.isUndoing) {\n\t\t\treason = TextDocumentChangeReason.Undo;\n\t\t} else if (events.isRedoing) {\n\t\t\treason = TextDocumentChangeReason.Redo;\n\t\t}\n\n\t\tthis._onDidChangeDocument.fire(deepFreeze({\n\t\t\tdocument: data.document,\n\t\t\tcontentChanges: events.changes.map((change) => {\n\t\t\t\treturn {\n\t\t\t\t\trange: TypeConverters.Range.to(change.range),\n\t\t\t\t\trangeOffset: change.rangeOffset,\n\t\t\t\t\trangeLength: change.rangeLength,\n\t\t\t\t\ttext: change.text\n\t\t\t\t};\n\t\t\t}),\n\t\t\treason\n\t\t}));\n\t}\n\n\tpublic setWordDefinitionFor(languageId: string, wordDefinition: RegExp | undefined): void {\n\t\tsetWordDefinitionFor(languageId, wordDefinition);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as assert from 'vs/base/common/assert';\nimport * as vscode from 'vscode';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { dispose } from 'vs/base/common/lifecycle';\nimport { URI } from 'vs/base/common/uri';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { ExtHostDocumentsAndEditorsShape, IDocumentsAndEditorsDelta, IModelAddedData, MainContext } from 'vs/workbench/api/common/extHost.protocol';\nimport { ExtHostDocumentData } from 'vs/workbench/api/common/extHostDocumentData';\nimport { IExtHostRpcService } from 'vs/workbench/api/common/extHostRpcService';\nimport { ExtHostTextEditor } from 'vs/workbench/api/common/extHostTextEditor';\nimport * as typeConverters from 'vs/workbench/api/common/extHostTypeConverters';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { ResourceMap } from 'vs/base/common/map';\nimport { Schemas } from 'vs/base/common/network';\nimport { Iterable } from 'vs/base/common/iterator';\nimport { Lazy } from 'vs/base/common/lazy';\n\nclass Reference<T> {\n\tprivate _count = 0;\n\tconstructor(readonly value: T) { }\n\tref() {\n\t\tthis._count++;\n\t}\n\tunref() {\n\t\treturn --this._count === 0;\n\t}\n}\n\nexport interface IExtHostModelAddedData extends IModelAddedData {\n\tnotebook?: vscode.NotebookDocument;\n}\n\nexport interface IExtHostDocumentsAndEditorsDelta extends IDocumentsAndEditorsDelta {\n\taddedDocuments?: IExtHostModelAddedData[];\n}\n\nexport class ExtHostDocumentsAndEditors implements ExtHostDocumentsAndEditorsShape {\n\n\treadonly _serviceBrand: undefined;\n\n\tprivate _activeEditorId: string | null = null;\n\n\tprivate readonly _editors = new Map<string, ExtHostTextEditor>();\n\tprivate readonly _documents = new ResourceMap<Reference<ExtHostDocumentData>>();\n\n\tprivate readonly _onDidAddDocuments = new Emitter<ExtHostDocumentData[]>();\n\tprivate readonly _onDidRemoveDocuments = new Emitter<ExtHostDocumentData[]>();\n\tprivate readonly _onDidChangeVisibleTextEditors = new Emitter<vscode.TextEditor[]>();\n\tprivate readonly _onDidChangeActiveTextEditor = new Emitter<vscode.TextEditor | undefined>();\n\n\treadonly onDidAddDocuments: Event<ExtHostDocumentData[]> = this._onDidAddDocuments.event;\n\treadonly onDidRemoveDocuments: Event<ExtHostDocumentData[]> = this._onDidRemoveDocuments.event;\n\treadonly onDidChangeVisibleTextEditors: Event<vscode.TextEditor[]> = this._onDidChangeVisibleTextEditors.event;\n\treadonly onDidChangeActiveTextEditor: Event<vscode.TextEditor | undefined> = this._onDidChangeActiveTextEditor.event;\n\n\tconstructor(\n\t\t@IExtHostRpcService private readonly _extHostRpc: IExtHostRpcService,\n\t\t@ILogService private readonly _logService: ILogService\n\t) { }\n\n\t$acceptDocumentsAndEditorsDelta(delta: IDocumentsAndEditorsDelta): void {\n\t\tthis.acceptDocumentsAndEditorsDelta(delta);\n\t}\n\n\tacceptDocumentsAndEditorsDelta(delta: IExtHostDocumentsAndEditorsDelta): void {\n\n\t\tconst removedDocuments: ExtHostDocumentData[] = [];\n\t\tconst addedDocuments: ExtHostDocumentData[] = [];\n\t\tconst removedEditors: ExtHostTextEditor[] = [];\n\n\t\tif (delta.removedDocuments) {\n\t\t\tfor (const uriComponent of delta.removedDocuments) {\n\t\t\t\tconst uri = URI.revive(uriComponent);\n\t\t\t\tconst data = this._documents.get(uri);\n\t\t\t\tif (data?.unref()) {\n\t\t\t\t\tthis._documents.delete(uri);\n\t\t\t\t\tremovedDocuments.push(data.value);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (delta.addedDocuments) {\n\t\t\tfor (const data of delta.addedDocuments) {\n\t\t\t\tconst resource = URI.revive(data.uri);\n\t\t\t\tlet ref = this._documents.get(resource);\n\n\t\t\t\t// double check -> only notebook cell documents should be\n\t\t\t\t// referenced/opened more than once...\n\t\t\t\tif (ref) {\n\t\t\t\t\tif (resource.scheme !== Schemas.vscodeNotebookCell && resource.scheme !== Schemas.vscodeInteractiveInput) {\n\t\t\t\t\t\tthrow new Error(`document '${resource} already exists!'`);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!ref) {\n\t\t\t\t\tref = new Reference(new ExtHostDocumentData(\n\t\t\t\t\t\tthis._extHostRpc.getProxy(MainContext.MainThreadDocuments),\n\t\t\t\t\t\tresource,\n\t\t\t\t\t\tdata.lines,\n\t\t\t\t\t\tdata.EOL,\n\t\t\t\t\t\tdata.versionId,\n\t\t\t\t\t\tdata.languageId,\n\t\t\t\t\t\tdata.isDirty,\n\t\t\t\t\t\tdata.notebook\n\t\t\t\t\t));\n\t\t\t\t\tthis._documents.set(resource, ref);\n\t\t\t\t\taddedDocuments.push(ref.value);\n\t\t\t\t}\n\n\t\t\t\tref.ref();\n\t\t\t}\n\t\t}\n\n\t\tif (delta.removedEditors) {\n\t\t\tfor (const id of delta.removedEditors) {\n\t\t\t\tconst editor = this._editors.get(id);\n\t\t\t\tthis._editors.delete(id);\n\t\t\t\tif (editor) {\n\t\t\t\t\tremovedEditors.push(editor);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (delta.addedEditors) {\n\t\t\tfor (const data of delta.addedEditors) {\n\t\t\t\tconst resource = URI.revive(data.documentUri);\n\t\t\t\tassert.ok(this._documents.has(resource), `document '${resource}' does not exist`);\n\t\t\t\tassert.ok(!this._editors.has(data.id), `editor '${data.id}' already exists!`);\n\n\t\t\t\tconst documentData = this._documents.get(resource)!.value;\n\t\t\t\tconst editor = new ExtHostTextEditor(\n\t\t\t\t\tdata.id,\n\t\t\t\t\tthis._extHostRpc.getProxy(MainContext.MainThreadTextEditors),\n\t\t\t\t\tthis._logService,\n\t\t\t\t\tnew Lazy(() => documentData.document),\n\t\t\t\t\tdata.selections.map(typeConverters.Selection.to),\n\t\t\t\t\tdata.options,\n\t\t\t\t\tdata.visibleRanges.map(range => typeConverters.Range.to(range)),\n\t\t\t\t\ttypeof data.editorPosition === 'number' ? typeConverters.ViewColumn.to(data.editorPosition) : undefined\n\t\t\t\t);\n\t\t\t\tthis._editors.set(data.id, editor);\n\t\t\t}\n\t\t}\n\n\t\tif (delta.newActiveEditor !== undefined) {\n\t\t\tassert.ok(delta.newActiveEditor === null || this._editors.has(delta.newActiveEditor), `active editor '${delta.newActiveEditor}' does not exist`);\n\t\t\tthis._activeEditorId = delta.newActiveEditor;\n\t\t}\n\n\t\tdispose(removedDocuments);\n\t\tdispose(removedEditors);\n\n\t\t// now that the internal state is complete, fire events\n\t\tif (delta.removedDocuments) {\n\t\t\tthis._onDidRemoveDocuments.fire(removedDocuments);\n\t\t}\n\t\tif (delta.addedDocuments) {\n\t\t\tthis._onDidAddDocuments.fire(addedDocuments);\n\t\t}\n\n\t\tif (delta.removedEditors || delta.addedEditors) {\n\t\t\tthis._onDidChangeVisibleTextEditors.fire(this.allEditors().map(editor => editor.value));\n\t\t}\n\t\tif (delta.newActiveEditor !== undefined) {\n\t\t\tthis._onDidChangeActiveTextEditor.fire(this.activeEditor());\n\t\t}\n\t}\n\n\tgetDocument(uri: URI): ExtHostDocumentData | undefined {\n\t\treturn this._documents.get(uri)?.value;\n\t}\n\n\tallDocuments(): Iterable<ExtHostDocumentData> {\n\t\treturn Iterable.map(this._documents.values(), ref => ref.value);\n\t}\n\n\tgetEditor(id: string): ExtHostTextEditor | undefined {\n\t\treturn this._editors.get(id);\n\t}\n\n\tactiveEditor(): vscode.TextEditor | undefined;\n\tactiveEditor(internal: true): ExtHostTextEditor | undefined;\n\tactiveEditor(internal?: true): vscode.TextEditor | ExtHostTextEditor | undefined {\n\t\tif (!this._activeEditorId) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst editor = this._editors.get(this._activeEditorId);\n\t\tif (internal) {\n\t\t\treturn editor;\n\t\t} else {\n\t\t\treturn editor?.value;\n\t\t}\n\t}\n\n\tallEditors(): ExtHostTextEditor[] {\n\t\treturn [...this._editors.values()];\n\t}\n}\n\nexport interface IExtHostDocumentsAndEditors extends ExtHostDocumentsAndEditors { }\nexport const IExtHostDocumentsAndEditors = createDecorator<IExtHostDocumentsAndEditors>('IExtHostDocumentsAndEditors');\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type * as vscode from 'vscode';\nimport * as typeConverters from 'vs/workbench/api/common/extHostTypeConverters';\nimport { IEditorTabDto, IEditorTabGroupDto, IExtHostEditorTabsShape, MainContext, MainThreadEditorTabsShape, TabInputKind, TabModelOperationKind, TabOperation } from 'vs/workbench/api/common/extHost.protocol';\nimport { URI } from 'vs/base/common/uri';\nimport { Emitter } from 'vs/base/common/event';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { CustomEditorTabInput, InteractiveWindowInput, NotebookDiffEditorTabInput, NotebookEditorTabInput, TerminalEditorTabInput, TextDiffTabInput, TextMergeTabInput, TextTabInput, WebviewEditorTabInput } from 'vs/workbench/api/common/extHostTypes';\nimport { IExtHostRpcService } from 'vs/workbench/api/common/extHostRpcService';\nimport { assertIsDefined } from 'vs/base/common/types';\nimport { diffSets } from 'vs/base/common/collections';\n\nexport interface IExtHostEditorTabs extends IExtHostEditorTabsShape {\n\treadonly _serviceBrand: undefined;\n\ttabGroups: vscode.TabGroups;\n}\n\nexport const IExtHostEditorTabs = createDecorator<IExtHostEditorTabs>('IExtHostEditorTabs');\n\ntype AnyTabInput = TextTabInput | TextDiffTabInput | CustomEditorTabInput | NotebookEditorTabInput | NotebookDiffEditorTabInput | WebviewEditorTabInput | TerminalEditorTabInput | InteractiveWindowInput;\n\nclass ExtHostEditorTab {\n\tprivate _apiObject: vscode.Tab | undefined;\n\tprivate _dto!: IEditorTabDto;\n\tprivate _input: AnyTabInput | undefined;\n\tprivate _parentGroup: ExtHostEditorTabGroup;\n\tprivate readonly _activeTabIdGetter: () => string;\n\n\tconstructor(dto: IEditorTabDto, parentGroup: ExtHostEditorTabGroup, activeTabIdGetter: () => string) {\n\t\tthis._activeTabIdGetter = activeTabIdGetter;\n\t\tthis._parentGroup = parentGroup;\n\t\tthis.acceptDtoUpdate(dto);\n\t}\n\n\tget apiObject(): vscode.Tab {\n\t\tif (!this._apiObject) {\n\t\t\t// Don't want to lose reference to parent `this` in the getters\n\t\t\tconst that = this;\n\t\t\tconst obj: vscode.Tab = {\n\t\t\t\tget isActive() {\n\t\t\t\t\t// We use a getter function here to always ensure at most 1 active tab per group and prevent iteration for being required\n\t\t\t\t\treturn that._dto.id === that._activeTabIdGetter();\n\t\t\t\t},\n\t\t\t\tget label() {\n\t\t\t\t\treturn that._dto.label;\n\t\t\t\t},\n\t\t\t\tget input() {\n\t\t\t\t\treturn that._input;\n\t\t\t\t},\n\t\t\t\tget isDirty() {\n\t\t\t\t\treturn that._dto.isDirty;\n\t\t\t\t},\n\t\t\t\tget isPinned() {\n\t\t\t\t\treturn that._dto.isPinned;\n\t\t\t\t},\n\t\t\t\tget isPreview() {\n\t\t\t\t\treturn that._dto.isPreview;\n\t\t\t\t},\n\t\t\t\tget group() {\n\t\t\t\t\treturn that._parentGroup.apiObject;\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._apiObject = Object.freeze<vscode.Tab>(obj);\n\t\t}\n\t\treturn this._apiObject;\n\t}\n\n\tget tabId(): string {\n\t\treturn this._dto.id;\n\t}\n\n\tacceptDtoUpdate(dto: IEditorTabDto) {\n\t\tthis._dto = dto;\n\t\tthis._input = this._initInput();\n\t}\n\n\tprivate _initInput() {\n\t\tswitch (this._dto.input.kind) {\n\t\t\tcase TabInputKind.TextInput:\n\t\t\t\treturn new TextTabInput(URI.revive(this._dto.input.uri));\n\t\t\tcase TabInputKind.TextDiffInput:\n\t\t\t\treturn new TextDiffTabInput(URI.revive(this._dto.input.original), URI.revive(this._dto.input.modified));\n\t\t\tcase TabInputKind.TextMergeInput:\n\t\t\t\treturn new TextMergeTabInput(URI.revive(this._dto.input.base), URI.revive(this._dto.input.input1), URI.revive(this._dto.input.input2), URI.revive(this._dto.input.result));\n\t\t\tcase TabInputKind.CustomEditorInput:\n\t\t\t\treturn new CustomEditorTabInput(URI.revive(this._dto.input.uri), this._dto.input.viewType);\n\t\t\tcase TabInputKind.WebviewEditorInput:\n\t\t\t\treturn new WebviewEditorTabInput(this._dto.input.viewType);\n\t\t\tcase TabInputKind.NotebookInput:\n\t\t\t\treturn new NotebookEditorTabInput(URI.revive(this._dto.input.uri), this._dto.input.notebookType);\n\t\t\tcase TabInputKind.NotebookDiffInput:\n\t\t\t\treturn new NotebookDiffEditorTabInput(URI.revive(this._dto.input.original), URI.revive(this._dto.input.modified), this._dto.input.notebookType);\n\t\t\tcase TabInputKind.TerminalEditorInput:\n\t\t\t\treturn new TerminalEditorTabInput();\n\t\t\tcase TabInputKind.InteractiveEditorInput:\n\t\t\t\treturn new InteractiveWindowInput(URI.revive(this._dto.input.uri), URI.revive(this._dto.input.inputBoxUri));\n\t\t\tdefault:\n\t\t\t\treturn undefined;\n\t\t}\n\t}\n}\n\nclass ExtHostEditorTabGroup {\n\n\tprivate _apiObject: vscode.TabGroup | undefined;\n\tprivate _dto: IEditorTabGroupDto;\n\tprivate _tabs: ExtHostEditorTab[] = [];\n\tprivate _activeTabId: string = '';\n\tprivate _activeGroupIdGetter: () => number | undefined;\n\n\tconstructor(dto: IEditorTabGroupDto, activeGroupIdGetter: () => number | undefined) {\n\t\tthis._dto = dto;\n\t\tthis._activeGroupIdGetter = activeGroupIdGetter;\n\t\t// Construct all tabs from the given dto\n\t\tfor (const tabDto of dto.tabs) {\n\t\t\tif (tabDto.isActive) {\n\t\t\t\tthis._activeTabId = tabDto.id;\n\t\t\t}\n\t\t\tthis._tabs.push(new ExtHostEditorTab(tabDto, this, () => this.activeTabId()));\n\t\t}\n\t}\n\n\tget apiObject(): vscode.TabGroup {\n\t\tif (!this._apiObject) {\n\t\t\t// Don't want to lose reference to parent `this` in the getters\n\t\t\tconst that = this;\n\t\t\tconst obj: vscode.TabGroup = {\n\t\t\t\tget isActive() {\n\t\t\t\t\t// We use a getter function here to always ensure at most 1 active group and prevent iteration for being required\n\t\t\t\t\treturn that._dto.groupId === that._activeGroupIdGetter();\n\t\t\t\t},\n\t\t\t\tget viewColumn() {\n\t\t\t\t\treturn typeConverters.ViewColumn.to(that._dto.viewColumn);\n\t\t\t\t},\n\t\t\t\tget activeTab() {\n\t\t\t\t\treturn that._tabs.find(tab => tab.tabId === that._activeTabId)?.apiObject;\n\t\t\t\t},\n\t\t\t\tget tabs() {\n\t\t\t\t\treturn Object.freeze(that._tabs.map(tab => tab.apiObject));\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._apiObject = Object.freeze<vscode.TabGroup>(obj);\n\t\t}\n\t\treturn this._apiObject;\n\t}\n\n\tget groupId(): number {\n\t\treturn this._dto.groupId;\n\t}\n\n\tget tabs(): ExtHostEditorTab[] {\n\t\treturn this._tabs;\n\t}\n\n\tacceptGroupDtoUpdate(dto: IEditorTabGroupDto) {\n\t\tthis._dto = dto;\n\t}\n\n\tacceptTabOperation(operation: TabOperation): ExtHostEditorTab {\n\t\t// In the open case we add the tab to the group\n\t\tif (operation.kind === TabModelOperationKind.TAB_OPEN) {\n\t\t\tconst tab = new ExtHostEditorTab(operation.tabDto, this, () => this.activeTabId());\n\t\t\t// Insert tab at editor index\n\t\t\tthis._tabs.splice(operation.index, 0, tab);\n\t\t\tif (operation.tabDto.isActive) {\n\t\t\t\tthis._activeTabId = tab.tabId;\n\t\t\t}\n\t\t\treturn tab;\n\t\t} else if (operation.kind === TabModelOperationKind.TAB_CLOSE) {\n\t\t\tconst tab = this._tabs.splice(operation.index, 1)[0];\n\t\t\tif (!tab) {\n\t\t\t\tthrow new Error(`Tab close updated received for index ${operation.index} which does not exist`);\n\t\t\t}\n\t\t\tif (tab.tabId === this._activeTabId) {\n\t\t\t\tthis._activeTabId = '';\n\t\t\t}\n\t\t\treturn tab;\n\t\t} else if (operation.kind === TabModelOperationKind.TAB_MOVE) {\n\t\t\tif (operation.oldIndex === undefined) {\n\t\t\t\tthrow new Error('Invalid old index on move IPC');\n\t\t\t}\n\t\t\t// Splice to remove at old index and insert at new index === moving the tab\n\t\t\tconst tab = this._tabs.splice(operation.oldIndex, 1)[0];\n\t\t\tif (!tab) {\n\t\t\t\tthrow new Error(`Tab move updated received for index ${operation.oldIndex} which does not exist`);\n\t\t\t}\n\t\t\tthis._tabs.splice(operation.index, 0, tab);\n\t\t\treturn tab;\n\t\t}\n\t\tconst tab = this._tabs.find(extHostTab => extHostTab.tabId === operation.tabDto.id);\n\t\tif (!tab) {\n\t\t\tthrow new Error('INVALID tab');\n\t\t}\n\t\tif (operation.tabDto.isActive) {\n\t\t\tthis._activeTabId = operation.tabDto.id;\n\t\t} else if (this._activeTabId === operation.tabDto.id && !operation.tabDto.isActive) {\n\t\t\t// Events aren't guaranteed to be in order so if we receive a dto that matches the active tab id\n\t\t\t// but isn't active we mark the active tab id as empty. This prevent onDidActiveTabChange from\n\t\t\t// firing incorrectly\n\t\t\tthis._activeTabId = '';\n\t\t}\n\t\ttab.acceptDtoUpdate(operation.tabDto);\n\t\treturn tab;\n\t}\n\n\t// Not a getter since it must be a function to be used as a callback for the tabs\n\tactiveTabId(): string {\n\t\treturn this._activeTabId;\n\t}\n}\n\nexport class ExtHostEditorTabs implements IExtHostEditorTabs {\n\treadonly _serviceBrand: undefined;\n\n\tprivate readonly _proxy: MainThreadEditorTabsShape;\n\tprivate readonly _onDidChangeTabs = new Emitter<vscode.TabChangeEvent>();\n\tprivate readonly _onDidChangeTabGroups = new Emitter<vscode.TabGroupChangeEvent>();\n\n\t// Have to use ! because this gets initialized via an RPC proxy\n\tprivate _activeGroupId!: number;\n\n\tprivate _extHostTabGroups: ExtHostEditorTabGroup[] = [];\n\n\tprivate _apiObject: vscode.TabGroups | undefined;\n\n\tconstructor(@IExtHostRpcService extHostRpc: IExtHostRpcService) {\n\t\tthis._proxy = extHostRpc.getProxy(MainContext.MainThreadEditorTabs);\n\t}\n\n\tget tabGroups(): vscode.TabGroups {\n\t\tif (!this._apiObject) {\n\t\t\tconst that = this;\n\t\t\tconst obj: vscode.TabGroups = {\n\t\t\t\t// never changes -> simple value\n\t\t\t\tonDidChangeTabGroups: that._onDidChangeTabGroups.event,\n\t\t\t\tonDidChangeTabs: that._onDidChangeTabs.event,\n\t\t\t\t// dynamic -> getters\n\t\t\t\tget all() {\n\t\t\t\t\treturn Object.freeze(that._extHostTabGroups.map(group => group.apiObject));\n\t\t\t\t},\n\t\t\t\tget activeTabGroup() {\n\t\t\t\t\tconst activeTabGroupId = that._activeGroupId;\n\t\t\t\t\tconst activeTabGroup = assertIsDefined(that._extHostTabGroups.find(candidate => candidate.groupId === activeTabGroupId)?.apiObject);\n\t\t\t\t\treturn activeTabGroup;\n\t\t\t\t},\n\t\t\t\tclose: async (tabOrTabGroup: vscode.Tab | readonly vscode.Tab[] | vscode.TabGroup | readonly vscode.TabGroup[], preserveFocus?: boolean) => {\n\t\t\t\t\tconst tabsOrTabGroups = Array.isArray(tabOrTabGroup) ? tabOrTabGroup : [tabOrTabGroup];\n\t\t\t\t\tif (!tabsOrTabGroups.length) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\t// Check which type was passed in and call the appropriate close\n\t\t\t\t\t// Casting is needed as typescript doesn't seem to infer enough from this\n\t\t\t\t\tif (isTabGroup(tabsOrTabGroups[0])) {\n\t\t\t\t\t\treturn this._closeGroups(tabsOrTabGroups as vscode.TabGroup[], preserveFocus);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn this._closeTabs(tabsOrTabGroups as vscode.Tab[], preserveFocus);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t// move: async (tab: vscode.Tab, viewColumn: ViewColumn, index: number, preserveFocus?: boolean) => {\n\t\t\t\t// \tconst extHostTab = this._findExtHostTabFromApi(tab);\n\t\t\t\t// \tif (!extHostTab) {\n\t\t\t\t// \t\tthrow new Error('Invalid tab');\n\t\t\t\t// \t}\n\t\t\t\t// \tthis._proxy.$moveTab(extHostTab.tabId, index, typeConverters.ViewColumn.from(viewColumn), preserveFocus);\n\t\t\t\t// \treturn;\n\t\t\t\t// }\n\t\t\t};\n\t\t\tthis._apiObject = Object.freeze(obj);\n\t\t}\n\t\treturn this._apiObject;\n\t}\n\n\t$acceptEditorTabModel(tabGroups: IEditorTabGroupDto[]): void {\n\n\t\tconst groupIdsBefore = new Set(this._extHostTabGroups.map(group => group.groupId));\n\t\tconst groupIdsAfter = new Set(tabGroups.map(dto => dto.groupId));\n\t\tconst diff = diffSets(groupIdsBefore, groupIdsAfter);\n\n\t\tconst closed: vscode.TabGroup[] = this._extHostTabGroups.filter(group => diff.removed.includes(group.groupId)).map(group => group.apiObject);\n\t\tconst opened: vscode.TabGroup[] = [];\n\t\tconst changed: vscode.TabGroup[] = [];\n\n\n\t\tthis._extHostTabGroups = tabGroups.map(tabGroup => {\n\t\t\tconst group = new ExtHostEditorTabGroup(tabGroup, () => this._activeGroupId);\n\t\t\tif (diff.added.includes(group.groupId)) {\n\t\t\t\topened.push(group.apiObject);\n\t\t\t} else {\n\t\t\t\tchanged.push(group.apiObject);\n\t\t\t}\n\t\t\treturn group;\n\t\t});\n\n\t\t// Set the active tab group id\n\t\tconst activeTabGroupId = assertIsDefined(tabGroups.find(group => group.isActive === true)?.groupId);\n\t\tif (activeTabGroupId !== undefined && this._activeGroupId !== activeTabGroupId) {\n\t\t\tthis._activeGroupId = activeTabGroupId;\n\t\t}\n\t\tthis._onDidChangeTabGroups.fire(Object.freeze({ opened, closed, changed }));\n\t}\n\n\t$acceptTabGroupUpdate(groupDto: IEditorTabGroupDto) {\n\t\tconst group = this._extHostTabGroups.find(group => group.groupId === groupDto.groupId);\n\t\tif (!group) {\n\t\t\tthrow new Error('Update Group IPC call received before group creation.');\n\t\t}\n\t\tgroup.acceptGroupDtoUpdate(groupDto);\n\t\tif (groupDto.isActive) {\n\t\t\tthis._activeGroupId = groupDto.groupId;\n\t\t}\n\t\tthis._onDidChangeTabGroups.fire(Object.freeze({ changed: [group.apiObject], opened: [], closed: [] }));\n\t}\n\n\t$acceptTabOperation(operation: TabOperation) {\n\t\tconst group = this._extHostTabGroups.find(group => group.groupId === operation.groupId);\n\t\tif (!group) {\n\t\t\tthrow new Error('Update Tabs IPC call received before group creation.');\n\t\t}\n\t\tconst tab = group.acceptTabOperation(operation);\n\n\t\t// Construct the tab change event based on the operation\n\t\tswitch (operation.kind) {\n\t\t\tcase TabModelOperationKind.TAB_OPEN:\n\t\t\t\tthis._onDidChangeTabs.fire(Object.freeze({\n\t\t\t\t\topened: [tab.apiObject],\n\t\t\t\t\tclosed: [],\n\t\t\t\t\tchanged: []\n\t\t\t\t}));\n\t\t\t\treturn;\n\t\t\tcase TabModelOperationKind.TAB_CLOSE:\n\t\t\t\tthis._onDidChangeTabs.fire(Object.freeze({\n\t\t\t\t\topened: [],\n\t\t\t\t\tclosed: [tab.apiObject],\n\t\t\t\t\tchanged: []\n\t\t\t\t}));\n\t\t\t\treturn;\n\t\t\tcase TabModelOperationKind.TAB_MOVE:\n\t\t\tcase TabModelOperationKind.TAB_UPDATE:\n\t\t\t\tthis._onDidChangeTabs.fire(Object.freeze({\n\t\t\t\t\topened: [],\n\t\t\t\t\tclosed: [],\n\t\t\t\t\tchanged: [tab.apiObject]\n\t\t\t\t}));\n\t\t\t\treturn;\n\t\t}\n\t}\n\n\tprivate _findExtHostTabFromApi(apiTab: vscode.Tab): ExtHostEditorTab | undefined {\n\t\tfor (const group of this._extHostTabGroups) {\n\t\t\tfor (const tab of group.tabs) {\n\t\t\t\tif (tab.apiObject === apiTab) {\n\t\t\t\t\treturn tab;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn;\n\t}\n\n\tprivate _findExtHostTabGroupFromApi(apiTabGroup: vscode.TabGroup): ExtHostEditorTabGroup | undefined {\n\t\treturn this._extHostTabGroups.find(candidate => candidate.apiObject === apiTabGroup);\n\t}\n\n\tprivate async _closeTabs(tabs: vscode.Tab[], preserveFocus?: boolean): Promise<boolean> {\n\t\tconst extHostTabIds: string[] = [];\n\t\tfor (const tab of tabs) {\n\t\t\tconst extHostTab = this._findExtHostTabFromApi(tab);\n\t\t\tif (!extHostTab) {\n\t\t\t\tthrow new Error('Tab close: Invalid tab not found!');\n\t\t\t}\n\t\t\textHostTabIds.push(extHostTab.tabId);\n\t\t}\n\t\treturn this._proxy.$closeTab(extHostTabIds, preserveFocus);\n\t}\n\n\tprivate async _closeGroups(groups: vscode.TabGroup[], preserverFoucs?: boolean): Promise<boolean> {\n\t\tconst extHostGroupIds: number[] = [];\n\t\tfor (const group of groups) {\n\t\t\tconst extHostGroup = this._findExtHostTabGroupFromApi(group);\n\t\t\tif (!extHostGroup) {\n\t\t\t\tthrow new Error('Group close: Invalid group not found!');\n\t\t\t}\n\t\t\textHostGroupIds.push(extHostGroup.groupId);\n\t\t}\n\t\treturn this._proxy.$closeGroup(extHostGroupIds, preserverFoucs);\n\t}\n}\n\n//#region Utils\nfunction isTabGroup(obj: unknown): obj is vscode.TabGroup {\n\tconst tabGroup = obj as vscode.TabGroup;\n\tif (tabGroup.tabs !== undefined) {\n\t\treturn true;\n\t}\n\treturn false;\n}\n//#endregion\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { MainContext, IMainContext, ExtHostFileSystemShape, MainThreadFileSystemShape, IFileChangeDto } from './extHost.protocol';\nimport type * as vscode from 'vscode';\nimport * as files from 'vs/platform/files/common/files';\nimport { IDisposable, toDisposable } from 'vs/base/common/lifecycle';\nimport { FileChangeType } from 'vs/workbench/api/common/extHostTypes';\nimport * as typeConverter from 'vs/workbench/api/common/extHostTypeConverters';\nimport { ExtHostLanguageFeatures } from 'vs/workbench/api/common/extHostLanguageFeatures';\nimport { State, StateMachine, LinkComputer, Edge } from 'vs/editor/common/languages/linkComputer';\nimport { commonPrefixLength } from 'vs/base/common/strings';\nimport { CharCode } from 'vs/base/common/charCode';\nimport { VSBuffer } from 'vs/base/common/buffer';\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { checkProposedApiEnabled } from 'vs/workbench/services/extensions/common/extensions';\n\nclass FsLinkProvider {\n\n\tprivate _schemes: string[] = [];\n\tprivate _stateMachine?: StateMachine;\n\n\tadd(scheme: string): void {\n\t\tthis._stateMachine = undefined;\n\t\tthis._schemes.push(scheme);\n\t}\n\n\tdelete(scheme: string): void {\n\t\tconst idx = this._schemes.indexOf(scheme);\n\t\tif (idx >= 0) {\n\t\t\tthis._schemes.splice(idx, 1);\n\t\t\tthis._stateMachine = undefined;\n\t\t}\n\t}\n\n\tprivate _initStateMachine(): void {\n\t\tif (!this._stateMachine) {\n\n\t\t\t// sort and compute common prefix with previous scheme\n\t\t\t// then build state transitions based on the data\n\t\t\tconst schemes = this._schemes.sort();\n\t\t\tconst edges: Edge[] = [];\n\t\t\tlet prevScheme: string | undefined;\n\t\t\tlet prevState: State;\n\t\t\tlet lastState = State.LastKnownState;\n\t\t\tlet nextState = State.LastKnownState;\n\t\t\tfor (const scheme of schemes) {\n\n\t\t\t\t// skip the common prefix of the prev scheme\n\t\t\t\t// and continue with its last state\n\t\t\t\tlet pos = !prevScheme ? 0 : commonPrefixLength(prevScheme, scheme);\n\t\t\t\tif (pos === 0) {\n\t\t\t\t\tprevState = State.Start;\n\t\t\t\t} else {\n\t\t\t\t\tprevState = nextState;\n\t\t\t\t}\n\n\t\t\t\tfor (; pos < scheme.length; pos++) {\n\t\t\t\t\t// keep creating new (next) states until the\n\t\t\t\t\t// end (and the BeforeColon-state) is reached\n\t\t\t\t\tif (pos + 1 === scheme.length) {\n\t\t\t\t\t\t// Save the last state here, because we need to continue for the next scheme\n\t\t\t\t\t\tlastState = nextState;\n\t\t\t\t\t\tnextState = State.BeforeColon;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnextState += 1;\n\t\t\t\t\t}\n\t\t\t\t\tedges.push([prevState, scheme.toUpperCase().charCodeAt(pos), nextState]);\n\t\t\t\t\tedges.push([prevState, scheme.toLowerCase().charCodeAt(pos), nextState]);\n\t\t\t\t\tprevState = nextState;\n\t\t\t\t}\n\n\t\t\t\tprevScheme = scheme;\n\t\t\t\t// Restore the last state\n\t\t\t\tnextState = lastState;\n\t\t\t}\n\n\t\t\t// all link must match this pattern `<scheme>:/<more>`\n\t\t\tedges.push([State.BeforeColon, CharCode.Colon, State.AfterColon]);\n\t\t\tedges.push([State.AfterColon, CharCode.Slash, State.End]);\n\n\t\t\tthis._stateMachine = new StateMachine(edges);\n\t\t}\n\t}\n\n\tprovideDocumentLinks(document: vscode.TextDocument): vscode.ProviderResult<vscode.DocumentLink[]> {\n\t\tthis._initStateMachine();\n\n\t\tconst result: vscode.DocumentLink[] = [];\n\t\tconst links = LinkComputer.computeLinks({\n\t\t\tgetLineContent(lineNumber: number): string {\n\t\t\t\treturn document.lineAt(lineNumber - 1).text;\n\t\t\t},\n\t\t\tgetLineCount(): number {\n\t\t\t\treturn document.lineCount;\n\t\t\t}\n\t\t}, this._stateMachine);\n\n\t\tfor (const link of links) {\n\t\t\tconst docLink = typeConverter.DocumentLink.to(link);\n\t\t\tif (docLink.target) {\n\t\t\t\tresult.push(docLink);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n}\n\nexport class ExtHostFileSystem implements ExtHostFileSystemShape {\n\n\tprivate readonly _proxy: MainThreadFileSystemShape;\n\tprivate readonly _linkProvider = new FsLinkProvider();\n\tprivate readonly _fsProvider = new Map<number, vscode.FileSystemProvider>();\n\tprivate readonly _registeredSchemes = new Set<string>();\n\tprivate readonly _watches = new Map<number, IDisposable>();\n\n\tprivate _linkProviderRegistration?: IDisposable;\n\tprivate _handlePool: number = 0;\n\n\tconstructor(mainContext: IMainContext, private _extHostLanguageFeatures: ExtHostLanguageFeatures) {\n\t\tthis._proxy = mainContext.getProxy(MainContext.MainThreadFileSystem);\n\t}\n\n\tdispose(): void {\n\t\tthis._linkProviderRegistration?.dispose();\n\t}\n\n\n\tregisterFileSystemProvider(extension: IExtensionDescription, scheme: string, provider: vscode.FileSystemProvider, options: { isCaseSensitive?: boolean; isReadonly?: boolean } = {}) {\n\n\t\tif (this._registeredSchemes.has(scheme)) {\n\t\t\tthrow new Error(`a provider for the scheme '${scheme}' is already registered`);\n\t\t}\n\n\t\t//\n\t\tif (!this._linkProviderRegistration) {\n\t\t\tthis._linkProviderRegistration = this._extHostLanguageFeatures.registerDocumentLinkProvider(extension, '*', this._linkProvider);\n\t\t}\n\n\t\tconst handle = this._handlePool++;\n\t\tthis._linkProvider.add(scheme);\n\t\tthis._registeredSchemes.add(scheme);\n\t\tthis._fsProvider.set(handle, provider);\n\n\t\tlet capabilities = files.FileSystemProviderCapabilities.FileReadWrite;\n\t\tif (options.isCaseSensitive) {\n\t\t\tcapabilities += files.FileSystemProviderCapabilities.PathCaseSensitive;\n\t\t}\n\t\tif (options.isReadonly) {\n\t\t\tcapabilities += files.FileSystemProviderCapabilities.Readonly;\n\t\t}\n\t\tif (typeof provider.copy === 'function') {\n\t\t\tcapabilities += files.FileSystemProviderCapabilities.FileFolderCopy;\n\t\t}\n\t\tif (typeof provider.open === 'function' && typeof provider.close === 'function'\n\t\t\t&& typeof provider.read === 'function' && typeof provider.write === 'function'\n\t\t) {\n\t\t\tcheckProposedApiEnabled(extension, 'fsChunks');\n\t\t\tcapabilities += files.FileSystemProviderCapabilities.FileOpenReadWriteClose;\n\t\t}\n\n\t\tthis._proxy.$registerFileSystemProvider(handle, scheme, capabilities).catch(err => {\n\t\t\tconsole.error(`FAILED to register filesystem provider of ${extension.identifier.value}-extension for the scheme ${scheme}`);\n\t\t\tconsole.error(err);\n\t\t});\n\n\t\tconst subscription = provider.onDidChangeFile(event => {\n\t\t\tconst mapped: IFileChangeDto[] = [];\n\t\t\tfor (const e of event) {\n\t\t\t\tconst { uri: resource, type } = e;\n\t\t\t\tif (resource.scheme !== scheme) {\n\t\t\t\t\t// dropping events for wrong scheme\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tlet newType: files.FileChangeType | undefined;\n\t\t\t\tswitch (type) {\n\t\t\t\t\tcase FileChangeType.Changed:\n\t\t\t\t\t\tnewType = files.FileChangeType.UPDATED;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase FileChangeType.Created:\n\t\t\t\t\t\tnewType = files.FileChangeType.ADDED;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase FileChangeType.Deleted:\n\t\t\t\t\t\tnewType = files.FileChangeType.DELETED;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthrow new Error('Unknown FileChangeType');\n\t\t\t\t}\n\t\t\t\tmapped.push({ resource, type: newType });\n\t\t\t}\n\t\t\tthis._proxy.$onFileSystemChange(handle, mapped);\n\t\t});\n\n\t\treturn toDisposable(() => {\n\t\t\tsubscription.dispose();\n\t\t\tthis._linkProvider.delete(scheme);\n\t\t\tthis._registeredSchemes.delete(scheme);\n\t\t\tthis._fsProvider.delete(handle);\n\t\t\tthis._proxy.$unregisterProvider(handle);\n\t\t});\n\t}\n\n\tprivate static _asIStat(stat: vscode.FileStat): files.IStat {\n\t\tconst { type, ctime, mtime, size, permissions } = stat;\n\t\treturn { type, ctime, mtime, size, permissions };\n\t}\n\n\t$stat(handle: number, resource: UriComponents): Promise<files.IStat> {\n\t\treturn Promise.resolve(this._getFsProvider(handle).stat(URI.revive(resource))).then(stat => ExtHostFileSystem._asIStat(stat));\n\t}\n\n\t$readdir(handle: number, resource: UriComponents): Promise<[string, files.FileType][]> {\n\t\treturn Promise.resolve(this._getFsProvider(handle).readDirectory(URI.revive(resource)));\n\t}\n\n\t$readFile(handle: number, resource: UriComponents): Promise<VSBuffer> {\n\t\treturn Promise.resolve(this._getFsProvider(handle).readFile(URI.revive(resource))).then(data => VSBuffer.wrap(data));\n\t}\n\n\t$writeFile(handle: number, resource: UriComponents, content: VSBuffer, opts: files.IFileWriteOptions): Promise<void> {\n\t\treturn Promise.resolve(this._getFsProvider(handle).writeFile(URI.revive(resource), content.buffer, opts));\n\t}\n\n\t$delete(handle: number, resource: UriComponents, opts: files.IFileDeleteOptions): Promise<void> {\n\t\treturn Promise.resolve(this._getFsProvider(handle).delete(URI.revive(resource), opts));\n\t}\n\n\t$rename(handle: number, oldUri: UriComponents, newUri: UriComponents, opts: files.IFileOverwriteOptions): Promise<void> {\n\t\treturn Promise.resolve(this._getFsProvider(handle).rename(URI.revive(oldUri), URI.revive(newUri), opts));\n\t}\n\n\t$copy(handle: number, oldUri: UriComponents, newUri: UriComponents, opts: files.IFileOverwriteOptions): Promise<void> {\n\t\tconst provider = this._getFsProvider(handle);\n\t\tif (!provider.copy) {\n\t\t\tthrow new Error('FileSystemProvider does not implement \"copy\"');\n\t\t}\n\t\treturn Promise.resolve(provider.copy(URI.revive(oldUri), URI.revive(newUri), opts));\n\t}\n\n\t$mkdir(handle: number, resource: UriComponents): Promise<void> {\n\t\treturn Promise.resolve(this._getFsProvider(handle).createDirectory(URI.revive(resource)));\n\t}\n\n\t$watch(handle: number, session: number, resource: UriComponents, opts: files.IWatchOptions): void {\n\t\tconst subscription = this._getFsProvider(handle).watch(URI.revive(resource), opts);\n\t\tthis._watches.set(session, subscription);\n\t}\n\n\t$unwatch(_handle: number, session: number): void {\n\t\tconst subscription = this._watches.get(session);\n\t\tif (subscription) {\n\t\t\tsubscription.dispose();\n\t\t\tthis._watches.delete(session);\n\t\t}\n\t}\n\n\t$open(handle: number, resource: UriComponents, opts: files.IFileOpenOptions): Promise<number> {\n\t\tconst provider = this._getFsProvider(handle);\n\t\tif (!provider.open) {\n\t\t\tthrow new Error('FileSystemProvider does not implement \"open\"');\n\t\t}\n\t\treturn Promise.resolve(provider.open(URI.revive(resource), opts));\n\t}\n\n\t$close(handle: number, fd: number): Promise<void> {\n\t\tconst provider = this._getFsProvider(handle);\n\t\tif (!provider.close) {\n\t\t\tthrow new Error('FileSystemProvider does not implement \"close\"');\n\t\t}\n\t\treturn Promise.resolve(provider.close(fd));\n\t}\n\n\t$read(handle: number, fd: number, pos: number, length: number): Promise<VSBuffer> {\n\t\tconst provider = this._getFsProvider(handle);\n\t\tif (!provider.read) {\n\t\t\tthrow new Error('FileSystemProvider does not implement \"read\"');\n\t\t}\n\t\tconst data = VSBuffer.alloc(length);\n\t\treturn Promise.resolve(provider.read(fd, pos, data.buffer, 0, length)).then(read => {\n\t\t\treturn data.slice(0, read); // don't send zeros\n\t\t});\n\t}\n\n\t$write(handle: number, fd: number, pos: number, data: VSBuffer): Promise<number> {\n\t\tconst provider = this._getFsProvider(handle);\n\t\tif (!provider.write) {\n\t\t\tthrow new Error('FileSystemProvider does not implement \"write\"');\n\t\t}\n\t\treturn Promise.resolve(provider.write(fd, pos, data.buffer, 0, data.byteLength));\n\t}\n\n\tprivate _getFsProvider(handle: number): vscode.FileSystemProvider {\n\t\tconst provider = this._fsProvider.get(handle);\n\t\tif (!provider) {\n\t\t\tconst err = new Error();\n\t\t\terr.name = 'ENOPRO';\n\t\t\terr.message = `no provider`;\n\t\t\tthrow err;\n\t\t}\n\t\treturn provider;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { MainContext, MainThreadFileSystemShape } from './extHost.protocol';\nimport * as vscode from 'vscode';\nimport * as files from 'vs/platform/files/common/files';\nimport { FileSystemError } from 'vs/workbench/api/common/extHostTypes';\nimport { VSBuffer } from 'vs/base/common/buffer';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { IExtHostRpcService } from 'vs/workbench/api/common/extHostRpcService';\nimport { IExtHostFileSystemInfo } from 'vs/workbench/api/common/extHostFileSystemInfo';\nimport { IDisposable, toDisposable } from 'vs/base/common/lifecycle';\n\nexport class ExtHostConsumerFileSystem {\n\n\treadonly _serviceBrand: undefined;\n\n\treadonly value: vscode.FileSystem;\n\n\tprivate readonly _proxy: MainThreadFileSystemShape;\n\tprivate readonly _fileSystemProvider = new Map<string, vscode.FileSystemProvider>();\n\n\tconstructor(\n\t\t@IExtHostRpcService extHostRpc: IExtHostRpcService,\n\t\t@IExtHostFileSystemInfo fileSystemInfo: IExtHostFileSystemInfo,\n\t) {\n\t\tthis._proxy = extHostRpc.getProxy(MainContext.MainThreadFileSystem);\n\t\tconst that = this;\n\n\t\tthis.value = Object.freeze({\n\t\t\tasync stat(uri: vscode.Uri): Promise<vscode.FileStat> {\n\t\t\t\ttry {\n\t\t\t\t\tconst provider = that._fileSystemProvider.get(uri.scheme);\n\t\t\t\t\tif (!provider) {\n\t\t\t\t\t\treturn await that._proxy.$stat(uri);\n\t\t\t\t\t}\n\t\t\t\t\t// use shortcut\n\t\t\t\t\tawait that._proxy.$ensureActivation(uri.scheme);\n\t\t\t\t\tconst stat = await provider.stat(uri);\n\t\t\t\t\treturn <vscode.FileStat>{\n\t\t\t\t\t\ttype: stat.type,\n\t\t\t\t\t\tctime: stat.ctime,\n\t\t\t\t\t\tmtime: stat.mtime,\n\t\t\t\t\t\tsize: stat.size,\n\t\t\t\t\t\tpermissions: stat.permissions\n\t\t\t\t\t};\n\t\t\t\t} catch (err) {\n\t\t\t\t\tExtHostConsumerFileSystem._handleError(err);\n\t\t\t\t}\n\t\t\t},\n\t\t\tasync readDirectory(uri: vscode.Uri): Promise<[string, vscode.FileType][]> {\n\t\t\t\ttry {\n\t\t\t\t\tconst provider = that._fileSystemProvider.get(uri.scheme);\n\t\t\t\t\tif (provider) {\n\t\t\t\t\t\t// use shortcut\n\t\t\t\t\t\tawait that._proxy.$ensureActivation(uri.scheme);\n\t\t\t\t\t\treturn (await provider.readDirectory(uri)).slice(); // safe-copy\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn await that._proxy.$readdir(uri);\n\t\t\t\t\t}\n\t\t\t\t} catch (err) {\n\t\t\t\t\treturn ExtHostConsumerFileSystem._handleError(err);\n\t\t\t\t}\n\t\t\t},\n\t\t\tasync createDirectory(uri: vscode.Uri): Promise<void> {\n\t\t\t\ttry {\n\t\t\t\t\t// no shortcut: does mkdirp\n\t\t\t\t\treturn await that._proxy.$mkdir(uri);\n\t\t\t\t} catch (err) {\n\t\t\t\t\treturn ExtHostConsumerFileSystem._handleError(err);\n\t\t\t\t}\n\t\t\t},\n\t\t\tasync readFile(uri: vscode.Uri): Promise<Uint8Array> {\n\t\t\t\ttry {\n\t\t\t\t\tconst provider = that._fileSystemProvider.get(uri.scheme);\n\t\t\t\t\tif (provider) {\n\t\t\t\t\t\t// use shortcut\n\t\t\t\t\t\tawait that._proxy.$ensureActivation(uri.scheme);\n\t\t\t\t\t\treturn (await provider.readFile(uri)).slice(); // safe-copy\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst buff = await that._proxy.$readFile(uri);\n\t\t\t\t\t\treturn buff.buffer;\n\t\t\t\t\t}\n\t\t\t\t} catch (err) {\n\t\t\t\t\treturn ExtHostConsumerFileSystem._handleError(err);\n\t\t\t\t}\n\t\t\t},\n\t\t\tasync writeFile(uri: vscode.Uri, content: Uint8Array): Promise<void> {\n\t\t\t\ttry {\n\t\t\t\t\t// no shortcut: does mkdirp\n\t\t\t\t\treturn await that._proxy.$writeFile(uri, VSBuffer.wrap(content));\n\t\t\t\t} catch (err) {\n\t\t\t\t\treturn ExtHostConsumerFileSystem._handleError(err);\n\t\t\t\t}\n\t\t\t},\n\t\t\tasync delete(uri: vscode.Uri, options?: { recursive?: boolean; useTrash?: boolean }): Promise<void> {\n\t\t\t\ttry {\n\t\t\t\t\tconst provider = that._fileSystemProvider.get(uri.scheme);\n\t\t\t\t\tif (provider) {\n\t\t\t\t\t\t// use shortcut\n\t\t\t\t\t\tawait that._proxy.$ensureActivation(uri.scheme);\n\t\t\t\t\t\treturn await provider.delete(uri, { recursive: false, ...options });\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn await that._proxy.$delete(uri, { recursive: false, useTrash: false, ...options });\n\t\t\t\t\t}\n\t\t\t\t} catch (err) {\n\t\t\t\t\treturn ExtHostConsumerFileSystem._handleError(err);\n\t\t\t\t}\n\t\t\t},\n\t\t\tasync rename(oldUri: vscode.Uri, newUri: vscode.Uri, options?: { overwrite?: boolean }): Promise<void> {\n\t\t\t\ttry {\n\t\t\t\t\t// no shortcut: potentially involves different schemes, does mkdirp\n\t\t\t\t\treturn await that._proxy.$rename(oldUri, newUri, { ...{ overwrite: false }, ...options });\n\t\t\t\t} catch (err) {\n\t\t\t\t\treturn ExtHostConsumerFileSystem._handleError(err);\n\t\t\t\t}\n\t\t\t},\n\t\t\tasync copy(source: vscode.Uri, destination: vscode.Uri, options?: { overwrite?: boolean }): Promise<void> {\n\t\t\t\ttry {\n\t\t\t\t\t// no shortcut: potentially involves different schemes, does mkdirp\n\t\t\t\t\treturn await that._proxy.$copy(source, destination, { ...{ overwrite: false }, ...options });\n\t\t\t\t} catch (err) {\n\t\t\t\t\treturn ExtHostConsumerFileSystem._handleError(err);\n\t\t\t\t}\n\t\t\t},\n\t\t\tisWritableFileSystem(scheme: string): boolean | undefined {\n\t\t\t\tconst capabilities = fileSystemInfo.getCapabilities(scheme);\n\t\t\t\tif (typeof capabilities === 'number') {\n\t\t\t\t\treturn !(capabilities & files.FileSystemProviderCapabilities.Readonly);\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate static _handleError(err: any): never {\n\t\t// desired error type\n\t\tif (err instanceof FileSystemError) {\n\t\t\tthrow err;\n\t\t}\n\n\t\t// generic error\n\t\tif (!(err instanceof Error)) {\n\t\t\tthrow new FileSystemError(String(err));\n\t\t}\n\n\t\t// no provider (unknown scheme) error\n\t\tif (err.name === 'ENOPRO') {\n\t\t\tthrow FileSystemError.Unavailable(err.message);\n\t\t}\n\n\t\t// file system error\n\t\tswitch (err.name) {\n\t\t\tcase files.FileSystemProviderErrorCode.FileExists: throw FileSystemError.FileExists(err.message);\n\t\t\tcase files.FileSystemProviderErrorCode.FileNotFound: throw FileSystemError.FileNotFound(err.message);\n\t\t\tcase files.FileSystemProviderErrorCode.FileNotADirectory: throw FileSystemError.FileNotADirectory(err.message);\n\t\t\tcase files.FileSystemProviderErrorCode.FileIsADirectory: throw FileSystemError.FileIsADirectory(err.message);\n\t\t\tcase files.FileSystemProviderErrorCode.NoPermissions: throw FileSystemError.NoPermissions(err.message);\n\t\t\tcase files.FileSystemProviderErrorCode.Unavailable: throw FileSystemError.Unavailable(err.message);\n\n\t\t\tdefault: throw new FileSystemError(err.message, err.name as files.FileSystemProviderErrorCode);\n\t\t}\n\t}\n\n\t// ---\n\n\taddFileSystemProvider(scheme: string, provider: vscode.FileSystemProvider): IDisposable {\n\t\tthis._fileSystemProvider.set(scheme, provider);\n\t\treturn toDisposable(() => this._fileSystemProvider.delete(scheme));\n\t}\n}\n\nexport interface IExtHostConsumerFileSystem extends ExtHostConsumerFileSystem { }\nexport const IExtHostConsumerFileSystem = createDecorator<IExtHostConsumerFileSystem>('IExtHostConsumerFileSystem');\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter, Event, AsyncEmitter, IWaitUntil, IWaitUntilData } from 'vs/base/common/event';\nimport { GLOBSTAR, GLOB_SPLIT, parse } from 'vs/base/common/glob';\nimport { URI } from 'vs/base/common/uri';\nimport { ExtHostDocumentsAndEditors } from 'vs/workbench/api/common/extHostDocumentsAndEditors';\nimport type * as vscode from 'vscode';\nimport { ExtHostFileSystemEventServiceShape, FileSystemEvents, IMainContext, SourceTargetPair, IWorkspaceEditDto, IWillRunFileOperationParticipation, MainContext, IRelativePatternDto } from './extHost.protocol';\nimport * as typeConverter from './extHostTypeConverters';\nimport { Disposable, WorkspaceEdit } from './extHostTypes';\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { FileOperation } from 'vs/platform/files/common/files';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { IExtHostWorkspace } from 'vs/workbench/api/common/extHostWorkspace';\nimport { isProposedApiEnabled } from 'vs/workbench/services/extensions/common/extensions';\n\nclass FileSystemWatcher implements vscode.FileSystemWatcher {\n\n\tprivate readonly _onDidCreate = new Emitter<vscode.Uri>();\n\tprivate readonly _onDidChange = new Emitter<vscode.Uri>();\n\tprivate readonly _onDidDelete = new Emitter<vscode.Uri>();\n\n\tprivate _disposable: Disposable;\n\tprivate _config: number;\n\n\tget ignoreCreateEvents(): boolean {\n\t\treturn Boolean(this._config & 0b001);\n\t}\n\n\tget ignoreChangeEvents(): boolean {\n\t\treturn Boolean(this._config & 0b010);\n\t}\n\n\tget ignoreDeleteEvents(): boolean {\n\t\treturn Boolean(this._config & 0b100);\n\t}\n\n\tconstructor(mainContext: IMainContext, workspace: IExtHostWorkspace, extension: IExtensionDescription, dispatcher: Event<FileSystemEvents>, globPattern: string | IRelativePatternDto, ignoreCreateEvents?: boolean, ignoreChangeEvents?: boolean, ignoreDeleteEvents?: boolean) {\n\t\tconst watcherDisposable = this.ensureWatching(mainContext, extension, globPattern);\n\n\t\tthis._config = 0;\n\t\tif (ignoreCreateEvents) {\n\t\t\tthis._config += 0b001;\n\t\t}\n\t\tif (ignoreChangeEvents) {\n\t\t\tthis._config += 0b010;\n\t\t}\n\t\tif (ignoreDeleteEvents) {\n\t\t\tthis._config += 0b100;\n\t\t}\n\n\t\tconst parsedPattern = parse(globPattern);\n\n\t\t// 1.64.x behaviour change: given the new support to watch any folder\n\t\t// we start to ignore events outside the workspace when only a string\n\t\t// pattern is provided to avoid sending events to extensions that are\n\t\t// unexpected.\n\t\t// https://github.com/microsoft/vscode/issues/3025\n\t\tconst excludeOutOfWorkspaceEvents = typeof globPattern === 'string';\n\n\t\tconst subscription = dispatcher(events => {\n\t\t\tif (!ignoreCreateEvents) {\n\t\t\t\tfor (const created of events.created) {\n\t\t\t\t\tconst uri = URI.revive(created);\n\t\t\t\t\tif (parsedPattern(uri.fsPath) && (!excludeOutOfWorkspaceEvents || workspace.getWorkspaceFolder(uri))) {\n\t\t\t\t\t\tthis._onDidCreate.fire(uri);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!ignoreChangeEvents) {\n\t\t\t\tfor (const changed of events.changed) {\n\t\t\t\t\tconst uri = URI.revive(changed);\n\t\t\t\t\tif (parsedPattern(uri.fsPath) && (!excludeOutOfWorkspaceEvents || workspace.getWorkspaceFolder(uri))) {\n\t\t\t\t\t\tthis._onDidChange.fire(uri);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!ignoreDeleteEvents) {\n\t\t\t\tfor (const deleted of events.deleted) {\n\t\t\t\t\tconst uri = URI.revive(deleted);\n\t\t\t\t\tif (parsedPattern(uri.fsPath) && (!excludeOutOfWorkspaceEvents || workspace.getWorkspaceFolder(uri))) {\n\t\t\t\t\t\tthis._onDidDelete.fire(uri);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis._disposable = Disposable.from(watcherDisposable, this._onDidCreate, this._onDidChange, this._onDidDelete, subscription);\n\t}\n\n\tprivate ensureWatching(mainContext: IMainContext, extension: IExtensionDescription, globPattern: string | IRelativePatternDto): Disposable {\n\t\tconst disposable = Disposable.from();\n\n\t\tif (typeof globPattern === 'string') {\n\t\t\treturn disposable; // a pattern alone does not carry sufficient information to start watching anything\n\t\t}\n\n\t\tconst proxy = mainContext.getProxy(MainContext.MainThreadFileSystem);\n\n\t\tlet recursive = false;\n\t\tif (globPattern.pattern.includes(GLOBSTAR) || globPattern.pattern.includes(GLOB_SPLIT)) {\n\t\t\trecursive = true; // only watch recursively if pattern indicates the need for it\n\t\t}\n\n\t\tconst session = Math.random();\n\t\tproxy.$watch(extension.identifier.value, session, globPattern.baseUri, { recursive, excludes: [] /* excludes are not yet surfaced in the API */ });\n\n\t\treturn Disposable.from({ dispose: () => proxy.$unwatch(session) });\n\t}\n\n\tdispose() {\n\t\tthis._disposable.dispose();\n\t}\n\n\tget onDidCreate(): Event<vscode.Uri> {\n\t\treturn this._onDidCreate.event;\n\t}\n\n\tget onDidChange(): Event<vscode.Uri> {\n\t\treturn this._onDidChange.event;\n\t}\n\n\tget onDidDelete(): Event<vscode.Uri> {\n\t\treturn this._onDidDelete.event;\n\t}\n}\n\ninterface IExtensionListener<E> {\n\textension: IExtensionDescription;\n\t(e: E): any;\n}\n\nexport class ExtHostFileSystemEventService implements ExtHostFileSystemEventServiceShape {\n\n\tprivate readonly _onFileSystemEvent = new Emitter<FileSystemEvents>();\n\n\tprivate readonly _onDidRenameFile = new Emitter<vscode.FileRenameEvent>();\n\tprivate readonly _onDidCreateFile = new Emitter<vscode.FileCreateEvent>();\n\tprivate readonly _onDidDeleteFile = new Emitter<vscode.FileDeleteEvent>();\n\tprivate readonly _onWillRenameFile = new AsyncEmitter<vscode.FileWillRenameEvent>();\n\tprivate readonly _onWillCreateFile = new AsyncEmitter<vscode.FileWillCreateEvent>();\n\tprivate readonly _onWillDeleteFile = new AsyncEmitter<vscode.FileWillDeleteEvent>();\n\n\treadonly onDidRenameFile: Event<vscode.FileRenameEvent> = this._onDidRenameFile.event;\n\treadonly onDidCreateFile: Event<vscode.FileCreateEvent> = this._onDidCreateFile.event;\n\treadonly onDidDeleteFile: Event<vscode.FileDeleteEvent> = this._onDidDeleteFile.event;\n\n\tconstructor(\n\t\tprivate readonly _mainContext: IMainContext,\n\t\tprivate readonly _logService: ILogService,\n\t\tprivate readonly _extHostDocumentsAndEditors: ExtHostDocumentsAndEditors\n\t) {\n\t\t//\n\t}\n\n\t//--- file events\n\n\tcreateFileSystemWatcher(workspace: IExtHostWorkspace, extension: IExtensionDescription, globPattern: vscode.GlobPattern, ignoreCreateEvents?: boolean, ignoreChangeEvents?: boolean, ignoreDeleteEvents?: boolean): vscode.FileSystemWatcher {\n\t\treturn new FileSystemWatcher(this._mainContext, workspace, extension, this._onFileSystemEvent.event, typeConverter.GlobPattern.from(globPattern), ignoreCreateEvents, ignoreChangeEvents, ignoreDeleteEvents);\n\t}\n\n\t$onFileEvent(events: FileSystemEvents) {\n\t\tthis._onFileSystemEvent.fire(events);\n\t}\n\n\n\t//--- file operations\n\n\t$onDidRunFileOperation(operation: FileOperation, files: SourceTargetPair[]): void {\n\t\tswitch (operation) {\n\t\t\tcase FileOperation.MOVE:\n\t\t\t\tthis._onDidRenameFile.fire(Object.freeze({ files: files.map(f => ({ oldUri: URI.revive(f.source!), newUri: URI.revive(f.target) })) }));\n\t\t\t\tbreak;\n\t\t\tcase FileOperation.DELETE:\n\t\t\t\tthis._onDidDeleteFile.fire(Object.freeze({ files: files.map(f => URI.revive(f.target)) }));\n\t\t\t\tbreak;\n\t\t\tcase FileOperation.CREATE:\n\t\t\tcase FileOperation.COPY:\n\t\t\t\tthis._onDidCreateFile.fire(Object.freeze({ files: files.map(f => URI.revive(f.target)) }));\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t//ignore, dont send\n\t\t}\n\t}\n\n\n\tgetOnWillRenameFileEvent(extension: IExtensionDescription): Event<vscode.FileWillRenameEvent> {\n\t\treturn this._createWillExecuteEvent(extension, this._onWillRenameFile);\n\t}\n\n\tgetOnWillCreateFileEvent(extension: IExtensionDescription): Event<vscode.FileWillCreateEvent> {\n\t\treturn this._createWillExecuteEvent(extension, this._onWillCreateFile);\n\t}\n\n\tgetOnWillDeleteFileEvent(extension: IExtensionDescription): Event<vscode.FileWillDeleteEvent> {\n\t\treturn this._createWillExecuteEvent(extension, this._onWillDeleteFile);\n\t}\n\n\tprivate _createWillExecuteEvent<E extends IWaitUntil>(extension: IExtensionDescription, emitter: AsyncEmitter<E>): Event<E> {\n\t\treturn (listener, thisArg, disposables) => {\n\t\t\tconst wrappedListener: IExtensionListener<E> = function wrapped(e: E) { listener.call(thisArg, e); };\n\t\t\twrappedListener.extension = extension;\n\t\t\treturn emitter.event(wrappedListener, undefined, disposables);\n\t\t};\n\t}\n\n\tasync $onWillRunFileOperation(operation: FileOperation, files: SourceTargetPair[], timeout: number, token: CancellationToken): Promise<IWillRunFileOperationParticipation | undefined> {\n\t\tswitch (operation) {\n\t\t\tcase FileOperation.MOVE:\n\t\t\t\treturn await this._fireWillEvent(this._onWillRenameFile, { files: files.map(f => ({ oldUri: URI.revive(f.source!), newUri: URI.revive(f.target) })) }, timeout, token);\n\t\t\tcase FileOperation.DELETE:\n\t\t\t\treturn await this._fireWillEvent(this._onWillDeleteFile, { files: files.map(f => URI.revive(f.target)) }, timeout, token);\n\t\t\tcase FileOperation.CREATE:\n\t\t\tcase FileOperation.COPY:\n\t\t\t\treturn await this._fireWillEvent(this._onWillCreateFile, { files: files.map(f => URI.revive(f.target)) }, timeout, token);\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprivate async _fireWillEvent<E extends IWaitUntil>(emitter: AsyncEmitter<E>, data: IWaitUntilData<E>, timeout: number, token: CancellationToken): Promise<IWillRunFileOperationParticipation | undefined> {\n\n\t\tconst extensionNames = new Set<string>();\n\t\tconst edits: [IExtensionDescription, WorkspaceEdit][] = [];\n\n\t\tawait emitter.fireAsync(data, token, async (thenable: Promise<unknown>, listener) => {\n\t\t\t// ignore all results except for WorkspaceEdits. Those are stored in an array.\n\t\t\tconst now = Date.now();\n\t\t\tconst result = await Promise.resolve(thenable);\n\t\t\tif (result instanceof WorkspaceEdit) {\n\t\t\t\tedits.push([(<IExtensionListener<E>>listener).extension, result]);\n\t\t\t\textensionNames.add((<IExtensionListener<E>>listener).extension.displayName ?? (<IExtensionListener<E>>listener).extension.identifier.value);\n\t\t\t}\n\n\t\t\tif (Date.now() - now > timeout) {\n\t\t\t\tthis._logService.warn('SLOW file-participant', (<IExtensionListener<E>>listener).extension.identifier);\n\t\t\t}\n\t\t});\n\n\t\tif (token.isCancellationRequested) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (edits.length === 0) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// concat all WorkspaceEdits collected via waitUntil-call and send them over to the renderer\n\t\tconst dto: IWorkspaceEditDto = { edits: [] };\n\t\tfor (const [extension, edit] of edits) {\n\t\t\tconst { edits } = typeConverter.WorkspaceEdit.from(edit, {\n\t\t\t\tgetTextDocumentVersion: uri => this._extHostDocumentsAndEditors.getDocument(uri)?.version,\n\t\t\t\tgetNotebookDocumentVersion: () => undefined,\n\t\t\t}, isProposedApiEnabled(extension, 'snippetWorkspaceEdit'));\n\t\t\tdto.edits = dto.edits.concat(edits);\n\t\t}\n\t\treturn { edit: dto, extensionNames: Array.from(extensionNames) };\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { ExtHostInteractiveShape, IMainContext } from 'vs/workbench/api/common/extHost.protocol';\nimport { ApiCommand, ApiCommandArgument, ApiCommandResult, ExtHostCommands } from 'vs/workbench/api/common/extHostCommands';\nimport { ExtHostDocumentsAndEditors } from 'vs/workbench/api/common/extHostDocumentsAndEditors';\nimport { ExtHostNotebookController } from 'vs/workbench/api/common/extHostNotebook';\nimport { NotebookEditor } from 'vscode';\n\nexport class ExtHostInteractive implements ExtHostInteractiveShape {\n\tconstructor(\n\t\tmainContext: IMainContext,\n\t\tprivate _extHostNotebooks: ExtHostNotebookController,\n\t\tprivate _textDocumentsAndEditors: ExtHostDocumentsAndEditors,\n\t\tprivate _commands: ExtHostCommands,\n\t\t_logService: ILogService\n\t) {\n\t\tconst openApiCommand = new ApiCommand(\n\t\t\t'interactive.open',\n\t\t\t'_interactive.open',\n\t\t\t'Open interactive window and return notebook editor and input URI',\n\t\t\t[\n\t\t\t\tnew ApiCommandArgument('showOptions', 'Show Options', v => true, v => v),\n\t\t\t\tnew ApiCommandArgument('resource', 'Interactive resource Uri', v => true, v => v),\n\t\t\t\tnew ApiCommandArgument('controllerId', 'Notebook controller Id', v => true, v => v),\n\t\t\t\tnew ApiCommandArgument('title', 'Interactive editor title', v => true, v => v)\n\t\t\t],\n\t\t\tnew ApiCommandResult<{ notebookUri: UriComponents; inputUri: UriComponents; notebookEditorId?: string }, { notebookUri: URI; inputUri: URI; notebookEditor?: NotebookEditor }>('Notebook and input URI', (v: { notebookUri: UriComponents; inputUri: UriComponents; notebookEditorId?: string }) => {\n\t\t\t\t_logService.debug('[ExtHostInteractive] open iw with notebook editor id', v.notebookEditorId);\n\t\t\t\tif (v.notebookEditorId !== undefined) {\n\t\t\t\t\tconst editor = this._extHostNotebooks.getEditorById(v.notebookEditorId);\n\t\t\t\t\t_logService.debug('[ExtHostInteractive] notebook editor found', editor.id);\n\t\t\t\t\treturn { notebookUri: URI.revive(v.notebookUri), inputUri: URI.revive(v.inputUri), notebookEditor: editor.apiEditor };\n\t\t\t\t}\n\t\t\t\t_logService.debug('[ExtHostInteractive] notebook editor not found, uris for the interactive document', v.notebookUri, v.inputUri);\n\t\t\t\treturn { notebookUri: URI.revive(v.notebookUri), inputUri: URI.revive(v.inputUri) };\n\t\t\t})\n\t\t);\n\t\tthis._commands.registerApiCommand(openApiCommand);\n\t}\n\n\t$willAddInteractiveDocument(uri: UriComponents, eol: string, languageId: string, notebookUri: UriComponents) {\n\t\tthis._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({\n\t\t\taddedDocuments: [{\n\t\t\t\tEOL: eol,\n\t\t\t\tlines: [''],\n\t\t\t\tlanguageId: languageId,\n\t\t\t\turi: uri,\n\t\t\t\tisDirty: false,\n\t\t\t\tversionId: 1,\n\t\t\t\tnotebook: this._extHostNotebooks.getNotebookDocument(URI.revive(notebookUri))?.apiNotebook\n\t\t\t}]\n\t\t});\n\t}\n\n\t$willRemoveInteractiveDocument(uri: UriComponents, notebookUri: UriComponents) {\n\t\tthis._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({\n\t\t\tremovedDocuments: [uri]\n\t\t});\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ResourceLabelFormatter } from 'vs/platform/label/common/label';\nimport { IDisposable, toDisposable } from 'vs/base/common/lifecycle';\nimport { MainThreadLabelServiceShape, ExtHostLabelServiceShape, MainContext, IMainContext } from 'vs/workbench/api/common/extHost.protocol';\n\nexport class ExtHostLabelService implements ExtHostLabelServiceShape {\n\n\tprivate readonly _proxy: MainThreadLabelServiceShape;\n\tprivate _handlePool: number = 0;\n\n\tconstructor(mainContext: IMainContext) {\n\t\tthis._proxy = mainContext.getProxy(MainContext.MainThreadLabelService);\n\t}\n\n\t$registerResourceLabelFormatter(formatter: ResourceLabelFormatter): IDisposable {\n\t\tconst handle = this._handlePool++;\n\t\tthis._proxy.$registerResourceLabelFormatter(handle, formatter);\n\n\t\treturn toDisposable(() => {\n\t\t\tthis._proxy.$unregisterResourceLabelFormatter(handle);\n\t\t});\n\t}\n}","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { mixin } from 'vs/base/common/objects';\nimport type * as vscode from 'vscode';\nimport * as typeConvert from 'vs/workbench/api/common/extHostTypeConverters';\nimport { Range, Disposable, CompletionList, SnippetString, CodeActionKind, SymbolInformation, DocumentSymbol, SemanticTokensEdits, SemanticTokens, SemanticTokensEdit, Location, InlineCompletionTriggerKindNew, InlineCompletionTriggerKind } from 'vs/workbench/api/common/extHostTypes';\nimport { ISingleEditOperation } from 'vs/editor/common/core/editOperation';\nimport * as languages from 'vs/editor/common/languages';\nimport { ExtHostDocuments } from 'vs/workbench/api/common/extHostDocuments';\nimport { ExtHostCommands, CommandsConverter } from 'vs/workbench/api/common/extHostCommands';\nimport { ExtHostDiagnostics } from 'vs/workbench/api/common/extHostDiagnostics';\nimport * as extHostProtocol from './extHost.protocol';\nimport { regExpLeadsToEndlessLoop, regExpFlags } from 'vs/base/common/strings';\nimport { IPosition } from 'vs/editor/common/core/position';\nimport { IRange, Range as EditorRange } from 'vs/editor/common/core/range';\nimport { isFalsyOrEmpty, isNonEmptyArray, coalesce } from 'vs/base/common/arrays';\nimport { isArray, isObject } from 'vs/base/common/types';\nimport { ISelection, Selection } from 'vs/editor/common/core/selection';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { ExtensionIdentifier, IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { IURITransformer } from 'vs/base/common/uriIpc';\nimport { DisposableStore } from 'vs/base/common/lifecycle';\nimport { VSBuffer } from 'vs/base/common/buffer';\nimport { encodeSemanticTokensDto } from 'vs/editor/common/services/semanticTokensDto';\nimport { IdGenerator } from 'vs/base/common/idGenerator';\nimport { IExtHostApiDeprecationService } from 'vs/workbench/api/common/extHostApiDeprecationService';\nimport { Cache } from './cache';\nimport { StopWatch } from 'vs/base/common/stopwatch';\nimport { isCancellationError, NotImplementedError } from 'vs/base/common/errors';\nimport { raceCancellationError } from 'vs/base/common/async';\nimport { isProposedApiEnabled } from 'vs/workbench/services/extensions/common/extensions';\n\n// --- adapter\n\nclass DocumentSymbolAdapter {\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.DocumentSymbolProvider\n\t) { }\n\n\tasync provideDocumentSymbols(resource: URI, token: CancellationToken): Promise<languages.DocumentSymbol[] | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst value = await this._provider.provideDocumentSymbols(doc, token);\n\t\tif (isFalsyOrEmpty(value)) {\n\t\t\treturn undefined;\n\t\t} else if (value![0] instanceof DocumentSymbol) {\n\t\t\treturn (<DocumentSymbol[]>value).map(typeConvert.DocumentSymbol.from);\n\t\t} else {\n\t\t\treturn DocumentSymbolAdapter._asDocumentSymbolTree(<SymbolInformation[]>value);\n\t\t}\n\t}\n\n\tprivate static _asDocumentSymbolTree(infos: SymbolInformation[]): languages.DocumentSymbol[] {\n\t\t// first sort by start (and end) and then loop over all elements\n\t\t// and build a tree based on containment.\n\t\tinfos = infos.slice(0).sort((a, b) => {\n\t\t\tlet res = a.location.range.start.compareTo(b.location.range.start);\n\t\t\tif (res === 0) {\n\t\t\t\tres = b.location.range.end.compareTo(a.location.range.end);\n\t\t\t}\n\t\t\treturn res;\n\t\t});\n\t\tconst res: languages.DocumentSymbol[] = [];\n\t\tconst parentStack: languages.DocumentSymbol[] = [];\n\t\tfor (const info of infos) {\n\t\t\tconst element: languages.DocumentSymbol = {\n\t\t\t\tname: info.name || '!!MISSING: name!!',\n\t\t\t\tkind: typeConvert.SymbolKind.from(info.kind),\n\t\t\t\ttags: info.tags?.map(typeConvert.SymbolTag.from) || [],\n\t\t\t\tdetail: '',\n\t\t\t\tcontainerName: info.containerName,\n\t\t\t\trange: typeConvert.Range.from(info.location.range),\n\t\t\t\tselectionRange: typeConvert.Range.from(info.location.range),\n\t\t\t\tchildren: []\n\t\t\t};\n\n\t\t\twhile (true) {\n\t\t\t\tif (parentStack.length === 0) {\n\t\t\t\t\tparentStack.push(element);\n\t\t\t\t\tres.push(element);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tconst parent = parentStack[parentStack.length - 1];\n\t\t\t\tif (EditorRange.containsRange(parent.range, element.range) && !EditorRange.equalsRange(parent.range, element.range)) {\n\t\t\t\t\tparent.children?.push(element);\n\t\t\t\t\tparentStack.push(element);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tparentStack.pop();\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t}\n}\n\nclass CodeLensAdapter {\n\n\tprivate static _badCmd: vscode.Command = { command: 'missing', title: '!!MISSING: command!!' };\n\n\tprivate readonly _cache = new Cache<vscode.CodeLens>('CodeLens');\n\tprivate readonly _disposables = new Map<number, DisposableStore>();\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _commands: CommandsConverter,\n\t\tprivate readonly _provider: vscode.CodeLensProvider\n\t) { }\n\n\tasync provideCodeLenses(resource: URI, token: CancellationToken): Promise<extHostProtocol.ICodeLensListDto | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\n\t\tconst lenses = await this._provider.provideCodeLenses(doc, token);\n\t\tif (!lenses || token.isCancellationRequested) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst cacheId = this._cache.add(lenses);\n\t\tconst disposables = new DisposableStore();\n\t\tthis._disposables.set(cacheId, disposables);\n\t\tconst result: extHostProtocol.ICodeLensListDto = {\n\t\t\tcacheId,\n\t\t\tlenses: [],\n\t\t};\n\t\tfor (let i = 0; i < lenses.length; i++) {\n\t\t\tresult.lenses.push({\n\t\t\t\tcacheId: [cacheId, i],\n\t\t\t\trange: typeConvert.Range.from(lenses[i].range),\n\t\t\t\tcommand: this._commands.toInternal(lenses[i].command, disposables)\n\t\t\t});\n\t\t}\n\t\treturn result;\n\t}\n\n\tasync resolveCodeLens(symbol: extHostProtocol.ICodeLensDto, token: CancellationToken): Promise<extHostProtocol.ICodeLensDto | undefined> {\n\n\t\tconst lens = symbol.cacheId && this._cache.get(...symbol.cacheId);\n\t\tif (!lens) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tlet resolvedLens: vscode.CodeLens | undefined | null;\n\t\tif (typeof this._provider.resolveCodeLens !== 'function' || lens.isResolved) {\n\t\t\tresolvedLens = lens;\n\t\t} else {\n\t\t\tresolvedLens = await this._provider.resolveCodeLens(lens, token);\n\t\t}\n\t\tif (!resolvedLens) {\n\t\t\tresolvedLens = lens;\n\t\t}\n\n\t\tif (token.isCancellationRequested) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst disposables = symbol.cacheId && this._disposables.get(symbol.cacheId[0]);\n\t\tif (!disposables) {\n\t\t\t// disposed in the meantime\n\t\t\treturn undefined;\n\t\t}\n\t\tsymbol.command = this._commands.toInternal(resolvedLens.command ?? CodeLensAdapter._badCmd, disposables);\n\t\treturn symbol;\n\t}\n\n\treleaseCodeLenses(cachedId: number): void {\n\t\tthis._disposables.get(cachedId)?.dispose();\n\t\tthis._disposables.delete(cachedId);\n\t\tthis._cache.delete(cachedId);\n\t}\n}\n\nfunction convertToLocationLinks(value: vscode.Location | vscode.Location[] | vscode.LocationLink[] | undefined | null): languages.LocationLink[] {\n\tif (Array.isArray(value)) {\n\t\treturn (<any>value).map(typeConvert.DefinitionLink.from);\n\t} else if (value) {\n\t\treturn [typeConvert.DefinitionLink.from(value)];\n\t}\n\treturn [];\n}\n\nclass DefinitionAdapter {\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.DefinitionProvider\n\t) { }\n\n\tasync provideDefinition(resource: URI, position: IPosition, token: CancellationToken): Promise<languages.LocationLink[]> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\t\tconst value = await this._provider.provideDefinition(doc, pos, token);\n\t\treturn convertToLocationLinks(value);\n\t}\n}\n\nclass DeclarationAdapter {\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.DeclarationProvider\n\t) { }\n\n\tasync provideDeclaration(resource: URI, position: IPosition, token: CancellationToken): Promise<languages.LocationLink[]> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\t\tconst value = await this._provider.provideDeclaration(doc, pos, token);\n\t\treturn convertToLocationLinks(value);\n\t}\n}\n\nclass ImplementationAdapter {\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.ImplementationProvider\n\t) { }\n\n\tasync provideImplementation(resource: URI, position: IPosition, token: CancellationToken): Promise<languages.LocationLink[]> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\t\tconst value = await this._provider.provideImplementation(doc, pos, token);\n\t\treturn convertToLocationLinks(value);\n\t}\n}\n\nclass TypeDefinitionAdapter {\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.TypeDefinitionProvider\n\t) { }\n\n\tasync provideTypeDefinition(resource: URI, position: IPosition, token: CancellationToken): Promise<languages.LocationLink[]> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\t\tconst value = await this._provider.provideTypeDefinition(doc, pos, token);\n\t\treturn convertToLocationLinks(value);\n\t}\n}\n\nclass HoverAdapter {\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.HoverProvider,\n\t) { }\n\n\tasync provideHover(resource: URI, position: IPosition, token: CancellationToken): Promise<languages.Hover | undefined> {\n\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\tconst value = await this._provider.provideHover(doc, pos, token);\n\t\tif (!value || isFalsyOrEmpty(value.contents)) {\n\t\t\treturn undefined;\n\t\t}\n\t\tif (!value.range) {\n\t\t\tvalue.range = doc.getWordRangeAtPosition(pos);\n\t\t}\n\t\tif (!value.range) {\n\t\t\tvalue.range = new Range(pos, pos);\n\t\t}\n\t\treturn typeConvert.Hover.from(value);\n\t}\n}\n\nclass EvaluatableExpressionAdapter {\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.EvaluatableExpressionProvider,\n\t) { }\n\n\tasync provideEvaluatableExpression(resource: URI, position: IPosition, token: CancellationToken): Promise<languages.EvaluatableExpression | undefined> {\n\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\tconst value = await this._provider.provideEvaluatableExpression(doc, pos, token);\n\t\tif (value) {\n\t\t\treturn typeConvert.EvaluatableExpression.from(value);\n\t\t}\n\t\treturn undefined;\n\t}\n}\n\nclass InlineValuesAdapter {\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.InlineValuesProvider,\n\t) { }\n\n\tasync provideInlineValues(resource: URI, viewPort: IRange, context: extHostProtocol.IInlineValueContextDto, token: CancellationToken): Promise<languages.InlineValue[] | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst value = await this._provider.provideInlineValues(doc, typeConvert.Range.to(viewPort), typeConvert.InlineValueContext.to(context), token);\n\t\tif (Array.isArray(value)) {\n\t\t\treturn value.map(iv => typeConvert.InlineValue.from(iv));\n\t\t}\n\t\treturn undefined;\n\t}\n}\n\nclass DocumentHighlightAdapter {\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.DocumentHighlightProvider\n\t) { }\n\n\tasync provideDocumentHighlights(resource: URI, position: IPosition, token: CancellationToken): Promise<languages.DocumentHighlight[] | undefined> {\n\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\tconst value = await this._provider.provideDocumentHighlights(doc, pos, token);\n\t\tif (Array.isArray(value)) {\n\t\t\treturn value.map(typeConvert.DocumentHighlight.from);\n\t\t}\n\t\treturn undefined;\n\t}\n}\n\nclass LinkedEditingRangeAdapter {\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.LinkedEditingRangeProvider\n\t) { }\n\n\tasync provideLinkedEditingRanges(resource: URI, position: IPosition, token: CancellationToken): Promise<languages.LinkedEditingRanges | undefined> {\n\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\tconst value = await this._provider.provideLinkedEditingRanges(doc, pos, token);\n\t\tif (value && Array.isArray(value.ranges)) {\n\t\t\treturn {\n\t\t\t\tranges: coalesce(value.ranges.map(typeConvert.Range.from)),\n\t\t\t\twordPattern: value.wordPattern\n\t\t\t};\n\t\t}\n\t\treturn undefined;\n\t}\n}\n\nclass ReferenceAdapter {\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.ReferenceProvider\n\t) { }\n\n\tasync provideReferences(resource: URI, position: IPosition, context: languages.ReferenceContext, token: CancellationToken): Promise<languages.Location[] | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\tconst value = await this._provider.provideReferences(doc, pos, context, token);\n\t\tif (Array.isArray(value)) {\n\t\t\treturn value.map(typeConvert.location.from);\n\t\t}\n\t\treturn undefined;\n\t}\n}\n\nexport interface CustomCodeAction extends extHostProtocol.ICodeActionDto {\n\t_isSynthetic?: boolean;\n}\n\nclass CodeActionAdapter {\n\tprivate static readonly _maxCodeActionsPerFile: number = 1000;\n\n\tprivate readonly _cache = new Cache<vscode.CodeAction | vscode.Command>('CodeAction');\n\tprivate readonly _disposables = new Map<number, DisposableStore>();\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _commands: CommandsConverter,\n\t\tprivate readonly _diagnostics: ExtHostDiagnostics,\n\t\tprivate readonly _provider: vscode.CodeActionProvider,\n\t\tprivate readonly _logService: ILogService,\n\t\tprivate readonly _extension: IExtensionDescription,\n\t\tprivate readonly _apiDeprecation: IExtHostApiDeprecationService,\n\t) { }\n\n\tasync provideCodeActions(resource: URI, rangeOrSelection: IRange | ISelection, context: languages.CodeActionContext, token: CancellationToken): Promise<extHostProtocol.ICodeActionListDto | undefined> {\n\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst ran = Selection.isISelection(rangeOrSelection)\n\t\t\t? <vscode.Selection>typeConvert.Selection.to(rangeOrSelection)\n\t\t\t: <vscode.Range>typeConvert.Range.to(rangeOrSelection);\n\t\tconst allDiagnostics: vscode.Diagnostic[] = [];\n\n\t\tfor (const diagnostic of this._diagnostics.getDiagnostics(resource)) {\n\t\t\tif (ran.intersection(diagnostic.range)) {\n\t\t\t\tconst newLen = allDiagnostics.push(diagnostic);\n\t\t\t\tif (newLen > CodeActionAdapter._maxCodeActionsPerFile) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst codeActionContext: vscode.CodeActionContext = {\n\t\t\tdiagnostics: allDiagnostics,\n\t\t\tonly: context.only ? new CodeActionKind(context.only) : undefined,\n\t\t\ttriggerKind: typeConvert.CodeActionTriggerKind.to(context.trigger),\n\t\t};\n\n\t\tconst commandsOrActions = await this._provider.provideCodeActions(doc, ran, codeActionContext, token);\n\t\tif (!isNonEmptyArray(commandsOrActions) || token.isCancellationRequested) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst cacheId = this._cache.add(commandsOrActions);\n\t\tconst disposables = new DisposableStore();\n\t\tthis._disposables.set(cacheId, disposables);\n\t\tconst actions: CustomCodeAction[] = [];\n\t\tfor (let i = 0; i < commandsOrActions.length; i++) {\n\t\t\tconst candidate = commandsOrActions[i];\n\t\t\tif (!candidate) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (CodeActionAdapter._isCommand(candidate)) {\n\t\t\t\t// old school: synthetic code action\n\t\t\t\tthis._apiDeprecation.report('CodeActionProvider.provideCodeActions - return commands', this._extension,\n\t\t\t\t\t`Return 'CodeAction' instances instead.`);\n\n\t\t\t\tactions.push({\n\t\t\t\t\t_isSynthetic: true,\n\t\t\t\t\ttitle: candidate.title,\n\t\t\t\t\tcommand: this._commands.toInternal(candidate, disposables),\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tif (codeActionContext.only) {\n\t\t\t\t\tif (!candidate.kind) {\n\t\t\t\t\t\tthis._logService.warn(`${this._extension.identifier.value} - Code actions of kind '${codeActionContext.only.value} 'requested but returned code action does not have a 'kind'. Code action will be dropped. Please set 'CodeAction.kind'.`);\n\t\t\t\t\t} else if (!codeActionContext.only.contains(candidate.kind)) {\n\t\t\t\t\t\tthis._logService.warn(`${this._extension.identifier.value} - Code actions of kind '${codeActionContext.only.value} 'requested but returned code action is of kind '${candidate.kind.value}'. Code action will be dropped. Please check 'CodeActionContext.only' to only return requested code actions.`);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// new school: convert code action\n\t\t\t\tactions.push({\n\t\t\t\t\tcacheId: [cacheId, i],\n\t\t\t\t\ttitle: candidate.title,\n\t\t\t\t\tcommand: candidate.command && this._commands.toInternal(candidate.command, disposables),\n\t\t\t\t\tdiagnostics: candidate.diagnostics && candidate.diagnostics.map(typeConvert.Diagnostic.from),\n\t\t\t\t\tedit: candidate.edit && typeConvert.WorkspaceEdit.from(candidate.edit, undefined, isProposedApiEnabled(this._extension, 'snippetWorkspaceEdit')),\n\t\t\t\t\tkind: candidate.kind && candidate.kind.value,\n\t\t\t\t\tisPreferred: candidate.isPreferred,\n\t\t\t\t\tdisabled: candidate.disabled?.reason\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn { cacheId, actions };\n\t}\n\n\tasync resolveCodeAction(id: extHostProtocol.ChainedCacheId, token: CancellationToken): Promise<extHostProtocol.IWorkspaceEditDto | undefined> {\n\t\tconst [sessionId, itemId] = id;\n\t\tconst item = this._cache.get(sessionId, itemId);\n\t\tif (!item || CodeActionAdapter._isCommand(item)) {\n\t\t\treturn undefined; // code actions only!\n\t\t}\n\t\tif (!this._provider.resolveCodeAction) {\n\t\t\treturn; // this should not happen...\n\t\t}\n\t\tconst resolvedItem = (await this._provider.resolveCodeAction(item, token)) ?? item;\n\t\treturn resolvedItem?.edit\n\t\t\t? typeConvert.WorkspaceEdit.from(resolvedItem.edit, undefined, isProposedApiEnabled(this._extension, 'snippetWorkspaceEdit'))\n\t\t\t: undefined;\n\t}\n\n\treleaseCodeActions(cachedId: number): void {\n\t\tthis._disposables.get(cachedId)?.dispose();\n\t\tthis._disposables.delete(cachedId);\n\t\tthis._cache.delete(cachedId);\n\t}\n\n\tprivate static _isCommand(thing: any): thing is vscode.Command {\n\t\treturn typeof (<vscode.Command>thing).command === 'string' && typeof (<vscode.Command>thing).title === 'string';\n\t}\n}\n\nclass DocumentPasteEditProvider {\n\n\tconstructor(\n\t\tprivate readonly _proxy: extHostProtocol.MainThreadLanguageFeaturesShape,\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.DocumentPasteEditProvider,\n\t\tprivate readonly _handle: number,\n\t) { }\n\n\tasync prepareDocumentPaste(resource: URI, ranges: IRange[], dataTransferDto: extHostProtocol.DataTransferDTO, token: CancellationToken): Promise<extHostProtocol.DataTransferDTO | undefined> {\n\t\tif (!this._provider.prepareDocumentPaste) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst vscodeRanges = ranges.map(range => typeConvert.Range.to(range));\n\n\t\tconst dataTransfer = typeConvert.DataTransfer.toDataTransfer(dataTransferDto, () => {\n\t\t\tthrow new NotImplementedError();\n\t\t});\n\t\tawait this._provider.prepareDocumentPaste(doc, vscodeRanges, dataTransfer, token);\n\n\t\treturn typeConvert.DataTransfer.toDataTransferDTO(dataTransfer);\n\t}\n\n\tasync providePasteEdits(requestId: number, resource: URI, ranges: IRange[], dataTransferDto: extHostProtocol.DataTransferDTO, token: CancellationToken): Promise<undefined | extHostProtocol.IPasteEditDto> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst vscodeRanges = ranges.map(range => typeConvert.Range.to(range));\n\n\t\tconst dataTransfer = typeConvert.DataTransfer.toDataTransfer(dataTransferDto, async (index) => {\n\t\t\treturn (await this._proxy.$resolvePasteFileData(this._handle, requestId, index)).buffer;\n\t\t});\n\n\t\tconst edit = await this._provider.provideDocumentPasteEdits(doc, vscodeRanges, dataTransfer, token);\n\t\tif (!edit) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn {\n\t\t\tinsertText: typeof edit.insertText === 'string' ? edit.insertText : { snippet: edit.insertText.value },\n\t\t\tadditionalEdit: edit.additionalEdit ? typeConvert.WorkspaceEdit.from(edit.additionalEdit, undefined, true) : undefined,\n\t\t};\n\t}\n}\n\nclass DocumentFormattingAdapter {\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.DocumentFormattingEditProvider\n\t) { }\n\n\tasync provideDocumentFormattingEdits(resource: URI, options: languages.FormattingOptions, token: CancellationToken): Promise<ISingleEditOperation[] | undefined> {\n\n\t\tconst document = this._documents.getDocument(resource);\n\n\t\tconst value = await this._provider.provideDocumentFormattingEdits(document, <any>options, token);\n\t\tif (Array.isArray(value)) {\n\t\t\treturn value.map(typeConvert.TextEdit.from);\n\t\t}\n\t\treturn undefined;\n\t}\n}\n\nclass RangeFormattingAdapter {\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.DocumentRangeFormattingEditProvider\n\t) { }\n\n\tasync provideDocumentRangeFormattingEdits(resource: URI, range: IRange, options: languages.FormattingOptions, token: CancellationToken): Promise<ISingleEditOperation[] | undefined> {\n\n\t\tconst document = this._documents.getDocument(resource);\n\t\tconst ran = typeConvert.Range.to(range);\n\n\t\tconst value = await this._provider.provideDocumentRangeFormattingEdits(document, ran, <any>options, token);\n\t\tif (Array.isArray(value)) {\n\t\t\treturn value.map(typeConvert.TextEdit.from);\n\t\t}\n\t\treturn undefined;\n\t}\n}\n\nclass OnTypeFormattingAdapter {\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.OnTypeFormattingEditProvider\n\t) { }\n\n\tautoFormatTriggerCharacters: string[] = []; // not here\n\n\tasync provideOnTypeFormattingEdits(resource: URI, position: IPosition, ch: string, options: languages.FormattingOptions, token: CancellationToken): Promise<ISingleEditOperation[] | undefined> {\n\n\t\tconst document = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\tconst value = await this._provider.provideOnTypeFormattingEdits(document, pos, ch, <any>options, token);\n\t\tif (Array.isArray(value)) {\n\t\t\treturn value.map(typeConvert.TextEdit.from);\n\t\t}\n\t\treturn undefined;\n\t}\n}\n\nclass NavigateTypeAdapter {\n\n\tprivate readonly _cache = new Cache<vscode.SymbolInformation>('WorkspaceSymbols');\n\n\tconstructor(\n\t\tprivate readonly _provider: vscode.WorkspaceSymbolProvider,\n\t\tprivate readonly _logService: ILogService\n\t) { }\n\n\tasync provideWorkspaceSymbols(search: string, token: CancellationToken): Promise<extHostProtocol.IWorkspaceSymbolsDto> {\n\t\tconst value = await this._provider.provideWorkspaceSymbols(search, token);\n\n\t\tif (!isNonEmptyArray(value)) {\n\t\t\treturn { symbols: [] };\n\t\t}\n\n\t\tconst sid = this._cache.add(value);\n\t\tconst result: extHostProtocol.IWorkspaceSymbolsDto = {\n\t\t\tcacheId: sid,\n\t\t\tsymbols: []\n\t\t};\n\n\t\tfor (let i = 0; i < value.length; i++) {\n\t\t\tconst item = value[i];\n\t\t\tif (!item || !item.name) {\n\t\t\t\tthis._logService.warn('INVALID SymbolInformation', item);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tresult.symbols.push({\n\t\t\t\t...typeConvert.WorkspaceSymbol.from(item),\n\t\t\t\tcacheId: [sid, i]\n\t\t\t});\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tasync resolveWorkspaceSymbol(symbol: extHostProtocol.IWorkspaceSymbolDto, token: CancellationToken): Promise<extHostProtocol.IWorkspaceSymbolDto | undefined> {\n\t\tif (typeof this._provider.resolveWorkspaceSymbol !== 'function') {\n\t\t\treturn symbol;\n\t\t}\n\t\tif (!symbol.cacheId) {\n\t\t\treturn symbol;\n\t\t}\n\t\tconst item = this._cache.get(...symbol.cacheId);\n\t\tif (item) {\n\t\t\tconst value = await this._provider.resolveWorkspaceSymbol(item, token);\n\t\t\treturn value && mixin(symbol, typeConvert.WorkspaceSymbol.from(value), true);\n\t\t}\n\t\treturn undefined;\n\t}\n\n\treleaseWorkspaceSymbols(id: number): any {\n\t\tthis._cache.delete(id);\n\t}\n}\n\nclass RenameAdapter {\n\n\tstatic supportsResolving(provider: vscode.RenameProvider): boolean {\n\t\treturn typeof provider.prepareRename === 'function';\n\t}\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.RenameProvider,\n\t\tprivate readonly _logService: ILogService\n\t) { }\n\n\tasync provideRenameEdits(resource: URI, position: IPosition, newName: string, token: CancellationToken): Promise<extHostProtocol.IWorkspaceEditDto | undefined> {\n\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\ttry {\n\t\t\tconst value = await this._provider.provideRenameEdits(doc, pos, newName, token);\n\t\t\tif (!value) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\treturn typeConvert.WorkspaceEdit.from(value);\n\n\t\t} catch (err) {\n\t\t\tconst rejectReason = RenameAdapter._asMessage(err);\n\t\t\tif (rejectReason) {\n\t\t\t\treturn <extHostProtocol.IWorkspaceEditDto>{ rejectReason, edits: undefined! };\n\t\t\t} else {\n\t\t\t\t// generic error\n\t\t\t\treturn Promise.reject<extHostProtocol.IWorkspaceEditDto>(err);\n\t\t\t}\n\t\t}\n\t}\n\n\tasync resolveRenameLocation(resource: URI, position: IPosition, token: CancellationToken): Promise<(languages.RenameLocation & languages.Rejection) | undefined> {\n\t\tif (typeof this._provider.prepareRename !== 'function') {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\ttry {\n\t\t\tconst rangeOrLocation = await this._provider.prepareRename(doc, pos, token);\n\n\t\t\tlet range: vscode.Range | undefined;\n\t\t\tlet text: string | undefined;\n\t\t\tif (Range.isRange(rangeOrLocation)) {\n\t\t\t\trange = rangeOrLocation;\n\t\t\t\ttext = doc.getText(rangeOrLocation);\n\n\t\t\t} else if (isObject(rangeOrLocation)) {\n\t\t\t\trange = rangeOrLocation.range;\n\t\t\t\ttext = rangeOrLocation.placeholder;\n\t\t\t}\n\n\t\t\tif (!range || !text) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\tif (range.start.line > pos.line || range.end.line < pos.line) {\n\t\t\t\tthis._logService.warn('INVALID rename location: position line must be within range start/end lines');\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\treturn { range: typeConvert.Range.from(range), text };\n\n\t\t} catch (err) {\n\t\t\tconst rejectReason = RenameAdapter._asMessage(err);\n\t\t\tif (rejectReason) {\n\t\t\t\treturn <languages.RenameLocation & languages.Rejection>{ rejectReason, range: undefined!, text: undefined! };\n\t\t\t} else {\n\t\t\t\treturn Promise.reject<any>(err);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate static _asMessage(err: any): string | undefined {\n\t\tif (typeof err === 'string') {\n\t\t\treturn err;\n\t\t} else if (err instanceof Error && typeof err.message === 'string') {\n\t\t\treturn err.message;\n\t\t} else {\n\t\t\treturn undefined;\n\t\t}\n\t}\n}\n\nclass SemanticTokensPreviousResult {\n\tconstructor(\n\t\treadonly resultId: string | undefined,\n\t\treadonly tokens?: Uint32Array,\n\t) { }\n}\n\ntype RelaxedSemanticTokens = { readonly resultId?: string; readonly data: number[] };\ntype RelaxedSemanticTokensEdit = { readonly start: number; readonly deleteCount: number; readonly data?: number[] };\ntype RelaxedSemanticTokensEdits = { readonly resultId?: string; readonly edits: RelaxedSemanticTokensEdit[] };\n\ntype ProvidedSemanticTokens = vscode.SemanticTokens | RelaxedSemanticTokens;\ntype ProvidedSemanticTokensEdits = vscode.SemanticTokensEdits | RelaxedSemanticTokensEdits;\n\nexport class DocumentSemanticTokensAdapter {\n\n\tprivate readonly _previousResults: Map<number, SemanticTokensPreviousResult>;\n\tprivate _nextResultId = 1;\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.DocumentSemanticTokensProvider,\n\t) {\n\t\tthis._previousResults = new Map<number, SemanticTokensPreviousResult>();\n\t}\n\n\tasync provideDocumentSemanticTokens(resource: URI, previousResultId: number, token: CancellationToken): Promise<VSBuffer | null> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst previousResult = (previousResultId !== 0 ? this._previousResults.get(previousResultId) : null);\n\t\tlet value = typeof previousResult?.resultId === 'string' && typeof this._provider.provideDocumentSemanticTokensEdits === 'function'\n\t\t\t? await this._provider.provideDocumentSemanticTokensEdits(doc, previousResult.resultId, token)\n\t\t\t: await this._provider.provideDocumentSemanticTokens(doc, token);\n\n\t\tif (previousResult) {\n\t\t\tthis._previousResults.delete(previousResultId);\n\t\t}\n\t\tif (!value) {\n\t\t\treturn null;\n\t\t}\n\t\tvalue = DocumentSemanticTokensAdapter._fixProvidedSemanticTokens(value);\n\t\treturn this._send(DocumentSemanticTokensAdapter._convertToEdits(previousResult, value), value);\n\t}\n\n\tasync releaseDocumentSemanticColoring(semanticColoringResultId: number): Promise<void> {\n\t\tthis._previousResults.delete(semanticColoringResultId);\n\t}\n\n\tprivate static _fixProvidedSemanticTokens(v: ProvidedSemanticTokens | ProvidedSemanticTokensEdits): vscode.SemanticTokens | vscode.SemanticTokensEdits {\n\t\tif (DocumentSemanticTokensAdapter._isSemanticTokens(v)) {\n\t\t\tif (DocumentSemanticTokensAdapter._isCorrectSemanticTokens(v)) {\n\t\t\t\treturn v;\n\t\t\t}\n\t\t\treturn new SemanticTokens(new Uint32Array(v.data), v.resultId);\n\t\t} else if (DocumentSemanticTokensAdapter._isSemanticTokensEdits(v)) {\n\t\t\tif (DocumentSemanticTokensAdapter._isCorrectSemanticTokensEdits(v)) {\n\t\t\t\treturn v;\n\t\t\t}\n\t\t\treturn new SemanticTokensEdits(v.edits.map(edit => new SemanticTokensEdit(edit.start, edit.deleteCount, edit.data ? new Uint32Array(edit.data) : edit.data)), v.resultId);\n\t\t}\n\t\treturn v;\n\t}\n\n\tprivate static _isSemanticTokens(v: ProvidedSemanticTokens | ProvidedSemanticTokensEdits): v is ProvidedSemanticTokens {\n\t\treturn v && !!((v as ProvidedSemanticTokens).data);\n\t}\n\n\tprivate static _isCorrectSemanticTokens(v: ProvidedSemanticTokens): v is vscode.SemanticTokens {\n\t\treturn (v.data instanceof Uint32Array);\n\t}\n\n\tprivate static _isSemanticTokensEdits(v: ProvidedSemanticTokens | ProvidedSemanticTokensEdits): v is ProvidedSemanticTokensEdits {\n\t\treturn v && Array.isArray((v as ProvidedSemanticTokensEdits).edits);\n\t}\n\n\tprivate static _isCorrectSemanticTokensEdits(v: ProvidedSemanticTokensEdits): v is vscode.SemanticTokensEdits {\n\t\tfor (const edit of v.edits) {\n\t\t\tif (!(edit.data instanceof Uint32Array)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tprivate static _convertToEdits(previousResult: SemanticTokensPreviousResult | null | undefined, newResult: vscode.SemanticTokens | vscode.SemanticTokensEdits): vscode.SemanticTokens | vscode.SemanticTokensEdits {\n\t\tif (!DocumentSemanticTokensAdapter._isSemanticTokens(newResult)) {\n\t\t\treturn newResult;\n\t\t}\n\t\tif (!previousResult || !previousResult.tokens) {\n\t\t\treturn newResult;\n\t\t}\n\t\tconst oldData = previousResult.tokens;\n\t\tconst oldLength = oldData.length;\n\t\tconst newData = newResult.data;\n\t\tconst newLength = newData.length;\n\n\t\tlet commonPrefixLength = 0;\n\t\tconst maxCommonPrefixLength = Math.min(oldLength, newLength);\n\t\twhile (commonPrefixLength < maxCommonPrefixLength && oldData[commonPrefixLength] === newData[commonPrefixLength]) {\n\t\t\tcommonPrefixLength++;\n\t\t}\n\n\t\tif (commonPrefixLength === oldLength && commonPrefixLength === newLength) {\n\t\t\t// complete overlap!\n\t\t\treturn new SemanticTokensEdits([], newResult.resultId);\n\t\t}\n\n\t\tlet commonSuffixLength = 0;\n\t\tconst maxCommonSuffixLength = maxCommonPrefixLength - commonPrefixLength;\n\t\twhile (commonSuffixLength < maxCommonSuffixLength && oldData[oldLength - commonSuffixLength - 1] === newData[newLength - commonSuffixLength - 1]) {\n\t\t\tcommonSuffixLength++;\n\t\t}\n\n\t\treturn new SemanticTokensEdits([{\n\t\t\tstart: commonPrefixLength,\n\t\t\tdeleteCount: (oldLength - commonPrefixLength - commonSuffixLength),\n\t\t\tdata: newData.subarray(commonPrefixLength, newLength - commonSuffixLength)\n\t\t}], newResult.resultId);\n\t}\n\n\tprivate _send(value: vscode.SemanticTokens | vscode.SemanticTokensEdits, original: vscode.SemanticTokens | vscode.SemanticTokensEdits): VSBuffer | null {\n\t\tif (DocumentSemanticTokensAdapter._isSemanticTokens(value)) {\n\t\t\tconst myId = this._nextResultId++;\n\t\t\tthis._previousResults.set(myId, new SemanticTokensPreviousResult(value.resultId, value.data));\n\t\t\treturn encodeSemanticTokensDto({\n\t\t\t\tid: myId,\n\t\t\t\ttype: 'full',\n\t\t\t\tdata: value.data\n\t\t\t});\n\t\t}\n\n\t\tif (DocumentSemanticTokensAdapter._isSemanticTokensEdits(value)) {\n\t\t\tconst myId = this._nextResultId++;\n\t\t\tif (DocumentSemanticTokensAdapter._isSemanticTokens(original)) {\n\t\t\t\t// store the original\n\t\t\t\tthis._previousResults.set(myId, new SemanticTokensPreviousResult(original.resultId, original.data));\n\t\t\t} else {\n\t\t\t\tthis._previousResults.set(myId, new SemanticTokensPreviousResult(value.resultId));\n\t\t\t}\n\t\t\treturn encodeSemanticTokensDto({\n\t\t\t\tid: myId,\n\t\t\t\ttype: 'delta',\n\t\t\t\tdeltas: (value.edits || []).map(edit => ({ start: edit.start, deleteCount: edit.deleteCount, data: edit.data }))\n\t\t\t});\n\t\t}\n\n\t\treturn null;\n\t}\n}\n\nexport class DocumentRangeSemanticTokensAdapter {\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.DocumentRangeSemanticTokensProvider,\n\t) { }\n\n\tasync provideDocumentRangeSemanticTokens(resource: URI, range: IRange, token: CancellationToken): Promise<VSBuffer | null> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst value = await this._provider.provideDocumentRangeSemanticTokens(doc, typeConvert.Range.to(range), token);\n\t\tif (!value) {\n\t\t\treturn null;\n\t\t}\n\t\treturn this._send(value);\n\t}\n\n\tprivate _send(value: vscode.SemanticTokens): VSBuffer {\n\t\treturn encodeSemanticTokensDto({\n\t\t\tid: 0,\n\t\t\ttype: 'full',\n\t\t\tdata: value.data\n\t\t});\n\t}\n}\n\nclass CompletionsAdapter {\n\n\tstatic supportsResolving(provider: vscode.CompletionItemProvider): boolean {\n\t\treturn typeof provider.resolveCompletionItem === 'function';\n\t}\n\n\tprivate _cache = new Cache<vscode.CompletionItem>('CompletionItem');\n\tprivate _disposables = new Map<number, DisposableStore>();\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _commands: CommandsConverter,\n\t\tprivate readonly _provider: vscode.CompletionItemProvider,\n\t\tprivate readonly _apiDeprecation: IExtHostApiDeprecationService,\n\t\tprivate readonly _extension: IExtensionDescription,\n\t) { }\n\n\tasync provideCompletionItems(resource: URI, position: IPosition, context: languages.CompletionContext, token: CancellationToken): Promise<extHostProtocol.ISuggestResultDto | undefined> {\n\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\t// The default insert/replace ranges. It's important to compute them\n\t\t// before asynchronously asking the provider for its results. See\n\t\t// https://github.com/microsoft/vscode/issues/83400#issuecomment-546851421\n\t\tconst replaceRange = doc.getWordRangeAtPosition(pos) || new Range(pos, pos);\n\t\tconst insertRange = replaceRange.with({ end: pos });\n\n\t\tconst sw = new StopWatch(true);\n\t\tconst itemsOrList = await this._provider.provideCompletionItems(doc, pos, token, typeConvert.CompletionContext.to(context));\n\n\t\tif (!itemsOrList) {\n\t\t\t// undefined and null are valid results\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (token.isCancellationRequested) {\n\t\t\t// cancelled -> return without further ado, esp no caching\n\t\t\t// of results as they will leak\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst list = Array.isArray(itemsOrList) ? new CompletionList(itemsOrList) : itemsOrList;\n\n\t\t// keep result for providers that support resolving\n\t\tconst pid: number = CompletionsAdapter.supportsResolving(this._provider) ? this._cache.add(list.items) : this._cache.add([]);\n\t\tconst disposables = new DisposableStore();\n\t\tthis._disposables.set(pid, disposables);\n\n\t\tconst completions: extHostProtocol.ISuggestDataDto[] = [];\n\t\tconst result: extHostProtocol.ISuggestResultDto = {\n\t\t\tx: pid,\n\t\t\t[extHostProtocol.ISuggestResultDtoField.completions]: completions,\n\t\t\t[extHostProtocol.ISuggestResultDtoField.defaultRanges]: { replace: typeConvert.Range.from(replaceRange), insert: typeConvert.Range.from(insertRange) },\n\t\t\t[extHostProtocol.ISuggestResultDtoField.isIncomplete]: list.isIncomplete || undefined,\n\t\t\t[extHostProtocol.ISuggestResultDtoField.duration]: sw.elapsed()\n\t\t};\n\n\t\tfor (let i = 0; i < list.items.length; i++) {\n\t\t\tconst item = list.items[i];\n\t\t\t// check for bad completion item first\n\t\t\tconst dto = this._convertCompletionItem(item, [pid, i], insertRange, replaceRange);\n\t\t\tcompletions.push(dto);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tasync resolveCompletionItem(id: extHostProtocol.ChainedCacheId, token: CancellationToken): Promise<extHostProtocol.ISuggestDataDto | undefined> {\n\n\t\tif (typeof this._provider.resolveCompletionItem !== 'function') {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst item = this._cache.get(...id);\n\t\tif (!item) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst resolvedItem = await this._provider.resolveCompletionItem!(item, token);\n\n\t\tif (!resolvedItem) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn this._convertCompletionItem(resolvedItem, id);\n\t}\n\n\treleaseCompletionItems(id: number): any {\n\t\tthis._disposables.get(id)?.dispose();\n\t\tthis._disposables.delete(id);\n\t\tthis._cache.delete(id);\n\t}\n\n\tprivate _convertCompletionItem(item: vscode.CompletionItem, id: extHostProtocol.ChainedCacheId, defaultInsertRange?: vscode.Range, defaultReplaceRange?: vscode.Range): extHostProtocol.ISuggestDataDto {\n\n\t\tconst disposables = this._disposables.get(id[0]);\n\t\tif (!disposables) {\n\t\t\tthrow Error('DisposableStore is missing...');\n\t\t}\n\n\t\tconst result: extHostProtocol.ISuggestDataDto = {\n\t\t\t//\n\t\t\tx: id,\n\t\t\t//\n\t\t\t[extHostProtocol.ISuggestDataDtoField.label]: item.label,\n\t\t\t[extHostProtocol.ISuggestDataDtoField.kind]: item.kind !== undefined ? typeConvert.CompletionItemKind.from(item.kind) : undefined,\n\t\t\t[extHostProtocol.ISuggestDataDtoField.kindModifier]: item.tags && item.tags.map(typeConvert.CompletionItemTag.from),\n\t\t\t[extHostProtocol.ISuggestDataDtoField.detail]: item.detail,\n\t\t\t[extHostProtocol.ISuggestDataDtoField.documentation]: typeof item.documentation === 'undefined' ? undefined : typeConvert.MarkdownString.fromStrict(item.documentation),\n\t\t\t[extHostProtocol.ISuggestDataDtoField.sortText]: item.sortText !== item.label ? item.sortText : undefined,\n\t\t\t[extHostProtocol.ISuggestDataDtoField.filterText]: item.filterText !== item.label ? item.filterText : undefined,\n\t\t\t[extHostProtocol.ISuggestDataDtoField.preselect]: item.preselect || undefined,\n\t\t\t[extHostProtocol.ISuggestDataDtoField.insertTextRules]: item.keepWhitespace ? languages.CompletionItemInsertTextRule.KeepWhitespace : 0,\n\t\t\t[extHostProtocol.ISuggestDataDtoField.commitCharacters]: item.commitCharacters,\n\t\t\t[extHostProtocol.ISuggestDataDtoField.additionalTextEdits]: item.additionalTextEdits && item.additionalTextEdits.map(typeConvert.TextEdit.from),\n\t\t\t[extHostProtocol.ISuggestDataDtoField.command]: this._commands.toInternal(item.command, disposables),\n\t\t};\n\n\t\t// 'insertText'-logic\n\t\tif (item.textEdit) {\n\t\t\tthis._apiDeprecation.report('CompletionItem.textEdit', this._extension, `Use 'CompletionItem.insertText' and 'CompletionItem.range' instead.`);\n\t\t\tresult[extHostProtocol.ISuggestDataDtoField.insertText] = item.textEdit.newText;\n\n\t\t} else if (typeof item.insertText === 'string') {\n\t\t\tresult[extHostProtocol.ISuggestDataDtoField.insertText] = item.insertText;\n\n\t\t} else if (item.insertText instanceof SnippetString) {\n\t\t\tresult[extHostProtocol.ISuggestDataDtoField.insertText] = item.insertText.value;\n\t\t\tresult[extHostProtocol.ISuggestDataDtoField.insertTextRules]! |= languages.CompletionItemInsertTextRule.InsertAsSnippet;\n\t\t}\n\n\t\t// 'overwrite[Before|After]'-logic\n\t\tlet range: vscode.Range | { inserting: vscode.Range; replacing: vscode.Range } | undefined;\n\t\tif (item.textEdit) {\n\t\t\trange = item.textEdit.range;\n\t\t} else if (item.range) {\n\t\t\trange = item.range;\n\t\t}\n\n\t\tif (Range.isRange(range)) {\n\t\t\t// \"old\" range\n\t\t\tresult[extHostProtocol.ISuggestDataDtoField.range] = typeConvert.Range.from(range);\n\n\t\t} else if (range && (!defaultInsertRange?.isEqual(range.inserting) || !defaultReplaceRange?.isEqual(range.replacing))) {\n\t\t\t// ONLY send range when it's different from the default ranges (safe bandwidth)\n\t\t\tresult[extHostProtocol.ISuggestDataDtoField.range] = {\n\t\t\t\tinsert: typeConvert.Range.from(range.inserting),\n\t\t\t\treplace: typeConvert.Range.from(range.replacing)\n\t\t\t};\n\t\t}\n\n\t\treturn result;\n\t}\n}\n\nclass InlineCompletionAdapterBase {\n\tasync provideInlineCompletions(resource: URI, position: IPosition, context: languages.InlineCompletionContext, token: CancellationToken): Promise<extHostProtocol.IdentifiableInlineCompletions | undefined> {\n\t\treturn undefined;\n\t}\n\n\tdisposeCompletions(pid: number): void { }\n\n\thandleDidShowCompletionItem(pid: number, idx: number): void { }\n}\n\nclass InlineCompletionAdapter extends InlineCompletionAdapterBase {\n\tprivate readonly _references = new ReferenceMap<{\n\t\tdispose(): void;\n\t\titems: readonly vscode.InlineCompletionItem[];\n\t}>();\n\n\tprivate readonly _isAdditionsProposedApiEnabled = isProposedApiEnabled(this._extension, 'inlineCompletionsAdditions');\n\n\tconstructor(\n\t\tprivate readonly _extension: IExtensionDescription,\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.InlineCompletionItemProvider,\n\t\tprivate readonly _commands: CommandsConverter,\n\t) {\n\t\tsuper();\n\t}\n\n\tpublic get supportsHandleDidShowCompletionItem(): boolean {\n\t\treturn isProposedApiEnabled(this._extension, 'inlineCompletionsAdditions') && typeof this._provider.handleDidShowCompletionItem === 'function';\n\t}\n\n\tprivate readonly languageTriggerKindToVSCodeTriggerKind: Record<languages.InlineCompletionTriggerKind, InlineCompletionTriggerKind> = {\n\t\t[languages.InlineCompletionTriggerKind.Automatic]: InlineCompletionTriggerKind.Automatic,\n\t\t[languages.InlineCompletionTriggerKind.Explicit]: InlineCompletionTriggerKind.Invoke,\n\t};\n\n\toverride async provideInlineCompletions(resource: URI, position: IPosition, context: languages.InlineCompletionContext, token: CancellationToken): Promise<extHostProtocol.IdentifiableInlineCompletions | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\tconst result = await this._provider.provideInlineCompletionItems(doc, pos, {\n\t\t\tselectedCompletionInfo:\n\t\t\t\tcontext.selectedSuggestionInfo\n\t\t\t\t\t? {\n\t\t\t\t\t\trange: typeConvert.Range.to(context.selectedSuggestionInfo.range),\n\t\t\t\t\t\ttext: context.selectedSuggestionInfo.text\n\t\t\t\t\t}\n\t\t\t\t\t: undefined,\n\t\t\ttriggerKind: this.languageTriggerKindToVSCodeTriggerKind[context.triggerKind]\n\t\t}, token);\n\n\t\tif (!result) {\n\t\t\t// undefined and null are valid results\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (token.isCancellationRequested) {\n\t\t\t// cancelled -> return without further ado, esp no caching\n\t\t\t// of results as they will leak\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst normalizedResult = isArray(result) ? result : result.items;\n\t\tconst commands = this._isAdditionsProposedApiEnabled ? isArray(result) ? [] : result.commands || [] : [];\n\n\t\tlet disposableStore: DisposableStore | undefined = undefined;\n\t\tconst pid = this._references.createReferenceId({\n\t\t\tdispose() {\n\t\t\t\tif (disposableStore) {\n\t\t\t\t\tdisposableStore.dispose();\n\t\t\t\t}\n\t\t\t},\n\t\t\titems: normalizedResult\n\t\t});\n\n\t\treturn {\n\t\t\tpid,\n\t\t\titems: normalizedResult.map<extHostProtocol.IdentifiableInlineCompletion>((item, idx) => {\n\t\t\t\tlet command: languages.Command | undefined = undefined;\n\t\t\t\tif (item.command) {\n\t\t\t\t\tif (!disposableStore) {\n\t\t\t\t\t\tdisposableStore = new DisposableStore();\n\t\t\t\t\t}\n\t\t\t\t\tcommand = this._commands.toInternal(item.command, disposableStore);\n\t\t\t\t}\n\n\t\t\t\tconst insertText = item.insertText;\n\t\t\t\treturn ({\n\t\t\t\t\tinsertText: typeof insertText === 'string' ? insertText : { snippet: insertText.value },\n\t\t\t\t\tfilterText: item.filterText,\n\t\t\t\t\trange: item.range ? typeConvert.Range.from(item.range) : undefined,\n\t\t\t\t\tcommand,\n\t\t\t\t\tidx: idx,\n\t\t\t\t\tcompleteBracketPairs: this._isAdditionsProposedApiEnabled ? item.completeBracketPairs : false\n\t\t\t\t});\n\t\t\t}),\n\t\t\tcommands: commands.map(c => {\n\t\t\t\tif (!disposableStore) {\n\t\t\t\t\tdisposableStore = new DisposableStore();\n\t\t\t\t}\n\t\t\t\treturn this._commands.toInternal(c, disposableStore);\n\t\t\t})\n\t\t};\n\t}\n\n\toverride disposeCompletions(pid: number) {\n\t\tconst data = this._references.disposeReferenceId(pid);\n\t\tdata?.dispose();\n\t}\n\n\toverride handleDidShowCompletionItem(pid: number, idx: number): void {\n\t\tconst completionItem = this._references.get(pid)?.items[idx];\n\t\tif (completionItem) {\n\t\t\tif (this._provider.handleDidShowCompletionItem && this._isAdditionsProposedApiEnabled) {\n\t\t\t\tthis._provider.handleDidShowCompletionItem(completionItem);\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass InlineCompletionAdapterNew extends InlineCompletionAdapterBase {\n\tprivate readonly _references = new ReferenceMap<{\n\t\tdispose(): void;\n\t\titems: readonly vscode.InlineCompletionItemNew[];\n\t}>();\n\n\tprivate readonly isAdditionProposedApiEnabled = isProposedApiEnabled(this.extension, 'inlineCompletionsAdditions');\n\n\tconstructor(\n\t\tprivate readonly extension: IExtensionDescription,\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.InlineCompletionItemProviderNew,\n\t\tprivate readonly _commands: CommandsConverter,\n\t) {\n\t\tsuper();\n\t}\n\n\tprivate readonly languageTriggerKindToVSCodeTriggerKind: Record<languages.InlineCompletionTriggerKind, vscode.InlineCompletionTriggerKindNew> = {\n\t\t[languages.InlineCompletionTriggerKind.Automatic]: InlineCompletionTriggerKindNew.Automatic,\n\t\t[languages.InlineCompletionTriggerKind.Explicit]: InlineCompletionTriggerKindNew.Invoke,\n\t};\n\n\toverride async provideInlineCompletions(resource: URI, position: IPosition, context: languages.InlineCompletionContext, token: CancellationToken): Promise<extHostProtocol.IdentifiableInlineCompletions | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\tconst result = await this._provider.provideInlineCompletionItems(doc, pos, {\n\t\t\tselectedCompletionInfo:\n\t\t\t\tcontext.selectedSuggestionInfo\n\t\t\t\t\t? {\n\t\t\t\t\t\trange: typeConvert.Range.to(context.selectedSuggestionInfo.range),\n\t\t\t\t\t\ttext: context.selectedSuggestionInfo.text\n\t\t\t\t\t}\n\t\t\t\t\t: undefined,\n\t\t\ttriggerKind: this.languageTriggerKindToVSCodeTriggerKind[context.triggerKind]\n\t\t}, token);\n\n\t\tif (!result) {\n\t\t\t// undefined and null are valid results\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (token.isCancellationRequested) {\n\t\t\t// cancelled -> return without further ado, esp no caching\n\t\t\t// of results as they will leak\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst normalizedResult = isArray(result) ? result : result.items;\n\t\tconst commands = isArray(result) ? [] : result.commands || [];\n\n\t\tlet disposableStore: DisposableStore | undefined = undefined;\n\t\tconst pid = this._references.createReferenceId({\n\t\t\tdispose() {\n\t\t\t\tif (disposableStore) {\n\t\t\t\t\tdisposableStore.dispose();\n\t\t\t\t}\n\t\t\t},\n\t\t\titems: normalizedResult\n\t\t});\n\n\t\treturn {\n\t\t\tpid,\n\t\t\titems: normalizedResult.map<extHostProtocol.IdentifiableInlineCompletion>((item, idx) => {\n\t\t\t\tlet command: languages.Command | undefined = undefined;\n\t\t\t\tif (item.command) {\n\t\t\t\t\tif (!disposableStore) {\n\t\t\t\t\t\tdisposableStore = new DisposableStore();\n\t\t\t\t\t}\n\t\t\t\t\tcommand = this._commands.toInternal(item.command, disposableStore);\n\t\t\t\t}\n\n\t\t\t\tconst insertText = item.insertText;\n\t\t\t\treturn ({\n\t\t\t\t\tinsertText: typeof insertText === 'string' ? insertText : { snippet: insertText.value },\n\t\t\t\t\tfilterText: item.filterText,\n\t\t\t\t\trange: item.range ? typeConvert.Range.from(item.range) : undefined,\n\t\t\t\t\tcommand,\n\t\t\t\t\tidx: idx,\n\t\t\t\t\tcompleteBracketPairs: this.isAdditionProposedApiEnabled ? item.completeBracketPairs : false\n\t\t\t\t});\n\t\t\t}),\n\t\t\tcommands: commands.map(c => {\n\t\t\t\tif (!disposableStore) {\n\t\t\t\t\tdisposableStore = new DisposableStore();\n\t\t\t\t}\n\t\t\t\treturn this._commands.toInternal(c, disposableStore);\n\t\t\t})\n\t\t};\n\t}\n\n\toverride disposeCompletions(pid: number) {\n\t\tconst data = this._references.disposeReferenceId(pid);\n\t\tdata?.dispose();\n\t}\n\n\toverride handleDidShowCompletionItem(pid: number, idx: number): void {\n\t\tconst completionItem = this._references.get(pid)?.items[idx];\n\t\tif (completionItem) {\n\t\t\tif (this._provider.handleDidShowCompletionItem && this.isAdditionProposedApiEnabled) {\n\t\t\t\tthis._provider.handleDidShowCompletionItem(completionItem);\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass ReferenceMap<T> {\n\tprivate readonly _references = new Map<number, T>();\n\tprivate _idPool = 1;\n\n\tcreateReferenceId(value: T): number {\n\t\tconst id = this._idPool++;\n\t\tthis._references.set(id, value);\n\t\treturn id;\n\t}\n\n\tdisposeReferenceId(referenceId: number): T | undefined {\n\t\tconst value = this._references.get(referenceId);\n\t\tthis._references.delete(referenceId);\n\t\treturn value;\n\t}\n\n\tget(referenceId: number): T | undefined {\n\t\treturn this._references.get(referenceId);\n\t}\n}\n\nclass SignatureHelpAdapter {\n\n\tprivate readonly _cache = new Cache<vscode.SignatureHelp>('SignatureHelp');\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.SignatureHelpProvider,\n\t) { }\n\n\tasync provideSignatureHelp(resource: URI, position: IPosition, context: extHostProtocol.ISignatureHelpContextDto, token: CancellationToken): Promise<extHostProtocol.ISignatureHelpDto | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\t\tconst vscodeContext = this.reviveContext(context);\n\n\t\tconst value = await this._provider.provideSignatureHelp(doc, pos, token, vscodeContext);\n\t\tif (value) {\n\t\t\tconst id = this._cache.add([value]);\n\t\t\treturn { ...typeConvert.SignatureHelp.from(value), id };\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprivate reviveContext(context: extHostProtocol.ISignatureHelpContextDto): vscode.SignatureHelpContext {\n\t\tlet activeSignatureHelp: vscode.SignatureHelp | undefined = undefined;\n\t\tif (context.activeSignatureHelp) {\n\t\t\tconst revivedSignatureHelp = typeConvert.SignatureHelp.to(context.activeSignatureHelp);\n\t\t\tconst saved = this._cache.get(context.activeSignatureHelp.id, 0);\n\t\t\tif (saved) {\n\t\t\t\tactiveSignatureHelp = saved;\n\t\t\t\tactiveSignatureHelp.activeSignature = revivedSignatureHelp.activeSignature;\n\t\t\t\tactiveSignatureHelp.activeParameter = revivedSignatureHelp.activeParameter;\n\t\t\t} else {\n\t\t\t\tactiveSignatureHelp = revivedSignatureHelp;\n\t\t\t}\n\t\t}\n\t\treturn { ...context, activeSignatureHelp };\n\t}\n\n\treleaseSignatureHelp(id: number): any {\n\t\tthis._cache.delete(id);\n\t}\n}\n\nclass InlayHintsAdapter {\n\n\tprivate _cache = new Cache<vscode.InlayHint>('InlayHints');\n\tprivate readonly _disposables = new Map<number, DisposableStore>();\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _commands: CommandsConverter,\n\t\tprivate readonly _provider: vscode.InlayHintsProvider,\n\t\tprivate readonly _logService: ILogService,\n\t\tprivate readonly _extension: IExtensionDescription\n\t) { }\n\n\tasync provideInlayHints(resource: URI, ran: IRange, token: CancellationToken): Promise<extHostProtocol.IInlayHintsDto | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst range = typeConvert.Range.to(ran);\n\n\t\tconst hints = await this._provider.provideInlayHints(doc, range, token);\n\t\tif (!Array.isArray(hints) || hints.length === 0) {\n\t\t\t// bad result\n\t\t\tthis._logService.trace(`[InlayHints] NO inlay hints from '${this._extension.identifier.value}' for ${ran}`);\n\t\t\treturn undefined;\n\t\t}\n\t\tif (token.isCancellationRequested) {\n\t\t\t// cancelled -> return without further ado, esp no caching\n\t\t\t// of results as they will leak\n\t\t\treturn undefined;\n\t\t}\n\t\tconst pid = this._cache.add(hints);\n\t\tthis._disposables.set(pid, new DisposableStore());\n\t\tconst result: extHostProtocol.IInlayHintsDto = { hints: [], cacheId: pid };\n\t\tfor (let i = 0; i < hints.length; i++) {\n\t\t\tif (this._isValidInlayHint(hints[i], range)) {\n\t\t\t\tresult.hints.push(this._convertInlayHint(hints[i], [pid, i]));\n\t\t\t}\n\t\t}\n\t\tthis._logService.trace(`[InlayHints] ${result.hints.length} inlay hints from '${this._extension.identifier.value}' for ${ran}`);\n\t\treturn result;\n\t}\n\n\tasync resolveInlayHint(id: extHostProtocol.ChainedCacheId, token: CancellationToken) {\n\t\tif (typeof this._provider.resolveInlayHint !== 'function') {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst item = this._cache.get(...id);\n\t\tif (!item) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst hint = await this._provider.resolveInlayHint!(item, token);\n\t\tif (!hint) {\n\t\t\treturn undefined;\n\t\t}\n\t\tif (!this._isValidInlayHint(hint)) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn this._convertInlayHint(hint, id);\n\t}\n\n\treleaseHints(id: number): any {\n\t\tthis._disposables.get(id)?.dispose();\n\t\tthis._disposables.delete(id);\n\t\tthis._cache.delete(id);\n\t}\n\n\tprivate _isValidInlayHint(hint: vscode.InlayHint, range?: vscode.Range): boolean {\n\t\tif (hint.label.length === 0 || Array.isArray(hint.label) && hint.label.every(part => part.value.length === 0)) {\n\t\t\tconsole.log('INVALID inlay hint, empty label', hint);\n\t\t\treturn false;\n\t\t}\n\t\tif (range && !range.contains(hint.position)) {\n\t\t\t// console.log('INVALID inlay hint, position outside range', range, hint);\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tprivate _convertInlayHint(hint: vscode.InlayHint, id: extHostProtocol.ChainedCacheId): extHostProtocol.IInlayHintDto {\n\n\t\tconst disposables = this._disposables.get(id[0]);\n\t\tif (!disposables) {\n\t\t\tthrow Error('DisposableStore is missing...');\n\t\t}\n\n\t\tconst result: extHostProtocol.IInlayHintDto = {\n\t\t\tlabel: '', // fill-in below\n\t\t\tcacheId: id,\n\t\t\ttooltip: typeConvert.MarkdownString.fromStrict(hint.tooltip),\n\t\t\tposition: typeConvert.Position.from(hint.position),\n\t\t\ttextEdits: hint.textEdits && hint.textEdits.map(typeConvert.TextEdit.from),\n\t\t\tkind: hint.kind && typeConvert.InlayHintKind.from(hint.kind),\n\t\t\tpaddingLeft: hint.paddingLeft,\n\t\t\tpaddingRight: hint.paddingRight,\n\t\t};\n\n\t\tif (typeof hint.label === 'string') {\n\t\t\tresult.label = hint.label;\n\t\t} else {\n\t\t\tresult.label = hint.label.map(part => {\n\t\t\t\tconst result: languages.InlayHintLabelPart = { label: part.value };\n\t\t\t\tresult.tooltip = typeConvert.MarkdownString.fromStrict(part.tooltip);\n\t\t\t\tif (Location.isLocation(part.location)) {\n\t\t\t\t\tresult.location = typeConvert.location.from(part.location);\n\t\t\t\t}\n\t\t\t\tif (part.command) {\n\t\t\t\t\tresult.command = this._commands.toInternal(part.command, disposables);\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t});\n\t\t}\n\t\treturn result;\n\t}\n}\n\nclass LinkProviderAdapter {\n\n\tprivate _cache = new Cache<vscode.DocumentLink>('DocumentLink');\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.DocumentLinkProvider\n\t) { }\n\n\tasync provideLinks(resource: URI, token: CancellationToken): Promise<extHostProtocol.ILinksListDto | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\n\t\tconst links = await this._provider.provideDocumentLinks(doc, token);\n\t\tif (!Array.isArray(links) || links.length === 0) {\n\t\t\t// bad result\n\t\t\treturn undefined;\n\t\t}\n\t\tif (token.isCancellationRequested) {\n\t\t\t// cancelled -> return without further ado, esp no caching\n\t\t\t// of results as they will leak\n\t\t\treturn undefined;\n\t\t}\n\t\tif (typeof this._provider.resolveDocumentLink !== 'function') {\n\t\t\t// no resolve -> no caching\n\t\t\treturn { links: links.filter(LinkProviderAdapter._validateLink).map(typeConvert.DocumentLink.from) };\n\n\t\t} else {\n\t\t\t// cache links for future resolving\n\t\t\tconst pid = this._cache.add(links);\n\t\t\tconst result: extHostProtocol.ILinksListDto = { links: [], cacheId: pid };\n\t\t\tfor (let i = 0; i < links.length; i++) {\n\n\t\t\t\tif (!LinkProviderAdapter._validateLink(links[i])) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst dto: extHostProtocol.ILinkDto = typeConvert.DocumentLink.from(links[i]);\n\t\t\t\tdto.cacheId = [pid, i];\n\t\t\t\tresult.links.push(dto);\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\t}\n\n\tprivate static _validateLink(link: vscode.DocumentLink): boolean {\n\t\tif (link.target && link.target.path.length > 50_000) {\n\t\t\tconsole.warn('DROPPING link because it is too long');\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tasync resolveLink(id: extHostProtocol.ChainedCacheId, token: CancellationToken): Promise<extHostProtocol.ILinkDto | undefined> {\n\t\tif (typeof this._provider.resolveDocumentLink !== 'function') {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst item = this._cache.get(...id);\n\t\tif (!item) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst link = await this._provider.resolveDocumentLink!(item, token);\n\t\tif (!link || !LinkProviderAdapter._validateLink(link)) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn typeConvert.DocumentLink.from(link);\n\t}\n\n\treleaseLinks(id: number): any {\n\t\tthis._cache.delete(id);\n\t}\n}\n\nclass ColorProviderAdapter {\n\n\tconstructor(\n\t\tprivate _documents: ExtHostDocuments,\n\t\tprivate _provider: vscode.DocumentColorProvider\n\t) { }\n\n\tasync provideColors(resource: URI, token: CancellationToken): Promise<extHostProtocol.IRawColorInfo[]> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst colors = await this._provider.provideDocumentColors(doc, token);\n\t\tif (!Array.isArray(colors)) {\n\t\t\treturn [];\n\t\t}\n\t\tconst colorInfos: extHostProtocol.IRawColorInfo[] = colors.map(ci => {\n\t\t\treturn {\n\t\t\t\tcolor: typeConvert.Color.from(ci.color),\n\t\t\t\trange: typeConvert.Range.from(ci.range)\n\t\t\t};\n\t\t});\n\t\treturn colorInfos;\n\t}\n\n\tasync provideColorPresentations(resource: URI, raw: extHostProtocol.IRawColorInfo, token: CancellationToken): Promise<languages.IColorPresentation[] | undefined> {\n\t\tconst document = this._documents.getDocument(resource);\n\t\tconst range = typeConvert.Range.to(raw.range);\n\t\tconst color = typeConvert.Color.to(raw.color);\n\t\tconst value = await this._provider.provideColorPresentations(color, { document, range }, token);\n\t\tif (!Array.isArray(value)) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn value.map(typeConvert.ColorPresentation.from);\n\t}\n}\n\nclass FoldingProviderAdapter {\n\n\tconstructor(\n\t\tprivate _documents: ExtHostDocuments,\n\t\tprivate _provider: vscode.FoldingRangeProvider\n\t) { }\n\n\tasync provideFoldingRanges(resource: URI, context: languages.FoldingContext, token: CancellationToken): Promise<languages.FoldingRange[] | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst ranges = await this._provider.provideFoldingRanges(doc, context, token);\n\t\tif (!Array.isArray(ranges)) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn ranges.map(typeConvert.FoldingRange.from);\n\t}\n}\n\nclass SelectionRangeAdapter {\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.SelectionRangeProvider,\n\t\tprivate readonly _logService: ILogService\n\t) { }\n\n\tasync provideSelectionRanges(resource: URI, pos: IPosition[], token: CancellationToken): Promise<languages.SelectionRange[][]> {\n\t\tconst document = this._documents.getDocument(resource);\n\t\tconst positions = pos.map(typeConvert.Position.to);\n\n\t\tconst allProviderRanges = await this._provider.provideSelectionRanges(document, positions, token);\n\t\tif (!isNonEmptyArray(allProviderRanges)) {\n\t\t\treturn [];\n\t\t}\n\t\tif (allProviderRanges.length !== positions.length) {\n\t\t\tthis._logService.warn('BAD selection ranges, provider must return ranges for each position');\n\t\t\treturn [];\n\t\t}\n\t\tconst allResults: languages.SelectionRange[][] = [];\n\t\tfor (let i = 0; i < positions.length; i++) {\n\t\t\tconst oneResult: languages.SelectionRange[] = [];\n\t\t\tallResults.push(oneResult);\n\n\t\t\tlet last: vscode.Position | vscode.Range = positions[i];\n\t\t\tlet selectionRange = allProviderRanges[i];\n\n\t\t\twhile (true) {\n\t\t\t\tif (!selectionRange.range.contains(last)) {\n\t\t\t\t\tthrow new Error('INVALID selection range, must contain the previous range');\n\t\t\t\t}\n\t\t\t\toneResult.push(typeConvert.SelectionRange.from(selectionRange));\n\t\t\t\tif (!selectionRange.parent) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tlast = selectionRange.range;\n\t\t\t\tselectionRange = selectionRange.parent;\n\t\t\t}\n\t\t}\n\t\treturn allResults;\n\t}\n}\n\nclass CallHierarchyAdapter {\n\n\tprivate readonly _idPool = new IdGenerator('');\n\tprivate readonly _cache = new Map<string, Map<string, vscode.CallHierarchyItem>>();\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.CallHierarchyProvider\n\t) { }\n\n\tasync prepareSession(uri: URI, position: IPosition, token: CancellationToken): Promise<extHostProtocol.ICallHierarchyItemDto[] | undefined> {\n\t\tconst doc = this._documents.getDocument(uri);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\tconst items = await this._provider.prepareCallHierarchy(doc, pos, token);\n\t\tif (!items) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst sessionId = this._idPool.nextId();\n\t\tthis._cache.set(sessionId, new Map());\n\n\t\tif (Array.isArray(items)) {\n\t\t\treturn items.map(item => this._cacheAndConvertItem(sessionId, item));\n\t\t} else {\n\t\t\treturn [this._cacheAndConvertItem(sessionId, items)];\n\t\t}\n\t}\n\n\tasync provideCallsTo(sessionId: string, itemId: string, token: CancellationToken): Promise<extHostProtocol.IIncomingCallDto[] | undefined> {\n\t\tconst item = this._itemFromCache(sessionId, itemId);\n\t\tif (!item) {\n\t\t\tthrow new Error('missing call hierarchy item');\n\t\t}\n\t\tconst calls = await this._provider.provideCallHierarchyIncomingCalls(item, token);\n\t\tif (!calls) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn calls.map(call => {\n\t\t\treturn {\n\t\t\t\tfrom: this._cacheAndConvertItem(sessionId, call.from),\n\t\t\t\tfromRanges: call.fromRanges.map(r => typeConvert.Range.from(r))\n\t\t\t};\n\t\t});\n\t}\n\n\tasync provideCallsFrom(sessionId: string, itemId: string, token: CancellationToken): Promise<extHostProtocol.IOutgoingCallDto[] | undefined> {\n\t\tconst item = this._itemFromCache(sessionId, itemId);\n\t\tif (!item) {\n\t\t\tthrow new Error('missing call hierarchy item');\n\t\t}\n\t\tconst calls = await this._provider.provideCallHierarchyOutgoingCalls(item, token);\n\t\tif (!calls) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn calls.map(call => {\n\t\t\treturn {\n\t\t\t\tto: this._cacheAndConvertItem(sessionId, call.to),\n\t\t\t\tfromRanges: call.fromRanges.map(r => typeConvert.Range.from(r))\n\t\t\t};\n\t\t});\n\t}\n\n\treleaseSession(sessionId: string): void {\n\t\tthis._cache.delete(sessionId);\n\t}\n\n\tprivate _cacheAndConvertItem(sessionId: string, item: vscode.CallHierarchyItem): extHostProtocol.ICallHierarchyItemDto {\n\t\tconst map = this._cache.get(sessionId)!;\n\t\tconst dto = typeConvert.CallHierarchyItem.from(item, sessionId, map.size.toString(36));\n\t\tmap.set(dto._itemId, item);\n\t\treturn dto;\n\t}\n\n\tprivate _itemFromCache(sessionId: string, itemId: string): vscode.CallHierarchyItem | undefined {\n\t\tconst map = this._cache.get(sessionId);\n\t\treturn map?.get(itemId);\n\t}\n}\n\nclass TypeHierarchyAdapter {\n\n\tprivate readonly _idPool = new IdGenerator('');\n\tprivate readonly _cache = new Map<string, Map<string, vscode.TypeHierarchyItem>>();\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.TypeHierarchyProvider\n\t) { }\n\n\tasync prepareSession(uri: URI, position: IPosition, token: CancellationToken): Promise<extHostProtocol.ITypeHierarchyItemDto[] | undefined> {\n\t\tconst doc = this._documents.getDocument(uri);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\tconst items = await this._provider.prepareTypeHierarchy(doc, pos, token);\n\t\tif (!items) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst sessionId = this._idPool.nextId();\n\t\tthis._cache.set(sessionId, new Map());\n\n\t\tif (Array.isArray(items)) {\n\t\t\treturn items.map(item => this._cacheAndConvertItem(sessionId, item));\n\t\t} else {\n\t\t\treturn [this._cacheAndConvertItem(sessionId, items)];\n\t\t}\n\t}\n\n\tasync provideSupertypes(sessionId: string, itemId: string, token: CancellationToken): Promise<extHostProtocol.ITypeHierarchyItemDto[] | undefined> {\n\t\tconst item = this._itemFromCache(sessionId, itemId);\n\t\tif (!item) {\n\t\t\tthrow new Error('missing type hierarchy item');\n\t\t}\n\t\tconst supertypes = await this._provider.provideTypeHierarchySupertypes(item, token);\n\t\tif (!supertypes) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn supertypes.map(supertype => {\n\t\t\treturn this._cacheAndConvertItem(sessionId, supertype);\n\t\t});\n\t}\n\n\tasync provideSubtypes(sessionId: string, itemId: string, token: CancellationToken): Promise<extHostProtocol.ITypeHierarchyItemDto[] | undefined> {\n\t\tconst item = this._itemFromCache(sessionId, itemId);\n\t\tif (!item) {\n\t\t\tthrow new Error('missing type hierarchy item');\n\t\t}\n\t\tconst subtypes = await this._provider.provideTypeHierarchySubtypes(item, token);\n\t\tif (!subtypes) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn subtypes.map(subtype => {\n\t\t\treturn this._cacheAndConvertItem(sessionId, subtype);\n\t\t});\n\t}\n\n\treleaseSession(sessionId: string): void {\n\t\tthis._cache.delete(sessionId);\n\t}\n\n\tprivate _cacheAndConvertItem(sessionId: string, item: vscode.TypeHierarchyItem): extHostProtocol.ITypeHierarchyItemDto {\n\t\tconst map = this._cache.get(sessionId)!;\n\t\tconst dto = typeConvert.TypeHierarchyItem.from(item, sessionId, map.size.toString(36));\n\t\tmap.set(dto._itemId, item);\n\t\treturn dto;\n\t}\n\n\tprivate _itemFromCache(sessionId: string, itemId: string): vscode.TypeHierarchyItem | undefined {\n\t\tconst map = this._cache.get(sessionId);\n\t\treturn map?.get(itemId);\n\t}\n}\n\nclass DocumentOnDropEditAdapter {\n\n\tconstructor(\n\t\tprivate readonly _proxy: extHostProtocol.MainThreadLanguageFeaturesShape,\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.DocumentDropEditProvider,\n\t\tprivate readonly _handle: number,\n\t) { }\n\n\tasync provideDocumentOnDropEdits(requestId: number, uri: URI, position: IPosition, dataTransferDto: extHostProtocol.DataTransferDTO, token: CancellationToken): Promise<extHostProtocol.IDocumentOnDropEditDto | undefined> {\n\t\tconst doc = this._documents.getDocument(uri);\n\t\tconst pos = typeConvert.Position.to(position);\n\t\tconst dataTransfer = typeConvert.DataTransfer.toDataTransfer(dataTransferDto, async (index) => {\n\t\t\treturn (await this._proxy.$resolveDocumentOnDropFileData(this._handle, requestId, index)).buffer;\n\t\t});\n\n\t\tconst edit = await this._provider.provideDocumentDropEdits(doc, pos, dataTransfer, token);\n\t\tif (!edit) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn {\n\t\t\tinsertText: typeof edit.insertText === 'string' ? edit.insertText : { snippet: edit.insertText.value },\n\t\t\tadditionalEdit: edit.additionalEdit ? typeConvert.WorkspaceEdit.from(edit.additionalEdit, undefined, true) : undefined,\n\t\t};\n\t}\n}\n\ntype Adapter = DocumentSymbolAdapter | CodeLensAdapter | DefinitionAdapter | HoverAdapter\n\t| DocumentHighlightAdapter | ReferenceAdapter | CodeActionAdapter | DocumentPasteEditProvider | DocumentFormattingAdapter\n\t| RangeFormattingAdapter | OnTypeFormattingAdapter | NavigateTypeAdapter | RenameAdapter\n\t| CompletionsAdapter | SignatureHelpAdapter | LinkProviderAdapter | ImplementationAdapter\n\t| TypeDefinitionAdapter | ColorProviderAdapter | FoldingProviderAdapter | DeclarationAdapter\n\t| SelectionRangeAdapter | CallHierarchyAdapter | TypeHierarchyAdapter\n\t| DocumentSemanticTokensAdapter | DocumentRangeSemanticTokensAdapter\n\t| EvaluatableExpressionAdapter | InlineValuesAdapter\n\t| LinkedEditingRangeAdapter | InlayHintsAdapter | InlineCompletionAdapter | InlineCompletionAdapterNew\n\t| DocumentOnDropEditAdapter;\n\nclass AdapterData {\n\tconstructor(\n\t\treadonly adapter: Adapter,\n\t\treadonly extension: IExtensionDescription\n\t) { }\n}\n\nexport class ExtHostLanguageFeatures implements extHostProtocol.ExtHostLanguageFeaturesShape {\n\n\tprivate static _handlePool: number = 0;\n\n\tprivate readonly _uriTransformer: IURITransformer;\n\tprivate readonly _proxy: extHostProtocol.MainThreadLanguageFeaturesShape;\n\tprivate readonly _documents: ExtHostDocuments;\n\tprivate readonly _commands: ExtHostCommands;\n\tprivate readonly _diagnostics: ExtHostDiagnostics;\n\tprivate readonly _adapter = new Map<number, AdapterData>();\n\tprivate readonly _logService: ILogService;\n\tprivate readonly _apiDeprecation: IExtHostApiDeprecationService;\n\n\tconstructor(\n\t\tmainContext: extHostProtocol.IMainContext,\n\t\turiTransformer: IURITransformer,\n\t\tdocuments: ExtHostDocuments,\n\t\tcommands: ExtHostCommands,\n\t\tdiagnostics: ExtHostDiagnostics,\n\t\tlogService: ILogService,\n\t\tapiDeprecationService: IExtHostApiDeprecationService,\n\t) {\n\t\tthis._uriTransformer = uriTransformer;\n\t\tthis._proxy = mainContext.getProxy(extHostProtocol.MainContext.MainThreadLanguageFeatures);\n\t\tthis._documents = documents;\n\t\tthis._commands = commands;\n\t\tthis._diagnostics = diagnostics;\n\t\tthis._logService = logService;\n\t\tthis._apiDeprecation = apiDeprecationService;\n\t}\n\n\tprivate _transformDocumentSelector(selector: vscode.DocumentSelector): Array<extHostProtocol.IDocumentFilterDto> {\n\t\treturn typeConvert.DocumentSelector.from(selector, this._uriTransformer);\n\t}\n\n\tprivate _createDisposable(handle: number): Disposable {\n\t\treturn new Disposable(() => {\n\t\t\tthis._adapter.delete(handle);\n\t\t\tthis._proxy.$unregister(handle);\n\t\t});\n\t}\n\n\tprivate _nextHandle(): number {\n\t\treturn ExtHostLanguageFeatures._handlePool++;\n\t}\n\n\tprivate async _withAdapter<A, R>(\n\t\thandle: number,\n\t\tctor: { new(...args: any[]): A },\n\t\tcallback: (adapter: A, extension: IExtensionDescription) => Promise<R>,\n\t\tfallbackValue: R,\n\t\ttokenToRaceAgainst: CancellationToken | undefined,\n\t\tdoNotLog: boolean = false\n\t): Promise<R> {\n\t\tconst data = this._adapter.get(handle);\n\t\tif (!data || !(data.adapter instanceof ctor)) {\n\t\t\treturn fallbackValue;\n\t\t}\n\n\t\tconst t1: number = Date.now();\n\t\tif (!doNotLog) {\n\t\t\tthis._logService.trace(`[${data.extension.identifier.value}] INVOKE provider '${callback.toString().replace(/[\\r\\n]/g, '')}'`);\n\t\t}\n\n\t\tconst result = callback(data.adapter, data.extension);\n\n\t\t// logging,tracing\n\t\tPromise.resolve(result).catch(err => {\n\t\t\tif (!isCancellationError(err)) {\n\t\t\t\tthis._logService.error(`[${data.extension.identifier.value}] provider FAILED`);\n\t\t\t\tthis._logService.error(err);\n\t\t\t}\n\t\t}).finally(() => {\n\t\t\tif (!doNotLog) {\n\t\t\t\tthis._logService.trace(`[${data.extension.identifier.value}] provider DONE after ${Date.now() - t1}ms`);\n\t\t\t}\n\t\t});\n\n\t\tif (CancellationToken.isCancellationToken(tokenToRaceAgainst)) {\n\t\t\treturn raceCancellationError(result, tokenToRaceAgainst);\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate _addNewAdapter(adapter: Adapter, extension: IExtensionDescription): number {\n\t\tconst handle = this._nextHandle();\n\t\tthis._adapter.set(handle, new AdapterData(adapter, extension));\n\t\treturn handle;\n\t}\n\n\tprivate static _extLabel(ext: IExtensionDescription): string {\n\t\treturn ext.displayName || ext.name;\n\t}\n\n\t// --- outline\n\n\tregisterDocumentSymbolProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.DocumentSymbolProvider, metadata?: vscode.DocumentSymbolProviderMetadata): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new DocumentSymbolAdapter(this._documents, provider), extension);\n\t\tconst displayName = (metadata && metadata.label) || ExtHostLanguageFeatures._extLabel(extension);\n\t\tthis._proxy.$registerDocumentSymbolProvider(handle, this._transformDocumentSelector(selector), displayName);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideDocumentSymbols(handle: number, resource: UriComponents, token: CancellationToken): Promise<languages.DocumentSymbol[] | undefined> {\n\t\treturn this._withAdapter(handle, DocumentSymbolAdapter, adapter => adapter.provideDocumentSymbols(URI.revive(resource), token), undefined, token);\n\t}\n\n\t// --- code lens\n\n\tregisterCodeLensProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.CodeLensProvider): vscode.Disposable {\n\t\tconst handle = this._nextHandle();\n\t\tconst eventHandle = typeof provider.onDidChangeCodeLenses === 'function' ? this._nextHandle() : undefined;\n\n\t\tthis._adapter.set(handle, new AdapterData(new CodeLensAdapter(this._documents, this._commands.converter, provider), extension));\n\t\tthis._proxy.$registerCodeLensSupport(handle, this._transformDocumentSelector(selector), eventHandle);\n\t\tlet result = this._createDisposable(handle);\n\n\t\tif (eventHandle !== undefined) {\n\t\t\tconst subscription = provider.onDidChangeCodeLenses!(_ => this._proxy.$emitCodeLensEvent(eventHandle));\n\t\t\tresult = Disposable.from(result, subscription);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t$provideCodeLenses(handle: number, resource: UriComponents, token: CancellationToken): Promise<extHostProtocol.ICodeLensListDto | undefined> {\n\t\treturn this._withAdapter(handle, CodeLensAdapter, adapter => adapter.provideCodeLenses(URI.revive(resource), token), undefined, token);\n\t}\n\n\t$resolveCodeLens(handle: number, symbol: extHostProtocol.ICodeLensDto, token: CancellationToken): Promise<extHostProtocol.ICodeLensDto | undefined> {\n\t\treturn this._withAdapter(handle, CodeLensAdapter, adapter => adapter.resolveCodeLens(symbol, token), undefined, undefined);\n\t}\n\n\t$releaseCodeLenses(handle: number, cacheId: number): void {\n\t\tthis._withAdapter(handle, CodeLensAdapter, adapter => Promise.resolve(adapter.releaseCodeLenses(cacheId)), undefined, undefined);\n\t}\n\n\t// --- declaration\n\n\tregisterDefinitionProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.DefinitionProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new DefinitionAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerDefinitionSupport(handle, this._transformDocumentSelector(selector));\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideDefinition(handle: number, resource: UriComponents, position: IPosition, token: CancellationToken): Promise<languages.LocationLink[]> {\n\t\treturn this._withAdapter(handle, DefinitionAdapter, adapter => adapter.provideDefinition(URI.revive(resource), position, token), [], token);\n\t}\n\n\tregisterDeclarationProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.DeclarationProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new DeclarationAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerDeclarationSupport(handle, this._transformDocumentSelector(selector));\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideDeclaration(handle: number, resource: UriComponents, position: IPosition, token: CancellationToken): Promise<languages.LocationLink[]> {\n\t\treturn this._withAdapter(handle, DeclarationAdapter, adapter => adapter.provideDeclaration(URI.revive(resource), position, token), [], token);\n\t}\n\n\tregisterImplementationProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.ImplementationProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new ImplementationAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerImplementationSupport(handle, this._transformDocumentSelector(selector));\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideImplementation(handle: number, resource: UriComponents, position: IPosition, token: CancellationToken): Promise<languages.LocationLink[]> {\n\t\treturn this._withAdapter(handle, ImplementationAdapter, adapter => adapter.provideImplementation(URI.revive(resource), position, token), [], token);\n\t}\n\n\tregisterTypeDefinitionProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.TypeDefinitionProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new TypeDefinitionAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerTypeDefinitionSupport(handle, this._transformDocumentSelector(selector));\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideTypeDefinition(handle: number, resource: UriComponents, position: IPosition, token: CancellationToken): Promise<languages.LocationLink[]> {\n\t\treturn this._withAdapter(handle, TypeDefinitionAdapter, adapter => adapter.provideTypeDefinition(URI.revive(resource), position, token), [], token);\n\t}\n\n\t// --- extra info\n\n\tregisterHoverProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.HoverProvider, extensionId?: ExtensionIdentifier): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new HoverAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerHoverProvider(handle, this._transformDocumentSelector(selector));\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideHover(handle: number, resource: UriComponents, position: IPosition, token: CancellationToken): Promise<languages.Hover | undefined> {\n\t\treturn this._withAdapter(handle, HoverAdapter, adapter => adapter.provideHover(URI.revive(resource), position, token), undefined, token);\n\t}\n\n\t// --- debug hover\n\n\tregisterEvaluatableExpressionProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.EvaluatableExpressionProvider, extensionId?: ExtensionIdentifier): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new EvaluatableExpressionAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerEvaluatableExpressionProvider(handle, this._transformDocumentSelector(selector));\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideEvaluatableExpression(handle: number, resource: UriComponents, position: IPosition, token: CancellationToken): Promise<languages.EvaluatableExpression | undefined> {\n\t\treturn this._withAdapter(handle, EvaluatableExpressionAdapter, adapter => adapter.provideEvaluatableExpression(URI.revive(resource), position, token), undefined, token);\n\t}\n\n\t// --- debug inline values\n\n\tregisterInlineValuesProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.InlineValuesProvider, extensionId?: ExtensionIdentifier): vscode.Disposable {\n\n\t\tconst eventHandle = typeof provider.onDidChangeInlineValues === 'function' ? this._nextHandle() : undefined;\n\t\tconst handle = this._addNewAdapter(new InlineValuesAdapter(this._documents, provider), extension);\n\n\t\tthis._proxy.$registerInlineValuesProvider(handle, this._transformDocumentSelector(selector), eventHandle);\n\t\tlet result = this._createDisposable(handle);\n\n\t\tif (eventHandle !== undefined) {\n\t\t\tconst subscription = provider.onDidChangeInlineValues!(_ => this._proxy.$emitInlineValuesEvent(eventHandle));\n\t\t\tresult = Disposable.from(result, subscription);\n\t\t}\n\t\treturn result;\n\t}\n\n\t$provideInlineValues(handle: number, resource: UriComponents, range: IRange, context: extHostProtocol.IInlineValueContextDto, token: CancellationToken): Promise<languages.InlineValue[] | undefined> {\n\t\treturn this._withAdapter(handle, InlineValuesAdapter, adapter => adapter.provideInlineValues(URI.revive(resource), range, context, token), undefined, token);\n\t}\n\n\t// --- occurrences\n\n\tregisterDocumentHighlightProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.DocumentHighlightProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new DocumentHighlightAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerDocumentHighlightProvider(handle, this._transformDocumentSelector(selector));\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideDocumentHighlights(handle: number, resource: UriComponents, position: IPosition, token: CancellationToken): Promise<languages.DocumentHighlight[] | undefined> {\n\t\treturn this._withAdapter(handle, DocumentHighlightAdapter, adapter => adapter.provideDocumentHighlights(URI.revive(resource), position, token), undefined, token);\n\t}\n\n\t// --- linked editing\n\n\tregisterLinkedEditingRangeProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.LinkedEditingRangeProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new LinkedEditingRangeAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerLinkedEditingRangeProvider(handle, this._transformDocumentSelector(selector));\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideLinkedEditingRanges(handle: number, resource: UriComponents, position: IPosition, token: CancellationToken): Promise<extHostProtocol.ILinkedEditingRangesDto | undefined> {\n\t\treturn this._withAdapter(handle, LinkedEditingRangeAdapter, async adapter => {\n\t\t\tconst res = await adapter.provideLinkedEditingRanges(URI.revive(resource), position, token);\n\t\t\tif (res) {\n\t\t\t\treturn {\n\t\t\t\t\tranges: res.ranges,\n\t\t\t\t\twordPattern: res.wordPattern ? ExtHostLanguageFeatures._serializeRegExp(res.wordPattern) : undefined\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn undefined;\n\t\t}, undefined, token);\n\t}\n\n\t// --- references\n\n\tregisterReferenceProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.ReferenceProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new ReferenceAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerReferenceSupport(handle, this._transformDocumentSelector(selector));\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideReferences(handle: number, resource: UriComponents, position: IPosition, context: languages.ReferenceContext, token: CancellationToken): Promise<languages.Location[] | undefined> {\n\t\treturn this._withAdapter(handle, ReferenceAdapter, adapter => adapter.provideReferences(URI.revive(resource), position, context, token), undefined, token);\n\t}\n\n\t// --- quick fix\n\n\tregisterCodeActionProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.CodeActionProvider, metadata?: vscode.CodeActionProviderMetadata): vscode.Disposable {\n\t\tconst store = new DisposableStore();\n\t\tconst handle = this._addNewAdapter(new CodeActionAdapter(this._documents, this._commands.converter, this._diagnostics, provider, this._logService, extension, this._apiDeprecation), extension);\n\t\tthis._proxy.$registerQuickFixSupport(handle, this._transformDocumentSelector(selector), {\n\t\t\tprovidedKinds: metadata?.providedCodeActionKinds?.map(kind => kind.value),\n\t\t\tdocumentation: metadata?.documentation?.map(x => ({\n\t\t\t\tkind: x.kind.value,\n\t\t\t\tcommand: this._commands.converter.toInternal(x.command, store),\n\t\t\t}))\n\t\t}, ExtHostLanguageFeatures._extLabel(extension), Boolean(provider.resolveCodeAction));\n\t\tstore.add(this._createDisposable(handle));\n\t\treturn store;\n\t}\n\n\n\t$provideCodeActions(handle: number, resource: UriComponents, rangeOrSelection: IRange | ISelection, context: languages.CodeActionContext, token: CancellationToken): Promise<extHostProtocol.ICodeActionListDto | undefined> {\n\t\treturn this._withAdapter(handle, CodeActionAdapter, adapter => adapter.provideCodeActions(URI.revive(resource), rangeOrSelection, context, token), undefined, token);\n\t}\n\n\t$resolveCodeAction(handle: number, id: extHostProtocol.ChainedCacheId, token: CancellationToken): Promise<extHostProtocol.IWorkspaceEditDto | undefined> {\n\t\treturn this._withAdapter(handle, CodeActionAdapter, adapter => adapter.resolveCodeAction(id, token), undefined, undefined);\n\t}\n\n\t$releaseCodeActions(handle: number, cacheId: number): void {\n\t\tthis._withAdapter(handle, CodeActionAdapter, adapter => Promise.resolve(adapter.releaseCodeActions(cacheId)), undefined, undefined);\n\t}\n\n\t// --- formatting\n\n\tregisterDocumentFormattingEditProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.DocumentFormattingEditProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new DocumentFormattingAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerDocumentFormattingSupport(handle, this._transformDocumentSelector(selector), extension.identifier, extension.displayName || extension.name);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideDocumentFormattingEdits(handle: number, resource: UriComponents, options: languages.FormattingOptions, token: CancellationToken): Promise<ISingleEditOperation[] | undefined> {\n\t\treturn this._withAdapter(handle, DocumentFormattingAdapter, adapter => adapter.provideDocumentFormattingEdits(URI.revive(resource), options, token), undefined, token);\n\t}\n\n\tregisterDocumentRangeFormattingEditProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.DocumentRangeFormattingEditProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new RangeFormattingAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerRangeFormattingSupport(handle, this._transformDocumentSelector(selector), extension.identifier, extension.displayName || extension.name);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideDocumentRangeFormattingEdits(handle: number, resource: UriComponents, range: IRange, options: languages.FormattingOptions, token: CancellationToken): Promise<ISingleEditOperation[] | undefined> {\n\t\treturn this._withAdapter(handle, RangeFormattingAdapter, adapter => adapter.provideDocumentRangeFormattingEdits(URI.revive(resource), range, options, token), undefined, token);\n\t}\n\n\tregisterOnTypeFormattingEditProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.OnTypeFormattingEditProvider, triggerCharacters: string[]): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new OnTypeFormattingAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerOnTypeFormattingSupport(handle, this._transformDocumentSelector(selector), triggerCharacters, extension.identifier);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideOnTypeFormattingEdits(handle: number, resource: UriComponents, position: IPosition, ch: string, options: languages.FormattingOptions, token: CancellationToken): Promise<ISingleEditOperation[] | undefined> {\n\t\treturn this._withAdapter(handle, OnTypeFormattingAdapter, adapter => adapter.provideOnTypeFormattingEdits(URI.revive(resource), position, ch, options, token), undefined, token);\n\t}\n\n\t// --- navigate types\n\n\tregisterWorkspaceSymbolProvider(extension: IExtensionDescription, provider: vscode.WorkspaceSymbolProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new NavigateTypeAdapter(provider, this._logService), extension);\n\t\tthis._proxy.$registerNavigateTypeSupport(handle, typeof provider.resolveWorkspaceSymbol === 'function');\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideWorkspaceSymbols(handle: number, search: string, token: CancellationToken): Promise<extHostProtocol.IWorkspaceSymbolsDto> {\n\t\treturn this._withAdapter(handle, NavigateTypeAdapter, adapter => adapter.provideWorkspaceSymbols(search, token), { symbols: [] }, token);\n\t}\n\n\t$resolveWorkspaceSymbol(handle: number, symbol: extHostProtocol.IWorkspaceSymbolDto, token: CancellationToken): Promise<extHostProtocol.IWorkspaceSymbolDto | undefined> {\n\t\treturn this._withAdapter(handle, NavigateTypeAdapter, adapter => adapter.resolveWorkspaceSymbol(symbol, token), undefined, undefined);\n\t}\n\n\t$releaseWorkspaceSymbols(handle: number, id: number): void {\n\t\tthis._withAdapter(handle, NavigateTypeAdapter, adapter => adapter.releaseWorkspaceSymbols(id), undefined, undefined);\n\t}\n\n\t// --- rename\n\n\tregisterRenameProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.RenameProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new RenameAdapter(this._documents, provider, this._logService), extension);\n\t\tthis._proxy.$registerRenameSupport(handle, this._transformDocumentSelector(selector), RenameAdapter.supportsResolving(provider));\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideRenameEdits(handle: number, resource: UriComponents, position: IPosition, newName: string, token: CancellationToken): Promise<extHostProtocol.IWorkspaceEditDto | undefined> {\n\t\treturn this._withAdapter(handle, RenameAdapter, adapter => adapter.provideRenameEdits(URI.revive(resource), position, newName, token), undefined, token);\n\t}\n\n\t$resolveRenameLocation(handle: number, resource: URI, position: IPosition, token: CancellationToken): Promise<languages.RenameLocation | undefined> {\n\t\treturn this._withAdapter(handle, RenameAdapter, adapter => adapter.resolveRenameLocation(URI.revive(resource), position, token), undefined, token);\n\t}\n\n\t//#region semantic coloring\n\n\tregisterDocumentSemanticTokensProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.DocumentSemanticTokensProvider, legend: vscode.SemanticTokensLegend): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new DocumentSemanticTokensAdapter(this._documents, provider), extension);\n\t\tconst eventHandle = (typeof provider.onDidChangeSemanticTokens === 'function' ? this._nextHandle() : undefined);\n\t\tthis._proxy.$registerDocumentSemanticTokensProvider(handle, this._transformDocumentSelector(selector), legend, eventHandle);\n\t\tlet result = this._createDisposable(handle);\n\n\t\tif (eventHandle) {\n\t\t\tconst subscription = provider.onDidChangeSemanticTokens!(_ => this._proxy.$emitDocumentSemanticTokensEvent(eventHandle));\n\t\t\tresult = Disposable.from(result, subscription);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t$provideDocumentSemanticTokens(handle: number, resource: UriComponents, previousResultId: number, token: CancellationToken): Promise<VSBuffer | null> {\n\t\treturn this._withAdapter(handle, DocumentSemanticTokensAdapter, adapter => adapter.provideDocumentSemanticTokens(URI.revive(resource), previousResultId, token), null, token);\n\t}\n\n\t$releaseDocumentSemanticTokens(handle: number, semanticColoringResultId: number): void {\n\t\tthis._withAdapter(handle, DocumentSemanticTokensAdapter, adapter => adapter.releaseDocumentSemanticColoring(semanticColoringResultId), undefined, undefined);\n\t}\n\n\tregisterDocumentRangeSemanticTokensProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.DocumentRangeSemanticTokensProvider, legend: vscode.SemanticTokensLegend): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new DocumentRangeSemanticTokensAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerDocumentRangeSemanticTokensProvider(handle, this._transformDocumentSelector(selector), legend);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideDocumentRangeSemanticTokens(handle: number, resource: UriComponents, range: IRange, token: CancellationToken): Promise<VSBuffer | null> {\n\t\treturn this._withAdapter(handle, DocumentRangeSemanticTokensAdapter, adapter => adapter.provideDocumentRangeSemanticTokens(URI.revive(resource), range, token), null, token);\n\t}\n\n\t//#endregion\n\n\t// --- suggestion\n\n\tregisterCompletionItemProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.CompletionItemProvider, triggerCharacters: string[]): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new CompletionsAdapter(this._documents, this._commands.converter, provider, this._apiDeprecation, extension), extension);\n\t\tthis._proxy.$registerCompletionsProvider(handle, this._transformDocumentSelector(selector), triggerCharacters, CompletionsAdapter.supportsResolving(provider), `${extension.identifier.value}(${triggerCharacters.join('')})`);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideCompletionItems(handle: number, resource: UriComponents, position: IPosition, context: languages.CompletionContext, token: CancellationToken): Promise<extHostProtocol.ISuggestResultDto | undefined> {\n\t\treturn this._withAdapter(handle, CompletionsAdapter, adapter => adapter.provideCompletionItems(URI.revive(resource), position, context, token), undefined, token);\n\t}\n\n\t$resolveCompletionItem(handle: number, id: extHostProtocol.ChainedCacheId, token: CancellationToken): Promise<extHostProtocol.ISuggestDataDto | undefined> {\n\t\treturn this._withAdapter(handle, CompletionsAdapter, adapter => adapter.resolveCompletionItem(id, token), undefined, token);\n\t}\n\n\t$releaseCompletionItems(handle: number, id: number): void {\n\t\tthis._withAdapter(handle, CompletionsAdapter, adapter => adapter.releaseCompletionItems(id), undefined, undefined);\n\t}\n\n\t// --- ghost test\n\n\tregisterInlineCompletionsProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.InlineCompletionItemProvider): vscode.Disposable {\n\t\tconst adapter = new InlineCompletionAdapter(extension, this._documents, provider, this._commands.converter);\n\t\tconst handle = this._addNewAdapter(adapter, extension);\n\t\tthis._proxy.$registerInlineCompletionsSupport(handle, this._transformDocumentSelector(selector), adapter.supportsHandleDidShowCompletionItem);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\tregisterInlineCompletionsProviderNew(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.InlineCompletionItemProviderNew): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new InlineCompletionAdapterNew(extension, this._documents, provider, this._commands.converter), extension);\n\t\tthis._proxy.$registerInlineCompletionsSupport(handle, this._transformDocumentSelector(selector), true);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideInlineCompletions(handle: number, resource: UriComponents, position: IPosition, context: languages.InlineCompletionContext, token: CancellationToken): Promise<extHostProtocol.IdentifiableInlineCompletions | undefined> {\n\t\treturn this._withAdapter(handle, InlineCompletionAdapterBase, adapter => adapter.provideInlineCompletions(URI.revive(resource), position, context, token), undefined, token);\n\t}\n\n\t$handleInlineCompletionDidShow(handle: number, pid: number, idx: number): void {\n\t\tthis._withAdapter(handle, InlineCompletionAdapterBase, async adapter => {\n\t\t\tadapter.handleDidShowCompletionItem(pid, idx);\n\t\t}, undefined, undefined);\n\t}\n\n\t$freeInlineCompletionsList(handle: number, pid: number): void {\n\t\tthis._withAdapter(handle, InlineCompletionAdapterBase, async adapter => { adapter.disposeCompletions(pid); }, undefined, undefined);\n\t}\n\n\t// --- parameter hints\n\n\tregisterSignatureHelpProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.SignatureHelpProvider, metadataOrTriggerChars: string[] | vscode.SignatureHelpProviderMetadata): vscode.Disposable {\n\t\tconst metadata: extHostProtocol.ISignatureHelpProviderMetadataDto | undefined = Array.isArray(metadataOrTriggerChars)\n\t\t\t? { triggerCharacters: metadataOrTriggerChars, retriggerCharacters: [] }\n\t\t\t: metadataOrTriggerChars;\n\n\t\tconst handle = this._addNewAdapter(new SignatureHelpAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerSignatureHelpProvider(handle, this._transformDocumentSelector(selector), metadata);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideSignatureHelp(handle: number, resource: UriComponents, position: IPosition, context: extHostProtocol.ISignatureHelpContextDto, token: CancellationToken): Promise<extHostProtocol.ISignatureHelpDto | undefined> {\n\t\treturn this._withAdapter(handle, SignatureHelpAdapter, adapter => adapter.provideSignatureHelp(URI.revive(resource), position, context, token), undefined, token);\n\t}\n\n\t$releaseSignatureHelp(handle: number, id: number): void {\n\t\tthis._withAdapter(handle, SignatureHelpAdapter, adapter => adapter.releaseSignatureHelp(id), undefined, undefined);\n\t}\n\n\t// --- inline hints\n\n\tregisterInlayHintsProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.InlayHintsProvider): vscode.Disposable {\n\n\t\tconst eventHandle = typeof provider.onDidChangeInlayHints === 'function' ? this._nextHandle() : undefined;\n\t\tconst handle = this._addNewAdapter(new InlayHintsAdapter(this._documents, this._commands.converter, provider, this._logService, extension), extension);\n\n\t\tthis._proxy.$registerInlayHintsProvider(handle, this._transformDocumentSelector(selector), typeof provider.resolveInlayHint === 'function', eventHandle, ExtHostLanguageFeatures._extLabel(extension));\n\t\tlet result = this._createDisposable(handle);\n\n\t\tif (eventHandle !== undefined) {\n\t\t\tconst subscription = provider.onDidChangeInlayHints!(uri => this._proxy.$emitInlayHintsEvent(eventHandle));\n\t\t\tresult = Disposable.from(result, subscription);\n\t\t}\n\t\treturn result;\n\t}\n\n\t$provideInlayHints(handle: number, resource: UriComponents, range: IRange, token: CancellationToken): Promise<extHostProtocol.IInlayHintsDto | undefined> {\n\t\treturn this._withAdapter(handle, InlayHintsAdapter, adapter => adapter.provideInlayHints(URI.revive(resource), range, token), undefined, token);\n\t}\n\n\t$resolveInlayHint(handle: number, id: extHostProtocol.ChainedCacheId, token: CancellationToken): Promise<extHostProtocol.IInlayHintDto | undefined> {\n\t\treturn this._withAdapter(handle, InlayHintsAdapter, adapter => adapter.resolveInlayHint(id, token), undefined, token);\n\t}\n\n\t$releaseInlayHints(handle: number, id: number): void {\n\t\tthis._withAdapter(handle, InlayHintsAdapter, adapter => adapter.releaseHints(id), undefined, undefined);\n\t}\n\n\t// --- links\n\n\tregisterDocumentLinkProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.DocumentLinkProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new LinkProviderAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerDocumentLinkProvider(handle, this._transformDocumentSelector(selector), typeof provider.resolveDocumentLink === 'function');\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideDocumentLinks(handle: number, resource: UriComponents, token: CancellationToken): Promise<extHostProtocol.ILinksListDto | undefined> {\n\t\treturn this._withAdapter(handle, LinkProviderAdapter, adapter => adapter.provideLinks(URI.revive(resource), token), undefined, token, resource.scheme === 'output');\n\t}\n\n\t$resolveDocumentLink(handle: number, id: extHostProtocol.ChainedCacheId, token: CancellationToken): Promise<extHostProtocol.ILinkDto | undefined> {\n\t\treturn this._withAdapter(handle, LinkProviderAdapter, adapter => adapter.resolveLink(id, token), undefined, undefined, true);\n\t}\n\n\t$releaseDocumentLinks(handle: number, id: number): void {\n\t\tthis._withAdapter(handle, LinkProviderAdapter, adapter => adapter.releaseLinks(id), undefined, undefined, true);\n\t}\n\n\tregisterColorProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.DocumentColorProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new ColorProviderAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerDocumentColorProvider(handle, this._transformDocumentSelector(selector));\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideDocumentColors(handle: number, resource: UriComponents, token: CancellationToken): Promise<extHostProtocol.IRawColorInfo[]> {\n\t\treturn this._withAdapter(handle, ColorProviderAdapter, adapter => adapter.provideColors(URI.revive(resource), token), [], token);\n\t}\n\n\t$provideColorPresentations(handle: number, resource: UriComponents, colorInfo: extHostProtocol.IRawColorInfo, token: CancellationToken): Promise<languages.IColorPresentation[] | undefined> {\n\t\treturn this._withAdapter(handle, ColorProviderAdapter, adapter => adapter.provideColorPresentations(URI.revive(resource), colorInfo, token), undefined, token);\n\t}\n\n\tregisterFoldingRangeProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.FoldingRangeProvider): vscode.Disposable {\n\t\tconst handle = this._nextHandle();\n\t\tconst eventHandle = typeof provider.onDidChangeFoldingRanges === 'function' ? this._nextHandle() : undefined;\n\n\t\tthis._adapter.set(handle, new AdapterData(new FoldingProviderAdapter(this._documents, provider), extension));\n\t\tthis._proxy.$registerFoldingRangeProvider(handle, this._transformDocumentSelector(selector), eventHandle);\n\t\tlet result = this._createDisposable(handle);\n\n\t\tif (eventHandle !== undefined) {\n\t\t\tconst subscription = provider.onDidChangeFoldingRanges!(() => this._proxy.$emitFoldingRangeEvent(eventHandle));\n\t\t\tresult = Disposable.from(result, subscription);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t$provideFoldingRanges(handle: number, resource: UriComponents, context: vscode.FoldingContext, token: CancellationToken): Promise<languages.FoldingRange[] | undefined> {\n\t\treturn this._withAdapter(handle, FoldingProviderAdapter, adapter => adapter.provideFoldingRanges(URI.revive(resource), context, token), undefined, token);\n\t}\n\n\t// --- smart select\n\n\tregisterSelectionRangeProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.SelectionRangeProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new SelectionRangeAdapter(this._documents, provider, this._logService), extension);\n\t\tthis._proxy.$registerSelectionRangeProvider(handle, this._transformDocumentSelector(selector));\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideSelectionRanges(handle: number, resource: UriComponents, positions: IPosition[], token: CancellationToken): Promise<languages.SelectionRange[][]> {\n\t\treturn this._withAdapter(handle, SelectionRangeAdapter, adapter => adapter.provideSelectionRanges(URI.revive(resource), positions, token), [], token);\n\t}\n\n\t// --- call hierarchy\n\n\tregisterCallHierarchyProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.CallHierarchyProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new CallHierarchyAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerCallHierarchyProvider(handle, this._transformDocumentSelector(selector));\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$prepareCallHierarchy(handle: number, resource: UriComponents, position: IPosition, token: CancellationToken): Promise<extHostProtocol.ICallHierarchyItemDto[] | undefined> {\n\t\treturn this._withAdapter(handle, CallHierarchyAdapter, adapter => Promise.resolve(adapter.prepareSession(URI.revive(resource), position, token)), undefined, token);\n\t}\n\n\t$provideCallHierarchyIncomingCalls(handle: number, sessionId: string, itemId: string, token: CancellationToken): Promise<extHostProtocol.IIncomingCallDto[] | undefined> {\n\t\treturn this._withAdapter(handle, CallHierarchyAdapter, adapter => adapter.provideCallsTo(sessionId, itemId, token), undefined, token);\n\t}\n\n\t$provideCallHierarchyOutgoingCalls(handle: number, sessionId: string, itemId: string, token: CancellationToken): Promise<extHostProtocol.IOutgoingCallDto[] | undefined> {\n\t\treturn this._withAdapter(handle, CallHierarchyAdapter, adapter => adapter.provideCallsFrom(sessionId, itemId, token), undefined, token);\n\t}\n\n\t$releaseCallHierarchy(handle: number, sessionId: string): void {\n\t\tthis._withAdapter(handle, CallHierarchyAdapter, adapter => Promise.resolve(adapter.releaseSession(sessionId)), undefined, undefined);\n\t}\n\n\t// --- type hierarchy\n\tregisterTypeHierarchyProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.TypeHierarchyProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new TypeHierarchyAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerTypeHierarchyProvider(handle, this._transformDocumentSelector(selector));\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$prepareTypeHierarchy(handle: number, resource: UriComponents, position: IPosition, token: CancellationToken): Promise<extHostProtocol.ITypeHierarchyItemDto[] | undefined> {\n\t\treturn this._withAdapter(handle, TypeHierarchyAdapter, adapter => Promise.resolve(adapter.prepareSession(URI.revive(resource), position, token)), undefined, token);\n\t}\n\n\t$provideTypeHierarchySupertypes(handle: number, sessionId: string, itemId: string, token: CancellationToken): Promise<extHostProtocol.ITypeHierarchyItemDto[] | undefined> {\n\t\treturn this._withAdapter(handle, TypeHierarchyAdapter, adapter => adapter.provideSupertypes(sessionId, itemId, token), undefined, token);\n\t}\n\n\t$provideTypeHierarchySubtypes(handle: number, sessionId: string, itemId: string, token: CancellationToken): Promise<extHostProtocol.ITypeHierarchyItemDto[] | undefined> {\n\t\treturn this._withAdapter(handle, TypeHierarchyAdapter, adapter => adapter.provideSubtypes(sessionId, itemId, token), undefined, token);\n\t}\n\n\t$releaseTypeHierarchy(handle: number, sessionId: string): void {\n\t\tthis._withAdapter(handle, TypeHierarchyAdapter, adapter => Promise.resolve(adapter.releaseSession(sessionId)), undefined, undefined);\n\t}\n\n\t// --- Document on drop\n\n\tregisterDocumentOnDropEditProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.DocumentDropEditProvider) {\n\t\tconst handle = this._nextHandle();\n\t\tthis._adapter.set(handle, new AdapterData(new DocumentOnDropEditAdapter(this._proxy, this._documents, provider, handle), extension));\n\t\tthis._proxy.$registerDocumentOnDropEditProvider(handle, this._transformDocumentSelector(selector));\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideDocumentOnDropEdits(handle: number, requestId: number, resource: UriComponents, position: IPosition, dataTransferDto: extHostProtocol.DataTransferDTO, token: CancellationToken): Promise<extHostProtocol.IDocumentOnDropEditDto | undefined> {\n\t\treturn this._withAdapter(handle, DocumentOnDropEditAdapter, adapter =>\n\t\t\tPromise.resolve(adapter.provideDocumentOnDropEdits(requestId, URI.revive(resource), position, dataTransferDto, token)), undefined, undefined);\n\t}\n\n\t// --- copy/paste actions\n\n\tregisterDocumentPasteEditProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.DocumentPasteEditProvider, metadata: vscode.DocumentPasteProviderMetadata): vscode.Disposable {\n\t\tconst handle = this._nextHandle();\n\t\tthis._adapter.set(handle, new AdapterData(new DocumentPasteEditProvider(this._proxy, this._documents, provider, handle), extension));\n\t\tthis._proxy.$registerPasteEditProvider(handle, this._transformDocumentSelector(selector), !!provider.prepareDocumentPaste, metadata.pasteMimeTypes);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$prepareDocumentPaste(handle: number, resource: UriComponents, ranges: IRange[], dataTransfer: extHostProtocol.DataTransferDTO, token: CancellationToken): Promise<extHostProtocol.DataTransferDTO | undefined> {\n\t\treturn this._withAdapter(handle, DocumentPasteEditProvider, adapter => adapter.prepareDocumentPaste(URI.revive(resource), ranges, dataTransfer, token), undefined, token);\n\t}\n\n\t$providePasteEdits(handle: number, requestId: number, resource: UriComponents, ranges: IRange[], dataTransferDto: extHostProtocol.DataTransferDTO, token: CancellationToken): Promise<extHostProtocol.IPasteEditDto | undefined> {\n\t\treturn this._withAdapter(handle, DocumentPasteEditProvider, adapter => adapter.providePasteEdits(requestId, URI.revive(resource), ranges, dataTransferDto, token), undefined, token);\n\t}\n\n\t// --- configuration\n\n\tprivate static _serializeRegExp(regExp: RegExp): extHostProtocol.IRegExpDto {\n\t\treturn {\n\t\t\tpattern: regExp.source,\n\t\t\tflags: regExpFlags(regExp),\n\t\t};\n\t}\n\n\tprivate static _serializeIndentationRule(indentationRule: vscode.IndentationRule): extHostProtocol.IIndentationRuleDto {\n\t\treturn {\n\t\t\tdecreaseIndentPattern: ExtHostLanguageFeatures._serializeRegExp(indentationRule.decreaseIndentPattern),\n\t\t\tincreaseIndentPattern: ExtHostLanguageFeatures._serializeRegExp(indentationRule.increaseIndentPattern),\n\t\t\tindentNextLinePattern: indentationRule.indentNextLinePattern ? ExtHostLanguageFeatures._serializeRegExp(indentationRule.indentNextLinePattern) : undefined,\n\t\t\tunIndentedLinePattern: indentationRule.unIndentedLinePattern ? ExtHostLanguageFeatures._serializeRegExp(indentationRule.unIndentedLinePattern) : undefined,\n\t\t};\n\t}\n\n\tprivate static _serializeOnEnterRule(onEnterRule: vscode.OnEnterRule): extHostProtocol.IOnEnterRuleDto {\n\t\treturn {\n\t\t\tbeforeText: ExtHostLanguageFeatures._serializeRegExp(onEnterRule.beforeText),\n\t\t\tafterText: onEnterRule.afterText ? ExtHostLanguageFeatures._serializeRegExp(onEnterRule.afterText) : undefined,\n\t\t\tpreviousLineText: onEnterRule.previousLineText ? ExtHostLanguageFeatures._serializeRegExp(onEnterRule.previousLineText) : undefined,\n\t\t\taction: onEnterRule.action\n\t\t};\n\t}\n\n\tprivate static _serializeOnEnterRules(onEnterRules: vscode.OnEnterRule[]): extHostProtocol.IOnEnterRuleDto[] {\n\t\treturn onEnterRules.map(ExtHostLanguageFeatures._serializeOnEnterRule);\n\t}\n\n\tsetLanguageConfiguration(extension: IExtensionDescription, languageId: string, configuration: vscode.LanguageConfiguration): vscode.Disposable {\n\t\tconst { wordPattern } = configuration;\n\n\t\t// check for a valid word pattern\n\t\tif (wordPattern && regExpLeadsToEndlessLoop(wordPattern)) {\n\t\t\tthrow new Error(`Invalid language configuration: wordPattern '${wordPattern}' is not allowed to match the empty string.`);\n\t\t}\n\n\t\t// word definition\n\t\tif (wordPattern) {\n\t\t\tthis._documents.setWordDefinitionFor(languageId, wordPattern);\n\t\t} else {\n\t\t\tthis._documents.setWordDefinitionFor(languageId, undefined);\n\t\t}\n\n\t\tif (configuration.__electricCharacterSupport) {\n\t\t\tthis._apiDeprecation.report('LanguageConfiguration.__electricCharacterSupport', extension,\n\t\t\t\t`Do not use.`);\n\t\t}\n\n\t\tif (configuration.__characterPairSupport) {\n\t\t\tthis._apiDeprecation.report('LanguageConfiguration.__characterPairSupport', extension,\n\t\t\t\t`Do not use.`);\n\t\t}\n\n\t\tconst handle = this._nextHandle();\n\t\tconst serializedConfiguration: extHostProtocol.ILanguageConfigurationDto = {\n\t\t\tcomments: configuration.comments,\n\t\t\tbrackets: configuration.brackets,\n\t\t\twordPattern: configuration.wordPattern ? ExtHostLanguageFeatures._serializeRegExp(configuration.wordPattern) : undefined,\n\t\t\tindentationRules: configuration.indentationRules ? ExtHostLanguageFeatures._serializeIndentationRule(configuration.indentationRules) : undefined,\n\t\t\tonEnterRules: configuration.onEnterRules ? ExtHostLanguageFeatures._serializeOnEnterRules(configuration.onEnterRules) : undefined,\n\t\t\t__electricCharacterSupport: configuration.__electricCharacterSupport,\n\t\t\t__characterPairSupport: configuration.__characterPairSupport,\n\t\t};\n\t\tthis._proxy.$setLanguageConfiguration(handle, languageId, serializedConfiguration);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$setWordDefinitions(wordDefinitions: extHostProtocol.ILanguageWordDefinitionDto[]): void {\n\t\tfor (const wordDefinition of wordDefinitions) {\n\t\t\tthis._documents.setWordDefinitionFor(wordDefinition.languageId, new RegExp(wordDefinition.regexSource, wordDefinition.regexFlags));\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { MainContext, MainThreadLanguagesShape, IMainContext, ExtHostLanguagesShape } from './extHost.protocol';\nimport type * as vscode from 'vscode';\nimport { ExtHostDocuments } from 'vs/workbench/api/common/extHostDocuments';\nimport * as typeConvert from 'vs/workbench/api/common/extHostTypeConverters';\nimport { StandardTokenType, Range, Position, LanguageStatusSeverity } from 'vs/workbench/api/common/extHostTypes';\nimport Severity from 'vs/base/common/severity';\nimport { disposableTimeout } from 'vs/base/common/async';\nimport { DisposableStore, IDisposable } from 'vs/base/common/lifecycle';\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { CommandsConverter } from 'vs/workbench/api/common/extHostCommands';\nimport { IURITransformer } from 'vs/base/common/uriIpc';\n\nexport class ExtHostLanguages implements ExtHostLanguagesShape {\n\n\tprivate readonly _proxy: MainThreadLanguagesShape;\n\n\tprivate _languageIds: string[] = [];\n\n\tconstructor(\n\t\tmainContext: IMainContext,\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _commands: CommandsConverter,\n\t\tprivate readonly _uriTransformer: IURITransformer | undefined\n\t) {\n\t\tthis._proxy = mainContext.getProxy(MainContext.MainThreadLanguages);\n\t}\n\n\t$acceptLanguageIds(ids: string[]): void {\n\t\tthis._languageIds = ids;\n\t}\n\n\tasync getLanguages(): Promise<string[]> {\n\t\treturn this._languageIds.slice(0);\n\t}\n\n\tasync changeLanguage(uri: vscode.Uri, languageId: string): Promise<vscode.TextDocument> {\n\t\tawait this._proxy.$changeLanguage(uri, languageId);\n\t\tconst data = this._documents.getDocumentData(uri);\n\t\tif (!data) {\n\t\t\tthrow new Error(`document '${uri.toString()}' NOT found`);\n\t\t}\n\t\treturn data.document;\n\t}\n\n\tasync tokenAtPosition(document: vscode.TextDocument, position: vscode.Position): Promise<vscode.TokenInformation> {\n\t\tconst versionNow = document.version;\n\t\tconst pos = typeConvert.Position.from(position);\n\t\tconst info = await this._proxy.$tokensAtPosition(document.uri, pos);\n\t\tconst defaultRange = {\n\t\t\ttype: StandardTokenType.Other,\n\t\t\trange: document.getWordRangeAtPosition(position) ?? new Range(position.line, position.character, position.line, position.character)\n\t\t};\n\t\tif (!info) {\n\t\t\t// no result\n\t\t\treturn defaultRange;\n\t\t}\n\t\tconst result = {\n\t\t\trange: typeConvert.Range.to(info.range),\n\t\t\ttype: typeConvert.TokenType.to(info.type)\n\t\t};\n\t\tif (!result.range.contains(<Position>position)) {\n\t\t\t// bogous result\n\t\t\treturn defaultRange;\n\t\t}\n\t\tif (versionNow !== document.version) {\n\t\t\t// concurrent change\n\t\t\treturn defaultRange;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate _handlePool: number = 0;\n\tprivate _ids = new Set<string>();\n\n\tcreateLanguageStatusItem(extension: IExtensionDescription, id: string, selector: vscode.DocumentSelector): vscode.LanguageStatusItem {\n\n\t\tconst handle = this._handlePool++;\n\t\tconst proxy = this._proxy;\n\t\tconst ids = this._ids;\n\n\t\t// enforce extension unique identifier\n\t\tconst fullyQualifiedId = `${extension.identifier.value}/${id}`;\n\t\tif (ids.has(fullyQualifiedId)) {\n\t\t\tthrow new Error(`LanguageStatusItem with id '${id}' ALREADY exists`);\n\t\t}\n\t\tids.add(fullyQualifiedId);\n\n\t\tconst data: Omit<vscode.LanguageStatusItem, 'dispose'> = {\n\t\t\tselector,\n\t\t\tid,\n\t\t\tname: extension.displayName ?? extension.name,\n\t\t\tseverity: LanguageStatusSeverity.Information,\n\t\t\tcommand: undefined,\n\t\t\ttext: '',\n\t\t\tdetail: '',\n\t\t\tbusy: false\n\t\t};\n\n\t\tlet soonHandle: IDisposable | undefined;\n\t\tconst commandDisposables = new DisposableStore();\n\t\tconst updateAsync = () => {\n\t\t\tsoonHandle?.dispose();\n\t\t\tsoonHandle = disposableTimeout(() => {\n\t\t\t\tcommandDisposables.clear();\n\t\t\t\tthis._proxy.$setLanguageStatus(handle, {\n\t\t\t\t\tid: fullyQualifiedId,\n\t\t\t\t\tname: data.name ?? extension.displayName ?? extension.name,\n\t\t\t\t\tsource: extension.displayName ?? extension.name,\n\t\t\t\t\tselector: typeConvert.DocumentSelector.from(data.selector, this._uriTransformer),\n\t\t\t\t\tlabel: data.text,\n\t\t\t\t\tdetail: data.detail ?? '',\n\t\t\t\t\tseverity: data.severity === LanguageStatusSeverity.Error ? Severity.Error : data.severity === LanguageStatusSeverity.Warning ? Severity.Warning : Severity.Info,\n\t\t\t\t\tcommand: data.command && this._commands.toInternal(data.command, commandDisposables),\n\t\t\t\t\taccessibilityInfo: data.accessibilityInformation,\n\t\t\t\t\tbusy: data.busy\n\t\t\t\t});\n\t\t\t}, 0);\n\t\t};\n\n\t\tconst result: vscode.LanguageStatusItem = {\n\t\t\tdispose() {\n\t\t\t\tcommandDisposables.dispose();\n\t\t\t\tsoonHandle?.dispose();\n\t\t\t\tproxy.$removeLanguageStatus(handle);\n\t\t\t\tids.delete(fullyQualifiedId);\n\t\t\t},\n\t\t\tget id() {\n\t\t\t\treturn data.id;\n\t\t\t},\n\t\t\tget name() {\n\t\t\t\treturn data.name;\n\t\t\t},\n\t\t\tset name(value) {\n\t\t\t\tdata.name = value;\n\t\t\t\tupdateAsync();\n\t\t\t},\n\t\t\tget selector() {\n\t\t\t\treturn data.selector;\n\t\t\t},\n\t\t\tset selector(value) {\n\t\t\t\tdata.selector = value;\n\t\t\t\tupdateAsync();\n\t\t\t},\n\t\t\tget text() {\n\t\t\t\treturn data.text;\n\t\t\t},\n\t\t\tset text(value) {\n\t\t\t\tdata.text = value;\n\t\t\t\tupdateAsync();\n\t\t\t},\n\t\t\tget detail() {\n\t\t\t\treturn data.detail;\n\t\t\t},\n\t\t\tset detail(value) {\n\t\t\t\tdata.detail = value;\n\t\t\t\tupdateAsync();\n\t\t\t},\n\t\t\tget severity() {\n\t\t\t\treturn data.severity;\n\t\t\t},\n\t\t\tset severity(value) {\n\t\t\t\tdata.severity = value;\n\t\t\t\tupdateAsync();\n\t\t\t},\n\t\t\tget accessibilityInformation() {\n\t\t\t\treturn data.accessibilityInformation;\n\t\t\t},\n\t\t\tset accessibilityInformation(value) {\n\t\t\t\tdata.accessibilityInformation = value;\n\t\t\t\tupdateAsync();\n\t\t\t},\n\t\t\tget command() {\n\t\t\t\treturn data.command;\n\t\t\t},\n\t\t\tset command(value) {\n\t\t\t\tdata.command = value;\n\t\t\t\tupdateAsync();\n\t\t\t},\n\t\t\tget busy() {\n\t\t\t\treturn data.busy;\n\t\t\t},\n\t\t\tset busy(value: boolean) {\n\t\t\t\tdata.busy = value;\n\t\t\t\tupdateAsync();\n\t\t\t}\n\t\t};\n\t\tupdateAsync();\n\t\treturn result;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ILogger, ILoggerOptions, AbstractMessageLogger, LogLevel, AbstractLoggerService } from 'vs/platform/log/common/log';\nimport { MainThreadLoggerShape, MainContext, ExtHostLogLevelServiceShape as ExtHostLogLevelServiceShape } from 'vs/workbench/api/common/extHost.protocol';\nimport { IExtHostInitDataService } from 'vs/workbench/api/common/extHostInitDataService';\nimport { IExtHostRpcService } from 'vs/workbench/api/common/extHostRpcService';\nimport { URI } from 'vs/base/common/uri';\nimport { Emitter } from 'vs/base/common/event';\n\nexport class ExtHostLoggerService extends AbstractLoggerService implements ExtHostLogLevelServiceShape {\n\n\tdeclare readonly _serviceBrand: undefined;\n\tprivate readonly _onDidChangeLogLevel: Emitter<LogLevel>;\n\tprivate readonly _proxy: MainThreadLoggerShape;\n\n\tconstructor(\n\t\t@IExtHostRpcService rpc: IExtHostRpcService,\n\t\t@IExtHostInitDataService initData: IExtHostInitDataService,\n\t) {\n\t\tconst emitter = new Emitter<LogLevel>();\n\t\tsuper(initData.logLevel, emitter.event);\n\t\tthis._proxy = rpc.getProxy(MainContext.MainThreadLogger);\n\t\tthis._onDidChangeLogLevel = this._register(emitter);\n\t}\n\n\t$setLevel(level: LogLevel): void {\n\t\tthis._onDidChangeLogLevel.fire(level);\n\t}\n\n\tprotected doCreateLogger(resource: URI, logLevel: LogLevel, options?: ILoggerOptions): ILogger {\n\t\treturn new Logger(this._proxy, resource, logLevel, options);\n\t}\n}\n\nclass Logger extends AbstractMessageLogger {\n\n\tprivate isLoggerCreated: boolean = false;\n\tprivate buffer: [LogLevel, string][] = [];\n\n\tconstructor(\n\t\tprivate readonly proxy: MainThreadLoggerShape,\n\t\tprivate readonly file: URI,\n\t\tlogLevel: LogLevel,\n\t\tloggerOptions?: ILoggerOptions,\n\t) {\n\t\tsuper(loggerOptions?.always);\n\t\tthis.setLevel(logLevel);\n\t\tthis.proxy.$createLogger(file, loggerOptions)\n\t\t\t.then(() => {\n\t\t\t\tthis.doLog(this.buffer);\n\t\t\t\tthis.isLoggerCreated = true;\n\t\t\t});\n\t}\n\n\tprotected log(level: LogLevel, message: string) {\n\t\tconst messages: [LogLevel, string][] = [[level, message]];\n\t\tif (this.isLoggerCreated) {\n\t\t\tthis.doLog(messages);\n\t\t} else {\n\t\t\tthis.buffer.push(...messages);\n\t\t}\n\t}\n\n\tprivate doLog(messages: [LogLevel, string][]) {\n\t\tthis.proxy.$log(this.file, messages);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport Severity from 'vs/base/common/severity';\nimport type * as vscode from 'vscode';\nimport { MainContext, MainThreadMessageServiceShape, MainThreadMessageOptions, IMainContext } from './extHost.protocol';\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { checkProposedApiEnabled } from 'vs/workbench/services/extensions/common/extensions';\n\nfunction isMessageItem(item: any): item is vscode.MessageItem {\n\treturn item && item.title;\n}\n\nexport class ExtHostMessageService {\n\n\tprivate _proxy: MainThreadMessageServiceShape;\n\n\tconstructor(\n\t\tmainContext: IMainContext,\n\t\t@ILogService private readonly _logService: ILogService\n\t) {\n\t\tthis._proxy = mainContext.getProxy(MainContext.MainThreadMessageService);\n\t}\n\n\n\tshowMessage(extension: IExtensionDescription, severity: Severity, message: string, optionsOrFirstItem: vscode.MessageOptions | string | undefined, rest: string[]): Promise<string | undefined>;\n\tshowMessage(extension: IExtensionDescription, severity: Severity, message: string, optionsOrFirstItem: vscode.MessageOptions | vscode.MessageItem | undefined, rest: vscode.MessageItem[]): Promise<vscode.MessageItem | undefined>;\n\tshowMessage(extension: IExtensionDescription, severity: Severity, message: string, optionsOrFirstItem: vscode.MessageOptions | vscode.MessageItem | string | undefined, rest: Array<vscode.MessageItem | string>): Promise<string | vscode.MessageItem | undefined>;\n\tshowMessage(extension: IExtensionDescription, severity: Severity, message: string, optionsOrFirstItem: vscode.MessageOptions | string | vscode.MessageItem | undefined, rest: Array<string | vscode.MessageItem>): Promise<string | vscode.MessageItem | undefined> {\n\n\t\tconst options: MainThreadMessageOptions = {\n\t\t\tsource: { identifier: extension.identifier, label: extension.displayName || extension.name }\n\t\t};\n\t\tlet items: (string | vscode.MessageItem)[];\n\n\t\tif (typeof optionsOrFirstItem === 'string' || isMessageItem(optionsOrFirstItem)) {\n\t\t\titems = [optionsOrFirstItem, ...rest];\n\t\t} else {\n\t\t\toptions.modal = optionsOrFirstItem?.modal;\n\t\t\toptions.useCustom = optionsOrFirstItem?.useCustom;\n\t\t\toptions.detail = optionsOrFirstItem?.detail;\n\t\t\titems = rest;\n\t\t}\n\n\t\tif (options.useCustom) {\n\t\t\tcheckProposedApiEnabled(extension, 'resolvers');\n\t\t}\n\n\t\tconst commands: { title: string; isCloseAffordance: boolean; handle: number }[] = [];\n\n\t\tfor (let handle = 0; handle < items.length; handle++) {\n\t\t\tconst command = items[handle];\n\t\t\tif (typeof command === 'string') {\n\t\t\t\tcommands.push({ title: command, handle, isCloseAffordance: false });\n\t\t\t} else if (typeof command === 'object') {\n\t\t\t\tconst { title, isCloseAffordance } = command;\n\t\t\t\tcommands.push({ title, isCloseAffordance: !!isCloseAffordance, handle });\n\t\t\t} else {\n\t\t\t\tthis._logService.warn('Invalid message item:', command);\n\t\t\t}\n\t\t}\n\n\t\treturn this._proxy.$showMessage(severity, message, options, commands).then(handle => {\n\t\t\tif (typeof handle === 'number') {\n\t\t\t\treturn items[handle];\n\t\t\t}\n\t\t\treturn undefined;\n\t\t});\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { VSBuffer } from 'vs/base/common/buffer';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { IRelativePattern } from 'vs/base/common/glob';\nimport { hash } from 'vs/base/common/hash';\nimport { DisposableStore, IDisposable, toDisposable } from 'vs/base/common/lifecycle';\nimport { ResourceMap } from 'vs/base/common/map';\nimport { MarshalledId } from 'vs/base/common/marshallingIds';\nimport { isFalsyOrWhitespace } from 'vs/base/common/strings';\nimport { assertIsDefined } from 'vs/base/common/types';\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { Cache } from 'vs/workbench/api/common/cache';\nimport { ExtHostNotebookShape, IMainContext, IModelAddedData, INotebookCellStatusBarListDto, INotebookDocumentsAndEditorsDelta, INotebookDocumentShowOptions, INotebookEditorAddData, MainContext, MainThreadNotebookDocumentsShape, MainThreadNotebookEditorsShape, MainThreadNotebookShape, NotebookDataDto } from 'vs/workbench/api/common/extHost.protocol';\nimport { ApiCommand, ApiCommandArgument, ApiCommandResult, CommandsConverter, ExtHostCommands } from 'vs/workbench/api/common/extHostCommands';\nimport { ExtHostDocuments } from 'vs/workbench/api/common/extHostDocuments';\nimport { ExtHostDocumentsAndEditors } from 'vs/workbench/api/common/extHostDocumentsAndEditors';\nimport { IExtensionStoragePaths } from 'vs/workbench/api/common/extHostStoragePaths';\nimport * as typeConverters from 'vs/workbench/api/common/extHostTypeConverters';\nimport * as extHostTypes from 'vs/workbench/api/common/extHostTypes';\nimport { INotebookExclusiveDocumentFilter, INotebookContributionData } from 'vs/workbench/contrib/notebook/common/notebookCommon';\nimport { SerializableObjectWithBuffers } from 'vs/workbench/services/extensions/common/proxyIdentifier';\nimport type * as vscode from 'vscode';\nimport { ExtHostCell, ExtHostNotebookDocument } from './extHostNotebookDocument';\nimport { ExtHostNotebookEditor } from './extHostNotebookEditor';\n\n\ntype NotebookContentProviderData = {\n\treadonly provider: vscode.NotebookContentProvider;\n\treadonly extension: IExtensionDescription;\n};\n\nexport class ExtHostNotebookController implements ExtHostNotebookShape {\n\tprivate static _notebookStatusBarItemProviderHandlePool: number = 0;\n\n\tprivate readonly _notebookProxy: MainThreadNotebookShape;\n\tprivate readonly _notebookDocumentsProxy: MainThreadNotebookDocumentsShape;\n\tprivate readonly _notebookEditorsProxy: MainThreadNotebookEditorsShape;\n\n\tprivate readonly _notebookContentProviders = new Map<string, NotebookContentProviderData>();\n\tprivate readonly _notebookStatusBarItemProviders = new Map<number, vscode.NotebookCellStatusBarItemProvider>();\n\tprivate readonly _documents = new ResourceMap<ExtHostNotebookDocument>();\n\tprivate readonly _editors = new Map<string, ExtHostNotebookEditor>();\n\tprivate readonly _commandsConverter: CommandsConverter;\n\n\tprivate readonly _onDidChangeActiveNotebookEditor = new Emitter<vscode.NotebookEditor | undefined>();\n\treadonly onDidChangeActiveNotebookEditor = this._onDidChangeActiveNotebookEditor.event;\n\n\tprivate _activeNotebookEditor: ExtHostNotebookEditor | undefined;\n\tget activeNotebookEditor(): vscode.NotebookEditor | undefined {\n\t\treturn this._activeNotebookEditor?.apiEditor;\n\t}\n\tprivate _visibleNotebookEditors: ExtHostNotebookEditor[] = [];\n\tget visibleNotebookEditors(): vscode.NotebookEditor[] {\n\t\treturn this._visibleNotebookEditors.map(editor => editor.apiEditor);\n\t}\n\n\tprivate _onDidOpenNotebookDocument = new Emitter<vscode.NotebookDocument>();\n\tonDidOpenNotebookDocument: Event<vscode.NotebookDocument> = this._onDidOpenNotebookDocument.event;\n\tprivate _onDidCloseNotebookDocument = new Emitter<vscode.NotebookDocument>();\n\tonDidCloseNotebookDocument: Event<vscode.NotebookDocument> = this._onDidCloseNotebookDocument.event;\n\n\tprivate _onDidChangeVisibleNotebookEditors = new Emitter<vscode.NotebookEditor[]>();\n\tonDidChangeVisibleNotebookEditors = this._onDidChangeVisibleNotebookEditors.event;\n\n\tprivate _statusBarCache = new Cache<IDisposable>('NotebookCellStatusBarCache');\n\n\tconstructor(\n\t\tmainContext: IMainContext,\n\t\tcommands: ExtHostCommands,\n\t\tprivate _textDocumentsAndEditors: ExtHostDocumentsAndEditors,\n\t\tprivate _textDocuments: ExtHostDocuments,\n\t\tprivate readonly _extensionStoragePaths: IExtensionStoragePaths,\n\t) {\n\t\tthis._notebookProxy = mainContext.getProxy(MainContext.MainThreadNotebook);\n\t\tthis._notebookDocumentsProxy = mainContext.getProxy(MainContext.MainThreadNotebookDocuments);\n\t\tthis._notebookEditorsProxy = mainContext.getProxy(MainContext.MainThreadNotebookEditors);\n\t\tthis._commandsConverter = commands.converter;\n\n\t\tcommands.registerArgumentProcessor({\n\t\t\t// Serialized INotebookCellActionContext\n\t\t\tprocessArgument: (arg) => {\n\t\t\t\tif (arg && arg.$mid === MarshalledId.NotebookCellActionContext) {\n\t\t\t\t\tconst notebookUri = arg.notebookEditor?.notebookUri;\n\t\t\t\t\tconst cellHandle = arg.cell.handle;\n\n\t\t\t\t\tconst data = this._documents.get(notebookUri);\n\t\t\t\t\tconst cell = data?.getCell(cellHandle);\n\t\t\t\t\tif (cell) {\n\t\t\t\t\t\treturn cell.apiCell;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn arg;\n\t\t\t}\n\t\t});\n\n\t\tExtHostNotebookController._registerApiCommands(commands);\n\t}\n\n\tgetEditorById(editorId: string): ExtHostNotebookEditor {\n\t\tconst editor = this._editors.get(editorId);\n\t\tif (!editor) {\n\t\t\tthrow new Error(`unknown text editor: ${editorId}. known editors: ${[...this._editors.keys()]} `);\n\t\t}\n\t\treturn editor;\n\t}\n\n\tgetIdByEditor(editor: vscode.NotebookEditor): string | undefined {\n\t\tfor (const [id, candidate] of this._editors) {\n\t\t\tif (candidate.apiEditor === editor) {\n\t\t\t\treturn id;\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tget notebookDocuments() {\n\t\treturn [...this._documents.values()];\n\t}\n\n\tgetNotebookDocument(uri: URI, relaxed: true): ExtHostNotebookDocument | undefined;\n\tgetNotebookDocument(uri: URI): ExtHostNotebookDocument;\n\tgetNotebookDocument(uri: URI, relaxed?: true): ExtHostNotebookDocument | undefined {\n\t\tconst result = this._documents.get(uri);\n\t\tif (!result && !relaxed) {\n\t\t\tthrow new Error(`NO notebook document for '${uri}'`);\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate _getProviderData(viewType: string): NotebookContentProviderData {\n\t\tconst result = this._notebookContentProviders.get(viewType);\n\t\tif (!result) {\n\t\t\tthrow new Error(`NO provider for '${viewType}'`);\n\t\t}\n\t\treturn result;\n\t}\n\n\tregisterNotebookContentProvider(\n\t\textension: IExtensionDescription,\n\t\tviewType: string,\n\t\tprovider: vscode.NotebookContentProvider,\n\t\toptions?: vscode.NotebookDocumentContentOptions,\n\t\tregistration?: vscode.NotebookRegistrationData\n\t): vscode.Disposable {\n\t\tif (isFalsyOrWhitespace(viewType)) {\n\t\t\tthrow new Error(`viewType cannot be empty or just whitespace`);\n\t\t}\n\t\tif (this._notebookContentProviders.has(viewType)) {\n\t\t\tthrow new Error(`Notebook provider for '${viewType}' already registered`);\n\t\t}\n\n\t\tthis._notebookContentProviders.set(viewType, { extension, provider });\n\n\t\tlet listener: IDisposable | undefined;\n\t\tif (provider.onDidChangeNotebookContentOptions) {\n\t\t\tlistener = provider.onDidChangeNotebookContentOptions(() => {\n\t\t\t\tconst internalOptions = typeConverters.NotebookDocumentContentOptions.from(provider.options);\n\t\t\t\tthis._notebookProxy.$updateNotebookProviderOptions(viewType, internalOptions);\n\t\t\t});\n\t\t}\n\n\t\tthis._notebookProxy.$registerNotebookProvider(\n\t\t\t{ id: extension.identifier, location: extension.extensionLocation },\n\t\t\tviewType,\n\t\t\ttypeConverters.NotebookDocumentContentOptions.from(options),\n\t\t\tExtHostNotebookController._convertNotebookRegistrationData(extension, registration)\n\t\t);\n\n\t\treturn new extHostTypes.Disposable(() => {\n\t\t\tlistener?.dispose();\n\t\t\tthis._notebookContentProviders.delete(viewType);\n\t\t\tthis._notebookProxy.$unregisterNotebookProvider(viewType);\n\t\t});\n\t}\n\n\tprivate static _convertNotebookRegistrationData(extension: IExtensionDescription, registration: vscode.NotebookRegistrationData | undefined): INotebookContributionData | undefined {\n\t\tif (!registration) {\n\t\t\treturn;\n\t\t}\n\t\tconst viewOptionsFilenamePattern = registration.filenamePattern\n\t\t\t.map(pattern => typeConverters.NotebookExclusiveDocumentPattern.from(pattern))\n\t\t\t.filter(pattern => pattern !== undefined) as (string | IRelativePattern | INotebookExclusiveDocumentFilter)[];\n\t\tif (registration.filenamePattern && !viewOptionsFilenamePattern) {\n\t\t\tconsole.warn(`Notebook content provider view options file name pattern is invalid ${registration.filenamePattern}`);\n\t\t\treturn undefined;\n\t\t}\n\t\treturn {\n\t\t\textension: extension.identifier,\n\t\t\tproviderDisplayName: extension.displayName || extension.name,\n\t\t\tdisplayName: registration.displayName,\n\t\t\tfilenamePattern: viewOptionsFilenamePattern,\n\t\t\texclusive: registration.exclusive || false\n\t\t};\n\t}\n\n\tregisterNotebookCellStatusBarItemProvider(extension: IExtensionDescription, notebookType: string, provider: vscode.NotebookCellStatusBarItemProvider) {\n\n\t\tconst handle = ExtHostNotebookController._notebookStatusBarItemProviderHandlePool++;\n\t\tconst eventHandle = typeof provider.onDidChangeCellStatusBarItems === 'function' ? ExtHostNotebookController._notebookStatusBarItemProviderHandlePool++ : undefined;\n\n\t\tthis._notebookStatusBarItemProviders.set(handle, provider);\n\t\tthis._notebookProxy.$registerNotebookCellStatusBarItemProvider(handle, eventHandle, notebookType);\n\n\t\tlet subscription: vscode.Disposable | undefined;\n\t\tif (eventHandle !== undefined) {\n\t\t\tsubscription = provider.onDidChangeCellStatusBarItems!(_ => this._notebookProxy.$emitCellStatusBarEvent(eventHandle));\n\t\t}\n\n\t\treturn new extHostTypes.Disposable(() => {\n\t\t\tthis._notebookStatusBarItemProviders.delete(handle);\n\t\t\tthis._notebookProxy.$unregisterNotebookCellStatusBarItemProvider(handle, eventHandle);\n\t\t\tif (subscription) {\n\t\t\t\tsubscription.dispose();\n\t\t\t}\n\t\t});\n\t}\n\n\tasync createNotebookDocument(options: { viewType: string; content?: vscode.NotebookData }): Promise<URI> {\n\t\tconst canonicalUri = await this._notebookDocumentsProxy.$tryCreateNotebook({\n\t\t\tviewType: options.viewType,\n\t\t\tcontent: options.content && typeConverters.NotebookData.from(options.content)\n\t\t});\n\t\treturn URI.revive(canonicalUri);\n\t}\n\n\tasync openNotebookDocument(uri: URI): Promise<vscode.NotebookDocument> {\n\t\tconst cached = this._documents.get(uri);\n\t\tif (cached) {\n\t\t\treturn cached.apiNotebook;\n\t\t}\n\t\tconst canonicalUri = await this._notebookDocumentsProxy.$tryOpenNotebook(uri);\n\t\tconst document = this._documents.get(URI.revive(canonicalUri));\n\t\treturn assertIsDefined(document?.apiNotebook);\n\t}\n\n\n\tasync showNotebookDocument(notebookOrUri: vscode.NotebookDocument | URI, options?: vscode.NotebookDocumentShowOptions): Promise<vscode.NotebookEditor> {\n\n\t\tif (URI.isUri(notebookOrUri)) {\n\t\t\tnotebookOrUri = await this.openNotebookDocument(notebookOrUri);\n\t\t}\n\n\t\tlet resolvedOptions: INotebookDocumentShowOptions;\n\t\tif (typeof options === 'object') {\n\t\t\tresolvedOptions = {\n\t\t\t\tposition: typeConverters.ViewColumn.from(options.viewColumn),\n\t\t\t\tpreserveFocus: options.preserveFocus,\n\t\t\t\tselections: options.selections && options.selections.map(typeConverters.NotebookRange.from),\n\t\t\t\tpinned: typeof options.preview === 'boolean' ? !options.preview : undefined\n\t\t\t};\n\t\t} else {\n\t\t\tresolvedOptions = {\n\t\t\t\tpreserveFocus: false\n\t\t\t};\n\t\t}\n\n\t\tconst editorId = await this._notebookEditorsProxy.$tryShowNotebookDocument(notebookOrUri.uri, notebookOrUri.notebookType, resolvedOptions);\n\t\tconst editor = editorId && this._editors.get(editorId)?.apiEditor;\n\n\t\tif (editor) {\n\t\t\treturn editor;\n\t\t}\n\n\t\tif (editorId) {\n\t\t\tthrow new Error(`Could NOT open editor for \"${notebookOrUri.uri.toString()}\" because another editor opened in the meantime.`);\n\t\t} else {\n\t\t\tthrow new Error(`Could NOT open editor for \"${notebookOrUri.uri.toString()}\".`);\n\t\t}\n\t}\n\n\tasync $provideNotebookCellStatusBarItems(handle: number, uri: UriComponents, index: number, token: CancellationToken): Promise<INotebookCellStatusBarListDto | undefined> {\n\t\tconst provider = this._notebookStatusBarItemProviders.get(handle);\n\t\tconst revivedUri = URI.revive(uri);\n\t\tconst document = this._documents.get(revivedUri);\n\t\tif (!document || !provider) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst cell = document.getCellFromIndex(index);\n\t\tif (!cell) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst result = await provider.provideCellStatusBarItems(cell.apiCell, token);\n\t\tif (!result) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst disposables = new DisposableStore();\n\t\tconst cacheId = this._statusBarCache.add([disposables]);\n\t\tconst resultArr = Array.isArray(result) ? result : [result];\n\t\tconst items = resultArr.map(item => typeConverters.NotebookStatusBarItem.from(item, this._commandsConverter, disposables));\n\t\treturn {\n\t\t\tcacheId,\n\t\t\titems\n\t\t};\n\t}\n\n\t$releaseNotebookCellStatusBarItems(cacheId: number): void {\n\t\tthis._statusBarCache.delete(cacheId);\n\t}\n\n\t// --- serialize/deserialize\n\n\tprivate _handlePool = 0;\n\tprivate readonly _notebookSerializer = new Map<number, vscode.NotebookSerializer>();\n\n\tregisterNotebookSerializer(extension: IExtensionDescription, viewType: string, serializer: vscode.NotebookSerializer, options?: vscode.NotebookDocumentContentOptions, registration?: vscode.NotebookRegistrationData): vscode.Disposable {\n\t\tif (isFalsyOrWhitespace(viewType)) {\n\t\t\tthrow new Error(`viewType cannot be empty or just whitespace`);\n\t\t}\n\t\tconst handle = this._handlePool++;\n\t\tthis._notebookSerializer.set(handle, serializer);\n\t\tthis._notebookProxy.$registerNotebookSerializer(\n\t\t\thandle,\n\t\t\t{ id: extension.identifier, location: extension.extensionLocation },\n\t\t\tviewType,\n\t\t\ttypeConverters.NotebookDocumentContentOptions.from(options),\n\t\t\tExtHostNotebookController._convertNotebookRegistrationData(extension, registration)\n\t\t);\n\t\treturn toDisposable(() => {\n\t\t\tthis._notebookProxy.$unregisterNotebookSerializer(handle);\n\t\t});\n\t}\n\n\tasync $dataToNotebook(handle: number, bytes: VSBuffer, token: CancellationToken): Promise<SerializableObjectWithBuffers<NotebookDataDto>> {\n\t\tconst serializer = this._notebookSerializer.get(handle);\n\t\tif (!serializer) {\n\t\t\tthrow new Error('NO serializer found');\n\t\t}\n\t\tconst data = await serializer.deserializeNotebook(bytes.buffer, token);\n\t\treturn new SerializableObjectWithBuffers(typeConverters.NotebookData.from(data));\n\t}\n\n\tasync $notebookToData(handle: number, data: SerializableObjectWithBuffers<NotebookDataDto>, token: CancellationToken): Promise<VSBuffer> {\n\t\tconst serializer = this._notebookSerializer.get(handle);\n\t\tif (!serializer) {\n\t\t\tthrow new Error('NO serializer found');\n\t\t}\n\t\tconst bytes = await serializer.serializeNotebook(typeConverters.NotebookData.to(data.value), token);\n\t\treturn VSBuffer.wrap(bytes);\n\t}\n\n\t// --- open, save, saveAs, backup\n\n\tasync $openNotebook(viewType: string, uri: UriComponents, backupId: string | undefined, untitledDocumentData: VSBuffer | undefined, token: CancellationToken): Promise<SerializableObjectWithBuffers<NotebookDataDto>> {\n\t\tconst { provider } = this._getProviderData(viewType);\n\t\tconst data = await provider.openNotebook(URI.revive(uri), { backupId, untitledDocumentData: untitledDocumentData?.buffer }, token);\n\t\treturn new SerializableObjectWithBuffers({\n\t\t\tmetadata: data.metadata ?? Object.create(null),\n\t\t\tcells: data.cells.map(typeConverters.NotebookCellData.from),\n\t\t});\n\t}\n\n\tasync $saveNotebook(viewType: string, uri: UriComponents, token: CancellationToken): Promise<boolean> {\n\t\tconst document = this.getNotebookDocument(URI.revive(uri));\n\t\tconst { provider } = this._getProviderData(viewType);\n\t\tawait provider.saveNotebook(document.apiNotebook, token);\n\t\treturn true;\n\t}\n\n\tasync $saveNotebookAs(viewType: string, uri: UriComponents, target: UriComponents, token: CancellationToken): Promise<boolean> {\n\t\tconst document = this.getNotebookDocument(URI.revive(uri));\n\t\tconst { provider } = this._getProviderData(viewType);\n\t\tawait provider.saveNotebookAs(URI.revive(target), document.apiNotebook, token);\n\t\treturn true;\n\t}\n\n\tprivate _backupIdPool: number = 0;\n\n\tasync $backupNotebook(viewType: string, uri: UriComponents, cancellation: CancellationToken): Promise<string> {\n\t\tconst document = this.getNotebookDocument(URI.revive(uri));\n\t\tconst provider = this._getProviderData(viewType);\n\n\t\tconst storagePath = this._extensionStoragePaths.workspaceValue(provider.extension) ?? this._extensionStoragePaths.globalValue(provider.extension);\n\t\tconst fileName = String(hash([document.uri.toString(), this._backupIdPool++]));\n\t\tconst backupUri = URI.joinPath(storagePath, fileName);\n\n\t\tconst backup = await provider.provider.backupNotebook(document.apiNotebook, { destination: backupUri }, cancellation);\n\t\tdocument.updateBackup(backup);\n\t\treturn backup.id;\n\t}\n\n\n\tprivate _createExtHostEditor(document: ExtHostNotebookDocument, editorId: string, data: INotebookEditorAddData) {\n\n\t\tif (this._editors.has(editorId)) {\n\t\t\tthrow new Error(`editor with id ALREADY EXSIST: ${editorId}`);\n\t\t}\n\n\t\tconst editor = new ExtHostNotebookEditor(\n\t\t\teditorId,\n\t\t\tthis._notebookEditorsProxy,\n\t\t\tdocument,\n\t\t\tdata.visibleRanges.map(typeConverters.NotebookRange.to),\n\t\t\tdata.selections.map(typeConverters.NotebookRange.to),\n\t\t\ttypeof data.viewColumn === 'number' ? typeConverters.ViewColumn.to(data.viewColumn) : undefined\n\t\t);\n\n\t\tthis._editors.set(editorId, editor);\n\t}\n\n\t$acceptDocumentAndEditorsDelta(delta: SerializableObjectWithBuffers<INotebookDocumentsAndEditorsDelta>): void {\n\n\t\tif (delta.value.removedDocuments) {\n\t\t\tfor (const uri of delta.value.removedDocuments) {\n\t\t\t\tconst revivedUri = URI.revive(uri);\n\t\t\t\tconst document = this._documents.get(revivedUri);\n\n\t\t\t\tif (document) {\n\t\t\t\t\tdocument.dispose();\n\t\t\t\t\tthis._documents.delete(revivedUri);\n\t\t\t\t\tthis._textDocumentsAndEditors.$acceptDocumentsAndEditorsDelta({ removedDocuments: document.apiNotebook.getCells().map(cell => cell.document.uri) });\n\t\t\t\t\tthis._onDidCloseNotebookDocument.fire(document.apiNotebook);\n\t\t\t\t}\n\n\t\t\t\tfor (const editor of this._editors.values()) {\n\t\t\t\t\tif (editor.notebookData.uri.toString() === revivedUri.toString()) {\n\t\t\t\t\t\tthis._editors.delete(editor.id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (delta.value.addedDocuments) {\n\n\t\t\tconst addedCellDocuments: IModelAddedData[] = [];\n\n\t\t\tfor (const modelData of delta.value.addedDocuments) {\n\t\t\t\tconst uri = URI.revive(modelData.uri);\n\n\t\t\t\tif (this._documents.has(uri)) {\n\t\t\t\t\tthrow new Error(`adding EXISTING notebook ${uri} `);\n\t\t\t\t}\n\n\t\t\t\tconst document = new ExtHostNotebookDocument(\n\t\t\t\t\tthis._notebookDocumentsProxy,\n\t\t\t\t\tthis._textDocumentsAndEditors,\n\t\t\t\t\tthis._textDocuments,\n\t\t\t\t\turi,\n\t\t\t\t\tmodelData\n\t\t\t\t);\n\n\t\t\t\t// add cell document as vscode.TextDocument\n\t\t\t\taddedCellDocuments.push(...modelData.cells.map(cell => ExtHostCell.asModelAddData(document.apiNotebook, cell)));\n\n\t\t\t\tthis._documents.get(uri)?.dispose();\n\t\t\t\tthis._documents.set(uri, document);\n\t\t\t\tthis._textDocumentsAndEditors.$acceptDocumentsAndEditorsDelta({ addedDocuments: addedCellDocuments });\n\n\t\t\t\tthis._onDidOpenNotebookDocument.fire(document.apiNotebook);\n\t\t\t}\n\t\t}\n\n\t\tif (delta.value.addedEditors) {\n\t\t\tfor (const editorModelData of delta.value.addedEditors) {\n\t\t\t\tif (this._editors.has(editorModelData.id)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst revivedUri = URI.revive(editorModelData.documentUri);\n\t\t\t\tconst document = this._documents.get(revivedUri);\n\n\t\t\t\tif (document) {\n\t\t\t\t\tthis._createExtHostEditor(document, editorModelData.id, editorModelData);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst removedEditors: ExtHostNotebookEditor[] = [];\n\n\t\tif (delta.value.removedEditors) {\n\t\t\tfor (const editorid of delta.value.removedEditors) {\n\t\t\t\tconst editor = this._editors.get(editorid);\n\n\t\t\t\tif (editor) {\n\t\t\t\t\tthis._editors.delete(editorid);\n\n\t\t\t\t\tif (this._activeNotebookEditor?.id === editor.id) {\n\t\t\t\t\t\tthis._activeNotebookEditor = undefined;\n\t\t\t\t\t}\n\n\t\t\t\t\tremovedEditors.push(editor);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (delta.value.visibleEditors) {\n\t\t\tthis._visibleNotebookEditors = delta.value.visibleEditors.map(id => this._editors.get(id)!).filter(editor => !!editor) as ExtHostNotebookEditor[];\n\t\t\tconst visibleEditorsSet = new Set<string>();\n\t\t\tthis._visibleNotebookEditors.forEach(editor => visibleEditorsSet.add(editor.id));\n\n\t\t\tfor (const editor of this._editors.values()) {\n\t\t\t\tconst newValue = visibleEditorsSet.has(editor.id);\n\t\t\t\teditor._acceptVisibility(newValue);\n\t\t\t}\n\n\t\t\tthis._visibleNotebookEditors = [...this._editors.values()].map(e => e).filter(e => e.visible);\n\t\t\tthis._onDidChangeVisibleNotebookEditors.fire(this.visibleNotebookEditors);\n\t\t}\n\n\t\tif (delta.value.newActiveEditor === null) {\n\t\t\t// clear active notebook as current active editor is non-notebook editor\n\t\t\tthis._activeNotebookEditor = undefined;\n\t\t} else if (delta.value.newActiveEditor) {\n\t\t\tthis._activeNotebookEditor = this._editors.get(delta.value.newActiveEditor);\n\t\t}\n\t\tif (delta.value.newActiveEditor !== undefined) {\n\t\t\tthis._onDidChangeActiveNotebookEditor.fire(this._activeNotebookEditor?.apiEditor);\n\t\t}\n\t}\n\n\tprivate static _registerApiCommands(extHostCommands: ExtHostCommands) {\n\n\t\tconst notebookTypeArg = ApiCommandArgument.String.with('notebookType', 'A notebook type');\n\n\t\tconst commandDataToNotebook = new ApiCommand(\n\t\t\t'vscode.executeDataToNotebook', '_executeDataToNotebook', 'Invoke notebook serializer',\n\t\t\t[notebookTypeArg, new ApiCommandArgument<Uint8Array, VSBuffer>('data', 'Bytes to convert to data', v => v instanceof Uint8Array, v => VSBuffer.wrap(v))],\n\t\t\tnew ApiCommandResult<SerializableObjectWithBuffers<NotebookDataDto>, vscode.NotebookData>('Notebook Data', data => typeConverters.NotebookData.to(data.value))\n\t\t);\n\n\t\tconst commandNotebookToData = new ApiCommand(\n\t\t\t'vscode.executeNotebookToData', '_executeNotebookToData', 'Invoke notebook serializer',\n\t\t\t[notebookTypeArg, new ApiCommandArgument<vscode.NotebookData, SerializableObjectWithBuffers<NotebookDataDto>>('NotebookData', 'Notebook data to convert to bytes', v => true, v => new SerializableObjectWithBuffers(typeConverters.NotebookData.from(v)))],\n\t\t\tnew ApiCommandResult<VSBuffer, Uint8Array>('Bytes', dto => dto.buffer)\n\t\t);\n\n\t\textHostCommands.registerApiCommand(commandDataToNotebook);\n\t\textHostCommands.registerApiCommand(commandNotebookToData);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { asArray } from 'vs/base/common/arrays';\nimport { DeferredPromise, timeout } from 'vs/base/common/async';\nimport { CancellationTokenSource } from 'vs/base/common/cancellation';\nimport { Emitter } from 'vs/base/common/event';\nimport { Disposable, DisposableStore } from 'vs/base/common/lifecycle';\nimport { ResourceMap } from 'vs/base/common/map';\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { ExtensionIdentifier, IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { ExtHostNotebookKernelsShape, ICellExecuteUpdateDto, IMainContext, INotebookKernelDto2, MainContext, MainThreadNotebookKernelsShape, NotebookOutputDto } from 'vs/workbench/api/common/extHost.protocol';\nimport { ApiCommand, ApiCommandArgument, ApiCommandResult, ExtHostCommands } from 'vs/workbench/api/common/extHostCommands';\nimport { IExtHostInitDataService } from 'vs/workbench/api/common/extHostInitDataService';\nimport { ExtHostNotebookController } from 'vs/workbench/api/common/extHostNotebook';\nimport { ExtHostCell } from 'vs/workbench/api/common/extHostNotebookDocument';\nimport * as extHostTypeConverters from 'vs/workbench/api/common/extHostTypeConverters';\nimport { NotebookCellExecutionState as ExtHostNotebookCellExecutionState, NotebookCellOutput } from 'vs/workbench/api/common/extHostTypes';\nimport { asWebviewUri } from 'vs/workbench/common/webview';\nimport { NotebookCellExecutionState } from 'vs/workbench/contrib/notebook/common/notebookCommon';\nimport { CellExecutionUpdateType } from 'vs/workbench/contrib/notebook/common/notebookExecutionService';\nimport { checkProposedApiEnabled } from 'vs/workbench/services/extensions/common/extensions';\nimport { SerializableObjectWithBuffers } from 'vs/workbench/services/extensions/common/proxyIdentifier';\nimport * as vscode from 'vscode';\n\ninterface IKernelData {\n\textensionId: ExtensionIdentifier;\n\tcontroller: vscode.NotebookController;\n\tonDidChangeSelection: Emitter<{ selected: boolean; notebook: vscode.NotebookDocument }>;\n\tonDidReceiveMessage: Emitter<{ editor: vscode.NotebookEditor; message: any }>;\n\tassociatedNotebooks: ResourceMap<boolean>;\n}\n\ntype ExtHostSelectKernelArgs = ControllerInfo | { notebookEditor: vscode.NotebookEditor } | ControllerInfo & { notebookEditor: vscode.NotebookEditor } | undefined;\nexport type SelectKernelReturnArgs = ControllerInfo | { notebookEditorId: string } | ControllerInfo & { notebookEditorId: string } | undefined;\ntype ControllerInfo = { id: string; extension: string };\n\n\nexport class ExtHostNotebookKernels implements ExtHostNotebookKernelsShape {\n\n\tprivate readonly _proxy: MainThreadNotebookKernelsShape;\n\tprivate readonly _activeExecutions = new ResourceMap<NotebookCellExecutionTask>();\n\n\tprivate readonly _kernelData = new Map<number, IKernelData>();\n\tprivate _handlePool: number = 0;\n\n\tprivate readonly _onDidChangeCellExecutionState = new Emitter<vscode.NotebookCellExecutionStateChangeEvent>();\n\treadonly onDidChangeNotebookCellExecutionState = this._onDidChangeCellExecutionState.event;\n\n\tconstructor(\n\t\tmainContext: IMainContext,\n\t\tprivate readonly _initData: IExtHostInitDataService,\n\t\tprivate readonly _extHostNotebook: ExtHostNotebookController,\n\t\tprivate _commands: ExtHostCommands,\n\t\t@ILogService private readonly _logService: ILogService,\n\t) {\n\t\tthis._proxy = mainContext.getProxy(MainContext.MainThreadNotebookKernels);\n\n\t\t// todo@rebornix @joyceerhl: move to APICommands once stabilized.\n\t\tconst selectKernelApiCommand = new ApiCommand(\n\t\t\t'notebook.selectKernel',\n\t\t\t'_notebook.selectKernel',\n\t\t\t'Trigger kernel picker for specified notebook editor widget',\n\t\t\t[\n\t\t\t\tnew ApiCommandArgument<ExtHostSelectKernelArgs, SelectKernelReturnArgs>('options', 'Select kernel options', v => true, (v: ExtHostSelectKernelArgs) => {\n\t\t\t\t\tif (v && 'notebookEditor' in v && 'id' in v) {\n\t\t\t\t\t\tconst notebookEditorId = this._extHostNotebook.getIdByEditor(v.notebookEditor);\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tid: v.id, extension: v.extension, notebookEditorId\n\t\t\t\t\t\t};\n\t\t\t\t\t} else if (v && 'notebookEditor' in v) {\n\t\t\t\t\t\tconst notebookEditorId = this._extHostNotebook.getIdByEditor(v.notebookEditor);\n\t\t\t\t\t\tif (notebookEditorId === undefined) {\n\t\t\t\t\t\t\tthrow new Error(`Cannot invoke 'notebook.selectKernel' for unrecognized notebook editor ${v.notebookEditor.document.uri.toString()}`);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn { notebookEditorId };\n\t\t\t\t\t}\n\t\t\t\t\treturn v;\n\t\t\t\t})\n\t\t\t],\n\t\t\tApiCommandResult.Void);\n\t\tthis._commands.registerApiCommand(selectKernelApiCommand);\n\t}\n\n\tcreateNotebookController(extension: IExtensionDescription, id: string, viewType: string, label: string, handler?: (cells: vscode.NotebookCell[], notebook: vscode.NotebookDocument, controller: vscode.NotebookController) => void | Thenable<void>, preloads?: vscode.NotebookRendererScript[]): vscode.NotebookController {\n\n\t\tfor (const data of this._kernelData.values()) {\n\t\t\tif (data.controller.id === id && ExtensionIdentifier.equals(extension.identifier, data.extensionId)) {\n\t\t\t\tthrow new Error(`notebook controller with id '${id}' ALREADY exist`);\n\t\t\t}\n\t\t}\n\n\n\t\tconst handle = this._handlePool++;\n\t\tconst that = this;\n\n\t\tthis._logService.trace(`NotebookController[${handle}], CREATED by ${extension.identifier.value}, ${id}`);\n\n\t\tconst _defaultExecutHandler = () => console.warn(`NO execute handler from notebook controller '${data.id}' of extension: '${extension.identifier}'`);\n\n\t\tlet isDisposed = false;\n\t\tconst commandDisposables = new DisposableStore();\n\n\t\tconst onDidChangeSelection = new Emitter<{ selected: boolean; notebook: vscode.NotebookDocument }>();\n\t\tconst onDidReceiveMessage = new Emitter<{ editor: vscode.NotebookEditor; message: any }>();\n\n\t\tconst data: INotebookKernelDto2 = {\n\t\t\tid: createKernelId(extension.identifier, id),\n\t\t\tnotebookType: viewType,\n\t\t\textensionId: extension.identifier,\n\t\t\textensionLocation: extension.extensionLocation,\n\t\t\tlabel: label || extension.identifier.value,\n\t\t\tpreloads: preloads ? preloads.map(extHostTypeConverters.NotebookRendererScript.from) : []\n\t\t};\n\n\t\t//\n\t\tlet _executeHandler = handler ?? _defaultExecutHandler;\n\t\tlet _interruptHandler: ((this: vscode.NotebookController, notebook: vscode.NotebookDocument) => void | Thenable<void>) | undefined;\n\n\t\tthis._proxy.$addKernel(handle, data).catch(err => {\n\t\t\t// this can happen when a kernel with that ID is already registered\n\t\t\tconsole.log(err);\n\t\t\tisDisposed = true;\n\t\t});\n\n\t\t// update: all setters write directly into the dto object\n\t\t// and trigger an update. the actual update will only happen\n\t\t// once per event loop execution\n\t\tlet tokenPool = 0;\n\t\tconst _update = () => {\n\t\t\tif (isDisposed) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst myToken = ++tokenPool;\n\t\t\tPromise.resolve().then(() => {\n\t\t\t\tif (myToken === tokenPool) {\n\t\t\t\t\tthis._proxy.$updateKernel(handle, data);\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\t// notebook documents that are associated to this controller\n\t\tconst associatedNotebooks = new ResourceMap<boolean>();\n\n\t\tconst controller: vscode.NotebookController = {\n\t\t\tget id() { return id; },\n\t\t\tget notebookType() { return data.notebookType; },\n\t\t\tonDidChangeSelectedNotebooks: onDidChangeSelection.event,\n\t\t\tget label() {\n\t\t\t\treturn data.label;\n\t\t\t},\n\t\t\tset label(value) {\n\t\t\t\tdata.label = value ?? extension.displayName ?? extension.name;\n\t\t\t\t_update();\n\t\t\t},\n\t\t\tget detail() {\n\t\t\t\treturn data.detail ?? '';\n\t\t\t},\n\t\t\tset detail(value) {\n\t\t\t\tdata.detail = value;\n\t\t\t\t_update();\n\t\t\t},\n\t\t\tget description() {\n\t\t\t\treturn data.description ?? '';\n\t\t\t},\n\t\t\tset description(value) {\n\t\t\t\tdata.description = value;\n\t\t\t\t_update();\n\t\t\t},\n\t\t\tget kind() {\n\t\t\t\tcheckProposedApiEnabled(extension, 'notebookControllerKind');\n\t\t\t\treturn data.kind ?? '';\n\t\t\t},\n\t\t\tset kind(value) {\n\t\t\t\tcheckProposedApiEnabled(extension, 'notebookControllerKind');\n\t\t\t\tdata.kind = value;\n\t\t\t\t_update();\n\t\t\t},\n\t\t\tget supportedLanguages() {\n\t\t\t\treturn data.supportedLanguages;\n\t\t\t},\n\t\t\tset supportedLanguages(value) {\n\t\t\t\tdata.supportedLanguages = value;\n\t\t\t\t_update();\n\t\t\t},\n\t\t\tget supportsExecutionOrder() {\n\t\t\t\treturn data.supportsExecutionOrder ?? false;\n\t\t\t},\n\t\t\tset supportsExecutionOrder(value) {\n\t\t\t\tdata.supportsExecutionOrder = value;\n\t\t\t\t_update();\n\t\t\t},\n\t\t\tget rendererScripts() {\n\t\t\t\treturn data.preloads ? data.preloads.map(extHostTypeConverters.NotebookRendererScript.to) : [];\n\t\t\t},\n\t\t\tget executeHandler() {\n\t\t\t\treturn _executeHandler;\n\t\t\t},\n\t\t\tset executeHandler(value) {\n\t\t\t\t_executeHandler = value ?? _defaultExecutHandler;\n\t\t\t},\n\t\t\tget interruptHandler() {\n\t\t\t\treturn _interruptHandler;\n\t\t\t},\n\t\t\tset interruptHandler(value) {\n\t\t\t\t_interruptHandler = value;\n\t\t\t\tdata.supportsInterrupt = Boolean(value);\n\t\t\t\t_update();\n\t\t\t},\n\t\t\tcreateNotebookCellExecution(cell) {\n\t\t\t\tif (isDisposed) {\n\t\t\t\t\tthrow new Error('notebook controller is DISPOSED');\n\t\t\t\t}\n\t\t\t\tif (!associatedNotebooks.has(cell.notebook.uri)) {\n\t\t\t\t\tthat._logService.trace(`NotebookController[${handle}] NOT associated to notebook, associated to THESE notebooks:`, Array.from(associatedNotebooks.keys()).map(u => u.toString()));\n\t\t\t\t\tthrow new Error(`notebook controller is NOT associated to notebook: ${cell.notebook.uri.toString()}`);\n\t\t\t\t}\n\t\t\t\treturn that._createNotebookCellExecution(cell, createKernelId(extension.identifier, this.id));\n\t\t\t},\n\t\t\tdispose: () => {\n\t\t\t\tif (!isDisposed) {\n\t\t\t\t\tthis._logService.trace(`NotebookController[${handle}], DISPOSED`);\n\t\t\t\t\tisDisposed = true;\n\t\t\t\t\tthis._kernelData.delete(handle);\n\t\t\t\t\tcommandDisposables.dispose();\n\t\t\t\t\tonDidChangeSelection.dispose();\n\t\t\t\t\tonDidReceiveMessage.dispose();\n\t\t\t\t\tthis._proxy.$removeKernel(handle);\n\t\t\t\t}\n\t\t\t},\n\t\t\t// --- priority\n\t\t\tupdateNotebookAffinity(notebook, priority) {\n\t\t\t\tthat._proxy.$updateNotebookPriority(handle, notebook.uri, priority);\n\t\t\t},\n\t\t\t// --- ipc\n\t\t\tonDidReceiveMessage: onDidReceiveMessage.event,\n\t\t\tpostMessage(message, editor) {\n\t\t\t\tcheckProposedApiEnabled(extension, 'notebookMessaging');\n\t\t\t\treturn that._proxy.$postMessage(handle, editor && that._extHostNotebook.getIdByEditor(editor), message);\n\t\t\t},\n\t\t\tasWebviewUri(uri: URI) {\n\t\t\t\tcheckProposedApiEnabled(extension, 'notebookMessaging');\n\t\t\t\treturn asWebviewUri(uri, that._initData.remote);\n\t\t\t},\n\t\t};\n\n\t\tthis._kernelData.set(handle, {\n\t\t\textensionId: extension.identifier,\n\t\t\tcontroller,\n\t\t\tonDidReceiveMessage,\n\t\t\tonDidChangeSelection,\n\t\t\tassociatedNotebooks\n\t\t});\n\t\treturn controller;\n\t}\n\n\tgetIdByController(controller: vscode.NotebookController) {\n\t\tfor (const [_, candidate] of this._kernelData) {\n\t\t\tif (candidate.controller === controller) {\n\t\t\t\treturn createKernelId(candidate.extensionId, controller.id);\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\t$acceptNotebookAssociation(handle: number, uri: UriComponents, value: boolean): void {\n\t\tconst obj = this._kernelData.get(handle);\n\t\tif (obj) {\n\t\t\t// update data structure\n\t\t\tconst notebook = this._extHostNotebook.getNotebookDocument(URI.revive(uri))!;\n\t\t\tif (value) {\n\t\t\t\tobj.associatedNotebooks.set(notebook.uri, true);\n\t\t\t} else {\n\t\t\t\tobj.associatedNotebooks.delete(notebook.uri);\n\t\t\t}\n\t\t\tthis._logService.trace(`NotebookController[${handle}] ASSOCIATE notebook`, notebook.uri.toString(), value);\n\t\t\t// send event\n\t\t\tobj.onDidChangeSelection.fire({\n\t\t\t\tselected: value,\n\t\t\t\tnotebook: notebook.apiNotebook\n\t\t\t});\n\t\t}\n\t}\n\n\tasync $executeCells(handle: number, uri: UriComponents, handles: number[]): Promise<void> {\n\t\tconst obj = this._kernelData.get(handle);\n\t\tif (!obj) {\n\t\t\t// extension can dispose kernels in the meantime\n\t\t\treturn;\n\t\t}\n\t\tconst document = this._extHostNotebook.getNotebookDocument(URI.revive(uri));\n\t\tconst cells: vscode.NotebookCell[] = [];\n\t\tfor (const cellHandle of handles) {\n\t\t\tconst cell = document.getCell(cellHandle);\n\t\t\tif (cell) {\n\t\t\t\tcells.push(cell.apiCell);\n\t\t\t}\n\t\t}\n\n\t\ttry {\n\t\t\tthis._logService.trace(`NotebookController[${handle}] EXECUTE cells`, document.uri.toString(), cells.length);\n\t\t\tawait obj.controller.executeHandler.call(obj.controller, cells, document.apiNotebook, obj.controller);\n\t\t} catch (err) {\n\t\t\t//\n\t\t\tthis._logService.error(`NotebookController[${handle}] execute cells FAILED`, err);\n\t\t\tconsole.error(err);\n\t\t}\n\t}\n\n\tasync $cancelCells(handle: number, uri: UriComponents, handles: number[]): Promise<void> {\n\t\tconst obj = this._kernelData.get(handle);\n\t\tif (!obj) {\n\t\t\t// extension can dispose kernels in the meantime\n\t\t\treturn;\n\t\t}\n\n\t\t// cancel or interrupt depends on the controller. When an interrupt handler is used we\n\t\t// don't trigger the cancelation token of executions.\n\t\tconst document = this._extHostNotebook.getNotebookDocument(URI.revive(uri));\n\t\tif (obj.controller.interruptHandler) {\n\t\t\tawait obj.controller.interruptHandler.call(obj.controller, document.apiNotebook);\n\n\t\t} else {\n\t\t\tfor (const cellHandle of handles) {\n\t\t\t\tconst cell = document.getCell(cellHandle);\n\t\t\t\tif (cell) {\n\t\t\t\t\tthis._activeExecutions.get(cell.uri)?.cancel();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t$acceptKernelMessageFromRenderer(handle: number, editorId: string, message: any): void {\n\t\tconst obj = this._kernelData.get(handle);\n\t\tif (!obj) {\n\t\t\t// extension can dispose kernels in the meantime\n\t\t\treturn;\n\t\t}\n\n\t\tconst editor = this._extHostNotebook.getEditorById(editorId);\n\t\tobj.onDidReceiveMessage.fire(Object.freeze({ editor: editor.apiEditor, message }));\n\t}\n\n\t$cellExecutionChanged(uri: UriComponents, cellHandle: number, state: NotebookCellExecutionState | undefined): void {\n\t\tconst document = this._extHostNotebook.getNotebookDocument(URI.revive(uri));\n\t\tconst cell = document.getCell(cellHandle);\n\t\tif (cell) {\n\t\t\tthis._onDidChangeCellExecutionState.fire({\n\t\t\t\tcell: cell.apiCell,\n\t\t\t\tstate: state ? extHostTypeConverters.NotebookCellExecutionState.to(state) : ExtHostNotebookCellExecutionState.Idle\n\t\t\t});\n\t\t}\n\t}\n\n\t// ---\n\n\t_createNotebookCellExecution(cell: vscode.NotebookCell, controllerId: string): vscode.NotebookCellExecution {\n\t\tif (cell.index < 0) {\n\t\t\tthrow new Error('CANNOT execute cell that has been REMOVED from notebook');\n\t\t}\n\t\tconst notebook = this._extHostNotebook.getNotebookDocument(cell.notebook.uri);\n\t\tconst cellObj = notebook.getCellFromApiCell(cell);\n\t\tif (!cellObj) {\n\t\t\tthrow new Error('invalid cell');\n\t\t}\n\t\tif (this._activeExecutions.has(cellObj.uri)) {\n\t\t\tthrow new Error(`duplicate execution for ${cellObj.uri}`);\n\t\t}\n\t\tconst execution = new NotebookCellExecutionTask(controllerId, cellObj, this._proxy);\n\t\tthis._activeExecutions.set(cellObj.uri, execution);\n\t\tconst listener = execution.onDidChangeState(() => {\n\t\t\tif (execution.state === NotebookCellExecutionTaskState.Resolved) {\n\t\t\t\texecution.dispose();\n\t\t\t\tlistener.dispose();\n\t\t\t\tthis._activeExecutions.delete(cellObj.uri);\n\t\t\t}\n\t\t});\n\t\treturn execution.asApiObject();\n\t}\n}\n\n\nenum NotebookCellExecutionTaskState {\n\tInit,\n\tStarted,\n\tResolved\n}\n\nclass NotebookCellExecutionTask extends Disposable {\n\tprivate static HANDLE = 0;\n\tprivate _handle = NotebookCellExecutionTask.HANDLE++;\n\n\tprivate _onDidChangeState = new Emitter<void>();\n\treadonly onDidChangeState = this._onDidChangeState.event;\n\n\tprivate _state = NotebookCellExecutionTaskState.Init;\n\tget state(): NotebookCellExecutionTaskState { return this._state; }\n\n\tprivate readonly _tokenSource = this._register(new CancellationTokenSource());\n\n\tprivate readonly _collector: TimeoutBasedCollector<ICellExecuteUpdateDto>;\n\n\tprivate _executionOrder: number | undefined;\n\n\tconstructor(\n\t\tcontrollerId: string,\n\t\tprivate readonly _cell: ExtHostCell,\n\t\tprivate readonly _proxy: MainThreadNotebookKernelsShape\n\t) {\n\t\tsuper();\n\n\t\tthis._collector = new TimeoutBasedCollector(10, updates => this.update(updates));\n\n\t\tthis._executionOrder = _cell.internalMetadata.executionOrder;\n\t\tthis._proxy.$createExecution(this._handle, controllerId, this._cell.notebook.uri, this._cell.handle);\n\t}\n\n\tcancel(): void {\n\t\tthis._tokenSource.cancel();\n\t}\n\n\tprivate async updateSoon(update: ICellExecuteUpdateDto): Promise<void> {\n\t\tawait this._collector.addItem(update);\n\t}\n\n\tprivate async update(update: ICellExecuteUpdateDto | ICellExecuteUpdateDto[]): Promise<void> {\n\t\tconst updates = Array.isArray(update) ? update : [update];\n\t\treturn this._proxy.$updateExecution(this._handle, new SerializableObjectWithBuffers(updates));\n\t}\n\n\tprivate verifyStateForOutput() {\n\t\tif (this._state === NotebookCellExecutionTaskState.Init) {\n\t\t\tthrow new Error('Must call start before modifying cell output');\n\t\t}\n\n\t\tif (this._state === NotebookCellExecutionTaskState.Resolved) {\n\t\t\tthrow new Error('Cannot modify cell output after calling resolve');\n\t\t}\n\t}\n\n\tprivate cellIndexToHandle(cellOrCellIndex: vscode.NotebookCell | undefined): number {\n\t\tlet cell: ExtHostCell | undefined = this._cell;\n\t\tif (cellOrCellIndex) {\n\t\t\tcell = this._cell.notebook.getCellFromApiCell(cellOrCellIndex);\n\t\t}\n\t\tif (!cell) {\n\t\t\tthrow new Error('INVALID cell');\n\t\t}\n\t\treturn cell.handle;\n\t}\n\n\tprivate validateAndConvertOutputs(items: vscode.NotebookCellOutput[]): NotebookOutputDto[] {\n\t\treturn items.map(output => {\n\t\t\tconst newOutput = NotebookCellOutput.ensureUniqueMimeTypes(output.items, true);\n\t\t\tif (newOutput === output.items) {\n\t\t\t\treturn extHostTypeConverters.NotebookCellOutput.from(output);\n\t\t\t}\n\t\t\treturn extHostTypeConverters.NotebookCellOutput.from({\n\t\t\t\titems: newOutput,\n\t\t\t\tid: output.id,\n\t\t\t\tmetadata: output.metadata\n\t\t\t});\n\t\t});\n\t}\n\n\tprivate async updateOutputs(outputs: vscode.NotebookCellOutput | vscode.NotebookCellOutput[], cell: vscode.NotebookCell | undefined, append: boolean): Promise<void> {\n\t\tconst handle = this.cellIndexToHandle(cell);\n\t\tconst outputDtos = this.validateAndConvertOutputs(asArray(outputs));\n\t\treturn this.updateSoon(\n\t\t\t{\n\t\t\t\teditType: CellExecutionUpdateType.Output,\n\t\t\t\tcellHandle: handle,\n\t\t\t\tappend,\n\t\t\t\toutputs: outputDtos\n\t\t\t});\n\t}\n\n\tprivate async updateOutputItems(items: vscode.NotebookCellOutputItem | vscode.NotebookCellOutputItem[], output: vscode.NotebookCellOutput, append: boolean): Promise<void> {\n\t\titems = NotebookCellOutput.ensureUniqueMimeTypes(asArray(items), true);\n\t\treturn this.updateSoon({\n\t\t\teditType: CellExecutionUpdateType.OutputItems,\n\t\t\titems: items.map(extHostTypeConverters.NotebookCellOutputItem.from),\n\t\t\toutputId: output.id,\n\t\t\tappend\n\t\t});\n\t}\n\n\tasApiObject(): vscode.NotebookCellExecution {\n\t\tconst that = this;\n\t\tconst result: vscode.NotebookCellExecution = {\n\t\t\tget token() { return that._tokenSource.token; },\n\t\t\tget cell() { return that._cell.apiCell; },\n\t\t\tget executionOrder() { return that._executionOrder; },\n\t\t\tset executionOrder(v: number | undefined) {\n\t\t\t\tthat._executionOrder = v;\n\t\t\t\tthat.update([{\n\t\t\t\t\teditType: CellExecutionUpdateType.ExecutionState,\n\t\t\t\t\texecutionOrder: that._executionOrder\n\t\t\t\t}]);\n\t\t\t},\n\n\t\t\tstart(startTime?: number): void {\n\t\t\t\tif (that._state === NotebookCellExecutionTaskState.Resolved || that._state === NotebookCellExecutionTaskState.Started) {\n\t\t\t\t\tthrow new Error('Cannot call start again');\n\t\t\t\t}\n\n\t\t\t\tthat._state = NotebookCellExecutionTaskState.Started;\n\t\t\t\tthat._onDidChangeState.fire();\n\n\t\t\t\tthat.update({\n\t\t\t\t\teditType: CellExecutionUpdateType.ExecutionState,\n\t\t\t\t\trunStartTime: startTime\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tend(success: boolean | undefined, endTime?: number): void {\n\t\t\t\tif (that._state === NotebookCellExecutionTaskState.Resolved) {\n\t\t\t\t\tthrow new Error('Cannot call resolve twice');\n\t\t\t\t}\n\n\t\t\t\tthat._state = NotebookCellExecutionTaskState.Resolved;\n\t\t\t\tthat._onDidChangeState.fire();\n\n\t\t\t\t// The last update needs to be ordered correctly and applied immediately,\n\t\t\t\t// so we use updateSoon and immediately flush.\n\t\t\t\tthat._collector.flush();\n\n\t\t\t\tthat._proxy.$completeExecution(that._handle, new SerializableObjectWithBuffers({\n\t\t\t\t\trunEndTime: endTime,\n\t\t\t\t\tlastRunSuccess: success\n\t\t\t\t}));\n\t\t\t},\n\n\t\t\tclearOutput(cell?: vscode.NotebookCell): Thenable<void> {\n\t\t\t\tthat.verifyStateForOutput();\n\t\t\t\treturn that.updateOutputs([], cell, false);\n\t\t\t},\n\n\t\t\tappendOutput(outputs: vscode.NotebookCellOutput | vscode.NotebookCellOutput[], cell?: vscode.NotebookCell): Promise<void> {\n\t\t\t\tthat.verifyStateForOutput();\n\t\t\t\treturn that.updateOutputs(outputs, cell, true);\n\t\t\t},\n\n\t\t\treplaceOutput(outputs: vscode.NotebookCellOutput | vscode.NotebookCellOutput[], cell?: vscode.NotebookCell): Promise<void> {\n\t\t\t\tthat.verifyStateForOutput();\n\t\t\t\treturn that.updateOutputs(outputs, cell, false);\n\t\t\t},\n\n\t\t\tappendOutputItems(items: vscode.NotebookCellOutputItem | vscode.NotebookCellOutputItem[], output: vscode.NotebookCellOutput): Promise<void> {\n\t\t\t\tthat.verifyStateForOutput();\n\t\t\t\treturn that.updateOutputItems(items, output, true);\n\t\t\t},\n\n\t\t\treplaceOutputItems(items: vscode.NotebookCellOutputItem | vscode.NotebookCellOutputItem[], output: vscode.NotebookCellOutput): Promise<void> {\n\t\t\t\tthat.verifyStateForOutput();\n\t\t\t\treturn that.updateOutputItems(items, output, false);\n\t\t\t}\n\t\t};\n\t\treturn Object.freeze(result);\n\t}\n}\n\nclass TimeoutBasedCollector<T> {\n\tprivate batch: T[] = [];\n\tprivate startedTimer = Date.now();\n\tprivate currentDeferred: DeferredPromise<void> | undefined;\n\n\tconstructor(\n\t\tprivate readonly delay: number,\n\t\tprivate readonly callback: (items: T[]) => Promise<void>) { }\n\n\taddItem(item: T): Promise<void> {\n\t\tthis.batch.push(item);\n\t\tif (!this.currentDeferred) {\n\t\t\tthis.currentDeferred = new DeferredPromise<void>();\n\t\t\tthis.startedTimer = Date.now();\n\t\t\ttimeout(this.delay).then(() => {\n\t\t\t\treturn this.flush();\n\t\t\t});\n\t\t}\n\n\t\t// This can be called by the extension repeatedly for a long time before the timeout is able to run.\n\t\t// Force a flush after the delay.\n\t\tif (Date.now() - this.startedTimer > this.delay) {\n\t\t\treturn this.flush();\n\t\t}\n\n\t\treturn this.currentDeferred.p;\n\t}\n\n\tflush(): Promise<void> {\n\t\tif (this.batch.length === 0 || !this.currentDeferred) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst deferred = this.currentDeferred;\n\t\tthis.currentDeferred = undefined;\n\t\tconst batch = this.batch;\n\t\tthis.batch = [];\n\t\treturn this.callback(batch)\n\t\t\t.finally(() => deferred.complete());\n\t}\n}\n\nexport function createKernelId(extensionIdentifier: ExtensionIdentifier, id: string): string {\n\treturn `${extensionIdentifier.value}/${id}`;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter } from 'vs/base/common/event';\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { ExtHostNotebookRenderersShape, IMainContext, MainContext, MainThreadNotebookRenderersShape } from 'vs/workbench/api/common/extHost.protocol';\nimport { ExtHostNotebookController } from 'vs/workbench/api/common/extHostNotebook';\nimport { ExtHostNotebookEditor } from 'vs/workbench/api/common/extHostNotebookEditor';\nimport * as vscode from 'vscode';\n\n\nexport class ExtHostNotebookRenderers implements ExtHostNotebookRenderersShape {\n\tprivate readonly _rendererMessageEmitters = new Map<string /* rendererId */, Emitter<{ editor: vscode.NotebookEditor; message: any }>>();\n\tprivate readonly proxy: MainThreadNotebookRenderersShape;\n\n\tconstructor(mainContext: IMainContext, private readonly _extHostNotebook: ExtHostNotebookController) {\n\t\tthis.proxy = mainContext.getProxy(MainContext.MainThreadNotebookRenderers);\n\t}\n\n\tpublic $postRendererMessage(editorId: string, rendererId: string, message: unknown): void {\n\t\tconst editor = this._extHostNotebook.getEditorById(editorId);\n\t\tthis._rendererMessageEmitters.get(rendererId)?.fire({ editor: editor.apiEditor, message });\n\t}\n\n\tpublic createRendererMessaging(manifest: IExtensionDescription, rendererId: string): vscode.NotebookRendererMessaging {\n\t\tif (!manifest.contributes?.notebookRenderer?.some(r => r.id === rendererId)) {\n\t\t\tthrow new Error(`Extensions may only call createRendererMessaging() for renderers they contribute (got ${rendererId})`);\n\t\t}\n\n\t\tconst messaging: vscode.NotebookRendererMessaging = {\n\t\t\tonDidReceiveMessage: (listener, thisArg, disposables) => {\n\t\t\t\treturn this.getOrCreateEmitterFor(rendererId).event(listener, thisArg, disposables);\n\t\t\t},\n\t\t\tpostMessage: (message, editorOrAlias) => {\n\t\t\t\tif (ExtHostNotebookEditor.apiEditorsToExtHost.has(message)) { // back compat for swapped args\n\t\t\t\t\t[message, editorOrAlias] = [editorOrAlias, message];\n\t\t\t\t}\n\n\t\t\t\tconst extHostEditor = editorOrAlias && ExtHostNotebookEditor.apiEditorsToExtHost.get(editorOrAlias);\n\t\t\t\treturn this.proxy.$postMessage(extHostEditor?.id, rendererId, message);\n\t\t\t},\n\t\t};\n\n\t\treturn messaging;\n\t}\n\n\tprivate getOrCreateEmitterFor(rendererId: string) {\n\t\tlet emitter = this._rendererMessageEmitters.get(rendererId);\n\t\tif (emitter) {\n\t\t\treturn emitter;\n\t\t}\n\n\t\temitter = new Emitter({\n\t\t\tonLastListenerRemove: () => {\n\t\t\t\temitter?.dispose();\n\t\t\t\tthis._rendererMessageEmitters.delete(rendererId);\n\t\t\t}\n\t\t});\n\n\t\tthis._rendererMessageEmitters.set(rendererId, emitter);\n\n\t\treturn emitter;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { Emitter } from 'vs/base/common/event';\nimport { dispose, IDisposable } from 'vs/base/common/lifecycle';\nimport { ExtHostCommands } from 'vs/workbench/api/common/extHostCommands';\nimport { IExtHostWorkspaceProvider } from 'vs/workbench/api/common/extHostWorkspace';\nimport { InputBox, InputBoxOptions, InputBoxValidationMessage, QuickInput, QuickInputButton, QuickPick, QuickPickItem, QuickPickItemButtonEvent, QuickPickOptions, WorkspaceFolder, WorkspaceFolderPickOptions } from 'vscode';\nimport { ExtHostQuickOpenShape, IMainContext, MainContext, TransferQuickInput, TransferQuickInputButton, TransferQuickPickItemOrSeparator } from './extHost.protocol';\nimport { URI } from 'vs/base/common/uri';\nimport { ThemeIcon, QuickInputButtons, QuickPickItemKind, InputBoxValidationSeverity } from 'vs/workbench/api/common/extHostTypes';\nimport { isCancellationError } from 'vs/base/common/errors';\nimport { ExtensionIdentifier, IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { coalesce } from 'vs/base/common/arrays';\nimport Severity from 'vs/base/common/severity';\nimport { ThemeIcon as ThemeIconUtils } from 'vs/platform/theme/common/themeService';\n\nexport type Item = string | QuickPickItem;\n\nexport interface ExtHostQuickOpen {\n\tshowQuickPick(itemsOrItemsPromise: QuickPickItem[] | Promise<QuickPickItem[]>, options: QuickPickOptions & { canPickMany: true }, token?: CancellationToken): Promise<QuickPickItem[] | undefined>;\n\tshowQuickPick(itemsOrItemsPromise: string[] | Promise<string[]>, options?: QuickPickOptions, token?: CancellationToken): Promise<string | undefined>;\n\tshowQuickPick(itemsOrItemsPromise: QuickPickItem[] | Promise<QuickPickItem[]>, options?: QuickPickOptions, token?: CancellationToken): Promise<QuickPickItem | undefined>;\n\tshowQuickPick(itemsOrItemsPromise: Item[] | Promise<Item[]>, options?: QuickPickOptions, token?: CancellationToken): Promise<Item | Item[] | undefined>;\n\n\tshowInput(options?: InputBoxOptions, token?: CancellationToken): Promise<string | undefined>;\n\n\tshowWorkspaceFolderPick(options?: WorkspaceFolderPickOptions, token?: CancellationToken): Promise<WorkspaceFolder | undefined>;\n\n\tcreateQuickPick<T extends QuickPickItem>(extension: IExtensionDescription): QuickPick<T>;\n\n\tcreateInputBox(extension: IExtensionDescription): InputBox;\n}\n\nexport function createExtHostQuickOpen(mainContext: IMainContext, workspace: IExtHostWorkspaceProvider, commands: ExtHostCommands): ExtHostQuickOpenShape & ExtHostQuickOpen {\n\tconst proxy = mainContext.getProxy(MainContext.MainThreadQuickOpen);\n\n\tclass ExtHostQuickOpenImpl implements ExtHostQuickOpenShape {\n\n\t\tprivate _workspace: IExtHostWorkspaceProvider;\n\t\tprivate _commands: ExtHostCommands;\n\n\t\tprivate _onDidSelectItem?: (handle: number) => void;\n\t\tprivate _validateInput?: (input: string) => string | InputBoxValidationMessage | undefined | null | Thenable<string | InputBoxValidationMessage | undefined | null>;\n\n\t\tprivate _sessions = new Map<number, ExtHostQuickInput>();\n\n\t\tprivate _instances = 0;\n\n\t\tconstructor(workspace: IExtHostWorkspaceProvider, commands: ExtHostCommands) {\n\t\t\tthis._workspace = workspace;\n\t\t\tthis._commands = commands;\n\t\t}\n\n\t\tshowQuickPick(itemsOrItemsPromise: QuickPickItem[] | Promise<QuickPickItem[]>, options: QuickPickOptions & { canPickMany: true }, token?: CancellationToken): Promise<QuickPickItem[] | undefined>;\n\t\tshowQuickPick(itemsOrItemsPromise: string[] | Promise<string[]>, options?: QuickPickOptions, token?: CancellationToken): Promise<string | undefined>;\n\t\tshowQuickPick(itemsOrItemsPromise: QuickPickItem[] | Promise<QuickPickItem[]>, options?: QuickPickOptions, token?: CancellationToken): Promise<QuickPickItem | undefined>;\n\t\tshowQuickPick(itemsOrItemsPromise: Item[] | Promise<Item[]>, options?: QuickPickOptions, token: CancellationToken = CancellationToken.None): Promise<Item | Item[] | undefined> {\n\n\t\t\t// clear state from last invocation\n\t\t\tthis._onDidSelectItem = undefined;\n\n\t\t\tconst itemsPromise = <Promise<Item[]>>Promise.resolve(itemsOrItemsPromise);\n\n\t\t\tconst instance = ++this._instances;\n\n\t\t\tconst quickPickWidget = proxy.$show(instance, {\n\t\t\t\ttitle: options?.title,\n\t\t\t\tplaceHolder: options?.placeHolder,\n\t\t\t\tmatchOnDescription: options?.matchOnDescription,\n\t\t\t\tmatchOnDetail: options?.matchOnDetail,\n\t\t\t\tignoreFocusLost: options?.ignoreFocusOut,\n\t\t\t\tcanPickMany: options?.canPickMany,\n\t\t\t}, token);\n\n\t\t\tconst widgetClosedMarker = {};\n\t\t\tconst widgetClosedPromise = quickPickWidget.then(() => widgetClosedMarker);\n\n\t\t\treturn Promise.race([widgetClosedPromise, itemsPromise]).then(result => {\n\t\t\t\tif (result === widgetClosedMarker) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\n\t\t\t\treturn itemsPromise.then(items => {\n\n\t\t\t\t\tconst pickItems: TransferQuickPickItemOrSeparator[] = [];\n\t\t\t\t\tfor (let handle = 0; handle < items.length; handle++) {\n\t\t\t\t\t\tconst item = items[handle];\n\t\t\t\t\t\tif (typeof item === 'string') {\n\t\t\t\t\t\t\tpickItems.push({ label: item, handle });\n\t\t\t\t\t\t} else if (item.kind === QuickPickItemKind.Separator) {\n\t\t\t\t\t\t\tpickItems.push({ type: 'separator', label: item.label });\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tpickItems.push({\n\t\t\t\t\t\t\t\tlabel: item.label,\n\t\t\t\t\t\t\t\tdescription: item.description,\n\t\t\t\t\t\t\t\tdetail: item.detail,\n\t\t\t\t\t\t\t\tpicked: item.picked,\n\t\t\t\t\t\t\t\talwaysShow: item.alwaysShow,\n\t\t\t\t\t\t\t\thandle\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// handle selection changes\n\t\t\t\t\tif (options && typeof options.onDidSelectItem === 'function') {\n\t\t\t\t\t\tthis._onDidSelectItem = (handle) => {\n\t\t\t\t\t\t\toptions.onDidSelectItem!(items[handle]);\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t\t// show items\n\t\t\t\t\tproxy.$setItems(instance, pickItems);\n\n\t\t\t\t\treturn quickPickWidget.then(handle => {\n\t\t\t\t\t\tif (typeof handle === 'number') {\n\t\t\t\t\t\t\treturn items[handle];\n\t\t\t\t\t\t} else if (Array.isArray(handle)) {\n\t\t\t\t\t\t\treturn handle.map(h => items[h]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}).then(undefined, err => {\n\t\t\t\tif (isCancellationError(err)) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\n\t\t\t\tproxy.$setError(instance, err);\n\n\t\t\t\treturn Promise.reject(err);\n\t\t\t});\n\t\t}\n\n\t\t$onItemSelected(handle: number): void {\n\t\t\tthis._onDidSelectItem?.(handle);\n\t\t}\n\n\t\t// ---- input\n\n\t\tshowInput(options?: InputBoxOptions, token: CancellationToken = CancellationToken.None): Promise<string | undefined> {\n\n\t\t\t// global validate fn used in callback below\n\t\t\tthis._validateInput = options?.validateInput;\n\n\t\t\treturn proxy.$input(options, typeof this._validateInput === 'function', token)\n\t\t\t\t.then(undefined, err => {\n\t\t\t\t\tif (isCancellationError(err)) {\n\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn Promise.reject(err);\n\t\t\t\t});\n\t\t}\n\n\t\tasync $validateInput(input: string): Promise<string | { content: string; severity: Severity } | null | undefined> {\n\t\t\tif (!this._validateInput) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst result = await this._validateInput(input);\n\t\t\tif (!result || typeof result === 'string') {\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tlet severity: Severity;\n\t\t\tswitch (result.severity) {\n\t\t\t\tcase InputBoxValidationSeverity.Info:\n\t\t\t\t\tseverity = Severity.Info;\n\t\t\t\t\tbreak;\n\t\t\t\tcase InputBoxValidationSeverity.Warning:\n\t\t\t\t\tseverity = Severity.Warning;\n\t\t\t\t\tbreak;\n\t\t\t\tcase InputBoxValidationSeverity.Error:\n\t\t\t\t\tseverity = Severity.Error;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tseverity = result.message ? Severity.Error : Severity.Ignore;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tcontent: result.message,\n\t\t\t\tseverity\n\t\t\t};\n\t\t}\n\n\t\t// ---- workspace folder picker\n\n\t\tasync showWorkspaceFolderPick(options?: WorkspaceFolderPickOptions, token = CancellationToken.None): Promise<WorkspaceFolder | undefined> {\n\t\t\tconst selectedFolder = await this._commands.executeCommand<WorkspaceFolder>('_workbench.pickWorkspaceFolder', [options]);\n\t\t\tif (!selectedFolder) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\tconst workspaceFolders = await this._workspace.getWorkspaceFolders2();\n\t\t\tif (!workspaceFolders) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\treturn workspaceFolders.find(folder => folder.uri.toString() === selectedFolder.uri.toString());\n\t\t}\n\n\t\t// ---- QuickInput\n\n\t\tcreateQuickPick<T extends QuickPickItem>(extension: IExtensionDescription): QuickPick<T> {\n\t\t\tconst session: ExtHostQuickPick<T> = new ExtHostQuickPick(extension, () => this._sessions.delete(session._id));\n\t\t\tthis._sessions.set(session._id, session);\n\t\t\treturn session;\n\t\t}\n\n\t\tcreateInputBox(extension: IExtensionDescription): InputBox {\n\t\t\tconst session: ExtHostInputBox = new ExtHostInputBox(extension, () => this._sessions.delete(session._id));\n\t\t\tthis._sessions.set(session._id, session);\n\t\t\treturn session;\n\t\t}\n\n\t\t$onDidChangeValue(sessionId: number, value: string): void {\n\t\t\tconst session = this._sessions.get(sessionId);\n\t\t\tsession?._fireDidChangeValue(value);\n\t\t}\n\n\t\t$onDidAccept(sessionId: number): void {\n\t\t\tconst session = this._sessions.get(sessionId);\n\t\t\tif (session) {\n\t\t\t\tsession._fireDidAccept();\n\t\t\t}\n\t\t}\n\n\t\t$onDidChangeActive(sessionId: number, handles: number[]): void {\n\t\t\tconst session = this._sessions.get(sessionId);\n\t\t\tif (session instanceof ExtHostQuickPick) {\n\t\t\t\tsession._fireDidChangeActive(handles);\n\t\t\t}\n\t\t}\n\n\t\t$onDidChangeSelection(sessionId: number, handles: number[]): void {\n\t\t\tconst session = this._sessions.get(sessionId);\n\t\t\tif (session instanceof ExtHostQuickPick) {\n\t\t\t\tsession._fireDidChangeSelection(handles);\n\t\t\t}\n\t\t}\n\n\t\t$onDidTriggerButton(sessionId: number, handle: number): void {\n\t\t\tconst session = this._sessions.get(sessionId);\n\t\t\tsession?._fireDidTriggerButton(handle);\n\t\t}\n\n\t\t$onDidTriggerItemButton(sessionId: number, itemHandle: number, buttonHandle: number): void {\n\t\t\tconst session = this._sessions.get(sessionId);\n\t\t\tif (session instanceof ExtHostQuickPick) {\n\t\t\t\tsession._fireDidTriggerItemButton(itemHandle, buttonHandle);\n\t\t\t}\n\t\t}\n\n\t\t$onDidHide(sessionId: number): void {\n\t\t\tconst session = this._sessions.get(sessionId);\n\t\t\tif (session) {\n\t\t\t\tsession._fireDidHide();\n\t\t\t}\n\t\t}\n\t}\n\n\tclass ExtHostQuickInput implements QuickInput {\n\n\t\tprivate static _nextId = 1;\n\t\t_id = ExtHostQuickPick._nextId++;\n\n\t\tprivate _title: string | undefined;\n\t\tprivate _steps: number | undefined;\n\t\tprivate _totalSteps: number | undefined;\n\t\tprivate _visible = false;\n\t\tprivate _expectingHide = false;\n\t\tprivate _enabled = true;\n\t\tprivate _busy = false;\n\t\tprivate _ignoreFocusOut = true;\n\t\tprivate _value = '';\n\t\tprivate _placeholder: string | undefined;\n\t\tprivate _buttons: QuickInputButton[] = [];\n\t\tprivate _handlesToButtons = new Map<number, QuickInputButton>();\n\t\tprivate readonly _onDidAcceptEmitter = new Emitter<void>();\n\t\tprivate readonly _onDidChangeValueEmitter = new Emitter<string>();\n\t\tprivate readonly _onDidTriggerButtonEmitter = new Emitter<QuickInputButton>();\n\t\tprivate readonly _onDidHideEmitter = new Emitter<void>();\n\t\tprivate _updateTimeout: any;\n\t\tprivate _pendingUpdate: TransferQuickInput = { id: this._id };\n\n\t\tprivate _disposed = false;\n\t\tprotected _disposables: IDisposable[] = [\n\t\t\tthis._onDidTriggerButtonEmitter,\n\t\t\tthis._onDidHideEmitter,\n\t\t\tthis._onDidAcceptEmitter,\n\t\t\tthis._onDidChangeValueEmitter\n\t\t];\n\n\t\tconstructor(protected _extensionId: ExtensionIdentifier, private _onDidDispose: () => void) {\n\t\t}\n\n\t\tget title() {\n\t\t\treturn this._title;\n\t\t}\n\n\t\tset title(title: string | undefined) {\n\t\t\tthis._title = title;\n\t\t\tthis.update({ title });\n\t\t}\n\n\t\tget step() {\n\t\t\treturn this._steps;\n\t\t}\n\n\t\tset step(step: number | undefined) {\n\t\t\tthis._steps = step;\n\t\t\tthis.update({ step });\n\t\t}\n\n\t\tget totalSteps() {\n\t\t\treturn this._totalSteps;\n\t\t}\n\n\t\tset totalSteps(totalSteps: number | undefined) {\n\t\t\tthis._totalSteps = totalSteps;\n\t\t\tthis.update({ totalSteps });\n\t\t}\n\n\t\tget enabled() {\n\t\t\treturn this._enabled;\n\t\t}\n\n\t\tset enabled(enabled: boolean) {\n\t\t\tthis._enabled = enabled;\n\t\t\tthis.update({ enabled });\n\t\t}\n\n\t\tget busy() {\n\t\t\treturn this._busy;\n\t\t}\n\n\t\tset busy(busy: boolean) {\n\t\t\tthis._busy = busy;\n\t\t\tthis.update({ busy });\n\t\t}\n\n\t\tget ignoreFocusOut() {\n\t\t\treturn this._ignoreFocusOut;\n\t\t}\n\n\t\tset ignoreFocusOut(ignoreFocusOut: boolean) {\n\t\t\tthis._ignoreFocusOut = ignoreFocusOut;\n\t\t\tthis.update({ ignoreFocusOut });\n\t\t}\n\n\t\tget value() {\n\t\t\treturn this._value;\n\t\t}\n\n\t\tset value(value: string) {\n\t\t\tthis._value = value;\n\t\t\tthis.update({ value });\n\t\t}\n\n\t\tget placeholder() {\n\t\t\treturn this._placeholder;\n\t\t}\n\n\t\tset placeholder(placeholder: string | undefined) {\n\t\t\tthis._placeholder = placeholder;\n\t\t\tthis.update({ placeholder });\n\t\t}\n\n\t\tonDidChangeValue = this._onDidChangeValueEmitter.event;\n\n\t\tonDidAccept = this._onDidAcceptEmitter.event;\n\n\t\tget buttons() {\n\t\t\treturn this._buttons;\n\t\t}\n\n\t\tset buttons(buttons: QuickInputButton[]) {\n\t\t\tthis._buttons = buttons.slice();\n\t\t\tthis._handlesToButtons.clear();\n\t\t\tbuttons.forEach((button, i) => {\n\t\t\t\tconst handle = button === QuickInputButtons.Back ? -1 : i;\n\t\t\t\tthis._handlesToButtons.set(handle, button);\n\t\t\t});\n\t\t\tthis.update({\n\t\t\t\tbuttons: buttons.map<TransferQuickInputButton>((button, i) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...getIconPathOrClass(button),\n\t\t\t\t\t\ttooltip: button.tooltip,\n\t\t\t\t\t\thandle: button === QuickInputButtons.Back ? -1 : i,\n\t\t\t\t\t};\n\t\t\t\t})\n\t\t\t});\n\t\t}\n\n\t\tonDidTriggerButton = this._onDidTriggerButtonEmitter.event;\n\n\t\tshow(): void {\n\t\t\tthis._visible = true;\n\t\t\tthis._expectingHide = true;\n\t\t\tthis.update({ visible: true });\n\t\t}\n\n\t\thide(): void {\n\t\t\tthis._visible = false;\n\t\t\tthis.update({ visible: false });\n\t\t}\n\n\t\tonDidHide = this._onDidHideEmitter.event;\n\n\t\t_fireDidAccept() {\n\t\t\tthis._onDidAcceptEmitter.fire();\n\t\t}\n\n\t\t_fireDidChangeValue(value: string) {\n\t\t\tthis._value = value;\n\t\t\tthis._onDidChangeValueEmitter.fire(value);\n\t\t}\n\n\t\t_fireDidTriggerButton(handle: number) {\n\t\t\tconst button = this._handlesToButtons.get(handle);\n\t\t\tif (button) {\n\t\t\t\tthis._onDidTriggerButtonEmitter.fire(button);\n\t\t\t}\n\t\t}\n\n\t\t_fireDidHide() {\n\t\t\tif (this._expectingHide) {\n\t\t\t\t// if this._visible is true, it means that .show() was called between\n\t\t\t\t// .hide() and .onDidHide. To ensure the correct number of onDidHide events\n\t\t\t\t// are emitted, we set this._expectingHide to this value so that\n\t\t\t\t// the next time .hide() is called, we can emit the event again.\n\t\t\t\t// Example:\n\t\t\t\t// .show() -> .hide() -> .show() -> .hide() should emit 2 onDidHide events.\n\t\t\t\t// .show() -> .hide() -> .hide() should emit 1 onDidHide event.\n\t\t\t\t// Fixes #135747\n\t\t\t\tthis._expectingHide = this._visible;\n\t\t\t\tthis._onDidHideEmitter.fire();\n\t\t\t}\n\t\t}\n\n\t\tdispose(): void {\n\t\t\tif (this._disposed) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._disposed = true;\n\t\t\tthis._fireDidHide();\n\t\t\tthis._disposables = dispose(this._disposables);\n\t\t\tif (this._updateTimeout) {\n\t\t\t\tclearTimeout(this._updateTimeout);\n\t\t\t\tthis._updateTimeout = undefined;\n\t\t\t}\n\t\t\tthis._onDidDispose();\n\t\t\tproxy.$dispose(this._id);\n\t\t}\n\n\t\tprotected update(properties: Record<string, any>): void {\n\t\t\tif (this._disposed) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tfor (const key of Object.keys(properties)) {\n\t\t\t\tconst value = properties[key];\n\t\t\t\tthis._pendingUpdate[key] = value === undefined ? null : value;\n\t\t\t}\n\n\t\t\tif ('visible' in this._pendingUpdate) {\n\t\t\t\tif (this._updateTimeout) {\n\t\t\t\t\tclearTimeout(this._updateTimeout);\n\t\t\t\t\tthis._updateTimeout = undefined;\n\t\t\t\t}\n\t\t\t\tthis.dispatchUpdate();\n\t\t\t} else if (this._visible && !this._updateTimeout) {\n\t\t\t\t// Defer the update so that multiple changes to setters dont cause a redraw each\n\t\t\t\tthis._updateTimeout = setTimeout(() => {\n\t\t\t\t\tthis._updateTimeout = undefined;\n\t\t\t\t\tthis.dispatchUpdate();\n\t\t\t\t}, 0);\n\t\t\t}\n\t\t}\n\n\t\tprivate dispatchUpdate() {\n\t\t\tproxy.$createOrUpdate(this._pendingUpdate);\n\t\t\tthis._pendingUpdate = { id: this._id };\n\t\t}\n\t}\n\n\tfunction getIconUris(iconPath: QuickInputButton['iconPath']): { dark: URI; light?: URI } | { id: string } {\n\t\tif (iconPath instanceof ThemeIcon) {\n\t\t\treturn { id: iconPath.id };\n\t\t}\n\t\tconst dark = getDarkIconUri(iconPath as URI | { light: URI; dark: URI });\n\t\tconst light = getLightIconUri(iconPath as URI | { light: URI; dark: URI });\n\t\t// Tolerate strings: https://github.com/microsoft/vscode/issues/110432#issuecomment-726144556\n\t\treturn {\n\t\t\tdark: typeof dark === 'string' ? URI.file(dark) : dark,\n\t\t\tlight: typeof light === 'string' ? URI.file(light) : light\n\t\t};\n\t}\n\n\tfunction getLightIconUri(iconPath: URI | { light: URI; dark: URI }) {\n\t\treturn typeof iconPath === 'object' && 'light' in iconPath ? iconPath.light : iconPath;\n\t}\n\n\tfunction getDarkIconUri(iconPath: URI | { light: URI; dark: URI }) {\n\t\treturn typeof iconPath === 'object' && 'dark' in iconPath ? iconPath.dark : iconPath;\n\t}\n\n\tfunction getIconPathOrClass(button: QuickInputButton) {\n\t\tconst iconPathOrIconClass = getIconUris(button.iconPath);\n\t\tlet iconPath: { dark: URI; light?: URI | undefined } | undefined;\n\t\tlet iconClass: string | undefined;\n\t\tif ('id' in iconPathOrIconClass) {\n\t\t\ticonClass = ThemeIconUtils.asClassName(iconPathOrIconClass);\n\t\t} else {\n\t\t\ticonPath = iconPathOrIconClass;\n\t\t}\n\n\t\treturn {\n\t\t\ticonPath,\n\t\t\ticonClass\n\t\t};\n\t}\n\n\tclass ExtHostQuickPick<T extends QuickPickItem> extends ExtHostQuickInput implements QuickPick<T> {\n\n\t\tprivate _items: T[] = [];\n\t\tprivate _handlesToItems = new Map<number, T>();\n\t\tprivate _itemsToHandles = new Map<T, number>();\n\t\tprivate _canSelectMany = false;\n\t\tprivate _matchOnDescription = true;\n\t\tprivate _matchOnDetail = true;\n\t\tprivate _sortByLabel = true;\n\t\tprivate _keepScrollPosition = false;\n\t\tprivate _activeItems: T[] = [];\n\t\tprivate readonly _onDidChangeActiveEmitter = new Emitter<T[]>();\n\t\tprivate _selectedItems: T[] = [];\n\t\tprivate readonly _onDidChangeSelectionEmitter = new Emitter<T[]>();\n\t\tprivate readonly _onDidTriggerItemButtonEmitter = new Emitter<QuickPickItemButtonEvent<T>>();\n\n\t\tconstructor(extension: IExtensionDescription, onDispose: () => void) {\n\t\t\tsuper(extension.identifier, onDispose);\n\t\t\tthis._disposables.push(\n\t\t\t\tthis._onDidChangeActiveEmitter,\n\t\t\t\tthis._onDidChangeSelectionEmitter,\n\t\t\t\tthis._onDidTriggerItemButtonEmitter\n\t\t\t);\n\t\t\tthis.update({ type: 'quickPick' });\n\t\t}\n\n\t\tget items() {\n\t\t\treturn this._items;\n\t\t}\n\n\t\tset items(items: T[]) {\n\t\t\tthis._items = items.slice();\n\t\t\tthis._handlesToItems.clear();\n\t\t\tthis._itemsToHandles.clear();\n\t\t\titems.forEach((item, i) => {\n\t\t\t\tthis._handlesToItems.set(i, item);\n\t\t\t\tthis._itemsToHandles.set(item, i);\n\t\t\t});\n\n\t\t\tconst pickItems: TransferQuickPickItemOrSeparator[] = [];\n\t\t\tfor (let handle = 0; handle < items.length; handle++) {\n\t\t\t\tconst item = items[handle];\n\t\t\t\tif (item.kind === QuickPickItemKind.Separator) {\n\t\t\t\t\tpickItems.push({ type: 'separator', label: item.label });\n\t\t\t\t} else {\n\t\t\t\t\tpickItems.push({\n\t\t\t\t\t\thandle,\n\t\t\t\t\t\tlabel: item.label,\n\t\t\t\t\t\tdescription: item.description,\n\t\t\t\t\t\tdetail: item.detail,\n\t\t\t\t\t\tpicked: item.picked,\n\t\t\t\t\t\talwaysShow: item.alwaysShow,\n\t\t\t\t\t\tbuttons: item.buttons?.map<TransferQuickInputButton>((button, i) => {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t...getIconPathOrClass(button),\n\t\t\t\t\t\t\t\ttooltip: button.tooltip,\n\t\t\t\t\t\t\t\thandle: i\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.update({\n\t\t\t\titems: pickItems,\n\t\t\t});\n\t\t}\n\n\t\tget canSelectMany() {\n\t\t\treturn this._canSelectMany;\n\t\t}\n\n\t\tset canSelectMany(canSelectMany: boolean) {\n\t\t\tthis._canSelectMany = canSelectMany;\n\t\t\tthis.update({ canSelectMany });\n\t\t}\n\n\t\tget matchOnDescription() {\n\t\t\treturn this._matchOnDescription;\n\t\t}\n\n\t\tset matchOnDescription(matchOnDescription: boolean) {\n\t\t\tthis._matchOnDescription = matchOnDescription;\n\t\t\tthis.update({ matchOnDescription });\n\t\t}\n\n\t\tget matchOnDetail() {\n\t\t\treturn this._matchOnDetail;\n\t\t}\n\n\t\tset matchOnDetail(matchOnDetail: boolean) {\n\t\t\tthis._matchOnDetail = matchOnDetail;\n\t\t\tthis.update({ matchOnDetail });\n\t\t}\n\n\t\tget sortByLabel() {\n\t\t\treturn this._sortByLabel;\n\t\t}\n\n\t\tset sortByLabel(sortByLabel: boolean) {\n\t\t\tthis._sortByLabel = sortByLabel;\n\t\t\tthis.update({ sortByLabel });\n\t\t}\n\n\t\tget keepScrollPosition() {\n\t\t\treturn this._keepScrollPosition;\n\t\t}\n\n\t\tset keepScrollPosition(keepScrollPosition: boolean) {\n\t\t\tthis._keepScrollPosition = keepScrollPosition;\n\t\t\tthis.update({ keepScrollPosition });\n\t\t}\n\n\t\tget activeItems() {\n\t\t\treturn this._activeItems;\n\t\t}\n\n\t\tset activeItems(activeItems: T[]) {\n\t\t\tthis._activeItems = activeItems.filter(item => this._itemsToHandles.has(item));\n\t\t\tthis.update({ activeItems: this._activeItems.map(item => this._itemsToHandles.get(item)) });\n\t\t}\n\n\t\tonDidChangeActive = this._onDidChangeActiveEmitter.event;\n\n\t\tget selectedItems() {\n\t\t\treturn this._selectedItems;\n\t\t}\n\n\t\tset selectedItems(selectedItems: T[]) {\n\t\t\tthis._selectedItems = selectedItems.filter(item => this._itemsToHandles.has(item));\n\t\t\tthis.update({ selectedItems: this._selectedItems.map(item => this._itemsToHandles.get(item)) });\n\t\t}\n\n\t\tonDidChangeSelection = this._onDidChangeSelectionEmitter.event;\n\n\t\t_fireDidChangeActive(handles: number[]) {\n\t\t\tconst items = coalesce(handles.map(handle => this._handlesToItems.get(handle)));\n\t\t\tthis._activeItems = items;\n\t\t\tthis._onDidChangeActiveEmitter.fire(items);\n\t\t}\n\n\t\t_fireDidChangeSelection(handles: number[]) {\n\t\t\tconst items = coalesce(handles.map(handle => this._handlesToItems.get(handle)));\n\t\t\tthis._selectedItems = items;\n\t\t\tthis._onDidChangeSelectionEmitter.fire(items);\n\t\t}\n\n\t\tonDidTriggerItemButton = this._onDidTriggerItemButtonEmitter.event;\n\n\t\t_fireDidTriggerItemButton(itemHandle: number, buttonHandle: number) {\n\t\t\tconst item = this._handlesToItems.get(itemHandle)!;\n\t\t\tif (!item || !item.buttons || !item.buttons.length) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst button = item.buttons[buttonHandle];\n\t\t\tif (button) {\n\t\t\t\tthis._onDidTriggerItemButtonEmitter.fire({\n\t\t\t\t\tbutton,\n\t\t\t\t\titem\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tclass ExtHostInputBox extends ExtHostQuickInput implements InputBox {\n\n\t\tprivate _password = false;\n\t\tprivate _prompt: string | undefined;\n\t\tprivate _validationMessage: string | InputBoxValidationMessage | undefined;\n\n\t\tconstructor(extension: IExtensionDescription, onDispose: () => void) {\n\t\t\tsuper(extension.identifier, onDispose);\n\t\t\tthis.update({ type: 'inputBox' });\n\t\t}\n\n\t\tget password() {\n\t\t\treturn this._password;\n\t\t}\n\n\t\tset password(password: boolean) {\n\t\t\tthis._password = password;\n\t\t\tthis.update({ password });\n\t\t}\n\n\t\tget prompt() {\n\t\t\treturn this._prompt;\n\t\t}\n\n\t\tset prompt(prompt: string | undefined) {\n\t\t\tthis._prompt = prompt;\n\t\t\tthis.update({ prompt });\n\t\t}\n\n\t\tget validationMessage() {\n\t\t\treturn this._validationMessage;\n\t\t}\n\n\t\tset validationMessage(validationMessage: string | InputBoxValidationMessage | undefined) {\n\t\t\tthis._validationMessage = validationMessage;\n\t\t\tif (!validationMessage) {\n\t\t\t\tthis.update({ validationMessage: undefined, severity: Severity.Ignore });\n\t\t\t} else if (typeof validationMessage === 'string') {\n\t\t\t\tthis.update({ validationMessage, severity: Severity.Error });\n\t\t\t} else {\n\t\t\t\tthis.update({ validationMessage: validationMessage.message, severity: validationMessage.severity ?? Severity.Error });\n\t\t\t}\n\t\t}\n\t}\n\n\treturn new ExtHostQuickOpenImpl(workspace, commands);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { Event, Emitter } from 'vs/base/common/event';\nimport { debounce } from 'vs/base/common/decorators';\nimport { DisposableStore, IDisposable, MutableDisposable } from 'vs/base/common/lifecycle';\nimport { asPromise } from 'vs/base/common/async';\nimport { ExtHostCommands } from 'vs/workbench/api/common/extHostCommands';\nimport { MainContext, MainThreadSCMShape, SCMRawResource, SCMRawResourceSplice, SCMRawResourceSplices, IMainContext, ExtHostSCMShape, ICommandDto, MainThreadTelemetryShape, SCMGroupFeatures } from './extHost.protocol';\nimport { sortedDiff, equals } from 'vs/base/common/arrays';\nimport { comparePaths } from 'vs/base/common/comparers';\nimport type * as vscode from 'vscode';\nimport { ISplice } from 'vs/base/common/sequence';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { ExtensionIdentifier, IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { MarshalledId } from 'vs/base/common/marshallingIds';\nimport { ThemeIcon } from 'vs/platform/theme/common/themeService';\nimport { IMarkdownString } from 'vs/base/common/htmlContent';\nimport { MarkdownString } from 'vs/workbench/api/common/extHostTypeConverters';\nimport { checkProposedApiEnabled } from 'vs/workbench/services/extensions/common/extensions';\n\ntype ProviderHandle = number;\ntype GroupHandle = number;\ntype ResourceStateHandle = number;\n\nfunction getIconResource(decorations?: vscode.SourceControlResourceThemableDecorations): UriComponents | ThemeIcon | undefined {\n\tif (!decorations) {\n\t\treturn undefined;\n\t} else if (typeof decorations.iconPath === 'string') {\n\t\treturn URI.file(decorations.iconPath);\n\t} else if (URI.isUri(decorations.iconPath)) {\n\t\treturn decorations.iconPath;\n\t} else if (ThemeIcon.isThemeIcon(decorations.iconPath)) {\n\t\treturn decorations.iconPath;\n\t} else {\n\t\treturn undefined;\n\t}\n}\n\nfunction compareResourceThemableDecorations(a: vscode.SourceControlResourceThemableDecorations, b: vscode.SourceControlResourceThemableDecorations): number {\n\tif (!a.iconPath && !b.iconPath) {\n\t\treturn 0;\n\t} else if (!a.iconPath) {\n\t\treturn -1;\n\t} else if (!b.iconPath) {\n\t\treturn 1;\n\t}\n\n\tconst aPath = typeof a.iconPath === 'string' ? a.iconPath : URI.isUri(a.iconPath) ? a.iconPath.fsPath : (a.iconPath as vscode.ThemeIcon).id;\n\tconst bPath = typeof b.iconPath === 'string' ? b.iconPath : URI.isUri(b.iconPath) ? b.iconPath.fsPath : (b.iconPath as vscode.ThemeIcon).id;\n\treturn comparePaths(aPath, bPath);\n}\n\nfunction compareResourceStatesDecorations(a: vscode.SourceControlResourceDecorations, b: vscode.SourceControlResourceDecorations): number {\n\tlet result = 0;\n\n\tif (a.strikeThrough !== b.strikeThrough) {\n\t\treturn a.strikeThrough ? 1 : -1;\n\t}\n\n\tif (a.faded !== b.faded) {\n\t\treturn a.faded ? 1 : -1;\n\t}\n\n\tif (a.tooltip !== b.tooltip) {\n\t\treturn (a.tooltip || '').localeCompare(b.tooltip || '');\n\t}\n\n\tresult = compareResourceThemableDecorations(a, b);\n\n\tif (result !== 0) {\n\t\treturn result;\n\t}\n\n\tif (a.light && b.light) {\n\t\tresult = compareResourceThemableDecorations(a.light, b.light);\n\t} else if (a.light) {\n\t\treturn 1;\n\t} else if (b.light) {\n\t\treturn -1;\n\t}\n\n\tif (result !== 0) {\n\t\treturn result;\n\t}\n\n\tif (a.dark && b.dark) {\n\t\tresult = compareResourceThemableDecorations(a.dark, b.dark);\n\t} else if (a.dark) {\n\t\treturn 1;\n\t} else if (b.dark) {\n\t\treturn -1;\n\t}\n\n\treturn result;\n}\n\nfunction compareCommands(a: vscode.Command, b: vscode.Command): number {\n\tif (a.command !== b.command) {\n\t\treturn a.command < b.command ? -1 : 1;\n\t}\n\n\tif (a.title !== b.title) {\n\t\treturn a.title < b.title ? -1 : 1;\n\t}\n\n\tif (a.tooltip !== b.tooltip) {\n\t\tif (a.tooltip !== undefined && b.tooltip !== undefined) {\n\t\t\treturn a.tooltip < b.tooltip ? -1 : 1;\n\t\t} else if (a.tooltip !== undefined) {\n\t\t\treturn 1;\n\t\t} else if (b.tooltip !== undefined) {\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\tif (a.arguments === b.arguments) {\n\t\treturn 0;\n\t} else if (!a.arguments) {\n\t\treturn -1;\n\t} else if (!b.arguments) {\n\t\treturn 1;\n\t} else if (a.arguments.length !== b.arguments.length) {\n\t\treturn a.arguments.length - b.arguments.length;\n\t}\n\n\tfor (let i = 0; i < a.arguments.length; i++) {\n\t\tconst aArg = a.arguments[i];\n\t\tconst bArg = b.arguments[i];\n\n\t\tif (aArg === bArg) {\n\t\t\tcontinue;\n\t\t}\n\n\t\treturn aArg < bArg ? -1 : 1;\n\t}\n\n\treturn 0;\n}\n\nfunction compareResourceStates(a: vscode.SourceControlResourceState, b: vscode.SourceControlResourceState): number {\n\tlet result = comparePaths(a.resourceUri.fsPath, b.resourceUri.fsPath, true);\n\n\tif (result !== 0) {\n\t\treturn result;\n\t}\n\n\tif (a.command && b.command) {\n\t\tresult = compareCommands(a.command, b.command);\n\t} else if (a.command) {\n\t\treturn 1;\n\t} else if (b.command) {\n\t\treturn -1;\n\t}\n\n\tif (result !== 0) {\n\t\treturn result;\n\t}\n\n\tif (a.decorations && b.decorations) {\n\t\tresult = compareResourceStatesDecorations(a.decorations, b.decorations);\n\t} else if (a.decorations) {\n\t\treturn 1;\n\t} else if (b.decorations) {\n\t\treturn -1;\n\t}\n\n\treturn result;\n}\n\nfunction compareArgs(a: any[], b: any[]): boolean {\n\tfor (let i = 0; i < a.length; i++) {\n\t\tif (a[i] !== b[i]) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n\nfunction commandEquals(a: vscode.Command, b: vscode.Command): boolean {\n\treturn a.command === b.command\n\t\t&& a.title === b.title\n\t\t&& a.tooltip === b.tooltip\n\t\t&& (a.arguments && b.arguments ? compareArgs(a.arguments, b.arguments) : a.arguments === b.arguments);\n}\n\nfunction commandListEquals(a: readonly vscode.Command[], b: readonly vscode.Command[]): boolean {\n\treturn equals(a, b, commandEquals);\n}\n\nexport interface IValidateInput {\n\t(value: string, cursorPosition: number): vscode.ProviderResult<vscode.SourceControlInputBoxValidation | undefined | null>;\n}\n\nexport class ExtHostSCMInputBox implements vscode.SourceControlInputBox {\n\n\t#proxy: MainThreadSCMShape;\n\n\tprivate _value: string = '';\n\n\tget value(): string {\n\t\treturn this._value;\n\t}\n\n\tset value(value: string) {\n\t\tvalue = value ?? '';\n\t\tthis.#proxy.$setInputBoxValue(this._sourceControlHandle, value);\n\t\tthis.updateValue(value);\n\t}\n\n\tprivate readonly _onDidChange = new Emitter<string>();\n\n\tget onDidChange(): Event<string> {\n\t\treturn this._onDidChange.event;\n\t}\n\n\tprivate _placeholder: string = '';\n\n\tget placeholder(): string {\n\t\treturn this._placeholder;\n\t}\n\n\tset placeholder(placeholder: string) {\n\t\tthis.#proxy.$setInputBoxPlaceholder(this._sourceControlHandle, placeholder);\n\t\tthis._placeholder = placeholder;\n\t}\n\n\tprivate _validateInput: IValidateInput | undefined;\n\n\tget validateInput(): IValidateInput | undefined {\n\t\tcheckProposedApiEnabled(this._extension, 'scmValidation');\n\n\t\treturn this._validateInput;\n\t}\n\n\tset validateInput(fn: IValidateInput | undefined) {\n\t\tcheckProposedApiEnabled(this._extension, 'scmValidation');\n\n\t\tif (fn && typeof fn !== 'function') {\n\t\t\tthrow new Error(`[${this._extension.identifier.value}]: Invalid SCM input box validation function`);\n\t\t}\n\n\t\tthis._validateInput = fn;\n\t\tthis.#proxy.$setValidationProviderIsEnabled(this._sourceControlHandle, !!fn);\n\t}\n\n\tprivate _enabled: boolean = true;\n\n\tget enabled(): boolean {\n\t\treturn this._enabled;\n\t}\n\n\tset enabled(enabled: boolean) {\n\t\tenabled = !!enabled;\n\n\t\tif (this._enabled === enabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._enabled = enabled;\n\t\tthis.#proxy.$setInputBoxEnablement(this._sourceControlHandle, enabled);\n\t}\n\n\tprivate _visible: boolean = true;\n\n\tget visible(): boolean {\n\t\treturn this._visible;\n\t}\n\n\tset visible(visible: boolean) {\n\t\tvisible = !!visible;\n\n\t\tif (this._visible === visible) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._visible = visible;\n\t\tthis.#proxy.$setInputBoxVisibility(this._sourceControlHandle, visible);\n\t}\n\n\tconstructor(private _extension: IExtensionDescription, proxy: MainThreadSCMShape, private _sourceControlHandle: number) {\n\t\tthis.#proxy = proxy;\n\t}\n\n\tshowValidationMessage(message: string | vscode.MarkdownString, type: vscode.SourceControlInputBoxValidationType) {\n\t\tcheckProposedApiEnabled(this._extension, 'scmValidation');\n\n\t\tthis.#proxy.$showValidationMessage(this._sourceControlHandle, message, type as any);\n\t}\n\n\t$onInputBoxValueChange(value: string): void {\n\t\tthis.updateValue(value);\n\t}\n\n\tprivate updateValue(value: string): void {\n\t\tthis._value = value;\n\t\tthis._onDidChange.fire(value);\n\t}\n}\n\nclass ExtHostSourceControlResourceGroup implements vscode.SourceControlResourceGroup {\n\n\tprivate static _handlePool: number = 0;\n\tprivate _resourceHandlePool: number = 0;\n\tprivate _resourceStates: vscode.SourceControlResourceState[] = [];\n\n\tprivate _resourceStatesMap = new Map<ResourceStateHandle, vscode.SourceControlResourceState>();\n\tprivate _resourceStatesCommandsMap = new Map<ResourceStateHandle, vscode.Command>();\n\tprivate _resourceStatesDisposablesMap = new Map<ResourceStateHandle, IDisposable>();\n\n\tprivate readonly _onDidUpdateResourceStates = new Emitter<void>();\n\treadonly onDidUpdateResourceStates = this._onDidUpdateResourceStates.event;\n\n\tprivate _disposed = false;\n\tget disposed(): boolean { return this._disposed; }\n\tprivate readonly _onDidDispose = new Emitter<void>();\n\treadonly onDidDispose = this._onDidDispose.event;\n\n\tprivate _handlesSnapshot: number[] = [];\n\tprivate _resourceSnapshot: vscode.SourceControlResourceState[] = [];\n\n\tget id(): string { return this._id; }\n\n\tget label(): string { return this._label; }\n\tset label(label: string) {\n\t\tthis._label = label;\n\t\tthis._proxy.$updateGroupLabel(this._sourceControlHandle, this.handle, label);\n\t}\n\n\tprivate _hideWhenEmpty: boolean | undefined = undefined;\n\tget hideWhenEmpty(): boolean | undefined { return this._hideWhenEmpty; }\n\tset hideWhenEmpty(hideWhenEmpty: boolean | undefined) {\n\t\tthis._hideWhenEmpty = hideWhenEmpty;\n\t\tthis._proxy.$updateGroup(this._sourceControlHandle, this.handle, this.features);\n\t}\n\n\tget features(): SCMGroupFeatures {\n\t\treturn {\n\t\t\thideWhenEmpty: this.hideWhenEmpty\n\t\t};\n\t}\n\n\tget resourceStates(): vscode.SourceControlResourceState[] { return [...this._resourceStates]; }\n\tset resourceStates(resources: vscode.SourceControlResourceState[]) {\n\t\tthis._resourceStates = [...resources];\n\t\tthis._onDidUpdateResourceStates.fire();\n\t}\n\n\treadonly handle = ExtHostSourceControlResourceGroup._handlePool++;\n\n\tconstructor(\n\t\tprivate _proxy: MainThreadSCMShape,\n\t\tprivate _commands: ExtHostCommands,\n\t\tprivate _sourceControlHandle: number,\n\t\tprivate _id: string,\n\t\tprivate _label: string,\n\t) { }\n\n\tgetResourceState(handle: number): vscode.SourceControlResourceState | undefined {\n\t\treturn this._resourceStatesMap.get(handle);\n\t}\n\n\t$executeResourceCommand(handle: number, preserveFocus: boolean): Promise<void> {\n\t\tconst command = this._resourceStatesCommandsMap.get(handle);\n\n\t\tif (!command) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\treturn asPromise(() => this._commands.executeCommand(command.command, ...(command.arguments || []), preserveFocus));\n\t}\n\n\t_takeResourceStateSnapshot(): SCMRawResourceSplice[] {\n\t\tconst snapshot = [...this._resourceStates].sort(compareResourceStates);\n\t\tconst diffs = sortedDiff(this._resourceSnapshot, snapshot, compareResourceStates);\n\n\t\tconst splices = diffs.map<ISplice<{ rawResource: SCMRawResource; handle: number }>>(diff => {\n\t\t\tconst toInsert = diff.toInsert.map(r => {\n\t\t\t\tconst handle = this._resourceHandlePool++;\n\t\t\t\tthis._resourceStatesMap.set(handle, r);\n\n\t\t\t\tconst sourceUri = r.resourceUri;\n\n\t\t\t\tlet command: ICommandDto | undefined;\n\t\t\t\tif (r.command) {\n\t\t\t\t\tif (r.command.command === 'vscode.open' || r.command.command === 'vscode.diff') {\n\t\t\t\t\t\tconst disposables = new DisposableStore();\n\t\t\t\t\t\tcommand = this._commands.converter.toInternal(r.command, disposables);\n\t\t\t\t\t\tthis._resourceStatesDisposablesMap.set(handle, disposables);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._resourceStatesCommandsMap.set(handle, r.command);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst icon = getIconResource(r.decorations);\n\t\t\t\tconst lightIcon = r.decorations && getIconResource(r.decorations.light) || icon;\n\t\t\t\tconst darkIcon = r.decorations && getIconResource(r.decorations.dark) || icon;\n\t\t\t\tconst icons: SCMRawResource[2] = [lightIcon, darkIcon];\n\n\t\t\t\tconst tooltip = (r.decorations && r.decorations.tooltip) || '';\n\t\t\t\tconst strikeThrough = r.decorations && !!r.decorations.strikeThrough;\n\t\t\t\tconst faded = r.decorations && !!r.decorations.faded;\n\t\t\t\tconst contextValue = r.contextValue || '';\n\n\t\t\t\tconst rawResource = [handle, sourceUri, icons, tooltip, strikeThrough, faded, contextValue, command] as SCMRawResource;\n\n\t\t\t\treturn { rawResource, handle };\n\t\t\t});\n\n\t\t\treturn { start: diff.start, deleteCount: diff.deleteCount, toInsert };\n\t\t});\n\n\t\tconst rawResourceSplices = splices\n\t\t\t.map(({ start, deleteCount, toInsert }) => [start, deleteCount, toInsert.map(i => i.rawResource)] as SCMRawResourceSplice);\n\n\t\tconst reverseSplices = splices.reverse();\n\n\t\tfor (const { start, deleteCount, toInsert } of reverseSplices) {\n\t\t\tconst handles = toInsert.map(i => i.handle);\n\t\t\tconst handlesToDelete = this._handlesSnapshot.splice(start, deleteCount, ...handles);\n\n\t\t\tfor (const handle of handlesToDelete) {\n\t\t\t\tthis._resourceStatesMap.delete(handle);\n\t\t\t\tthis._resourceStatesCommandsMap.delete(handle);\n\t\t\t\tthis._resourceStatesDisposablesMap.get(handle)?.dispose();\n\t\t\t\tthis._resourceStatesDisposablesMap.delete(handle);\n\t\t\t}\n\t\t}\n\n\t\tthis._resourceSnapshot = snapshot;\n\t\treturn rawResourceSplices;\n\t}\n\n\tdispose(): void {\n\t\tthis._disposed = true;\n\t\tthis._onDidDispose.fire();\n\t}\n}\n\nclass ExtHostSourceControl implements vscode.SourceControl {\n\n\tprivate static _handlePool: number = 0;\n\n\t#proxy: MainThreadSCMShape;\n\n\tprivate _groups: Map<GroupHandle, ExtHostSourceControlResourceGroup> = new Map<GroupHandle, ExtHostSourceControlResourceGroup>();\n\n\tget id(): string {\n\t\treturn this._id;\n\t}\n\n\tget label(): string {\n\t\treturn this._label;\n\t}\n\n\tget rootUri(): vscode.Uri | undefined {\n\t\treturn this._rootUri;\n\t}\n\n\tprivate _inputBox: ExtHostSCMInputBox;\n\tget inputBox(): ExtHostSCMInputBox { return this._inputBox; }\n\n\tprivate _count: number | undefined = undefined;\n\n\tget count(): number | undefined {\n\t\treturn this._count;\n\t}\n\n\tset count(count: number | undefined) {\n\t\tif (this._count === count) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._count = count;\n\t\tthis.#proxy.$updateSourceControl(this.handle, { count });\n\t}\n\n\tprivate _quickDiffProvider: vscode.QuickDiffProvider | undefined = undefined;\n\n\tget quickDiffProvider(): vscode.QuickDiffProvider | undefined {\n\t\treturn this._quickDiffProvider;\n\t}\n\n\tset quickDiffProvider(quickDiffProvider: vscode.QuickDiffProvider | undefined) {\n\t\tthis._quickDiffProvider = quickDiffProvider;\n\t\tthis.#proxy.$updateSourceControl(this.handle, { hasQuickDiffProvider: !!quickDiffProvider });\n\t}\n\n\tprivate _commitTemplate: string | undefined = undefined;\n\n\tget commitTemplate(): string | undefined {\n\t\treturn this._commitTemplate;\n\t}\n\n\tset commitTemplate(commitTemplate: string | undefined) {\n\t\tif (commitTemplate === this._commitTemplate) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._commitTemplate = commitTemplate;\n\t\tthis.#proxy.$updateSourceControl(this.handle, { commitTemplate });\n\t}\n\n\tprivate _acceptInputDisposables = new MutableDisposable<DisposableStore>();\n\tprivate _acceptInputCommand: vscode.Command | undefined = undefined;\n\n\tget acceptInputCommand(): vscode.Command | undefined {\n\t\treturn this._acceptInputCommand;\n\t}\n\n\tset acceptInputCommand(acceptInputCommand: vscode.Command | undefined) {\n\t\tthis._acceptInputDisposables.value = new DisposableStore();\n\n\t\tthis._acceptInputCommand = acceptInputCommand;\n\n\t\tconst internal = this._commands.converter.toInternal(acceptInputCommand, this._acceptInputDisposables.value);\n\t\tthis.#proxy.$updateSourceControl(this.handle, { acceptInputCommand: internal });\n\t}\n\n\tprivate _actionButtonDisposables = new MutableDisposable<DisposableStore>();\n\tprivate _actionButton: vscode.SourceControlActionButton | undefined;\n\tget actionButton(): vscode.SourceControlActionButton | undefined {\n\t\tcheckProposedApiEnabled(this._extension, 'scmActionButton');\n\t\treturn this._actionButton;\n\t}\n\tset actionButton(actionButton: vscode.SourceControlActionButton | undefined) {\n\t\tcheckProposedApiEnabled(this._extension, 'scmActionButton');\n\t\tthis._actionButtonDisposables.value = new DisposableStore();\n\n\t\tthis._actionButton = actionButton;\n\n\t\tconst internal = actionButton !== undefined ?\n\t\t\t{\n\t\t\t\tcommand: this._commands.converter.toInternal(actionButton.command, this._actionButtonDisposables.value),\n\t\t\t\tsecondaryCommands: actionButton.secondaryCommands?.map(commandGroup => {\n\t\t\t\t\treturn commandGroup.map(command => this._commands.converter.toInternal(command, this._actionButtonDisposables.value!));\n\t\t\t\t}),\n\t\t\t\tdescription: actionButton.description,\n\t\t\t\tenabled: actionButton.enabled\n\t\t\t} : undefined;\n\t\tthis.#proxy.$updateSourceControl(this.handle, { actionButton: internal ?? null });\n\t}\n\n\n\tprivate _statusBarDisposables = new MutableDisposable<DisposableStore>();\n\tprivate _statusBarCommands: vscode.Command[] | undefined = undefined;\n\n\tget statusBarCommands(): vscode.Command[] | undefined {\n\t\treturn this._statusBarCommands;\n\t}\n\n\tset statusBarCommands(statusBarCommands: vscode.Command[] | undefined) {\n\t\tif (this._statusBarCommands && statusBarCommands && commandListEquals(this._statusBarCommands, statusBarCommands)) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._statusBarDisposables.value = new DisposableStore();\n\n\t\tthis._statusBarCommands = statusBarCommands;\n\n\t\tconst internal = (statusBarCommands || []).map(c => this._commands.converter.toInternal(c, this._statusBarDisposables.value!)) as ICommandDto[];\n\t\tthis.#proxy.$updateSourceControl(this.handle, { statusBarCommands: internal });\n\t}\n\n\tprivate _selected: boolean = false;\n\n\tget selected(): boolean {\n\t\treturn this._selected;\n\t}\n\n\tprivate readonly _onDidChangeSelection = new Emitter<boolean>();\n\treadonly onDidChangeSelection = this._onDidChangeSelection.event;\n\n\tprivate handle: number = ExtHostSourceControl._handlePool++;\n\n\tconstructor(\n\t\tprivate readonly _extension: IExtensionDescription,\n\t\tproxy: MainThreadSCMShape,\n\t\tprivate _commands: ExtHostCommands,\n\t\tprivate _id: string,\n\t\tprivate _label: string,\n\t\tprivate _rootUri?: vscode.Uri\n\t) {\n\t\tthis.#proxy = proxy;\n\n\t\tthis._inputBox = new ExtHostSCMInputBox(_extension, this.#proxy, this.handle);\n\t\tthis.#proxy.$registerSourceControl(this.handle, _id, _label, _rootUri);\n\t}\n\n\tprivate createdResourceGroups = new Map<ExtHostSourceControlResourceGroup, IDisposable>();\n\tprivate updatedResourceGroups = new Set<ExtHostSourceControlResourceGroup>();\n\n\tcreateResourceGroup(id: string, label: string): ExtHostSourceControlResourceGroup {\n\t\tconst group = new ExtHostSourceControlResourceGroup(this.#proxy, this._commands, this.handle, id, label);\n\t\tconst disposable = Event.once(group.onDidDispose)(() => this.createdResourceGroups.delete(group));\n\t\tthis.createdResourceGroups.set(group, disposable);\n\t\tthis.eventuallyAddResourceGroups();\n\t\treturn group;\n\t}\n\n\t@debounce(100)\n\teventuallyAddResourceGroups(): void {\n\t\tconst groups: [number /*handle*/, string /*id*/, string /*label*/, SCMGroupFeatures][] = [];\n\t\tconst splices: SCMRawResourceSplices[] = [];\n\n\t\tfor (const [group, disposable] of this.createdResourceGroups) {\n\t\t\tdisposable.dispose();\n\n\t\t\tconst updateListener = group.onDidUpdateResourceStates(() => {\n\t\t\t\tthis.updatedResourceGroups.add(group);\n\t\t\t\tthis.eventuallyUpdateResourceStates();\n\t\t\t});\n\n\t\t\tEvent.once(group.onDidDispose)(() => {\n\t\t\t\tthis.updatedResourceGroups.delete(group);\n\t\t\t\tupdateListener.dispose();\n\t\t\t\tthis._groups.delete(group.handle);\n\t\t\t\tthis.#proxy.$unregisterGroup(this.handle, group.handle);\n\t\t\t});\n\n\t\t\tgroups.push([group.handle, group.id, group.label, group.features]);\n\n\t\t\tconst snapshot = group._takeResourceStateSnapshot();\n\n\t\t\tif (snapshot.length > 0) {\n\t\t\t\tsplices.push([group.handle, snapshot]);\n\t\t\t}\n\n\t\t\tthis._groups.set(group.handle, group);\n\t\t}\n\n\t\tthis.#proxy.$registerGroups(this.handle, groups, splices);\n\t\tthis.createdResourceGroups.clear();\n\t}\n\n\t@debounce(100)\n\teventuallyUpdateResourceStates(): void {\n\t\tconst splices: SCMRawResourceSplices[] = [];\n\n\t\tthis.updatedResourceGroups.forEach(group => {\n\t\t\tconst snapshot = group._takeResourceStateSnapshot();\n\n\t\t\tif (snapshot.length === 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsplices.push([group.handle, snapshot]);\n\t\t});\n\n\t\tif (splices.length > 0) {\n\t\t\tthis.#proxy.$spliceResourceStates(this.handle, splices);\n\t\t}\n\n\t\tthis.updatedResourceGroups.clear();\n\t}\n\n\tgetResourceGroup(handle: GroupHandle): ExtHostSourceControlResourceGroup | undefined {\n\t\treturn this._groups.get(handle);\n\t}\n\n\tsetSelectionState(selected: boolean): void {\n\t\tthis._selected = selected;\n\t\tthis._onDidChangeSelection.fire(selected);\n\t}\n\n\tdispose(): void {\n\t\tthis._acceptInputDisposables.dispose();\n\t\tthis._actionButtonDisposables.dispose();\n\t\tthis._statusBarDisposables.dispose();\n\n\t\tthis._groups.forEach(group => group.dispose());\n\t\tthis.#proxy.$unregisterSourceControl(this.handle);\n\t}\n}\n\nexport class ExtHostSCM implements ExtHostSCMShape {\n\n\tprivate static _handlePool: number = 0;\n\n\tprivate _proxy: MainThreadSCMShape;\n\tprivate readonly _telemetry: MainThreadTelemetryShape;\n\tprivate _sourceControls: Map<ProviderHandle, ExtHostSourceControl> = new Map<ProviderHandle, ExtHostSourceControl>();\n\tprivate _sourceControlsByExtension: Map<string, ExtHostSourceControl[]> = new Map<string, ExtHostSourceControl[]>();\n\n\tprivate readonly _onDidChangeActiveProvider = new Emitter<vscode.SourceControl>();\n\tget onDidChangeActiveProvider(): Event<vscode.SourceControl> { return this._onDidChangeActiveProvider.event; }\n\n\tprivate _selectedSourceControlHandle: number | undefined;\n\n\tconstructor(\n\t\tmainContext: IMainContext,\n\t\tprivate _commands: ExtHostCommands,\n\t\t@ILogService private readonly logService: ILogService\n\t) {\n\t\tthis._proxy = mainContext.getProxy(MainContext.MainThreadSCM);\n\t\tthis._telemetry = mainContext.getProxy(MainContext.MainThreadTelemetry);\n\n\t\t_commands.registerArgumentProcessor({\n\t\t\tprocessArgument: arg => {\n\t\t\t\tif (arg && arg.$mid === MarshalledId.ScmResource) {\n\t\t\t\t\tconst sourceControl = this._sourceControls.get(arg.sourceControlHandle);\n\n\t\t\t\t\tif (!sourceControl) {\n\t\t\t\t\t\treturn arg;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst group = sourceControl.getResourceGroup(arg.groupHandle);\n\n\t\t\t\t\tif (!group) {\n\t\t\t\t\t\treturn arg;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn group.getResourceState(arg.handle);\n\t\t\t\t} else if (arg && arg.$mid === MarshalledId.ScmResourceGroup) {\n\t\t\t\t\tconst sourceControl = this._sourceControls.get(arg.sourceControlHandle);\n\n\t\t\t\t\tif (!sourceControl) {\n\t\t\t\t\t\treturn arg;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn sourceControl.getResourceGroup(arg.groupHandle);\n\t\t\t\t} else if (arg && arg.$mid === MarshalledId.ScmProvider) {\n\t\t\t\t\tconst sourceControl = this._sourceControls.get(arg.handle);\n\n\t\t\t\t\tif (!sourceControl) {\n\t\t\t\t\t\treturn arg;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn sourceControl;\n\t\t\t\t}\n\n\t\t\t\treturn arg;\n\t\t\t}\n\t\t});\n\t}\n\n\tcreateSourceControl(extension: IExtensionDescription, id: string, label: string, rootUri: vscode.Uri | undefined): vscode.SourceControl {\n\t\tthis.logService.trace('ExtHostSCM#createSourceControl', extension.identifier.value, id, label, rootUri);\n\n\t\ttype TEvent = { extensionId: string };\n\t\ttype TMeta = {\n\t\t\towner: 'joaomoreno';\n\t\t\textensionId: { classification: 'SystemMetaData'; purpose: 'FeatureInsight'; comment: 'The ID of the extension contributing to the Source Control API.' };\n\t\t\tcomment: 'This is used to know what extensions contribute to the Source Control API.';\n\t\t};\n\t\tthis._telemetry.$publicLog2<TEvent, TMeta>('api/scm/createSourceControl', {\n\t\t\textensionId: extension.identifier.value,\n\t\t});\n\n\t\tconst handle = ExtHostSCM._handlePool++;\n\t\tconst sourceControl = new ExtHostSourceControl(extension, this._proxy, this._commands, id, label, rootUri);\n\t\tthis._sourceControls.set(handle, sourceControl);\n\n\t\tconst sourceControls = this._sourceControlsByExtension.get(ExtensionIdentifier.toKey(extension.identifier)) || [];\n\t\tsourceControls.push(sourceControl);\n\t\tthis._sourceControlsByExtension.set(ExtensionIdentifier.toKey(extension.identifier), sourceControls);\n\n\t\treturn sourceControl;\n\t}\n\n\t// Deprecated\n\tgetLastInputBox(extension: IExtensionDescription): ExtHostSCMInputBox | undefined {\n\t\tthis.logService.trace('ExtHostSCM#getLastInputBox', extension.identifier.value);\n\n\t\tconst sourceControls = this._sourceControlsByExtension.get(ExtensionIdentifier.toKey(extension.identifier));\n\t\tconst sourceControl = sourceControls && sourceControls[sourceControls.length - 1];\n\t\treturn sourceControl && sourceControl.inputBox;\n\t}\n\n\t$provideOriginalResource(sourceControlHandle: number, uriComponents: UriComponents, token: CancellationToken): Promise<UriComponents | null> {\n\t\tconst uri = URI.revive(uriComponents);\n\t\tthis.logService.trace('ExtHostSCM#$provideOriginalResource', sourceControlHandle, uri.toString());\n\n\t\tconst sourceControl = this._sourceControls.get(sourceControlHandle);\n\n\t\tif (!sourceControl || !sourceControl.quickDiffProvider || !sourceControl.quickDiffProvider.provideOriginalResource) {\n\t\t\treturn Promise.resolve(null);\n\t\t}\n\n\t\treturn asPromise(() => sourceControl.quickDiffProvider!.provideOriginalResource!(uri, token))\n\t\t\t.then<UriComponents | null>(r => r || null);\n\t}\n\n\t$onInputBoxValueChange(sourceControlHandle: number, value: string): Promise<void> {\n\t\tthis.logService.trace('ExtHostSCM#$onInputBoxValueChange', sourceControlHandle);\n\n\t\tconst sourceControl = this._sourceControls.get(sourceControlHandle);\n\n\t\tif (!sourceControl) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\tsourceControl.inputBox.$onInputBoxValueChange(value);\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\t$executeResourceCommand(sourceControlHandle: number, groupHandle: number, handle: number, preserveFocus: boolean): Promise<void> {\n\t\tthis.logService.trace('ExtHostSCM#$executeResourceCommand', sourceControlHandle, groupHandle, handle);\n\n\t\tconst sourceControl = this._sourceControls.get(sourceControlHandle);\n\n\t\tif (!sourceControl) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\tconst group = sourceControl.getResourceGroup(groupHandle);\n\n\t\tif (!group) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\treturn group.$executeResourceCommand(handle, preserveFocus);\n\t}\n\n\t$validateInput(sourceControlHandle: number, value: string, cursorPosition: number): Promise<[string | IMarkdownString, number] | undefined> {\n\t\tthis.logService.trace('ExtHostSCM#$validateInput', sourceControlHandle);\n\n\t\tconst sourceControl = this._sourceControls.get(sourceControlHandle);\n\n\t\tif (!sourceControl) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\tif (!sourceControl.inputBox.validateInput) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\treturn asPromise(() => sourceControl.inputBox.validateInput!(value, cursorPosition)).then(result => {\n\t\t\tif (!result) {\n\t\t\t\treturn Promise.resolve(undefined);\n\t\t\t}\n\n\t\t\tconst message = MarkdownString.fromStrict(result.message);\n\t\t\tif (!message) {\n\t\t\t\treturn Promise.resolve(undefined);\n\t\t\t}\n\n\t\t\treturn Promise.resolve<[string | IMarkdownString, number]>([message, result.type]);\n\t\t});\n\t}\n\n\t$setSelectedSourceControl(selectedSourceControlHandle: number | undefined): Promise<void> {\n\t\tthis.logService.trace('ExtHostSCM#$setSelectedSourceControl', selectedSourceControlHandle);\n\n\t\tif (selectedSourceControlHandle !== undefined) {\n\t\t\tthis._sourceControls.get(selectedSourceControlHandle)?.setSelectionState(true);\n\t\t}\n\n\t\tif (this._selectedSourceControlHandle !== undefined) {\n\t\t\tthis._sourceControls.get(this._selectedSourceControlHandle)?.setSelectionState(false);\n\t\t}\n\n\t\tthis._selectedSourceControlHandle = selectedSourceControlHandle;\n\t\treturn Promise.resolve(undefined);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { StatusBarAlignment as ExtHostStatusBarAlignment, Disposable, ThemeColor } from './extHostTypes';\nimport type * as vscode from 'vscode';\nimport { MainContext, MainThreadStatusBarShape, IMainContext, ICommandDto } from './extHost.protocol';\nimport { localize } from 'vs/nls';\nimport { CommandsConverter } from 'vs/workbench/api/common/extHostCommands';\nimport { DisposableStore } from 'vs/base/common/lifecycle';\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { MarkdownString } from 'vs/workbench/api/common/extHostTypeConverters';\nimport { isNumber } from 'vs/base/common/types';\n\nexport class ExtHostStatusBarEntry implements vscode.StatusBarItem {\n\n\tprivate static ID_GEN = 0;\n\n\tprivate static ALLOWED_BACKGROUND_COLORS = new Map<string, ThemeColor>(\n\t\t[\n\t\t\t['statusBarItem.errorBackground', new ThemeColor('statusBarItem.errorForeground')],\n\t\t\t['statusBarItem.warningBackground', new ThemeColor('statusBarItem.warningForeground')]\n\t\t]\n\t);\n\n\t#proxy: MainThreadStatusBarShape;\n\t#commands: CommandsConverter;\n\n\tprivate _entryId: number;\n\n\tprivate _extension?: IExtensionDescription;\n\n\tprivate _id?: string;\n\tprivate _alignment: number;\n\tprivate _priority?: number;\n\n\tprivate _disposed: boolean = false;\n\tprivate _visible: boolean = false;\n\n\tprivate _text: string = '';\n\tprivate _tooltip?: string | vscode.MarkdownString;\n\tprivate _name?: string;\n\tprivate _color?: string | ThemeColor;\n\tprivate _backgroundColor?: ThemeColor;\n\tprivate readonly _internalCommandRegistration = new DisposableStore();\n\tprivate _command?: {\n\t\treadonly fromApi: string | vscode.Command;\n\t\treadonly internal: ICommandDto;\n\t};\n\n\tprivate _timeoutHandle: any;\n\tprivate _accessibilityInformation?: vscode.AccessibilityInformation;\n\n\tconstructor(proxy: MainThreadStatusBarShape, commands: CommandsConverter, extension: IExtensionDescription, id?: string, alignment?: ExtHostStatusBarAlignment, priority?: number);\n\tconstructor(proxy: MainThreadStatusBarShape, commands: CommandsConverter, extension: IExtensionDescription | undefined, id: string, alignment?: ExtHostStatusBarAlignment, priority?: number);\n\tconstructor(proxy: MainThreadStatusBarShape, commands: CommandsConverter, extension?: IExtensionDescription, id?: string, alignment: ExtHostStatusBarAlignment = ExtHostStatusBarAlignment.Left, priority?: number) {\n\t\tthis.#proxy = proxy;\n\t\tthis.#commands = commands;\n\n\t\tthis._entryId = ExtHostStatusBarEntry.ID_GEN++;\n\n\t\tthis._extension = extension;\n\n\t\tthis._id = id;\n\t\tthis._alignment = alignment;\n\t\tthis._priority = this.validatePriority(priority);\n\t}\n\n\tprivate validatePriority(priority?: number): number | undefined {\n\t\tif (!isNumber(priority)) {\n\t\t\treturn undefined; // using this method to catch `NaN` too!\n\t\t}\n\n\t\t// Our RPC mechanism use JSON to serialize data which does\n\t\t// not support `Infinity` so we need to fill in the number\n\t\t// equivalent as close as possible.\n\t\t// https://github.com/microsoft/vscode/issues/133317\n\n\t\tif (priority === Number.POSITIVE_INFINITY) {\n\t\t\treturn Number.MAX_VALUE;\n\t\t}\n\n\t\tif (priority === Number.NEGATIVE_INFINITY) {\n\t\t\treturn -Number.MAX_VALUE;\n\t\t}\n\n\t\treturn priority;\n\t}\n\n\tpublic get id(): string {\n\t\treturn this._id ?? this._extension!.identifier.value;\n\t}\n\n\tpublic get alignment(): vscode.StatusBarAlignment {\n\t\treturn this._alignment;\n\t}\n\n\tpublic get priority(): number | undefined {\n\t\treturn this._priority;\n\t}\n\n\tpublic get text(): string {\n\t\treturn this._text;\n\t}\n\n\tpublic get name(): string | undefined {\n\t\treturn this._name;\n\t}\n\n\tpublic get tooltip(): vscode.MarkdownString | string | undefined {\n\t\treturn this._tooltip;\n\t}\n\n\tpublic get color(): string | ThemeColor | undefined {\n\t\treturn this._color;\n\t}\n\n\tpublic get backgroundColor(): ThemeColor | undefined {\n\t\treturn this._backgroundColor;\n\t}\n\n\tpublic get command(): string | vscode.Command | undefined {\n\t\treturn this._command?.fromApi;\n\t}\n\n\tpublic get accessibilityInformation(): vscode.AccessibilityInformation | undefined {\n\t\treturn this._accessibilityInformation;\n\t}\n\n\tpublic set text(text: string) {\n\t\tthis._text = text;\n\t\tthis.update();\n\t}\n\n\tpublic set name(name: string | undefined) {\n\t\tthis._name = name;\n\t\tthis.update();\n\t}\n\n\tpublic set tooltip(tooltip: vscode.MarkdownString | string | undefined) {\n\t\tthis._tooltip = tooltip;\n\t\tthis.update();\n\t}\n\n\tpublic set color(color: string | ThemeColor | undefined) {\n\t\tthis._color = color;\n\t\tthis.update();\n\t}\n\n\tpublic set backgroundColor(color: ThemeColor | undefined) {\n\t\tif (color && !ExtHostStatusBarEntry.ALLOWED_BACKGROUND_COLORS.has(color.id)) {\n\t\t\tcolor = undefined;\n\t\t}\n\n\t\tthis._backgroundColor = color;\n\t\tthis.update();\n\t}\n\n\tpublic set command(command: string | vscode.Command | undefined) {\n\t\tif (this._command?.fromApi === command) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._internalCommandRegistration.clear();\n\t\tif (typeof command === 'string') {\n\t\t\tthis._command = {\n\t\t\t\tfromApi: command,\n\t\t\t\tinternal: this.#commands.toInternal({ title: '', command }, this._internalCommandRegistration),\n\t\t\t};\n\t\t} else if (command) {\n\t\t\tthis._command = {\n\t\t\t\tfromApi: command,\n\t\t\t\tinternal: this.#commands.toInternal(command, this._internalCommandRegistration),\n\t\t\t};\n\t\t} else {\n\t\t\tthis._command = undefined;\n\t\t}\n\t\tthis.update();\n\t}\n\n\tpublic set accessibilityInformation(accessibilityInformation: vscode.AccessibilityInformation | undefined) {\n\t\tthis._accessibilityInformation = accessibilityInformation;\n\t\tthis.update();\n\t}\n\n\tpublic show(): void {\n\t\tthis._visible = true;\n\t\tthis.update();\n\t}\n\n\tpublic hide(): void {\n\t\tclearTimeout(this._timeoutHandle);\n\t\tthis._visible = false;\n\t\tthis.#proxy.$dispose(this._entryId);\n\t}\n\n\tprivate update(): void {\n\t\tif (this._disposed || !this._visible) {\n\t\t\treturn;\n\t\t}\n\n\t\tclearTimeout(this._timeoutHandle);\n\n\t\t// Defer the update so that multiple changes to setters dont cause a redraw each\n\t\tthis._timeoutHandle = setTimeout(() => {\n\t\t\tthis._timeoutHandle = undefined;\n\n\t\t\t// If the id is not set, derive it from the extension identifier,\n\t\t\t// otherwise make sure to prefix it with the extension identifier\n\t\t\t// to get a more unique value across extensions.\n\t\t\tlet id: string;\n\t\t\tif (this._extension) {\n\t\t\t\tif (this._id) {\n\t\t\t\t\tid = `${this._extension.identifier.value}.${this._id}`;\n\t\t\t\t} else {\n\t\t\t\t\tid = this._extension.identifier.value;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tid = this._id!;\n\t\t\t}\n\n\t\t\t// If the name is not set, derive it from the extension descriptor\n\t\t\tlet name: string;\n\t\t\tif (this._name) {\n\t\t\t\tname = this._name;\n\t\t\t} else {\n\t\t\t\tname = localize('extensionLabel', \"{0} (Extension)\", this._extension!.displayName || this._extension!.name);\n\t\t\t}\n\n\t\t\t// If a background color is set, the foreground is determined\n\t\t\tlet color = this._color;\n\t\t\tif (this._backgroundColor) {\n\t\t\t\tcolor = ExtHostStatusBarEntry.ALLOWED_BACKGROUND_COLORS.get(this._backgroundColor.id);\n\t\t\t}\n\n\t\t\tconst tooltip = MarkdownString.fromStrict(this._tooltip);\n\n\t\t\t// Set to status bar\n\t\t\tthis.#proxy.$setEntry(this._entryId, id, name, this._text, tooltip, this._command?.internal, color,\n\t\t\t\tthis._backgroundColor, this._alignment === ExtHostStatusBarAlignment.Left,\n\t\t\t\tthis._priority, this._accessibilityInformation);\n\t\t}, 0);\n\t}\n\n\tpublic dispose(): void {\n\t\tthis.hide();\n\t\tthis._disposed = true;\n\t}\n}\n\nclass StatusBarMessage {\n\n\tprivate _item: vscode.StatusBarItem;\n\tprivate _messages: { message: string }[] = [];\n\n\tconstructor(statusBar: ExtHostStatusBar) {\n\t\tthis._item = statusBar.createStatusBarEntry(undefined, 'status.extensionMessage', ExtHostStatusBarAlignment.Left, Number.MIN_VALUE);\n\t\tthis._item.name = localize('status.extensionMessage', \"Extension Status\");\n\t}\n\n\tdispose() {\n\t\tthis._messages.length = 0;\n\t\tthis._item.dispose();\n\t}\n\n\tsetMessage(message: string): Disposable {\n\t\tconst data: { message: string } = { message }; // use object to not confuse equal strings\n\t\tthis._messages.unshift(data);\n\t\tthis._update();\n\n\t\treturn new Disposable(() => {\n\t\t\tconst idx = this._messages.indexOf(data);\n\t\t\tif (idx >= 0) {\n\t\t\t\tthis._messages.splice(idx, 1);\n\t\t\t\tthis._update();\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate _update() {\n\t\tif (this._messages.length > 0) {\n\t\t\tthis._item.text = this._messages[0].message;\n\t\t\tthis._item.show();\n\t\t} else {\n\t\t\tthis._item.hide();\n\t\t}\n\t}\n}\n\nexport class ExtHostStatusBar {\n\n\tprivate readonly _proxy: MainThreadStatusBarShape;\n\tprivate readonly _commands: CommandsConverter;\n\tprivate _statusMessage: StatusBarMessage;\n\n\tconstructor(mainContext: IMainContext, commands: CommandsConverter) {\n\t\tthis._proxy = mainContext.getProxy(MainContext.MainThreadStatusBar);\n\t\tthis._commands = commands;\n\t\tthis._statusMessage = new StatusBarMessage(this);\n\t}\n\n\tcreateStatusBarEntry(extension: IExtensionDescription | undefined, id: string, alignment?: ExtHostStatusBarAlignment, priority?: number): vscode.StatusBarItem;\n\tcreateStatusBarEntry(extension: IExtensionDescription, id?: string, alignment?: ExtHostStatusBarAlignment, priority?: number): vscode.StatusBarItem;\n\tcreateStatusBarEntry(extension: IExtensionDescription, id: string, alignment?: ExtHostStatusBarAlignment, priority?: number): vscode.StatusBarItem {\n\t\treturn new ExtHostStatusBarEntry(this._proxy, this._commands, extension, id, alignment, priority);\n\t}\n\n\tsetStatusBarMessage(text: string, timeoutOrThenable?: number | Thenable<any>): Disposable {\n\t\tconst d = this._statusMessage.setMessage(text);\n\t\tlet handle: any;\n\n\t\tif (typeof timeoutOrThenable === 'number') {\n\t\t\thandle = setTimeout(() => d.dispose(), timeoutOrThenable);\n\t\t} else if (typeof timeoutOrThenable !== 'undefined') {\n\t\t\ttimeoutOrThenable.then(() => d.dispose(), () => d.dispose());\n\t\t}\n\n\t\treturn new Disposable(() => {\n\t\t\td.dispose();\n\t\t\tclearTimeout(handle);\n\t\t});\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { MainContext, MainThreadStorageShape, ExtHostStorageShape } from './extHost.protocol';\nimport { Emitter } from 'vs/base/common/event';\nimport { IExtHostRpcService } from 'vs/workbench/api/common/extHostRpcService';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { IExtensionIdWithVersion } from 'vs/platform/extensionManagement/common/extensionStorage';\n\nexport interface IStorageChangeEvent {\n\tshared: boolean;\n\tkey: string;\n\tvalue: object;\n}\n\nexport class ExtHostStorage implements ExtHostStorageShape {\n\n\treadonly _serviceBrand: undefined;\n\n\tprivate _proxy: MainThreadStorageShape;\n\n\tprivate readonly _onDidChangeStorage = new Emitter<IStorageChangeEvent>();\n\treadonly onDidChangeStorage = this._onDidChangeStorage.event;\n\n\tconstructor(mainContext: IExtHostRpcService) {\n\t\tthis._proxy = mainContext.getProxy(MainContext.MainThreadStorage);\n\t}\n\n\tregisterExtensionStorageKeysToSync(extension: IExtensionIdWithVersion, keys: string[]): void {\n\t\tthis._proxy.$registerExtensionStorageKeysToSync(extension, keys);\n\t}\n\n\tinitializeExtensionStorage(shared: boolean, key: string, defaultValue?: object): Promise<object | undefined> {\n\t\treturn this._proxy.$initializeExtensionStorage(shared, key).then(value => value || defaultValue);\n\t}\n\n\tsetValue(shared: boolean, key: string, value: object): Promise<void> {\n\t\treturn this._proxy.$setValue(shared, key, value);\n\t}\n\n\t$acceptValue(shared: boolean, key: string, value: object): void {\n\t\tthis._onDidChangeStorage.fire({ shared, key, value });\n\t}\n}\n\nexport interface IExtHostStorage extends ExtHostStorage { }\nexport const IExtHostStorage = createDecorator<IExtHostStorage>('IExtHostStorage');\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { IExtHostInitDataService } from 'vs/workbench/api/common/extHostInitDataService';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { IEnvironment, IStaticWorkspaceData } from 'vs/workbench/services/extensions/common/extensionHostProtocol';\nimport { IExtHostConsumerFileSystem } from 'vs/workbench/api/common/extHostFileSystemConsumer';\nimport { URI } from 'vs/base/common/uri';\n\nexport const IExtensionStoragePaths = createDecorator<IExtensionStoragePaths>('IExtensionStoragePaths');\n\nexport interface IExtensionStoragePaths {\n\treadonly _serviceBrand: undefined;\n\twhenReady: Promise<any>;\n\tworkspaceValue(extension: IExtensionDescription): URI | undefined;\n\tglobalValue(extension: IExtensionDescription): URI;\n\tonWillDeactivateAll(): void;\n}\n\nexport class ExtensionStoragePaths implements IExtensionStoragePaths {\n\n\treadonly _serviceBrand: undefined;\n\n\tprivate readonly _workspace?: IStaticWorkspaceData;\n\tprotected readonly _environment: IEnvironment;\n\n\treadonly whenReady: Promise<URI | undefined>;\n\tprivate _value?: URI;\n\n\tconstructor(\n\t\t@IExtHostInitDataService initData: IExtHostInitDataService,\n\t\t@ILogService protected readonly _logService: ILogService,\n\t\t@IExtHostConsumerFileSystem private readonly _extHostFileSystem: IExtHostConsumerFileSystem\n\t) {\n\t\tthis._workspace = initData.workspace ?? undefined;\n\t\tthis._environment = initData.environment;\n\t\tthis.whenReady = this._getOrCreateWorkspaceStoragePath().then(value => this._value = value);\n\t}\n\n\tprotected async _getWorkspaceStorageURI(storageName: string): Promise<URI> {\n\t\treturn URI.joinPath(this._environment.workspaceStorageHome, storageName);\n\t}\n\n\tprivate async _getOrCreateWorkspaceStoragePath(): Promise<URI | undefined> {\n\t\tif (!this._workspace) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\t\tconst storageName = this._workspace.id;\n\t\tconst storageUri = await this._getWorkspaceStorageURI(storageName);\n\n\t\ttry {\n\t\t\tawait this._extHostFileSystem.value.stat(storageUri);\n\t\t\tthis._logService.trace('[ExtHostStorage] storage dir already exists', storageUri);\n\t\t\treturn storageUri;\n\t\t} catch {\n\t\t\t// doesn't exist, that's OK\n\t\t}\n\n\t\ttry {\n\t\t\tthis._logService.trace('[ExtHostStorage] creating dir and metadata-file', storageUri);\n\t\t\tawait this._extHostFileSystem.value.createDirectory(storageUri);\n\t\t\tawait this._extHostFileSystem.value.writeFile(\n\t\t\t\tURI.joinPath(storageUri, 'meta.json'),\n\t\t\t\tnew TextEncoder().encode(JSON.stringify({\n\t\t\t\t\tid: this._workspace.id,\n\t\t\t\t\tconfiguration: URI.revive(this._workspace.configuration)?.toString(),\n\t\t\t\t\tname: this._workspace.name\n\t\t\t\t}, undefined, 2))\n\t\t\t);\n\t\t\treturn storageUri;\n\n\t\t} catch (e) {\n\t\t\tthis._logService.error('[ExtHostStorage]', e);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tworkspaceValue(extension: IExtensionDescription): URI | undefined {\n\t\tif (this._value) {\n\t\t\treturn URI.joinPath(this._value, extension.identifier.value);\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tglobalValue(extension: IExtensionDescription): URI {\n\t\treturn URI.joinPath(this._environment.globalStorageHome, extension.identifier.value.toLowerCase());\n\t}\n\n\tonWillDeactivateAll(): void {\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type * as vscode from 'vscode';\nimport { Event, Emitter } from 'vs/base/common/event';\nimport { ExtHostTerminalServiceShape, MainContext, MainThreadTerminalServiceShape, ITerminalDimensionsDto, ITerminalLinkDto, ExtHostTerminalIdentifier } from 'vs/workbench/api/common/extHost.protocol';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { URI } from 'vs/base/common/uri';\nimport { IExtHostRpcService } from 'vs/workbench/api/common/extHostRpcService';\nimport { IDisposable, DisposableStore, Disposable } from 'vs/base/common/lifecycle';\nimport { Disposable as VSCodeDisposable, EnvironmentVariableMutatorType, TerminalExitReason } from './extHostTypes';\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { localize } from 'vs/nls';\nimport { NotSupportedError } from 'vs/base/common/errors';\nimport { serializeEnvironmentVariableCollection } from 'vs/workbench/contrib/terminal/common/environmentVariableShared';\nimport { CancellationTokenSource } from 'vs/base/common/cancellation';\nimport { generateUuid } from 'vs/base/common/uuid';\nimport { ISerializableEnvironmentVariableCollection } from 'vs/workbench/contrib/terminal/common/environmentVariable';\nimport { ICreateContributedTerminalProfileOptions, IProcessReadyEvent, IShellLaunchConfigDto, ITerminalChildProcess, ITerminalLaunchError, ITerminalProfile, TerminalIcon, TerminalLocation, IProcessProperty, ProcessPropertyType, IProcessPropertyMap } from 'vs/platform/terminal/common/terminal';\nimport { TerminalDataBufferer } from 'vs/platform/terminal/common/terminalDataBuffering';\nimport { ThemeColor } from 'vs/platform/theme/common/themeService';\nimport { withNullAsUndefined } from 'vs/base/common/types';\nimport { Promises } from 'vs/base/common/async';\n\nexport interface IExtHostTerminalService extends ExtHostTerminalServiceShape, IDisposable {\n\n\treadonly _serviceBrand: undefined;\n\n\tactiveTerminal: vscode.Terminal | undefined;\n\tterminals: vscode.Terminal[];\n\n\tonDidCloseTerminal: Event<vscode.Terminal>;\n\tonDidOpenTerminal: Event<vscode.Terminal>;\n\tonDidChangeActiveTerminal: Event<vscode.Terminal | undefined>;\n\tonDidChangeTerminalDimensions: Event<vscode.TerminalDimensionsChangeEvent>;\n\tonDidChangeTerminalState: Event<vscode.Terminal>;\n\tonDidWriteTerminalData: Event<vscode.TerminalDataWriteEvent>;\n\n\tcreateTerminal(name?: string, shellPath?: string, shellArgs?: readonly string[] | string): vscode.Terminal;\n\tcreateTerminalFromOptions(options: vscode.TerminalOptions, internalOptions?: ITerminalInternalOptions): vscode.Terminal;\n\tcreateExtensionTerminal(options: vscode.ExtensionTerminalOptions): vscode.Terminal;\n\tattachPtyToTerminal(id: number, pty: vscode.Pseudoterminal): void;\n\tgetDefaultShell(useAutomationShell: boolean): string;\n\tgetDefaultShellArgs(useAutomationShell: boolean): string[] | string;\n\tregisterLinkProvider(provider: vscode.TerminalLinkProvider): vscode.Disposable;\n\tregisterProfileProvider(extension: IExtensionDescription, id: string, provider: vscode.TerminalProfileProvider): vscode.Disposable;\n\tgetEnvironmentVariableCollection(extension: IExtensionDescription, persistent?: boolean): vscode.EnvironmentVariableCollection;\n}\n\nexport interface ITerminalInternalOptions {\n\tisFeatureTerminal?: boolean;\n\tuseShellEnvironment?: boolean;\n\tresolvedExtHostIdentifier?: ExtHostTerminalIdentifier;\n\t/**\n\t * This location is different from the API location because it can include splitActiveTerminal,\n\t * a property we resolve internally\n\t */\n\tlocation?: TerminalLocation | { viewColumn: number; preserveState?: boolean } | { splitActiveTerminal: boolean };\n}\n\nexport const IExtHostTerminalService = createDecorator<IExtHostTerminalService>('IExtHostTerminalService');\n\nexport class ExtHostTerminal {\n\tprivate _disposed: boolean = false;\n\tprivate _pidPromise: Promise<number | undefined>;\n\tprivate _cols: number | undefined;\n\tprivate _pidPromiseComplete: ((value: number | undefined) => any) | undefined;\n\tprivate _rows: number | undefined;\n\tprivate _exitStatus: vscode.TerminalExitStatus | undefined;\n\tprivate _state: vscode.TerminalState = { isInteractedWith: false };\n\n\tpublic isOpen: boolean = false;\n\n\treadonly value: vscode.Terminal;\n\n\tconstructor(\n\t\tprivate _proxy: MainThreadTerminalServiceShape,\n\t\tpublic _id: ExtHostTerminalIdentifier,\n\t\tprivate readonly _creationOptions: vscode.TerminalOptions | vscode.ExtensionTerminalOptions,\n\t\tprivate _name?: string,\n\t) {\n\t\tthis._creationOptions = Object.freeze(this._creationOptions);\n\t\tthis._pidPromise = new Promise<number | undefined>(c => this._pidPromiseComplete = c);\n\n\t\tconst that = this;\n\t\tthis.value = {\n\t\t\tget name(): string {\n\t\t\t\treturn that._name || '';\n\t\t\t},\n\t\t\tget processId(): Promise<number | undefined> {\n\t\t\t\treturn that._pidPromise;\n\t\t\t},\n\t\t\tget creationOptions(): Readonly<vscode.TerminalOptions | vscode.ExtensionTerminalOptions> {\n\t\t\t\treturn that._creationOptions;\n\t\t\t},\n\t\t\tget exitStatus(): vscode.TerminalExitStatus | undefined {\n\t\t\t\treturn that._exitStatus;\n\t\t\t},\n\t\t\tget state(): vscode.TerminalState {\n\t\t\t\treturn that._state;\n\t\t\t},\n\t\t\tsendText(text: string, addNewLine: boolean = true): void {\n\t\t\t\tthat._checkDisposed();\n\t\t\t\tthat._proxy.$sendText(that._id, text, addNewLine);\n\t\t\t},\n\t\t\tshow(preserveFocus: boolean): void {\n\t\t\t\tthat._checkDisposed();\n\t\t\t\tthat._proxy.$show(that._id, preserveFocus);\n\t\t\t},\n\t\t\thide(): void {\n\t\t\t\tthat._checkDisposed();\n\t\t\t\tthat._proxy.$hide(that._id);\n\t\t\t},\n\t\t\tdispose(): void {\n\t\t\t\tif (!that._disposed) {\n\t\t\t\t\tthat._disposed = true;\n\t\t\t\t\tthat._proxy.$dispose(that._id);\n\t\t\t\t}\n\t\t\t},\n\t\t\tget dimensions(): vscode.TerminalDimensions | undefined {\n\t\t\t\tif (that._cols === undefined || that._rows === undefined) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tcolumns: that._cols,\n\t\t\t\t\trows: that._rows\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\t}\n\n\tpublic async create(\n\t\toptions: vscode.TerminalOptions,\n\t\tinternalOptions?: ITerminalInternalOptions,\n\t): Promise<void> {\n\t\tif (typeof this._id !== 'string') {\n\t\t\tthrow new Error('Terminal has already been created');\n\t\t}\n\t\tawait this._proxy.$createTerminal(this._id, {\n\t\t\tname: options.name,\n\t\t\tshellPath: withNullAsUndefined(options.shellPath),\n\t\t\tshellArgs: withNullAsUndefined(options.shellArgs),\n\t\t\tcwd: withNullAsUndefined(options.cwd),\n\t\t\tenv: withNullAsUndefined(options.env),\n\t\t\ticon: withNullAsUndefined(asTerminalIcon(options.iconPath)),\n\t\t\tcolor: ThemeColor.isThemeColor(options.color) ? options.color.id : undefined,\n\t\t\tinitialText: withNullAsUndefined(options.message),\n\t\t\tstrictEnv: withNullAsUndefined(options.strictEnv),\n\t\t\thideFromUser: withNullAsUndefined(options.hideFromUser),\n\t\t\tisFeatureTerminal: withNullAsUndefined(internalOptions?.isFeatureTerminal),\n\t\t\tisExtensionOwnedTerminal: true,\n\t\t\tuseShellEnvironment: withNullAsUndefined(internalOptions?.useShellEnvironment),\n\t\t\tlocation: internalOptions?.location || this._serializeParentTerminal(options.location, internalOptions?.resolvedExtHostIdentifier),\n\t\t\tisTransient: withNullAsUndefined(options.isTransient)\n\t\t});\n\t}\n\n\n\tpublic async createExtensionTerminal(location?: TerminalLocation | vscode.TerminalEditorLocationOptions | vscode.TerminalSplitLocationOptions, parentTerminal?: ExtHostTerminalIdentifier, iconPath?: TerminalIcon, color?: ThemeColor): Promise<number> {\n\t\tif (typeof this._id !== 'string') {\n\t\t\tthrow new Error('Terminal has already been created');\n\t\t}\n\t\tawait this._proxy.$createTerminal(this._id, {\n\t\t\tname: this._name,\n\t\t\tisExtensionCustomPtyTerminal: true,\n\t\t\ticon: iconPath,\n\t\t\tcolor: ThemeColor.isThemeColor(color) ? color.id : undefined,\n\t\t\tlocation: this._serializeParentTerminal(location, parentTerminal),\n\t\t\tisTransient: true\n\t\t});\n\t\t// At this point, the id has been set via `$acceptTerminalOpened`\n\t\tif (typeof this._id === 'string') {\n\t\t\tthrow new Error('Terminal creation failed');\n\t\t}\n\t\treturn this._id;\n\t}\n\n\tprivate _serializeParentTerminal(location?: TerminalLocation | vscode.TerminalEditorLocationOptions | vscode.TerminalSplitLocationOptions, parentTerminal?: ExtHostTerminalIdentifier): TerminalLocation | vscode.TerminalEditorLocationOptions | { parentTerminal: ExtHostTerminalIdentifier } | undefined {\n\t\tif (typeof location === 'object') {\n\t\t\tif ('parentTerminal' in location && location.parentTerminal && parentTerminal) {\n\t\t\t\treturn { parentTerminal };\n\t\t\t}\n\n\t\t\tif ('viewColumn' in location) {\n\t\t\t\treturn { viewColumn: location.viewColumn, preserveFocus: location.preserveFocus };\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn location;\n\t}\n\n\tprivate _checkDisposed() {\n\t\tif (this._disposed) {\n\t\t\tthrow new Error('Terminal has already been disposed');\n\t\t}\n\t}\n\n\tpublic set name(name: string) {\n\t\tthis._name = name;\n\t}\n\n\tpublic setExitStatus(code: number | undefined, reason: TerminalExitReason) {\n\t\tthis._exitStatus = Object.freeze({ code, reason });\n\t}\n\n\tpublic setDimensions(cols: number, rows: number): boolean {\n\t\tif (cols === this._cols && rows === this._rows) {\n\t\t\t// Nothing changed\n\t\t\treturn false;\n\t\t}\n\t\tif (cols === 0 || rows === 0) {\n\t\t\treturn false;\n\t\t}\n\t\tthis._cols = cols;\n\t\tthis._rows = rows;\n\t\treturn true;\n\t}\n\n\tpublic setInteractedWith(): boolean {\n\t\tif (!this._state.isInteractedWith) {\n\t\t\tthis._state = { isInteractedWith: true };\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic _setProcessId(processId: number | undefined): void {\n\t\t// The event may fire 2 times when the panel is restored\n\t\tif (this._pidPromiseComplete) {\n\t\t\tthis._pidPromiseComplete(processId);\n\t\t\tthis._pidPromiseComplete = undefined;\n\t\t} else {\n\t\t\t// Recreate the promise if this is the nth processId set (e.g. reused task terminals)\n\t\t\tthis._pidPromise.then(pid => {\n\t\t\t\tif (pid !== processId) {\n\t\t\t\t\tthis._pidPromise = Promise.resolve(processId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n}\n\nexport class ExtHostPseudoterminal implements ITerminalChildProcess {\n\treadonly id = 0;\n\treadonly shouldPersist = false;\n\n\tprivate readonly _onProcessData = new Emitter<string>();\n\tpublic readonly onProcessData: Event<string> = this._onProcessData.event;\n\tprivate readonly _onProcessReady = new Emitter<IProcessReadyEvent>();\n\tpublic get onProcessReady(): Event<IProcessReadyEvent> { return this._onProcessReady.event; }\n\tprivate readonly _onDidChangeProperty = new Emitter<IProcessProperty<any>>();\n\tpublic readonly onDidChangeProperty = this._onDidChangeProperty.event;\n\tprivate readonly _onProcessExit = new Emitter<number | undefined>();\n\tpublic readonly onProcessExit: Event<number | undefined> = this._onProcessExit.event;\n\n\tconstructor(private readonly _pty: vscode.Pseudoterminal) { }\n\n\trefreshProperty<T extends ProcessPropertyType>(property: ProcessPropertyType): Promise<IProcessPropertyMap[T]> {\n\t\tthrow new Error(`refreshProperty is not suppported in extension owned terminals. property: ${property}`);\n\t}\n\n\tupdateProperty<T extends ProcessPropertyType>(property: ProcessPropertyType, value: IProcessPropertyMap[T]): Promise<void> {\n\t\tthrow new Error(`updateProperty is not suppported in extension owned terminals. property: ${property}, value: ${value}`);\n\t}\n\n\tasync start(): Promise<undefined> {\n\t\treturn undefined;\n\t}\n\n\tshutdown(): void {\n\t\tthis._pty.close();\n\t}\n\n\tinput(data: string): void {\n\t\tthis._pty.handleInput?.(data);\n\t}\n\n\tresize(cols: number, rows: number): void {\n\t\tthis._pty.setDimensions?.({ columns: cols, rows });\n\t}\n\n\tasync processBinary(data: string): Promise<void> {\n\t\t// No-op, processBinary is not supported in extension owned terminals.\n\t}\n\n\tacknowledgeDataEvent(charCount: number): void {\n\t\t// No-op, flow control is not supported in extension owned terminals. If this is ever\n\t\t// implemented it will need new pause and resume VS Code APIs.\n\t}\n\n\tasync setUnicodeVersion(version: '6' | '11'): Promise<void> {\n\t\t// No-op, xterm-headless isn't used for extension owned terminals.\n\t}\n\n\tgetInitialCwd(): Promise<string> {\n\t\treturn Promise.resolve('');\n\t}\n\n\tgetCwd(): Promise<string> {\n\t\treturn Promise.resolve('');\n\t}\n\n\tgetLatency(): Promise<number> {\n\t\treturn Promise.resolve(0);\n\t}\n\n\tstartSendingEvents(initialDimensions: ITerminalDimensionsDto | undefined): void {\n\t\t// Attach the listeners\n\t\tthis._pty.onDidWrite(e => this._onProcessData.fire(e));\n\t\tthis._pty.onDidClose?.((e: number | void = undefined) => {\n\t\t\tthis._onProcessExit.fire(e === void 0 ? undefined : e);\n\t\t});\n\t\tthis._pty.onDidOverrideDimensions?.(e => {\n\t\t\tif (e) {\n\t\t\t\tthis._onDidChangeProperty.fire({ type: ProcessPropertyType.OverrideDimensions, value: { cols: e.columns, rows: e.rows } });\n\t\t\t}\n\t\t});\n\t\tthis._pty.onDidChangeName?.(title => {\n\t\t\tthis._onDidChangeProperty.fire({ type: ProcessPropertyType.Title, value: title });\n\t\t});\n\n\t\tthis._pty.open(initialDimensions ? initialDimensions : undefined);\n\n\t\tif (initialDimensions) {\n\t\t\tthis._pty.setDimensions?.(initialDimensions);\n\t\t}\n\n\t\tthis._onProcessReady.fire({ pid: -1, cwd: '' });\n\t}\n}\n\nlet nextLinkId = 1;\n\ninterface ICachedLinkEntry {\n\tprovider: vscode.TerminalLinkProvider;\n\tlink: vscode.TerminalLink;\n}\n\nexport abstract class BaseExtHostTerminalService extends Disposable implements IExtHostTerminalService, ExtHostTerminalServiceShape {\n\n\treadonly _serviceBrand: undefined;\n\n\tprotected _proxy: MainThreadTerminalServiceShape;\n\tprotected _activeTerminal: ExtHostTerminal | undefined;\n\tprotected _terminals: ExtHostTerminal[] = [];\n\tprotected _terminalProcesses: Map<number, ITerminalChildProcess> = new Map();\n\tprotected _terminalProcessDisposables: { [id: number]: IDisposable } = {};\n\tprotected _extensionTerminalAwaitingStart: { [id: number]: { initialDimensions: ITerminalDimensionsDto | undefined } | undefined } = {};\n\tprotected _getTerminalPromises: { [id: number]: Promise<ExtHostTerminal | undefined> } = {};\n\tprotected _environmentVariableCollections: Map<string, EnvironmentVariableCollection> = new Map();\n\tprivate _defaultProfile: ITerminalProfile | undefined;\n\tprivate _defaultAutomationProfile: ITerminalProfile | undefined;\n\n\tprivate readonly _bufferer: TerminalDataBufferer;\n\tprivate readonly _linkProviders: Set<vscode.TerminalLinkProvider> = new Set();\n\tprivate readonly _profileProviders: Map<string, vscode.TerminalProfileProvider> = new Map();\n\tprivate readonly _terminalLinkCache: Map<number, Map<number, ICachedLinkEntry>> = new Map();\n\tprivate readonly _terminalLinkCancellationSource: Map<number, CancellationTokenSource> = new Map();\n\n\tpublic get activeTerminal(): vscode.Terminal | undefined { return this._activeTerminal?.value; }\n\tpublic get terminals(): vscode.Terminal[] { return this._terminals.map(term => term.value); }\n\n\tprotected readonly _onDidCloseTerminal = new Emitter<vscode.Terminal>();\n\treadonly onDidCloseTerminal = this._onDidCloseTerminal.event;\n\tprotected readonly _onDidOpenTerminal = new Emitter<vscode.Terminal>();\n\treadonly onDidOpenTerminal = this._onDidOpenTerminal.event;\n\tprotected readonly _onDidChangeActiveTerminal = new Emitter<vscode.Terminal | undefined>();\n\treadonly onDidChangeActiveTerminal = this._onDidChangeActiveTerminal.event;\n\tprotected readonly _onDidChangeTerminalDimensions = new Emitter<vscode.TerminalDimensionsChangeEvent>();\n\treadonly onDidChangeTerminalDimensions = this._onDidChangeTerminalDimensions.event;\n\tprotected readonly _onDidChangeTerminalState = new Emitter<vscode.Terminal>();\n\treadonly onDidChangeTerminalState = this._onDidChangeTerminalState.event;\n\tprotected readonly _onDidWriteTerminalData: Emitter<vscode.TerminalDataWriteEvent>;\n\tget onDidWriteTerminalData(): Event<vscode.TerminalDataWriteEvent> { return this._onDidWriteTerminalData.event; }\n\n\tconstructor(\n\t\tsupportsProcesses: boolean,\n\t\t@IExtHostRpcService extHostRpc: IExtHostRpcService\n\t) {\n\t\tsuper();\n\t\tthis._proxy = extHostRpc.getProxy(MainContext.MainThreadTerminalService);\n\t\tthis._bufferer = new TerminalDataBufferer(this._proxy.$sendProcessData);\n\t\tthis._onDidWriteTerminalData = new Emitter<vscode.TerminalDataWriteEvent>({\n\t\t\tonFirstListenerAdd: () => this._proxy.$startSendingDataEvents(),\n\t\t\tonLastListenerRemove: () => this._proxy.$stopSendingDataEvents()\n\t\t});\n\t\tthis._proxy.$registerProcessSupport(supportsProcesses);\n\t\tthis._register({\n\t\t\tdispose: () => {\n\t\t\t\tfor (const [_, terminalProcess] of this._terminalProcesses) {\n\t\t\t\t\tterminalProcess.shutdown(true);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tpublic abstract createTerminal(name?: string, shellPath?: string, shellArgs?: string[] | string): vscode.Terminal;\n\tpublic abstract createTerminalFromOptions(options: vscode.TerminalOptions, internalOptions?: ITerminalInternalOptions): vscode.Terminal;\n\n\tpublic getDefaultShell(useAutomationShell: boolean): string {\n\t\tconst profile = useAutomationShell ? this._defaultAutomationProfile : this._defaultProfile;\n\t\treturn profile?.path || '';\n\t}\n\n\tpublic getDefaultShellArgs(useAutomationShell: boolean): string[] | string {\n\t\tconst profile = useAutomationShell ? this._defaultAutomationProfile : this._defaultProfile;\n\t\treturn profile?.args || [];\n\t}\n\n\tpublic createExtensionTerminal(options: vscode.ExtensionTerminalOptions, internalOptions?: ITerminalInternalOptions): vscode.Terminal {\n\t\tconst terminal = new ExtHostTerminal(this._proxy, generateUuid(), options, options.name);\n\t\tconst p = new ExtHostPseudoterminal(options.pty);\n\t\tterminal.createExtensionTerminal(options.location, this._serializeParentTerminal(options, internalOptions).resolvedExtHostIdentifier, asTerminalIcon(options.iconPath), asTerminalColor(options.color)).then(id => {\n\t\t\tconst disposable = this._setupExtHostProcessListeners(id, p);\n\t\t\tthis._terminalProcessDisposables[id] = disposable;\n\t\t});\n\t\tthis._terminals.push(terminal);\n\t\treturn terminal.value;\n\t}\n\n\tprotected _serializeParentTerminal(options: vscode.TerminalOptions, internalOptions?: ITerminalInternalOptions): ITerminalInternalOptions {\n\t\tinternalOptions = internalOptions ? internalOptions : {};\n\t\tif (options.location && typeof options.location === 'object' && 'parentTerminal' in options.location) {\n\t\t\tconst parentTerminal = options.location.parentTerminal;\n\t\t\tif (parentTerminal) {\n\t\t\t\tconst parentExtHostTerminal = this._terminals.find(t => t.value === parentTerminal);\n\t\t\t\tif (parentExtHostTerminal) {\n\t\t\t\t\tinternalOptions.resolvedExtHostIdentifier = parentExtHostTerminal._id;\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (options.location && typeof options.location !== 'object') {\n\t\t\tinternalOptions.location = options.location;\n\t\t} else if (internalOptions.location && typeof internalOptions.location === 'object' && 'splitActiveTerminal' in internalOptions.location) {\n\t\t\tinternalOptions.location = { splitActiveTerminal: true };\n\t\t}\n\t\treturn internalOptions;\n\t}\n\n\tpublic attachPtyToTerminal(id: number, pty: vscode.Pseudoterminal): void {\n\t\tconst terminal = this._getTerminalById(id);\n\t\tif (!terminal) {\n\t\t\tthrow new Error(`Cannot resolve terminal with id ${id} for virtual process`);\n\t\t}\n\t\tconst p = new ExtHostPseudoterminal(pty);\n\t\tconst disposable = this._setupExtHostProcessListeners(id, p);\n\t\tthis._terminalProcessDisposables[id] = disposable;\n\t}\n\n\tpublic async $acceptActiveTerminalChanged(id: number | null): Promise<void> {\n\t\tconst original = this._activeTerminal;\n\t\tif (id === null) {\n\t\t\tthis._activeTerminal = undefined;\n\t\t\tif (original !== this._activeTerminal) {\n\t\t\t\tthis._onDidChangeActiveTerminal.fire(this._activeTerminal);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tconst terminal = this._getTerminalById(id);\n\t\tif (terminal) {\n\t\t\tthis._activeTerminal = terminal;\n\t\t\tif (original !== this._activeTerminal) {\n\t\t\t\tthis._onDidChangeActiveTerminal.fire(this._activeTerminal.value);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic async $acceptTerminalProcessData(id: number, data: string): Promise<void> {\n\t\tconst terminal = this._getTerminalById(id);\n\t\tif (terminal) {\n\t\t\tthis._onDidWriteTerminalData.fire({ terminal: terminal.value, data });\n\t\t}\n\t}\n\n\tpublic async $acceptTerminalDimensions(id: number, cols: number, rows: number): Promise<void> {\n\t\tconst terminal = this._getTerminalById(id);\n\t\tif (terminal) {\n\t\t\tif (terminal.setDimensions(cols, rows)) {\n\t\t\t\tthis._onDidChangeTerminalDimensions.fire({\n\t\t\t\t\tterminal: terminal.value,\n\t\t\t\t\tdimensions: terminal.value.dimensions as vscode.TerminalDimensions\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic async $acceptTerminalMaximumDimensions(id: number, cols: number, rows: number): Promise<void> {\n\t\t// Extension pty terminal only - when virtual process resize fires it means that the\n\t\t// terminal's maximum dimensions changed\n\t\tthis._terminalProcesses.get(id)?.resize(cols, rows);\n\t}\n\n\tpublic async $acceptTerminalTitleChange(id: number, name: string): Promise<void> {\n\t\tconst terminal = this._getTerminalById(id);\n\t\tif (terminal) {\n\t\t\tterminal.name = name;\n\t\t}\n\t}\n\n\tpublic async $acceptTerminalClosed(id: number, exitCode: number | undefined, exitReason: TerminalExitReason): Promise<void> {\n\t\tconst index = this._getTerminalObjectIndexById(this._terminals, id);\n\t\tif (index !== null) {\n\t\t\tconst terminal = this._terminals.splice(index, 1)[0];\n\t\t\tterminal.setExitStatus(exitCode, exitReason);\n\t\t\tthis._onDidCloseTerminal.fire(terminal.value);\n\t\t}\n\t}\n\n\tpublic $acceptTerminalOpened(id: number, extHostTerminalId: string | undefined, name: string, shellLaunchConfigDto: IShellLaunchConfigDto): void {\n\t\tif (extHostTerminalId) {\n\t\t\t// Resolve with the renderer generated id\n\t\t\tconst index = this._getTerminalObjectIndexById(this._terminals, extHostTerminalId);\n\t\t\tif (index !== null) {\n\t\t\t\t// The terminal has already been created (via createTerminal*), only fire the event\n\t\t\t\tthis._terminals[index]._id = id;\n\t\t\t\tthis._onDidOpenTerminal.fire(this.terminals[index]);\n\t\t\t\tthis._terminals[index].isOpen = true;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tconst creationOptions: vscode.TerminalOptions = {\n\t\t\tname: shellLaunchConfigDto.name,\n\t\t\tshellPath: shellLaunchConfigDto.executable,\n\t\t\tshellArgs: shellLaunchConfigDto.args,\n\t\t\tcwd: typeof shellLaunchConfigDto.cwd === 'string' ? shellLaunchConfigDto.cwd : URI.revive(shellLaunchConfigDto.cwd),\n\t\t\tenv: shellLaunchConfigDto.env,\n\t\t\thideFromUser: shellLaunchConfigDto.hideFromUser\n\t\t};\n\t\tconst terminal = new ExtHostTerminal(this._proxy, id, creationOptions, name);\n\t\tthis._terminals.push(terminal);\n\t\tthis._onDidOpenTerminal.fire(terminal.value);\n\t\tterminal.isOpen = true;\n\t}\n\n\tpublic async $acceptTerminalProcessId(id: number, processId: number): Promise<void> {\n\t\tconst terminal = this._getTerminalById(id);\n\t\tterminal?._setProcessId(processId);\n\t}\n\n\tpublic async $startExtensionTerminal(id: number, initialDimensions: ITerminalDimensionsDto | undefined): Promise<ITerminalLaunchError | undefined> {\n\t\t// Make sure the ExtHostTerminal exists so onDidOpenTerminal has fired before we call\n\t\t// Pseudoterminal.start\n\t\tconst terminal = this._getTerminalById(id);\n\t\tif (!terminal) {\n\t\t\treturn { message: localize('launchFail.idMissingOnExtHost', \"Could not find the terminal with id {0} on the extension host\", id) };\n\t\t}\n\n\t\t// Wait for onDidOpenTerminal to fire\n\t\tif (!terminal.isOpen) {\n\t\t\tawait new Promise<void>(r => {\n\t\t\t\t// Ensure open is called after onDidOpenTerminal\n\t\t\t\tconst listener = this.onDidOpenTerminal(async e => {\n\t\t\t\t\tif (e === terminal.value) {\n\t\t\t\t\t\tlistener.dispose();\n\t\t\t\t\t\tr();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tconst terminalProcess = this._terminalProcesses.get(id);\n\t\tif (terminalProcess) {\n\t\t\t(terminalProcess as ExtHostPseudoterminal).startSendingEvents(initialDimensions);\n\t\t} else {\n\t\t\t// Defer startSendingEvents call to when _setupExtHostProcessListeners is called\n\t\t\tthis._extensionTerminalAwaitingStart[id] = { initialDimensions };\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprotected _setupExtHostProcessListeners(id: number, p: ITerminalChildProcess): IDisposable {\n\t\tconst disposables = new DisposableStore();\n\t\tdisposables.add(p.onProcessReady(e => this._proxy.$sendProcessReady(id, e.pid, e.cwd)));\n\t\tdisposables.add(p.onDidChangeProperty(property => this._proxy.$sendProcessProperty(id, property)));\n\n\t\t// Buffer data events to reduce the amount of messages going to the renderer\n\t\tthis._bufferer.startBuffering(id, p.onProcessData);\n\t\tdisposables.add(p.onProcessExit(exitCode => this._onProcessExit(id, exitCode)));\n\t\tthis._terminalProcesses.set(id, p);\n\n\t\tconst awaitingStart = this._extensionTerminalAwaitingStart[id];\n\t\tif (awaitingStart && p instanceof ExtHostPseudoterminal) {\n\t\t\tp.startSendingEvents(awaitingStart.initialDimensions);\n\t\t\tdelete this._extensionTerminalAwaitingStart[id];\n\t\t}\n\n\t\treturn disposables;\n\t}\n\n\tpublic $acceptProcessAckDataEvent(id: number, charCount: number): void {\n\t\tthis._terminalProcesses.get(id)?.acknowledgeDataEvent(charCount);\n\t}\n\n\tpublic $acceptProcessInput(id: number, data: string): void {\n\t\tthis._terminalProcesses.get(id)?.input(data);\n\t}\n\n\tpublic $acceptTerminalInteraction(id: number): void {\n\t\tconst terminal = this._getTerminalById(id);\n\t\tif (terminal?.setInteractedWith()) {\n\t\t\tthis._onDidChangeTerminalState.fire(terminal.value);\n\t\t}\n\t}\n\n\tpublic $acceptProcessResize(id: number, cols: number, rows: number): void {\n\t\ttry {\n\t\t\tthis._terminalProcesses.get(id)?.resize(cols, rows);\n\t\t} catch (error) {\n\t\t\t// We tried to write to a closed pipe / channel.\n\t\t\tif (error.code !== 'EPIPE' && error.code !== 'ERR_IPC_CHANNEL_CLOSED') {\n\t\t\t\tthrow (error);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic $acceptProcessShutdown(id: number, immediate: boolean): void {\n\t\tthis._terminalProcesses.get(id)?.shutdown(immediate);\n\t}\n\n\tpublic $acceptProcessRequestInitialCwd(id: number): void {\n\t\tthis._terminalProcesses.get(id)?.getInitialCwd().then(initialCwd => this._proxy.$sendProcessProperty(id, { type: ProcessPropertyType.InitialCwd, value: initialCwd }));\n\t}\n\n\tpublic $acceptProcessRequestCwd(id: number): void {\n\t\tthis._terminalProcesses.get(id)?.getCwd().then(cwd => this._proxy.$sendProcessProperty(id, { type: ProcessPropertyType.Cwd, value: cwd }));\n\t}\n\n\tpublic $acceptProcessRequestLatency(id: number): Promise<number> {\n\t\treturn Promise.resolve(id);\n\t}\n\n\tpublic registerLinkProvider(provider: vscode.TerminalLinkProvider): vscode.Disposable {\n\t\tthis._linkProviders.add(provider);\n\t\tif (this._linkProviders.size === 1) {\n\t\t\tthis._proxy.$startLinkProvider();\n\t\t}\n\t\treturn new VSCodeDisposable(() => {\n\t\t\tthis._linkProviders.delete(provider);\n\t\t\tif (this._linkProviders.size === 0) {\n\t\t\t\tthis._proxy.$stopLinkProvider();\n\t\t\t}\n\t\t});\n\t}\n\n\tpublic registerProfileProvider(extension: IExtensionDescription, id: string, provider: vscode.TerminalProfileProvider): vscode.Disposable {\n\t\tif (this._profileProviders.has(id)) {\n\t\t\tthrow new Error(`Terminal profile provider \"${id}\" already registered`);\n\t\t}\n\t\tthis._profileProviders.set(id, provider);\n\t\tthis._proxy.$registerProfileProvider(id, extension.identifier.value);\n\t\treturn new VSCodeDisposable(() => {\n\t\t\tthis._profileProviders.delete(id);\n\t\t\tthis._proxy.$unregisterProfileProvider(id);\n\t\t});\n\t}\n\n\tpublic async $createContributedProfileTerminal(id: string, options: ICreateContributedTerminalProfileOptions): Promise<void> {\n\t\tconst token = new CancellationTokenSource().token;\n\t\tlet profile = await this._profileProviders.get(id)?.provideTerminalProfile(token);\n\t\tif (token.isCancellationRequested) {\n\t\t\treturn;\n\t\t}\n\t\tif (profile && !('options' in profile)) {\n\t\t\tprofile = { options: profile };\n\t\t}\n\n\t\tif (!profile || !('options' in profile)) {\n\t\t\tthrow new Error(`No terminal profile options provided for id \"${id}\"`);\n\t\t}\n\n\t\tif ('pty' in profile.options) {\n\t\t\tthis.createExtensionTerminal(profile.options, options);\n\t\t\treturn;\n\t\t}\n\t\tthis.createTerminalFromOptions(profile.options, options);\n\t}\n\n\tpublic async $provideLinks(terminalId: number, line: string): Promise<ITerminalLinkDto[]> {\n\t\tconst terminal = this._getTerminalById(terminalId);\n\t\tif (!terminal) {\n\t\t\treturn [];\n\t\t}\n\n\t\t// Discard any cached links the terminal has been holding, currently all links are released\n\t\t// when new links are provided.\n\t\tthis._terminalLinkCache.delete(terminalId);\n\n\t\tconst oldToken = this._terminalLinkCancellationSource.get(terminalId);\n\t\toldToken?.dispose(true);\n\t\tconst cancellationSource = new CancellationTokenSource();\n\t\tthis._terminalLinkCancellationSource.set(terminalId, cancellationSource);\n\n\t\tconst result: ITerminalLinkDto[] = [];\n\t\tconst context: vscode.TerminalLinkContext = { terminal: terminal.value, line };\n\t\tconst promises: vscode.ProviderResult<{ provider: vscode.TerminalLinkProvider; links: vscode.TerminalLink[] }>[] = [];\n\n\t\tfor (const provider of this._linkProviders) {\n\t\t\tpromises.push(Promises.withAsyncBody(async r => {\n\t\t\t\tcancellationSource.token.onCancellationRequested(() => r({ provider, links: [] }));\n\t\t\t\tconst links = (await provider.provideTerminalLinks(context, cancellationSource.token)) || [];\n\t\t\t\tif (!cancellationSource.token.isCancellationRequested) {\n\t\t\t\t\tr({ provider, links });\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\n\t\tconst provideResults = await Promise.all(promises);\n\n\t\tif (cancellationSource.token.isCancellationRequested) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst cacheLinkMap = new Map<number, ICachedLinkEntry>();\n\t\tfor (const provideResult of provideResults) {\n\t\t\tif (provideResult && provideResult.links.length > 0) {\n\t\t\t\tresult.push(...provideResult.links.map(providerLink => {\n\t\t\t\t\tconst link = {\n\t\t\t\t\t\tid: nextLinkId++,\n\t\t\t\t\t\tstartIndex: providerLink.startIndex,\n\t\t\t\t\t\tlength: providerLink.length,\n\t\t\t\t\t\tlabel: providerLink.tooltip\n\t\t\t\t\t};\n\t\t\t\t\tcacheLinkMap.set(link.id, {\n\t\t\t\t\t\tprovider: provideResult.provider,\n\t\t\t\t\t\tlink: providerLink\n\t\t\t\t\t});\n\t\t\t\t\treturn link;\n\t\t\t\t}));\n\t\t\t}\n\t\t}\n\n\t\tthis._terminalLinkCache.set(terminalId, cacheLinkMap);\n\n\t\treturn result;\n\t}\n\n\t$activateLink(terminalId: number, linkId: number): void {\n\t\tconst cachedLink = this._terminalLinkCache.get(terminalId)?.get(linkId);\n\t\tif (!cachedLink) {\n\t\t\treturn;\n\t\t}\n\t\tcachedLink.provider.handleTerminalLink(cachedLink.link);\n\t}\n\n\tprivate _onProcessExit(id: number, exitCode: number | undefined): void {\n\t\tthis._bufferer.stopBuffering(id);\n\n\t\t// Remove process reference\n\t\tthis._terminalProcesses.delete(id);\n\t\tdelete this._extensionTerminalAwaitingStart[id];\n\n\t\t// Clean up process disposables\n\t\tconst processDiposable = this._terminalProcessDisposables[id];\n\t\tif (processDiposable) {\n\t\t\tprocessDiposable.dispose();\n\t\t\tdelete this._terminalProcessDisposables[id];\n\t\t}\n\t\t// Send exit event to main side\n\t\tthis._proxy.$sendProcessExit(id, exitCode);\n\t}\n\n\tprivate _getTerminalById(id: number): ExtHostTerminal | null {\n\t\treturn this._getTerminalObjectById(this._terminals, id);\n\t}\n\n\tprivate _getTerminalObjectById<T extends ExtHostTerminal>(array: T[], id: number): T | null {\n\t\tconst index = this._getTerminalObjectIndexById(array, id);\n\t\treturn index !== null ? array[index] : null;\n\t}\n\n\tprivate _getTerminalObjectIndexById<T extends ExtHostTerminal>(array: T[], id: ExtHostTerminalIdentifier): number | null {\n\t\tlet index: number | null = null;\n\t\tarray.some((item, i) => {\n\t\t\tconst thisId = item._id;\n\t\t\tif (thisId === id) {\n\t\t\t\tindex = i;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\t\treturn index;\n\t}\n\n\tpublic getEnvironmentVariableCollection(extension: IExtensionDescription): vscode.EnvironmentVariableCollection {\n\t\tlet collection = this._environmentVariableCollections.get(extension.identifier.value);\n\t\tif (!collection) {\n\t\t\tcollection = new EnvironmentVariableCollection();\n\t\t\tthis._setEnvironmentVariableCollection(extension.identifier.value, collection);\n\t\t}\n\t\treturn collection;\n\t}\n\n\tprivate _syncEnvironmentVariableCollection(extensionIdentifier: string, collection: EnvironmentVariableCollection): void {\n\t\tconst serialized = serializeEnvironmentVariableCollection(collection.map);\n\t\tthis._proxy.$setEnvironmentVariableCollection(extensionIdentifier, collection.persistent, serialized.length === 0 ? undefined : serialized);\n\t}\n\n\tpublic $initEnvironmentVariableCollections(collections: [string, ISerializableEnvironmentVariableCollection][]): void {\n\t\tcollections.forEach(entry => {\n\t\t\tconst extensionIdentifier = entry[0];\n\t\t\tconst collection = new EnvironmentVariableCollection(entry[1]);\n\t\t\tthis._setEnvironmentVariableCollection(extensionIdentifier, collection);\n\t\t});\n\t}\n\n\tpublic $acceptDefaultProfile(profile: ITerminalProfile, automationProfile: ITerminalProfile): void {\n\t\tthis._defaultProfile = profile;\n\t\tthis._defaultAutomationProfile = automationProfile;\n\t}\n\n\tprivate _setEnvironmentVariableCollection(extensionIdentifier: string, collection: EnvironmentVariableCollection): void {\n\t\tthis._environmentVariableCollections.set(extensionIdentifier, collection);\n\t\tcollection.onDidChangeCollection(() => {\n\t\t\t// When any collection value changes send this immediately, this is done to ensure\n\t\t\t// following calls to createTerminal will be created with the new environment. It will\n\t\t\t// result in more noise by sending multiple updates when called but collections are\n\t\t\t// expected to be small.\n\t\t\tthis._syncEnvironmentVariableCollection(extensionIdentifier, collection!);\n\t\t});\n\t}\n}\n\nexport class EnvironmentVariableCollection implements vscode.EnvironmentVariableCollection {\n\treadonly map: Map<string, vscode.EnvironmentVariableMutator> = new Map();\n\tprivate _persistent: boolean = true;\n\n\tpublic get persistent(): boolean { return this._persistent; }\n\tpublic set persistent(value: boolean) {\n\t\tthis._persistent = value;\n\t\tthis._onDidChangeCollection.fire();\n\t}\n\n\tprotected readonly _onDidChangeCollection: Emitter<void> = new Emitter<void>();\n\tget onDidChangeCollection(): Event<void> { return this._onDidChangeCollection && this._onDidChangeCollection.event; }\n\n\tconstructor(\n\t\tserialized?: ISerializableEnvironmentVariableCollection\n\t) {\n\t\tthis.map = new Map(serialized);\n\t}\n\n\tget size(): number {\n\t\treturn this.map.size;\n\t}\n\n\treplace(variable: string, value: string): void {\n\t\tthis._setIfDiffers(variable, { value, type: EnvironmentVariableMutatorType.Replace });\n\t}\n\n\tappend(variable: string, value: string): void {\n\t\tthis._setIfDiffers(variable, { value, type: EnvironmentVariableMutatorType.Append });\n\t}\n\n\tprepend(variable: string, value: string): void {\n\t\tthis._setIfDiffers(variable, { value, type: EnvironmentVariableMutatorType.Prepend });\n\t}\n\n\tprivate _setIfDiffers(variable: string, mutator: vscode.EnvironmentVariableMutator): void {\n\t\tconst current = this.map.get(variable);\n\t\tif (!current || current.value !== mutator.value || current.type !== mutator.type) {\n\t\t\tthis.map.set(variable, mutator);\n\t\t\tthis._onDidChangeCollection.fire();\n\t\t}\n\t}\n\n\tget(variable: string): vscode.EnvironmentVariableMutator | undefined {\n\t\treturn this.map.get(variable);\n\t}\n\n\tforEach(callback: (variable: string, mutator: vscode.EnvironmentVariableMutator, collection: vscode.EnvironmentVariableCollection) => any, thisArg?: any): void {\n\t\tthis.map.forEach((value, key) => callback.call(thisArg, key, value, this));\n\t}\n\n\t[Symbol.iterator](): IterableIterator<[variable: string, mutator: vscode.EnvironmentVariableMutator]> {\n\t\treturn this.map.entries();\n\t}\n\n\tdelete(variable: string): void {\n\t\tthis.map.delete(variable);\n\t\tthis._onDidChangeCollection.fire();\n\t}\n\n\tclear(): void {\n\t\tthis.map.clear();\n\t\tthis._onDidChangeCollection.fire();\n\t}\n}\n\nexport class WorkerExtHostTerminalService extends BaseExtHostTerminalService {\n\tconstructor(\n\t\t@IExtHostRpcService extHostRpc: IExtHostRpcService\n\t) {\n\t\tsuper(false, extHostRpc);\n\t}\n\n\tpublic createTerminal(name?: string, shellPath?: string, shellArgs?: string[] | string): vscode.Terminal {\n\t\tthrow new NotSupportedError();\n\t}\n\n\tpublic createTerminalFromOptions(options: vscode.TerminalOptions, internalOptions?: ITerminalInternalOptions): vscode.Terminal {\n\t\tthrow new NotSupportedError();\n\t}\n}\n\nfunction asTerminalIcon(iconPath?: vscode.Uri | { light: vscode.Uri; dark: vscode.Uri } | vscode.ThemeIcon): TerminalIcon | undefined {\n\tif (!iconPath || typeof iconPath === 'string') {\n\t\treturn undefined;\n\t}\n\n\tif (!('id' in iconPath)) {\n\t\treturn iconPath;\n\t}\n\n\treturn {\n\t\tid: iconPath.id,\n\t\tcolor: iconPath.color as ThemeColor\n\t};\n}\n\nfunction asTerminalColor(color?: vscode.ThemeColor): ThemeColor | undefined {\n\treturn ThemeColor.isThemeColor(color) ? color as ThemeColor : undefined;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { mapFind } from 'vs/base/common/arrays';\nimport { VSBuffer } from 'vs/base/common/buffer';\nimport { CancellationToken, CancellationTokenSource } from 'vs/base/common/cancellation';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { once } from 'vs/base/common/functional';\nimport { hash } from 'vs/base/common/hash';\nimport { Disposable, DisposableStore, toDisposable } from 'vs/base/common/lifecycle';\nimport { MarshalledId } from 'vs/base/common/marshallingIds';\nimport { deepFreeze } from 'vs/base/common/objects';\nimport { isDefined } from 'vs/base/common/types';\nimport { generateUuid } from 'vs/base/common/uuid';\nimport { ExtHostTestingShape, ILocationDto, MainContext, MainThreadTestingShape } from 'vs/workbench/api/common/extHost.protocol';\nimport { ExtHostCommands } from 'vs/workbench/api/common/extHostCommands';\nimport { IExtHostRpcService } from 'vs/workbench/api/common/extHostRpcService';\nimport { ExtHostTestItemCollection, TestItemImpl, TestItemRootImpl, toItemFromContext } from 'vs/workbench/api/common/extHostTestItem';\nimport * as Convert from 'vs/workbench/api/common/extHostTypeConverters';\nimport { TestRunProfileKind, TestRunRequest } from 'vs/workbench/api/common/extHostTypes';\nimport { TestId, TestIdPathParts, TestPosition } from 'vs/workbench/contrib/testing/common/testId';\nimport { InvalidTestItemError } from 'vs/workbench/contrib/testing/common/testItemCollection';\nimport { AbstractIncrementalTestCollection, CoverageDetails, IFileCoverage, IncrementalChangeCollector, IncrementalTestCollectionItem, InternalTestItem, ISerializedTestResults, ITestItem, RunTestForControllerRequest, TestResultState, TestRunProfileBitset, TestsDiff, TestsDiffOp } from 'vs/workbench/contrib/testing/common/testTypes';\nimport type * as vscode from 'vscode';\n\ninterface ControllerInfo {\n\tcontroller: vscode.TestController;\n\tprofiles: Map<number, vscode.TestRunProfile>;\n\tcollection: ExtHostTestItemCollection;\n}\n\nexport class ExtHostTesting implements ExtHostTestingShape {\n\tprivate readonly resultsChangedEmitter = new Emitter<void>();\n\tprivate readonly controllers = new Map</* controller ID */ string, ControllerInfo>();\n\tprivate readonly proxy: MainThreadTestingShape;\n\tprivate readonly runTracker: TestRunCoordinator;\n\tprivate readonly observer: TestObservers;\n\n\tpublic onResultsChanged = this.resultsChangedEmitter.event;\n\tpublic results: ReadonlyArray<vscode.TestRunResult> = [];\n\n\tconstructor(@IExtHostRpcService rpc: IExtHostRpcService, commands: ExtHostCommands) {\n\t\tthis.proxy = rpc.getProxy(MainContext.MainThreadTesting);\n\t\tthis.observer = new TestObservers(this.proxy);\n\t\tthis.runTracker = new TestRunCoordinator(this.proxy);\n\n\t\tcommands.registerArgumentProcessor({\n\t\t\tprocessArgument: arg =>\n\t\t\t\targ?.$mid === MarshalledId.TestItemContext ? toItemFromContext(arg) : arg,\n\t\t});\n\t}\n\n\t/**\n\t * Implements vscode.test.registerTestProvider\n\t */\n\tpublic createTestController(controllerId: string, label: string, refreshHandler?: (token: CancellationToken) => Thenable<void> | void): vscode.TestController {\n\t\tif (this.controllers.has(controllerId)) {\n\t\t\tthrow new Error(`Attempt to insert a duplicate controller with ID \"${controllerId}\"`);\n\t\t}\n\n\t\tconst disposable = new DisposableStore();\n\t\tconst collection = disposable.add(new ExtHostTestItemCollection(controllerId, label));\n\t\tcollection.root.label = label;\n\n\t\tconst profiles = new Map<number, vscode.TestRunProfile>();\n\t\tconst proxy = this.proxy;\n\n\t\tconst controller: vscode.TestController = {\n\t\t\titems: collection.root.children,\n\t\t\tget label() {\n\t\t\t\treturn label;\n\t\t\t},\n\t\t\tset label(value: string) {\n\t\t\t\tlabel = value;\n\t\t\t\tcollection.root.label = value;\n\t\t\t\tproxy.$updateController(controllerId, { label });\n\t\t\t},\n\t\t\tget refreshHandler() {\n\t\t\t\treturn refreshHandler;\n\t\t\t},\n\t\t\tset refreshHandler(value: ((token: CancellationToken) => Thenable<void> | void) | undefined) {\n\t\t\t\trefreshHandler = value;\n\t\t\t\tproxy.$updateController(controllerId, { canRefresh: !!value });\n\t\t\t},\n\t\t\tget id() {\n\t\t\t\treturn controllerId;\n\t\t\t},\n\t\t\tcreateRunProfile: (label, group, runHandler, isDefault, tag?: vscode.TestTag | undefined) => {\n\t\t\t\t// Derive the profile ID from a hash so that the same profile will tend\n\t\t\t\t// to have the same hashes, allowing re-run requests to work across reloads.\n\t\t\t\tlet profileId = hash(label);\n\t\t\t\twhile (profiles.has(profileId)) {\n\t\t\t\t\tprofileId++;\n\t\t\t\t}\n\n\t\t\t\treturn new TestRunProfileImpl(this.proxy, profiles, controllerId, profileId, label, group, runHandler, isDefault, tag);\n\t\t\t},\n\t\t\tcreateTestItem(id, label, uri) {\n\t\t\t\treturn new TestItemImpl(controllerId, id, label, uri);\n\t\t\t},\n\t\t\tcreateTestRun: (request, name, persist = true) => {\n\t\t\t\treturn this.runTracker.createTestRun(controllerId, collection, request, name, persist);\n\t\t\t},\n\t\t\tset resolveHandler(fn) {\n\t\t\t\tcollection.resolveHandler = fn;\n\t\t\t},\n\t\t\tget resolveHandler() {\n\t\t\t\treturn collection.resolveHandler as undefined | ((item?: vscode.TestItem) => void);\n\t\t\t},\n\t\t\tdispose: () => {\n\t\t\t\tdisposable.dispose();\n\t\t\t},\n\t\t};\n\n\t\tproxy.$registerTestController(controllerId, label, !!refreshHandler);\n\t\tdisposable.add(toDisposable(() => proxy.$unregisterTestController(controllerId)));\n\n\t\tconst info: ControllerInfo = { controller, collection, profiles: profiles };\n\t\tthis.controllers.set(controllerId, info);\n\t\tdisposable.add(toDisposable(() => this.controllers.delete(controllerId)));\n\n\t\tdisposable.add(collection.onDidGenerateDiff(diff => proxy.$publishDiff(controllerId, diff.map(TestsDiffOp.serialize))));\n\n\t\treturn controller;\n\t}\n\n\t/**\n\t * Implements vscode.test.createTestObserver\n\t */\n\tpublic createTestObserver() {\n\t\treturn this.observer.checkout();\n\t}\n\n\n\t/**\n\t * Implements vscode.test.runTests\n\t */\n\tpublic async runTests(req: vscode.TestRunRequest, token = CancellationToken.None) {\n\t\tconst profile = tryGetProfileFromTestRunReq(req);\n\t\tif (!profile) {\n\t\t\tthrow new Error('The request passed to `vscode.test.runTests` must include a profile');\n\t\t}\n\n\t\tconst controller = this.controllers.get(profile.controllerId);\n\t\tif (!controller) {\n\t\t\tthrow new Error('Controller not found');\n\t\t}\n\n\t\tawait this.proxy.$runTests({\n\t\t\tisUiTriggered: false,\n\t\t\ttargets: [{\n\t\t\t\ttestIds: req.include?.map(t => TestId.fromExtHostTestItem(t, controller.collection.root.id).toString()) ?? [controller.collection.root.id],\n\t\t\t\tprofileGroup: profileGroupToBitset[profile.kind],\n\t\t\t\tprofileId: profile.profileId,\n\t\t\t\tcontrollerId: profile.controllerId,\n\t\t\t}],\n\t\t\texclude: req.exclude?.map(t => t.id),\n\t\t}, token);\n\t}\n\n\t/**\n\t * @inheritdoc\n\t */\n\t$provideFileCoverage(runId: string, taskId: string, token: CancellationToken): Promise<IFileCoverage[]> {\n\t\tconst coverage = mapFind(this.runTracker.trackers, t => t.id === runId ? t.getCoverage(taskId) : undefined);\n\t\treturn coverage?.provideFileCoverage(token) ?? Promise.resolve([]);\n\t}\n\n\t/**\n\t * @inheritdoc\n\t */\n\t$resolveFileCoverage(runId: string, taskId: string, fileIndex: number, token: CancellationToken): Promise<CoverageDetails[]> {\n\t\tconst coverage = mapFind(this.runTracker.trackers, t => t.id === runId ? t.getCoverage(taskId) : undefined);\n\t\treturn coverage?.resolveFileCoverage(fileIndex, token) ?? Promise.resolve([]);\n\t}\n\n\t/** @inheritdoc */\n\t$configureRunProfile(controllerId: string, profileId: number) {\n\t\tthis.controllers.get(controllerId)?.profiles.get(profileId)?.configureHandler?.();\n\t}\n\n\t/** @inheritdoc */\n\tasync $refreshTests(controllerId: string, token: CancellationToken) {\n\t\tawait this.controllers.get(controllerId)?.controller.refreshHandler?.(token);\n\t}\n\n\t/**\n\t * Updates test results shown to extensions.\n\t * @override\n\t */\n\tpublic $publishTestResults(results: ISerializedTestResults[]): void {\n\t\tthis.results = Object.freeze(\n\t\t\tresults\n\t\t\t\t.map(r => deepFreeze(Convert.TestResults.to(r)))\n\t\t\t\t.concat(this.results)\n\t\t\t\t.sort((a, b) => b.completedAt - a.completedAt)\n\t\t\t\t.slice(0, 32),\n\t\t);\n\n\t\tthis.resultsChangedEmitter.fire();\n\t}\n\n\t/**\n\t * Expands the nodes in the test tree. If levels is less than zero, it will\n\t * be treated as infinite.\n\t */\n\tpublic async $expandTest(testId: string, levels: number) {\n\t\tconst collection = this.controllers.get(TestId.fromString(testId).controllerId)?.collection;\n\t\tif (collection) {\n\t\t\tawait collection.expand(testId, levels < 0 ? Infinity : levels);\n\t\t\tcollection.flushDiff();\n\t\t}\n\t}\n\n\t/**\n\t * Receives a test update from the main thread. Called (eventually) whenever\n\t * tests change.\n\t */\n\tpublic $acceptDiff(diff: TestsDiffOp.Serialized[]): void {\n\t\tthis.observer.applyDiff(diff.map(TestsDiffOp.deserialize));\n\t}\n\n\t/**\n\t * Runs tests with the given set of IDs. Allows for test from multiple\n\t * providers to be run.\n\t * @override\n\t */\n\tpublic async $runControllerTests(req: RunTestForControllerRequest, token: CancellationToken): Promise<void> {\n\t\tconst lookup = this.controllers.get(req.controllerId);\n\t\tif (!lookup) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { collection, profiles } = lookup;\n\t\tconst profile = profiles.get(req.profileId);\n\t\tif (!profile) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst includeTests = req.testIds\n\t\t\t.map((testId) => collection.tree.get(testId))\n\t\t\t.filter(isDefined);\n\n\t\tconst excludeTests = req.excludeExtIds\n\t\t\t.map(id => lookup.collection.tree.get(id))\n\t\t\t.filter(isDefined)\n\t\t\t.filter(exclude => includeTests.some(\n\t\t\t\tinclude => include.fullId.compare(exclude.fullId) === TestPosition.IsChild,\n\t\t\t));\n\n\t\tif (!includeTests.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst publicReq = new TestRunRequest(\n\t\t\tincludeTests.some(i => i.actual instanceof TestItemRootImpl) ? undefined : includeTests.map(t => t.actual),\n\t\t\texcludeTests.map(t => t.actual),\n\t\t\tprofile,\n\t\t);\n\n\t\tconst tracker = this.runTracker.prepareForMainThreadTestRun(\n\t\t\tpublicReq,\n\t\t\tTestRunDto.fromInternal(req, lookup.collection),\n\t\t\ttoken,\n\t\t);\n\n\t\ttry {\n\t\t\tawait profile.runHandler(publicReq, token);\n\t\t} finally {\n\t\t\tif (tracker.isRunning && !token.isCancellationRequested) {\n\t\t\t\tawait Event.toPromise(tracker.onEnd);\n\t\t\t}\n\n\t\t\ttracker.dispose();\n\t\t}\n\t}\n\n\t/**\n\t * Cancels an ongoing test run.\n\t */\n\tpublic $cancelExtensionTestRun(runId: string | undefined) {\n\t\tif (runId === undefined) {\n\t\t\tthis.runTracker.cancelAllRuns();\n\t\t} else {\n\t\t\tthis.runTracker.cancelRunById(runId);\n\t\t}\n\t}\n}\n\nclass TestRunTracker extends Disposable {\n\tprivate readonly tasks = new Map</* task ID */string, { run: vscode.TestRun; coverage: TestRunCoverageBearer }>();\n\tprivate readonly sharedTestIds = new Set<string>();\n\tprivate readonly cts: CancellationTokenSource;\n\tprivate readonly endEmitter = this._register(new Emitter<void>());\n\tprivate disposed = false;\n\n\t/**\n\t * Fires when a test ends, and no more tests are left running.\n\t */\n\tpublic readonly onEnd = this.endEmitter.event;\n\n\t/**\n\t * Gets whether there are any tests running.\n\t */\n\tpublic get isRunning() {\n\t\treturn this.tasks.size > 0;\n\t}\n\n\t/**\n\t * Gets the run ID.\n\t */\n\tpublic get id() {\n\t\treturn this.dto.id;\n\t}\n\n\tconstructor(private readonly dto: TestRunDto, private readonly proxy: MainThreadTestingShape, parentToken?: CancellationToken) {\n\t\tsuper();\n\t\tthis.cts = this._register(new CancellationTokenSource(parentToken));\n\t\tthis._register(this.cts.token.onCancellationRequested(() => {\n\t\t\tfor (const { run } of this.tasks.values()) {\n\t\t\t\trun.end();\n\t\t\t}\n\t\t}));\n\t}\n\n\tpublic getCoverage(taskId: string) {\n\t\treturn this.tasks.get(taskId)?.coverage;\n\t}\n\n\tpublic createRun(name: string | undefined) {\n\t\tconst runId = this.dto.id;\n\t\tconst ctrlId = this.dto.controllerId;\n\t\tconst taskId = generateUuid();\n\t\tconst coverage = new TestRunCoverageBearer(this.proxy, runId, taskId);\n\n\t\tconst guardTestMutation = <Args extends unknown[]>(fn: (test: vscode.TestItem, ...args: Args) => void) =>\n\t\t\t(test: vscode.TestItem, ...args: Args) => {\n\t\t\t\tif (ended) {\n\t\t\t\t\tconsole.warn(`Setting the state of test \"${test.id}\" is a no-op after the run ends.`);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!this.dto.isIncluded(test)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.ensureTestIsKnown(test);\n\t\t\t\tfn(test, ...args);\n\t\t\t};\n\n\t\tconst appendMessages = (test: vscode.TestItem, messages: vscode.TestMessage | readonly vscode.TestMessage[]) => {\n\t\t\tconst converted = messages instanceof Array\n\t\t\t\t? messages.map(Convert.TestMessage.from)\n\t\t\t\t: [Convert.TestMessage.from(messages)];\n\n\t\t\tif (test.uri && test.range) {\n\t\t\t\tconst defaultLocation: ILocationDto = { range: Convert.Range.from(test.range), uri: test.uri };\n\t\t\t\tfor (const message of converted) {\n\t\t\t\t\tmessage.location = message.location || defaultLocation;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.proxy.$appendTestMessagesInRun(runId, taskId, TestId.fromExtHostTestItem(test, ctrlId).toString(), converted);\n\t\t};\n\n\t\tlet ended = false;\n\t\tconst run: vscode.TestRun = {\n\t\t\tisPersisted: this.dto.isPersisted,\n\t\t\ttoken: this.cts.token,\n\t\t\tname,\n\t\t\tget coverageProvider() {\n\t\t\t\treturn coverage.coverageProvider;\n\t\t\t},\n\t\t\tset coverageProvider(provider) {\n\t\t\t\tcoverage.coverageProvider = provider;\n\t\t\t},\n\t\t\t//#region state mutation\n\t\t\tenqueued: guardTestMutation(test => {\n\t\t\t\tthis.proxy.$updateTestStateInRun(runId, taskId, TestId.fromExtHostTestItem(test, ctrlId).toString(), TestResultState.Queued);\n\t\t\t}),\n\t\t\tskipped: guardTestMutation(test => {\n\t\t\t\tthis.proxy.$updateTestStateInRun(runId, taskId, TestId.fromExtHostTestItem(test, ctrlId).toString(), TestResultState.Skipped);\n\t\t\t}),\n\t\t\tstarted: guardTestMutation(test => {\n\t\t\t\tthis.proxy.$updateTestStateInRun(runId, taskId, TestId.fromExtHostTestItem(test, ctrlId).toString(), TestResultState.Running);\n\t\t\t}),\n\t\t\terrored: guardTestMutation((test, messages, duration) => {\n\t\t\t\tappendMessages(test, messages);\n\t\t\t\tthis.proxy.$updateTestStateInRun(runId, taskId, TestId.fromExtHostTestItem(test, ctrlId).toString(), TestResultState.Errored, duration);\n\t\t\t}),\n\t\t\tfailed: guardTestMutation((test, messages, duration) => {\n\t\t\t\tappendMessages(test, messages);\n\t\t\t\tthis.proxy.$updateTestStateInRun(runId, taskId, TestId.fromExtHostTestItem(test, ctrlId).toString(), TestResultState.Failed, duration);\n\t\t\t}),\n\t\t\tpassed: guardTestMutation((test, duration) => {\n\t\t\t\tthis.proxy.$updateTestStateInRun(runId, taskId, TestId.fromExtHostTestItem(test, this.dto.controllerId).toString(), TestResultState.Passed, duration);\n\t\t\t}),\n\t\t\t//#endregion\n\t\t\tappendOutput: (output, location?: vscode.Location, test?: vscode.TestItem) => {\n\t\t\t\tif (ended) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (test) {\n\t\t\t\t\tif (this.dto.isIncluded(test)) {\n\t\t\t\t\t\tthis.ensureTestIsKnown(test);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttest = undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.proxy.$appendOutputToRun(\n\t\t\t\t\trunId,\n\t\t\t\t\ttaskId,\n\t\t\t\t\tVSBuffer.fromString(output),\n\t\t\t\t\tlocation && Convert.location.from(location),\n\t\t\t\t\ttest && TestId.fromExtHostTestItem(test, ctrlId).toString(),\n\t\t\t\t);\n\t\t\t},\n\t\t\tend: () => {\n\t\t\t\tif (ended) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tended = true;\n\t\t\t\tthis.proxy.$finishedTestRunTask(runId, taskId);\n\t\t\t\tthis.tasks.delete(taskId);\n\t\t\t\tif (!this.isRunning) {\n\t\t\t\t\tthis.dispose();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tthis.tasks.set(taskId, { run, coverage });\n\t\tthis.proxy.$startedTestRunTask(runId, { id: taskId, name, running: true });\n\n\t\treturn run;\n\t}\n\n\tpublic override dispose() {\n\t\tif (!this.disposed) {\n\t\t\tthis.disposed = true;\n\t\t\tthis.endEmitter.fire();\n\t\t\tthis.cts.cancel();\n\t\t\tsuper.dispose();\n\t\t}\n\t}\n\n\n\tprivate ensureTestIsKnown(test: vscode.TestItem) {\n\t\tif (!(test instanceof TestItemImpl)) {\n\t\t\tthrow new InvalidTestItemError(test.id);\n\t\t}\n\n\t\tif (this.sharedTestIds.has(TestId.fromExtHostTestItem(test, this.dto.controllerId).toString())) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst chain: ITestItem.Serialized[] = [];\n\t\tconst root = this.dto.colllection.root;\n\t\twhile (true) {\n\t\t\tconst converted = Convert.TestItem.from(test as TestItemImpl);\n\t\t\tchain.unshift(converted);\n\n\t\t\tif (this.sharedTestIds.has(converted.extId)) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tthis.sharedTestIds.add(converted.extId);\n\t\t\tif (test === root) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\ttest = test.parent || root;\n\t\t}\n\n\t\tthis.proxy.$addTestsToRun(this.dto.controllerId, this.dto.id, chain);\n\t}\n}\n\n/**\n * Queues runs for a single extension and provides the currently-executing\n * run so that `createTestRun` can be properly correlated.\n */\nexport class TestRunCoordinator {\n\tprivate tracked = new Map<vscode.TestRunRequest, TestRunTracker>();\n\n\tpublic get trackers() {\n\t\treturn this.tracked.values();\n\t}\n\n\tconstructor(private readonly proxy: MainThreadTestingShape) { }\n\n\t/**\n\t * Registers a request as being invoked by the main thread, so\n\t * `$startedExtensionTestRun` is not invoked. The run must eventually\n\t * be cancelled manually.\n\t */\n\tpublic prepareForMainThreadTestRun(req: vscode.TestRunRequest, dto: TestRunDto, token: CancellationToken) {\n\t\treturn this.getTracker(req, dto, token);\n\t}\n\n\t/**\n\t * Cancels an existing test run via its cancellation token.\n\t */\n\tpublic cancelRunById(runId: string) {\n\t\tfor (const tracker of this.tracked.values()) {\n\t\t\tif (tracker.id === runId) {\n\t\t\t\ttracker.dispose();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Cancels an existing test run via its cancellation token.\n\t */\n\tpublic cancelAllRuns() {\n\t\tfor (const tracker of this.tracked.values()) {\n\t\t\ttracker.dispose();\n\t\t}\n\t}\n\n\n\t/**\n\t * Implements the public `createTestRun` API.\n\t */\n\tpublic createTestRun(controllerId: string, collection: ExtHostTestItemCollection, request: vscode.TestRunRequest, name: string | undefined, persist: boolean): vscode.TestRun {\n\t\tconst existing = this.tracked.get(request);\n\t\tif (existing) {\n\t\t\treturn existing.createRun(name);\n\t\t}\n\n\t\t// If there is not an existing tracked extension for the request, start\n\t\t// a new, detached session.\n\t\tconst dto = TestRunDto.fromPublic(controllerId, collection, request, persist);\n\t\tconst profile = tryGetProfileFromTestRunReq(request);\n\t\tthis.proxy.$startedExtensionTestRun({\n\t\t\tcontrollerId,\n\t\t\tprofile: profile && { group: profileGroupToBitset[profile.kind], id: profile.profileId },\n\t\t\texclude: request.exclude?.map(t => TestId.fromExtHostTestItem(t, collection.root.id).toString()) ?? [],\n\t\t\tid: dto.id,\n\t\t\tinclude: request.include?.map(t => TestId.fromExtHostTestItem(t, collection.root.id).toString()) ?? [collection.root.id],\n\t\t\tpersist\n\t\t});\n\n\t\tconst tracker = this.getTracker(request, dto);\n\t\ttracker.onEnd(() => this.proxy.$finishedExtensionTestRun(dto.id));\n\t\treturn tracker.createRun(name);\n\t}\n\n\tprivate getTracker(req: vscode.TestRunRequest, dto: TestRunDto, token?: CancellationToken) {\n\t\tconst tracker = new TestRunTracker(dto, this.proxy, token);\n\t\tthis.tracked.set(req, tracker);\n\t\ttracker.onEnd(() => this.tracked.delete(req));\n\t\treturn tracker;\n\t}\n}\n\nconst tryGetProfileFromTestRunReq = (request: vscode.TestRunRequest) => {\n\tif (!request.profile) {\n\t\treturn undefined;\n\t}\n\n\tif (!(request.profile instanceof TestRunProfileImpl)) {\n\t\tthrow new Error(`TestRunRequest.profile is not an instance created from TestController.createRunProfile`);\n\t}\n\n\treturn request.profile;\n};\n\nexport class TestRunDto {\n\tprivate readonly includePrefix: string[];\n\tprivate readonly excludePrefix: string[];\n\n\tpublic static fromPublic(controllerId: string, collection: ExtHostTestItemCollection, request: vscode.TestRunRequest, persist: boolean) {\n\t\treturn new TestRunDto(\n\t\t\tcontrollerId,\n\t\t\tgenerateUuid(),\n\t\t\trequest.include?.map(t => TestId.fromExtHostTestItem(t, controllerId).toString()) ?? [controllerId],\n\t\t\trequest.exclude?.map(t => TestId.fromExtHostTestItem(t, controllerId).toString()) ?? [],\n\t\t\tpersist,\n\t\t\tcollection,\n\t\t);\n\t}\n\n\tpublic static fromInternal(request: RunTestForControllerRequest, collection: ExtHostTestItemCollection) {\n\t\treturn new TestRunDto(\n\t\t\trequest.controllerId,\n\t\t\trequest.runId,\n\t\t\trequest.testIds,\n\t\t\trequest.excludeExtIds,\n\t\t\ttrue,\n\t\t\tcollection,\n\t\t);\n\t}\n\n\tconstructor(\n\t\tpublic readonly controllerId: string,\n\t\tpublic readonly id: string,\n\t\tinclude: string[],\n\t\texclude: string[],\n\t\tpublic readonly isPersisted: boolean,\n\t\tpublic readonly colllection: ExtHostTestItemCollection,\n\t) {\n\t\tthis.includePrefix = include.map(id => id + TestIdPathParts.Delimiter);\n\t\tthis.excludePrefix = exclude.map(id => id + TestIdPathParts.Delimiter);\n\t}\n\n\tpublic isIncluded(test: vscode.TestItem) {\n\t\tconst id = TestId.fromExtHostTestItem(test, this.controllerId).toString() + TestIdPathParts.Delimiter;\n\t\tfor (const prefix of this.excludePrefix) {\n\t\t\tif (id === prefix || id.startsWith(prefix)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tfor (const prefix of this.includePrefix) {\n\t\t\tif (id === prefix || id.startsWith(prefix)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n}\n\nclass TestRunCoverageBearer {\n\tprivate _coverageProvider?: vscode.TestCoverageProvider;\n\tprivate fileCoverage?: Promise<vscode.FileCoverage[] | null | undefined>;\n\n\tpublic set coverageProvider(provider: vscode.TestCoverageProvider | undefined) {\n\t\tif (this._coverageProvider) {\n\t\t\tthrow new Error('The TestCoverageProvider cannot be replaced after being provided');\n\t\t}\n\n\t\tif (!provider) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._coverageProvider = provider;\n\t\tthis.proxy.$signalCoverageAvailable(this.runId, this.taskId);\n\t}\n\n\tpublic get coverageProvider() {\n\t\treturn this._coverageProvider;\n\t}\n\n\tconstructor(\n\t\tprivate readonly proxy: MainThreadTestingShape,\n\t\tprivate readonly runId: string,\n\t\tprivate readonly taskId: string,\n\t) {\n\t}\n\n\tpublic async provideFileCoverage(token: CancellationToken): Promise<IFileCoverage[]> {\n\t\tif (!this._coverageProvider) {\n\t\t\treturn [];\n\t\t}\n\n\t\tif (!this.fileCoverage) {\n\t\t\tthis.fileCoverage = (async () => this._coverageProvider!.provideFileCoverage(token))();\n\t\t}\n\n\t\ttry {\n\t\t\tconst coverage = await this.fileCoverage;\n\t\t\treturn coverage?.map(Convert.TestCoverage.fromFile) ?? [];\n\t\t} catch (e) {\n\t\t\tthis.fileCoverage = undefined;\n\t\t\tthrow e;\n\t\t}\n\t}\n\n\tpublic async resolveFileCoverage(index: number, token: CancellationToken): Promise<CoverageDetails[]> {\n\t\tconst fileCoverage = await this.fileCoverage;\n\t\tlet file = fileCoverage?.[index];\n\t\tif (!this._coverageProvider || !fileCoverage || !file) {\n\t\t\treturn [];\n\t\t}\n\n\t\tif (!file.detailedCoverage) {\n\t\t\tfile = fileCoverage[index] = await this._coverageProvider.resolveFileCoverage?.(file, token) ?? file;\n\t\t}\n\n\t\treturn file.detailedCoverage?.map(Convert.TestCoverage.fromDetailed) ?? [];\n\t}\n}\n\n/**\n * @private\n */\ninterface MirroredCollectionTestItem extends IncrementalTestCollectionItem {\n\trevived: vscode.TestItem;\n\tdepth: number;\n}\n\nclass MirroredChangeCollector extends IncrementalChangeCollector<MirroredCollectionTestItem> {\n\tprivate readonly added = new Set<MirroredCollectionTestItem>();\n\tprivate readonly updated = new Set<MirroredCollectionTestItem>();\n\tprivate readonly removed = new Set<MirroredCollectionTestItem>();\n\n\tprivate readonly alreadyRemoved = new Set<string>();\n\n\tpublic get isEmpty() {\n\t\treturn this.added.size === 0 && this.removed.size === 0 && this.updated.size === 0;\n\t}\n\n\tconstructor(private readonly emitter: Emitter<vscode.TestsChangeEvent>) {\n\t\tsuper();\n\t}\n\n\t/**\n\t * @override\n\t */\n\tpublic override add(node: MirroredCollectionTestItem): void {\n\t\tthis.added.add(node);\n\t}\n\n\t/**\n\t * @override\n\t */\n\tpublic override update(node: MirroredCollectionTestItem): void {\n\t\tObject.assign(node.revived, Convert.TestItem.toPlain(node.item));\n\t\tif (!this.added.has(node)) {\n\t\t\tthis.updated.add(node);\n\t\t}\n\t}\n\n\t/**\n\t * @override\n\t */\n\tpublic override remove(node: MirroredCollectionTestItem): void {\n\t\tif (this.added.has(node)) {\n\t\t\tthis.added.delete(node);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.updated.delete(node);\n\n\t\tif (node.parent && this.alreadyRemoved.has(node.parent)) {\n\t\t\tthis.alreadyRemoved.add(node.item.extId);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.removed.add(node);\n\t}\n\n\t/**\n\t * @override\n\t */\n\tpublic getChangeEvent(): vscode.TestsChangeEvent {\n\t\tconst { added, updated, removed } = this;\n\t\treturn {\n\t\t\tget added() { return [...added].map(n => n.revived); },\n\t\t\tget updated() { return [...updated].map(n => n.revived); },\n\t\t\tget removed() { return [...removed].map(n => n.revived); },\n\t\t};\n\t}\n\n\tpublic override complete() {\n\t\tif (!this.isEmpty) {\n\t\t\tthis.emitter.fire(this.getChangeEvent());\n\t\t}\n\t}\n}\n\n/**\n * Maintains tests in this extension host sent from the main thread.\n * @private\n */\nexport class MirroredTestCollection extends AbstractIncrementalTestCollection<MirroredCollectionTestItem> {\n\tprivate changeEmitter = new Emitter<vscode.TestsChangeEvent>();\n\n\t/**\n\t * Change emitter that fires with the same semantics as `TestObserver.onDidChangeTests`.\n\t */\n\tpublic readonly onDidChangeTests = this.changeEmitter.event;\n\n\t/**\n\t * Gets a list of root test items.\n\t */\n\tpublic get rootTests() {\n\t\treturn super.roots;\n\t}\n\n\t/**\n\t *\n\t * If the test ID exists, returns its underlying ID.\n\t */\n\tpublic getMirroredTestDataById(itemId: string) {\n\t\treturn this.items.get(itemId);\n\t}\n\n\t/**\n\t * If the test item is a mirrored test item, returns its underlying ID.\n\t */\n\tpublic getMirroredTestDataByReference(item: vscode.TestItem) {\n\t\treturn this.items.get(item.id);\n\t}\n\n\t/**\n\t * @override\n\t */\n\tprotected createItem(item: InternalTestItem, parent?: MirroredCollectionTestItem): MirroredCollectionTestItem {\n\t\treturn {\n\t\t\t...item,\n\t\t\t// todo@connor4312: make this work well again with children\n\t\t\trevived: Convert.TestItem.toPlain(item.item) as vscode.TestItem,\n\t\t\tdepth: parent ? parent.depth + 1 : 0,\n\t\t\tchildren: new Set(),\n\t\t};\n\t}\n\n\t/**\n\t * @override\n\t */\n\tprotected override createChangeCollector() {\n\t\treturn new MirroredChangeCollector(this.changeEmitter);\n\t}\n}\n\nclass TestObservers {\n\tprivate current?: {\n\t\tobservers: number;\n\t\ttests: MirroredTestCollection;\n\t};\n\n\tconstructor(private readonly proxy: MainThreadTestingShape) {\n\t}\n\n\tpublic checkout(): vscode.TestObserver {\n\t\tif (!this.current) {\n\t\t\tthis.current = this.createObserverData();\n\t\t}\n\n\t\tconst current = this.current;\n\t\tcurrent.observers++;\n\n\t\treturn {\n\t\t\tonDidChangeTest: current.tests.onDidChangeTests,\n\t\t\tget tests() { return [...current.tests.rootTests].map(t => t.revived); },\n\t\t\tdispose: once(() => {\n\t\t\t\tif (--current.observers === 0) {\n\t\t\t\t\tthis.proxy.$unsubscribeFromDiffs();\n\t\t\t\t\tthis.current = undefined;\n\t\t\t\t}\n\t\t\t}),\n\t\t};\n\t}\n\n\t/**\n\t * Gets the internal test data by its reference.\n\t */\n\tpublic getMirroredTestDataByReference(ref: vscode.TestItem) {\n\t\treturn this.current?.tests.getMirroredTestDataByReference(ref);\n\t}\n\n\t/**\n\t * Applies test diffs to the current set of observed tests.\n\t */\n\tpublic applyDiff(diff: TestsDiff) {\n\t\tthis.current?.tests.apply(diff);\n\t}\n\n\tprivate createObserverData() {\n\t\tconst tests = new MirroredTestCollection();\n\t\tthis.proxy.$subscribeToDiffs();\n\t\treturn { observers: 0, tests, };\n\t}\n}\n\nexport class TestRunProfileImpl implements vscode.TestRunProfile {\n\treadonly #proxy: MainThreadTestingShape;\n\t#profiles?: Map<number, vscode.TestRunProfile>;\n\tprivate _configureHandler?: (() => void);\n\n\tpublic get label() {\n\t\treturn this._label;\n\t}\n\n\tpublic set label(label: string) {\n\t\tif (label !== this._label) {\n\t\t\tthis._label = label;\n\t\t\tthis.#proxy.$updateTestRunConfig(this.controllerId, this.profileId, { label });\n\t\t}\n\t}\n\n\tpublic get isDefault() {\n\t\treturn this._isDefault;\n\t}\n\n\tpublic set isDefault(isDefault: boolean) {\n\t\tif (isDefault !== this._isDefault) {\n\t\t\tthis._isDefault = isDefault;\n\t\t\tthis.#proxy.$updateTestRunConfig(this.controllerId, this.profileId, { isDefault });\n\t\t}\n\t}\n\n\tpublic get tag() {\n\t\treturn this._tag;\n\t}\n\n\tpublic set tag(tag: vscode.TestTag | undefined) {\n\t\tif (tag?.id !== this._tag?.id) {\n\t\t\tthis._tag = tag;\n\t\t\tthis.#proxy.$updateTestRunConfig(this.controllerId, this.profileId, {\n\t\t\t\ttag: tag ? Convert.TestTag.namespace(this.controllerId, tag.id) : null,\n\t\t\t});\n\t\t}\n\t}\n\n\tpublic get configureHandler() {\n\t\treturn this._configureHandler;\n\t}\n\n\tpublic set configureHandler(handler: undefined | (() => void)) {\n\t\tif (handler !== this._configureHandler) {\n\t\t\tthis._configureHandler = handler;\n\t\t\tthis.#proxy.$updateTestRunConfig(this.controllerId, this.profileId, { hasConfigurationHandler: !!handler });\n\t\t}\n\t}\n\n\tconstructor(\n\t\tproxy: MainThreadTestingShape,\n\t\tprofiles: Map<number, vscode.TestRunProfile>,\n\t\tpublic readonly controllerId: string,\n\t\tpublic readonly profileId: number,\n\t\tprivate _label: string,\n\t\tpublic readonly kind: vscode.TestRunProfileKind,\n\t\tpublic runHandler: (request: vscode.TestRunRequest, token: vscode.CancellationToken) => Thenable<void> | void,\n\t\tprivate _isDefault = false,\n\t\tpublic _tag: vscode.TestTag | undefined = undefined,\n\t) {\n\t\tthis.#proxy = proxy;\n\t\tthis.#profiles = profiles;\n\t\tprofiles.set(profileId, this);\n\n\t\tconst groupBitset = profileGroupToBitset[kind];\n\t\tif (typeof groupBitset !== 'number') {\n\t\t\tthrow new Error(`Unknown TestRunProfile.group ${kind}`);\n\t\t}\n\n\t\tthis.#proxy.$publishTestRunProfile({\n\t\t\tprofileId: profileId,\n\t\t\tcontrollerId,\n\t\t\ttag: _tag ? Convert.TestTag.namespace(this.controllerId, _tag.id) : null,\n\t\t\tlabel: _label,\n\t\t\tgroup: groupBitset,\n\t\t\tisDefault: _isDefault,\n\t\t\thasConfigurationHandler: false,\n\t\t});\n\t}\n\n\tdispose(): void {\n\t\tif (this.#profiles?.delete(this.profileId)) {\n\t\t\tthis.#profiles = undefined;\n\t\t\tthis.#proxy.$removeTestProfile(this.controllerId, this.profileId);\n\t\t}\n\t}\n}\n\nconst profileGroupToBitset: { [K in TestRunProfileKind]: TestRunProfileBitset } = {\n\t[TestRunProfileKind.Coverage]: TestRunProfileBitset.Coverage,\n\t[TestRunProfileKind.Debug]: TestRunProfileBitset.Debug,\n\t[TestRunProfileKind.Run]: TestRunProfileBitset.Run,\n};\n\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as arrays from 'vs/base/common/arrays';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { ExtHostEditorsShape, IEditorPropertiesChangeData, IMainContext, ITextDocumentShowOptions, ITextEditorPositionData, MainContext, MainThreadTextEditorsShape } from 'vs/workbench/api/common/extHost.protocol';\nimport { ExtHostDocumentsAndEditors } from 'vs/workbench/api/common/extHostDocumentsAndEditors';\nimport { ExtHostTextEditor, TextEditorDecorationType } from 'vs/workbench/api/common/extHostTextEditor';\nimport * as TypeConverters from 'vs/workbench/api/common/extHostTypeConverters';\nimport { TextEditorSelectionChangeKind } from 'vs/workbench/api/common/extHostTypes';\nimport * as vscode from 'vscode';\n\nexport class ExtHostEditors implements ExtHostEditorsShape {\n\n\tprivate readonly _onDidChangeTextEditorSelection = new Emitter<vscode.TextEditorSelectionChangeEvent>();\n\tprivate readonly _onDidChangeTextEditorOptions = new Emitter<vscode.TextEditorOptionsChangeEvent>();\n\tprivate readonly _onDidChangeTextEditorVisibleRanges = new Emitter<vscode.TextEditorVisibleRangesChangeEvent>();\n\tprivate readonly _onDidChangeTextEditorViewColumn = new Emitter<vscode.TextEditorViewColumnChangeEvent>();\n\tprivate readonly _onDidChangeActiveTextEditor = new Emitter<vscode.TextEditor | undefined>();\n\tprivate readonly _onDidChangeVisibleTextEditors = new Emitter<vscode.TextEditor[]>();\n\n\treadonly onDidChangeTextEditorSelection: Event<vscode.TextEditorSelectionChangeEvent> = this._onDidChangeTextEditorSelection.event;\n\treadonly onDidChangeTextEditorOptions: Event<vscode.TextEditorOptionsChangeEvent> = this._onDidChangeTextEditorOptions.event;\n\treadonly onDidChangeTextEditorVisibleRanges: Event<vscode.TextEditorVisibleRangesChangeEvent> = this._onDidChangeTextEditorVisibleRanges.event;\n\treadonly onDidChangeTextEditorViewColumn: Event<vscode.TextEditorViewColumnChangeEvent> = this._onDidChangeTextEditorViewColumn.event;\n\treadonly onDidChangeActiveTextEditor: Event<vscode.TextEditor | undefined> = this._onDidChangeActiveTextEditor.event;\n\treadonly onDidChangeVisibleTextEditors: Event<vscode.TextEditor[]> = this._onDidChangeVisibleTextEditors.event;\n\n\tprivate readonly _proxy: MainThreadTextEditorsShape;\n\n\tconstructor(\n\t\tmainContext: IMainContext,\n\t\tprivate readonly _extHostDocumentsAndEditors: ExtHostDocumentsAndEditors,\n\t) {\n\t\tthis._proxy = mainContext.getProxy(MainContext.MainThreadTextEditors);\n\n\n\t\tthis._extHostDocumentsAndEditors.onDidChangeVisibleTextEditors(e => this._onDidChangeVisibleTextEditors.fire(e));\n\t\tthis._extHostDocumentsAndEditors.onDidChangeActiveTextEditor(e => this._onDidChangeActiveTextEditor.fire(e));\n\t}\n\n\tgetActiveTextEditor(): vscode.TextEditor | undefined {\n\t\treturn this._extHostDocumentsAndEditors.activeEditor();\n\t}\n\n\tgetVisibleTextEditors(): vscode.TextEditor[];\n\tgetVisibleTextEditors(internal: true): ExtHostTextEditor[];\n\tgetVisibleTextEditors(internal?: true): ExtHostTextEditor[] | vscode.TextEditor[] {\n\t\tconst editors = this._extHostDocumentsAndEditors.allEditors();\n\t\treturn internal\n\t\t\t? editors\n\t\t\t: editors.map(editor => editor.value);\n\t}\n\n\tshowTextDocument(document: vscode.TextDocument, column: vscode.ViewColumn, preserveFocus: boolean): Promise<vscode.TextEditor>;\n\tshowTextDocument(document: vscode.TextDocument, options: { column: vscode.ViewColumn; preserveFocus: boolean; pinned: boolean }): Promise<vscode.TextEditor>;\n\tshowTextDocument(document: vscode.TextDocument, columnOrOptions: vscode.ViewColumn | vscode.TextDocumentShowOptions | undefined, preserveFocus?: boolean): Promise<vscode.TextEditor>;\n\tasync showTextDocument(document: vscode.TextDocument, columnOrOptions: vscode.ViewColumn | vscode.TextDocumentShowOptions | undefined, preserveFocus?: boolean): Promise<vscode.TextEditor> {\n\t\tlet options: ITextDocumentShowOptions;\n\t\tif (typeof columnOrOptions === 'number') {\n\t\t\toptions = {\n\t\t\t\tposition: TypeConverters.ViewColumn.from(columnOrOptions),\n\t\t\t\tpreserveFocus\n\t\t\t};\n\t\t} else if (typeof columnOrOptions === 'object') {\n\t\t\toptions = {\n\t\t\t\tposition: TypeConverters.ViewColumn.from(columnOrOptions.viewColumn),\n\t\t\t\tpreserveFocus: columnOrOptions.preserveFocus,\n\t\t\t\tselection: typeof columnOrOptions.selection === 'object' ? TypeConverters.Range.from(columnOrOptions.selection) : undefined,\n\t\t\t\tpinned: typeof columnOrOptions.preview === 'boolean' ? !columnOrOptions.preview : undefined\n\t\t\t};\n\t\t} else {\n\t\t\toptions = {\n\t\t\t\tpreserveFocus: false\n\t\t\t};\n\t\t}\n\n\t\tconst editorId = await this._proxy.$tryShowTextDocument(document.uri, options);\n\t\tconst editor = editorId && this._extHostDocumentsAndEditors.getEditor(editorId);\n\t\tif (editor) {\n\t\t\treturn editor.value;\n\t\t}\n\t\t// we have no editor... having an id means that we had an editor\n\t\t// on the main side and that it isn't the current editor anymore...\n\t\tif (editorId) {\n\t\t\tthrow new Error(`Could NOT open editor for \"${document.uri.toString()}\" because another editor opened in the meantime.`);\n\t\t} else {\n\t\t\tthrow new Error(`Could NOT open editor for \"${document.uri.toString()}\".`);\n\t\t}\n\t}\n\n\tcreateTextEditorDecorationType(extension: IExtensionDescription, options: vscode.DecorationRenderOptions): vscode.TextEditorDecorationType {\n\t\treturn new TextEditorDecorationType(this._proxy, extension, options).value;\n\t}\n\n\t// --- called from main thread\n\n\t$acceptEditorPropertiesChanged(id: string, data: IEditorPropertiesChangeData): void {\n\t\tconst textEditor = this._extHostDocumentsAndEditors.getEditor(id);\n\t\tif (!textEditor) {\n\t\t\tthrow new Error('unknown text editor');\n\t\t}\n\n\t\t// (1) set all properties\n\t\tif (data.options) {\n\t\t\ttextEditor._acceptOptions(data.options);\n\t\t}\n\t\tif (data.selections) {\n\t\t\tconst selections = data.selections.selections.map(TypeConverters.Selection.to);\n\t\t\ttextEditor._acceptSelections(selections);\n\t\t}\n\t\tif (data.visibleRanges) {\n\t\t\tconst visibleRanges = arrays.coalesce(data.visibleRanges.map(TypeConverters.Range.to));\n\t\t\ttextEditor._acceptVisibleRanges(visibleRanges);\n\t\t}\n\n\t\t// (2) fire change events\n\t\tif (data.options) {\n\t\t\tthis._onDidChangeTextEditorOptions.fire({\n\t\t\t\ttextEditor: textEditor.value,\n\t\t\t\toptions: { ...data.options, lineNumbers: TypeConverters.TextEditorLineNumbersStyle.to(data.options.lineNumbers) }\n\t\t\t});\n\t\t}\n\t\tif (data.selections) {\n\t\t\tconst kind = TextEditorSelectionChangeKind.fromValue(data.selections.source);\n\t\t\tconst selections = data.selections.selections.map(TypeConverters.Selection.to);\n\t\t\tthis._onDidChangeTextEditorSelection.fire({\n\t\t\t\ttextEditor: textEditor.value,\n\t\t\t\tselections,\n\t\t\t\tkind\n\t\t\t});\n\t\t}\n\t\tif (data.visibleRanges) {\n\t\t\tconst visibleRanges = arrays.coalesce(data.visibleRanges.map(TypeConverters.Range.to));\n\t\t\tthis._onDidChangeTextEditorVisibleRanges.fire({\n\t\t\t\ttextEditor: textEditor.value,\n\t\t\t\tvisibleRanges\n\t\t\t});\n\t\t}\n\t}\n\n\t$acceptEditorPositionData(data: ITextEditorPositionData): void {\n\t\tfor (const id in data) {\n\t\t\tconst textEditor = this._extHostDocumentsAndEditors.getEditor(id);\n\t\t\tif (!textEditor) {\n\t\t\t\tthrow new Error('Unknown text editor');\n\t\t\t}\n\t\t\tconst viewColumn = TypeConverters.ViewColumn.to(data[id]);\n\t\t\tif (textEditor.value.viewColumn !== viewColumn) {\n\t\t\t\ttextEditor._acceptViewColumn(viewColumn);\n\t\t\t\tthis._onDidChangeTextEditorViewColumn.fire({ textEditor: textEditor.value, viewColumn });\n\t\t\t}\n\t\t}\n\t}\n\n\tgetDiffInformation(id: string): Promise<vscode.LineChange[]> {\n\t\treturn Promise.resolve(this._proxy.$getDiffInformation(id));\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as vscode from 'vscode';\nimport { UriComponents, URI } from 'vs/base/common/uri';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { ExtHostTimelineShape, MainThreadTimelineShape, IMainContext, MainContext } from 'vs/workbench/api/common/extHost.protocol';\nimport { Timeline, TimelineItem, TimelineOptions, TimelineProvider } from 'vs/workbench/contrib/timeline/common/timeline';\nimport { IDisposable, toDisposable, DisposableStore } from 'vs/base/common/lifecycle';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { CommandsConverter, ExtHostCommands } from 'vs/workbench/api/common/extHostCommands';\nimport { ThemeIcon, MarkdownString as MarkdownStringType } from 'vs/workbench/api/common/extHostTypes';\nimport { MarkdownString } from 'vs/workbench/api/common/extHostTypeConverters';\nimport { ExtensionIdentifier } from 'vs/platform/extensions/common/extensions';\nimport { MarshalledId } from 'vs/base/common/marshallingIds';\nimport { isString } from 'vs/base/common/types';\n\nexport interface IExtHostTimeline extends ExtHostTimelineShape {\n\treadonly _serviceBrand: undefined;\n\t$getTimeline(id: string, uri: UriComponents, options: vscode.TimelineOptions, token: vscode.CancellationToken): Promise<Timeline | undefined>;\n}\n\nexport const IExtHostTimeline = createDecorator<IExtHostTimeline>('IExtHostTimeline');\n\nexport class ExtHostTimeline implements IExtHostTimeline {\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate _proxy: MainThreadTimelineShape;\n\n\tprivate _providers = new Map<string, TimelineProvider>();\n\n\tprivate _itemsBySourceAndUriMap = new Map<string, Map<string | undefined, Map<string, vscode.TimelineItem>>>();\n\n\tconstructor(\n\t\tmainContext: IMainContext,\n\t\tcommands: ExtHostCommands,\n\t) {\n\t\tthis._proxy = mainContext.getProxy(MainContext.MainThreadTimeline);\n\n\t\tcommands.registerArgumentProcessor({\n\t\t\tprocessArgument: arg => {\n\t\t\t\tif (arg && arg.$mid === MarshalledId.TimelineActionContext) {\n\t\t\t\t\tconst uri = arg.uri === undefined ? undefined : URI.revive(arg.uri);\n\t\t\t\t\treturn this._itemsBySourceAndUriMap.get(arg.source)?.get(getUriKey(uri))?.get(arg.handle);\n\t\t\t\t}\n\n\t\t\t\treturn arg;\n\t\t\t}\n\t\t});\n\t}\n\n\tasync $getTimeline(id: string, uri: UriComponents, options: vscode.TimelineOptions, token: vscode.CancellationToken): Promise<Timeline | undefined> {\n\t\tconst provider = this._providers.get(id);\n\t\treturn provider?.provideTimeline(URI.revive(uri), options, token);\n\t}\n\n\tregisterTimelineProvider(scheme: string | string[], provider: vscode.TimelineProvider, _extensionId: ExtensionIdentifier, commandConverter: CommandsConverter): IDisposable {\n\t\tconst timelineDisposables = new DisposableStore();\n\n\t\tconst convertTimelineItem = this.convertTimelineItem(provider.id, commandConverter, timelineDisposables).bind(this);\n\n\t\tlet disposable: IDisposable | undefined;\n\t\tif (provider.onDidChange) {\n\t\t\tdisposable = provider.onDidChange(e => this._proxy.$emitTimelineChangeEvent({ uri: undefined, reset: true, ...e, id: provider.id }), this);\n\t\t}\n\n\t\tconst itemsBySourceAndUriMap = this._itemsBySourceAndUriMap;\n\t\treturn this.registerTimelineProviderCore({\n\t\t\t...provider,\n\t\t\tscheme: scheme,\n\t\t\tonDidChange: undefined,\n\t\t\tasync provideTimeline(uri: URI, options: TimelineOptions, token: CancellationToken) {\n\t\t\t\tif (options?.resetCache) {\n\t\t\t\t\ttimelineDisposables.clear();\n\n\t\t\t\t\t// For now, only allow the caching of a single Uri\n\t\t\t\t\t// itemsBySourceAndUriMap.get(provider.id)?.get(getUriKey(uri))?.clear();\n\t\t\t\t\titemsBySourceAndUriMap.get(provider.id)?.clear();\n\t\t\t\t}\n\n\t\t\t\tconst result = await provider.provideTimeline(uri, options, token);\n\t\t\t\tif (result === undefined || result === null) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\n\t\t\t\t// TODO: Should we bother converting all the data if we aren't caching? Meaning it is being requested by an extension?\n\n\t\t\t\tconst convertItem = convertTimelineItem(uri, options);\n\t\t\t\treturn {\n\t\t\t\t\t...result,\n\t\t\t\t\tsource: provider.id,\n\t\t\t\t\titems: result.items.map(convertItem)\n\t\t\t\t};\n\t\t\t},\n\t\t\tdispose() {\n\t\t\t\tfor (const sourceMap of itemsBySourceAndUriMap.values()) {\n\t\t\t\t\tsourceMap.get(provider.id)?.clear();\n\t\t\t\t}\n\n\t\t\t\tdisposable?.dispose();\n\t\t\t\ttimelineDisposables.dispose();\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate convertTimelineItem(source: string, commandConverter: CommandsConverter, disposables: DisposableStore) {\n\t\treturn (uri: URI, options?: TimelineOptions) => {\n\t\t\tlet items: Map<string, vscode.TimelineItem> | undefined;\n\t\t\tif (options?.cacheResults) {\n\t\t\t\tlet itemsByUri = this._itemsBySourceAndUriMap.get(source);\n\t\t\t\tif (itemsByUri === undefined) {\n\t\t\t\t\titemsByUri = new Map();\n\t\t\t\t\tthis._itemsBySourceAndUriMap.set(source, itemsByUri);\n\t\t\t\t}\n\n\t\t\t\tconst uriKey = getUriKey(uri);\n\t\t\t\titems = itemsByUri.get(uriKey);\n\t\t\t\tif (items === undefined) {\n\t\t\t\t\titems = new Map();\n\t\t\t\t\titemsByUri.set(uriKey, items);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn (item: vscode.TimelineItem): TimelineItem => {\n\t\t\t\tconst { iconPath, ...props } = item;\n\n\t\t\t\tconst handle = `${source}|${item.id ?? item.timestamp}`;\n\t\t\t\titems?.set(handle, item);\n\n\t\t\t\tlet icon;\n\t\t\t\tlet iconDark;\n\t\t\t\tlet themeIcon;\n\t\t\t\tif (item.iconPath) {\n\t\t\t\t\tif (iconPath instanceof ThemeIcon) {\n\t\t\t\t\t\tthemeIcon = { id: iconPath.id, color: iconPath.color };\n\t\t\t\t\t}\n\t\t\t\t\telse if (URI.isUri(iconPath)) {\n\t\t\t\t\t\ticon = iconPath;\n\t\t\t\t\t\ticonDark = iconPath;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t({ light: icon, dark: iconDark } = iconPath as { light: URI; dark: URI });\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlet tooltip;\n\t\t\t\tif (MarkdownStringType.isMarkdownString(props.tooltip)) {\n\t\t\t\t\ttooltip = MarkdownString.from(props.tooltip);\n\t\t\t\t}\n\t\t\t\telse if (isString(props.tooltip)) {\n\t\t\t\t\ttooltip = props.tooltip;\n\t\t\t\t}\n\t\t\t\t// TODO @jkearl, remove once migration complete.\n\t\t\t\telse if (MarkdownStringType.isMarkdownString((props as any).detail)) {\n\t\t\t\t\tconsole.warn('Using deprecated TimelineItem.detail, migrate to TimelineItem.tooltip');\n\t\t\t\t\ttooltip = MarkdownString.from((props as any).detail);\n\t\t\t\t}\n\t\t\t\telse if (isString((props as any).detail)) {\n\t\t\t\t\tconsole.warn('Using deprecated TimelineItem.detail, migrate to TimelineItem.tooltip');\n\t\t\t\t\ttooltip = (props as any).detail;\n\t\t\t\t}\n\n\t\t\t\treturn {\n\t\t\t\t\t...props,\n\t\t\t\t\tid: props.id ?? undefined,\n\t\t\t\t\thandle: handle,\n\t\t\t\t\tsource: source,\n\t\t\t\t\tcommand: item.command ? commandConverter.toInternal(item.command, disposables) : undefined,\n\t\t\t\t\ticon: icon,\n\t\t\t\t\ticonDark: iconDark,\n\t\t\t\t\tthemeIcon: themeIcon,\n\t\t\t\t\ttooltip,\n\t\t\t\t\taccessibilityInformation: item.accessibilityInformation\n\t\t\t\t};\n\t\t\t};\n\t\t};\n\t}\n\n\tprivate registerTimelineProviderCore(provider: TimelineProvider): IDisposable {\n\t\t// console.log(`ExtHostTimeline#registerTimelineProvider: id=${provider.id}`);\n\n\t\tconst existing = this._providers.get(provider.id);\n\t\tif (existing) {\n\t\t\tthrow new Error(`Timeline Provider ${provider.id} already exists.`);\n\t\t}\n\n\t\tthis._proxy.$registerTimelineProvider({\n\t\t\tid: provider.id,\n\t\t\tlabel: provider.label,\n\t\t\tscheme: provider.scheme\n\t\t});\n\t\tthis._providers.set(provider.id, provider);\n\n\t\treturn toDisposable(() => {\n\t\t\tfor (const sourceMap of this._itemsBySourceAndUriMap.values()) {\n\t\t\t\tsourceMap.get(provider.id)?.clear();\n\t\t\t}\n\n\t\t\tthis._providers.delete(provider.id);\n\t\t\tthis._proxy.$unregisterTimelineProvider(provider.id);\n\t\t\tprovider.dispose();\n\t\t});\n\t}\n}\n\nfunction getUriKey(uri: URI | undefined): string | undefined {\n\treturn uri?.toString();\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { toDisposable } from 'vs/base/common/lifecycle';\nimport { Schemas } from 'vs/base/common/network';\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport * as languages from 'vs/editor/common/languages';\nimport { ExtensionIdentifier } from 'vs/platform/extensions/common/extensions';\nimport type * as vscode from 'vscode';\nimport { ExtHostUriOpenersShape, IMainContext, MainContext, MainThreadUriOpenersShape } from './extHost.protocol';\n\n\nexport class ExtHostUriOpeners implements ExtHostUriOpenersShape {\n\n\tprivate static readonly supportedSchemes = new Set<string>([Schemas.http, Schemas.https]);\n\n\tprivate readonly _proxy: MainThreadUriOpenersShape;\n\n\tprivate readonly _openers = new Map<string, vscode.ExternalUriOpener>();\n\n\tconstructor(\n\t\tmainContext: IMainContext,\n\t) {\n\t\tthis._proxy = mainContext.getProxy(MainContext.MainThreadUriOpeners);\n\t}\n\n\tregisterExternalUriOpener(\n\t\textensionId: ExtensionIdentifier,\n\t\tid: string,\n\t\topener: vscode.ExternalUriOpener,\n\t\tmetadata: vscode.ExternalUriOpenerMetadata,\n\t): vscode.Disposable {\n\t\tif (this._openers.has(id)) {\n\t\t\tthrow new Error(`Opener with id '${id}' already registered`);\n\t\t}\n\n\t\tconst invalidScheme = metadata.schemes.find(scheme => !ExtHostUriOpeners.supportedSchemes.has(scheme));\n\t\tif (invalidScheme) {\n\t\t\tthrow new Error(`Scheme '${invalidScheme}' is not supported. Only http and https are currently supported.`);\n\t\t}\n\n\t\tthis._openers.set(id, opener);\n\t\tthis._proxy.$registerUriOpener(id, metadata.schemes, extensionId, metadata.label);\n\n\t\treturn toDisposable(() => {\n\t\t\tthis._openers.delete(id);\n\t\t\tthis._proxy.$unregisterUriOpener(id);\n\t\t});\n\t}\n\n\tasync $canOpenUri(id: string, uriComponents: UriComponents, token: CancellationToken): Promise<languages.ExternalUriOpenerPriority> {\n\t\tconst opener = this._openers.get(id);\n\t\tif (!opener) {\n\t\t\tthrow new Error(`Unknown opener with id: ${id}`);\n\t\t}\n\n\t\tconst uri = URI.revive(uriComponents);\n\t\treturn opener.canOpenExternalUri(uri, token);\n\t}\n\n\tasync $openUri(id: string, context: { resolvedUri: UriComponents; sourceUri: UriComponents }, token: CancellationToken): Promise<void> {\n\t\tconst opener = this._openers.get(id);\n\t\tif (!opener) {\n\t\t\tthrow new Error(`Unknown opener id: '${id}'`);\n\t\t}\n\n\t\treturn opener.openExternalUri(URI.revive(context.resolvedUri), {\n\t\t\tsourceUri: URI.revive(context.sourceUri)\n\t\t}, token);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type * as vscode from 'vscode';\nimport { MainContext, IMainContext, ExtHostUrlsShape, MainThreadUrlsShape } from './extHost.protocol';\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { toDisposable } from 'vs/base/common/lifecycle';\nimport { onUnexpectedError } from 'vs/base/common/errors';\nimport { ExtensionIdentifier } from 'vs/platform/extensions/common/extensions';\n\nexport class ExtHostUrls implements ExtHostUrlsShape {\n\n\tprivate static HandlePool = 0;\n\tprivate readonly _proxy: MainThreadUrlsShape;\n\n\tprivate handles = new Set<string>();\n\tprivate handlers = new Map<number, vscode.UriHandler>();\n\n\tconstructor(\n\t\tmainContext: IMainContext\n\t) {\n\t\tthis._proxy = mainContext.getProxy(MainContext.MainThreadUrls);\n\t}\n\n\tregisterUriHandler(extensionId: ExtensionIdentifier, handler: vscode.UriHandler): vscode.Disposable {\n\t\tif (this.handles.has(ExtensionIdentifier.toKey(extensionId))) {\n\t\t\tthrow new Error(`Protocol handler already registered for extension ${extensionId}`);\n\t\t}\n\n\t\tconst handle = ExtHostUrls.HandlePool++;\n\t\tthis.handles.add(ExtensionIdentifier.toKey(extensionId));\n\t\tthis.handlers.set(handle, handler);\n\t\tthis._proxy.$registerUriHandler(handle, extensionId);\n\n\t\treturn toDisposable(() => {\n\t\t\tthis.handles.delete(ExtensionIdentifier.toKey(extensionId));\n\t\t\tthis.handlers.delete(handle);\n\t\t\tthis._proxy.$unregisterUriHandler(handle);\n\t\t});\n\t}\n\n\t$handleExternalUri(handle: number, uri: UriComponents): Promise<void> {\n\t\tconst handler = this.handlers.get(handle);\n\n\t\tif (!handler) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\t\ttry {\n\t\t\thandler.handleUri(URI.revive(uri));\n\t\t} catch (err) {\n\t\t\tonUnexpectedError(err);\n\t\t}\n\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\tasync createAppUri(uri: URI): Promise<vscode.Uri> {\n\t\treturn URI.revive(await this._proxy.$createAppUri(uri));\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { VSBuffer } from 'vs/base/common/buffer';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { Schemas } from 'vs/base/common/network';\nimport { URI } from 'vs/base/common/uri';\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { normalizeVersion, parseVersion } from 'vs/platform/extensions/common/extensionValidator';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { IExtHostApiDeprecationService } from 'vs/workbench/api/common/extHostApiDeprecationService';\nimport { serializeWebviewMessage, deserializeWebviewMessage } from 'vs/workbench/api/common/extHostWebviewMessaging';\nimport { IExtHostWorkspace } from 'vs/workbench/api/common/extHostWorkspace';\nimport { asWebviewUri, webviewGenericCspSource, WebviewRemoteInfo } from 'vs/workbench/common/webview';\nimport { SerializableObjectWithBuffers } from 'vs/workbench/services/extensions/common/proxyIdentifier';\nimport type * as vscode from 'vscode';\nimport * as extHostProtocol from './extHost.protocol';\n\nexport class ExtHostWebview implements vscode.Webview {\n\n\treadonly #handle: extHostProtocol.WebviewHandle;\n\treadonly #proxy: extHostProtocol.MainThreadWebviewsShape;\n\treadonly #deprecationService: IExtHostApiDeprecationService;\n\n\treadonly #remoteInfo: WebviewRemoteInfo;\n\treadonly #workspace: IExtHostWorkspace | undefined;\n\treadonly #extension: IExtensionDescription;\n\n\t#html: string = '';\n\t#options: vscode.WebviewOptions;\n\t#isDisposed: boolean = false;\n\t#hasCalledAsWebviewUri = false;\n\n\t#serializeBuffersForPostMessage = false;\n\n\tconstructor(\n\t\thandle: extHostProtocol.WebviewHandle,\n\t\tproxy: extHostProtocol.MainThreadWebviewsShape,\n\t\toptions: vscode.WebviewOptions,\n\t\tremoteInfo: WebviewRemoteInfo,\n\t\tworkspace: IExtHostWorkspace | undefined,\n\t\textension: IExtensionDescription,\n\t\tdeprecationService: IExtHostApiDeprecationService,\n\t) {\n\t\tthis.#handle = handle;\n\t\tthis.#proxy = proxy;\n\t\tthis.#options = options;\n\t\tthis.#remoteInfo = remoteInfo;\n\t\tthis.#workspace = workspace;\n\t\tthis.#extension = extension;\n\t\tthis.#serializeBuffersForPostMessage = shouldSerializeBuffersForPostMessage(extension);\n\t\tthis.#deprecationService = deprecationService;\n\t}\n\n\t/* internal */ readonly _onMessageEmitter = new Emitter<any>();\n\tpublic readonly onDidReceiveMessage: Event<any> = this._onMessageEmitter.event;\n\n\treadonly #onDidDisposeEmitter = new Emitter<void>();\n\t/* internal */ readonly _onDidDispose: Event<void> = this.#onDidDisposeEmitter.event;\n\n\tpublic dispose() {\n\t\tthis.#isDisposed = true;\n\n\t\tthis.#onDidDisposeEmitter.fire();\n\n\t\tthis.#onDidDisposeEmitter.dispose();\n\t\tthis._onMessageEmitter.dispose();\n\t}\n\n\tpublic asWebviewUri(resource: vscode.Uri): vscode.Uri {\n\t\tthis.#hasCalledAsWebviewUri = true;\n\t\treturn asWebviewUri(resource, this.#remoteInfo);\n\t}\n\n\tpublic get cspSource(): string {\n\t\tconst extensionLocation = this.#extension.extensionLocation;\n\t\tif (extensionLocation.scheme === Schemas.https || extensionLocation.scheme === Schemas.http) {\n\t\t\t// The extension is being served up from a CDN.\n\t\t\t// Also include the CDN in the default csp.\n\t\t\tlet extensionCspRule = extensionLocation.toString();\n\t\t\tif (!extensionCspRule.endsWith('/')) {\n\t\t\t\t// Always treat the location as a directory so that we allow all content under it\n\t\t\t\textensionCspRule += '/';\n\t\t\t}\n\t\t\treturn extensionCspRule + ' ' + webviewGenericCspSource;\n\t\t}\n\t\treturn webviewGenericCspSource;\n\t}\n\n\tpublic get html(): string {\n\t\tthis.assertNotDisposed();\n\t\treturn this.#html;\n\t}\n\n\tpublic set html(value: string) {\n\t\tthis.assertNotDisposed();\n\t\tif (this.#html !== value) {\n\t\t\tthis.#html = value;\n\t\t\tif (!this.#hasCalledAsWebviewUri && /([\"'])vscode-resource:([^\\s'\"]+?)([\"'])/i.test(value)) {\n\t\t\t\tthis.#hasCalledAsWebviewUri = true;\n\t\t\t\tthis.#deprecationService.report('Webview vscode-resource: uris', this.#extension,\n\t\t\t\t\t`Please migrate to use the 'webview.asWebviewUri' api instead: https://aka.ms/vscode-webview-use-aswebviewuri`);\n\t\t\t}\n\t\t\tthis.#proxy.$setHtml(this.#handle, value);\n\t\t}\n\t}\n\n\tpublic get options(): vscode.WebviewOptions {\n\t\tthis.assertNotDisposed();\n\t\treturn this.#options;\n\t}\n\n\tpublic set options(newOptions: vscode.WebviewOptions) {\n\t\tthis.assertNotDisposed();\n\t\tthis.#proxy.$setOptions(this.#handle, serializeWebviewOptions(this.#extension, this.#workspace, newOptions));\n\t\tthis.#options = newOptions;\n\t}\n\n\tpublic async postMessage(message: any): Promise<boolean> {\n\t\tif (this.#isDisposed) {\n\t\t\treturn false;\n\t\t}\n\t\tconst serialized = serializeWebviewMessage(message, { serializeBuffersForPostMessage: this.#serializeBuffersForPostMessage });\n\t\treturn this.#proxy.$postMessage(this.#handle, serialized.message, ...serialized.buffers);\n\t}\n\n\tprivate assertNotDisposed() {\n\t\tif (this.#isDisposed) {\n\t\t\tthrow new Error('Webview is disposed');\n\t\t}\n\t}\n}\n\nexport function shouldSerializeBuffersForPostMessage(extension: IExtensionDescription): boolean {\n\ttry {\n\t\tconst version = normalizeVersion(parseVersion(extension.engines.vscode));\n\t\treturn !!version && version.majorBase >= 1 && version.minorBase >= 57;\n\t} catch {\n\t\treturn false;\n\t}\n}\n\nexport class ExtHostWebviews implements extHostProtocol.ExtHostWebviewsShape {\n\n\tprivate readonly _webviewProxy: extHostProtocol.MainThreadWebviewsShape;\n\n\tprivate readonly _webviews = new Map<extHostProtocol.WebviewHandle, ExtHostWebview>();\n\n\tconstructor(\n\t\tmainContext: extHostProtocol.IMainContext,\n\t\tprivate readonly remoteInfo: WebviewRemoteInfo,\n\t\tprivate readonly workspace: IExtHostWorkspace | undefined,\n\t\tprivate readonly _logService: ILogService,\n\t\tprivate readonly _deprecationService: IExtHostApiDeprecationService,\n\t) {\n\t\tthis._webviewProxy = mainContext.getProxy(extHostProtocol.MainContext.MainThreadWebviews);\n\t}\n\n\tpublic $onMessage(\n\t\thandle: extHostProtocol.WebviewHandle,\n\t\tjsonMessage: string,\n\t\tbuffers: SerializableObjectWithBuffers<VSBuffer[]>\n\t): void {\n\t\tconst webview = this.getWebview(handle);\n\t\tif (webview) {\n\t\t\tconst { message } = deserializeWebviewMessage(jsonMessage, buffers.value);\n\t\t\twebview._onMessageEmitter.fire(message);\n\t\t}\n\t}\n\n\tpublic $onMissingCsp(\n\t\t_handle: extHostProtocol.WebviewHandle,\n\t\textensionId: string\n\t): void {\n\t\tthis._logService.warn(`${extensionId} created a webview without a content security policy: https://aka.ms/vscode-webview-missing-csp`);\n\t}\n\n\tpublic createNewWebview(handle: string, options: extHostProtocol.IWebviewContentOptions, extension: IExtensionDescription): ExtHostWebview {\n\t\tconst webview = new ExtHostWebview(handle, this._webviewProxy, reviveOptions(options), this.remoteInfo, this.workspace, extension, this._deprecationService);\n\t\tthis._webviews.set(handle, webview);\n\n\t\twebview._onDidDispose(() => { this._webviews.delete(handle); });\n\n\t\treturn webview;\n\t}\n\n\tpublic deleteWebview(handle: string) {\n\t\tthis._webviews.delete(handle);\n\t}\n\n\tprivate getWebview(handle: extHostProtocol.WebviewHandle): ExtHostWebview | undefined {\n\t\treturn this._webviews.get(handle);\n\t}\n}\n\nexport function toExtensionData(extension: IExtensionDescription): extHostProtocol.WebviewExtensionDescription {\n\treturn { id: extension.identifier, location: extension.extensionLocation };\n}\n\nexport function serializeWebviewOptions(\n\textension: IExtensionDescription,\n\tworkspace: IExtHostWorkspace | undefined,\n\toptions: vscode.WebviewOptions,\n): extHostProtocol.IWebviewContentOptions {\n\treturn {\n\t\tenableCommandUris: options.enableCommandUris,\n\t\tenableScripts: options.enableScripts,\n\t\tenableForms: options.enableForms,\n\t\tportMapping: options.portMapping,\n\t\tlocalResourceRoots: options.localResourceRoots || getDefaultLocalResourceRoots(extension, workspace)\n\t};\n}\n\nexport function reviveOptions(options: extHostProtocol.IWebviewContentOptions): vscode.WebviewOptions {\n\treturn {\n\t\tenableCommandUris: options.enableCommandUris,\n\t\tenableScripts: options.enableScripts,\n\t\tenableForms: options.enableForms,\n\t\tportMapping: options.portMapping,\n\t\tlocalResourceRoots: options.localResourceRoots?.map(components => URI.from(components)),\n\t};\n}\n\nfunction getDefaultLocalResourceRoots(\n\textension: IExtensionDescription,\n\tworkspace: IExtHostWorkspace | undefined,\n): URI[] {\n\treturn [\n\t\t...(workspace?.getWorkspaceFolders() || []).map(x => x.uri),\n\t\textension.extensionLocation,\n\t];\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { VSBuffer } from 'vs/base/common/buffer';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { hash } from 'vs/base/common/hash';\nimport { DisposableStore } from 'vs/base/common/lifecycle';\nimport { Schemas } from 'vs/base/common/network';\nimport { joinPath } from 'vs/base/common/resources';\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { ExtHostDocuments } from 'vs/workbench/api/common/extHostDocuments';\nimport { IExtensionStoragePaths } from 'vs/workbench/api/common/extHostStoragePaths';\nimport * as typeConverters from 'vs/workbench/api/common/extHostTypeConverters';\nimport { ExtHostWebviews, shouldSerializeBuffersForPostMessage, toExtensionData } from 'vs/workbench/api/common/extHostWebview';\nimport { ExtHostWebviewPanels } from 'vs/workbench/api/common/extHostWebviewPanels';\nimport { EditorGroupColumn } from 'vs/workbench/services/editor/common/editorGroupColumn';\nimport type * as vscode from 'vscode';\nimport { Cache } from './cache';\nimport * as extHostProtocol from './extHost.protocol';\nimport * as extHostTypes from './extHostTypes';\n\n\nclass CustomDocumentStoreEntry {\n\n\tprivate _backupCounter = 1;\n\n\tconstructor(\n\t\tpublic readonly document: vscode.CustomDocument,\n\t\tprivate readonly _storagePath: URI | undefined,\n\t) { }\n\n\tprivate readonly _edits = new Cache<vscode.CustomDocumentEditEvent>('custom documents');\n\n\tprivate _backup?: vscode.CustomDocumentBackup;\n\n\taddEdit(item: vscode.CustomDocumentEditEvent): number {\n\t\treturn this._edits.add([item]);\n\t}\n\n\tasync undo(editId: number, isDirty: boolean): Promise<void> {\n\t\tawait this.getEdit(editId).undo();\n\t\tif (!isDirty) {\n\t\t\tthis.disposeBackup();\n\t\t}\n\t}\n\n\tasync redo(editId: number, isDirty: boolean): Promise<void> {\n\t\tawait this.getEdit(editId).redo();\n\t\tif (!isDirty) {\n\t\t\tthis.disposeBackup();\n\t\t}\n\t}\n\n\tdisposeEdits(editIds: number[]): void {\n\t\tfor (const id of editIds) {\n\t\t\tthis._edits.delete(id);\n\t\t}\n\t}\n\n\tgetNewBackupUri(): URI {\n\t\tif (!this._storagePath) {\n\t\t\tthrow new Error('Backup requires a valid storage path');\n\t\t}\n\t\tconst fileName = hashPath(this.document.uri) + (this._backupCounter++);\n\t\treturn joinPath(this._storagePath, fileName);\n\t}\n\n\tupdateBackup(backup: vscode.CustomDocumentBackup): void {\n\t\tthis._backup?.delete();\n\t\tthis._backup = backup;\n\t}\n\n\tdisposeBackup(): void {\n\t\tthis._backup?.delete();\n\t\tthis._backup = undefined;\n\t}\n\n\tprivate getEdit(editId: number): vscode.CustomDocumentEditEvent {\n\t\tconst edit = this._edits.get(editId, 0);\n\t\tif (!edit) {\n\t\t\tthrow new Error('No edit found');\n\t\t}\n\t\treturn edit;\n\t}\n}\n\nclass CustomDocumentStore {\n\tprivate readonly _documents = new Map<string, CustomDocumentStoreEntry>();\n\n\tpublic get(viewType: string, resource: vscode.Uri): CustomDocumentStoreEntry | undefined {\n\t\treturn this._documents.get(this.key(viewType, resource));\n\t}\n\n\tpublic add(viewType: string, document: vscode.CustomDocument, storagePath: URI | undefined): CustomDocumentStoreEntry {\n\t\tconst key = this.key(viewType, document.uri);\n\t\tif (this._documents.has(key)) {\n\t\t\tthrow new Error(`Document already exists for viewType:${viewType} resource:${document.uri}`);\n\t\t}\n\t\tconst entry = new CustomDocumentStoreEntry(document, storagePath);\n\t\tthis._documents.set(key, entry);\n\t\treturn entry;\n\t}\n\n\tpublic delete(viewType: string, document: vscode.CustomDocument) {\n\t\tconst key = this.key(viewType, document.uri);\n\t\tthis._documents.delete(key);\n\t}\n\n\tprivate key(viewType: string, resource: vscode.Uri): string {\n\t\treturn `${viewType}@@@${resource}`;\n\t}\n\n}\n\nconst enum WebviewEditorType {\n\tText,\n\tCustom\n}\n\ntype ProviderEntry = {\n\treadonly extension: IExtensionDescription;\n\treadonly type: WebviewEditorType.Text;\n\treadonly provider: vscode.CustomTextEditorProvider;\n} | {\n\treadonly extension: IExtensionDescription;\n\treadonly type: WebviewEditorType.Custom;\n\treadonly provider: vscode.CustomReadonlyEditorProvider;\n};\n\nclass EditorProviderStore {\n\tprivate readonly _providers = new Map<string, ProviderEntry>();\n\n\tpublic addTextProvider(viewType: string, extension: IExtensionDescription, provider: vscode.CustomTextEditorProvider): vscode.Disposable {\n\t\treturn this.add(WebviewEditorType.Text, viewType, extension, provider);\n\t}\n\n\tpublic addCustomProvider(viewType: string, extension: IExtensionDescription, provider: vscode.CustomReadonlyEditorProvider): vscode.Disposable {\n\t\treturn this.add(WebviewEditorType.Custom, viewType, extension, provider);\n\t}\n\n\tpublic get(viewType: string): ProviderEntry | undefined {\n\t\treturn this._providers.get(viewType);\n\t}\n\n\tprivate add(type: WebviewEditorType, viewType: string, extension: IExtensionDescription, provider: vscode.CustomTextEditorProvider | vscode.CustomReadonlyEditorProvider): vscode.Disposable {\n\t\tif (this._providers.has(viewType)) {\n\t\t\tthrow new Error(`Provider for viewType:${viewType} already registered`);\n\t\t}\n\t\tthis._providers.set(viewType, { type, extension, provider } as ProviderEntry);\n\t\treturn new extHostTypes.Disposable(() => this._providers.delete(viewType));\n\t}\n}\n\nexport class ExtHostCustomEditors implements extHostProtocol.ExtHostCustomEditorsShape {\n\n\tprivate readonly _proxy: extHostProtocol.MainThreadCustomEditorsShape;\n\n\tprivate readonly _editorProviders = new EditorProviderStore();\n\n\tprivate readonly _documents = new CustomDocumentStore();\n\n\tconstructor(\n\t\tmainContext: extHostProtocol.IMainContext,\n\t\tprivate readonly _extHostDocuments: ExtHostDocuments,\n\t\tprivate readonly _extensionStoragePaths: IExtensionStoragePaths | undefined,\n\t\tprivate readonly _extHostWebview: ExtHostWebviews,\n\t\tprivate readonly _extHostWebviewPanels: ExtHostWebviewPanels,\n\t) {\n\t\tthis._proxy = mainContext.getProxy(extHostProtocol.MainContext.MainThreadCustomEditors);\n\t}\n\n\tpublic registerCustomEditorProvider(\n\t\textension: IExtensionDescription,\n\t\tviewType: string,\n\t\tprovider: vscode.CustomReadonlyEditorProvider | vscode.CustomTextEditorProvider,\n\t\toptions: { webviewOptions?: vscode.WebviewPanelOptions; supportsMultipleEditorsPerDocument?: boolean },\n\t): vscode.Disposable {\n\t\tconst disposables = new DisposableStore();\n\t\tif (isCustomTextEditorProvider(provider)) {\n\t\t\tdisposables.add(this._editorProviders.addTextProvider(viewType, extension, provider));\n\t\t\tthis._proxy.$registerTextEditorProvider(toExtensionData(extension), viewType, options.webviewOptions || {}, {\n\t\t\t\tsupportsMove: !!provider.moveCustomTextEditor,\n\t\t\t}, shouldSerializeBuffersForPostMessage(extension));\n\t\t} else {\n\t\t\tdisposables.add(this._editorProviders.addCustomProvider(viewType, extension, provider));\n\n\t\t\tif (this.supportEditing(provider)) {\n\t\t\t\tdisposables.add(provider.onDidChangeCustomDocument(e => {\n\t\t\t\t\tconst entry = this.getCustomDocumentEntry(viewType, e.document.uri);\n\t\t\t\t\tif (isEditEvent(e)) {\n\t\t\t\t\t\tconst editId = entry.addEdit(e);\n\t\t\t\t\t\tthis._proxy.$onDidEdit(e.document.uri, viewType, editId, e.label);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._proxy.$onContentChange(e.document.uri, viewType);\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t}\n\n\t\t\tthis._proxy.$registerCustomEditorProvider(toExtensionData(extension), viewType, options.webviewOptions || {}, !!options.supportsMultipleEditorsPerDocument, shouldSerializeBuffersForPostMessage(extension));\n\t\t}\n\n\t\treturn extHostTypes.Disposable.from(\n\t\t\tdisposables,\n\t\t\tnew extHostTypes.Disposable(() => {\n\t\t\t\tthis._proxy.$unregisterEditorProvider(viewType);\n\t\t\t}));\n\t}\n\n\tasync $createCustomDocument(resource: UriComponents, viewType: string, backupId: string | undefined, untitledDocumentData: VSBuffer | undefined, cancellation: CancellationToken) {\n\t\tconst entry = this._editorProviders.get(viewType);\n\t\tif (!entry) {\n\t\t\tthrow new Error(`No provider found for '${viewType}'`);\n\t\t}\n\n\t\tif (entry.type !== WebviewEditorType.Custom) {\n\t\t\tthrow new Error(`Invalid provide type for '${viewType}'`);\n\t\t}\n\n\t\tconst revivedResource = URI.revive(resource);\n\t\tconst document = await entry.provider.openCustomDocument(revivedResource, { backupId, untitledDocumentData: untitledDocumentData?.buffer }, cancellation);\n\n\t\tlet storageRoot: URI | undefined;\n\t\tif (this.supportEditing(entry.provider) && this._extensionStoragePaths) {\n\t\t\tstorageRoot = this._extensionStoragePaths.workspaceValue(entry.extension) ?? this._extensionStoragePaths.globalValue(entry.extension);\n\t\t}\n\t\tthis._documents.add(viewType, document, storageRoot);\n\n\t\treturn { editable: this.supportEditing(entry.provider) };\n\t}\n\n\tasync $disposeCustomDocument(resource: UriComponents, viewType: string): Promise<void> {\n\t\tconst entry = this._editorProviders.get(viewType);\n\t\tif (!entry) {\n\t\t\tthrow new Error(`No provider found for '${viewType}'`);\n\t\t}\n\n\t\tif (entry.type !== WebviewEditorType.Custom) {\n\t\t\tthrow new Error(`Invalid provider type for '${viewType}'`);\n\t\t}\n\n\t\tconst revivedResource = URI.revive(resource);\n\t\tconst { document } = this.getCustomDocumentEntry(viewType, revivedResource);\n\t\tthis._documents.delete(viewType, document);\n\t\tdocument.dispose();\n\t}\n\n\tasync $resolveWebviewEditor(\n\t\tresource: UriComponents,\n\t\thandle: extHostProtocol.WebviewHandle,\n\t\tviewType: string,\n\t\tinitData: {\n\t\t\ttitle: string;\n\t\t\twebviewOptions: extHostProtocol.IWebviewContentOptions;\n\t\t\tpanelOptions: extHostProtocol.IWebviewPanelOptions;\n\t\t},\n\t\tposition: EditorGroupColumn,\n\t\tcancellation: CancellationToken,\n\t): Promise<void> {\n\t\tconst entry = this._editorProviders.get(viewType);\n\t\tif (!entry) {\n\t\t\tthrow new Error(`No provider found for '${viewType}'`);\n\t\t}\n\n\t\tconst viewColumn = typeConverters.ViewColumn.to(position);\n\n\t\tconst webview = this._extHostWebview.createNewWebview(handle, initData.webviewOptions, entry.extension);\n\t\tconst panel = this._extHostWebviewPanels.createNewWebviewPanel(handle, viewType, initData.title, viewColumn, initData.panelOptions, webview, true);\n\n\t\tconst revivedResource = URI.revive(resource);\n\n\t\tswitch (entry.type) {\n\t\t\tcase WebviewEditorType.Custom:\n\t\t\t\t{\n\t\t\t\t\tconst { document } = this.getCustomDocumentEntry(viewType, revivedResource);\n\t\t\t\t\treturn entry.provider.resolveCustomEditor(document, panel, cancellation);\n\t\t\t\t}\n\t\t\tcase WebviewEditorType.Text:\n\t\t\t\t{\n\t\t\t\t\tconst document = this._extHostDocuments.getDocument(revivedResource);\n\t\t\t\t\treturn entry.provider.resolveCustomTextEditor(document, panel, cancellation);\n\t\t\t\t}\n\t\t\tdefault:\n\t\t\t\t{\n\t\t\t\t\tthrow new Error('Unknown webview provider type');\n\t\t\t\t}\n\t\t}\n\t}\n\n\t$disposeEdits(resourceComponents: UriComponents, viewType: string, editIds: number[]): void {\n\t\tconst document = this.getCustomDocumentEntry(viewType, resourceComponents);\n\t\tdocument.disposeEdits(editIds);\n\t}\n\n\tasync $onMoveCustomEditor(handle: string, newResourceComponents: UriComponents, viewType: string): Promise<void> {\n\t\tconst entry = this._editorProviders.get(viewType);\n\t\tif (!entry) {\n\t\t\tthrow new Error(`No provider found for '${viewType}'`);\n\t\t}\n\n\t\tif (!(entry.provider as vscode.CustomTextEditorProvider).moveCustomTextEditor) {\n\t\t\tthrow new Error(`Provider does not implement move '${viewType}'`);\n\t\t}\n\n\t\tconst webview = this._extHostWebviewPanels.getWebviewPanel(handle);\n\t\tif (!webview) {\n\t\t\tthrow new Error(`No webview found`);\n\t\t}\n\n\t\tconst resource = URI.revive(newResourceComponents);\n\t\tconst document = this._extHostDocuments.getDocument(resource);\n\t\tawait (entry.provider as vscode.CustomTextEditorProvider).moveCustomTextEditor!(document, webview, CancellationToken.None);\n\t}\n\n\tasync $undo(resourceComponents: UriComponents, viewType: string, editId: number, isDirty: boolean): Promise<void> {\n\t\tconst entry = this.getCustomDocumentEntry(viewType, resourceComponents);\n\t\treturn entry.undo(editId, isDirty);\n\t}\n\n\tasync $redo(resourceComponents: UriComponents, viewType: string, editId: number, isDirty: boolean): Promise<void> {\n\t\tconst entry = this.getCustomDocumentEntry(viewType, resourceComponents);\n\t\treturn entry.redo(editId, isDirty);\n\t}\n\n\tasync $revert(resourceComponents: UriComponents, viewType: string, cancellation: CancellationToken): Promise<void> {\n\t\tconst entry = this.getCustomDocumentEntry(viewType, resourceComponents);\n\t\tconst provider = this.getCustomEditorProvider(viewType);\n\t\tawait provider.revertCustomDocument(entry.document, cancellation);\n\t\tentry.disposeBackup();\n\t}\n\n\tasync $onSave(resourceComponents: UriComponents, viewType: string, cancellation: CancellationToken): Promise<void> {\n\t\tconst entry = this.getCustomDocumentEntry(viewType, resourceComponents);\n\t\tconst provider = this.getCustomEditorProvider(viewType);\n\t\tawait provider.saveCustomDocument(entry.document, cancellation);\n\t\tentry.disposeBackup();\n\t}\n\n\tasync $onSaveAs(resourceComponents: UriComponents, viewType: string, targetResource: UriComponents, cancellation: CancellationToken): Promise<void> {\n\t\tconst entry = this.getCustomDocumentEntry(viewType, resourceComponents);\n\t\tconst provider = this.getCustomEditorProvider(viewType);\n\t\treturn provider.saveCustomDocumentAs(entry.document, URI.revive(targetResource), cancellation);\n\t}\n\n\tasync $backup(resourceComponents: UriComponents, viewType: string, cancellation: CancellationToken): Promise<string> {\n\t\tconst entry = this.getCustomDocumentEntry(viewType, resourceComponents);\n\t\tconst provider = this.getCustomEditorProvider(viewType);\n\n\t\tconst backup = await provider.backupCustomDocument(entry.document, {\n\t\t\tdestination: entry.getNewBackupUri(),\n\t\t}, cancellation);\n\t\tentry.updateBackup(backup);\n\t\treturn backup.id;\n\t}\n\n\tprivate getCustomDocumentEntry(viewType: string, resource: UriComponents): CustomDocumentStoreEntry {\n\t\tconst entry = this._documents.get(viewType, URI.revive(resource));\n\t\tif (!entry) {\n\t\t\tthrow new Error('No custom document found');\n\t\t}\n\t\treturn entry;\n\t}\n\n\tprivate getCustomEditorProvider(viewType: string): vscode.CustomEditorProvider {\n\t\tconst entry = this._editorProviders.get(viewType);\n\t\tconst provider = entry?.provider;\n\t\tif (!provider || !this.supportEditing(provider)) {\n\t\t\tthrow new Error('Custom document is not editable');\n\t\t}\n\t\treturn provider;\n\t}\n\n\tprivate supportEditing(\n\t\tprovider: vscode.CustomTextEditorProvider | vscode.CustomEditorProvider | vscode.CustomReadonlyEditorProvider\n\t): provider is vscode.CustomEditorProvider {\n\t\treturn !!(provider as vscode.CustomEditorProvider).onDidChangeCustomDocument;\n\t}\n}\n\nfunction isCustomTextEditorProvider(provider: vscode.CustomReadonlyEditorProvider<vscode.CustomDocument> | vscode.CustomTextEditorProvider): provider is vscode.CustomTextEditorProvider {\n\treturn typeof (provider as vscode.CustomTextEditorProvider).resolveCustomTextEditor === 'function';\n}\n\nfunction isEditEvent(e: vscode.CustomDocumentContentChangeEvent | vscode.CustomDocumentEditEvent): e is vscode.CustomDocumentEditEvent {\n\treturn typeof (e as vscode.CustomDocumentEditEvent).undo === 'function'\n\t\t&& typeof (e as vscode.CustomDocumentEditEvent).redo === 'function';\n}\n\nfunction hashPath(resource: URI): string {\n\tconst str = resource.scheme === Schemas.file || resource.scheme === Schemas.untitled ? resource.fsPath : resource.toString();\n\treturn hash(str) + '';\n}\n\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter } from 'vs/base/common/event';\nimport { Disposable } from 'vs/base/common/lifecycle';\nimport { URI } from 'vs/base/common/uri';\nimport { generateUuid } from 'vs/base/common/uuid';\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport * as typeConverters from 'vs/workbench/api/common/extHostTypeConverters';\nimport { serializeWebviewOptions, ExtHostWebview, ExtHostWebviews, toExtensionData, shouldSerializeBuffersForPostMessage } from 'vs/workbench/api/common/extHostWebview';\nimport { IExtHostWorkspace } from 'vs/workbench/api/common/extHostWorkspace';\nimport { EditorGroupColumn } from 'vs/workbench/services/editor/common/editorGroupColumn';\nimport type * as vscode from 'vscode';\nimport * as extHostProtocol from './extHost.protocol';\nimport * as extHostTypes from './extHostTypes';\n\n\ntype IconPath = URI | { readonly light: URI; readonly dark: URI };\n\nclass ExtHostWebviewPanel extends Disposable implements vscode.WebviewPanel {\n\n\treadonly #handle: extHostProtocol.WebviewHandle;\n\treadonly #proxy: extHostProtocol.MainThreadWebviewPanelsShape;\n\treadonly #viewType: string;\n\n\treadonly #webview: ExtHostWebview;\n\treadonly #options: vscode.WebviewPanelOptions;\n\n\t#title: string;\n\t#iconPath?: IconPath;\n\t#viewColumn: vscode.ViewColumn | undefined = undefined;\n\t#visible: boolean = true;\n\t#active: boolean;\n\t#isDisposed: boolean = false;\n\n\treadonly #onDidDispose = this._register(new Emitter<void>());\n\tpublic readonly onDidDispose = this.#onDidDispose.event;\n\n\treadonly #onDidChangeViewState = this._register(new Emitter<vscode.WebviewPanelOnDidChangeViewStateEvent>());\n\tpublic readonly onDidChangeViewState = this.#onDidChangeViewState.event;\n\n\tconstructor(\n\t\thandle: extHostProtocol.WebviewHandle,\n\t\tproxy: extHostProtocol.MainThreadWebviewPanelsShape,\n\t\twebview: ExtHostWebview,\n\t\tparams: {\n\t\t\tviewType: string;\n\t\t\ttitle: string;\n\t\t\tviewColumn: vscode.ViewColumn | undefined;\n\t\t\tpanelOptions: vscode.WebviewPanelOptions;\n\t\t\tactive: boolean;\n\t\t}\n\t) {\n\t\tsuper();\n\t\tthis.#handle = handle;\n\t\tthis.#proxy = proxy;\n\t\tthis.#webview = webview;\n\t\tthis.#viewType = params.viewType;\n\t\tthis.#options = params.panelOptions;\n\t\tthis.#viewColumn = params.viewColumn;\n\t\tthis.#title = params.title;\n\t\tthis.#active = params.active;\n\t}\n\n\tpublic override dispose() {\n\t\tif (this.#isDisposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#isDisposed = true;\n\t\tthis.#onDidDispose.fire();\n\n\t\tthis.#proxy.$disposeWebview(this.#handle);\n\t\tthis.#webview.dispose();\n\n\t\tsuper.dispose();\n\t}\n\n\tget webview() {\n\t\tthis.assertNotDisposed();\n\t\treturn this.#webview;\n\t}\n\n\tget viewType(): string {\n\t\tthis.assertNotDisposed();\n\t\treturn this.#viewType;\n\t}\n\n\tget title(): string {\n\t\tthis.assertNotDisposed();\n\t\treturn this.#title;\n\t}\n\n\tset title(value: string) {\n\t\tthis.assertNotDisposed();\n\t\tif (this.#title !== value) {\n\t\t\tthis.#title = value;\n\t\t\tthis.#proxy.$setTitle(this.#handle, value);\n\t\t}\n\t}\n\n\tget iconPath(): IconPath | undefined {\n\t\tthis.assertNotDisposed();\n\t\treturn this.#iconPath;\n\t}\n\n\tset iconPath(value: IconPath | undefined) {\n\t\tthis.assertNotDisposed();\n\t\tif (this.#iconPath !== value) {\n\t\t\tthis.#iconPath = value;\n\n\t\t\tthis.#proxy.$setIconPath(this.#handle, URI.isUri(value) ? { light: value, dark: value } : value);\n\t\t}\n\t}\n\n\tget options() {\n\t\treturn this.#options;\n\t}\n\n\tget viewColumn(): vscode.ViewColumn | undefined {\n\t\tthis.assertNotDisposed();\n\t\tif (typeof this.#viewColumn === 'number' && this.#viewColumn < 0) {\n\t\t\t// We are using a symbolic view column\n\t\t\t// Return undefined instead to indicate that the real view column is currently unknown but will be resolved.\n\t\t\treturn undefined;\n\t\t}\n\t\treturn this.#viewColumn;\n\t}\n\n\tpublic get active(): boolean {\n\t\tthis.assertNotDisposed();\n\t\treturn this.#active;\n\t}\n\n\tpublic get visible(): boolean {\n\t\tthis.assertNotDisposed();\n\t\treturn this.#visible;\n\t}\n\n\t_updateViewState(newState: { active: boolean; visible: boolean; viewColumn: vscode.ViewColumn }) {\n\t\tif (this.#isDisposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.active !== newState.active || this.visible !== newState.visible || this.viewColumn !== newState.viewColumn) {\n\t\t\tthis.#active = newState.active;\n\t\t\tthis.#visible = newState.visible;\n\t\t\tthis.#viewColumn = newState.viewColumn;\n\t\t\tthis.#onDidChangeViewState.fire({ webviewPanel: this });\n\t\t}\n\t}\n\n\tpublic reveal(viewColumn?: vscode.ViewColumn, preserveFocus?: boolean): void {\n\t\tthis.assertNotDisposed();\n\t\tthis.#proxy.$reveal(this.#handle, {\n\t\t\tviewColumn: typeof viewColumn === 'undefined' ? undefined : typeConverters.ViewColumn.from(viewColumn),\n\t\t\tpreserveFocus: !!preserveFocus\n\t\t});\n\t}\n\n\tprivate assertNotDisposed() {\n\t\tif (this.#isDisposed) {\n\t\t\tthrow new Error('Webview is disposed');\n\t\t}\n\t}\n}\n\nexport class ExtHostWebviewPanels implements extHostProtocol.ExtHostWebviewPanelsShape {\n\n\tprivate static newHandle(): extHostProtocol.WebviewHandle {\n\t\treturn generateUuid();\n\t}\n\n\tprivate readonly _proxy: extHostProtocol.MainThreadWebviewPanelsShape;\n\n\tprivate readonly _webviewPanels = new Map<extHostProtocol.WebviewHandle, ExtHostWebviewPanel>();\n\n\tprivate readonly _serializers = new Map<string, {\n\t\treadonly serializer: vscode.WebviewPanelSerializer;\n\t\treadonly extension: IExtensionDescription;\n\t}>();\n\n\tconstructor(\n\t\tmainContext: extHostProtocol.IMainContext,\n\t\tprivate readonly webviews: ExtHostWebviews,\n\t\tprivate readonly workspace: IExtHostWorkspace | undefined,\n\t) {\n\t\tthis._proxy = mainContext.getProxy(extHostProtocol.MainContext.MainThreadWebviewPanels);\n\t}\n\n\tpublic createWebviewPanel(\n\t\textension: IExtensionDescription,\n\t\tviewType: string,\n\t\ttitle: string,\n\t\tshowOptions: vscode.ViewColumn | { viewColumn: vscode.ViewColumn; preserveFocus?: boolean },\n\t\toptions: (vscode.WebviewPanelOptions & vscode.WebviewOptions) = {},\n\t): vscode.WebviewPanel {\n\t\tconst viewColumn = typeof showOptions === 'object' ? showOptions.viewColumn : showOptions;\n\t\tconst webviewShowOptions = {\n\t\t\tviewColumn: typeConverters.ViewColumn.from(viewColumn),\n\t\t\tpreserveFocus: typeof showOptions === 'object' && !!showOptions.preserveFocus\n\t\t};\n\n\t\tconst serializeBuffersForPostMessage = shouldSerializeBuffersForPostMessage(extension);\n\t\tconst handle = ExtHostWebviewPanels.newHandle();\n\t\tthis._proxy.$createWebviewPanel(toExtensionData(extension), handle, viewType, {\n\t\t\ttitle,\n\t\t\tpanelOptions: serializeWebviewPanelOptions(options),\n\t\t\twebviewOptions: serializeWebviewOptions(extension, this.workspace, options),\n\t\t\tserializeBuffersForPostMessage,\n\t\t}, webviewShowOptions);\n\n\t\tconst webview = this.webviews.createNewWebview(handle, options, extension);\n\t\tconst panel = this.createNewWebviewPanel(handle, viewType, title, viewColumn, options, webview, true);\n\n\t\treturn panel;\n\t}\n\n\tpublic $onDidChangeWebviewPanelViewStates(newStates: extHostProtocol.WebviewPanelViewStateData): void {\n\t\tconst handles = Object.keys(newStates);\n\t\t// Notify webviews of state changes in the following order:\n\t\t// - Non-visible\n\t\t// - Visible\n\t\t// - Active\n\t\thandles.sort((a, b) => {\n\t\t\tconst stateA = newStates[a];\n\t\t\tconst stateB = newStates[b];\n\t\t\tif (stateA.active) {\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\tif (stateB.active) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn (+stateA.visible) - (+stateB.visible);\n\t\t});\n\n\t\tfor (const handle of handles) {\n\t\t\tconst panel = this.getWebviewPanel(handle);\n\t\t\tif (!panel) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst newState = newStates[handle];\n\t\t\tpanel._updateViewState({\n\t\t\t\tactive: newState.active,\n\t\t\t\tvisible: newState.visible,\n\t\t\t\tviewColumn: typeConverters.ViewColumn.to(newState.position),\n\t\t\t});\n\t\t}\n\t}\n\n\tasync $onDidDisposeWebviewPanel(handle: extHostProtocol.WebviewHandle): Promise<void> {\n\t\tconst panel = this.getWebviewPanel(handle);\n\t\tpanel?.dispose();\n\n\t\tthis._webviewPanels.delete(handle);\n\t\tthis.webviews.deleteWebview(handle);\n\t}\n\n\tpublic registerWebviewPanelSerializer(\n\t\textension: IExtensionDescription,\n\t\tviewType: string,\n\t\tserializer: vscode.WebviewPanelSerializer\n\t): vscode.Disposable {\n\t\tif (this._serializers.has(viewType)) {\n\t\t\tthrow new Error(`Serializer for '${viewType}' already registered`);\n\t\t}\n\n\t\tthis._serializers.set(viewType, { serializer, extension });\n\t\tthis._proxy.$registerSerializer(viewType, {\n\t\t\tserializeBuffersForPostMessage: shouldSerializeBuffersForPostMessage(extension)\n\t\t});\n\n\t\treturn new extHostTypes.Disposable(() => {\n\t\t\tthis._serializers.delete(viewType);\n\t\t\tthis._proxy.$unregisterSerializer(viewType);\n\t\t});\n\t}\n\n\tasync $deserializeWebviewPanel(\n\t\twebviewHandle: extHostProtocol.WebviewHandle,\n\t\tviewType: string,\n\t\tinitData: {\n\t\t\ttitle: string;\n\t\t\tstate: any;\n\t\t\twebviewOptions: extHostProtocol.IWebviewContentOptions;\n\t\t\tpanelOptions: extHostProtocol.IWebviewPanelOptions;\n\t\t\tactive: boolean;\n\t\t},\n\t\tposition: EditorGroupColumn\n\t): Promise<void> {\n\t\tconst entry = this._serializers.get(viewType);\n\t\tif (!entry) {\n\t\t\tthrow new Error(`No serializer found for '${viewType}'`);\n\t\t}\n\t\tconst { serializer, extension } = entry;\n\n\t\tconst webview = this.webviews.createNewWebview(webviewHandle, initData.webviewOptions, extension);\n\t\tconst revivedPanel = this.createNewWebviewPanel(webviewHandle, viewType, initData.title, position, initData.panelOptions, webview, initData.active);\n\t\tawait serializer.deserializeWebviewPanel(revivedPanel, initData.state);\n\t}\n\n\tpublic createNewWebviewPanel(webviewHandle: string, viewType: string, title: string, position: vscode.ViewColumn, options: extHostProtocol.IWebviewPanelOptions, webview: ExtHostWebview, active: boolean) {\n\t\tconst panel = new ExtHostWebviewPanel(webviewHandle, this._proxy, webview, { viewType, title, viewColumn: position, panelOptions: options, active });\n\t\tthis._webviewPanels.set(webviewHandle, panel);\n\t\treturn panel;\n\t}\n\n\tpublic getWebviewPanel(handle: extHostProtocol.WebviewHandle): ExtHostWebviewPanel | undefined {\n\t\treturn this._webviewPanels.get(handle);\n\t}\n}\n\nfunction serializeWebviewPanelOptions(options: vscode.WebviewPanelOptions): extHostProtocol.IWebviewPanelOptions {\n\treturn {\n\t\tenableFindWidget: options.enableFindWidget,\n\t\tretainContextWhenHidden: options.retainContextWhenHidden,\n\t};\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { Emitter } from 'vs/base/common/event';\nimport { Disposable } from 'vs/base/common/lifecycle';\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { ExtHostWebview, ExtHostWebviews, toExtensionData, shouldSerializeBuffersForPostMessage } from 'vs/workbench/api/common/extHostWebview';\nimport { checkProposedApiEnabled } from 'vs/workbench/services/extensions/common/extensions';\nimport { ViewBadge } from 'vs/workbench/api/common/extHostTypeConverters';\nimport type * as vscode from 'vscode';\nimport * as extHostProtocol from './extHost.protocol';\nimport * as extHostTypes from './extHostTypes';\n\nclass ExtHostWebviewView extends Disposable implements vscode.WebviewView {\n\n\treadonly #handle: extHostProtocol.WebviewHandle;\n\treadonly #proxy: extHostProtocol.MainThreadWebviewViewsShape;\n\n\treadonly #viewType: string;\n\treadonly #webview: ExtHostWebview;\n\treadonly #extension: IExtensionDescription;\n\n\t#isDisposed = false;\n\t#isVisible: boolean;\n\t#title: string | undefined;\n\t#description: string | undefined;\n\t#badge: vscode.ViewBadge | undefined;\n\n\tconstructor(\n\t\thandle: extHostProtocol.WebviewHandle,\n\t\tproxy: extHostProtocol.MainThreadWebviewViewsShape,\n\t\tviewType: string,\n\t\ttitle: string | undefined,\n\t\twebview: ExtHostWebview,\n\t\textension: IExtensionDescription,\n\t\tisVisible: boolean,\n\t) {\n\t\tsuper();\n\n\t\tthis.#viewType = viewType;\n\t\tthis.#title = title;\n\t\tthis.#handle = handle;\n\t\tthis.#proxy = proxy;\n\t\tthis.#webview = webview;\n\t\tthis.#extension = extension;\n\t\tthis.#isVisible = isVisible;\n\t}\n\n\tpublic override dispose() {\n\t\tif (this.#isDisposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#isDisposed = true;\n\t\tthis.#onDidDispose.fire();\n\n\t\tthis.#webview.dispose();\n\n\t\tsuper.dispose();\n\t}\n\n\treadonly #onDidChangeVisibility = this._register(new Emitter<void>());\n\tpublic readonly onDidChangeVisibility = this.#onDidChangeVisibility.event;\n\n\treadonly #onDidDispose = this._register(new Emitter<void>());\n\tpublic readonly onDidDispose = this.#onDidDispose.event;\n\n\tpublic get title(): string | undefined {\n\t\tthis.assertNotDisposed();\n\t\treturn this.#title;\n\t}\n\n\tpublic set title(value: string | undefined) {\n\t\tthis.assertNotDisposed();\n\t\tif (this.#title !== value) {\n\t\t\tthis.#title = value;\n\t\t\tthis.#proxy.$setWebviewViewTitle(this.#handle, value);\n\t\t}\n\t}\n\n\tpublic get description(): string | undefined {\n\t\tthis.assertNotDisposed();\n\t\treturn this.#description;\n\t}\n\n\tpublic set description(value: string | undefined) {\n\t\tthis.assertNotDisposed();\n\t\tif (this.#description !== value) {\n\t\t\tthis.#description = value;\n\t\t\tthis.#proxy.$setWebviewViewDescription(this.#handle, value);\n\t\t}\n\t}\n\n\tpublic get visible(): boolean { return this.#isVisible; }\n\n\tpublic get webview(): vscode.Webview { return this.#webview; }\n\n\tpublic get viewType(): string { return this.#viewType; }\n\n\t/* internal */ _setVisible(visible: boolean) {\n\t\tif (visible === this.#isVisible || this.#isDisposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#isVisible = visible;\n\t\tthis.#onDidChangeVisibility.fire();\n\t}\n\n\tpublic get badge(): vscode.ViewBadge | undefined {\n\t\tthis.assertNotDisposed();\n\t\tcheckProposedApiEnabled(this.#extension, 'badges');\n\t\treturn this.#badge;\n\t}\n\n\tpublic set badge(badge: vscode.ViewBadge | undefined) {\n\t\tthis.assertNotDisposed();\n\t\tcheckProposedApiEnabled(this.#extension, 'badges');\n\n\t\tif (badge?.value === this.#badge?.value &&\n\t\t\tbadge?.tooltip === this.#badge?.tooltip) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#badge = ViewBadge.from(badge);\n\t\tthis.#proxy.$setWebviewViewBadge(this.#handle, badge);\n\t}\n\n\tpublic show(preserveFocus?: boolean): void {\n\t\tthis.assertNotDisposed();\n\t\tthis.#proxy.$show(this.#handle, !!preserveFocus);\n\t}\n\n\tprivate assertNotDisposed() {\n\t\tif (this.#isDisposed) {\n\t\t\tthrow new Error('Webview is disposed');\n\t\t}\n\t}\n}\n\nexport class ExtHostWebviewViews implements extHostProtocol.ExtHostWebviewViewsShape {\n\n\tprivate readonly _proxy: extHostProtocol.MainThreadWebviewViewsShape;\n\n\tprivate readonly _viewProviders = new Map<string, {\n\t\treadonly provider: vscode.WebviewViewProvider;\n\t\treadonly extension: IExtensionDescription;\n\t}>();\n\n\tprivate readonly _webviewViews = new Map<extHostProtocol.WebviewHandle, ExtHostWebviewView>();\n\n\tconstructor(\n\t\tmainContext: extHostProtocol.IMainContext,\n\t\tprivate readonly _extHostWebview: ExtHostWebviews,\n\t) {\n\t\tthis._proxy = mainContext.getProxy(extHostProtocol.MainContext.MainThreadWebviewViews);\n\t}\n\n\tpublic registerWebviewViewProvider(\n\t\textension: IExtensionDescription,\n\t\tviewType: string,\n\t\tprovider: vscode.WebviewViewProvider,\n\t\twebviewOptions?: {\n\t\t\tretainContextWhenHidden?: boolean;\n\t\t},\n\t): vscode.Disposable {\n\t\tif (this._viewProviders.has(viewType)) {\n\t\t\tthrow new Error(`View provider for '${viewType}' already registered`);\n\t\t}\n\n\t\tthis._viewProviders.set(viewType, { provider, extension });\n\t\tthis._proxy.$registerWebviewViewProvider(toExtensionData(extension), viewType, {\n\t\t\tretainContextWhenHidden: webviewOptions?.retainContextWhenHidden,\n\t\t\tserializeBuffersForPostMessage: shouldSerializeBuffersForPostMessage(extension),\n\t\t});\n\n\t\treturn new extHostTypes.Disposable(() => {\n\t\t\tthis._viewProviders.delete(viewType);\n\t\t\tthis._proxy.$unregisterWebviewViewProvider(viewType);\n\t\t});\n\t}\n\n\tasync $resolveWebviewView(\n\t\twebviewHandle: string,\n\t\tviewType: string,\n\t\ttitle: string | undefined,\n\t\tstate: any,\n\t\tcancellation: CancellationToken,\n\t): Promise<void> {\n\t\tconst entry = this._viewProviders.get(viewType);\n\t\tif (!entry) {\n\t\t\tthrow new Error(`No view provider found for '${viewType}'`);\n\t\t}\n\n\t\tconst { provider, extension } = entry;\n\n\t\tconst webview = this._extHostWebview.createNewWebview(webviewHandle, { /* todo */ }, extension);\n\t\tconst revivedView = new ExtHostWebviewView(webviewHandle, this._proxy, viewType, title, webview, extension, true);\n\n\t\tthis._webviewViews.set(webviewHandle, revivedView);\n\n\t\tawait provider.resolveWebviewView(revivedView, { state }, cancellation);\n\t}\n\n\tasync $onDidChangeWebviewViewVisibility(\n\t\twebviewHandle: string,\n\t\tvisible: boolean\n\t) {\n\t\tconst webviewView = this.getWebviewView(webviewHandle);\n\t\twebviewView._setVisible(visible);\n\t}\n\n\tasync $disposeWebviewView(webviewHandle: string) {\n\t\tconst webviewView = this.getWebviewView(webviewHandle);\n\t\tthis._webviewViews.delete(webviewHandle);\n\t\twebviewView.dispose();\n\n\t\tthis._extHostWebview.deleteWebview(webviewHandle);\n\t}\n\n\tprivate getWebviewView(handle: string): ExtHostWebviewView {\n\t\tconst entry = this._webviewViews.get(handle);\n\t\tif (!entry) {\n\t\t\tthrow new Error('No webview found');\n\t\t}\n\t\treturn entry;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Event, Emitter } from 'vs/base/common/event';\nimport { ExtHostWindowShape, MainContext, MainThreadWindowShape, IOpenUriOptions } from './extHost.protocol';\nimport { WindowState } from 'vscode';\nimport { URI } from 'vs/base/common/uri';\nimport { Schemas } from 'vs/base/common/network';\nimport { isFalsyOrWhitespace } from 'vs/base/common/strings';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { IExtHostRpcService } from 'vs/workbench/api/common/extHostRpcService';\n\nexport class ExtHostWindow implements ExtHostWindowShape {\n\n\tprivate static InitialState: WindowState = {\n\t\tfocused: true\n\t};\n\n\tprivate _proxy: MainThreadWindowShape;\n\n\tprivate readonly _onDidChangeWindowState = new Emitter<WindowState>();\n\treadonly onDidChangeWindowState: Event<WindowState> = this._onDidChangeWindowState.event;\n\n\tprivate _state = ExtHostWindow.InitialState;\n\tget state(): WindowState { return this._state; }\n\n\tconstructor(@IExtHostRpcService extHostRpc: IExtHostRpcService) {\n\t\tthis._proxy = extHostRpc.getProxy(MainContext.MainThreadWindow);\n\t\tthis._proxy.$getWindowVisibility().then(isFocused => this.$onDidChangeWindowFocus(isFocused));\n\t}\n\n\t$onDidChangeWindowFocus(focused: boolean): void {\n\t\tif (focused === this._state.focused) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._state = { ...this._state, focused };\n\t\tthis._onDidChangeWindowState.fire(this._state);\n\t}\n\n\topenUri(stringOrUri: string | URI, options: IOpenUriOptions): Promise<boolean> {\n\t\tlet uriAsString: string | undefined;\n\t\tif (typeof stringOrUri === 'string') {\n\t\t\turiAsString = stringOrUri;\n\t\t\ttry {\n\t\t\t\tstringOrUri = URI.parse(stringOrUri);\n\t\t\t} catch (e) {\n\t\t\t\treturn Promise.reject(`Invalid uri - '${stringOrUri}'`);\n\t\t\t}\n\t\t}\n\t\tif (isFalsyOrWhitespace(stringOrUri.scheme)) {\n\t\t\treturn Promise.reject('Invalid scheme - cannot be empty');\n\t\t} else if (stringOrUri.scheme === Schemas.command) {\n\t\t\treturn Promise.reject(`Invalid scheme '${stringOrUri.scheme}'`);\n\t\t}\n\t\treturn this._proxy.$openUri(stringOrUri, uriAsString, options);\n\t}\n\n\tasync asExternalUri(uri: URI, options: IOpenUriOptions): Promise<URI> {\n\t\tif (isFalsyOrWhitespace(uri.scheme)) {\n\t\t\treturn Promise.reject('Invalid scheme - cannot be empty');\n\t\t}\n\n\t\tconst result = await this._proxy.$asExternalUri(uri, options);\n\t\treturn URI.from(result);\n\t}\n}\n\nexport const IExtHostWindow = createDecorator<IExtHostWindow>('IExtHostWindow');\nexport interface IExtHostWindow extends ExtHostWindow, ExtHostWindowShape { }\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { AbstractExtHostConsoleForwarder } from 'vs/workbench/api/common/extHostConsoleForwarder';\nimport { IExtHostInitDataService } from 'vs/workbench/api/common/extHostInitDataService';\nimport { IExtHostRpcService } from 'vs/workbench/api/common/extHostRpcService';\n\nexport class ExtHostConsoleForwarder extends AbstractExtHostConsoleForwarder {\n\n\tconstructor(\n\t\t@IExtHostRpcService extHostRpc: IExtHostRpcService,\n\t\t@IExtHostInitDataService initData: IExtHostInitDataService,\n\t) {\n\t\tsuper(extHostRpc, initData);\n\t}\n\n\tprotected override _nativeConsoleLogMessage(method: 'log' | 'info' | 'warn' | 'error', original: (...args: any[]) => void, args: IArguments) {\n\t\toriginal.apply(console, args as any);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { RunOnceScheduler } from 'vs/base/common/async';\nimport { VSBuffer } from 'vs/base/common/buffer';\nimport { CancellationToken, CancellationTokenSource } from 'vs/base/common/cancellation';\nimport { CharCode } from 'vs/base/common/charCode';\nimport * as errors from 'vs/base/common/errors';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { Disposable } from 'vs/base/common/lifecycle';\nimport { MarshalledObject } from 'vs/base/common/marshalling';\nimport { MarshalledId } from 'vs/base/common/marshallingIds';\nimport { IURITransformer, transformIncomingURIs } from 'vs/base/common/uriIpc';\nimport { IMessagePassingProtocol } from 'vs/base/parts/ipc/common/ipc';\nimport { CanceledLazyPromise, LazyPromise } from 'vs/workbench/services/extensions/common/lazyPromise';\nimport { getStringIdentifierForProxy, IRPCProtocol, Proxied, ProxyIdentifier, SerializableObjectWithBuffers } from 'vs/workbench/services/extensions/common/proxyIdentifier';\n\nexport interface JSONStringifyReplacer {\n\t(key: string, value: any): any;\n}\n\nfunction safeStringify(obj: any, replacer: JSONStringifyReplacer | null): string {\n\ttry {\n\t\treturn JSON.stringify(obj, <(key: string, value: any) => any>replacer);\n\t} catch (err) {\n\t\treturn 'null';\n\t}\n}\n\nconst refSymbolName = '$$ref$$';\nconst undefinedRef = { [refSymbolName]: -1 } as const;\n\nclass StringifiedJsonWithBufferRefs {\n\tconstructor(\n\t\tpublic readonly jsonString: string,\n\t\tpublic readonly referencedBuffers: readonly VSBuffer[],\n\t) { }\n}\n\nexport function stringifyJsonWithBufferRefs<T>(obj: T, replacer: JSONStringifyReplacer | null = null, useSafeStringify = false): StringifiedJsonWithBufferRefs {\n\tconst foundBuffers: VSBuffer[] = [];\n\tconst serialized = (useSafeStringify ? safeStringify : JSON.stringify)(obj, (key, value) => {\n\t\tif (typeof value === 'undefined') {\n\t\t\treturn undefinedRef; // JSON.stringify normally converts 'undefined' to 'null'\n\t\t} else if (typeof value === 'object') {\n\t\t\tif (value instanceof VSBuffer) {\n\t\t\t\tconst bufferIndex = foundBuffers.push(value) - 1;\n\t\t\t\treturn { [refSymbolName]: bufferIndex };\n\t\t\t}\n\t\t\tif (replacer) {\n\t\t\t\treturn replacer(key, value);\n\t\t\t}\n\t\t}\n\t\treturn value;\n\t});\n\treturn {\n\t\tjsonString: serialized,\n\t\treferencedBuffers: foundBuffers\n\t};\n}\n\nexport function parseJsonAndRestoreBufferRefs(jsonString: string, buffers: readonly VSBuffer[], uriTransformer: IURITransformer | null): any {\n\treturn JSON.parse(jsonString, (_key, value) => {\n\t\tif (value) {\n\t\t\tconst ref = value[refSymbolName];\n\t\t\tif (typeof ref === 'number') {\n\t\t\t\treturn buffers[ref];\n\t\t\t}\n\n\t\t\tif (uriTransformer && (<MarshalledObject>value).$mid === MarshalledId.Uri) {\n\t\t\t\treturn uriTransformer.transformIncoming(value);\n\t\t\t}\n\t\t}\n\t\treturn value;\n\t});\n}\n\n\nfunction stringify(obj: any, replacer: JSONStringifyReplacer | null): string {\n\treturn JSON.stringify(obj, <(key: string, value: any) => any>replacer);\n}\n\nfunction createURIReplacer(transformer: IURITransformer | null): JSONStringifyReplacer | null {\n\tif (!transformer) {\n\t\treturn null;\n\t}\n\treturn (key: string, value: any): any => {\n\t\tif (value && value.$mid === MarshalledId.Uri) {\n\t\t\treturn transformer.transformOutgoing(value);\n\t\t}\n\t\treturn value;\n\t};\n}\n\nexport const enum RequestInitiator {\n\tLocalSide = 0,\n\tOtherSide = 1\n}\n\nexport const enum ResponsiveState {\n\tResponsive = 0,\n\tUnresponsive = 1\n}\n\nexport interface IRPCProtocolLogger {\n\tlogIncoming(msgLength: number, req: number, initiator: RequestInitiator, str: string, data?: any): void;\n\tlogOutgoing(msgLength: number, req: number, initiator: RequestInitiator, str: string, data?: any): void;\n}\n\nconst noop = () => { };\n\nconst _RPCProtocolSymbol = Symbol.for('rpcProtocol');\nconst _RPCProxySymbol = Symbol.for('rpcProxy');\n\nexport class RPCProtocol extends Disposable implements IRPCProtocol {\n\n\t[_RPCProtocolSymbol] = true;\n\n\tprivate static readonly UNRESPONSIVE_TIME = 3 * 1000; // 3s\n\n\tprivate readonly _onDidChangeResponsiveState: Emitter<ResponsiveState> = this._register(new Emitter<ResponsiveState>());\n\tpublic readonly onDidChangeResponsiveState: Event<ResponsiveState> = this._onDidChangeResponsiveState.event;\n\n\tprivate readonly _protocol: IMessagePassingProtocol;\n\tprivate readonly _logger: IRPCProtocolLogger | null;\n\tprivate readonly _uriTransformer: IURITransformer | null;\n\tprivate readonly _uriReplacer: JSONStringifyReplacer | null;\n\tprivate _isDisposed: boolean;\n\tprivate readonly _locals: any[];\n\tprivate readonly _proxies: any[];\n\tprivate _lastMessageId: number;\n\tprivate readonly _cancelInvokedHandlers: { [req: string]: () => void };\n\tprivate readonly _pendingRPCReplies: { [msgId: string]: LazyPromise };\n\tprivate _responsiveState: ResponsiveState;\n\tprivate _unacknowledgedCount: number;\n\tprivate _unresponsiveTime: number;\n\tprivate _asyncCheckUresponsive: RunOnceScheduler;\n\n\tconstructor(protocol: IMessagePassingProtocol, logger: IRPCProtocolLogger | null = null, transformer: IURITransformer | null = null) {\n\t\tsuper();\n\t\tthis._protocol = protocol;\n\t\tthis._logger = logger;\n\t\tthis._uriTransformer = transformer;\n\t\tthis._uriReplacer = createURIReplacer(this._uriTransformer);\n\t\tthis._isDisposed = false;\n\t\tthis._locals = [];\n\t\tthis._proxies = [];\n\t\tfor (let i = 0, len = ProxyIdentifier.count; i < len; i++) {\n\t\t\tthis._locals[i] = null;\n\t\t\tthis._proxies[i] = null;\n\t\t}\n\t\tthis._lastMessageId = 0;\n\t\tthis._cancelInvokedHandlers = Object.create(null);\n\t\tthis._pendingRPCReplies = {};\n\t\tthis._responsiveState = ResponsiveState.Responsive;\n\t\tthis._unacknowledgedCount = 0;\n\t\tthis._unresponsiveTime = 0;\n\t\tthis._asyncCheckUresponsive = this._register(new RunOnceScheduler(() => this._checkUnresponsive(), 1000));\n\t\tthis._protocol.onMessage((msg) => this._receiveOneMessage(msg));\n\t}\n\n\tpublic override dispose(): void {\n\t\tthis._isDisposed = true;\n\n\t\t// Release all outstanding promises with a canceled error\n\t\tObject.keys(this._pendingRPCReplies).forEach((msgId) => {\n\t\t\tconst pending = this._pendingRPCReplies[msgId];\n\t\t\tpending.resolveErr(errors.canceled());\n\t\t});\n\t}\n\n\tpublic drain(): Promise<void> {\n\t\tif (typeof this._protocol.drain === 'function') {\n\t\t\treturn this._protocol.drain();\n\t\t}\n\t\treturn Promise.resolve();\n\t}\n\n\tprivate _onWillSendRequest(req: number): void {\n\t\tif (this._unacknowledgedCount === 0) {\n\t\t\t// Since this is the first request we are sending in a while,\n\t\t\t// mark this moment as the start for the countdown to unresponsive time\n\t\t\tthis._unresponsiveTime = Date.now() + RPCProtocol.UNRESPONSIVE_TIME;\n\t\t}\n\t\tthis._unacknowledgedCount++;\n\t\tif (!this._asyncCheckUresponsive.isScheduled()) {\n\t\t\tthis._asyncCheckUresponsive.schedule();\n\t\t}\n\t}\n\n\tprivate _onDidReceiveAcknowledge(req: number): void {\n\t\t// The next possible unresponsive time is now + delta.\n\t\tthis._unresponsiveTime = Date.now() + RPCProtocol.UNRESPONSIVE_TIME;\n\t\tthis._unacknowledgedCount--;\n\t\tif (this._unacknowledgedCount === 0) {\n\t\t\t// No more need to check for unresponsive\n\t\t\tthis._asyncCheckUresponsive.cancel();\n\t\t}\n\t\t// The ext host is responsive!\n\t\tthis._setResponsiveState(ResponsiveState.Responsive);\n\t}\n\n\tprivate _checkUnresponsive(): void {\n\t\tif (this._unacknowledgedCount === 0) {\n\t\t\t// Not waiting for anything => cannot say if it is responsive or not\n\t\t\treturn;\n\t\t}\n\n\t\tif (Date.now() > this._unresponsiveTime) {\n\t\t\t// Unresponsive!!\n\t\t\tthis._setResponsiveState(ResponsiveState.Unresponsive);\n\t\t} else {\n\t\t\t// Not (yet) unresponsive, be sure to check again soon\n\t\t\tthis._asyncCheckUresponsive.schedule();\n\t\t}\n\t}\n\n\tprivate _setResponsiveState(newResponsiveState: ResponsiveState): void {\n\t\tif (this._responsiveState === newResponsiveState) {\n\t\t\t// no change\n\t\t\treturn;\n\t\t}\n\t\tthis._responsiveState = newResponsiveState;\n\t\tthis._onDidChangeResponsiveState.fire(this._responsiveState);\n\t}\n\n\tpublic get responsiveState(): ResponsiveState {\n\t\treturn this._responsiveState;\n\t}\n\n\tpublic transformIncomingURIs<T>(obj: T): T {\n\t\tif (!this._uriTransformer) {\n\t\t\treturn obj;\n\t\t}\n\t\treturn transformIncomingURIs(obj, this._uriTransformer);\n\t}\n\n\tpublic getProxy<T>(identifier: ProxyIdentifier<T>): Proxied<T> {\n\t\tconst { nid: rpcId, sid } = identifier;\n\t\tif (!this._proxies[rpcId]) {\n\t\t\tthis._proxies[rpcId] = this._createProxy(rpcId, sid);\n\t\t}\n\t\treturn this._proxies[rpcId];\n\t}\n\n\tprivate _createProxy<T>(rpcId: number, debugName: string): T {\n\t\tconst handler = {\n\t\t\tget: (target: any, name: PropertyKey) => {\n\t\t\t\tif (typeof name === 'string' && !target[name] && name.charCodeAt(0) === CharCode.DollarSign) {\n\t\t\t\t\ttarget[name] = (...myArgs: any[]) => {\n\t\t\t\t\t\treturn this._remoteCall(rpcId, name, myArgs);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tif (name === _RPCProxySymbol) {\n\t\t\t\t\treturn debugName;\n\t\t\t\t}\n\t\t\t\treturn target[name];\n\t\t\t}\n\t\t};\n\t\treturn new Proxy(Object.create(null), handler);\n\t}\n\n\tpublic set<T, R extends T>(identifier: ProxyIdentifier<T>, value: R): R {\n\t\tthis._locals[identifier.nid] = value;\n\t\treturn value;\n\t}\n\n\tpublic assertRegistered(identifiers: ProxyIdentifier<any>[]): void {\n\t\tfor (let i = 0, len = identifiers.length; i < len; i++) {\n\t\t\tconst identifier = identifiers[i];\n\t\t\tif (!this._locals[identifier.nid]) {\n\t\t\t\tthrow new Error(`Missing proxy instance ${identifier.sid}`);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _receiveOneMessage(rawmsg: VSBuffer): void {\n\t\tif (this._isDisposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst msgLength = rawmsg.byteLength;\n\t\tconst buff = MessageBuffer.read(rawmsg, 0);\n\t\tconst messageType = <MessageType>buff.readUInt8();\n\t\tconst req = buff.readUInt32();\n\n\t\tswitch (messageType) {\n\t\t\tcase MessageType.RequestJSONArgs:\n\t\t\tcase MessageType.RequestJSONArgsWithCancellation: {\n\t\t\t\tlet { rpcId, method, args } = MessageIO.deserializeRequestJSONArgs(buff);\n\t\t\t\tif (this._uriTransformer) {\n\t\t\t\t\targs = transformIncomingURIs(args, this._uriTransformer);\n\t\t\t\t}\n\t\t\t\tthis._receiveRequest(msgLength, req, rpcId, method, args, (messageType === MessageType.RequestJSONArgsWithCancellation));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase MessageType.RequestMixedArgs:\n\t\t\tcase MessageType.RequestMixedArgsWithCancellation: {\n\t\t\t\tlet { rpcId, method, args } = MessageIO.deserializeRequestMixedArgs(buff);\n\t\t\t\tif (this._uriTransformer) {\n\t\t\t\t\targs = transformIncomingURIs(args, this._uriTransformer);\n\t\t\t\t}\n\t\t\t\tthis._receiveRequest(msgLength, req, rpcId, method, args, (messageType === MessageType.RequestMixedArgsWithCancellation));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase MessageType.Acknowledged: {\n\t\t\t\tthis._logger?.logIncoming(msgLength, req, RequestInitiator.LocalSide, `ack`);\n\t\t\t\tthis._onDidReceiveAcknowledge(req);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase MessageType.Cancel: {\n\t\t\t\tthis._receiveCancel(msgLength, req);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase MessageType.ReplyOKEmpty: {\n\t\t\t\tthis._receiveReply(msgLength, req, undefined);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase MessageType.ReplyOKJSON: {\n\t\t\t\tlet value = MessageIO.deserializeReplyOKJSON(buff);\n\t\t\t\tif (this._uriTransformer) {\n\t\t\t\t\tvalue = transformIncomingURIs(value, this._uriTransformer);\n\t\t\t\t}\n\t\t\t\tthis._receiveReply(msgLength, req, value);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase MessageType.ReplyOKJSONWithBuffers: {\n\t\t\t\tconst value = MessageIO.deserializeReplyOKJSONWithBuffers(buff, this._uriTransformer);\n\t\t\t\tthis._receiveReply(msgLength, req, value);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase MessageType.ReplyOKVSBuffer: {\n\t\t\t\tconst value = MessageIO.deserializeReplyOKVSBuffer(buff);\n\t\t\t\tthis._receiveReply(msgLength, req, value);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase MessageType.ReplyErrError: {\n\t\t\t\tlet err = MessageIO.deserializeReplyErrError(buff);\n\t\t\t\tif (this._uriTransformer) {\n\t\t\t\t\terr = transformIncomingURIs(err, this._uriTransformer);\n\t\t\t\t}\n\t\t\t\tthis._receiveReplyErr(msgLength, req, err);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase MessageType.ReplyErrEmpty: {\n\t\t\t\tthis._receiveReplyErr(msgLength, req, undefined);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdefault:\n\t\t\t\tconsole.error(`received unexpected message`);\n\t\t\t\tconsole.error(rawmsg);\n\t\t}\n\t}\n\n\tprivate _receiveRequest(msgLength: number, req: number, rpcId: number, method: string, args: any[], usesCancellationToken: boolean): void {\n\t\tthis._logger?.logIncoming(msgLength, req, RequestInitiator.OtherSide, `receiveRequest ${getStringIdentifierForProxy(rpcId)}.${method}(`, args);\n\t\tconst callId = String(req);\n\n\t\tlet promise: Promise<any>;\n\t\tlet cancel: () => void;\n\t\tif (usesCancellationToken) {\n\t\t\tconst cancellationTokenSource = new CancellationTokenSource();\n\t\t\targs.push(cancellationTokenSource.token);\n\t\t\tpromise = this._invokeHandler(rpcId, method, args);\n\t\t\tcancel = () => cancellationTokenSource.cancel();\n\t\t} else {\n\t\t\t// cannot be cancelled\n\t\t\tpromise = this._invokeHandler(rpcId, method, args);\n\t\t\tcancel = noop;\n\t\t}\n\n\t\tthis._cancelInvokedHandlers[callId] = cancel;\n\n\t\t// Acknowledge the request\n\t\tconst msg = MessageIO.serializeAcknowledged(req);\n\t\tthis._logger?.logOutgoing(msg.byteLength, req, RequestInitiator.OtherSide, `ack`);\n\t\tthis._protocol.send(msg);\n\n\t\tpromise.then((r) => {\n\t\t\tdelete this._cancelInvokedHandlers[callId];\n\t\t\tconst msg = MessageIO.serializeReplyOK(req, r, this._uriReplacer);\n\t\t\tthis._logger?.logOutgoing(msg.byteLength, req, RequestInitiator.OtherSide, `reply:`, r);\n\t\t\tthis._protocol.send(msg);\n\t\t}, (err) => {\n\t\t\tdelete this._cancelInvokedHandlers[callId];\n\t\t\tconst msg = MessageIO.serializeReplyErr(req, err);\n\t\t\tthis._logger?.logOutgoing(msg.byteLength, req, RequestInitiator.OtherSide, `replyErr:`, err);\n\t\t\tthis._protocol.send(msg);\n\t\t});\n\t}\n\n\tprivate _receiveCancel(msgLength: number, req: number): void {\n\t\tthis._logger?.logIncoming(msgLength, req, RequestInitiator.OtherSide, `receiveCancel`);\n\t\tconst callId = String(req);\n\t\tthis._cancelInvokedHandlers[callId]?.();\n\t}\n\n\tprivate _receiveReply(msgLength: number, req: number, value: any): void {\n\t\tthis._logger?.logIncoming(msgLength, req, RequestInitiator.LocalSide, `receiveReply:`, value);\n\t\tconst callId = String(req);\n\t\tif (!this._pendingRPCReplies.hasOwnProperty(callId)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst pendingReply = this._pendingRPCReplies[callId];\n\t\tdelete this._pendingRPCReplies[callId];\n\n\t\tpendingReply.resolveOk(value);\n\t}\n\n\tprivate _receiveReplyErr(msgLength: number, req: number, value: any): void {\n\t\tthis._logger?.logIncoming(msgLength, req, RequestInitiator.LocalSide, `receiveReplyErr:`, value);\n\n\t\tconst callId = String(req);\n\t\tif (!this._pendingRPCReplies.hasOwnProperty(callId)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst pendingReply = this._pendingRPCReplies[callId];\n\t\tdelete this._pendingRPCReplies[callId];\n\n\t\tlet err: any = undefined;\n\t\tif (value) {\n\t\t\tif (value.$isError) {\n\t\t\t\terr = new Error();\n\t\t\t\terr.name = value.name;\n\t\t\t\terr.message = value.message;\n\t\t\t\terr.stack = value.stack;\n\t\t\t} else {\n\t\t\t\terr = value;\n\t\t\t}\n\t\t}\n\t\tpendingReply.resolveErr(err);\n\t}\n\n\tprivate _invokeHandler(rpcId: number, methodName: string, args: any[]): Promise<any> {\n\t\ttry {\n\t\t\treturn Promise.resolve(this._doInvokeHandler(rpcId, methodName, args));\n\t\t} catch (err) {\n\t\t\treturn Promise.reject(err);\n\t\t}\n\t}\n\n\tprivate _doInvokeHandler(rpcId: number, methodName: string, args: any[]): any {\n\t\tconst actor = this._locals[rpcId];\n\t\tif (!actor) {\n\t\t\tthrow new Error('Unknown actor ' + getStringIdentifierForProxy(rpcId));\n\t\t}\n\t\tconst method = actor[methodName];\n\t\tif (typeof method !== 'function') {\n\t\t\tthrow new Error('Unknown method ' + methodName + ' on actor ' + getStringIdentifierForProxy(rpcId));\n\t\t}\n\t\treturn method.apply(actor, args);\n\t}\n\n\tprivate _remoteCall(rpcId: number, methodName: string, args: any[]): Promise<any> {\n\t\tif (this._isDisposed) {\n\t\t\treturn new CanceledLazyPromise();\n\t\t}\n\t\tlet cancellationToken: CancellationToken | null = null;\n\t\tif (args.length > 0 && CancellationToken.isCancellationToken(args[args.length - 1])) {\n\t\t\tcancellationToken = args.pop();\n\t\t}\n\n\t\tif (cancellationToken && cancellationToken.isCancellationRequested) {\n\t\t\t// No need to do anything...\n\t\t\treturn Promise.reject<any>(errors.canceled());\n\t\t}\n\n\t\tconst serializedRequestArguments = MessageIO.serializeRequestArguments(args, this._uriReplacer);\n\n\t\tconst req = ++this._lastMessageId;\n\t\tconst callId = String(req);\n\t\tconst result = new LazyPromise();\n\n\t\tif (cancellationToken) {\n\t\t\tcancellationToken.onCancellationRequested(() => {\n\t\t\t\tconst msg = MessageIO.serializeCancel(req);\n\t\t\t\tthis._logger?.logOutgoing(msg.byteLength, req, RequestInitiator.LocalSide, `cancel`);\n\t\t\t\tthis._protocol.send(MessageIO.serializeCancel(req));\n\t\t\t});\n\t\t}\n\n\t\tthis._pendingRPCReplies[callId] = result;\n\t\tthis._onWillSendRequest(req);\n\t\tconst msg = MessageIO.serializeRequest(req, rpcId, methodName, serializedRequestArguments, !!cancellationToken);\n\t\tthis._logger?.logOutgoing(msg.byteLength, req, RequestInitiator.LocalSide, `request: ${getStringIdentifierForProxy(rpcId)}.${methodName}(`, args);\n\t\tthis._protocol.send(msg);\n\t\treturn result;\n\t}\n}\n\nclass MessageBuffer {\n\n\tpublic static alloc(type: MessageType, req: number, messageSize: number): MessageBuffer {\n\t\tconst result = new MessageBuffer(VSBuffer.alloc(messageSize + 1 /* type */ + 4 /* req */), 0);\n\t\tresult.writeUInt8(type);\n\t\tresult.writeUInt32(req);\n\t\treturn result;\n\t}\n\n\tpublic static read(buff: VSBuffer, offset: number): MessageBuffer {\n\t\treturn new MessageBuffer(buff, offset);\n\t}\n\n\tprivate _buff: VSBuffer;\n\tprivate _offset: number;\n\n\tpublic get buffer(): VSBuffer {\n\t\treturn this._buff;\n\t}\n\n\tprivate constructor(buff: VSBuffer, offset: number) {\n\t\tthis._buff = buff;\n\t\tthis._offset = offset;\n\t}\n\n\tpublic static sizeUInt8(): number {\n\t\treturn 1;\n\t}\n\n\tpublic static readonly sizeUInt32 = 4;\n\n\tpublic writeUInt8(n: number): void {\n\t\tthis._buff.writeUInt8(n, this._offset); this._offset += 1;\n\t}\n\n\tpublic readUInt8(): number {\n\t\tconst n = this._buff.readUInt8(this._offset); this._offset += 1;\n\t\treturn n;\n\t}\n\n\tpublic writeUInt32(n: number): void {\n\t\tthis._buff.writeUInt32BE(n, this._offset); this._offset += 4;\n\t}\n\n\tpublic readUInt32(): number {\n\t\tconst n = this._buff.readUInt32BE(this._offset); this._offset += 4;\n\t\treturn n;\n\t}\n\n\tpublic static sizeShortString(str: VSBuffer): number {\n\t\treturn 1 /* string length */ + str.byteLength /* actual string */;\n\t}\n\n\tpublic writeShortString(str: VSBuffer): void {\n\t\tthis._buff.writeUInt8(str.byteLength, this._offset); this._offset += 1;\n\t\tthis._buff.set(str, this._offset); this._offset += str.byteLength;\n\t}\n\n\tpublic readShortString(): string {\n\t\tconst strByteLength = this._buff.readUInt8(this._offset); this._offset += 1;\n\t\tconst strBuff = this._buff.slice(this._offset, this._offset + strByteLength);\n\t\tconst str = strBuff.toString(); this._offset += strByteLength;\n\t\treturn str;\n\t}\n\n\tpublic static sizeLongString(str: VSBuffer): number {\n\t\treturn 4 /* string length */ + str.byteLength /* actual string */;\n\t}\n\n\tpublic writeLongString(str: VSBuffer): void {\n\t\tthis._buff.writeUInt32BE(str.byteLength, this._offset); this._offset += 4;\n\t\tthis._buff.set(str, this._offset); this._offset += str.byteLength;\n\t}\n\n\tpublic readLongString(): string {\n\t\tconst strByteLength = this._buff.readUInt32BE(this._offset); this._offset += 4;\n\t\tconst strBuff = this._buff.slice(this._offset, this._offset + strByteLength);\n\t\tconst str = strBuff.toString(); this._offset += strByteLength;\n\t\treturn str;\n\t}\n\n\tpublic writeBuffer(buff: VSBuffer): void {\n\t\tthis._buff.writeUInt32BE(buff.byteLength, this._offset); this._offset += 4;\n\t\tthis._buff.set(buff, this._offset); this._offset += buff.byteLength;\n\t}\n\n\tpublic static sizeVSBuffer(buff: VSBuffer): number {\n\t\treturn 4 /* buffer length */ + buff.byteLength /* actual buffer */;\n\t}\n\n\tpublic writeVSBuffer(buff: VSBuffer): void {\n\t\tthis._buff.writeUInt32BE(buff.byteLength, this._offset); this._offset += 4;\n\t\tthis._buff.set(buff, this._offset); this._offset += buff.byteLength;\n\t}\n\n\tpublic readVSBuffer(): VSBuffer {\n\t\tconst buffLength = this._buff.readUInt32BE(this._offset); this._offset += 4;\n\t\tconst buff = this._buff.slice(this._offset, this._offset + buffLength); this._offset += buffLength;\n\t\treturn buff;\n\t}\n\n\tpublic static sizeMixedArray(arr: readonly MixedArg[]): number {\n\t\tlet size = 0;\n\t\tsize += 1; // arr length\n\t\tfor (let i = 0, len = arr.length; i < len; i++) {\n\t\t\tconst el = arr[i];\n\t\t\tsize += 1; // arg type\n\t\t\tswitch (el.type) {\n\t\t\t\tcase ArgType.String:\n\t\t\t\t\tsize += this.sizeLongString(el.value);\n\t\t\t\t\tbreak;\n\t\t\t\tcase ArgType.VSBuffer:\n\t\t\t\t\tsize += this.sizeVSBuffer(el.value);\n\t\t\t\t\tbreak;\n\t\t\t\tcase ArgType.SerializedObjectWithBuffers:\n\t\t\t\t\tsize += this.sizeUInt32; // buffer count\n\t\t\t\t\tsize += this.sizeLongString(el.value);\n\t\t\t\t\tfor (let i = 0; i < el.buffers.length; ++i) {\n\t\t\t\t\t\tsize += this.sizeVSBuffer(el.buffers[i]);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase ArgType.Undefined:\n\t\t\t\t\t// empty...\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn size;\n\t}\n\n\tpublic writeMixedArray(arr: readonly MixedArg[]): void {\n\t\tthis._buff.writeUInt8(arr.length, this._offset); this._offset += 1;\n\t\tfor (let i = 0, len = arr.length; i < len; i++) {\n\t\t\tconst el = arr[i];\n\t\t\tswitch (el.type) {\n\t\t\t\tcase ArgType.String:\n\t\t\t\t\tthis.writeUInt8(ArgType.String);\n\t\t\t\t\tthis.writeLongString(el.value);\n\t\t\t\t\tbreak;\n\t\t\t\tcase ArgType.VSBuffer:\n\t\t\t\t\tthis.writeUInt8(ArgType.VSBuffer);\n\t\t\t\t\tthis.writeVSBuffer(el.value);\n\t\t\t\t\tbreak;\n\t\t\t\tcase ArgType.SerializedObjectWithBuffers:\n\t\t\t\t\tthis.writeUInt8(ArgType.SerializedObjectWithBuffers);\n\t\t\t\t\tthis.writeUInt32(el.buffers.length);\n\t\t\t\t\tthis.writeLongString(el.value);\n\t\t\t\t\tfor (let i = 0; i < el.buffers.length; ++i) {\n\t\t\t\t\t\tthis.writeBuffer(el.buffers[i]);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase ArgType.Undefined:\n\t\t\t\t\tthis.writeUInt8(ArgType.Undefined);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic readMixedArray(): Array<string | VSBuffer | SerializableObjectWithBuffers<any> | undefined> {\n\t\tconst arrLen = this._buff.readUInt8(this._offset); this._offset += 1;\n\t\tconst arr: Array<string | VSBuffer | SerializableObjectWithBuffers<any> | undefined> = new Array(arrLen);\n\t\tfor (let i = 0; i < arrLen; i++) {\n\t\t\tconst argType = <ArgType>this.readUInt8();\n\t\t\tswitch (argType) {\n\t\t\t\tcase ArgType.String:\n\t\t\t\t\tarr[i] = this.readLongString();\n\t\t\t\t\tbreak;\n\t\t\t\tcase ArgType.VSBuffer:\n\t\t\t\t\tarr[i] = this.readVSBuffer();\n\t\t\t\t\tbreak;\n\t\t\t\tcase ArgType.SerializedObjectWithBuffers: {\n\t\t\t\t\tconst bufferCount = this.readUInt32();\n\t\t\t\t\tconst jsonString = this.readLongString();\n\t\t\t\t\tconst buffers: VSBuffer[] = [];\n\t\t\t\t\tfor (let i = 0; i < bufferCount; ++i) {\n\t\t\t\t\t\tbuffers.push(this.readVSBuffer());\n\t\t\t\t\t}\n\t\t\t\t\tarr[i] = new SerializableObjectWithBuffers(parseJsonAndRestoreBufferRefs(jsonString, buffers, null));\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase ArgType.Undefined:\n\t\t\t\t\tarr[i] = undefined;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn arr;\n\t}\n}\n\nconst enum SerializedRequestArgumentType {\n\tSimple,\n\tMixed,\n}\n\ntype SerializedRequestArguments =\n\t| { readonly type: SerializedRequestArgumentType.Simple; args: string }\n\t| { readonly type: SerializedRequestArgumentType.Mixed; args: MixedArg[] };\n\n\nclass MessageIO {\n\n\tprivate static _useMixedArgSerialization(arr: any[]): boolean {\n\t\tfor (let i = 0, len = arr.length; i < len; i++) {\n\t\t\tif (arr[i] instanceof VSBuffer) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif (arr[i] instanceof SerializableObjectWithBuffers) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif (typeof arr[i] === 'undefined') {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic static serializeRequestArguments(args: any[], replacer: JSONStringifyReplacer | null): SerializedRequestArguments {\n\t\tif (this._useMixedArgSerialization(args)) {\n\t\t\tconst massagedArgs: MixedArg[] = [];\n\t\t\tfor (let i = 0, len = args.length; i < len; i++) {\n\t\t\t\tconst arg = args[i];\n\t\t\t\tif (arg instanceof VSBuffer) {\n\t\t\t\t\tmassagedArgs[i] = { type: ArgType.VSBuffer, value: arg };\n\t\t\t\t} else if (typeof arg === 'undefined') {\n\t\t\t\t\tmassagedArgs[i] = { type: ArgType.Undefined };\n\t\t\t\t} else if (arg instanceof SerializableObjectWithBuffers) {\n\t\t\t\t\tconst { jsonString, referencedBuffers } = stringifyJsonWithBufferRefs(arg.value, replacer);\n\t\t\t\t\tmassagedArgs[i] = { type: ArgType.SerializedObjectWithBuffers, value: VSBuffer.fromString(jsonString), buffers: referencedBuffers };\n\t\t\t\t} else {\n\t\t\t\t\tmassagedArgs[i] = { type: ArgType.String, value: VSBuffer.fromString(stringify(arg, replacer)) };\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn {\n\t\t\t\ttype: SerializedRequestArgumentType.Mixed,\n\t\t\t\targs: massagedArgs,\n\t\t\t};\n\t\t}\n\t\treturn {\n\t\t\ttype: SerializedRequestArgumentType.Simple,\n\t\t\targs: stringify(args, replacer)\n\t\t};\n\t}\n\n\tpublic static serializeRequest(req: number, rpcId: number, method: string, serializedArgs: SerializedRequestArguments, usesCancellationToken: boolean): VSBuffer {\n\t\tswitch (serializedArgs.type) {\n\t\t\tcase SerializedRequestArgumentType.Simple:\n\t\t\t\treturn this._requestJSONArgs(req, rpcId, method, serializedArgs.args, usesCancellationToken);\n\t\t\tcase SerializedRequestArgumentType.Mixed:\n\t\t\t\treturn this._requestMixedArgs(req, rpcId, method, serializedArgs.args, usesCancellationToken);\n\t\t}\n\t}\n\n\tprivate static _requestJSONArgs(req: number, rpcId: number, method: string, args: string, usesCancellationToken: boolean): VSBuffer {\n\t\tconst methodBuff = VSBuffer.fromString(method);\n\t\tconst argsBuff = VSBuffer.fromString(args);\n\n\t\tlet len = 0;\n\t\tlen += MessageBuffer.sizeUInt8();\n\t\tlen += MessageBuffer.sizeShortString(methodBuff);\n\t\tlen += MessageBuffer.sizeLongString(argsBuff);\n\n\t\tconst result = MessageBuffer.alloc(usesCancellationToken ? MessageType.RequestJSONArgsWithCancellation : MessageType.RequestJSONArgs, req, len);\n\t\tresult.writeUInt8(rpcId);\n\t\tresult.writeShortString(methodBuff);\n\t\tresult.writeLongString(argsBuff);\n\t\treturn result.buffer;\n\t}\n\n\tpublic static deserializeRequestJSONArgs(buff: MessageBuffer): { rpcId: number; method: string; args: any[] } {\n\t\tconst rpcId = buff.readUInt8();\n\t\tconst method = buff.readShortString();\n\t\tconst args = buff.readLongString();\n\t\treturn {\n\t\t\trpcId: rpcId,\n\t\t\tmethod: method,\n\t\t\targs: JSON.parse(args)\n\t\t};\n\t}\n\n\tprivate static _requestMixedArgs(req: number, rpcId: number, method: string, args: readonly MixedArg[], usesCancellationToken: boolean): VSBuffer {\n\t\tconst methodBuff = VSBuffer.fromString(method);\n\n\t\tlet len = 0;\n\t\tlen += MessageBuffer.sizeUInt8();\n\t\tlen += MessageBuffer.sizeShortString(methodBuff);\n\t\tlen += MessageBuffer.sizeMixedArray(args);\n\n\t\tconst result = MessageBuffer.alloc(usesCancellationToken ? MessageType.RequestMixedArgsWithCancellation : MessageType.RequestMixedArgs, req, len);\n\t\tresult.writeUInt8(rpcId);\n\t\tresult.writeShortString(methodBuff);\n\t\tresult.writeMixedArray(args);\n\t\treturn result.buffer;\n\t}\n\n\tpublic static deserializeRequestMixedArgs(buff: MessageBuffer): { rpcId: number; method: string; args: any[] } {\n\t\tconst rpcId = buff.readUInt8();\n\t\tconst method = buff.readShortString();\n\t\tconst rawargs = buff.readMixedArray();\n\t\tconst args: any[] = new Array(rawargs.length);\n\t\tfor (let i = 0, len = rawargs.length; i < len; i++) {\n\t\t\tconst rawarg = rawargs[i];\n\t\t\tif (typeof rawarg === 'string') {\n\t\t\t\targs[i] = JSON.parse(rawarg);\n\t\t\t} else {\n\t\t\t\targs[i] = rawarg;\n\t\t\t}\n\t\t}\n\t\treturn {\n\t\t\trpcId: rpcId,\n\t\t\tmethod: method,\n\t\t\targs: args\n\t\t};\n\t}\n\n\tpublic static serializeAcknowledged(req: number): VSBuffer {\n\t\treturn MessageBuffer.alloc(MessageType.Acknowledged, req, 0).buffer;\n\t}\n\n\tpublic static serializeCancel(req: number): VSBuffer {\n\t\treturn MessageBuffer.alloc(MessageType.Cancel, req, 0).buffer;\n\t}\n\n\tpublic static serializeReplyOK(req: number, res: any, replacer: JSONStringifyReplacer | null): VSBuffer {\n\t\tif (typeof res === 'undefined') {\n\t\t\treturn this._serializeReplyOKEmpty(req);\n\t\t} else if (res instanceof VSBuffer) {\n\t\t\treturn this._serializeReplyOKVSBuffer(req, res);\n\t\t} else if (res instanceof SerializableObjectWithBuffers) {\n\t\t\tconst { jsonString, referencedBuffers } = stringifyJsonWithBufferRefs(res.value, replacer, true);\n\t\t\treturn this._serializeReplyOKJSONWithBuffers(req, jsonString, referencedBuffers);\n\t\t} else {\n\t\t\treturn this._serializeReplyOKJSON(req, safeStringify(res, replacer));\n\t\t}\n\t}\n\n\tprivate static _serializeReplyOKEmpty(req: number): VSBuffer {\n\t\treturn MessageBuffer.alloc(MessageType.ReplyOKEmpty, req, 0).buffer;\n\t}\n\n\tprivate static _serializeReplyOKVSBuffer(req: number, res: VSBuffer): VSBuffer {\n\t\tlet len = 0;\n\t\tlen += MessageBuffer.sizeVSBuffer(res);\n\n\t\tconst result = MessageBuffer.alloc(MessageType.ReplyOKVSBuffer, req, len);\n\t\tresult.writeVSBuffer(res);\n\t\treturn result.buffer;\n\t}\n\n\tpublic static deserializeReplyOKVSBuffer(buff: MessageBuffer): VSBuffer {\n\t\treturn buff.readVSBuffer();\n\t}\n\n\tprivate static _serializeReplyOKJSON(req: number, res: string): VSBuffer {\n\t\tconst resBuff = VSBuffer.fromString(res);\n\n\t\tlet len = 0;\n\t\tlen += MessageBuffer.sizeLongString(resBuff);\n\n\t\tconst result = MessageBuffer.alloc(MessageType.ReplyOKJSON, req, len);\n\t\tresult.writeLongString(resBuff);\n\t\treturn result.buffer;\n\t}\n\n\tprivate static _serializeReplyOKJSONWithBuffers(req: number, res: string, buffers: readonly VSBuffer[]): VSBuffer {\n\t\tconst resBuff = VSBuffer.fromString(res);\n\n\t\tlet len = 0;\n\t\tlen += MessageBuffer.sizeUInt32; // buffer count\n\t\tlen += MessageBuffer.sizeLongString(resBuff);\n\t\tfor (const buffer of buffers) {\n\t\t\tlen += MessageBuffer.sizeVSBuffer(buffer);\n\t\t}\n\n\t\tconst result = MessageBuffer.alloc(MessageType.ReplyOKJSONWithBuffers, req, len);\n\t\tresult.writeUInt32(buffers.length);\n\t\tresult.writeLongString(resBuff);\n\t\tfor (const buffer of buffers) {\n\t\t\tresult.writeBuffer(buffer);\n\t\t}\n\n\t\treturn result.buffer;\n\t}\n\n\tpublic static deserializeReplyOKJSON(buff: MessageBuffer): any {\n\t\tconst res = buff.readLongString();\n\t\treturn JSON.parse(res);\n\t}\n\n\tpublic static deserializeReplyOKJSONWithBuffers(buff: MessageBuffer, uriTransformer: IURITransformer | null): SerializableObjectWithBuffers<any> {\n\t\tconst bufferCount = buff.readUInt32();\n\t\tconst res = buff.readLongString();\n\n\t\tconst buffers: VSBuffer[] = [];\n\t\tfor (let i = 0; i < bufferCount; ++i) {\n\t\t\tbuffers.push(buff.readVSBuffer());\n\t\t}\n\n\t\treturn new SerializableObjectWithBuffers(parseJsonAndRestoreBufferRefs(res, buffers, uriTransformer));\n\t}\n\n\tpublic static serializeReplyErr(req: number, err: any): VSBuffer {\n\t\tconst errStr: string | undefined = (err ? safeStringify(errors.transformErrorForSerialization(err), null) : undefined);\n\t\tif (typeof errStr !== 'string') {\n\t\t\treturn this._serializeReplyErrEmpty(req);\n\t\t}\n\t\tconst errBuff = VSBuffer.fromString(errStr);\n\n\t\tlet len = 0;\n\t\tlen += MessageBuffer.sizeLongString(errBuff);\n\n\t\tconst result = MessageBuffer.alloc(MessageType.ReplyErrError, req, len);\n\t\tresult.writeLongString(errBuff);\n\t\treturn result.buffer;\n\t}\n\n\tpublic static deserializeReplyErrError(buff: MessageBuffer): Error {\n\t\tconst err = buff.readLongString();\n\t\treturn JSON.parse(err);\n\t}\n\n\tprivate static _serializeReplyErrEmpty(req: number): VSBuffer {\n\t\treturn MessageBuffer.alloc(MessageType.ReplyErrEmpty, req, 0).buffer;\n\t}\n}\n\nconst enum MessageType {\n\tRequestJSONArgs = 1,\n\tRequestJSONArgsWithCancellation = 2,\n\tRequestMixedArgs = 3,\n\tRequestMixedArgsWithCancellation = 4,\n\tAcknowledged = 5,\n\tCancel = 6,\n\tReplyOKEmpty = 7,\n\tReplyOKVSBuffer = 8,\n\tReplyOKJSON = 9,\n\tReplyOKJSONWithBuffers = 10,\n\tReplyErrError = 11,\n\tReplyErrEmpty = 12,\n}\n\nconst enum ArgType {\n\tString = 1,\n\tVSBuffer = 2,\n\tSerializedObjectWithBuffers = 3,\n\tUndefined = 4,\n}\n\n\ntype MixedArg =\n\t| { readonly type: ArgType.String; readonly value: VSBuffer }\n\t| { readonly type: ArgType.VSBuffer; readonly value: VSBuffer }\n\t| { readonly type: ArgType.SerializedObjectWithBuffers; readonly value: VSBuffer; readonly buffers: readonly VSBuffer[] }\n\t| { readonly type: ArgType.Undefined }\n\t;\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { NewWorkerMessage, TerminateWorkerMessage } from 'vs/workbench/services/extensions/common/polyfillNestedWorker.protocol';\n\ndeclare function postMessage(data: any, transferables?: Transferable[]): void;\n\ndeclare type MessageEventHandler = ((ev: MessageEvent<any>) => any) | null;\n\nconst _bootstrapFnSource = (function _bootstrapFn(workerUrl: string) {\n\n\tconst listener: EventListener = (event: Event): void => {\n\t\t// uninstall handler\n\t\tself.removeEventListener('message', listener);\n\n\t\t// get data\n\t\tconst port = <MessagePort>(<MessageEvent>event).data;\n\n\t\t// postMessage\n\t\t// onmessage\n\t\tObject.defineProperties(self, {\n\t\t\t'postMessage': {\n\t\t\t\tvalue(data: any, transferOrOptions?: any) {\n\t\t\t\t\tport.postMessage(data, transferOrOptions);\n\t\t\t\t}\n\t\t\t},\n\t\t\t'onmessage': {\n\t\t\t\tget() {\n\t\t\t\t\treturn port.onmessage;\n\t\t\t\t},\n\t\t\t\tset(value: MessageEventHandler) {\n\t\t\t\t\tport.onmessage = value;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// todo onerror\n\t\t});\n\n\t\tport.addEventListener('message', msg => {\n\t\t\tself.dispatchEvent(new MessageEvent('message', { data: msg.data }));\n\t\t});\n\n\t\tport.start();\n\n\t\t// fake recursively nested worker\n\t\tself.Worker = <any>class { constructor() { throw new TypeError('Nested workers from within nested worker are NOT supported.'); } };\n\n\t\t// load module\n\t\timportScripts(workerUrl);\n\t};\n\n\tself.addEventListener('message', listener);\n}).toString();\n\n\nexport class NestedWorker extends EventTarget implements Worker {\n\n\tonmessage: ((this: Worker, ev: MessageEvent<any>) => any) | null = null;\n\tonmessageerror: ((this: Worker, ev: MessageEvent<any>) => any) | null = null;\n\tonerror: ((this: AbstractWorker, ev: ErrorEvent) => any) | null = null;\n\n\treadonly terminate: () => void;\n\treadonly postMessage: (message: any, options?: any) => void;\n\n\tconstructor(nativePostMessage: typeof postMessage, stringOrUrl: string | URL, options?: WorkerOptions) {\n\t\tsuper();\n\n\t\t// create bootstrap script\n\t\tconst bootstrap = `((${_bootstrapFnSource})('${stringOrUrl}'))`;\n\t\tconst blob = new Blob([bootstrap], { type: 'application/javascript' });\n\t\tconst blobUrl = URL.createObjectURL(blob);\n\n\t\tconst channel = new MessageChannel();\n\t\tconst id = blobUrl; // works because blob url is unique, needs ID pool otherwise\n\n\t\tconst msg: NewWorkerMessage = {\n\t\t\ttype: '_newWorker',\n\t\t\tid,\n\t\t\tport: channel.port2,\n\t\t\turl: blobUrl,\n\t\t\toptions,\n\t\t};\n\t\tnativePostMessage(msg, [channel.port2]);\n\n\t\t// worker-impl: functions\n\t\tthis.postMessage = channel.port1.postMessage.bind(channel.port1);\n\t\tthis.terminate = () => {\n\t\t\tconst msg: TerminateWorkerMessage = {\n\t\t\t\ttype: '_terminateWorker',\n\t\t\t\tid\n\t\t\t};\n\t\t\tnativePostMessage(msg);\n\t\t\tURL.revokeObjectURL(blobUrl);\n\n\t\t\tchannel.port1.close();\n\t\t\tchannel.port2.close();\n\t\t};\n\n\t\t// worker-impl: events\n\t\tObject.defineProperties(this, {\n\t\t\t'onmessage': {\n\t\t\t\tget() {\n\t\t\t\t\treturn channel.port1.onmessage;\n\t\t\t\t},\n\t\t\t\tset(value: MessageEventHandler) {\n\t\t\t\t\tchannel.port1.onmessage = value;\n\t\t\t\t}\n\t\t\t},\n\t\t\t'onmessageerror': {\n\t\t\t\tget() {\n\t\t\t\t\treturn channel.port1.onmessageerror;\n\t\t\t\t},\n\t\t\t\tset(value: MessageEventHandler) {\n\t\t\t\t\tchannel.port1.onmessageerror = value;\n\t\t\t\t}\n\t\t\t},\n\t\t\t// todo onerror\n\t\t});\n\n\t\tchannel.port1.addEventListener('messageerror', evt => {\n\t\t\tconst msgEvent = new MessageEvent('messageerror', { data: evt.data });\n\t\t\tthis.dispatchEvent(msgEvent);\n\t\t});\n\n\t\tchannel.port1.addEventListener('message', evt => {\n\t\t\tconst msgEvent = new MessageEvent('message', { data: evt.data });\n\t\t\tthis.dispatchEvent(msgEvent);\n\t\t});\n\n\t\tchannel.port1.start();\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Event, Emitter } from 'vs/base/common/event';\nimport { Registry } from 'vs/platform/registry/common/platform';\nimport { URI } from 'vs/base/common/uri';\nimport { RawContextKey } from 'vs/platform/contextkey/common/contextkey';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { IFileService, whenProviderRegistered } from 'vs/platform/files/common/files';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { CancellationError, getErrorMessage, isCancellationError } from 'vs/base/common/errors';\nimport { CancelablePromise, createCancelablePromise, timeout } from 'vs/base/common/async';\n\n/**\n * Mime type used by the output editor.\n */\nexport const OUTPUT_MIME = 'text/x-code-output';\n\n/**\n * Output resource scheme.\n */\nexport const OUTPUT_SCHEME = 'output';\n\n/**\n * Id used by the output editor.\n */\nexport const OUTPUT_MODE_ID = 'Log';\n\n/**\n * Mime type used by the log output editor.\n */\nexport const LOG_MIME = 'text/x-code-log-output';\n\n/**\n * Log resource scheme.\n */\nexport const LOG_SCHEME = 'log';\n\n/**\n * Id used by the log output editor.\n */\nexport const LOG_MODE_ID = 'log';\n\n/**\n * Output view id\n */\nexport const OUTPUT_VIEW_ID = 'workbench.panel.output';\n\nexport const OUTPUT_SERVICE_ID = 'outputService';\n\nexport const MAX_OUTPUT_LENGTH = 10000 /* Max. number of output lines to show in output */ * 100 /* Guestimated chars per line */;\n\nexport const CONTEXT_IN_OUTPUT = new RawContextKey<boolean>('inOutput', false);\n\nexport const CONTEXT_ACTIVE_LOG_OUTPUT = new RawContextKey<boolean>('activeLogOutput', false);\n\nexport const CONTEXT_OUTPUT_SCROLL_LOCK = new RawContextKey<boolean>(`outputView.scrollLock`, false);\n\nexport const IOutputService = createDecorator<IOutputService>(OUTPUT_SERVICE_ID);\n\n/**\n * The output service to manage output from the various processes running.\n */\nexport interface IOutputService {\n\treadonly _serviceBrand: undefined;\n\n\t/**\n\t * Given the channel id returns the output channel instance.\n\t * Channel should be first registered via OutputChannelRegistry.\n\t */\n\tgetChannel(id: string): IOutputChannel | undefined;\n\n\t/**\n\t * Given the channel id returns the registered output channel descriptor.\n\t */\n\tgetChannelDescriptor(id: string): IOutputChannelDescriptor | undefined;\n\n\t/**\n\t * Returns an array of all known output channels descriptors.\n\t */\n\tgetChannelDescriptors(): IOutputChannelDescriptor[];\n\n\t/**\n\t * Returns the currently active channel.\n\t * Only one channel can be active at a given moment.\n\t */\n\tgetActiveChannel(): IOutputChannel | undefined;\n\n\t/**\n\t * Show the channel with the passed id.\n\t */\n\tshowChannel(id: string, preserveFocus?: boolean): Promise<void>;\n\n\t/**\n\t * Allows to register on active output channel change.\n\t */\n\tonActiveOutputChannel: Event<string>;\n}\n\nexport enum OutputChannelUpdateMode {\n\tAppend = 1,\n\tReplace,\n\tClear\n}\n\nexport interface IOutputChannel {\n\n\t/**\n\t * Identifier of the output channel.\n\t */\n\tid: string;\n\n\t/**\n\t * Label of the output channel to be displayed to the user.\n\t */\n\tlabel: string;\n\n\t/**\n\t * URI of the output channel.\n\t */\n\turi: URI;\n\n\t/**\n\t * Appends output to the channel.\n\t */\n\tappend(output: string): void;\n\n\t/**\n\t * Clears all received output for this channel.\n\t */\n\tclear(): void;\n\n\t/**\n\t * Replaces the content of the channel with given output\n\t */\n\treplace(output: string): void;\n\n\t/**\n\t * Update the channel.\n\t */\n\tupdate(mode: OutputChannelUpdateMode.Append): void;\n\tupdate(mode: OutputChannelUpdateMode, till: number): void;\n\n\t/**\n\t * Disposes the output channel.\n\t */\n\tdispose(): void;\n}\n\nexport const Extensions = {\n\tOutputChannels: 'workbench.contributions.outputChannels'\n};\n\nexport interface IOutputChannelDescriptor {\n\tid: string;\n\tlabel: string;\n\tlog: boolean;\n\tlanguageId?: string;\n\tfile?: URI;\n}\n\nexport interface IFileOutputChannelDescriptor extends IOutputChannelDescriptor {\n\tfile: URI;\n}\n\nexport interface IOutputChannelRegistry {\n\n\treadonly onDidRegisterChannel: Event<string>;\n\treadonly onDidRemoveChannel: Event<string>;\n\n\t/**\n\t * Make an output channel known to the output world.\n\t */\n\tregisterChannel(descriptor: IOutputChannelDescriptor): void;\n\n\t/**\n\t * Returns the list of channels known to the output world.\n\t */\n\tgetChannels(): IOutputChannelDescriptor[];\n\n\t/**\n\t * Returns the channel with the passed id.\n\t */\n\tgetChannel(id: string): IOutputChannelDescriptor | undefined;\n\n\t/**\n\t * Remove the output channel with the passed id.\n\t */\n\tremoveChannel(id: string): void;\n}\n\nclass OutputChannelRegistry implements IOutputChannelRegistry {\n\tprivate channels = new Map<string, IOutputChannelDescriptor>();\n\n\tprivate readonly _onDidRegisterChannel = new Emitter<string>();\n\treadonly onDidRegisterChannel: Event<string> = this._onDidRegisterChannel.event;\n\n\tprivate readonly _onDidRemoveChannel = new Emitter<string>();\n\treadonly onDidRemoveChannel: Event<string> = this._onDidRemoveChannel.event;\n\n\tpublic registerChannel(descriptor: IOutputChannelDescriptor): void {\n\t\tif (!this.channels.has(descriptor.id)) {\n\t\t\tthis.channels.set(descriptor.id, descriptor);\n\t\t\tthis._onDidRegisterChannel.fire(descriptor.id);\n\t\t}\n\t}\n\n\tpublic getChannels(): IOutputChannelDescriptor[] {\n\t\tconst result: IOutputChannelDescriptor[] = [];\n\t\tthis.channels.forEach(value => result.push(value));\n\t\treturn result;\n\t}\n\n\tpublic getChannel(id: string): IOutputChannelDescriptor | undefined {\n\t\treturn this.channels.get(id);\n\t}\n\n\tpublic removeChannel(id: string): void {\n\t\tthis.channels.delete(id);\n\t\tthis._onDidRemoveChannel.fire(id);\n\t}\n}\n\nRegistry.add(Extensions.OutputChannels, new OutputChannelRegistry());\n\nexport function registerLogChannel(id: string, label: string, file: URI, fileService: IFileService, logService: ILogService): CancelablePromise<void> {\n\treturn createCancelablePromise(async token => {\n\t\tawait whenProviderRegistered(file, fileService);\n\t\tconst outputChannelRegistry = Registry.as<IOutputChannelRegistry>(Extensions.OutputChannels);\n\t\ttry {\n\t\t\tawait whenFileExists(file, 1, fileService, logService, token);\n\t\t\toutputChannelRegistry.registerChannel({ id, label, file, log: true });\n\t\t} catch (error) {\n\t\t\tif (!isCancellationError(error)) {\n\t\t\t\tlogService.error('Error while registering log channel', file.toString(), getErrorMessage(error));\n\t\t\t}\n\t\t}\n\t});\n}\n\nasync function whenFileExists(file: URI, trial: number, fileService: IFileService, logService: ILogService, token: CancellationToken): Promise<void> {\n\tconst exists = await fileService.exists(file);\n\tif (exists) {\n\t\treturn;\n\t}\n\tif (token.isCancellationRequested) {\n\t\tthrow new CancellationError();\n\t}\n\tif (trial > 10) {\n\t\tthrow new Error(`Timed out while waiting for file to be created`);\n\t}\n\tlogService.debug(`[Registering Log Channel] File does not exist. Waiting for 1s to retry.`, file.toString());\n\tawait timeout(1000, token);\n\tawait whenFileExists(file, trial + 1, fileService, logService, token);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { MainContext, MainThreadOutputServiceShape, ExtHostOutputServiceShape } from './extHost.protocol';\nimport type * as vscode from 'vscode';\nimport { URI } from 'vs/base/common/uri';\nimport { Disposable } from 'vs/base/common/lifecycle';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { IExtHostRpcService } from 'vs/workbench/api/common/extHostRpcService';\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { ILogger, ILoggerService } from 'vs/platform/log/common/log';\nimport { OutputChannelUpdateMode } from 'vs/workbench/services/output/common/output';\nimport { IExtHostConsumerFileSystem } from 'vs/workbench/api/common/extHostFileSystemConsumer';\nimport { IExtHostInitDataService } from 'vs/workbench/api/common/extHostInitDataService';\nimport { IExtHostFileSystemInfo } from 'vs/workbench/api/common/extHostFileSystemInfo';\nimport { toLocalISOString } from 'vs/base/common/date';\nimport { VSBuffer } from 'vs/base/common/buffer';\nimport { isString } from 'vs/base/common/types';\n\nexport class ExtHostOutputChannel extends Disposable implements vscode.OutputChannel {\n\n\tprivate offset: number = 0;\n\tpublic visible: boolean = false;\n\n\tprivate _disposed: boolean = false;\n\tget disposed(): boolean { return this._disposed; }\n\n\tconstructor(\n\t\treadonly id: string, readonly name: string,\n\t\tprivate readonly logger: ILogger,\n\t\tprivate readonly proxy: MainThreadOutputServiceShape\n\t) {\n\t\tsuper();\n\t}\n\n\tappendLine(value: string): void {\n\t\tthis.append(value + '\\n');\n\t}\n\n\tappend(value: string): void {\n\t\tthis.write(value);\n\t\tif (this.visible) {\n\t\t\tthis.logger.flush();\n\t\t\tthis.proxy.$update(this.id, OutputChannelUpdateMode.Append);\n\t\t}\n\t}\n\n\tclear(): void {\n\t\tconst till = this.offset;\n\t\tthis.logger.flush();\n\t\tthis.proxy.$update(this.id, OutputChannelUpdateMode.Clear, till);\n\t}\n\n\treplace(value: string): void {\n\t\tconst till = this.offset;\n\t\tthis.write(value);\n\t\tthis.proxy.$update(this.id, OutputChannelUpdateMode.Replace, till);\n\t\tif (this.visible) {\n\t\t\tthis.logger.flush();\n\t\t}\n\t}\n\n\tshow(columnOrPreserveFocus?: vscode.ViewColumn | boolean, preserveFocus?: boolean): void {\n\t\tthis.logger.flush();\n\t\tthis.proxy.$reveal(this.id, !!(typeof columnOrPreserveFocus === 'boolean' ? columnOrPreserveFocus : preserveFocus));\n\t}\n\n\thide(): void {\n\t\tthis.proxy.$close(this.id);\n\t}\n\n\tprivate write(value: string): void {\n\t\tthis.offset += VSBuffer.fromString(value).byteLength;\n\t\tthis.logger.info(value);\n\t}\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\n\t\tif (!this._disposed) {\n\t\t\tthis.proxy.$dispose(this.id);\n\t\t\tthis._disposed = true;\n\t\t}\n\t}\n\n}\n\nexport class ExtHostOutputService implements ExtHostOutputServiceShape {\n\n\treadonly _serviceBrand: undefined;\n\n\tprivate readonly proxy: MainThreadOutputServiceShape;\n\n\tprivate readonly outputsLocation: URI;\n\tprivate outputDirectoryPromise: Thenable<URI> | undefined;\n\tprivate namePool: number = 1;\n\n\tprivate readonly channels: Map<string, ExtHostOutputChannel> = new Map<string, ExtHostOutputChannel>();\n\tprivate visibleChannelId: string | null = null;\n\n\tconstructor(\n\t\t@IExtHostRpcService extHostRpc: IExtHostRpcService,\n\t\t@IExtHostInitDataService initData: IExtHostInitDataService,\n\t\t@IExtHostConsumerFileSystem private readonly extHostFileSystem: IExtHostConsumerFileSystem,\n\t\t@IExtHostFileSystemInfo private readonly extHostFileSystemInfo: IExtHostFileSystemInfo,\n\t\t@ILoggerService private readonly loggerService: ILoggerService,\n\t) {\n\t\tthis.proxy = extHostRpc.getProxy(MainContext.MainThreadOutputService);\n\t\tthis.outputsLocation = this.extHostFileSystemInfo.extUri.joinPath(initData.logsLocation, `output_logging_${toLocalISOString(new Date()).replace(/-|:|\\.\\d+Z$/g, '')}`);\n\t}\n\n\t$setVisibleChannel(visibleChannelId: string | null): void {\n\t\tthis.visibleChannelId = visibleChannelId;\n\t\tfor (const [id, channel] of this.channels) {\n\t\t\tchannel.visible = id === this.visibleChannelId;\n\t\t}\n\t}\n\n\tcreateOutputChannel(name: string, languageId: string | undefined, extension: IExtensionDescription): vscode.OutputChannel {\n\t\tname = name.trim();\n\t\tif (!name) {\n\t\t\tthrow new Error('illegal argument `name`. must not be falsy');\n\t\t}\n\t\tif (isString(languageId) && !languageId.trim()) {\n\t\t\tthrow new Error('illegal argument `languageId`. must not be empty');\n\t\t}\n\t\tconst extHostOutputChannel = this.doCreateOutputChannel(name, languageId, extension);\n\t\textHostOutputChannel.then(channel => {\n\t\t\tthis.channels.set(channel.id, channel);\n\t\t\tchannel.visible = channel.id === this.visibleChannelId;\n\t\t});\n\t\treturn this.createExtHostOutputChannel(name, extHostOutputChannel);\n\t}\n\n\tprivate async doCreateOutputChannel(name: string, languageId: string | undefined, extension: IExtensionDescription): Promise<ExtHostOutputChannel> {\n\t\tconst outputDir = await this.createOutputDirectory();\n\t\tconst file = this.extHostFileSystemInfo.extUri.joinPath(outputDir, `${this.namePool++}-${name.replace(/[\\\\/:\\*\\?\"<>\\|]/g, '')}.log`);\n\t\tconst logger = this.loggerService.createLogger(file, { always: true, donotRotate: true, donotUseFormatters: true });\n\t\tconst id = await this.proxy.$register(name, false, file, languageId, extension.identifier.value);\n\t\treturn new ExtHostOutputChannel(id, name, logger, this.proxy);\n\t}\n\n\tprivate createOutputDirectory(): Thenable<URI> {\n\t\tif (!this.outputDirectoryPromise) {\n\t\t\tthis.outputDirectoryPromise = this.extHostFileSystem.value.createDirectory(this.outputsLocation).then(() => this.outputsLocation);\n\t\t}\n\t\treturn this.outputDirectoryPromise;\n\t}\n\n\tprivate createExtHostOutputChannel(name: string, channelPromise: Promise<ExtHostOutputChannel>): vscode.OutputChannel {\n\t\tlet disposed = false;\n\t\tconst validate = () => {\n\t\t\tif (disposed) {\n\t\t\t\tthrow new Error('Channel has been closed');\n\t\t\t}\n\t\t};\n\t\treturn {\n\t\t\tget name(): string { return name; },\n\t\t\tappend(value: string): void {\n\t\t\t\tvalidate();\n\t\t\t\tchannelPromise.then(channel => channel.append(value));\n\t\t\t},\n\t\t\tappendLine(value: string): void {\n\t\t\t\tvalidate();\n\t\t\t\tchannelPromise.then(channel => channel.appendLine(value));\n\t\t\t},\n\t\t\tclear(): void {\n\t\t\t\tvalidate();\n\t\t\t\tchannelPromise.then(channel => channel.clear());\n\t\t\t},\n\t\t\treplace(value: string): void {\n\t\t\t\tvalidate();\n\t\t\t\tchannelPromise.then(channel => channel.replace(value));\n\t\t\t},\n\t\t\tshow(columnOrPreserveFocus?: vscode.ViewColumn | boolean, preserveFocus?: boolean): void {\n\t\t\t\tvalidate();\n\t\t\t\tchannelPromise.then(channel => channel.show(columnOrPreserveFocus, preserveFocus));\n\t\t\t},\n\t\t\thide(): void {\n\t\t\t\tvalidate();\n\t\t\t\tchannelPromise.then(channel => channel.hide());\n\t\t\t},\n\t\t\tdispose(): void {\n\t\t\t\tdisposed = true;\n\t\t\t\tchannelPromise.then(channel => channel.dispose());\n\t\t\t}\n\t\t};\n\t}\n}\n\nexport interface IExtHostOutputService extends ExtHostOutputService { }\nexport const IExtHostOutputService = createDecorator<IExtHostOutputService>('IExtHostOutputService');\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { RemoteAgentConnectionContext, IRemoteAgentEnvironment } from 'vs/platform/remote/common/remoteAgentEnvironment';\nimport { IChannel, IServerChannel } from 'vs/base/parts/ipc/common/ipc';\nimport { IDiagnosticInfoOptions, IDiagnosticInfo } from 'vs/platform/diagnostics/common/diagnostics';\nimport { Event } from 'vs/base/common/event';\nimport { PersistentConnectionEvent, ISocketFactory } from 'vs/platform/remote/common/remoteAgentConnection';\nimport { ITelemetryData, TelemetryLevel } from 'vs/platform/telemetry/common/telemetry';\nimport { ExtensionIdentifier, IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { URI } from 'vs/base/common/uri';\n\nexport const RemoteExtensionLogFileName = 'remoteagent';\n\nexport const IRemoteAgentService = createDecorator<IRemoteAgentService>('remoteAgentService');\n\nexport interface IRemoteAgentService {\n\treadonly _serviceBrand: undefined;\n\n\treadonly socketFactory: ISocketFactory;\n\n\tgetConnection(): IRemoteAgentConnection | null;\n\t/**\n\t * Get the remote environment. In case of an error, returns `null`.\n\t */\n\tgetEnvironment(): Promise<IRemoteAgentEnvironment | null>;\n\t/**\n\t * Get the remote environment. Can return an error.\n\t */\n\tgetRawEnvironment(): Promise<IRemoteAgentEnvironment | null>;\n\t/**\n\t * Get exit information for a remote extension host.\n\t */\n\tgetExtensionHostExitInfo(reconnectionToken: string): Promise<IExtensionHostExitInfo | null>;\n\n\t/**\n\t * Gets the round trip time from the remote extension host. Note that this\n\t * may be delayed if the extension host is busy.\n\t */\n\tgetRoundTripTime(): Promise<number | undefined>;\n\n\twhenExtensionsReady(): Promise<void>;\n\t/**\n\t * Scan remote extensions.\n\t */\n\tscanExtensions(skipExtensions?: ExtensionIdentifier[]): Promise<IExtensionDescription[]>;\n\t/**\n\t * Scan a single remote extension.\n\t */\n\tscanSingleExtension(extensionLocation: URI, isBuiltin: boolean): Promise<IExtensionDescription | null>;\n\tgetDiagnosticInfo(options: IDiagnosticInfoOptions): Promise<IDiagnosticInfo | undefined>;\n\tupdateTelemetryLevel(telemetryLevel: TelemetryLevel): Promise<void>;\n\tlogTelemetry(eventName: string, data?: ITelemetryData): Promise<void>;\n\tflushTelemetry(): Promise<void>;\n}\n\nexport interface IExtensionHostExitInfo {\n\tcode: number;\n\tsignal: string;\n}\n\nexport interface IRemoteAgentConnection {\n\treadonly remoteAuthority: string;\n\n\treadonly onReconnecting: Event<void>;\n\treadonly onDidStateChange: Event<PersistentConnectionEvent>;\n\n\tdispose(): void;\n\tgetChannel<T extends IChannel>(channelName: string): T;\n\twithChannel<T extends IChannel, R>(channelName: string, callback: (channel: T) => Promise<R>): Promise<R>;\n\tregisterChannel<T extends IServerChannel<RemoteAgentConnectionContext>>(channelName: string, channel: T): void;\n\tgetInitialConnectionTimeMs(): Promise<number>;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { isValidBasename } from 'vs/base/common/extpath';\nimport { Schemas } from 'vs/base/common/network';\nimport { IPath, win32, posix } from 'vs/base/common/path';\nimport { OperatingSystem, OS } from 'vs/base/common/platform';\nimport { basename } from 'vs/base/common/resources';\nimport { URI } from 'vs/base/common/uri';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { getVirtualWorkspaceScheme } from 'vs/platform/workspace/common/virtualWorkspace';\nimport { IWorkspaceContextService } from 'vs/platform/workspace/common/workspace';\nimport { IWorkbenchEnvironmentService } from 'vs/workbench/services/environment/common/environmentService';\nimport { IRemoteAgentService } from 'vs/workbench/services/remote/common/remoteAgentService';\n\nexport const IPathService = createDecorator<IPathService>('pathService');\n\n/**\n * Provides access to path related properties that will match the\n * environment. If the environment is connected to a remote, the\n * path properties will match that of the remotes operating system.\n */\nexport interface IPathService {\n\n\treadonly _serviceBrand: undefined;\n\n\t/**\n\t * The correct path library to use for the target environment. If\n\t * the environment is connected to a remote, this will be the\n\t * path library of the remote file system. Otherwise it will be\n\t * the local file system's path library depending on the OS.\n\t */\n\treadonly path: Promise<IPath>;\n\n\t/**\n\t * Determines the best default URI scheme for the current workspace.\n\t * It uses information about whether we're running remote, in browser,\n\t * or native combined with information about the current workspace to\n\t * find the best default scheme.\n\t */\n\treadonly defaultUriScheme: string;\n\n\t/**\n\t * Converts the given path to a file URI to use for the target\n\t * environment. If the environment is connected to a remote, it\n\t * will use the path separators according to the remote file\n\t * system. Otherwise it will use the local file system's path\n\t * separators.\n\t */\n\tfileURI(path: string): Promise<URI>;\n\n\t/**\n\t * Resolves the user-home directory for the target environment.\n\t * If the envrionment is connected to a remote, this will be the\n\t * remote's user home directory, otherwise the local one unless\n\t * `preferLocal` is set to `true`.\n\t */\n\tuserHome(options: { preferLocal: true }): URI;\n\tuserHome(options?: { preferLocal: boolean }): Promise<URI>;\n\n\t/**\n\t * Figures out if the provided resource has a valid file name\n\t * for the operating system the file is saved to.\n\t *\n\t * Note: this currently only supports `file` and `vscode-file`\n\t * protocols where we know the limits of the file systems behind\n\t * these OS. Other remotes are not supported and this method\n\t * will always return `true` for them.\n\t */\n\thasValidBasename(resource: URI, basename?: string): Promise<boolean>;\n\thasValidBasename(resource: URI, os: OperatingSystem, basename?: string): boolean;\n\n\t/**\n\t * @deprecated use `userHome` instead.\n\t */\n\treadonly resolvedUserHome: URI | undefined;\n}\n\nexport abstract class AbstractPathService implements IPathService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate resolveOS: Promise<OperatingSystem>;\n\n\tprivate resolveUserHome: Promise<URI>;\n\tprivate maybeUnresolvedUserHome: URI | undefined;\n\n\tconstructor(\n\t\tprivate localUserHome: URI,\n\t\t@IRemoteAgentService private readonly remoteAgentService: IRemoteAgentService,\n\t\t@IWorkbenchEnvironmentService private readonly environmentService: IWorkbenchEnvironmentService,\n\t\t@IWorkspaceContextService private contextService: IWorkspaceContextService\n\t) {\n\n\t\t// OS\n\t\tthis.resolveOS = (async () => {\n\t\t\tconst env = await this.remoteAgentService.getEnvironment();\n\n\t\t\treturn env?.os || OS;\n\t\t})();\n\n\t\t// User Home\n\t\tthis.resolveUserHome = (async () => {\n\t\t\tconst env = await this.remoteAgentService.getEnvironment();\n\t\t\tconst userHome = this.maybeUnresolvedUserHome = env?.userHome ?? localUserHome;\n\n\t\t\treturn userHome;\n\t\t})();\n\t}\n\n\thasValidBasename(resource: URI, basename?: string): Promise<boolean>;\n\thasValidBasename(resource: URI, os: OperatingSystem, basename?: string): boolean;\n\thasValidBasename(resource: URI, arg2?: string | OperatingSystem, basename?: string): boolean | Promise<boolean> {\n\n\t\t// async version\n\t\tif (typeof arg2 === 'string' || typeof arg2 === 'undefined') {\n\t\t\treturn this.resolveOS.then(os => this.doHasValidBasename(resource, os, arg2));\n\t\t}\n\n\t\t// sync version\n\t\treturn this.doHasValidBasename(resource, arg2, basename);\n\t}\n\n\tprivate doHasValidBasename(resource: URI, os: OperatingSystem, name?: string): boolean {\n\n\t\t// Our `isValidBasename` method only works with our\n\t\t// standard schemes for files on disk, either locally\n\t\t// or remote.\n\t\tif (resource.scheme === Schemas.file || resource.scheme === Schemas.vscodeRemote) {\n\t\t\treturn isValidBasename(name ?? basename(resource), os === OperatingSystem.Windows);\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tget defaultUriScheme(): string {\n\t\treturn AbstractPathService.findDefaultUriScheme(this.environmentService, this.contextService);\n\t}\n\n\tstatic findDefaultUriScheme(environmentService: IWorkbenchEnvironmentService, contextService: IWorkspaceContextService): string {\n\t\tif (environmentService.remoteAuthority) {\n\t\t\treturn Schemas.vscodeRemote;\n\t\t}\n\n\t\tconst virtualWorkspace = getVirtualWorkspaceScheme(contextService.getWorkspace());\n\t\tif (virtualWorkspace) {\n\t\t\treturn virtualWorkspace;\n\t\t}\n\n\t\tconst firstFolder = contextService.getWorkspace().folders[0];\n\t\tif (firstFolder) {\n\t\t\treturn firstFolder.uri.scheme;\n\t\t}\n\n\t\tconst configuration = contextService.getWorkspace().configuration;\n\t\tif (configuration) {\n\t\t\treturn configuration.scheme;\n\t\t}\n\n\t\treturn Schemas.file;\n\t}\n\n\tuserHome(options?: { preferLocal: boolean }): Promise<URI>;\n\tuserHome(options: { preferLocal: true }): URI;\n\tuserHome(options?: { preferLocal: boolean }): Promise<URI> | URI {\n\t\treturn options?.preferLocal ? this.localUserHome : this.resolveUserHome;\n\t}\n\n\tget resolvedUserHome(): URI | undefined {\n\t\treturn this.maybeUnresolvedUserHome;\n\t}\n\n\tget path(): Promise<IPath> {\n\t\treturn this.resolveOS.then(os => {\n\t\t\treturn os === OperatingSystem.Windows ?\n\t\t\t\twin32 :\n\t\t\t\tposix;\n\t\t});\n\t}\n\n\tasync fileURI(_path: string): Promise<URI> {\n\t\tlet authority = '';\n\n\t\t// normalize to fwd-slashes on windows,\n\t\t// on other systems bwd-slashes are valid\n\t\t// filename character, eg /f\\oo/ba\\r.txt\n\t\tconst os = await this.resolveOS;\n\t\tif (os === OperatingSystem.Windows) {\n\t\t\t_path = _path.replace(/\\\\/g, '/');\n\t\t}\n\n\t\t// check for authority as used in UNC shares\n\t\t// or use the path as given\n\t\tif (_path[0] === '/' && _path[1] === '/') {\n\t\t\tconst idx = _path.indexOf('/', 2);\n\t\t\tif (idx === -1) {\n\t\t\t\tauthority = _path.substring(2);\n\t\t\t\t_path = '/';\n\t\t\t} else {\n\t\t\t\tauthority = _path.substring(2, idx);\n\t\t\t\t_path = _path.substring(idx) || '/';\n\t\t\t}\n\t\t}\n\n\t\treturn URI.from({\n\t\t\tscheme: Schemas.file,\n\t\t\tauthority,\n\t\t\tpath: _path,\n\t\t\tquery: '',\n\t\t\tfragment: ''\n\t\t});\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { URI } from 'vs/base/common/uri';\nimport { IProgress } from 'vs/platform/progress/common/progress';\n\nexport class Position {\n\tconstructor(readonly line: number, readonly character: number) { }\n\n\tisBefore(other: Position): boolean { return false; }\n\tisBeforeOrEqual(other: Position): boolean { return false; }\n\tisAfter(other: Position): boolean { return false; }\n\tisAfterOrEqual(other: Position): boolean { return false; }\n\tisEqual(other: Position): boolean { return false; }\n\tcompareTo(other: Position): number { return 0; }\n\ttranslate(lineDelta?: number, characterDelta?: number): Position;\n\ttranslate(change: { lineDelta?: number; characterDelta?: number }): Position;\n\ttranslate(_?: any, _2?: any): Position { return new Position(0, 0); }\n\twith(line?: number, character?: number): Position;\n\twith(change: { line?: number; character?: number }): Position;\n\twith(_: any): Position { return new Position(0, 0); }\n}\n\nexport class Range {\n\treadonly start: Position;\n\treadonly end: Position;\n\n\tconstructor(startLine: number, startCol: number, endLine: number, endCol: number) {\n\t\tthis.start = new Position(startLine, startCol);\n\t\tthis.end = new Position(endLine, endCol);\n\t}\n\n\tisEmpty = false;\n\tisSingleLine = false;\n\tcontains(positionOrRange: Position | Range): boolean { return false; }\n\tisEqual(other: Range): boolean { return false; }\n\tintersection(range: Range): Range | undefined { return undefined; }\n\tunion(other: Range): Range { return new Range(0, 0, 0, 0); }\n\n\twith(start?: Position, end?: Position): Range;\n\twith(change: { start?: Position; end?: Position }): Range;\n\twith(_: any): Range { return new Range(0, 0, 0, 0); }\n}\n\nexport type ProviderResult<T> = T | undefined | null | Thenable<T | undefined | null>;\n\n/**\n * A relative pattern is a helper to construct glob patterns that are matched\n * relatively to a base path. The base path can either be an absolute file path\n * or a [workspace folder](#WorkspaceFolder).\n */\nexport interface RelativePattern {\n\n\t/**\n\t * A base file path to which this pattern will be matched against relatively.\n\t */\n\tbase: string;\n\n\t/**\n\t * A file glob pattern like `*.{ts,js}` that will be matched on file paths\n\t * relative to the base path.\n\t *\n\t * Example: Given a base of `/home/work/folder` and a file path of `/home/work/folder/index.js`,\n\t * the file glob pattern will match on `index.js`.\n\t */\n\tpattern: string;\n}\n\n/**\n * A file glob pattern to match file paths against. This can either be a glob pattern string\n * (like `** /*.{ts,js}` without space before / or `*.{ts,js}`) or a [relative pattern](#RelativePattern).\n *\n * Glob patterns can have the following syntax:\n * * `*` to match zero or more characters in a path segment\n * * `?` to match on one character in a path segment\n * * `**` to match any number of path segments, including none\n * * `{}` to group conditions (e.g. `** /*.{ts,js}` without space before / matches all TypeScript and JavaScript files)\n * * `[]` to declare a range of characters to match in a path segment (e.g., `example.[0-9]` to match on `example.0`, `example.1`, )\n * * `[!...]` to negate a range of characters to match in a path segment (e.g., `example.[!0-9]` to match on `example.a`, `example.b`, but not `example.0`)\n *\n * Note: a backslash (`\\`) is not valid within a glob pattern. If you have an existing file\n * path to match against, consider to use the [relative pattern](#RelativePattern) support\n * that takes care of converting any backslash into slash. Otherwise, make sure to convert\n * any backslash to slash when creating the glob pattern.\n */\nexport type GlobPattern = string | RelativePattern;\n\n/**\n * The parameters of a query for text search.\n */\nexport interface TextSearchQuery {\n\t/**\n\t * The text pattern to search for.\n\t */\n\tpattern: string;\n\n\t/**\n\t * Whether or not `pattern` should match multiple lines of text.\n\t */\n\tisMultiline?: boolean;\n\n\t/**\n\t * Whether or not `pattern` should be interpreted as a regular expression.\n\t */\n\tisRegExp?: boolean;\n\n\t/**\n\t * Whether or not the search should be case-sensitive.\n\t */\n\tisCaseSensitive?: boolean;\n\n\t/**\n\t * Whether or not to search for whole word matches only.\n\t */\n\tisWordMatch?: boolean;\n}\n\n/**\n * A file glob pattern to match file paths against.\n * TODO@roblou - merge this with the GlobPattern docs/definition in vscode.d.ts.\n * @see [GlobPattern](#GlobPattern)\n */\nexport type GlobString = string;\n\n/**\n * Options common to file and text search\n */\nexport interface SearchOptions {\n\t/**\n\t * The root folder to search within.\n\t */\n\tfolder: URI;\n\n\t/**\n\t * Files that match an `includes` glob pattern should be included in the search.\n\t */\n\tincludes: GlobString[];\n\n\t/**\n\t * Files that match an `excludes` glob pattern should be excluded from the search.\n\t */\n\texcludes: GlobString[];\n\n\t/**\n\t * Whether external files that exclude files, like .gitignore, should be respected.\n\t * See the vscode setting `\"search.useIgnoreFiles\"`.\n\t */\n\tuseIgnoreFiles: boolean;\n\n\t/**\n\t * Whether symlinks should be followed while searching.\n\t * See the vscode setting `\"search.followSymlinks\"`.\n\t */\n\tfollowSymlinks: boolean;\n\n\t/**\n\t * Whether global files that exclude files, like .gitignore, should be respected.\n\t * See the vscode setting `\"search.useGlobalIgnoreFiles\"`.\n\t */\n\tuseGlobalIgnoreFiles: boolean;\n\n\t/**\n\t * Whether files in parent directories that exclude files, like .gitignore, should be respected.\n\t * See the vscode setting `\"search.useParentIgnoreFiles\"`.\n\t */\n\tuseParentIgnoreFiles: boolean;\n}\n\n/**\n * Options to specify the size of the result text preview.\n * These options don't affect the size of the match itself, just the amount of preview text.\n */\nexport interface TextSearchPreviewOptions {\n\t/**\n\t * The maximum number of lines in the preview.\n\t * Only search providers that support multiline search will ever return more than one line in the match.\n\t */\n\tmatchLines: number;\n\n\t/**\n\t * The maximum number of characters included per line.\n\t */\n\tcharsPerLine: number;\n}\n\n/**\n * Options that apply to text search.\n */\nexport interface TextSearchOptions extends SearchOptions {\n\t/**\n\t * The maximum number of results to be returned.\n\t */\n\tmaxResults: number;\n\n\t/**\n\t * Options to specify the size of the result text preview.\n\t */\n\tpreviewOptions?: TextSearchPreviewOptions;\n\n\t/**\n\t * Exclude files larger than `maxFileSize` in bytes.\n\t */\n\tmaxFileSize?: number;\n\n\t/**\n\t * Interpret files using this encoding.\n\t * See the vscode setting `\"files.encoding\"`\n\t */\n\tencoding?: string;\n\n\t/**\n\t * Number of lines of context to include before each match.\n\t */\n\tbeforeContext?: number;\n\n\t/**\n\t * Number of lines of context to include after each match.\n\t */\n\tafterContext?: number;\n}\n\n/**\n * Represents the severity of a TextSearchComplete message.\n */\nexport enum TextSearchCompleteMessageType {\n\tInformation = 1,\n\tWarning = 2,\n}\n\n/**\n * A message regarding a completed search.\n */\nexport interface TextSearchCompleteMessage {\n\t/**\n\t * Markdown text of the message.\n\t */\n\ttext: string;\n\t/**\n\t * Whether the source of the message is trusted, command links are disabled for untrusted message sources.\n\t */\n\ttrusted?: boolean;\n\t/**\n\t * The message type, this affects how the message will be rendered.\n\t */\n\ttype: TextSearchCompleteMessageType;\n}\n\n/**\n * Information collected when text search is complete.\n */\nexport interface TextSearchComplete {\n\t/**\n\t * Whether the search hit the limit on the maximum number of search results.\n\t * `maxResults` on [`TextSearchOptions`](#TextSearchOptions) specifies the max number of results.\n\t * - If exactly that number of matches exist, this should be false.\n\t * - If `maxResults` matches are returned and more exist, this should be true.\n\t * - If search hits an internal limit which is less than `maxResults`, this should be true.\n\t */\n\tlimitHit?: boolean;\n\n\t/**\n\t * Additional information regarding the state of the completed search.\n\t *\n\t * Supports links in markdown syntax:\n\t * - Click to [run a command](command:workbench.action.OpenQuickPick)\n\t * - Click to [open a website](https://aka.ms)\n\t */\n\tmessage?: TextSearchCompleteMessage | TextSearchCompleteMessage[];\n}\n\n/**\n * The parameters of a query for file search.\n */\nexport interface FileSearchQuery {\n\t/**\n\t * The search pattern to match against file paths.\n\t */\n\tpattern: string;\n}\n\n/**\n * Options that apply to file search.\n */\nexport interface FileSearchOptions extends SearchOptions {\n\t/**\n\t * The maximum number of results to be returned.\n\t */\n\tmaxResults?: number;\n\n\t/**\n\t * A CancellationToken that represents the session for this search query. If the provider chooses to, this object can be used as the key for a cache,\n\t * and searches with the same session object can search the same cache. When the token is cancelled, the session is complete and the cache can be cleared.\n\t */\n\tsession?: CancellationToken;\n}\n\n/**\n * A preview of the text result.\n */\nexport interface TextSearchMatchPreview {\n\t/**\n\t * The matching lines of text, or a portion of the matching line that contains the match.\n\t */\n\ttext: string;\n\n\t/**\n\t * The Range within `text` corresponding to the text of the match.\n\t * The number of matches must match the TextSearchMatch's range property.\n\t */\n\tmatches: Range | Range[];\n}\n\n/**\n * A match from a text search\n */\nexport interface TextSearchMatch {\n\t/**\n\t * The uri for the matching document.\n\t */\n\turi: URI;\n\n\t/**\n\t * The range of the match within the document, or multiple ranges for multiple matches.\n\t */\n\tranges: Range | Range[];\n\n\t/**\n\t * A preview of the text match.\n\t */\n\tpreview: TextSearchMatchPreview;\n}\n\n/**\n * A line of context surrounding a TextSearchMatch.\n */\nexport interface TextSearchContext {\n\t/**\n\t * The uri for the matching document.\n\t */\n\turi: URI;\n\n\t/**\n\t * One line of text.\n\t * previewOptions.charsPerLine applies to this\n\t */\n\ttext: string;\n\n\t/**\n\t * The line number of this line of context.\n\t */\n\tlineNumber: number;\n}\n\nexport type TextSearchResult = TextSearchMatch | TextSearchContext;\n\n/**\n * A FileSearchProvider provides search results for files in the given folder that match a query string. It can be invoked by quickaccess or other extensions.\n *\n * A FileSearchProvider is the more powerful of two ways to implement file search in VS Code. Use a FileSearchProvider if you wish to search within a folder for\n * all files that match the user's query.\n *\n * The FileSearchProvider will be invoked on every keypress in quickaccess. When `workspace.findFiles` is called, it will be invoked with an empty query string,\n * and in that case, every file in the folder should be returned.\n */\nexport interface FileSearchProvider {\n\t/**\n\t * Provide the set of files that match a certain file path pattern.\n\t * @param query The parameters for this query.\n\t * @param options A set of options to consider while searching files.\n\t * @param progress A progress callback that must be invoked for all results.\n\t * @param token A cancellation token.\n\t */\n\tprovideFileSearchResults(query: FileSearchQuery, options: FileSearchOptions, token: CancellationToken): ProviderResult<URI[]>;\n}\n\n/**\n * A TextSearchProvider provides search results for text results inside files in the workspace.\n */\nexport interface TextSearchProvider {\n\t/**\n\t * Provide results that match the given text pattern.\n\t * @param query The parameters for this query.\n\t * @param options A set of options to consider while searching.\n\t * @param progress A progress callback that must be invoked for all results.\n\t * @param token A cancellation token.\n\t */\n\tprovideTextSearchResults(query: TextSearchQuery, options: TextSearchOptions, progress: IProgress<TextSearchResult>, token: CancellationToken): ProviderResult<TextSearchComplete>;\n}\n\n/**\n * Options that can be set on a findTextInFiles search.\n */\nexport interface FindTextInFilesOptions {\n\t/**\n\t * A [glob pattern](#GlobPattern) that defines the files to search for. The glob pattern\n\t * will be matched against the file paths of files relative to their workspace. Use a [relative pattern](#RelativePattern)\n\t * to restrict the search results to a [workspace folder](#WorkspaceFolder).\n\t */\n\tinclude?: GlobPattern;\n\n\t/**\n\t * A [glob pattern](#GlobPattern) that defines files and folders to exclude. The glob pattern\n\t * will be matched against the file paths of resulting matches relative to their workspace. When `undefined` only default excludes will\n\t * apply, when `null` no excludes will apply.\n\t */\n\texclude?: GlobPattern | null;\n\n\t/**\n\t * The maximum number of results to search for\n\t */\n\tmaxResults?: number;\n\n\t/**\n\t * Whether external files that exclude files, like .gitignore, should be respected.\n\t * See the vscode setting `\"search.useIgnoreFiles\"`.\n\t */\n\tuseIgnoreFiles?: boolean;\n\n\t/**\n\t * Whether global files that exclude files, like .gitignore, should be respected.\n\t * See the vscode setting `\"search.useGlobalIgnoreFiles\"`.\n\t */\n\tuseGlobalIgnoreFiles?: boolean;\n\n\t/**\n\t * Whether files in parent directories that exclude files, like .gitignore, should be respected.\n\t * See the vscode setting `\"search.useParentIgnoreFiles\"`.\n\t */\n\tuseParentIgnoreFiles: boolean;\n\n\t/**\n\t * Whether symlinks should be followed while searching.\n\t * See the vscode setting `\"search.followSymlinks\"`.\n\t */\n\tfollowSymlinks?: boolean;\n\n\t/**\n\t * Interpret files using this encoding.\n\t * See the vscode setting `\"files.encoding\"`\n\t */\n\tencoding?: string;\n\n\t/**\n\t * Options to specify the size of the result text preview.\n\t */\n\tpreviewOptions?: TextSearchPreviewOptions;\n\n\t/**\n\t * Number of lines of context to include before each match.\n\t */\n\tbeforeContext?: number;\n\n\t/**\n\t * Number of lines of context to include after each match.\n\t */\n\tafterContext?: number;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { mapArrayOrNot } from 'vs/base/common/arrays';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport * as glob from 'vs/base/common/glob';\nimport { IDisposable } from 'vs/base/common/lifecycle';\nimport * as objects from 'vs/base/common/objects';\nimport * as extpath from 'vs/base/common/extpath';\nimport { fuzzyContains, getNLines } from 'vs/base/common/strings';\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { IFilesConfiguration } from 'vs/platform/files/common/files';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { ITelemetryData } from 'vs/platform/telemetry/common/telemetry';\nimport { Event } from 'vs/base/common/event';\nimport * as paths from 'vs/base/common/path';\nimport { isCancellationError } from 'vs/base/common/errors';\nimport { TextSearchCompleteMessageType } from 'vs/workbench/services/search/common/searchExtTypes';\nimport { isThenable } from 'vs/base/common/async';\n\nexport { TextSearchCompleteMessageType };\n\nexport const VIEWLET_ID = 'workbench.view.search';\nexport const PANEL_ID = 'workbench.panel.search';\nexport const VIEW_ID = 'workbench.view.search';\n\nexport const SEARCH_EXCLUDE_CONFIG = 'search.exclude';\n\n// Warning: this pattern is used in the search editor to detect offsets. If you\n// change this, also change the search-result built-in extension\nconst SEARCH_ELIDED_PREFIX = ' ';\nconst SEARCH_ELIDED_SUFFIX = ' characters skipped ';\nconst SEARCH_ELIDED_MIN_LEN = (SEARCH_ELIDED_PREFIX.length + SEARCH_ELIDED_SUFFIX.length + 5) * 2;\n\nexport const ISearchService = createDecorator<ISearchService>('searchService');\n\n/**\n * A service that enables to search for files or with in files.\n */\nexport interface ISearchService {\n\treadonly _serviceBrand: undefined;\n\ttextSearch(query: ITextQuery, token?: CancellationToken, onProgress?: (result: ISearchProgressItem) => void): Promise<ISearchComplete>;\n\tfileSearch(query: IFileQuery, token?: CancellationToken): Promise<ISearchComplete>;\n\tclearCache(cacheKey: string): Promise<void>;\n\tregisterSearchResultProvider(scheme: string, type: SearchProviderType, provider: ISearchResultProvider): IDisposable;\n}\n\n/**\n * TODO@roblou - split text from file search entirely, or share code in a more natural way.\n */\nexport const enum SearchProviderType {\n\tfile,\n\ttext\n}\n\nexport interface ISearchResultProvider {\n\ttextSearch(query: ITextQuery, onProgress?: (p: ISearchProgressItem) => void, token?: CancellationToken): Promise<ISearchComplete>;\n\tfileSearch(query: IFileQuery, token?: CancellationToken): Promise<ISearchComplete>;\n\tclearCache(cacheKey: string): Promise<void>;\n}\n\nexport interface IFolderQuery<U extends UriComponents = URI> {\n\tfolder: U;\n\tfolderName?: string;\n\texcludePattern?: glob.IExpression;\n\tincludePattern?: glob.IExpression;\n\tfileEncoding?: string;\n\tdisregardIgnoreFiles?: boolean;\n\tdisregardGlobalIgnoreFiles?: boolean;\n\tdisregardParentIgnoreFiles?: boolean;\n\tignoreSymlinks?: boolean;\n}\n\nexport interface ICommonQueryProps<U extends UriComponents> {\n\t/** For telemetry - indicates what is triggering the source */\n\t_reason?: string;\n\n\tfolderQueries: IFolderQuery<U>[];\n\tincludePattern?: glob.IExpression;\n\texcludePattern?: glob.IExpression;\n\textraFileResources?: U[];\n\n\tonlyOpenEditors?: boolean;\n\n\tmaxResults?: number;\n\tusingSearchPaths?: boolean;\n}\n\nexport interface IFileQueryProps<U extends UriComponents> extends ICommonQueryProps<U> {\n\ttype: QueryType.File;\n\tfilePattern?: string;\n\n\t/**\n\t * If true no results will be returned. Instead `limitHit` will indicate if at least one result exists or not.\n\t * Currently does not work with queries including a 'siblings clause'.\n\t */\n\texists?: boolean;\n\tsortByScore?: boolean;\n\tcacheKey?: string;\n}\n\nexport interface ITextQueryProps<U extends UriComponents> extends ICommonQueryProps<U> {\n\ttype: QueryType.Text;\n\tcontentPattern: IPatternInfo;\n\n\tpreviewOptions?: ITextSearchPreviewOptions;\n\tmaxFileSize?: number;\n\tusePCRE2?: boolean;\n\tafterContext?: number;\n\tbeforeContext?: number;\n\n\tuserDisabledExcludesAndIgnoreFiles?: boolean;\n}\n\nexport type IFileQuery = IFileQueryProps<URI>;\nexport type IRawFileQuery = IFileQueryProps<UriComponents>;\nexport type ITextQuery = ITextQueryProps<URI>;\nexport type IRawTextQuery = ITextQueryProps<UriComponents>;\n\nexport type IRawQuery = IRawTextQuery | IRawFileQuery;\nexport type ISearchQuery = ITextQuery | IFileQuery;\n\nexport const enum QueryType {\n\tFile = 1,\n\tText = 2\n}\n\n/* __GDPR__FRAGMENT__\n\t\"IPatternInfo\" : {\n\t\t\"pattern\" : { \"classification\": \"CustomerContent\", \"purpose\": \"FeatureInsight\" },\n\t\t\"isRegExp\": { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\"isWordMatch\": { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\"wordSeparators\": { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\" },\n\t\t\"isMultiline\": { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\"isCaseSensitive\": { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true },\n\t\t\"isSmartCase\": { \"classification\": \"SystemMetaData\", \"purpose\": \"FeatureInsight\", \"isMeasurement\": true }\n\t}\n*/\nexport interface IPatternInfo {\n\tpattern: string;\n\tisRegExp?: boolean;\n\tisWordMatch?: boolean;\n\twordSeparators?: string;\n\tisMultiline?: boolean;\n\tisUnicode?: boolean;\n\tisCaseSensitive?: boolean;\n}\n\nexport interface IExtendedExtensionSearchOptions {\n\tusePCRE2?: boolean;\n}\n\nexport interface IFileMatch<U extends UriComponents = URI> {\n\tresource: U;\n\tresults?: ITextSearchResult[];\n}\n\nexport type IRawFileMatch2 = IFileMatch<UriComponents>;\n\nexport interface ITextSearchPreviewOptions {\n\tmatchLines: number;\n\tcharsPerLine: number;\n}\n\nexport interface ISearchRange {\n\treadonly startLineNumber: number;\n\treadonly startColumn: number;\n\treadonly endLineNumber: number;\n\treadonly endColumn: number;\n}\n\nexport interface ITextSearchResultPreview {\n\ttext: string;\n\tmatches: ISearchRange | ISearchRange[];\n}\n\nexport interface ITextSearchMatch {\n\turi?: URI;\n\tranges: ISearchRange | ISearchRange[];\n\tpreview: ITextSearchResultPreview;\n}\n\nexport interface ITextSearchContext {\n\turi?: URI;\n\ttext: string;\n\tlineNumber: number;\n}\n\nexport type ITextSearchResult = ITextSearchMatch | ITextSearchContext;\n\nexport function resultIsMatch(result: ITextSearchResult): result is ITextSearchMatch {\n\treturn !!(<ITextSearchMatch>result).preview;\n}\n\nexport interface IProgressMessage {\n\tmessage: string;\n}\n\nexport type ISearchProgressItem = IFileMatch | IProgressMessage;\n\nexport function isFileMatch(p: ISearchProgressItem): p is IFileMatch {\n\treturn !!(<IFileMatch>p).resource;\n}\n\nexport function isProgressMessage(p: ISearchProgressItem | ISerializedSearchProgressItem): p is IProgressMessage {\n\treturn !!(p as IProgressMessage).message;\n}\n\nexport interface ITextSearchCompleteMessage {\n\ttext: string;\n\ttype: TextSearchCompleteMessageType;\n\ttrusted?: boolean;\n}\n\nexport interface ISearchCompleteStats {\n\tlimitHit?: boolean;\n\tmessages: ITextSearchCompleteMessage[];\n\tstats?: IFileSearchStats | ITextSearchStats;\n}\n\nexport interface ISearchComplete extends ISearchCompleteStats {\n\tresults: IFileMatch[];\n\texit?: SearchCompletionExitCode;\n}\n\nexport const enum SearchCompletionExitCode {\n\tNormal,\n\tNewSearchStarted\n}\n\nexport interface ITextSearchStats {\n\ttype: 'textSearchProvider' | 'searchProcess';\n}\n\nexport interface IFileSearchStats {\n\tfromCache: boolean;\n\tdetailStats: ISearchEngineStats | ICachedSearchStats | IFileSearchProviderStats;\n\n\tresultCount: number;\n\ttype: 'fileSearchProvider' | 'searchProcess';\n\tsortingTime?: number;\n}\n\nexport interface ICachedSearchStats {\n\tcacheWasResolved: boolean;\n\tcacheLookupTime: number;\n\tcacheFilterTime: number;\n\tcacheEntryCount: number;\n}\n\nexport interface ISearchEngineStats {\n\tfileWalkTime: number;\n\tdirectoriesWalked: number;\n\tfilesWalked: number;\n\tcmdTime: number;\n\tcmdResultCount?: number;\n}\n\nexport interface IFileSearchProviderStats {\n\tproviderTime: number;\n\tpostProcessTime: number;\n}\n\nexport class FileMatch implements IFileMatch {\n\tresults: ITextSearchResult[] = [];\n\tconstructor(public resource: URI) {\n\t\t// empty\n\t}\n}\n\nexport class TextSearchMatch implements ITextSearchMatch {\n\tranges: ISearchRange | ISearchRange[];\n\tpreview: ITextSearchResultPreview;\n\n\tconstructor(text: string, range: ISearchRange | ISearchRange[], previewOptions?: ITextSearchPreviewOptions) {\n\t\tthis.ranges = range;\n\n\t\t// Trim preview if this is one match and a single-line match with a preview requested.\n\t\t// Otherwise send the full text, like for replace or for showing multiple previews.\n\t\t// TODO this is fishy.\n\t\tconst ranges = Array.isArray(range) ? range : [range];\n\t\tif (previewOptions && previewOptions.matchLines === 1 && isSingleLineRangeList(ranges)) {\n\t\t\t// 1 line preview requested\n\t\t\ttext = getNLines(text, previewOptions.matchLines);\n\n\t\t\tlet result = '';\n\t\t\tlet shift = 0;\n\t\t\tlet lastEnd = 0;\n\t\t\tconst leadingChars = Math.floor(previewOptions.charsPerLine / 5);\n\t\t\tconst matches: ISearchRange[] = [];\n\t\t\tfor (const range of ranges) {\n\t\t\t\tconst previewStart = Math.max(range.startColumn - leadingChars, 0);\n\t\t\t\tconst previewEnd = range.startColumn + previewOptions.charsPerLine;\n\t\t\t\tif (previewStart > lastEnd + leadingChars + SEARCH_ELIDED_MIN_LEN) {\n\t\t\t\t\tconst elision = SEARCH_ELIDED_PREFIX + (previewStart - lastEnd) + SEARCH_ELIDED_SUFFIX;\n\t\t\t\t\tresult += elision + text.slice(previewStart, previewEnd);\n\t\t\t\t\tshift += previewStart - (lastEnd + elision.length);\n\t\t\t\t} else {\n\t\t\t\t\tresult += text.slice(lastEnd, previewEnd);\n\t\t\t\t}\n\n\t\t\t\tmatches.push(new OneLineRange(0, range.startColumn - shift, range.endColumn - shift));\n\t\t\t\tlastEnd = previewEnd;\n\t\t\t}\n\n\t\t\tthis.preview = { text: result, matches: Array.isArray(this.ranges) ? matches : matches[0] };\n\t\t} else {\n\t\t\tconst firstMatchLine = Array.isArray(range) ? range[0].startLineNumber : range.startLineNumber;\n\n\t\t\tthis.preview = {\n\t\t\t\ttext,\n\t\t\t\tmatches: mapArrayOrNot(range, r => new SearchRange(r.startLineNumber - firstMatchLine, r.startColumn, r.endLineNumber - firstMatchLine, r.endColumn))\n\t\t\t};\n\t\t}\n\t}\n}\n\nfunction isSingleLineRangeList(ranges: ISearchRange[]): boolean {\n\tconst line = ranges[0].startLineNumber;\n\tfor (const r of ranges) {\n\t\tif (r.startLineNumber !== line || r.endLineNumber !== line) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n\nexport class SearchRange implements ISearchRange {\n\tstartLineNumber: number;\n\tstartColumn: number;\n\tendLineNumber: number;\n\tendColumn: number;\n\n\tconstructor(startLineNumber: number, startColumn: number, endLineNumber: number, endColumn: number) {\n\t\tthis.startLineNumber = startLineNumber;\n\t\tthis.startColumn = startColumn;\n\t\tthis.endLineNumber = endLineNumber;\n\t\tthis.endColumn = endColumn;\n\t}\n}\n\nexport class OneLineRange extends SearchRange {\n\tconstructor(lineNumber: number, startColumn: number, endColumn: number) {\n\t\tsuper(lineNumber, startColumn, lineNumber, endColumn);\n\t}\n}\n\nexport const enum SearchSortOrder {\n\tDefault = 'default',\n\tFileNames = 'fileNames',\n\tType = 'type',\n\tModified = 'modified',\n\tCountDescending = 'countDescending',\n\tCountAscending = 'countAscending'\n}\n\nexport interface ISearchConfigurationProperties {\n\texclude: glob.IExpression;\n\tuseRipgrep: boolean;\n\t/**\n\t * Use ignore file for file search.\n\t */\n\tuseIgnoreFiles: boolean;\n\tuseGlobalIgnoreFiles: boolean;\n\tuseParentIgnoreFiles: boolean;\n\tfollowSymlinks: boolean;\n\tsmartCase: boolean;\n\tglobalFindClipboard: boolean;\n\tlocation: 'sidebar' | 'panel';\n\tuseReplacePreview: boolean;\n\tshowLineNumbers: boolean;\n\tusePCRE2: boolean;\n\tactionsPosition: 'auto' | 'right';\n\tmaintainFileSearchCache: boolean;\n\tmaxResults: number | null;\n\tcollapseResults: 'auto' | 'alwaysCollapse' | 'alwaysExpand';\n\tsearchOnType: boolean;\n\tseedOnFocus: boolean;\n\tseedWithNearestWord: boolean;\n\tsearchOnTypeDebouncePeriod: number;\n\tmode: 'view' | 'reuseEditor' | 'newEditor';\n\tsearchEditor: {\n\t\tdoubleClickBehaviour: 'selectWord' | 'goToLocation' | 'openLocationToSide';\n\t\treusePriorSearchConfiguration: boolean;\n\t\tdefaultNumberOfContextLines: number | null;\n\t\texperimental: {};\n\t};\n\tsortOrder: SearchSortOrder;\n}\n\nexport interface ISearchConfiguration extends IFilesConfiguration {\n\tsearch: ISearchConfigurationProperties;\n\teditor: {\n\t\twordSeparators: string;\n\t};\n}\n\nexport function getExcludes(configuration: ISearchConfiguration, includeSearchExcludes = true): glob.IExpression | undefined {\n\tconst fileExcludes = configuration && configuration.files && configuration.files.exclude;\n\tconst searchExcludes = includeSearchExcludes && configuration && configuration.search && configuration.search.exclude;\n\n\tif (!fileExcludes && !searchExcludes) {\n\t\treturn undefined;\n\t}\n\n\tif (!fileExcludes || !searchExcludes) {\n\t\treturn fileExcludes || searchExcludes;\n\t}\n\n\tlet allExcludes: glob.IExpression = Object.create(null);\n\t// clone the config as it could be frozen\n\tallExcludes = objects.mixin(allExcludes, objects.deepClone(fileExcludes));\n\tallExcludes = objects.mixin(allExcludes, objects.deepClone(searchExcludes), true);\n\n\treturn allExcludes;\n}\n\nexport function pathIncludedInQuery(queryProps: ICommonQueryProps<URI>, fsPath: string): boolean {\n\tif (queryProps.excludePattern && glob.match(queryProps.excludePattern, fsPath)) {\n\t\treturn false;\n\t}\n\n\tif (queryProps.includePattern || queryProps.usingSearchPaths) {\n\t\tif (queryProps.includePattern && glob.match(queryProps.includePattern, fsPath)) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// If searchPaths are being used, the extra file must be in a subfolder and match the pattern, if present\n\t\tif (queryProps.usingSearchPaths) {\n\t\t\treturn !!queryProps.folderQueries && queryProps.folderQueries.some(fq => {\n\t\t\t\tconst searchPath = fq.folder.fsPath;\n\t\t\t\tif (extpath.isEqualOrParent(fsPath, searchPath)) {\n\t\t\t\t\tconst relPath = paths.relative(searchPath, fsPath);\n\t\t\t\t\treturn !fq.includePattern || !!glob.match(fq.includePattern, relPath);\n\t\t\t\t} else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn false;\n\t}\n\n\treturn true;\n}\n\nexport enum SearchErrorCode {\n\tunknownEncoding = 1,\n\tregexParseError,\n\tglobParseError,\n\tinvalidLiteral,\n\trgProcessError,\n\tother,\n\tcanceled\n}\n\nexport class SearchError extends Error {\n\tconstructor(message: string, readonly code?: SearchErrorCode) {\n\t\tsuper(message);\n\t}\n}\n\nexport function deserializeSearchError(error: Error): SearchError {\n\tconst errorMsg = error.message;\n\n\tif (isCancellationError(error)) {\n\t\treturn new SearchError(errorMsg, SearchErrorCode.canceled);\n\t}\n\n\ttry {\n\t\tconst details = JSON.parse(errorMsg);\n\t\treturn new SearchError(details.message, details.code);\n\t} catch (e) {\n\t\treturn new SearchError(errorMsg, SearchErrorCode.other);\n\t}\n}\n\nexport function serializeSearchError(searchError: SearchError): Error {\n\tconst details = { message: searchError.message, code: searchError.code };\n\treturn new Error(JSON.stringify(details));\n}\nexport interface ITelemetryEvent {\n\teventName: string;\n\tdata: ITelemetryData;\n}\n\nexport interface IRawSearchService {\n\tfileSearch(search: IRawFileQuery): Event<ISerializedSearchProgressItem | ISerializedSearchComplete>;\n\ttextSearch(search: IRawTextQuery): Event<ISerializedSearchProgressItem | ISerializedSearchComplete>;\n\tclearCache(cacheKey: string): Promise<void>;\n}\n\nexport interface IRawFileMatch {\n\tbase?: string;\n\t/**\n\t * The path of the file relative to the containing `base` folder.\n\t * This path is exactly as it appears on the filesystem.\n\t */\n\trelativePath: string;\n\t/**\n\t * This path is transformed for search purposes. For example, this could be\n\t * the `relativePath` with the workspace folder name prepended. This way the\n\t * search algorithm would also match against the name of the containing folder.\n\t *\n\t * If not given, the search algorithm should use `relativePath`.\n\t */\n\tsearchPath: string | undefined;\n}\n\nexport interface ISearchEngine<T> {\n\tsearch: (onResult: (matches: T) => void, onProgress: (progress: IProgressMessage) => void, done: (error: Error | null, complete: ISearchEngineSuccess) => void) => void;\n\tcancel: () => void;\n}\n\nexport interface ISerializedSearchSuccess {\n\ttype: 'success';\n\tlimitHit: boolean;\n\tmessages: ITextSearchCompleteMessage[];\n\tstats?: IFileSearchStats | ITextSearchStats;\n}\n\nexport interface ISearchEngineSuccess {\n\tlimitHit: boolean;\n\tmessages: ITextSearchCompleteMessage[];\n\tstats: ISearchEngineStats;\n}\n\nexport interface ISerializedSearchError {\n\ttype: 'error';\n\terror: {\n\t\tmessage: string;\n\t\tstack: string;\n\t};\n}\n\nexport type ISerializedSearchComplete = ISerializedSearchSuccess | ISerializedSearchError;\n\nexport function isSerializedSearchComplete(arg: ISerializedSearchProgressItem | ISerializedSearchComplete): arg is ISerializedSearchComplete {\n\tif ((arg as any).type === 'error') {\n\t\treturn true;\n\t} else if ((arg as any).type === 'success') {\n\t\treturn true;\n\t} else {\n\t\treturn false;\n\t}\n}\n\nexport function isSerializedSearchSuccess(arg: ISerializedSearchComplete): arg is ISerializedSearchSuccess {\n\treturn arg.type === 'success';\n}\n\nexport function isSerializedFileMatch(arg: ISerializedSearchProgressItem): arg is ISerializedFileMatch {\n\treturn !!(<ISerializedFileMatch>arg).path;\n}\n\nexport function isFilePatternMatch(candidate: IRawFileMatch, normalizedFilePatternLowercase: string): boolean {\n\tconst pathToMatch = candidate.searchPath ? candidate.searchPath : candidate.relativePath;\n\treturn fuzzyContains(pathToMatch, normalizedFilePatternLowercase);\n}\n\nexport interface ISerializedFileMatch {\n\tpath: string;\n\tresults?: ITextSearchResult[];\n\tnumMatches?: number;\n}\n\n// Type of the possible values for progress calls from the engine\nexport type ISerializedSearchProgressItem = ISerializedFileMatch | ISerializedFileMatch[] | IProgressMessage;\nexport type IFileSearchProgressItem = IRawFileMatch | IRawFileMatch[] | IProgressMessage;\n\n\nexport class SerializableFileMatch implements ISerializedFileMatch {\n\tpath: string;\n\tresults: ITextSearchMatch[];\n\n\tconstructor(path: string) {\n\t\tthis.path = path;\n\t\tthis.results = [];\n\t}\n\n\taddMatch(match: ITextSearchMatch): void {\n\t\tthis.results.push(match);\n\t}\n\n\tserialize(): ISerializedFileMatch {\n\t\treturn {\n\t\t\tpath: this.path,\n\t\t\tresults: this.results,\n\t\t\tnumMatches: this.results.length\n\t\t};\n\t}\n}\n\n/**\n *  Computes the patterns that the provider handles. Discards sibling clauses and 'false' patterns\n */\nexport function resolvePatternsForProvider(globalPattern: glob.IExpression | undefined, folderPattern: glob.IExpression | undefined): string[] {\n\tconst merged = {\n\t\t...(globalPattern || {}),\n\t\t...(folderPattern || {})\n\t};\n\n\treturn Object.keys(merged)\n\t\t.filter(key => {\n\t\t\tconst value = merged[key];\n\t\t\treturn typeof value === 'boolean' && value;\n\t\t});\n}\n\nexport class QueryGlobTester {\n\n\tprivate _excludeExpression: glob.IExpression;\n\tprivate _parsedExcludeExpression: glob.ParsedExpression;\n\n\tprivate _parsedIncludeExpression: glob.ParsedExpression | null = null;\n\n\tconstructor(config: ISearchQuery, folderQuery: IFolderQuery) {\n\t\tthis._excludeExpression = {\n\t\t\t...(config.excludePattern || {}),\n\t\t\t...(folderQuery.excludePattern || {})\n\t\t};\n\t\tthis._parsedExcludeExpression = glob.parse(this._excludeExpression);\n\n\t\t// Empty includeExpression means include nothing, so no {} shortcuts\n\t\tlet includeExpression: glob.IExpression | undefined = config.includePattern;\n\t\tif (folderQuery.includePattern) {\n\t\t\tif (includeExpression) {\n\t\t\t\tincludeExpression = {\n\t\t\t\t\t...includeExpression,\n\t\t\t\t\t...folderQuery.includePattern\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tincludeExpression = folderQuery.includePattern;\n\t\t\t}\n\t\t}\n\n\t\tif (includeExpression) {\n\t\t\tthis._parsedIncludeExpression = glob.parse(includeExpression);\n\t\t}\n\t}\n\n\tmatchesExcludesSync(testPath: string, basename?: string, hasSibling?: (name: string) => boolean): boolean {\n\t\tif (this._parsedExcludeExpression && this._parsedExcludeExpression(testPath, basename, hasSibling)) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t/**\n\t * Guaranteed sync - siblingsFn should not return a promise.\n\t */\n\tincludedInQuerySync(testPath: string, basename?: string, hasSibling?: (name: string) => boolean): boolean {\n\t\tif (this._parsedExcludeExpression && this._parsedExcludeExpression(testPath, basename, hasSibling)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this._parsedIncludeExpression && !this._parsedIncludeExpression(testPath, basename, hasSibling)) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t/**\n\t * Evaluating the exclude expression is only async if it includes sibling clauses. As an optimization, avoid doing anything with Promises\n\t * unless the expression is async.\n\t */\n\tincludedInQuery(testPath: string, basename?: string, hasSibling?: (name: string) => boolean | Promise<boolean>): Promise<boolean> | boolean {\n\t\tconst excluded = this._parsedExcludeExpression(testPath, basename, hasSibling);\n\n\t\tconst isIncluded = () => {\n\t\t\treturn this._parsedIncludeExpression ?\n\t\t\t\t!!(this._parsedIncludeExpression(testPath, basename, hasSibling)) :\n\t\t\t\ttrue;\n\t\t};\n\n\t\tif (isThenable(excluded)) {\n\t\t\treturn excluded.then(excluded => {\n\t\t\t\tif (excluded) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn isIncluded();\n\t\t\t});\n\t\t}\n\n\t\treturn isIncluded();\n\t}\n\n\thasSiblingExcludeClauses(): boolean {\n\t\treturn hasSiblingClauses(this._excludeExpression);\n\t}\n}\n\nfunction hasSiblingClauses(pattern: glob.IExpression): boolean {\n\tfor (const key in pattern) {\n\t\tif (typeof pattern[key] !== 'boolean') {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn false;\n}\n\nexport function hasSiblingPromiseFn(siblingsFn?: () => Promise<string[]>) {\n\tif (!siblingsFn) {\n\t\treturn undefined;\n\t}\n\n\tlet siblings: Promise<Record<string, true>>;\n\treturn (name: string) => {\n\t\tif (!siblings) {\n\t\t\tsiblings = (siblingsFn() || Promise.resolve([]))\n\t\t\t\t.then(list => list ? listToMap(list) : {});\n\t\t}\n\t\treturn siblings.then(map => !!map[name]);\n\t};\n}\n\nexport function hasSiblingFn(siblingsFn?: () => string[]) {\n\tif (!siblingsFn) {\n\t\treturn undefined;\n\t}\n\n\tlet siblings: Record<string, true>;\n\treturn (name: string) => {\n\t\tif (!siblings) {\n\t\t\tconst list = siblingsFn();\n\t\t\tsiblings = list ? listToMap(list) : {};\n\t\t}\n\t\treturn !!siblings[name];\n\t};\n}\n\nfunction listToMap(list: string[]) {\n\tconst map: Record<string, true> = {};\n\tfor (const key of list) {\n\t\tmap[key] = true;\n\t}\n\treturn map;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { delta as arrayDelta, mapArrayOrNot } from 'vs/base/common/arrays';\nimport { Barrier } from 'vs/base/common/async';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { TernarySearchTree } from 'vs/base/common/map';\nimport { Schemas } from 'vs/base/common/network';\nimport { Counter } from 'vs/base/common/numbers';\nimport { basename, basenameOrAuthority, dirname, ExtUri, relativePath } from 'vs/base/common/resources';\nimport { compare } from 'vs/base/common/strings';\nimport { withUndefinedAsNull } from 'vs/base/common/types';\nimport { URI } from 'vs/base/common/uri';\nimport { localize } from 'vs/nls';\nimport { ExtensionIdentifier, IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { FileSystemProviderCapabilities } from 'vs/platform/files/common/files';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { Severity } from 'vs/platform/notification/common/notification';\nimport { Workspace, WorkspaceFolder } from 'vs/platform/workspace/common/workspace';\nimport { IExtHostFileSystemInfo } from 'vs/workbench/api/common/extHostFileSystemInfo';\nimport { IExtHostInitDataService } from 'vs/workbench/api/common/extHostInitDataService';\nimport { IExtHostRpcService } from 'vs/workbench/api/common/extHostRpcService';\nimport { GlobPattern } from 'vs/workbench/api/common/extHostTypeConverters';\nimport { Range } from 'vs/workbench/api/common/extHostTypes';\nimport { ITextQueryBuilderOptions } from 'vs/workbench/services/search/common/queryBuilder';\nimport { IRawFileMatch2, resultIsMatch } from 'vs/workbench/services/search/common/search';\nimport * as vscode from 'vscode';\nimport { ExtHostWorkspaceShape, IRelativePatternDto, IWorkspaceData, MainContext, MainThreadMessageOptions, MainThreadMessageServiceShape, MainThreadWorkspaceShape } from './extHost.protocol';\n\nexport interface IExtHostWorkspaceProvider {\n\tgetWorkspaceFolder2(uri: vscode.Uri, resolveParent?: boolean): Promise<vscode.WorkspaceFolder | undefined>;\n\tresolveWorkspaceFolder(uri: vscode.Uri): Promise<vscode.WorkspaceFolder | undefined>;\n\tgetWorkspaceFolders2(): Promise<vscode.WorkspaceFolder[] | undefined>;\n\tresolveProxy(url: string): Promise<string | undefined>;\n}\n\nfunction isFolderEqual(folderA: URI, folderB: URI, extHostFileSystemInfo: IExtHostFileSystemInfo): boolean {\n\treturn new ExtUri(uri => ignorePathCasing(uri, extHostFileSystemInfo)).isEqual(folderA, folderB);\n}\n\nfunction compareWorkspaceFolderByUri(a: vscode.WorkspaceFolder, b: vscode.WorkspaceFolder, extHostFileSystemInfo: IExtHostFileSystemInfo): number {\n\treturn isFolderEqual(a.uri, b.uri, extHostFileSystemInfo) ? 0 : compare(a.uri.toString(), b.uri.toString());\n}\n\nfunction compareWorkspaceFolderByUriAndNameAndIndex(a: vscode.WorkspaceFolder, b: vscode.WorkspaceFolder, extHostFileSystemInfo: IExtHostFileSystemInfo): number {\n\tif (a.index !== b.index) {\n\t\treturn a.index < b.index ? -1 : 1;\n\t}\n\n\treturn isFolderEqual(a.uri, b.uri, extHostFileSystemInfo) ? compare(a.name, b.name) : compare(a.uri.toString(), b.uri.toString());\n}\n\nfunction delta(oldFolders: vscode.WorkspaceFolder[], newFolders: vscode.WorkspaceFolder[], compare: (a: vscode.WorkspaceFolder, b: vscode.WorkspaceFolder, extHostFileSystemInfo: IExtHostFileSystemInfo) => number, extHostFileSystemInfo: IExtHostFileSystemInfo): { removed: vscode.WorkspaceFolder[]; added: vscode.WorkspaceFolder[] } {\n\tconst oldSortedFolders = oldFolders.slice(0).sort((a, b) => compare(a, b, extHostFileSystemInfo));\n\tconst newSortedFolders = newFolders.slice(0).sort((a, b) => compare(a, b, extHostFileSystemInfo));\n\n\treturn arrayDelta(oldSortedFolders, newSortedFolders, (a, b) => compare(a, b, extHostFileSystemInfo));\n}\n\nfunction ignorePathCasing(uri: URI, extHostFileSystemInfo: IExtHostFileSystemInfo): boolean {\n\tconst capabilities = extHostFileSystemInfo.getCapabilities(uri.scheme);\n\treturn !(capabilities && (capabilities & FileSystemProviderCapabilities.PathCaseSensitive));\n}\n\ninterface MutableWorkspaceFolder extends vscode.WorkspaceFolder {\n\tname: string;\n\tindex: number;\n}\n\nclass ExtHostWorkspaceImpl extends Workspace {\n\n\tstatic toExtHostWorkspace(data: IWorkspaceData | null, previousConfirmedWorkspace: ExtHostWorkspaceImpl | undefined, previousUnconfirmedWorkspace: ExtHostWorkspaceImpl | undefined, extHostFileSystemInfo: IExtHostFileSystemInfo): { workspace: ExtHostWorkspaceImpl | null; added: vscode.WorkspaceFolder[]; removed: vscode.WorkspaceFolder[] } {\n\t\tif (!data) {\n\t\t\treturn { workspace: null, added: [], removed: [] };\n\t\t}\n\n\t\tconst { id, name, folders, configuration, transient, isUntitled } = data;\n\t\tconst newWorkspaceFolders: vscode.WorkspaceFolder[] = [];\n\n\t\t// If we have an existing workspace, we try to find the folders that match our\n\t\t// data and update their properties. It could be that an extension stored them\n\t\t// for later use and we want to keep them \"live\" if they are still present.\n\t\tconst oldWorkspace = previousConfirmedWorkspace;\n\t\tif (previousConfirmedWorkspace) {\n\t\t\tfolders.forEach((folderData, index) => {\n\t\t\t\tconst folderUri = URI.revive(folderData.uri);\n\t\t\t\tconst existingFolder = ExtHostWorkspaceImpl._findFolder(previousUnconfirmedWorkspace || previousConfirmedWorkspace, folderUri, extHostFileSystemInfo);\n\n\t\t\t\tif (existingFolder) {\n\t\t\t\t\texistingFolder.name = folderData.name;\n\t\t\t\t\texistingFolder.index = folderData.index;\n\n\t\t\t\t\tnewWorkspaceFolders.push(existingFolder);\n\t\t\t\t} else {\n\t\t\t\t\tnewWorkspaceFolders.push({ uri: folderUri, name: folderData.name, index });\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tnewWorkspaceFolders.push(...folders.map(({ uri, name, index }) => ({ uri: URI.revive(uri), name, index })));\n\t\t}\n\n\t\t// make sure to restore sort order based on index\n\t\tnewWorkspaceFolders.sort((f1, f2) => f1.index < f2.index ? -1 : 1);\n\n\t\tconst workspace = new ExtHostWorkspaceImpl(id, name, newWorkspaceFolders, !!transient, configuration ? URI.revive(configuration) : null, !!isUntitled, uri => ignorePathCasing(uri, extHostFileSystemInfo));\n\t\tconst { added, removed } = delta(oldWorkspace ? oldWorkspace.workspaceFolders : [], workspace.workspaceFolders, compareWorkspaceFolderByUri, extHostFileSystemInfo);\n\n\t\treturn { workspace, added, removed };\n\t}\n\n\tprivate static _findFolder(workspace: ExtHostWorkspaceImpl, folderUriToFind: URI, extHostFileSystemInfo: IExtHostFileSystemInfo): MutableWorkspaceFolder | undefined {\n\t\tfor (let i = 0; i < workspace.folders.length; i++) {\n\t\t\tconst folder = workspace.workspaceFolders[i];\n\t\t\tif (isFolderEqual(folder.uri, folderUriToFind, extHostFileSystemInfo)) {\n\t\t\t\treturn folder;\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate readonly _workspaceFolders: vscode.WorkspaceFolder[] = [];\n\tprivate readonly _structure: TernarySearchTree<URI, vscode.WorkspaceFolder>;\n\n\tconstructor(id: string, private _name: string, folders: vscode.WorkspaceFolder[], transient: boolean, configuration: URI | null, private _isUntitled: boolean, ignorePathCasing: (key: URI) => boolean) {\n\t\tsuper(id, folders.map(f => new WorkspaceFolder(f)), transient, configuration, ignorePathCasing);\n\t\tthis._structure = TernarySearchTree.forUris<vscode.WorkspaceFolder>(ignorePathCasing);\n\n\t\t// setup the workspace folder data structure\n\t\tfolders.forEach(folder => {\n\t\t\tthis._workspaceFolders.push(folder);\n\t\t\tthis._structure.set(folder.uri, folder);\n\t\t});\n\t}\n\n\tget name(): string {\n\t\treturn this._name;\n\t}\n\n\tget isUntitled(): boolean {\n\t\treturn this._isUntitled;\n\t}\n\n\tget workspaceFolders(): vscode.WorkspaceFolder[] {\n\t\treturn this._workspaceFolders.slice(0);\n\t}\n\n\tgetWorkspaceFolder(uri: URI, resolveParent?: boolean): vscode.WorkspaceFolder | undefined {\n\t\tif (resolveParent && this._structure.get(uri)) {\n\t\t\t// `uri` is a workspace folder so we check for its parent\n\t\t\turi = dirname(uri);\n\t\t}\n\t\treturn this._structure.findSubstr(uri);\n\t}\n\n\tresolveWorkspaceFolder(uri: URI): vscode.WorkspaceFolder | undefined {\n\t\treturn this._structure.get(uri);\n\t}\n}\n\nexport class ExtHostWorkspace implements ExtHostWorkspaceShape, IExtHostWorkspaceProvider {\n\n\treadonly _serviceBrand: undefined;\n\n\tprivate readonly _onDidChangeWorkspace = new Emitter<vscode.WorkspaceFoldersChangeEvent>();\n\treadonly onDidChangeWorkspace: Event<vscode.WorkspaceFoldersChangeEvent> = this._onDidChangeWorkspace.event;\n\n\tprivate readonly _onDidGrantWorkspaceTrust = new Emitter<void>();\n\treadonly onDidGrantWorkspaceTrust: Event<void> = this._onDidGrantWorkspaceTrust.event;\n\n\tprivate readonly _logService: ILogService;\n\tprivate readonly _requestIdProvider: Counter;\n\tprivate readonly _barrier: Barrier;\n\n\tprivate _confirmedWorkspace?: ExtHostWorkspaceImpl;\n\tprivate _unconfirmedWorkspace?: ExtHostWorkspaceImpl;\n\n\tprivate readonly _proxy: MainThreadWorkspaceShape;\n\tprivate readonly _messageService: MainThreadMessageServiceShape;\n\tprivate readonly _extHostFileSystemInfo: IExtHostFileSystemInfo;\n\n\tprivate readonly _activeSearchCallbacks: ((match: IRawFileMatch2) => any)[] = [];\n\n\tprivate _trusted: boolean = false;\n\n\tconstructor(\n\t\t@IExtHostRpcService extHostRpc: IExtHostRpcService,\n\t\t@IExtHostInitDataService initData: IExtHostInitDataService,\n\t\t@IExtHostFileSystemInfo extHostFileSystemInfo: IExtHostFileSystemInfo,\n\t\t@ILogService logService: ILogService,\n\t) {\n\t\tthis._logService = logService;\n\t\tthis._extHostFileSystemInfo = extHostFileSystemInfo;\n\t\tthis._requestIdProvider = new Counter();\n\t\tthis._barrier = new Barrier();\n\n\t\tthis._proxy = extHostRpc.getProxy(MainContext.MainThreadWorkspace);\n\t\tthis._messageService = extHostRpc.getProxy(MainContext.MainThreadMessageService);\n\t\tconst data = initData.workspace;\n\t\tthis._confirmedWorkspace = data ? new ExtHostWorkspaceImpl(data.id, data.name, [], !!data.transient, data.configuration ? URI.revive(data.configuration) : null, !!data.isUntitled, uri => ignorePathCasing(uri, extHostFileSystemInfo)) : undefined;\n\t}\n\n\t$initializeWorkspace(data: IWorkspaceData | null, trusted: boolean): void {\n\t\tthis._trusted = trusted;\n\t\tthis.$acceptWorkspaceData(data);\n\t\tthis._barrier.open();\n\t}\n\n\twaitForInitializeCall(): Promise<boolean> {\n\t\treturn this._barrier.wait();\n\t}\n\n\t// --- workspace ---\n\n\tget workspace(): Workspace | undefined {\n\t\treturn this._actualWorkspace;\n\t}\n\n\tget name(): string | undefined {\n\t\treturn this._actualWorkspace ? this._actualWorkspace.name : undefined;\n\t}\n\n\tget workspaceFile(): vscode.Uri | undefined {\n\t\tif (this._actualWorkspace) {\n\t\t\tif (this._actualWorkspace.configuration) {\n\t\t\t\tif (this._actualWorkspace.isUntitled) {\n\t\t\t\t\treturn URI.from({ scheme: Schemas.untitled, path: basename(dirname(this._actualWorkspace.configuration)) }); // Untitled Workspace: return untitled URI\n\t\t\t\t}\n\n\t\t\t\treturn this._actualWorkspace.configuration; // Workspace: return the configuration location\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate get _actualWorkspace(): ExtHostWorkspaceImpl | undefined {\n\t\treturn this._unconfirmedWorkspace || this._confirmedWorkspace;\n\t}\n\n\tgetWorkspaceFolders(): vscode.WorkspaceFolder[] | undefined {\n\t\tif (!this._actualWorkspace) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn this._actualWorkspace.workspaceFolders.slice(0);\n\t}\n\n\tasync getWorkspaceFolders2(): Promise<vscode.WorkspaceFolder[] | undefined> {\n\t\tawait this._barrier.wait();\n\t\tif (!this._actualWorkspace) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn this._actualWorkspace.workspaceFolders.slice(0);\n\t}\n\n\tupdateWorkspaceFolders(extension: IExtensionDescription, index: number, deleteCount: number, ...workspaceFoldersToAdd: { uri: vscode.Uri; name?: string }[]): boolean {\n\t\tconst validatedDistinctWorkspaceFoldersToAdd: { uri: vscode.Uri; name?: string }[] = [];\n\t\tif (Array.isArray(workspaceFoldersToAdd)) {\n\t\t\tworkspaceFoldersToAdd.forEach(folderToAdd => {\n\t\t\t\tif (URI.isUri(folderToAdd.uri) && !validatedDistinctWorkspaceFoldersToAdd.some(f => isFolderEqual(f.uri, folderToAdd.uri, this._extHostFileSystemInfo))) {\n\t\t\t\t\tvalidatedDistinctWorkspaceFoldersToAdd.push({ uri: folderToAdd.uri, name: folderToAdd.name || basenameOrAuthority(folderToAdd.uri) });\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (!!this._unconfirmedWorkspace) {\n\t\t\treturn false; // prevent accumulated calls without a confirmed workspace\n\t\t}\n\n\t\tif ([index, deleteCount].some(i => typeof i !== 'number' || i < 0)) {\n\t\t\treturn false; // validate numbers\n\t\t}\n\n\t\tif (deleteCount === 0 && validatedDistinctWorkspaceFoldersToAdd.length === 0) {\n\t\t\treturn false; // nothing to delete or add\n\t\t}\n\n\t\tconst currentWorkspaceFolders: MutableWorkspaceFolder[] = this._actualWorkspace ? this._actualWorkspace.workspaceFolders : [];\n\t\tif (index + deleteCount > currentWorkspaceFolders.length) {\n\t\t\treturn false; // cannot delete more than we have\n\t\t}\n\n\t\t// Simulate the updateWorkspaceFolders method on our data to do more validation\n\t\tconst newWorkspaceFolders = currentWorkspaceFolders.slice(0);\n\t\tnewWorkspaceFolders.splice(index, deleteCount, ...validatedDistinctWorkspaceFoldersToAdd.map(f => ({ uri: f.uri, name: f.name || basenameOrAuthority(f.uri), index: undefined! /* fixed later */ })));\n\n\t\tfor (let i = 0; i < newWorkspaceFolders.length; i++) {\n\t\t\tconst folder = newWorkspaceFolders[i];\n\t\t\tif (newWorkspaceFolders.some((otherFolder, index) => index !== i && isFolderEqual(folder.uri, otherFolder.uri, this._extHostFileSystemInfo))) {\n\t\t\t\treturn false; // cannot add the same folder multiple times\n\t\t\t}\n\t\t}\n\n\t\tnewWorkspaceFolders.forEach((f, index) => f.index = index); // fix index\n\t\tconst { added, removed } = delta(currentWorkspaceFolders, newWorkspaceFolders, compareWorkspaceFolderByUriAndNameAndIndex, this._extHostFileSystemInfo);\n\t\tif (added.length === 0 && removed.length === 0) {\n\t\t\treturn false; // nothing actually changed\n\t\t}\n\n\t\t// Trigger on main side\n\t\tif (this._proxy) {\n\t\t\tconst extName = extension.displayName || extension.name;\n\t\t\tthis._proxy.$updateWorkspaceFolders(extName, index, deleteCount, validatedDistinctWorkspaceFoldersToAdd).then(undefined, error => {\n\n\t\t\t\t// in case of an error, make sure to clear out the unconfirmed workspace\n\t\t\t\t// because we cannot expect the acknowledgement from the main side for this\n\t\t\t\tthis._unconfirmedWorkspace = undefined;\n\n\t\t\t\t// show error to user\n\t\t\t\tconst options: MainThreadMessageOptions = { source: { identifier: extension.identifier, label: extension.displayName || extension.name } };\n\t\t\t\tthis._messageService.$showMessage(Severity.Error, localize('updateerror', \"Extension '{0}' failed to update workspace folders: {1}\", extName, error.toString()), options, []);\n\t\t\t});\n\t\t}\n\n\t\t// Try to accept directly\n\t\tthis.trySetWorkspaceFolders(newWorkspaceFolders);\n\n\t\treturn true;\n\t}\n\n\tgetWorkspaceFolder(uri: vscode.Uri, resolveParent?: boolean): vscode.WorkspaceFolder | undefined {\n\t\tif (!this._actualWorkspace) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn this._actualWorkspace.getWorkspaceFolder(uri, resolveParent);\n\t}\n\n\tasync getWorkspaceFolder2(uri: vscode.Uri, resolveParent?: boolean): Promise<vscode.WorkspaceFolder | undefined> {\n\t\tawait this._barrier.wait();\n\t\tif (!this._actualWorkspace) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn this._actualWorkspace.getWorkspaceFolder(uri, resolveParent);\n\t}\n\n\tasync resolveWorkspaceFolder(uri: vscode.Uri): Promise<vscode.WorkspaceFolder | undefined> {\n\t\tawait this._barrier.wait();\n\t\tif (!this._actualWorkspace) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn this._actualWorkspace.resolveWorkspaceFolder(uri);\n\t}\n\n\tgetPath(): string | undefined {\n\n\t\t// this is legacy from the days before having\n\t\t// multi-root and we keep it only alive if there\n\t\t// is just one workspace folder.\n\t\tif (!this._actualWorkspace) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst { folders } = this._actualWorkspace;\n\t\tif (folders.length === 0) {\n\t\t\treturn undefined;\n\t\t}\n\t\t// #54483 @Joh Why are we still using fsPath?\n\t\treturn folders[0].uri.fsPath;\n\t}\n\n\tgetRelativePath(pathOrUri: string | vscode.Uri, includeWorkspace?: boolean): string {\n\n\t\tlet resource: URI | undefined;\n\t\tlet path: string = '';\n\t\tif (typeof pathOrUri === 'string') {\n\t\t\tresource = URI.file(pathOrUri);\n\t\t\tpath = pathOrUri;\n\t\t} else if (typeof pathOrUri !== 'undefined') {\n\t\t\tresource = pathOrUri;\n\t\t\tpath = pathOrUri.fsPath;\n\t\t}\n\n\t\tif (!resource) {\n\t\t\treturn path;\n\t\t}\n\n\t\tconst folder = this.getWorkspaceFolder(\n\t\t\tresource,\n\t\t\ttrue\n\t\t);\n\n\t\tif (!folder) {\n\t\t\treturn path;\n\t\t}\n\n\t\tif (typeof includeWorkspace === 'undefined' && this._actualWorkspace) {\n\t\t\tincludeWorkspace = this._actualWorkspace.folders.length > 1;\n\t\t}\n\n\t\tlet result = relativePath(folder.uri, resource);\n\t\tif (includeWorkspace && folder.name) {\n\t\t\tresult = `${folder.name}/${result}`;\n\t\t}\n\t\treturn result!;\n\t}\n\n\tprivate trySetWorkspaceFolders(folders: vscode.WorkspaceFolder[]): void {\n\n\t\t// Update directly here. The workspace is unconfirmed as long as we did not get an\n\t\t// acknowledgement from the main side (via $acceptWorkspaceData)\n\t\tif (this._actualWorkspace) {\n\t\t\tthis._unconfirmedWorkspace = ExtHostWorkspaceImpl.toExtHostWorkspace({\n\t\t\t\tid: this._actualWorkspace.id,\n\t\t\t\tname: this._actualWorkspace.name,\n\t\t\t\tconfiguration: this._actualWorkspace.configuration,\n\t\t\t\tfolders,\n\t\t\t\tisUntitled: this._actualWorkspace.isUntitled\n\t\t\t} as IWorkspaceData, this._actualWorkspace, undefined, this._extHostFileSystemInfo).workspace || undefined;\n\t\t}\n\t}\n\n\t$acceptWorkspaceData(data: IWorkspaceData | null): void {\n\n\t\tconst { workspace, added, removed } = ExtHostWorkspaceImpl.toExtHostWorkspace(data, this._confirmedWorkspace, this._unconfirmedWorkspace, this._extHostFileSystemInfo);\n\n\t\t// Update our workspace object. We have a confirmed workspace, so we drop our\n\t\t// unconfirmed workspace.\n\t\tthis._confirmedWorkspace = workspace || undefined;\n\t\tthis._unconfirmedWorkspace = undefined;\n\n\t\t// Events\n\t\tthis._onDidChangeWorkspace.fire(Object.freeze({\n\t\t\tadded,\n\t\t\tremoved,\n\t\t}));\n\t}\n\n\t// --- search ---\n\n\t/**\n\t * Note, null/undefined have different and important meanings for \"exclude\"\n\t */\n\tfindFiles(include: vscode.GlobPattern | undefined, exclude: vscode.GlobPattern | null | undefined, maxResults: number | undefined, extensionId: ExtensionIdentifier, token: vscode.CancellationToken = CancellationToken.None): Promise<vscode.Uri[]> {\n\t\tthis._logService.trace(`extHostWorkspace#findFiles: fileSearch, extension: ${extensionId.value}, entryPoint: findFiles`);\n\n\t\tlet excludePatternOrDisregardExcludes: string | false | undefined = undefined;\n\t\tif (exclude === null) {\n\t\t\texcludePatternOrDisregardExcludes = false;\n\t\t} else if (exclude) {\n\t\t\tif (typeof exclude === 'string') {\n\t\t\t\texcludePatternOrDisregardExcludes = exclude;\n\t\t\t} else {\n\t\t\t\texcludePatternOrDisregardExcludes = exclude.pattern;\n\t\t\t}\n\t\t}\n\n\t\tif (token && token.isCancellationRequested) {\n\t\t\treturn Promise.resolve([]);\n\t\t}\n\n\t\tconst { includePattern, folder } = parseSearchInclude(GlobPattern.from(include));\n\t\treturn this._proxy.$startFileSearch(\n\t\t\twithUndefinedAsNull(includePattern),\n\t\t\twithUndefinedAsNull(folder),\n\t\t\twithUndefinedAsNull(excludePatternOrDisregardExcludes),\n\t\t\twithUndefinedAsNull(maxResults),\n\t\t\ttoken\n\t\t)\n\t\t\t.then(data => Array.isArray(data) ? data.map(d => URI.revive(d)) : []);\n\t}\n\n\tasync findTextInFiles(query: vscode.TextSearchQuery, options: vscode.FindTextInFilesOptions, callback: (result: vscode.TextSearchResult) => void, extensionId: ExtensionIdentifier, token: vscode.CancellationToken = CancellationToken.None): Promise<vscode.TextSearchComplete> {\n\t\tthis._logService.trace(`extHostWorkspace#findTextInFiles: textSearch, extension: ${extensionId.value}, entryPoint: findTextInFiles`);\n\n\t\tconst requestId = this._requestIdProvider.getNext();\n\n\t\tconst previewOptions: vscode.TextSearchPreviewOptions = typeof options.previewOptions === 'undefined' ?\n\t\t\t{\n\t\t\t\tmatchLines: 100,\n\t\t\t\tcharsPerLine: 10000\n\t\t\t} :\n\t\t\toptions.previewOptions;\n\n\t\tconst { includePattern, folder } = parseSearchInclude(GlobPattern.from(options.include));\n\t\tconst excludePattern = (typeof options.exclude === 'string') ? options.exclude :\n\t\t\toptions.exclude ? options.exclude.pattern : undefined;\n\t\tconst queryOptions: ITextQueryBuilderOptions = {\n\t\t\tignoreSymlinks: typeof options.followSymlinks === 'boolean' ? !options.followSymlinks : undefined,\n\t\t\tdisregardIgnoreFiles: typeof options.useIgnoreFiles === 'boolean' ? !options.useIgnoreFiles : undefined,\n\t\t\tdisregardGlobalIgnoreFiles: typeof options.useGlobalIgnoreFiles === 'boolean' ? !options.useGlobalIgnoreFiles : undefined,\n\t\t\tdisregardParentIgnoreFiles: typeof options.useParentIgnoreFiles === 'boolean' ? !options.useParentIgnoreFiles : undefined,\n\t\t\tdisregardExcludeSettings: typeof options.useDefaultExcludes === 'boolean' ? !options.useDefaultExcludes : true,\n\t\t\tfileEncoding: options.encoding,\n\t\t\tmaxResults: options.maxResults,\n\t\t\tpreviewOptions,\n\t\t\tafterContext: options.afterContext,\n\t\t\tbeforeContext: options.beforeContext,\n\n\t\t\tincludePattern: includePattern,\n\t\t\texcludePattern: excludePattern\n\t\t};\n\n\t\tconst isCanceled = false;\n\n\t\tthis._activeSearchCallbacks[requestId] = p => {\n\t\t\tif (isCanceled) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst uri = URI.revive(p.resource);\n\t\t\tp.results!.forEach(result => {\n\t\t\t\tif (resultIsMatch(result)) {\n\t\t\t\t\tcallback(<vscode.TextSearchMatch>{\n\t\t\t\t\t\turi,\n\t\t\t\t\t\tpreview: {\n\t\t\t\t\t\t\ttext: result.preview.text,\n\t\t\t\t\t\t\tmatches: mapArrayOrNot(\n\t\t\t\t\t\t\t\tresult.preview.matches,\n\t\t\t\t\t\t\t\tm => new Range(m.startLineNumber, m.startColumn, m.endLineNumber, m.endColumn))\n\t\t\t\t\t\t},\n\t\t\t\t\t\tranges: mapArrayOrNot(\n\t\t\t\t\t\t\tresult.ranges,\n\t\t\t\t\t\t\tr => new Range(r.startLineNumber, r.startColumn, r.endLineNumber, r.endColumn))\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tcallback(<vscode.TextSearchContext>{\n\t\t\t\t\t\turi,\n\t\t\t\t\t\ttext: result.text,\n\t\t\t\t\t\tlineNumber: result.lineNumber\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tif (token.isCancellationRequested) {\n\t\t\treturn {};\n\t\t}\n\n\t\ttry {\n\t\t\tconst result = await this._proxy.$startTextSearch(\n\t\t\t\tquery,\n\t\t\t\twithUndefinedAsNull(folder),\n\t\t\t\tqueryOptions,\n\t\t\t\trequestId,\n\t\t\t\ttoken);\n\t\t\tdelete this._activeSearchCallbacks[requestId];\n\t\t\treturn result || {};\n\t\t} catch (err) {\n\t\t\tdelete this._activeSearchCallbacks[requestId];\n\t\t\tthrow err;\n\t\t}\n\t}\n\n\t$handleTextSearchResult(result: IRawFileMatch2, requestId: number): void {\n\t\tthis._activeSearchCallbacks[requestId]?.(result);\n\t}\n\n\tsaveAll(includeUntitled?: boolean): Promise<boolean> {\n\t\treturn this._proxy.$saveAll(includeUntitled);\n\t}\n\n\tresolveProxy(url: string): Promise<string | undefined> {\n\t\treturn this._proxy.$resolveProxy(url);\n\t}\n\n\t// --- trust ---\n\n\tget trusted(): boolean {\n\t\treturn this._trusted;\n\t}\n\n\trequestWorkspaceTrust(options?: vscode.WorkspaceTrustRequestOptions): Promise<boolean | undefined> {\n\t\treturn this._proxy.$requestWorkspaceTrust(options);\n\t}\n\n\t$onDidGrantWorkspaceTrust(): void {\n\t\tif (!this._trusted) {\n\t\t\tthis._trusted = true;\n\t\t\tthis._onDidGrantWorkspaceTrust.fire();\n\t\t}\n\t}\n}\n\nexport const IExtHostWorkspace = createDecorator<IExtHostWorkspace>('IExtHostWorkspace');\nexport interface IExtHostWorkspace extends ExtHostWorkspace, ExtHostWorkspaceShape, IExtHostWorkspaceProvider { }\n\nfunction parseSearchInclude(include: string | IRelativePatternDto | undefined | null): { includePattern?: string; folder?: URI } {\n\tlet includePattern: string | undefined;\n\tlet includeFolder: URI | undefined;\n\tif (include) {\n\t\tif (typeof include === 'string') {\n\t\t\tincludePattern = include;\n\t\t} else {\n\t\t\tincludePattern = include.pattern;\n\t\t\tincludeFolder = URI.revive(include.baseUri);\n\t\t}\n\t}\n\n\treturn {\n\t\tincludePattern,\n\t\tfolder: includeFolder\n\t};\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { mixin, deepClone } from 'vs/base/common/objects';\nimport { Event, Emitter } from 'vs/base/common/event';\nimport type * as vscode from 'vscode';\nimport { ExtHostWorkspace, IExtHostWorkspace } from 'vs/workbench/api/common/extHostWorkspace';\nimport { ExtHostConfigurationShape, MainThreadConfigurationShape, IConfigurationInitData, MainContext } from './extHost.protocol';\nimport { ConfigurationTarget as ExtHostConfigurationTarget } from './extHostTypes';\nimport { ConfigurationTarget, IConfigurationChange, IConfigurationData, IConfigurationOverrides } from 'vs/platform/configuration/common/configuration';\nimport { Configuration, ConfigurationChangeEvent } from 'vs/platform/configuration/common/configurationModels';\nimport { ConfigurationScope, OVERRIDE_PROPERTY_REGEX } from 'vs/platform/configuration/common/configurationRegistry';\nimport { isObject } from 'vs/base/common/types';\nimport { ExtensionIdentifier, IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { Barrier } from 'vs/base/common/async';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { IExtHostRpcService } from 'vs/workbench/api/common/extHostRpcService';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { Workspace } from 'vs/platform/workspace/common/workspace';\nimport { URI } from 'vs/base/common/uri';\n\nfunction lookUp(tree: any, key: string) {\n\tif (key) {\n\t\tconst parts = key.split('.');\n\t\tlet node = tree;\n\t\tfor (let i = 0; node && i < parts.length; i++) {\n\t\t\tnode = node[parts[i]];\n\t\t}\n\t\treturn node;\n\t}\n}\n\ntype ConfigurationInspect<T> = {\n\tkey: string;\n\n\tdefaultValue?: T;\n\tglobalValue?: T;\n\tworkspaceValue?: T;\n\tworkspaceFolderValue?: T;\n\n\tdefaultLanguageValue?: T;\n\tglobalLanguageValue?: T;\n\tworkspaceLanguageValue?: T;\n\tworkspaceFolderLanguageValue?: T;\n\n\tlanguageIds?: string[];\n};\n\nfunction isUri(thing: any): thing is vscode.Uri {\n\treturn thing instanceof URI;\n}\n\nfunction isResourceLanguage(thing: any): thing is { uri: URI; languageId: string } {\n\treturn thing\n\t\t&& thing.uri instanceof URI\n\t\t&& (thing.languageId && typeof thing.languageId === 'string');\n}\n\nfunction isLanguage(thing: any): thing is { languageId: string } {\n\treturn thing\n\t\t&& !thing.uri\n\t\t&& (thing.languageId && typeof thing.languageId === 'string');\n}\n\nfunction isWorkspaceFolder(thing: any): thing is vscode.WorkspaceFolder {\n\treturn thing\n\t\t&& thing.uri instanceof URI\n\t\t&& (!thing.name || typeof thing.name === 'string')\n\t\t&& (!thing.index || typeof thing.index === 'number');\n}\n\nfunction scopeToOverrides(scope: vscode.ConfigurationScope | undefined | null): IConfigurationOverrides | undefined {\n\tif (isUri(scope)) {\n\t\treturn { resource: scope };\n\t}\n\tif (isResourceLanguage(scope)) {\n\t\treturn { resource: scope.uri, overrideIdentifier: scope.languageId };\n\t}\n\tif (isLanguage(scope)) {\n\t\treturn { overrideIdentifier: scope.languageId };\n\t}\n\tif (isWorkspaceFolder(scope)) {\n\t\treturn { resource: scope.uri };\n\t}\n\tif (scope === null) {\n\t\treturn { resource: null };\n\t}\n\treturn undefined;\n}\n\nexport class ExtHostConfiguration implements ExtHostConfigurationShape {\n\n\treadonly _serviceBrand: undefined;\n\n\tprivate readonly _proxy: MainThreadConfigurationShape;\n\tprivate readonly _logService: ILogService;\n\tprivate readonly _extHostWorkspace: ExtHostWorkspace;\n\tprivate readonly _barrier: Barrier;\n\tprivate _actual: ExtHostConfigProvider | null;\n\n\tconstructor(\n\t\t@IExtHostRpcService extHostRpc: IExtHostRpcService,\n\t\t@IExtHostWorkspace extHostWorkspace: IExtHostWorkspace,\n\t\t@ILogService logService: ILogService,\n\t) {\n\t\tthis._proxy = extHostRpc.getProxy(MainContext.MainThreadConfiguration);\n\t\tthis._extHostWorkspace = extHostWorkspace;\n\t\tthis._logService = logService;\n\t\tthis._barrier = new Barrier();\n\t\tthis._actual = null;\n\t}\n\n\tpublic getConfigProvider(): Promise<ExtHostConfigProvider> {\n\t\treturn this._barrier.wait().then(_ => this._actual!);\n\t}\n\n\t$initializeConfiguration(data: IConfigurationInitData): void {\n\t\tthis._actual = new ExtHostConfigProvider(this._proxy, this._extHostWorkspace, data, this._logService);\n\t\tthis._barrier.open();\n\t}\n\n\t$acceptConfigurationChanged(data: IConfigurationInitData, change: IConfigurationChange): void {\n\t\tthis.getConfigProvider().then(provider => provider.$acceptConfigurationChanged(data, change));\n\t}\n}\n\nexport class ExtHostConfigProvider {\n\n\tprivate readonly _onDidChangeConfiguration = new Emitter<vscode.ConfigurationChangeEvent>();\n\tprivate readonly _proxy: MainThreadConfigurationShape;\n\tprivate readonly _extHostWorkspace: ExtHostWorkspace;\n\tprivate _configurationScopes: Map<string, ConfigurationScope | undefined>;\n\tprivate _configuration: Configuration;\n\tprivate _logService: ILogService;\n\n\tconstructor(proxy: MainThreadConfigurationShape, extHostWorkspace: ExtHostWorkspace, data: IConfigurationInitData, logService: ILogService) {\n\t\tthis._proxy = proxy;\n\t\tthis._logService = logService;\n\t\tthis._extHostWorkspace = extHostWorkspace;\n\t\tthis._configuration = Configuration.parse(data);\n\t\tthis._configurationScopes = this._toMap(data.configurationScopes);\n\t}\n\n\tget onDidChangeConfiguration(): Event<vscode.ConfigurationChangeEvent> {\n\t\treturn this._onDidChangeConfiguration && this._onDidChangeConfiguration.event;\n\t}\n\n\t$acceptConfigurationChanged(data: IConfigurationInitData, change: IConfigurationChange) {\n\t\tconst previous = { data: this._configuration.toData(), workspace: this._extHostWorkspace.workspace };\n\t\tthis._configuration = Configuration.parse(data);\n\t\tthis._configurationScopes = this._toMap(data.configurationScopes);\n\t\tthis._onDidChangeConfiguration.fire(this._toConfigurationChangeEvent(change, previous));\n\t}\n\n\tgetConfiguration(section?: string, scope?: vscode.ConfigurationScope | null, extensionDescription?: IExtensionDescription): vscode.WorkspaceConfiguration {\n\t\tconst overrides = scopeToOverrides(scope) || {};\n\t\tconst config = this._toReadonlyValue(section\n\t\t\t? lookUp(this._configuration.getValue(undefined, overrides, this._extHostWorkspace.workspace), section)\n\t\t\t: this._configuration.getValue(undefined, overrides, this._extHostWorkspace.workspace));\n\n\t\tif (section) {\n\t\t\tthis._validateConfigurationAccess(section, overrides, extensionDescription?.identifier);\n\t\t}\n\n\t\tfunction parseConfigurationTarget(arg: boolean | ExtHostConfigurationTarget): ConfigurationTarget | null {\n\t\t\tif (arg === undefined || arg === null) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tif (typeof arg === 'boolean') {\n\t\t\t\treturn arg ? ConfigurationTarget.USER : ConfigurationTarget.WORKSPACE;\n\t\t\t}\n\n\t\t\tswitch (arg) {\n\t\t\t\tcase ExtHostConfigurationTarget.Global: return ConfigurationTarget.USER;\n\t\t\t\tcase ExtHostConfigurationTarget.Workspace: return ConfigurationTarget.WORKSPACE;\n\t\t\t\tcase ExtHostConfigurationTarget.WorkspaceFolder: return ConfigurationTarget.WORKSPACE_FOLDER;\n\t\t\t}\n\t\t}\n\n\t\tconst result: vscode.WorkspaceConfiguration = {\n\t\t\thas(key: string): boolean {\n\t\t\t\treturn typeof lookUp(config, key) !== 'undefined';\n\t\t\t},\n\t\t\tget: <T>(key: string, defaultValue?: T) => {\n\t\t\t\tthis._validateConfigurationAccess(section ? `${section}.${key}` : key, overrides, extensionDescription?.identifier);\n\t\t\t\tlet result = lookUp(config, key);\n\t\t\t\tif (typeof result === 'undefined') {\n\t\t\t\t\tresult = defaultValue;\n\t\t\t\t} else {\n\t\t\t\t\tlet clonedConfig: any | undefined = undefined;\n\t\t\t\t\tconst cloneOnWriteProxy = (target: any, accessor: string): any => {\n\t\t\t\t\t\tlet clonedTarget: any | undefined = undefined;\n\t\t\t\t\t\tconst cloneTarget = () => {\n\t\t\t\t\t\t\tclonedConfig = clonedConfig ? clonedConfig : deepClone(config);\n\t\t\t\t\t\t\tclonedTarget = clonedTarget ? clonedTarget : lookUp(clonedConfig, accessor);\n\t\t\t\t\t\t};\n\t\t\t\t\t\treturn isObject(target) ?\n\t\t\t\t\t\t\tnew Proxy(target, {\n\t\t\t\t\t\t\t\tget: (target: any, property: PropertyKey) => {\n\t\t\t\t\t\t\t\t\tif (typeof property === 'string' && property.toLowerCase() === 'tojson') {\n\t\t\t\t\t\t\t\t\t\tcloneTarget();\n\t\t\t\t\t\t\t\t\t\treturn () => clonedTarget;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (clonedConfig) {\n\t\t\t\t\t\t\t\t\t\tclonedTarget = clonedTarget ? clonedTarget : lookUp(clonedConfig, accessor);\n\t\t\t\t\t\t\t\t\t\treturn clonedTarget[property];\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tconst result = target[property];\n\t\t\t\t\t\t\t\t\tif (typeof property === 'string') {\n\t\t\t\t\t\t\t\t\t\treturn cloneOnWriteProxy(result, `${accessor}.${property}`);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn result;\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tset: (_target: any, property: PropertyKey, value: any) => {\n\t\t\t\t\t\t\t\t\tcloneTarget();\n\t\t\t\t\t\t\t\t\tif (clonedTarget) {\n\t\t\t\t\t\t\t\t\t\tclonedTarget[property] = value;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdeleteProperty: (_target: any, property: PropertyKey) => {\n\t\t\t\t\t\t\t\t\tcloneTarget();\n\t\t\t\t\t\t\t\t\tif (clonedTarget) {\n\t\t\t\t\t\t\t\t\t\tdelete clonedTarget[property];\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdefineProperty: (_target: any, property: PropertyKey, descriptor: any) => {\n\t\t\t\t\t\t\t\t\tcloneTarget();\n\t\t\t\t\t\t\t\t\tif (clonedTarget) {\n\t\t\t\t\t\t\t\t\t\tObject.defineProperty(clonedTarget, property, descriptor);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}) : target;\n\t\t\t\t\t};\n\t\t\t\t\tresult = cloneOnWriteProxy(result, key);\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\tupdate: (key: string, value: any, extHostConfigurationTarget: ExtHostConfigurationTarget | boolean, scopeToLanguage?: boolean) => {\n\t\t\t\tkey = section ? `${section}.${key}` : key;\n\t\t\t\tconst target = parseConfigurationTarget(extHostConfigurationTarget);\n\t\t\t\tif (value !== undefined) {\n\t\t\t\t\treturn this._proxy.$updateConfigurationOption(target, key, value, overrides, scopeToLanguage);\n\t\t\t\t} else {\n\t\t\t\t\treturn this._proxy.$removeConfigurationOption(target, key, overrides, scopeToLanguage);\n\t\t\t\t}\n\t\t\t},\n\t\t\tinspect: <T>(key: string): ConfigurationInspect<T> | undefined => {\n\t\t\t\tkey = section ? `${section}.${key}` : key;\n\t\t\t\tconst config = deepClone(this._configuration.inspect<T>(key, overrides, this._extHostWorkspace.workspace));\n\t\t\t\tif (config) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tkey,\n\n\t\t\t\t\t\tdefaultValue: config.policy?.value ?? config.default?.value,\n\t\t\t\t\t\tglobalValue: config.user?.value ?? config.application?.value,\n\t\t\t\t\t\tworkspaceValue: config.workspace?.value,\n\t\t\t\t\t\tworkspaceFolderValue: config.workspaceFolder?.value,\n\n\t\t\t\t\t\tdefaultLanguageValue: config.default?.override,\n\t\t\t\t\t\tglobalLanguageValue: config.user?.override ?? config.application?.override,\n\t\t\t\t\t\tworkspaceLanguageValue: config.workspace?.override,\n\t\t\t\t\t\tworkspaceFolderLanguageValue: config.workspaceFolder?.override,\n\n\t\t\t\t\t\tlanguageIds: config.overrideIdentifiers\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t};\n\n\t\tif (typeof config === 'object') {\n\t\t\tmixin(result, config, false);\n\t\t}\n\n\t\treturn Object.freeze(result);\n\t}\n\n\tprivate _toReadonlyValue(result: any): any {\n\t\tconst readonlyProxy = (target: any): any => {\n\t\t\treturn isObject(target) ?\n\t\t\t\tnew Proxy(target, {\n\t\t\t\t\tget: (target: any, property: PropertyKey) => readonlyProxy(target[property]),\n\t\t\t\t\tset: (_target: any, property: PropertyKey, _value: any) => { throw new Error(`TypeError: Cannot assign to read only property '${String(property)}' of object`); },\n\t\t\t\t\tdeleteProperty: (_target: any, property: PropertyKey) => { throw new Error(`TypeError: Cannot delete read only property '${String(property)}' of object`); },\n\t\t\t\t\tdefineProperty: (_target: any, property: PropertyKey) => { throw new Error(`TypeError: Cannot define property '${String(property)}' for a readonly object`); },\n\t\t\t\t\tsetPrototypeOf: (_target: any) => { throw new Error(`TypeError: Cannot set prototype for a readonly object`); },\n\t\t\t\t\tisExtensible: () => false,\n\t\t\t\t\tpreventExtensions: () => true\n\t\t\t\t}) : target;\n\t\t};\n\t\treturn readonlyProxy(result);\n\t}\n\n\tprivate _validateConfigurationAccess(key: string, overrides?: IConfigurationOverrides, extensionId?: ExtensionIdentifier): void {\n\t\tconst scope = OVERRIDE_PROPERTY_REGEX.test(key) ? ConfigurationScope.RESOURCE : this._configurationScopes.get(key);\n\t\tconst extensionIdText = extensionId ? `[${extensionId.value}] ` : '';\n\t\tif (ConfigurationScope.RESOURCE === scope) {\n\t\t\tif (typeof overrides?.resource === 'undefined') {\n\t\t\t\tthis._logService.warn(`${extensionIdText}Accessing a resource scoped configuration without providing a resource is not expected. To get the effective value for '${key}', provide the URI of a resource or 'null' for any resource.`);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tif (ConfigurationScope.WINDOW === scope) {\n\t\t\tif (overrides?.resource) {\n\t\t\t\tthis._logService.warn(`${extensionIdText}Accessing a window scoped configuration for a resource is not expected. To associate '${key}' to a resource, define its scope to 'resource' in configuration contributions in 'package.json'.`);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t}\n\n\tprivate _toConfigurationChangeEvent(change: IConfigurationChange, previous: { data: IConfigurationData; workspace: Workspace | undefined }): vscode.ConfigurationChangeEvent {\n\t\tconst event = new ConfigurationChangeEvent(change, previous, this._configuration, this._extHostWorkspace.workspace);\n\t\treturn Object.freeze({\n\t\t\taffectsConfiguration: (section: string, scope?: vscode.ConfigurationScope) => event.affectsConfiguration(section, scopeToOverrides(scope))\n\t\t});\n\t}\n\n\tprivate _toMap(scopes: [string, ConfigurationScope | undefined][]): Map<string, ConfigurationScope | undefined> {\n\t\treturn scopes.reduce((result, scope) => { result.set(scope[0], scope[1]); return result; }, new Map<string, ConfigurationScope | undefined>());\n\t}\n\n}\n\nexport const IExtHostConfiguration = createDecorator<IExtHostConfiguration>('IExtHostConfiguration');\nexport interface IExtHostConfiguration extends ExtHostConfiguration { }\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { asPromise } from 'vs/base/common/async';\nimport { Event, Emitter } from 'vs/base/common/event';\n\nimport { MainContext, MainThreadTaskShape, ExtHostTaskShape } from 'vs/workbench/api/common/extHost.protocol';\nimport * as types from 'vs/workbench/api/common/extHostTypes';\nimport { IExtHostWorkspaceProvider, IExtHostWorkspace } from 'vs/workbench/api/common/extHostWorkspace';\nimport type * as vscode from 'vscode';\nimport * as tasks from '../common/shared/tasks';\nimport { IExtHostDocumentsAndEditors } from 'vs/workbench/api/common/extHostDocumentsAndEditors';\nimport { IExtHostConfiguration } from 'vs/workbench/api/common/extHostConfiguration';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { IExtHostTerminalService } from 'vs/workbench/api/common/extHostTerminalService';\nimport { IExtHostRpcService } from 'vs/workbench/api/common/extHostRpcService';\nimport { IExtHostInitDataService } from 'vs/workbench/api/common/extHostInitDataService';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { Schemas } from 'vs/base/common/network';\nimport * as Platform from 'vs/base/common/platform';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { IExtHostApiDeprecationService } from 'vs/workbench/api/common/extHostApiDeprecationService';\nimport { USER_TASKS_GROUP_KEY } from 'vs/workbench/contrib/tasks/common/tasks';\nimport { NotSupportedError } from 'vs/base/common/errors';\n\nexport interface IExtHostTask extends ExtHostTaskShape {\n\n\treadonly _serviceBrand: undefined;\n\n\ttaskExecutions: vscode.TaskExecution[];\n\tonDidStartTask: Event<vscode.TaskStartEvent>;\n\tonDidEndTask: Event<vscode.TaskEndEvent>;\n\tonDidStartTaskProcess: Event<vscode.TaskProcessStartEvent>;\n\tonDidEndTaskProcess: Event<vscode.TaskProcessEndEvent>;\n\n\tregisterTaskProvider(extension: IExtensionDescription, type: string, provider: vscode.TaskProvider): vscode.Disposable;\n\tregisterTaskSystem(scheme: string, info: tasks.ITaskSystemInfoDTO): void;\n\tfetchTasks(filter?: vscode.TaskFilter): Promise<vscode.Task[]>;\n\texecuteTask(extension: IExtensionDescription, task: vscode.Task): Promise<vscode.TaskExecution>;\n\tterminateTask(execution: vscode.TaskExecution): Promise<void>;\n}\n\nexport namespace TaskDefinitionDTO {\n\texport function from(value: vscode.TaskDefinition): tasks.ITaskDefinitionDTO | undefined {\n\t\tif (value === undefined || value === null) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn value;\n\t}\n\texport function to(value: tasks.ITaskDefinitionDTO): vscode.TaskDefinition | undefined {\n\t\tif (value === undefined || value === null) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn value;\n\t}\n}\n\nexport namespace TaskPresentationOptionsDTO {\n\texport function from(value: vscode.TaskPresentationOptions): tasks.ITaskPresentationOptionsDTO | undefined {\n\t\tif (value === undefined || value === null) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn value;\n\t}\n\texport function to(value: tasks.ITaskPresentationOptionsDTO): vscode.TaskPresentationOptions | undefined {\n\t\tif (value === undefined || value === null) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn value;\n\t}\n}\n\nexport namespace ProcessExecutionOptionsDTO {\n\texport function from(value: vscode.ProcessExecutionOptions): tasks.IProcessExecutionOptionsDTO | undefined {\n\t\tif (value === undefined || value === null) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn value;\n\t}\n\texport function to(value: tasks.IProcessExecutionOptionsDTO): vscode.ProcessExecutionOptions | undefined {\n\t\tif (value === undefined || value === null) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn value;\n\t}\n}\n\nexport namespace ProcessExecutionDTO {\n\texport function is(value: tasks.IShellExecutionDTO | tasks.IProcessExecutionDTO | tasks.ICustomExecutionDTO | undefined): value is tasks.IProcessExecutionDTO {\n\t\tif (value) {\n\t\t\tconst candidate = value as tasks.IProcessExecutionDTO;\n\t\t\treturn candidate && !!candidate.process;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\texport function from(value: vscode.ProcessExecution): tasks.IProcessExecutionDTO | undefined {\n\t\tif (value === undefined || value === null) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst result: tasks.IProcessExecutionDTO = {\n\t\t\tprocess: value.process,\n\t\t\targs: value.args\n\t\t};\n\t\tif (value.options) {\n\t\t\tresult.options = ProcessExecutionOptionsDTO.from(value.options);\n\t\t}\n\t\treturn result;\n\t}\n\texport function to(value: tasks.IProcessExecutionDTO): types.ProcessExecution | undefined {\n\t\tif (value === undefined || value === null) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn new types.ProcessExecution(value.process, value.args, value.options);\n\t}\n}\n\nexport namespace ShellExecutionOptionsDTO {\n\texport function from(value: vscode.ShellExecutionOptions): tasks.IShellExecutionOptionsDTO | undefined {\n\t\tif (value === undefined || value === null) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn value;\n\t}\n\texport function to(value: tasks.IShellExecutionOptionsDTO): vscode.ShellExecutionOptions | undefined {\n\t\tif (value === undefined || value === null) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn value;\n\t}\n}\n\nexport namespace ShellExecutionDTO {\n\texport function is(value: tasks.IShellExecutionDTO | tasks.IProcessExecutionDTO | tasks.ICustomExecutionDTO | undefined): value is tasks.IShellExecutionDTO {\n\t\tif (value) {\n\t\t\tconst candidate = value as tasks.IShellExecutionDTO;\n\t\t\treturn candidate && (!!candidate.commandLine || !!candidate.command);\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\texport function from(value: vscode.ShellExecution): tasks.IShellExecutionDTO | undefined {\n\t\tif (value === undefined || value === null) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst result: tasks.IShellExecutionDTO = {\n\t\t};\n\t\tif (value.commandLine !== undefined) {\n\t\t\tresult.commandLine = value.commandLine;\n\t\t} else {\n\t\t\tresult.command = value.command;\n\t\t\tresult.args = value.args;\n\t\t}\n\t\tif (value.options) {\n\t\t\tresult.options = ShellExecutionOptionsDTO.from(value.options);\n\t\t}\n\t\treturn result;\n\t}\n\texport function to(value: tasks.IShellExecutionDTO): types.ShellExecution | undefined {\n\t\tif (value === undefined || value === null || (value.command === undefined && value.commandLine === undefined)) {\n\t\t\treturn undefined;\n\t\t}\n\t\tif (value.commandLine) {\n\t\t\treturn new types.ShellExecution(value.commandLine, value.options);\n\t\t} else {\n\t\t\treturn new types.ShellExecution(value.command!, value.args ? value.args : [], value.options);\n\t\t}\n\t}\n}\n\nexport namespace CustomExecutionDTO {\n\texport function is(value: tasks.IShellExecutionDTO | tasks.IProcessExecutionDTO | tasks.ICustomExecutionDTO | undefined): value is tasks.ICustomExecutionDTO {\n\t\tif (value) {\n\t\t\tconst candidate = value as tasks.ICustomExecutionDTO;\n\t\t\treturn candidate && candidate.customExecution === 'customExecution';\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\texport function from(value: vscode.CustomExecution): tasks.ICustomExecutionDTO {\n\t\treturn {\n\t\t\tcustomExecution: 'customExecution'\n\t\t};\n\t}\n\n\texport function to(taskId: string, providedCustomExeutions: Map<string, types.CustomExecution>): types.CustomExecution | undefined {\n\t\treturn providedCustomExeutions.get(taskId);\n\t}\n}\n\n\nexport namespace TaskHandleDTO {\n\texport function from(value: types.Task, workspaceService?: IExtHostWorkspace): tasks.ITaskHandleDTO {\n\t\tlet folder: UriComponents | string;\n\t\tif (value.scope !== undefined && typeof value.scope !== 'number') {\n\t\t\tfolder = value.scope.uri;\n\t\t} else if (value.scope !== undefined && typeof value.scope === 'number') {\n\t\t\tif ((value.scope === types.TaskScope.Workspace) && workspaceService && workspaceService.workspaceFile) {\n\t\t\t\tfolder = workspaceService.workspaceFile;\n\t\t\t} else {\n\t\t\t\tfolder = USER_TASKS_GROUP_KEY;\n\t\t\t}\n\t\t}\n\t\treturn {\n\t\t\tid: value._id!,\n\t\t\tworkspaceFolder: folder!\n\t\t};\n\t}\n}\nexport namespace TaskGroupDTO {\n\texport function from(value: vscode.TaskGroup): tasks.ITaskGroupDTO | undefined {\n\t\tif (value === undefined || value === null) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn { _id: value.id, isDefault: value.isDefault };\n\t}\n}\n\nexport namespace TaskDTO {\n\texport function fromMany(tasks: vscode.Task[], extension: IExtensionDescription): tasks.ITaskDTO[] {\n\t\tif (tasks === undefined || tasks === null) {\n\t\t\treturn [];\n\t\t}\n\t\tconst result: tasks.ITaskDTO[] = [];\n\t\tfor (const task of tasks) {\n\t\t\tconst converted = from(task, extension);\n\t\t\tif (converted) {\n\t\t\t\tresult.push(converted);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\texport function from(value: vscode.Task, extension: IExtensionDescription): tasks.ITaskDTO | undefined {\n\t\tif (value === undefined || value === null) {\n\t\t\treturn undefined;\n\t\t}\n\t\tlet execution: tasks.IShellExecutionDTO | tasks.IProcessExecutionDTO | tasks.ICustomExecutionDTO | undefined;\n\t\tif (value.execution instanceof types.ProcessExecution) {\n\t\t\texecution = ProcessExecutionDTO.from(value.execution);\n\t\t} else if (value.execution instanceof types.ShellExecution) {\n\t\t\texecution = ShellExecutionDTO.from(value.execution);\n\t\t} else if (value.execution && value.execution instanceof types.CustomExecution) {\n\t\t\texecution = CustomExecutionDTO.from(<types.CustomExecution>value.execution);\n\t\t}\n\n\t\tconst definition: tasks.ITaskDefinitionDTO | undefined = TaskDefinitionDTO.from(value.definition);\n\t\tlet scope: number | UriComponents;\n\t\tif (value.scope) {\n\t\t\tif (typeof value.scope === 'number') {\n\t\t\t\tscope = value.scope;\n\t\t\t} else {\n\t\t\t\tscope = value.scope.uri;\n\t\t\t}\n\t\t} else {\n\t\t\t// To continue to support the deprecated task constructor that doesn't take a scope, we must add a scope here:\n\t\t\tscope = types.TaskScope.Workspace;\n\t\t}\n\t\tif (!definition || !scope) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst result: tasks.ITaskDTO = {\n\t\t\t_id: (value as types.Task)._id!,\n\t\t\tdefinition,\n\t\t\tname: value.name,\n\t\t\tsource: {\n\t\t\t\textensionId: extension.identifier.value,\n\t\t\t\tlabel: value.source,\n\t\t\t\tscope: scope\n\t\t\t},\n\t\t\texecution: execution!,\n\t\t\tisBackground: value.isBackground,\n\t\t\tgroup: TaskGroupDTO.from(value.group as vscode.TaskGroup),\n\t\t\tpresentationOptions: TaskPresentationOptionsDTO.from(value.presentationOptions),\n\t\t\tproblemMatchers: value.problemMatchers,\n\t\t\thasDefinedMatchers: (value as types.Task).hasDefinedMatchers,\n\t\t\trunOptions: value.runOptions ? value.runOptions : { reevaluateOnRerun: true },\n\t\t\tdetail: value.detail\n\t\t};\n\t\treturn result;\n\t}\n\texport async function to(value: tasks.ITaskDTO | undefined, workspace: IExtHostWorkspaceProvider, providedCustomExeutions: Map<string, types.CustomExecution>): Promise<types.Task | undefined> {\n\t\tif (value === undefined || value === null) {\n\t\t\treturn undefined;\n\t\t}\n\t\tlet execution: types.ShellExecution | types.ProcessExecution | types.CustomExecution | undefined;\n\t\tif (ProcessExecutionDTO.is(value.execution)) {\n\t\t\texecution = ProcessExecutionDTO.to(value.execution);\n\t\t} else if (ShellExecutionDTO.is(value.execution)) {\n\t\t\texecution = ShellExecutionDTO.to(value.execution);\n\t\t} else if (CustomExecutionDTO.is(value.execution)) {\n\t\t\texecution = CustomExecutionDTO.to(value._id, providedCustomExeutions);\n\t\t}\n\t\tconst definition: vscode.TaskDefinition | undefined = TaskDefinitionDTO.to(value.definition);\n\t\tlet scope: vscode.TaskScope.Global | vscode.TaskScope.Workspace | vscode.WorkspaceFolder | undefined;\n\t\tif (value.source) {\n\t\t\tif (value.source.scope !== undefined) {\n\t\t\t\tif (typeof value.source.scope === 'number') {\n\t\t\t\t\tscope = value.source.scope;\n\t\t\t\t} else {\n\t\t\t\t\tscope = await workspace.resolveWorkspaceFolder(URI.revive(value.source.scope));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tscope = types.TaskScope.Workspace;\n\t\t\t}\n\t\t}\n\t\tif (!definition || !scope) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst result = new types.Task(definition, scope, value.name!, value.source.label, execution, value.problemMatchers);\n\t\tif (value.isBackground !== undefined) {\n\t\t\tresult.isBackground = value.isBackground;\n\t\t}\n\t\tif (value.group !== undefined) {\n\t\t\tresult.group = types.TaskGroup.from(value.group._id);\n\t\t\tif (result.group && value.group.isDefault) {\n\t\t\t\tresult.group = new types.TaskGroup(result.group.id, result.group.label);\n\t\t\t\tif (value.group.isDefault === true) {\n\t\t\t\t\tresult.group.isDefault = value.group.isDefault;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (value.presentationOptions) {\n\t\t\tresult.presentationOptions = TaskPresentationOptionsDTO.to(value.presentationOptions)!;\n\t\t}\n\t\tif (value._id) {\n\t\t\tresult._id = value._id;\n\t\t}\n\t\tif (value.detail) {\n\t\t\tresult.detail = value.detail;\n\t\t}\n\t\treturn result;\n\t}\n}\n\nexport namespace TaskFilterDTO {\n\texport function from(value: vscode.TaskFilter | undefined): tasks.ITaskFilterDTO | undefined {\n\t\treturn value;\n\t}\n\n\texport function to(value: tasks.ITaskFilterDTO): vscode.TaskFilter | undefined {\n\t\tif (!value) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn Object.assign(Object.create(null), value);\n\t}\n}\n\nclass TaskExecutionImpl implements vscode.TaskExecution {\n\n\treadonly #tasks: ExtHostTaskBase;\n\n\tconstructor(tasks: ExtHostTaskBase, readonly _id: string, private readonly _task: vscode.Task) {\n\t\tthis.#tasks = tasks;\n\t}\n\n\tpublic get task(): vscode.Task {\n\t\treturn this._task;\n\t}\n\n\tpublic terminate(): void {\n\t\tthis.#tasks.terminateTask(this);\n\t}\n\n\tpublic fireDidStartProcess(value: tasks.ITaskProcessStartedDTO): void {\n\t}\n\n\tpublic fireDidEndProcess(value: tasks.ITaskProcessEndedDTO): void {\n\t}\n}\n\nexport namespace TaskExecutionDTO {\n\texport function from(value: vscode.TaskExecution): tasks.ITaskExecutionDTO {\n\t\treturn {\n\t\t\tid: (value as TaskExecutionImpl)._id,\n\t\t\ttask: undefined\n\t\t};\n\t}\n}\n\nexport interface HandlerData {\n\ttype: string;\n\tprovider: vscode.TaskProvider;\n\textension: IExtensionDescription;\n}\n\nexport abstract class ExtHostTaskBase implements ExtHostTaskShape, IExtHostTask {\n\treadonly _serviceBrand: undefined;\n\n\tprotected readonly _proxy: MainThreadTaskShape;\n\tprotected readonly _workspaceProvider: IExtHostWorkspaceProvider;\n\tprotected readonly _editorService: IExtHostDocumentsAndEditors;\n\tprotected readonly _configurationService: IExtHostConfiguration;\n\tprotected readonly _terminalService: IExtHostTerminalService;\n\tprotected readonly _logService: ILogService;\n\tprotected readonly _deprecationService: IExtHostApiDeprecationService;\n\tprotected _handleCounter: number;\n\tprotected _handlers: Map<number, HandlerData>;\n\tprotected _taskExecutions: Map<string, TaskExecutionImpl>;\n\tprotected _taskExecutionPromises: Map<string, Promise<TaskExecutionImpl>>;\n\tprotected _providedCustomExecutions2: Map<string, types.CustomExecution>;\n\tprivate _notProvidedCustomExecutions: Set<string>; // Used for custom executions tasks that are created and run through executeTask.\n\tprotected _activeCustomExecutions2: Map<string, types.CustomExecution>;\n\tprivate _lastStartedTask: string | undefined;\n\tprotected readonly _onDidExecuteTask: Emitter<vscode.TaskStartEvent> = new Emitter<vscode.TaskStartEvent>();\n\tprotected readonly _onDidTerminateTask: Emitter<vscode.TaskEndEvent> = new Emitter<vscode.TaskEndEvent>();\n\n\tprotected readonly _onDidTaskProcessStarted: Emitter<vscode.TaskProcessStartEvent> = new Emitter<vscode.TaskProcessStartEvent>();\n\tprotected readonly _onDidTaskProcessEnded: Emitter<vscode.TaskProcessEndEvent> = new Emitter<vscode.TaskProcessEndEvent>();\n\n\tconstructor(\n\t\t@IExtHostRpcService extHostRpc: IExtHostRpcService,\n\t\t@IExtHostInitDataService initData: IExtHostInitDataService,\n\t\t@IExtHostWorkspace workspaceService: IExtHostWorkspace,\n\t\t@IExtHostDocumentsAndEditors editorService: IExtHostDocumentsAndEditors,\n\t\t@IExtHostConfiguration configurationService: IExtHostConfiguration,\n\t\t@IExtHostTerminalService extHostTerminalService: IExtHostTerminalService,\n\t\t@ILogService logService: ILogService,\n\t\t@IExtHostApiDeprecationService deprecationService: IExtHostApiDeprecationService\n\t) {\n\t\tthis._proxy = extHostRpc.getProxy(MainContext.MainThreadTask);\n\t\tthis._workspaceProvider = workspaceService;\n\t\tthis._editorService = editorService;\n\t\tthis._configurationService = configurationService;\n\t\tthis._terminalService = extHostTerminalService;\n\t\tthis._handleCounter = 0;\n\t\tthis._handlers = new Map<number, HandlerData>();\n\t\tthis._taskExecutions = new Map<string, TaskExecutionImpl>();\n\t\tthis._taskExecutionPromises = new Map<string, Promise<TaskExecutionImpl>>();\n\t\tthis._providedCustomExecutions2 = new Map<string, types.CustomExecution>();\n\t\tthis._notProvidedCustomExecutions = new Set<string>();\n\t\tthis._activeCustomExecutions2 = new Map<string, types.CustomExecution>();\n\t\tthis._logService = logService;\n\t\tthis._deprecationService = deprecationService;\n\t\tthis._proxy.$registerSupportedExecutions(true);\n\t}\n\n\tpublic registerTaskProvider(extension: IExtensionDescription, type: string, provider: vscode.TaskProvider): vscode.Disposable {\n\t\tif (!provider) {\n\t\t\treturn new types.Disposable(() => { });\n\t\t}\n\t\tconst handle = this.nextHandle();\n\t\tthis._handlers.set(handle, { type, provider, extension });\n\t\tthis._proxy.$registerTaskProvider(handle, type);\n\t\treturn new types.Disposable(() => {\n\t\t\tthis._handlers.delete(handle);\n\t\t\tthis._proxy.$unregisterTaskProvider(handle);\n\t\t});\n\t}\n\n\tpublic registerTaskSystem(scheme: string, info: tasks.ITaskSystemInfoDTO): void {\n\t\tthis._proxy.$registerTaskSystem(scheme, info);\n\t}\n\n\tpublic fetchTasks(filter?: vscode.TaskFilter): Promise<vscode.Task[]> {\n\t\treturn this._proxy.$fetchTasks(TaskFilterDTO.from(filter)).then(async (values) => {\n\t\t\tconst result: vscode.Task[] = [];\n\t\t\tfor (const value of values) {\n\t\t\t\tconst task = await TaskDTO.to(value, this._workspaceProvider, this._providedCustomExecutions2);\n\t\t\t\tif (task) {\n\t\t\t\t\tresult.push(task);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t});\n\t}\n\n\tpublic abstract executeTask(extension: IExtensionDescription, task: vscode.Task): Promise<vscode.TaskExecution>;\n\n\tpublic get taskExecutions(): vscode.TaskExecution[] {\n\t\tconst result: vscode.TaskExecution[] = [];\n\t\tthis._taskExecutions.forEach(value => result.push(value));\n\t\treturn result;\n\t}\n\n\tpublic terminateTask(execution: vscode.TaskExecution): Promise<void> {\n\t\tif (!(execution instanceof TaskExecutionImpl)) {\n\t\t\tthrow new Error('No valid task execution provided');\n\t\t}\n\t\treturn this._proxy.$terminateTask((execution as TaskExecutionImpl)._id);\n\t}\n\n\tpublic get onDidStartTask(): Event<vscode.TaskStartEvent> {\n\t\treturn this._onDidExecuteTask.event;\n\t}\n\n\tpublic async $onDidStartTask(execution: tasks.ITaskExecutionDTO, terminalId: number, resolvedDefinition: tasks.ITaskDefinitionDTO): Promise<void> {\n\t\tconst customExecution: types.CustomExecution | undefined = this._providedCustomExecutions2.get(execution.id);\n\t\tif (customExecution) {\n\t\t\t// Clone the custom execution to keep the original untouched. This is important for multiple runs of the same task.\n\t\t\tthis._activeCustomExecutions2.set(execution.id, customExecution);\n\t\t\tthis._terminalService.attachPtyToTerminal(terminalId, await customExecution.callback(resolvedDefinition));\n\t\t}\n\t\tthis._lastStartedTask = execution.id;\n\n\t\tthis._onDidExecuteTask.fire({\n\t\t\texecution: await this.getTaskExecution(execution)\n\t\t});\n\t}\n\n\tpublic get onDidEndTask(): Event<vscode.TaskEndEvent> {\n\t\treturn this._onDidTerminateTask.event;\n\t}\n\n\tpublic async $OnDidEndTask(execution: tasks.ITaskExecutionDTO): Promise<void> {\n\t\tconst _execution = await this.getTaskExecution(execution);\n\t\tthis._taskExecutionPromises.delete(execution.id);\n\t\tthis._taskExecutions.delete(execution.id);\n\t\tthis.customExecutionComplete(execution);\n\t\tthis._onDidTerminateTask.fire({\n\t\t\texecution: _execution\n\t\t});\n\t}\n\n\tpublic get onDidStartTaskProcess(): Event<vscode.TaskProcessStartEvent> {\n\t\treturn this._onDidTaskProcessStarted.event;\n\t}\n\n\tpublic async $onDidStartTaskProcess(value: tasks.ITaskProcessStartedDTO): Promise<void> {\n\t\tconst execution = await this.getTaskExecution(value.id);\n\t\tthis._onDidTaskProcessStarted.fire({\n\t\t\texecution: execution,\n\t\t\tprocessId: value.processId\n\t\t});\n\t}\n\n\tpublic get onDidEndTaskProcess(): Event<vscode.TaskProcessEndEvent> {\n\t\treturn this._onDidTaskProcessEnded.event;\n\t}\n\n\tpublic async $onDidEndTaskProcess(value: tasks.ITaskProcessEndedDTO): Promise<void> {\n\t\tconst execution = await this.getTaskExecution(value.id);\n\t\tthis._onDidTaskProcessEnded.fire({\n\t\t\texecution: execution,\n\t\t\texitCode: value.exitCode\n\t\t});\n\t}\n\n\tprotected abstract provideTasksInternal(validTypes: { [key: string]: boolean }, taskIdPromises: Promise<void>[], handler: HandlerData, value: vscode.Task[] | null | undefined): { tasks: tasks.ITaskDTO[]; extension: IExtensionDescription };\n\n\tpublic $provideTasks(handle: number, validTypes: { [key: string]: boolean }): Promise<tasks.ITaskSetDTO> {\n\t\tconst handler = this._handlers.get(handle);\n\t\tif (!handler) {\n\t\t\treturn Promise.reject(new Error('no handler found'));\n\t\t}\n\n\t\t// Set up a list of task ID promises that we can wait on\n\t\t// before returning the provided tasks. The ensures that\n\t\t// our task IDs are calculated for any custom execution tasks.\n\t\t// Knowing this ID ahead of time is needed because when a task\n\t\t// start event is fired this is when the custom execution is called.\n\t\t// The task start event is also the first time we see the ID from the main\n\t\t// thread, which is too late for us because we need to save an map\n\t\t// from an ID to the custom execution function. (Kind of a cart before the horse problem).\n\t\tconst taskIdPromises: Promise<void>[] = [];\n\t\tconst fetchPromise = asPromise(() => handler.provider.provideTasks(CancellationToken.None)).then(value => {\n\t\t\treturn this.provideTasksInternal(validTypes, taskIdPromises, handler, value);\n\t\t});\n\n\t\treturn new Promise((resolve) => {\n\t\t\tfetchPromise.then((result) => {\n\t\t\t\tPromise.all(taskIdPromises).then(() => {\n\t\t\t\t\tresolve(result);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\tprotected abstract resolveTaskInternal(resolvedTaskDTO: tasks.ITaskDTO): Promise<tasks.ITaskDTO | undefined>;\n\n\tpublic async $resolveTask(handle: number, taskDTO: tasks.ITaskDTO): Promise<tasks.ITaskDTO | undefined> {\n\t\tconst handler = this._handlers.get(handle);\n\t\tif (!handler) {\n\t\t\treturn Promise.reject(new Error('no handler found'));\n\t\t}\n\n\t\tif (taskDTO.definition.type !== handler.type) {\n\t\t\tthrow new Error(`Unexpected: Task of type [${taskDTO.definition.type}] cannot be resolved by provider of type [${handler.type}].`);\n\t\t}\n\n\t\tconst task = await TaskDTO.to(taskDTO, this._workspaceProvider, this._providedCustomExecutions2);\n\t\tif (!task) {\n\t\t\tthrow new Error('Unexpected: Task cannot be resolved.');\n\t\t}\n\n\t\tconst resolvedTask = await handler.provider.resolveTask(task, CancellationToken.None);\n\t\tif (!resolvedTask) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.checkDeprecation(resolvedTask, handler);\n\n\t\tconst resolvedTaskDTO: tasks.ITaskDTO | undefined = TaskDTO.from(resolvedTask, handler.extension);\n\t\tif (!resolvedTaskDTO) {\n\t\t\tthrow new Error('Unexpected: Task cannot be resolved.');\n\t\t}\n\n\t\tif (resolvedTask.definition !== task.definition) {\n\t\t\tthrow new Error('Unexpected: The resolved task definition must be the same object as the original task definition. The task definition cannot be changed.');\n\t\t}\n\n\t\tif (CustomExecutionDTO.is(resolvedTaskDTO.execution)) {\n\t\t\tawait this.addCustomExecution(resolvedTaskDTO, resolvedTask, true);\n\t\t}\n\n\t\treturn await this.resolveTaskInternal(resolvedTaskDTO);\n\t}\n\n\tpublic abstract $resolveVariables(uriComponents: UriComponents, toResolve: { process?: { name: string; cwd?: string; path?: string }; variables: string[] }): Promise<{ process?: string; variables: { [key: string]: string } }>;\n\n\tprivate nextHandle(): number {\n\t\treturn this._handleCounter++;\n\t}\n\n\tprotected async addCustomExecution(taskDTO: tasks.ITaskDTO, task: vscode.Task, isProvided: boolean): Promise<void> {\n\t\tconst taskId = await this._proxy.$createTaskId(taskDTO);\n\t\tif (!isProvided && !this._providedCustomExecutions2.has(taskId)) {\n\t\t\tthis._notProvidedCustomExecutions.add(taskId);\n\t\t\t// Also add to active executions when not coming from a provider to prevent timing issue.\n\t\t\tthis._activeCustomExecutions2.set(taskId, <types.CustomExecution>task.execution);\n\t\t}\n\t\tthis._providedCustomExecutions2.set(taskId, <types.CustomExecution>task.execution);\n\t}\n\n\tprotected async getTaskExecution(execution: tasks.ITaskExecutionDTO | string, task?: vscode.Task): Promise<TaskExecutionImpl> {\n\t\tif (typeof execution === 'string') {\n\t\t\tconst taskExecution = this._taskExecutionPromises.get(execution);\n\t\t\tif (!taskExecution) {\n\t\t\t\tthrow new Error('Unexpected: The specified task is missing an execution');\n\t\t\t}\n\t\t\treturn taskExecution;\n\t\t}\n\n\t\tconst result: Promise<TaskExecutionImpl> | undefined = this._taskExecutionPromises.get(execution.id);\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t\tconst createdResult: Promise<TaskExecutionImpl> = new Promise((resolve, reject) => {\n\t\t\tfunction resolvePromiseWithCreatedTask(that: ExtHostTaskBase, execution: tasks.ITaskExecutionDTO, taskToCreate: vscode.Task | types.Task | undefined) {\n\t\t\t\tif (!taskToCreate) {\n\t\t\t\t\treject('Unexpected: Task does not exist.');\n\t\t\t\t} else {\n\t\t\t\t\tresolve(new TaskExecutionImpl(that, execution.id, taskToCreate));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (task) {\n\t\t\t\tresolvePromiseWithCreatedTask(this, execution, task);\n\t\t\t} else {\n\t\t\t\tTaskDTO.to(execution.task, this._workspaceProvider, this._providedCustomExecutions2)\n\t\t\t\t\t.then(task => resolvePromiseWithCreatedTask(this, execution, task));\n\t\t\t}\n\t\t});\n\n\t\tthis._taskExecutionPromises.set(execution.id, createdResult);\n\t\treturn createdResult.then(executionCreatedResult => {\n\t\t\tthis._taskExecutions.set(execution.id, executionCreatedResult);\n\t\t\treturn executionCreatedResult;\n\t\t}, rejected => {\n\t\t\treturn Promise.reject(rejected);\n\t\t});\n\t}\n\n\tprotected checkDeprecation(task: vscode.Task, handler: HandlerData) {\n\t\tconst tTask = (task as types.Task);\n\t\tif (tTask._deprecated) {\n\t\t\tthis._deprecationService.report('Task.constructor', handler.extension, 'Use the Task constructor that takes a `scope` instead.');\n\t\t}\n\t}\n\n\tprivate customExecutionComplete(execution: tasks.ITaskExecutionDTO): void {\n\t\tconst extensionCallback2: vscode.CustomExecution | undefined = this._activeCustomExecutions2.get(execution.id);\n\t\tif (extensionCallback2) {\n\t\t\tthis._activeCustomExecutions2.delete(execution.id);\n\t\t}\n\n\t\t// Technically we don't really need to do this, however, if an extension\n\t\t// is executing a task through \"executeTask\" over and over again\n\t\t// with different properties in the task definition, then the map of executions\n\t\t// could grow indefinitely, something we don't want.\n\t\tif (this._notProvidedCustomExecutions.has(execution.id) && (this._lastStartedTask !== execution.id)) {\n\t\t\tthis._providedCustomExecutions2.delete(execution.id);\n\t\t\tthis._notProvidedCustomExecutions.delete(execution.id);\n\t\t}\n\t\tconst iterator = this._notProvidedCustomExecutions.values();\n\t\tlet iteratorResult = iterator.next();\n\t\twhile (!iteratorResult.done) {\n\t\t\tif (!this._activeCustomExecutions2.has(iteratorResult.value) && (this._lastStartedTask !== iteratorResult.value)) {\n\t\t\t\tthis._providedCustomExecutions2.delete(iteratorResult.value);\n\t\t\t\tthis._notProvidedCustomExecutions.delete(iteratorResult.value);\n\t\t\t}\n\t\t\titeratorResult = iterator.next();\n\t\t}\n\t}\n\n\tpublic abstract $jsonTasksSupported(): Promise<boolean>;\n\n\tpublic abstract $findExecutable(command: string, cwd?: string | undefined, paths?: string[] | undefined): Promise<string | undefined>;\n}\n\nexport class WorkerExtHostTask extends ExtHostTaskBase {\n\tconstructor(\n\t\t@IExtHostRpcService extHostRpc: IExtHostRpcService,\n\t\t@IExtHostInitDataService initData: IExtHostInitDataService,\n\t\t@IExtHostWorkspace workspaceService: IExtHostWorkspace,\n\t\t@IExtHostDocumentsAndEditors editorService: IExtHostDocumentsAndEditors,\n\t\t@IExtHostConfiguration configurationService: IExtHostConfiguration,\n\t\t@IExtHostTerminalService extHostTerminalService: IExtHostTerminalService,\n\t\t@ILogService logService: ILogService,\n\t\t@IExtHostApiDeprecationService deprecationService: IExtHostApiDeprecationService\n\t) {\n\t\tsuper(extHostRpc, initData, workspaceService, editorService, configurationService, extHostTerminalService, logService, deprecationService);\n\t\tthis.registerTaskSystem(Schemas.vscodeRemote, {\n\t\t\tscheme: Schemas.vscodeRemote,\n\t\t\tauthority: '',\n\t\t\tplatform: Platform.PlatformToString(Platform.Platform.Web)\n\t\t});\n\t}\n\n\tpublic async executeTask(extension: IExtensionDescription, task: vscode.Task): Promise<vscode.TaskExecution> {\n\t\tif (!task.execution) {\n\t\t\tthrow new Error('Tasks to execute must include an execution');\n\t\t}\n\n\t\tconst dto = TaskDTO.from(task, extension);\n\t\tif (dto === undefined) {\n\t\t\tthrow new Error('Task is not valid');\n\t\t}\n\n\t\t// If this task is a custom execution, then we need to save it away\n\t\t// in the provided custom execution map that is cleaned up after the\n\t\t// task is executed.\n\t\tif (CustomExecutionDTO.is(dto.execution)) {\n\t\t\tawait this.addCustomExecution(dto, task, false);\n\t\t} else {\n\t\t\tthrow new NotSupportedError();\n\t\t}\n\n\t\t// Always get the task execution first to prevent timing issues when retrieving it later\n\t\tconst execution = await this.getTaskExecution(await this._proxy.$getTaskExecution(dto), task);\n\t\tthis._proxy.$executeTask(dto).catch(error => { throw new Error(error); });\n\t\treturn execution;\n\t}\n\n\tprotected provideTasksInternal(validTypes: { [key: string]: boolean }, taskIdPromises: Promise<void>[], handler: HandlerData, value: vscode.Task[] | null | undefined): { tasks: tasks.ITaskDTO[]; extension: IExtensionDescription } {\n\t\tconst taskDTOs: tasks.ITaskDTO[] = [];\n\t\tif (value) {\n\t\t\tfor (const task of value) {\n\t\t\t\tthis.checkDeprecation(task, handler);\n\t\t\t\tif (!task.definition || !validTypes[task.definition.type]) {\n\t\t\t\t\tthis._logService.warn(`The task [${task.source}, ${task.name}] uses an undefined task type. The task will be ignored in the future.`);\n\t\t\t\t}\n\n\t\t\t\tconst taskDTO: tasks.ITaskDTO | undefined = TaskDTO.from(task, handler.extension);\n\t\t\t\tif (taskDTO && CustomExecutionDTO.is(taskDTO.execution)) {\n\t\t\t\t\ttaskDTOs.push(taskDTO);\n\t\t\t\t\t// The ID is calculated on the main thread task side, so, let's call into it here.\n\t\t\t\t\t// We need the task id's pre-computed for custom task executions because when OnDidStartTask\n\t\t\t\t\t// is invoked, we have to be able to map it back to our data.\n\t\t\t\t\ttaskIdPromises.push(this.addCustomExecution(taskDTO, task, true));\n\t\t\t\t} else {\n\t\t\t\t\tthis._logService.warn('Only custom execution tasks supported.');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn {\n\t\t\ttasks: taskDTOs,\n\t\t\textension: handler.extension\n\t\t};\n\t}\n\n\tprotected async resolveTaskInternal(resolvedTaskDTO: tasks.ITaskDTO): Promise<tasks.ITaskDTO | undefined> {\n\t\tif (CustomExecutionDTO.is(resolvedTaskDTO.execution)) {\n\t\t\treturn resolvedTaskDTO;\n\t\t} else {\n\t\t\tthis._logService.warn('Only custom execution tasks supported.');\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tpublic async $resolveVariables(uriComponents: UriComponents, toResolve: { process?: { name: string; cwd?: string; path?: string }; variables: string[] }): Promise<{ process?: string; variables: { [key: string]: string } }> {\n\t\tconst result = {\n\t\t\tprocess: <unknown>undefined as string,\n\t\t\tvariables: Object.create(null)\n\t\t};\n\t\treturn result;\n\t}\n\n\tpublic async $jsonTasksSupported(): Promise<boolean> {\n\t\treturn false;\n\t}\n\n\tpublic async $findExecutable(command: string, cwd?: string | undefined, paths?: string[] | undefined): Promise<string | undefined> {\n\t\treturn undefined;\n\t}\n}\n\nexport const IExtHostTask = createDecorator<IExtHostTask>('IExtHostTask');\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as path from 'vs/base/common/path';\nimport { CancellationToken, CancellationTokenSource } from 'vs/base/common/cancellation';\nimport { toErrorMessage } from 'vs/base/common/errorMessage';\nimport * as glob from 'vs/base/common/glob';\nimport * as resources from 'vs/base/common/resources';\nimport { StopWatch } from 'vs/base/common/stopwatch';\nimport { URI } from 'vs/base/common/uri';\nimport { IFileMatch, IFileSearchProviderStats, IFolderQuery, ISearchCompleteStats, IFileQuery, QueryGlobTester, resolvePatternsForProvider, hasSiblingFn } from 'vs/workbench/services/search/common/search';\nimport { FileSearchProvider, FileSearchOptions } from 'vs/workbench/services/search/common/searchExtTypes';\n\nexport interface IInternalFileMatch {\n\tbase: URI;\n\toriginal?: URI;\n\trelativePath?: string; // Not present for extraFiles or absolute path matches\n\tbasename: string;\n\tsize?: number;\n}\n\nexport interface IDirectoryEntry {\n\tbase: URI;\n\trelativePath: string;\n\tbasename: string;\n}\n\nexport interface IDirectoryTree {\n\trootEntries: IDirectoryEntry[];\n\tpathToEntries: { [relativePath: string]: IDirectoryEntry[] };\n}\n\nclass FileSearchEngine {\n\tprivate filePattern?: string;\n\tprivate includePattern?: glob.ParsedExpression;\n\tprivate maxResults?: number;\n\tprivate exists?: boolean;\n\tprivate isLimitHit = false;\n\tprivate resultCount = 0;\n\tprivate isCanceled = false;\n\n\tprivate activeCancellationTokens: Set<CancellationTokenSource>;\n\n\tprivate globalExcludePattern?: glob.ParsedExpression;\n\n\tconstructor(private config: IFileQuery, private provider: FileSearchProvider, private sessionToken?: CancellationToken) {\n\t\tthis.filePattern = config.filePattern;\n\t\tthis.includePattern = config.includePattern && glob.parse(config.includePattern);\n\t\tthis.maxResults = config.maxResults || undefined;\n\t\tthis.exists = config.exists;\n\t\tthis.activeCancellationTokens = new Set<CancellationTokenSource>();\n\n\t\tthis.globalExcludePattern = config.excludePattern && glob.parse(config.excludePattern);\n\t}\n\n\tcancel(): void {\n\t\tthis.isCanceled = true;\n\t\tthis.activeCancellationTokens.forEach(t => t.cancel());\n\t\tthis.activeCancellationTokens = new Set();\n\t}\n\n\tsearch(_onResult: (match: IInternalFileMatch) => void): Promise<IInternalSearchComplete> {\n\t\tconst folderQueries = this.config.folderQueries || [];\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst onResult = (match: IInternalFileMatch) => {\n\t\t\t\tthis.resultCount++;\n\t\t\t\t_onResult(match);\n\t\t\t};\n\n\t\t\t// Support that the file pattern is a full path to a file that exists\n\t\t\tif (this.isCanceled) {\n\t\t\t\treturn resolve({ limitHit: this.isLimitHit });\n\t\t\t}\n\n\t\t\t// For each extra file\n\t\t\tif (this.config.extraFileResources) {\n\t\t\t\tthis.config.extraFileResources\n\t\t\t\t\t.forEach(extraFile => {\n\t\t\t\t\t\tconst extraFileStr = extraFile.toString(); // ?\n\t\t\t\t\t\tconst basename = path.basename(extraFileStr);\n\t\t\t\t\t\tif (this.globalExcludePattern && this.globalExcludePattern(extraFileStr, basename)) {\n\t\t\t\t\t\t\treturn; // excluded\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// File: Check for match on file pattern and include pattern\n\t\t\t\t\t\tthis.matchFile(onResult, { base: extraFile, basename });\n\t\t\t\t\t});\n\t\t\t}\n\n\t\t\t// For each root folder\n\t\t\tPromise.all(folderQueries.map(fq => {\n\t\t\t\treturn this.searchInFolder(fq, onResult);\n\t\t\t})).then(stats => {\n\t\t\t\tresolve({\n\t\t\t\t\tlimitHit: this.isLimitHit,\n\t\t\t\t\tstats: stats[0] || undefined // Only looking at single-folder workspace stats...\n\t\t\t\t});\n\t\t\t}, (err: Error) => {\n\t\t\t\treject(new Error(toErrorMessage(err)));\n\t\t\t});\n\t\t});\n\t}\n\n\tprivate async searchInFolder(fq: IFolderQuery<URI>, onResult: (match: IInternalFileMatch) => void): Promise<IFileSearchProviderStats | null> {\n\t\tconst cancellation = new CancellationTokenSource();\n\t\tconst options = this.getSearchOptionsForFolder(fq);\n\t\tconst tree = this.initDirectoryTree();\n\n\t\tconst queryTester = new QueryGlobTester(this.config, fq);\n\t\tconst noSiblingsClauses = !queryTester.hasSiblingExcludeClauses();\n\n\t\tlet providerSW: StopWatch;\n\n\t\ttry {\n\t\t\tthis.activeCancellationTokens.add(cancellation);\n\n\t\t\tproviderSW = StopWatch.create();\n\t\t\tconst results = await this.provider.provideFileSearchResults(\n\t\t\t\t{\n\t\t\t\t\tpattern: this.config.filePattern || ''\n\t\t\t\t},\n\t\t\t\toptions,\n\t\t\t\tcancellation.token);\n\t\t\tconst providerTime = providerSW.elapsed();\n\t\t\tconst postProcessSW = StopWatch.create();\n\n\t\t\tif (this.isCanceled && !this.isLimitHit) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tif (results) {\n\t\t\t\tresults.forEach(result => {\n\t\t\t\t\tconst relativePath = path.posix.relative(fq.folder.path, result.path);\n\n\t\t\t\t\tif (noSiblingsClauses) {\n\t\t\t\t\t\tconst basename = path.basename(result.path);\n\t\t\t\t\t\tthis.matchFile(onResult, { base: fq.folder, relativePath, basename });\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// TODO: Optimize siblings clauses with ripgrep here.\n\t\t\t\t\tthis.addDirectoryEntries(tree, fq.folder, relativePath, onResult);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (this.isCanceled && !this.isLimitHit) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tthis.matchDirectoryTree(tree, queryTester, onResult);\n\t\t\treturn <IFileSearchProviderStats>{\n\t\t\t\tproviderTime,\n\t\t\t\tpostProcessTime: postProcessSW.elapsed()\n\t\t\t};\n\t\t} finally {\n\t\t\tcancellation.dispose();\n\t\t\tthis.activeCancellationTokens.delete(cancellation);\n\t\t}\n\t}\n\n\tprivate getSearchOptionsForFolder(fq: IFolderQuery<URI>): FileSearchOptions {\n\t\tconst includes = resolvePatternsForProvider(this.config.includePattern, fq.includePattern);\n\t\tconst excludes = resolvePatternsForProvider(this.config.excludePattern, fq.excludePattern);\n\n\t\treturn {\n\t\t\tfolder: fq.folder,\n\t\t\texcludes,\n\t\t\tincludes,\n\t\t\tuseIgnoreFiles: !fq.disregardIgnoreFiles,\n\t\t\tuseGlobalIgnoreFiles: !fq.disregardGlobalIgnoreFiles,\n\t\t\tuseParentIgnoreFiles: !fq.disregardParentIgnoreFiles,\n\t\t\tfollowSymlinks: !fq.ignoreSymlinks,\n\t\t\tmaxResults: this.config.maxResults,\n\t\t\tsession: this.sessionToken\n\t\t};\n\t}\n\n\tprivate initDirectoryTree(): IDirectoryTree {\n\t\tconst tree: IDirectoryTree = {\n\t\t\trootEntries: [],\n\t\t\tpathToEntries: Object.create(null)\n\t\t};\n\t\ttree.pathToEntries['.'] = tree.rootEntries;\n\t\treturn tree;\n\t}\n\n\tprivate addDirectoryEntries({ pathToEntries }: IDirectoryTree, base: URI, relativeFile: string, onResult: (result: IInternalFileMatch) => void) {\n\t\t// Support relative paths to files from a root resource (ignores excludes)\n\t\tif (relativeFile === this.filePattern) {\n\t\t\tconst basename = path.basename(this.filePattern);\n\t\t\tthis.matchFile(onResult, { base: base, relativePath: this.filePattern, basename });\n\t\t}\n\n\t\tfunction add(relativePath: string) {\n\t\t\tconst basename = path.basename(relativePath);\n\t\t\tconst dirname = path.dirname(relativePath);\n\t\t\tlet entries = pathToEntries[dirname];\n\t\t\tif (!entries) {\n\t\t\t\tentries = pathToEntries[dirname] = [];\n\t\t\t\tadd(dirname);\n\t\t\t}\n\t\t\tentries.push({\n\t\t\t\tbase,\n\t\t\t\trelativePath,\n\t\t\t\tbasename\n\t\t\t});\n\t\t}\n\n\t\tadd(relativeFile);\n\t}\n\n\tprivate matchDirectoryTree({ rootEntries, pathToEntries }: IDirectoryTree, queryTester: QueryGlobTester, onResult: (result: IInternalFileMatch) => void) {\n\t\tconst self = this;\n\t\tconst filePattern = this.filePattern;\n\t\tfunction matchDirectory(entries: IDirectoryEntry[]) {\n\t\t\tconst hasSibling = hasSiblingFn(() => entries.map(entry => entry.basename));\n\t\t\tfor (let i = 0, n = entries.length; i < n; i++) {\n\t\t\t\tconst entry = entries[i];\n\t\t\t\tconst { relativePath, basename } = entry;\n\n\t\t\t\t// Check exclude pattern\n\t\t\t\t// If the user searches for the exact file name, we adjust the glob matching\n\t\t\t\t// to ignore filtering by siblings because the user seems to know what they\n\t\t\t\t// are searching for and we want to include the result in that case anyway\n\t\t\t\tif (queryTester.matchesExcludesSync(relativePath, basename, filePattern !== basename ? hasSibling : undefined)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst sub = pathToEntries[relativePath];\n\t\t\t\tif (sub) {\n\t\t\t\t\tmatchDirectory(sub);\n\t\t\t\t} else {\n\t\t\t\t\tif (relativePath === filePattern) {\n\t\t\t\t\t\tcontinue; // ignore file if its path matches with the file pattern because that is already matched above\n\t\t\t\t\t}\n\n\t\t\t\t\tself.matchFile(onResult, entry);\n\t\t\t\t}\n\n\t\t\t\tif (self.isLimitHit) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tmatchDirectory(rootEntries);\n\t}\n\n\tprivate matchFile(onResult: (result: IInternalFileMatch) => void, candidate: IInternalFileMatch): void {\n\t\tif (!this.includePattern || (candidate.relativePath && this.includePattern(candidate.relativePath, candidate.basename))) {\n\t\t\tif (this.exists || (this.maxResults && this.resultCount >= this.maxResults)) {\n\t\t\t\tthis.isLimitHit = true;\n\t\t\t\tthis.cancel();\n\t\t\t}\n\n\t\t\tif (!this.isLimitHit) {\n\t\t\t\tonResult(candidate);\n\t\t\t}\n\t\t}\n\t}\n}\n\ninterface IInternalSearchComplete {\n\tlimitHit: boolean;\n\tstats?: IFileSearchProviderStats;\n}\n\nexport class FileSearchManager {\n\n\tprivate static readonly BATCH_SIZE = 512;\n\n\tprivate readonly sessions = new Map<string, CancellationTokenSource>();\n\n\tfileSearch(config: IFileQuery, provider: FileSearchProvider, onBatch: (matches: IFileMatch[]) => void, token: CancellationToken): Promise<ISearchCompleteStats> {\n\t\tconst sessionTokenSource = this.getSessionTokenSource(config.cacheKey);\n\t\tconst engine = new FileSearchEngine(config, provider, sessionTokenSource && sessionTokenSource.token);\n\n\t\tlet resultCount = 0;\n\t\tconst onInternalResult = (batch: IInternalFileMatch[]) => {\n\t\t\tresultCount += batch.length;\n\t\t\tonBatch(batch.map(m => this.rawMatchToSearchItem(m)));\n\t\t};\n\n\t\treturn this.doSearch(engine, FileSearchManager.BATCH_SIZE, onInternalResult, token).then(\n\t\t\tresult => {\n\t\t\t\treturn <ISearchCompleteStats>{\n\t\t\t\t\tlimitHit: result.limitHit,\n\t\t\t\t\tstats: {\n\t\t\t\t\t\tfromCache: false,\n\t\t\t\t\t\ttype: 'fileSearchProvider',\n\t\t\t\t\t\tresultCount,\n\t\t\t\t\t\tdetailStats: result.stats\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t});\n\t}\n\n\tclearCache(cacheKey: string): void {\n\t\tconst sessionTokenSource = this.getSessionTokenSource(cacheKey);\n\t\tif (sessionTokenSource) {\n\t\t\tsessionTokenSource.cancel();\n\t\t}\n\t}\n\n\tprivate getSessionTokenSource(cacheKey: string | undefined): CancellationTokenSource | undefined {\n\t\tif (!cacheKey) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (!this.sessions.has(cacheKey)) {\n\t\t\tthis.sessions.set(cacheKey, new CancellationTokenSource());\n\t\t}\n\n\t\treturn this.sessions.get(cacheKey);\n\t}\n\n\tprivate rawMatchToSearchItem(match: IInternalFileMatch): IFileMatch {\n\t\tif (match.relativePath) {\n\t\t\treturn {\n\t\t\t\tresource: resources.joinPath(match.base, match.relativePath)\n\t\t\t};\n\t\t} else {\n\t\t\t// extraFileResources\n\t\t\treturn {\n\t\t\t\tresource: match.base\n\t\t\t};\n\t\t}\n\t}\n\n\tprivate doSearch(engine: FileSearchEngine, batchSize: number, onResultBatch: (matches: IInternalFileMatch[]) => void, token: CancellationToken): Promise<IInternalSearchComplete> {\n\t\ttoken.onCancellationRequested(() => {\n\t\t\tengine.cancel();\n\t\t});\n\n\t\tconst _onResult = (match: IInternalFileMatch) => {\n\t\t\tif (match) {\n\t\t\t\tbatch.push(match);\n\t\t\t\tif (batchSize > 0 && batch.length >= batchSize) {\n\t\t\t\t\tonResultBatch(batch);\n\t\t\t\t\tbatch = [];\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tlet batch: IInternalFileMatch[] = [];\n\t\treturn engine.search(_onResult).then(result => {\n\t\t\tif (batch.length) {\n\t\t\t\tonResultBatch(batch);\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}, error => {\n\t\t\tif (batch.length) {\n\t\t\t\tonResultBatch(batch);\n\t\t\t}\n\n\t\t\treturn Promise.reject(error);\n\t\t});\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as arrays from 'vs/base/common/arrays';\nimport * as collections from 'vs/base/common/collections';\nimport * as glob from 'vs/base/common/glob';\nimport { untildify } from 'vs/base/common/labels';\nimport { ResourceMap } from 'vs/base/common/map';\nimport { Schemas } from 'vs/base/common/network';\nimport * as path from 'vs/base/common/path';\nimport { isEqual, basename, relativePath, isAbsolutePath } from 'vs/base/common/resources';\nimport * as strings from 'vs/base/common/strings';\nimport { assertIsDefined, isDefined } from 'vs/base/common/types';\nimport { URI, URI as uri } from 'vs/base/common/uri';\nimport { isMultilineRegexSource } from 'vs/editor/common/model/textModelSearch';\nimport * as nls from 'vs/nls';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { IWorkspaceContextService, IWorkspaceFolderData, toWorkspaceFolder, WorkbenchState } from 'vs/platform/workspace/common/workspace';\nimport { IEditorGroupsService } from 'vs/workbench/services/editor/common/editorGroupsService';\nimport { IPathService } from 'vs/workbench/services/path/common/pathService';\nimport { getExcludes, ICommonQueryProps, IFileQuery, IFolderQuery, IPatternInfo, ISearchConfiguration, ITextQuery, ITextSearchPreviewOptions, pathIncludedInQuery, QueryType } from 'vs/workbench/services/search/common/search';\n\n/**\n * One folder to search and a glob expression that should be applied.\n */\nexport interface IOneSearchPathPattern {\n\tsearchPath: uri;\n\tpattern?: string;\n}\n\n/**\n * One folder to search and a set of glob expressions that should be applied.\n */\nexport interface ISearchPathPattern {\n\tsearchPath: uri;\n\tpattern?: glob.IExpression;\n}\n\n/**\n * A set of search paths and a set of glob expressions that should be applied.\n */\nexport interface ISearchPathsInfo {\n\tsearchPaths?: ISearchPathPattern[];\n\tpattern?: glob.IExpression;\n}\n\nexport interface ICommonQueryBuilderOptions {\n\t_reason?: string;\n\texcludePattern?: string | string[];\n\tincludePattern?: string | string[];\n\textraFileResources?: uri[];\n\n\t/** Parse the special ./ syntax supported by the searchview, and expand foo to ** /foo */\n\texpandPatterns?: boolean;\n\n\tmaxResults?: number;\n\tmaxFileSize?: number;\n\tdisregardIgnoreFiles?: boolean;\n\tdisregardGlobalIgnoreFiles?: boolean;\n\tdisregardParentIgnoreFiles?: boolean;\n\tdisregardExcludeSettings?: boolean;\n\tdisregardSearchExcludeSettings?: boolean;\n\tignoreSymlinks?: boolean;\n\tonlyOpenEditors?: boolean;\n}\n\nexport interface IFileQueryBuilderOptions extends ICommonQueryBuilderOptions {\n\tfilePattern?: string;\n\texists?: boolean;\n\tsortByScore?: boolean;\n\tcacheKey?: string;\n}\n\nexport interface ITextQueryBuilderOptions extends ICommonQueryBuilderOptions {\n\tpreviewOptions?: ITextSearchPreviewOptions;\n\tfileEncoding?: string;\n\tbeforeContext?: number;\n\tafterContext?: number;\n\tisSmartCase?: boolean;\n}\n\nexport class QueryBuilder {\n\n\tconstructor(\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IWorkspaceContextService private readonly workspaceContextService: IWorkspaceContextService,\n\t\t@IEditorGroupsService private readonly editorGroupsService: IEditorGroupsService,\n\t\t@ILogService private readonly logService: ILogService,\n\t\t@IPathService private readonly pathService: IPathService\n\t) {\n\t}\n\n\ttext(contentPattern: IPatternInfo, folderResources?: uri[], options: ITextQueryBuilderOptions = {}): ITextQuery {\n\t\tcontentPattern = this.getContentPattern(contentPattern, options);\n\t\tconst searchConfig = this.configurationService.getValue<ISearchConfiguration>();\n\n\t\tconst fallbackToPCRE = folderResources && folderResources.some(folder => {\n\t\t\tconst folderConfig = this.configurationService.getValue<ISearchConfiguration>({ resource: folder });\n\t\t\treturn !folderConfig.search.useRipgrep;\n\t\t});\n\n\t\tconst commonQuery = this.commonQuery(folderResources?.map(toWorkspaceFolder), options);\n\t\treturn <ITextQuery>{\n\t\t\t...commonQuery,\n\t\t\ttype: QueryType.Text,\n\t\t\tcontentPattern,\n\t\t\tpreviewOptions: options.previewOptions,\n\t\t\tmaxFileSize: options.maxFileSize,\n\t\t\tusePCRE2: searchConfig.search.usePCRE2 || fallbackToPCRE || false,\n\t\t\tbeforeContext: options.beforeContext,\n\t\t\tafterContext: options.afterContext,\n\t\t\tuserDisabledExcludesAndIgnoreFiles: options.disregardExcludeSettings && options.disregardIgnoreFiles\n\t\t};\n\t}\n\n\t/**\n\t * Adjusts input pattern for config\n\t */\n\tprivate getContentPattern(inputPattern: IPatternInfo, options: ITextQueryBuilderOptions): IPatternInfo {\n\t\tconst searchConfig = this.configurationService.getValue<ISearchConfiguration>();\n\n\t\tif (inputPattern.isRegExp) {\n\t\t\tinputPattern.pattern = inputPattern.pattern.replace(/\\r?\\n/g, '\\\\n');\n\t\t}\n\n\t\tconst newPattern = {\n\t\t\t...inputPattern,\n\t\t\twordSeparators: searchConfig.editor.wordSeparators\n\t\t};\n\n\t\tif (this.isCaseSensitive(inputPattern, options)) {\n\t\t\tnewPattern.isCaseSensitive = true;\n\t\t}\n\n\t\tif (this.isMultiline(inputPattern)) {\n\t\t\tnewPattern.isMultiline = true;\n\t\t}\n\n\t\treturn newPattern;\n\t}\n\n\tfile(folders: (IWorkspaceFolderData | URI)[], options: IFileQueryBuilderOptions = {}): IFileQuery {\n\t\tconst commonQuery = this.commonQuery(folders, options);\n\t\treturn <IFileQuery>{\n\t\t\t...commonQuery,\n\t\t\ttype: QueryType.File,\n\t\t\tfilePattern: options.filePattern\n\t\t\t\t? options.filePattern.trim()\n\t\t\t\t: options.filePattern,\n\t\t\texists: options.exists,\n\t\t\tsortByScore: options.sortByScore,\n\t\t\tcacheKey: options.cacheKey,\n\t\t};\n\t}\n\n\tprivate handleIncludeExclude(pattern: string | string[] | undefined, expandPatterns: boolean | undefined): ISearchPathsInfo {\n\t\tif (!pattern) {\n\t\t\treturn {};\n\t\t}\n\n\t\tpattern = Array.isArray(pattern) ? pattern.map(normalizeSlashes) : normalizeSlashes(pattern);\n\t\treturn expandPatterns\n\t\t\t? this.parseSearchPaths(pattern)\n\t\t\t: { pattern: patternListToIExpression(...(Array.isArray(pattern) ? pattern : [pattern])) };\n\t}\n\n\tprivate commonQuery(folderResources: (IWorkspaceFolderData | URI)[] = [], options: ICommonQueryBuilderOptions = {}): ICommonQueryProps<uri> {\n\t\tconst includeSearchPathsInfo: ISearchPathsInfo = this.handleIncludeExclude(options.includePattern, options.expandPatterns);\n\t\tconst excludeSearchPathsInfo: ISearchPathsInfo = this.handleIncludeExclude(options.excludePattern, options.expandPatterns);\n\n\t\t// Build folderQueries from searchPaths, if given, otherwise folderResources\n\t\tconst includeFolderName = folderResources.length > 1;\n\t\tconst folderQueries = (includeSearchPathsInfo.searchPaths && includeSearchPathsInfo.searchPaths.length ?\n\t\t\tincludeSearchPathsInfo.searchPaths.map(searchPath => this.getFolderQueryForSearchPath(searchPath, options, excludeSearchPathsInfo)) :\n\t\t\tfolderResources.map(folder => this.getFolderQueryForRoot(folder, options, excludeSearchPathsInfo, includeFolderName)))\n\t\t\t.filter(query => !!query) as IFolderQuery[];\n\n\t\tconst queryProps: ICommonQueryProps<uri> = {\n\t\t\t_reason: options._reason,\n\t\t\tfolderQueries,\n\t\t\tusingSearchPaths: !!(includeSearchPathsInfo.searchPaths && includeSearchPathsInfo.searchPaths.length),\n\t\t\textraFileResources: options.extraFileResources,\n\n\t\t\texcludePattern: excludeSearchPathsInfo.pattern,\n\t\t\tincludePattern: includeSearchPathsInfo.pattern,\n\t\t\tonlyOpenEditors: options.onlyOpenEditors,\n\t\t\tmaxResults: options.maxResults\n\t\t};\n\n\t\tif (options.onlyOpenEditors) {\n\t\t\tconst openEditors = arrays.coalesce(arrays.flatten(this.editorGroupsService.groups.map(group => group.editors.map(editor => editor.resource))));\n\t\t\tthis.logService.trace('QueryBuilder#commonQuery - openEditor URIs', JSON.stringify(openEditors));\n\t\t\tconst openEditorsInQuery = openEditors.filter(editor => pathIncludedInQuery(queryProps, editor.fsPath));\n\t\t\tconst openEditorsQueryProps = this.commonQueryFromFileList(openEditorsInQuery);\n\t\t\tthis.logService.trace('QueryBuilder#commonQuery - openEditor Query', JSON.stringify(openEditorsQueryProps));\n\t\t\treturn { ...queryProps, ...openEditorsQueryProps };\n\t\t}\n\n\t\t// Filter extraFileResources against global include/exclude patterns - they are already expected to not belong to a workspace\n\t\tconst extraFileResources = options.extraFileResources && options.extraFileResources.filter(extraFile => pathIncludedInQuery(queryProps, extraFile.fsPath));\n\t\tqueryProps.extraFileResources = extraFileResources && extraFileResources.length ? extraFileResources : undefined;\n\n\t\treturn queryProps;\n\t}\n\n\tprivate commonQueryFromFileList(files: URI[]): ICommonQueryProps<URI> {\n\t\tconst folderQueries: IFolderQuery[] = [];\n\t\tconst foldersToSearch: ResourceMap<IFolderQuery> = new ResourceMap();\n\t\tconst includePattern: glob.IExpression = {};\n\t\tlet hasIncludedFile = false;\n\t\tfiles.forEach(file => {\n\t\t\tif (file.scheme === Schemas.walkThrough) { return; }\n\n\t\t\tconst providerExists = isAbsolutePath(file);\n\t\t\t// Special case userdata as we don't have a search provider for it, but it can be searched.\n\t\t\tif (providerExists) {\n\t\t\t\tconst searchRoot = this.workspaceContextService.getWorkspaceFolder(file)?.uri ?? file.with({ path: path.dirname(file.fsPath) });\n\n\t\t\t\tlet folderQuery = foldersToSearch.get(searchRoot);\n\t\t\t\tif (!folderQuery) {\n\t\t\t\t\thasIncludedFile = true;\n\t\t\t\t\tfolderQuery = { folder: searchRoot, includePattern: {} };\n\t\t\t\t\tfolderQueries.push(folderQuery);\n\t\t\t\t\tfoldersToSearch.set(searchRoot, folderQuery);\n\t\t\t\t}\n\n\t\t\t\tconst relPath = path.relative(searchRoot.fsPath, file.fsPath);\n\t\t\t\tassertIsDefined(folderQuery.includePattern)[relPath.replace(/\\\\/g, '/')] = true;\n\t\t\t} else {\n\t\t\t\tif (file.fsPath) {\n\t\t\t\t\thasIncludedFile = true;\n\t\t\t\t\tincludePattern[file.fsPath] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn {\n\t\t\tfolderQueries,\n\t\t\tincludePattern,\n\t\t\tusingSearchPaths: true,\n\t\t\texcludePattern: hasIncludedFile ? undefined : { '**/*': true }\n\t\t};\n\t}\n\n\t/**\n\t * Resolve isCaseSensitive flag based on the query and the isSmartCase flag, for search providers that don't support smart case natively.\n\t */\n\tprivate isCaseSensitive(contentPattern: IPatternInfo, options: ITextQueryBuilderOptions): boolean {\n\t\tif (options.isSmartCase) {\n\t\t\tif (contentPattern.isRegExp) {\n\t\t\t\t// Consider it case sensitive if it contains an unescaped capital letter\n\t\t\t\tif (strings.containsUppercaseCharacter(contentPattern.pattern, true)) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t} else if (strings.containsUppercaseCharacter(contentPattern.pattern)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn !!contentPattern.isCaseSensitive;\n\t}\n\n\tprivate isMultiline(contentPattern: IPatternInfo): boolean {\n\t\tif (contentPattern.isMultiline) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (contentPattern.isRegExp && isMultilineRegexSource(contentPattern.pattern)) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (contentPattern.pattern.indexOf('\\n') >= 0) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn !!contentPattern.isMultiline;\n\t}\n\n\t/**\n\t * Take the includePattern as seen in the search viewlet, and split into components that look like searchPaths, and\n\t * glob patterns. Glob patterns are expanded from 'foo/bar' to '{foo/bar/**, **\\/foo/bar}.\n\t *\n\t * Public for test.\n\t */\n\tparseSearchPaths(pattern: string | string[]): ISearchPathsInfo {\n\t\tconst isSearchPath = (segment: string) => {\n\t\t\t// A segment is a search path if it is an absolute path or starts with ./, ../, .\\, or ..\\\n\t\t\treturn path.isAbsolute(segment) || /^\\.\\.?([\\/\\\\]|$)/.test(segment);\n\t\t};\n\n\t\tconst patterns = Array.isArray(pattern) ? pattern : splitGlobPattern(pattern);\n\t\tconst segments = patterns\n\t\t\t.map(segment => {\n\t\t\t\tconst userHome = this.pathService.resolvedUserHome;\n\t\t\t\tif (userHome) {\n\t\t\t\t\treturn untildify(segment, userHome.scheme === Schemas.file ? userHome.fsPath : userHome.path);\n\t\t\t\t}\n\n\t\t\t\treturn segment;\n\t\t\t});\n\t\tconst groups = collections.groupBy(segments,\n\t\t\tsegment => isSearchPath(segment) ? 'searchPaths' : 'exprSegments');\n\n\t\tconst expandedExprSegments = (groups.exprSegments || [])\n\t\t\t.map(s => strings.rtrim(s, '/'))\n\t\t\t.map(s => strings.rtrim(s, '\\\\'))\n\t\t\t.map(p => {\n\t\t\t\tif (p[0] === '.') {\n\t\t\t\t\tp = '*' + p; // convert \".js\" to \"*.js\"\n\t\t\t\t}\n\n\t\t\t\treturn expandGlobalGlob(p);\n\t\t\t});\n\n\t\tconst result: ISearchPathsInfo = {};\n\t\tconst searchPaths = this.expandSearchPathPatterns(groups.searchPaths || []);\n\t\tif (searchPaths && searchPaths.length) {\n\t\t\tresult.searchPaths = searchPaths;\n\t\t}\n\n\t\tconst exprSegments = arrays.flatten(expandedExprSegments);\n\t\tconst includePattern = patternListToIExpression(...exprSegments);\n\t\tif (includePattern) {\n\t\t\tresult.pattern = includePattern;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprivate getExcludesForFolder(folderConfig: ISearchConfiguration, options: ICommonQueryBuilderOptions): glob.IExpression | undefined {\n\t\treturn options.disregardExcludeSettings ?\n\t\t\tundefined :\n\t\t\tgetExcludes(folderConfig, !options.disregardSearchExcludeSettings);\n\t}\n\n\t/**\n\t * Split search paths (./ or ../ or absolute paths in the includePatterns) into absolute paths and globs applied to those paths\n\t */\n\tprivate expandSearchPathPatterns(searchPaths: string[]): ISearchPathPattern[] {\n\t\tif (!searchPaths || !searchPaths.length) {\n\t\t\t// No workspace => ignore search paths\n\t\t\treturn [];\n\t\t}\n\n\t\tconst expandedSearchPaths = arrays.flatten(\n\t\t\tsearchPaths.map(searchPath => {\n\t\t\t\t// 1 open folder => just resolve the search paths to absolute paths\n\t\t\t\tlet { pathPortion, globPortion } = splitGlobFromPath(searchPath);\n\n\t\t\t\tif (globPortion) {\n\t\t\t\t\tglobPortion = normalizeGlobPattern(globPortion);\n\t\t\t\t}\n\n\t\t\t\t// One pathPortion to multiple expanded search paths (e.g. duplicate matching workspace folders)\n\t\t\t\tconst oneExpanded = this.expandOneSearchPath(pathPortion);\n\n\t\t\t\t// Expanded search paths to multiple resolved patterns (with ** and without)\n\t\t\t\treturn arrays.flatten(\n\t\t\t\t\toneExpanded.map(oneExpandedResult => this.resolveOneSearchPathPattern(oneExpandedResult, globPortion)));\n\t\t\t}));\n\n\t\tconst searchPathPatternMap = new Map<string, ISearchPathPattern>();\n\t\texpandedSearchPaths.forEach(oneSearchPathPattern => {\n\t\t\tconst key = oneSearchPathPattern.searchPath.toString();\n\t\t\tconst existing = searchPathPatternMap.get(key);\n\t\t\tif (existing) {\n\t\t\t\tif (oneSearchPathPattern.pattern) {\n\t\t\t\t\texisting.pattern = existing.pattern || {};\n\t\t\t\t\texisting.pattern[oneSearchPathPattern.pattern] = true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tsearchPathPatternMap.set(key, {\n\t\t\t\t\tsearchPath: oneSearchPathPattern.searchPath,\n\t\t\t\t\tpattern: oneSearchPathPattern.pattern ? patternListToIExpression(oneSearchPathPattern.pattern) : undefined\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\treturn Array.from(searchPathPatternMap.values());\n\t}\n\n\t/**\n\t * Takes a searchPath like `./a/foo` or `../a/foo` and expands it to absolute paths for all the workspaces it matches.\n\t */\n\tprivate expandOneSearchPath(searchPath: string): IOneSearchPathPattern[] {\n\t\tif (path.isAbsolute(searchPath)) {\n\t\t\tconst workspaceFolders = this.workspaceContextService.getWorkspace().folders;\n\t\t\tif (workspaceFolders[0] && workspaceFolders[0].uri.scheme !== Schemas.file) {\n\t\t\t\treturn [{\n\t\t\t\t\tsearchPath: workspaceFolders[0].uri.with({ path: searchPath })\n\t\t\t\t}];\n\t\t\t}\n\n\t\t\t// Currently only local resources can be searched for with absolute search paths.\n\t\t\t// TODO convert this to a workspace folder + pattern, so excludes will be resolved properly for an absolute path inside a workspace folder\n\t\t\treturn [{\n\t\t\t\tsearchPath: uri.file(path.normalize(searchPath))\n\t\t\t}];\n\t\t}\n\n\t\tif (this.workspaceContextService.getWorkbenchState() === WorkbenchState.FOLDER) {\n\t\t\tconst workspaceUri = this.workspaceContextService.getWorkspace().folders[0].uri;\n\n\t\t\tsearchPath = normalizeSlashes(searchPath);\n\t\t\tif (searchPath.startsWith('../') || searchPath === '..') {\n\t\t\t\tconst resolvedPath = path.posix.resolve(workspaceUri.path, searchPath);\n\t\t\t\treturn [{\n\t\t\t\t\tsearchPath: workspaceUri.with({ path: resolvedPath })\n\t\t\t\t}];\n\t\t\t}\n\n\t\t\tconst cleanedPattern = normalizeGlobPattern(searchPath);\n\t\t\treturn [{\n\t\t\t\tsearchPath: workspaceUri,\n\t\t\t\tpattern: cleanedPattern\n\t\t\t}];\n\t\t} else if (searchPath === './' || searchPath === '.\\\\') {\n\t\t\treturn []; // ./ or ./**/foo makes sense for single-folder but not multi-folder workspaces\n\t\t} else {\n\t\t\tconst searchPathWithoutDotSlash = searchPath.replace(/^\\.[\\/\\\\]/, '');\n\t\t\tconst folders = this.workspaceContextService.getWorkspace().folders;\n\t\t\tconst folderMatches = folders.map(folder => {\n\t\t\t\tconst match = searchPathWithoutDotSlash.match(new RegExp(`^${strings.escapeRegExpCharacters(folder.name)}(?:/(.*)|$)`));\n\t\t\t\treturn match ? {\n\t\t\t\t\tmatch,\n\t\t\t\t\tfolder\n\t\t\t\t} : null;\n\t\t\t}).filter(isDefined);\n\n\t\t\tif (folderMatches.length) {\n\t\t\t\treturn folderMatches.map(match => {\n\t\t\t\t\tconst patternMatch = match.match[1];\n\t\t\t\t\treturn {\n\t\t\t\t\t\tsearchPath: match.folder.uri,\n\t\t\t\t\t\tpattern: patternMatch && normalizeGlobPattern(patternMatch)\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tconst probableWorkspaceFolderNameMatch = searchPath.match(/\\.[\\/\\\\](.+)[\\/\\\\]?/);\n\t\t\t\tconst probableWorkspaceFolderName = probableWorkspaceFolderNameMatch ? probableWorkspaceFolderNameMatch[1] : searchPath;\n\n\t\t\t\t// No root folder with name\n\t\t\t\tconst searchPathNotFoundError = nls.localize('search.noWorkspaceWithName', \"Workspace folder does not exist: {0}\", probableWorkspaceFolderName);\n\t\t\t\tthrow new Error(searchPathNotFoundError);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate resolveOneSearchPathPattern(oneExpandedResult: IOneSearchPathPattern, globPortion?: string): IOneSearchPathPattern[] {\n\t\tconst pattern = oneExpandedResult.pattern && globPortion ?\n\t\t\t`${oneExpandedResult.pattern}/${globPortion}` :\n\t\t\toneExpandedResult.pattern || globPortion;\n\n\t\tconst results = [\n\t\t\t{\n\t\t\t\tsearchPath: oneExpandedResult.searchPath,\n\t\t\t\tpattern\n\t\t\t}];\n\n\t\tif (pattern && !pattern.endsWith('**')) {\n\t\t\tresults.push({\n\t\t\t\tsearchPath: oneExpandedResult.searchPath,\n\t\t\t\tpattern: pattern + '/**'\n\t\t\t});\n\t\t}\n\n\t\treturn results;\n\t}\n\n\tprivate getFolderQueryForSearchPath(searchPath: ISearchPathPattern, options: ICommonQueryBuilderOptions, searchPathExcludes: ISearchPathsInfo): IFolderQuery | null {\n\t\tconst rootConfig = this.getFolderQueryForRoot(toWorkspaceFolder(searchPath.searchPath), options, searchPathExcludes, false);\n\t\tif (!rootConfig) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\t...rootConfig,\n\t\t\t...{\n\t\t\t\tincludePattern: searchPath.pattern\n\t\t\t}\n\t\t};\n\t}\n\n\tprivate getFolderQueryForRoot(folder: (IWorkspaceFolderData | URI), options: ICommonQueryBuilderOptions, searchPathExcludes: ISearchPathsInfo, includeFolderName: boolean): IFolderQuery | null {\n\t\tlet thisFolderExcludeSearchPathPattern: glob.IExpression | undefined;\n\t\tconst folderUri = URI.isUri(folder) ? folder : folder.uri;\n\t\tif (searchPathExcludes.searchPaths) {\n\t\t\tconst thisFolderExcludeSearchPath = searchPathExcludes.searchPaths.filter(sp => isEqual(sp.searchPath, folderUri))[0];\n\t\t\tif (thisFolderExcludeSearchPath && !thisFolderExcludeSearchPath.pattern) {\n\t\t\t\t// entire folder is excluded\n\t\t\t\treturn null;\n\t\t\t} else if (thisFolderExcludeSearchPath) {\n\t\t\t\tthisFolderExcludeSearchPathPattern = thisFolderExcludeSearchPath.pattern;\n\t\t\t}\n\t\t}\n\n\t\tconst folderConfig = this.configurationService.getValue<ISearchConfiguration>({ resource: folderUri });\n\t\tconst settingExcludes = this.getExcludesForFolder(folderConfig, options);\n\t\tconst excludePattern: glob.IExpression = {\n\t\t\t...(settingExcludes || {}),\n\t\t\t...(thisFolderExcludeSearchPathPattern || {})\n\t\t};\n\n\t\tconst folderName = URI.isUri(folder) ? basename(folder) : folder.name;\n\t\treturn <IFolderQuery>{\n\t\t\tfolder: folderUri,\n\t\t\tfolderName: includeFolderName ? folderName : undefined,\n\t\t\texcludePattern: Object.keys(excludePattern).length > 0 ? excludePattern : undefined,\n\t\t\tfileEncoding: folderConfig.files && folderConfig.files.encoding,\n\t\t\tdisregardIgnoreFiles: typeof options.disregardIgnoreFiles === 'boolean' ? options.disregardIgnoreFiles : !folderConfig.search.useIgnoreFiles,\n\t\t\tdisregardGlobalIgnoreFiles: typeof options.disregardGlobalIgnoreFiles === 'boolean' ? options.disregardGlobalIgnoreFiles : !folderConfig.search.useGlobalIgnoreFiles,\n\t\t\tdisregardParentIgnoreFiles: typeof options.disregardParentIgnoreFiles === 'boolean' ? options.disregardParentIgnoreFiles : !folderConfig.search.useParentIgnoreFiles,\n\t\t\tignoreSymlinks: typeof options.ignoreSymlinks === 'boolean' ? options.ignoreSymlinks : !folderConfig.search.followSymlinks,\n\t\t};\n\t}\n}\n\nfunction splitGlobFromPath(searchPath: string): { pathPortion: string; globPortion?: string } {\n\tconst globCharMatch = searchPath.match(/[\\*\\{\\}\\(\\)\\[\\]\\?]/);\n\tif (globCharMatch) {\n\t\tconst globCharIdx = globCharMatch.index;\n\t\tconst lastSlashMatch = searchPath.substr(0, globCharIdx).match(/[/|\\\\][^/\\\\]*$/);\n\t\tif (lastSlashMatch) {\n\t\t\tlet pathPortion = searchPath.substr(0, lastSlashMatch.index);\n\t\t\tif (!pathPortion.match(/[/\\\\]/)) {\n\t\t\t\t// If the last slash was the only slash, then we now have '' or 'C:' or '.'. Append a slash.\n\t\t\t\tpathPortion += '/';\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tpathPortion,\n\t\t\t\tglobPortion: searchPath.substr((lastSlashMatch.index || 0) + 1)\n\t\t\t};\n\t\t}\n\t}\n\n\t// No glob char, or malformed\n\treturn {\n\t\tpathPortion: searchPath\n\t};\n}\n\nfunction patternListToIExpression(...patterns: string[]): glob.IExpression {\n\treturn patterns.length ?\n\t\tpatterns.reduce((glob, cur) => { glob[cur] = true; return glob; }, Object.create(null)) :\n\t\tundefined;\n}\n\nfunction splitGlobPattern(pattern: string): string[] {\n\treturn glob.splitGlobAware(pattern, ',')\n\t\t.map(s => s.trim())\n\t\t.filter(s => !!s.length);\n}\n\n/**\n * Note - we used {} here previously but ripgrep can't handle nested {} patterns. See https://github.com/microsoft/vscode/issues/32761\n */\nfunction expandGlobalGlob(pattern: string): string[] {\n\tconst patterns = [\n\t\t`**/${pattern}/**`,\n\t\t`**/${pattern}`\n\t];\n\n\treturn patterns.map(p => p.replace(/\\*\\*\\/\\*\\*/g, '**'));\n}\n\nfunction normalizeSlashes(pattern: string): string {\n\treturn pattern.replace(/\\\\/g, '/');\n}\n\n/**\n * Normalize slashes, remove `./` and trailing slashes\n */\nfunction normalizeGlobPattern(pattern: string): string {\n\treturn normalizeSlashes(pattern)\n\t\t.replace(/^\\.\\//, '')\n\t\t.replace(/\\/+$/g, '');\n}\n\n/**\n * Construct an include pattern from a list of folders uris to search in.\n */\nexport function resolveResourcesForSearchIncludes(resources: URI[], contextService: IWorkspaceContextService): string[] {\n\tresources = arrays.distinct(resources, resource => resource.toString());\n\n\tconst folderPaths: string[] = [];\n\tconst workspace = contextService.getWorkspace();\n\n\tif (resources) {\n\t\tresources.forEach(resource => {\n\t\t\tlet folderPath: string | undefined;\n\t\t\tif (contextService.getWorkbenchState() === WorkbenchState.FOLDER) {\n\t\t\t\t// Show relative path from the root for single-root mode\n\t\t\t\tfolderPath = relativePath(workspace.folders[0].uri, resource); // always uses forward slashes\n\t\t\t\tif (folderPath && folderPath !== '.') {\n\t\t\t\t\tfolderPath = './' + folderPath;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst owningFolder = contextService.getWorkspaceFolder(resource);\n\t\t\t\tif (owningFolder) {\n\t\t\t\t\tconst owningRootName = owningFolder.name;\n\t\t\t\t\t// If this root is the only one with its basename, use a relative ./ path. If there is another, use an absolute path\n\t\t\t\t\tconst isUniqueFolder = workspace.folders.filter(folder => folder.name === owningRootName).length === 1;\n\t\t\t\t\tif (isUniqueFolder) {\n\t\t\t\t\t\tconst relPath = relativePath(owningFolder.uri, resource); // always uses forward slashes\n\t\t\t\t\t\tif (relPath === '') {\n\t\t\t\t\t\t\tfolderPath = `./${owningFolder.name}`;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfolderPath = `./${owningFolder.name}/${relPath}`;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfolderPath = resource.fsPath; // TODO rob: handle non-file URIs\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (folderPath) {\n\t\t\t\tfolderPaths.push(folderPath);\n\t\t\t}\n\t\t});\n\t}\n\treturn folderPaths;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as resources from 'vs/base/common/resources';\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { CancellationTokenSource, CancellationToken } from 'vs/base/common/cancellation';\nimport * as errors from 'vs/base/common/errors';\nimport { ExtensionIdentifier, IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { IInstantiationService, ServicesAccessor } from 'vs/platform/instantiation/common/instantiation';\nimport { QueryBuilder } from 'vs/workbench/services/search/common/queryBuilder';\nimport { ISearchService } from 'vs/workbench/services/search/common/search';\nimport { toWorkspaceFolder } from 'vs/platform/workspace/common/workspace';\nimport { ILogService } from 'vs/platform/log/common/log';\n\nconst WORKSPACE_CONTAINS_TIMEOUT = 7000;\n\nexport interface IExtensionActivationHost {\n\treadonly logService: ILogService;\n\treadonly folders: readonly UriComponents[];\n\treadonly forceUsingSearch: boolean;\n\n\texists(uri: URI): Promise<boolean>;\n\tcheckExists(folders: readonly UriComponents[], includes: string[], token: CancellationToken): Promise<boolean>;\n}\n\nexport interface IExtensionActivationResult {\n\tactivationEvent: string;\n}\n\nexport function checkActivateWorkspaceContainsExtension(host: IExtensionActivationHost, desc: IExtensionDescription): Promise<IExtensionActivationResult | undefined> {\n\tconst activationEvents = desc.activationEvents;\n\tif (!activationEvents) {\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\tconst fileNames: string[] = [];\n\tconst globPatterns: string[] = [];\n\n\tfor (const activationEvent of activationEvents) {\n\t\tif (/^workspaceContains:/.test(activationEvent)) {\n\t\t\tconst fileNameOrGlob = activationEvent.substr('workspaceContains:'.length);\n\t\t\tif (fileNameOrGlob.indexOf('*') >= 0 || fileNameOrGlob.indexOf('?') >= 0 || host.forceUsingSearch) {\n\t\t\t\tglobPatterns.push(fileNameOrGlob);\n\t\t\t} else {\n\t\t\t\tfileNames.push(fileNameOrGlob);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (fileNames.length === 0 && globPatterns.length === 0) {\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\tlet resolveResult: (value: IExtensionActivationResult | undefined) => void;\n\tconst result = new Promise<IExtensionActivationResult | undefined>((resolve, reject) => { resolveResult = resolve; });\n\tconst activate = (activationEvent: string) => resolveResult({ activationEvent });\n\n\tconst fileNamePromise = Promise.all(fileNames.map((fileName) => _activateIfFileName(host, fileName, activate))).then(() => { });\n\tconst globPatternPromise = _activateIfGlobPatterns(host, desc.identifier, globPatterns, activate);\n\n\tPromise.all([fileNamePromise, globPatternPromise]).then(() => {\n\t\t// when all are done, resolve with undefined (relevant only if it was not activated so far)\n\t\tresolveResult(undefined);\n\t});\n\n\treturn result;\n}\n\nasync function _activateIfFileName(host: IExtensionActivationHost, fileName: string, activate: (activationEvent: string) => void): Promise<void> {\n\t// find exact path\n\tfor (const uri of host.folders) {\n\t\tif (await host.exists(resources.joinPath(URI.revive(uri), fileName))) {\n\t\t\t// the file was found\n\t\t\tactivate(`workspaceContains:${fileName}`);\n\t\t\treturn;\n\t\t}\n\t}\n}\n\nasync function _activateIfGlobPatterns(host: IExtensionActivationHost, extensionId: ExtensionIdentifier, globPatterns: string[], activate: (activationEvent: string) => void): Promise<void> {\n\tif (globPatterns.length === 0) {\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\tconst tokenSource = new CancellationTokenSource();\n\tconst searchP = host.checkExists(host.folders, globPatterns, tokenSource.token);\n\n\tconst timer = setTimeout(async () => {\n\t\ttokenSource.cancel();\n\t\thost.logService.info(`Not activating extension '${extensionId.value}': Timed out while searching for 'workspaceContains' pattern ${globPatterns.join(',')}`);\n\t}, WORKSPACE_CONTAINS_TIMEOUT);\n\n\tlet exists: boolean = false;\n\ttry {\n\t\texists = await searchP;\n\t} catch (err) {\n\t\tif (!errors.isCancellationError(err)) {\n\t\t\terrors.onUnexpectedError(err);\n\t\t}\n\t}\n\n\ttokenSource.dispose();\n\tclearTimeout(timer);\n\n\tif (exists) {\n\t\t// a file was found matching one of the glob patterns\n\t\tactivate(`workspaceContains:${globPatterns.join(',')}`);\n\t}\n}\n\nexport function checkGlobFileExists(\n\taccessor: ServicesAccessor,\n\tfolders: readonly UriComponents[],\n\tincludes: string[],\n\ttoken: CancellationToken,\n): Promise<boolean> {\n\tconst instantiationService = accessor.get(IInstantiationService);\n\tconst searchService = accessor.get(ISearchService);\n\tconst queryBuilder = instantiationService.createInstance(QueryBuilder);\n\tconst query = queryBuilder.file(folders.map(folder => toWorkspaceFolder(URI.revive(folder))), {\n\t\t_reason: 'checkExists',\n\t\tincludePattern: includes,\n\t\texists: true\n\t});\n\n\treturn searchService.fileSearch(query, token).then(\n\t\tresult => {\n\t\t\treturn !!result.limitHit;\n\t\t},\n\t\terr => {\n\t\t\tif (!errors.isCancellationError(err)) {\n\t\t\t\treturn Promise.reject(err);\n\t\t\t}\n\n\t\t\treturn false;\n\t\t});\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from 'vs/nls';\nimport * as path from 'vs/base/common/path';\nimport * as performance from 'vs/base/common/performance';\nimport { originalFSPath, joinPath, extUriBiasedIgnorePathCase } from 'vs/base/common/resources';\nimport { asPromise, Barrier, timeout } from 'vs/base/common/async';\nimport { dispose, toDisposable, Disposable } from 'vs/base/common/lifecycle';\nimport { TernarySearchTree } from 'vs/base/common/map';\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { ExtHostExtensionServiceShape, MainContext, MainThreadExtensionServiceShape, MainThreadTelemetryShape, MainThreadWorkspaceShape } from 'vs/workbench/api/common/extHost.protocol';\nimport { IExtensionDescriptionDelta, IExtensionHostInitData } from 'vs/workbench/services/extensions/common/extensionHostProtocol';\nimport { ExtHostConfiguration, IExtHostConfiguration } from 'vs/workbench/api/common/extHostConfiguration';\nimport { ActivatedExtension, EmptyExtension, ExtensionActivationTimes, ExtensionActivationTimesBuilder, ExtensionsActivator, IExtensionAPI, IExtensionModule, HostExtension, ExtensionActivationTimesFragment } from 'vs/workbench/api/common/extHostExtensionActivator';\nimport { ExtHostStorage, IExtHostStorage } from 'vs/workbench/api/common/extHostStorage';\nimport { ExtHostWorkspace, IExtHostWorkspace } from 'vs/workbench/api/common/extHostWorkspace';\nimport { MissingExtensionDependency, ActivationKind, checkProposedApiEnabled, isProposedApiEnabled, ExtensionActivationReason, extensionIdentifiersArrayToSet } from 'vs/workbench/services/extensions/common/extensions';\nimport { ExtensionDescriptionRegistry } from 'vs/workbench/services/extensions/common/extensionDescriptionRegistry';\nimport * as errors from 'vs/base/common/errors';\nimport type * as vscode from 'vscode';\nimport { ExtensionIdentifier, IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { VSBuffer } from 'vs/base/common/buffer';\nimport { ExtensionGlobalMemento, ExtensionMemento } from 'vs/workbench/api/common/extHostMemento';\nimport { RemoteAuthorityResolverError, ExtensionKind, ExtensionMode, ExtensionRuntime } from 'vs/workbench/api/common/extHostTypes';\nimport { ResolvedAuthority, ResolvedOptions, RemoteAuthorityResolverErrorCode, IRemoteConnectionData } from 'vs/platform/remote/common/remoteAuthorityResolver';\nimport { IInstantiationService, createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { IExtHostInitDataService } from 'vs/workbench/api/common/extHostInitDataService';\nimport { IExtensionStoragePaths } from 'vs/workbench/api/common/extHostStoragePaths';\nimport { IExtHostRpcService } from 'vs/workbench/api/common/extHostRpcService';\nimport { ServiceCollection } from 'vs/platform/instantiation/common/serviceCollection';\nimport { IExtHostTunnelService } from 'vs/workbench/api/common/extHostTunnelService';\nimport { IExtHostTerminalService } from 'vs/workbench/api/common/extHostTerminalService';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { IExtensionActivationHost, checkActivateWorkspaceContainsExtension } from 'vs/workbench/services/extensions/common/workspaceContains';\nimport { ExtHostSecretState, IExtHostSecretState } from 'vs/workbench/api/common/exHostSecretState';\nimport { ExtensionSecrets } from 'vs/workbench/api/common/extHostSecrets';\nimport { Schemas } from 'vs/base/common/network';\nimport { IResolveAuthorityResult } from 'vs/workbench/services/extensions/common/extensionHostProxy';\n\ninterface ITestRunner {\n\t/** Old test runner API, as exported from `vscode/lib/testrunner` */\n\trun(testsRoot: string, clb: (error: Error, failures?: number) => void): void;\n}\n\ninterface INewTestRunner {\n\t/** New test runner API, as explained in the extension test doc */\n\trun(): Promise<void>;\n}\n\nexport const IHostUtils = createDecorator<IHostUtils>('IHostUtils');\n\nexport interface IHostUtils {\n\treadonly _serviceBrand: undefined;\n\treadonly pid: number | undefined;\n\texit(code: number): void;\n\texists(path: string): Promise<boolean>;\n\trealpath(path: string): Promise<string>;\n}\n\ntype TelemetryActivationEventFragment = {\n\tid: { classification: 'PublicNonPersonalData'; purpose: 'FeatureInsight'; comment: 'The identifier of an extension' };\n\tname: { classification: 'PublicNonPersonalData'; purpose: 'FeatureInsight'; comment: 'The name of the extension' };\n\textensionVersion: { classification: 'PublicNonPersonalData'; purpose: 'FeatureInsight'; comment: 'The version of the extension' };\n\tpublisherDisplayName: { classification: 'SystemMetaData'; purpose: 'FeatureInsight'; comment: 'The publisher of the extension' };\n\tactivationEvents: { classification: 'SystemMetaData'; purpose: 'FeatureInsight'; comment: 'All activation events of the extension' };\n\tisBuiltin: { classification: 'SystemMetaData'; purpose: 'FeatureInsight'; isMeasurement: true; comment: 'If the extension is builtin or git installed' };\n\treason: { classification: 'SystemMetaData'; purpose: 'FeatureInsight'; comment: 'The activation event' };\n\treasonId: { classification: 'PublicNonPersonalData'; purpose: 'FeatureInsight'; comment: 'The identifier of the activation event' };\n};\n\nexport abstract class AbstractExtHostExtensionService extends Disposable implements ExtHostExtensionServiceShape {\n\n\treadonly _serviceBrand: undefined;\n\n\tabstract readonly extensionRuntime: ExtensionRuntime;\n\n\tprivate readonly _onDidChangeRemoteConnectionData = this._register(new Emitter<void>());\n\tpublic readonly onDidChangeRemoteConnectionData = this._onDidChangeRemoteConnectionData.event;\n\n\tprotected readonly _hostUtils: IHostUtils;\n\tprotected readonly _initData: IExtensionHostInitData;\n\tprotected readonly _extHostContext: IExtHostRpcService;\n\tprotected readonly _instaService: IInstantiationService;\n\tprotected readonly _extHostWorkspace: ExtHostWorkspace;\n\tprotected readonly _extHostConfiguration: ExtHostConfiguration;\n\tprotected readonly _logService: ILogService;\n\tprotected readonly _extHostTunnelService: IExtHostTunnelService;\n\tprotected readonly _extHostTerminalService: IExtHostTerminalService;\n\n\tprotected readonly _mainThreadWorkspaceProxy: MainThreadWorkspaceShape;\n\tprotected readonly _mainThreadTelemetryProxy: MainThreadTelemetryShape;\n\tprotected readonly _mainThreadExtensionsProxy: MainThreadExtensionServiceShape;\n\n\tprivate readonly _almostReadyToRunExtensions: Barrier;\n\tprivate readonly _readyToStartExtensionHost: Barrier;\n\tprivate readonly _readyToRunExtensions: Barrier;\n\tprivate readonly _eagerExtensionsActivated: Barrier;\n\n\tprotected readonly _myRegistry: ExtensionDescriptionRegistry;\n\tprotected readonly _globalRegistry: ExtensionDescriptionRegistry;\n\tprivate readonly _storage: ExtHostStorage;\n\tprivate readonly _secretState: ExtHostSecretState;\n\tprivate readonly _storagePath: IExtensionStoragePaths;\n\tprivate readonly _activator: ExtensionsActivator;\n\tprivate _extensionPathIndex: Promise<ExtensionPaths> | null;\n\n\tprivate readonly _resolvers: { [authorityPrefix: string]: vscode.RemoteAuthorityResolver };\n\n\tprivate _started: boolean;\n\tprivate _isTerminating: boolean = false;\n\tprivate _remoteConnectionData: IRemoteConnectionData | null;\n\n\tconstructor(\n\t\t@IInstantiationService instaService: IInstantiationService,\n\t\t@IHostUtils hostUtils: IHostUtils,\n\t\t@IExtHostRpcService extHostContext: IExtHostRpcService,\n\t\t@IExtHostWorkspace extHostWorkspace: IExtHostWorkspace,\n\t\t@IExtHostConfiguration extHostConfiguration: IExtHostConfiguration,\n\t\t@ILogService logService: ILogService,\n\t\t@IExtHostInitDataService initData: IExtHostInitDataService,\n\t\t@IExtensionStoragePaths storagePath: IExtensionStoragePaths,\n\t\t@IExtHostTunnelService extHostTunnelService: IExtHostTunnelService,\n\t\t@IExtHostTerminalService extHostTerminalService: IExtHostTerminalService,\n\t) {\n\t\tsuper();\n\t\tthis._hostUtils = hostUtils;\n\t\tthis._extHostContext = extHostContext;\n\t\tthis._initData = initData;\n\n\t\tthis._extHostWorkspace = extHostWorkspace;\n\t\tthis._extHostConfiguration = extHostConfiguration;\n\t\tthis._logService = logService;\n\t\tthis._extHostTunnelService = extHostTunnelService;\n\t\tthis._extHostTerminalService = extHostTerminalService;\n\n\t\tthis._mainThreadWorkspaceProxy = this._extHostContext.getProxy(MainContext.MainThreadWorkspace);\n\t\tthis._mainThreadTelemetryProxy = this._extHostContext.getProxy(MainContext.MainThreadTelemetry);\n\t\tthis._mainThreadExtensionsProxy = this._extHostContext.getProxy(MainContext.MainThreadExtensionService);\n\n\t\tthis._almostReadyToRunExtensions = new Barrier();\n\t\tthis._readyToStartExtensionHost = new Barrier();\n\t\tthis._readyToRunExtensions = new Barrier();\n\t\tthis._eagerExtensionsActivated = new Barrier();\n\t\tthis._globalRegistry = new ExtensionDescriptionRegistry(this._initData.allExtensions);\n\t\tconst myExtensionsSet = extensionIdentifiersArrayToSet(this._initData.myExtensions);\n\t\tthis._myRegistry = new ExtensionDescriptionRegistry(\n\t\t\tfilterExtensions(this._globalRegistry, myExtensionsSet)\n\t\t);\n\t\tthis._storage = new ExtHostStorage(this._extHostContext);\n\t\tthis._secretState = new ExtHostSecretState(this._extHostContext);\n\t\tthis._storagePath = storagePath;\n\n\t\tthis._instaService = instaService.createChild(new ServiceCollection(\n\t\t\t[IExtHostStorage, this._storage],\n\t\t\t[IExtHostSecretState, this._secretState]\n\t\t));\n\n\t\tlet resolvedExtensions: ExtensionIdentifier[] = [];\n\t\tlet hostExtensions: ExtensionIdentifier[] = [];\n\t\tif (this._initData.remote.isRemote) {\n\t\t\tresolvedExtensions = this._initData.allExtensions.filter(extension => !extension.main && !extension.browser).map(extension => extension.identifier);\n\t\t\thostExtensions = (\n\t\t\t\tthis._initData.allExtensions\n\t\t\t\t\t.filter(extension => !myExtensionsSet.has(ExtensionIdentifier.toKey(extension.identifier.value)))\n\t\t\t\t\t.filter(extension => (extension.main || extension.browser) && extension.api === 'none').map(extension => extension.identifier)\n\t\t\t);\n\t\t}\n\t\tconst hostExtensionsSet = extensionIdentifiersArrayToSet(hostExtensions);\n\n\t\tthis._activator = this._register(new ExtensionsActivator(\n\t\t\tthis._myRegistry,\n\t\t\tresolvedExtensions,\n\t\t\thostExtensions,\n\t\t\t{\n\t\t\t\tonExtensionActivationError: (extensionId: ExtensionIdentifier, error: Error, missingExtensionDependency: MissingExtensionDependency | null): void => {\n\t\t\t\t\tthis._mainThreadExtensionsProxy.$onExtensionActivationError(extensionId, errors.transformErrorForSerialization(error), missingExtensionDependency);\n\t\t\t\t},\n\n\t\t\t\tactualActivateExtension: async (extensionId: ExtensionIdentifier, reason: ExtensionActivationReason): Promise<ActivatedExtension> => {\n\t\t\t\t\tif (hostExtensionsSet.has(ExtensionIdentifier.toKey(extensionId))) {\n\t\t\t\t\t\tawait this._mainThreadExtensionsProxy.$activateExtension(extensionId, reason);\n\t\t\t\t\t\treturn new HostExtension();\n\t\t\t\t\t}\n\t\t\t\t\tconst extensionDescription = this._myRegistry.getExtensionDescription(extensionId)!;\n\t\t\t\t\treturn this._activateExtension(extensionDescription, reason);\n\t\t\t\t}\n\t\t\t},\n\t\t\tthis._logService\n\t\t));\n\t\tthis._extensionPathIndex = null;\n\t\tthis._resolvers = Object.create(null);\n\t\tthis._started = false;\n\t\tthis._remoteConnectionData = this._initData.remote.connectionData;\n\t}\n\n\tpublic getRemoteConnectionData(): IRemoteConnectionData | null {\n\t\treturn this._remoteConnectionData;\n\t}\n\n\tpublic async initialize(): Promise<void> {\n\t\ttry {\n\n\t\t\tawait this._beforeAlmostReadyToRunExtensions();\n\t\t\tthis._almostReadyToRunExtensions.open();\n\n\t\t\tawait this._extHostWorkspace.waitForInitializeCall();\n\t\t\tperformance.mark('code/extHost/ready');\n\t\t\tthis._readyToStartExtensionHost.open();\n\n\t\t\tif (this._initData.autoStart) {\n\t\t\t\tthis._startExtensionHost();\n\t\t\t}\n\t\t} catch (err) {\n\t\t\terrors.onUnexpectedError(err);\n\t\t}\n\t}\n\n\tprivate async _deactivateAll(): Promise<void> {\n\t\tthis._storagePath.onWillDeactivateAll();\n\n\t\tlet allPromises: Promise<void>[] = [];\n\t\ttry {\n\t\t\tconst allExtensions = this._myRegistry.getAllExtensionDescriptions();\n\t\t\tconst allExtensionsIds = allExtensions.map(ext => ext.identifier);\n\t\t\tconst activatedExtensions = allExtensionsIds.filter(id => this.isActivated(id));\n\n\t\t\tallPromises = activatedExtensions.map((extensionId) => {\n\t\t\t\treturn this._deactivate(extensionId);\n\t\t\t});\n\t\t} catch (err) {\n\t\t\t// TODO: write to log once we have one\n\t\t}\n\t\tawait Promise.all(allPromises);\n\t}\n\n\tpublic terminate(reason: string, code: number = 0): void {\n\t\tif (this._isTerminating) {\n\t\t\t// we are already shutting down...\n\t\t\treturn;\n\t\t}\n\t\tthis._isTerminating = true;\n\t\tthis._logService.info(`Extension host terminating: ${reason}`);\n\t\tthis._logService.flush();\n\n\t\tthis._extHostTerminalService.dispose();\n\t\tthis._activator.dispose();\n\n\t\terrors.setUnexpectedErrorHandler((err) => {\n\t\t\tthis._logService.error(err);\n\t\t});\n\n\t\t// Invalidate all proxies\n\t\tthis._extHostContext.dispose();\n\n\t\tconst extensionsDeactivated = this._deactivateAll();\n\n\t\t// Give extensions at most 5 seconds to wrap up any async deactivate, then exit\n\t\tPromise.race([timeout(5000), extensionsDeactivated]).finally(() => {\n\t\t\tif (this._hostUtils.pid) {\n\t\t\t\tthis._logService.info(`Extension host with pid ${this._hostUtils.pid} exiting with code ${code}`);\n\t\t\t} else {\n\t\t\t\tthis._logService.info(`Extension host exiting with code ${code}`);\n\t\t\t}\n\t\t\tthis._logService.flush();\n\t\t\tthis._logService.dispose();\n\t\t\tthis._hostUtils.exit(code);\n\t\t});\n\t}\n\n\tpublic isActivated(extensionId: ExtensionIdentifier): boolean {\n\t\tif (this._readyToRunExtensions.isOpen()) {\n\t\t\treturn this._activator.isActivated(extensionId);\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic async getExtension(extensionId: string): Promise<IExtensionDescription | undefined> {\n\t\tconst ext = await this._mainThreadExtensionsProxy.$getExtension(extensionId);\n\t\treturn ext && {\n\t\t\t...ext,\n\t\t\tidentifier: new ExtensionIdentifier(ext.identifier.value),\n\t\t\textensionLocation: URI.revive(ext.extensionLocation),\n\t\t};\n\t}\n\n\tprivate _activateByEvent(activationEvent: string, startup: boolean): Promise<void> {\n\t\treturn this._activator.activateByEvent(activationEvent, startup);\n\t}\n\n\tprivate _activateById(extensionId: ExtensionIdentifier, reason: ExtensionActivationReason): Promise<void> {\n\t\treturn this._activator.activateById(extensionId, reason);\n\t}\n\n\tpublic activateByIdWithErrors(extensionId: ExtensionIdentifier, reason: ExtensionActivationReason): Promise<void> {\n\t\treturn this._activateById(extensionId, reason).then(() => {\n\t\t\tconst extension = this._activator.getActivatedExtension(extensionId);\n\t\t\tif (extension.activationFailed) {\n\t\t\t\t// activation failed => bubble up the error as the promise result\n\t\t\t\treturn Promise.reject(extension.activationFailedError);\n\t\t\t}\n\t\t\treturn undefined;\n\t\t});\n\t}\n\n\tpublic getExtensionRegistry(): Promise<ExtensionDescriptionRegistry> {\n\t\treturn this._readyToRunExtensions.wait().then(_ => this._myRegistry);\n\t}\n\n\tpublic getExtensionExports(extensionId: ExtensionIdentifier): IExtensionAPI | null | undefined {\n\t\tif (this._readyToRunExtensions.isOpen()) {\n\t\t\treturn this._activator.getActivatedExtension(extensionId).exports;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\t/**\n\t * Applies realpath to file-uris and returns all others uris unmodified\n\t */\n\tprivate async _realPathExtensionUri(uri: URI): Promise<URI> {\n\t\tif (uri.scheme !== Schemas.file) {\n\t\t\treturn uri;\n\t\t}\n\t\tconst realpathValue = await this._hostUtils.realpath(uri.fsPath);\n\t\treturn URI.file(realpathValue);\n\t}\n\n\t// create trie to enable fast 'filename -> extension id' look up\n\tpublic async getExtensionPathIndex(): Promise<ExtensionPaths> {\n\t\tif (!this._extensionPathIndex) {\n\t\t\tthis._extensionPathIndex = this._createExtensionPathIndex(this._myRegistry.getAllExtensionDescriptions()).then((searchTree) => {\n\t\t\t\treturn new ExtensionPaths(searchTree);\n\t\t\t});\n\t\t}\n\t\treturn this._extensionPathIndex;\n\t}\n\n\t/**\n\t * create trie to enable fast 'filename -> extension id' look up\n\t */\n\tprivate async _createExtensionPathIndex(extensions: IExtensionDescription[]): Promise<TernarySearchTree<URI, IExtensionDescription>> {\n\t\tconst tst = TernarySearchTree.forUris<IExtensionDescription>(key => {\n\t\t\t// using the default/biased extUri-util because the IExtHostFileSystemInfo-service\n\t\t\t// isn't ready to be used yet, e.g the knowledge about `file` protocol and others\n\t\t\t// comes in while this code runs\n\t\t\treturn extUriBiasedIgnorePathCase.ignorePathCasing(key);\n\t\t});\n\t\t// const tst = TernarySearchTree.forUris<IExtensionDescription>(key => true);\n\t\tawait Promise.all(extensions.map(async (ext) => {\n\t\t\tif (this._getEntryPoint(ext)) {\n\t\t\t\tconst uri = await this._realPathExtensionUri(ext.extensionLocation);\n\t\t\t\ttst.set(uri, ext);\n\t\t\t}\n\t\t}));\n\t\treturn tst;\n\t}\n\n\tprivate _deactivate(extensionId: ExtensionIdentifier): Promise<void> {\n\t\tlet result = Promise.resolve(undefined);\n\n\t\tif (!this._readyToRunExtensions.isOpen()) {\n\t\t\treturn result;\n\t\t}\n\n\t\tif (!this._activator.isActivated(extensionId)) {\n\t\t\treturn result;\n\t\t}\n\n\t\tconst extension = this._activator.getActivatedExtension(extensionId);\n\t\tif (!extension) {\n\t\t\treturn result;\n\t\t}\n\n\t\t// call deactivate if available\n\t\ttry {\n\t\t\tif (typeof extension.module.deactivate === 'function') {\n\t\t\t\tresult = Promise.resolve(extension.module.deactivate()).then(undefined, (err) => {\n\t\t\t\t\tthis._logService.error(err);\n\t\t\t\t\treturn Promise.resolve(undefined);\n\t\t\t\t});\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tthis._logService.error(`An error occurred when deactivating the extension '${extensionId.value}':`);\n\t\t\tthis._logService.error(err);\n\t\t}\n\n\t\t// clean up subscriptions\n\t\ttry {\n\t\t\tdispose(extension.subscriptions);\n\t\t} catch (err) {\n\t\t\tthis._logService.error(`An error occurred when deactivating the subscriptions for extension '${extensionId.value}':`);\n\t\t\tthis._logService.error(err);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t// --- impl\n\n\tprivate async _activateExtension(extensionDescription: IExtensionDescription, reason: ExtensionActivationReason): Promise<ActivatedExtension> {\n\t\tif (!this._initData.remote.isRemote) {\n\t\t\t// local extension host process\n\t\t\tawait this._mainThreadExtensionsProxy.$onWillActivateExtension(extensionDescription.identifier);\n\t\t} else {\n\t\t\t// remote extension host process\n\t\t\t// do not wait for renderer confirmation\n\t\t\tthis._mainThreadExtensionsProxy.$onWillActivateExtension(extensionDescription.identifier);\n\t\t}\n\t\treturn this._doActivateExtension(extensionDescription, reason).then((activatedExtension) => {\n\t\t\tconst activationTimes = activatedExtension.activationTimes;\n\t\t\tthis._mainThreadExtensionsProxy.$onDidActivateExtension(extensionDescription.identifier, activationTimes.codeLoadingTime, activationTimes.activateCallTime, activationTimes.activateResolvedTime, reason);\n\t\t\tthis._logExtensionActivationTimes(extensionDescription, reason, 'success', activationTimes);\n\t\t\treturn activatedExtension;\n\t\t}, (err) => {\n\t\t\tthis._logExtensionActivationTimes(extensionDescription, reason, 'failure');\n\t\t\tthrow err;\n\t\t});\n\t}\n\n\tprivate _logExtensionActivationTimes(extensionDescription: IExtensionDescription, reason: ExtensionActivationReason, outcome: string, activationTimes?: ExtensionActivationTimes) {\n\t\tconst event = getTelemetryActivationEvent(extensionDescription, reason);\n\t\ttype ExtensionActivationTimesClassification = {\n\t\t\towner: 'jrieken';\n\t\t\tcomment: 'Timestamps for extension activation';\n\t\t\toutcome: { classification: 'SystemMetaData'; purpose: 'FeatureInsight'; comment: 'Did extension activation succeed or fail' };\n\t\t} & TelemetryActivationEventFragment & ExtensionActivationTimesFragment;\n\n\t\ttype ExtensionActivationTimesEvent = {\n\t\t\toutcome: string;\n\t\t} & ActivationTimesEvent & TelemetryActivationEvent;\n\n\t\ttype ActivationTimesEvent = {\n\t\t\tstartup?: boolean;\n\t\t\tcodeLoadingTime?: number;\n\t\t\tactivateCallTime?: number;\n\t\t\tactivateResolvedTime?: number;\n\t\t};\n\n\t\tthis._mainThreadTelemetryProxy.$publicLog2<ExtensionActivationTimesEvent, ExtensionActivationTimesClassification>('extensionActivationTimes', {\n\t\t\t...event,\n\t\t\t...(activationTimes || {}),\n\t\t\toutcome\n\t\t});\n\t}\n\n\tprivate _doActivateExtension(extensionDescription: IExtensionDescription, reason: ExtensionActivationReason): Promise<ActivatedExtension> {\n\t\tconst event = getTelemetryActivationEvent(extensionDescription, reason);\n\t\ttype ActivatePluginClassification = {\n\t\t\towner: 'jrieken';\n\t\t\tcomment: 'Data about how/why an extension was activated';\n\t\t} & TelemetryActivationEventFragment;\n\t\tthis._mainThreadTelemetryProxy.$publicLog2<TelemetryActivationEvent, ActivatePluginClassification>('activatePlugin', event);\n\t\tconst entryPoint = this._getEntryPoint(extensionDescription);\n\t\tif (!entryPoint) {\n\t\t\t// Treat the extension as being empty => NOT AN ERROR CASE\n\t\t\treturn Promise.resolve(new EmptyExtension(ExtensionActivationTimes.NONE));\n\t\t}\n\n\t\tthis._logService.info(`ExtensionService#_doActivateExtension ${extensionDescription.identifier.value}, startup: ${reason.startup}, activationEvent: '${reason.activationEvent}'${extensionDescription.identifier.value !== reason.extensionId.value ? `, root cause: ${reason.extensionId.value}` : ``}`);\n\t\tthis._logService.flush();\n\n\t\tconst activationTimesBuilder = new ExtensionActivationTimesBuilder(reason.startup);\n\t\treturn Promise.all([\n\t\t\tthis._loadCommonJSModule<IExtensionModule>(extensionDescription.identifier, joinPath(extensionDescription.extensionLocation, entryPoint), activationTimesBuilder),\n\t\t\tthis._loadExtensionContext(extensionDescription)\n\t\t]).then(values => {\n\t\t\tperformance.mark(`code/extHost/willActivateExtension/${extensionDescription.identifier.value}`);\n\t\t\treturn AbstractExtHostExtensionService._callActivate(this._logService, extensionDescription.identifier, values[0], values[1], activationTimesBuilder);\n\t\t}).then((activatedExtension) => {\n\t\t\tperformance.mark(`code/extHost/didActivateExtension/${extensionDescription.identifier.value}`);\n\t\t\treturn activatedExtension;\n\t\t});\n\t}\n\n\tprivate _loadExtensionContext(extensionDescription: IExtensionDescription): Promise<vscode.ExtensionContext> {\n\n\t\tconst globalState = new ExtensionGlobalMemento(extensionDescription, this._storage);\n\t\tconst workspaceState = new ExtensionMemento(extensionDescription.identifier.value, false, this._storage);\n\t\tconst secrets = new ExtensionSecrets(extensionDescription, this._secretState);\n\t\tconst extensionMode = extensionDescription.isUnderDevelopment\n\t\t\t? (this._initData.environment.extensionTestsLocationURI ? ExtensionMode.Test : ExtensionMode.Development)\n\t\t\t: ExtensionMode.Production;\n\t\tconst extensionKind = this._initData.remote.isRemote ? ExtensionKind.Workspace : ExtensionKind.UI;\n\n\t\tthis._logService.trace(`ExtensionService#loadExtensionContext ${extensionDescription.identifier.value}`);\n\n\t\treturn Promise.all([\n\t\t\tglobalState.whenReady,\n\t\t\tworkspaceState.whenReady,\n\t\t\tthis._storagePath.whenReady\n\t\t]).then(() => {\n\t\t\tconst that = this;\n\t\t\tlet extension: vscode.Extension<any> | undefined;\n\n\t\t\tlet messagePassingProtocol: vscode.MessagePassingProtocol | undefined;\n\t\t\tconst messagePort = isProposedApiEnabled(extensionDescription, 'ipc')\n\t\t\t\t? this._initData.messagePorts?.get(ExtensionIdentifier.toKey(extensionDescription.identifier))\n\t\t\t\t: undefined;\n\n\t\t\treturn Object.freeze<vscode.ExtensionContext>({\n\t\t\t\tglobalState,\n\t\t\t\tworkspaceState,\n\t\t\t\tsecrets,\n\t\t\t\tsubscriptions: [],\n\t\t\t\tget extensionUri() { return extensionDescription.extensionLocation; },\n\t\t\t\tget extensionPath() { return extensionDescription.extensionLocation.fsPath; },\n\t\t\t\tasAbsolutePath(relativePath: string) { return path.join(extensionDescription.extensionLocation.fsPath, relativePath); },\n\t\t\t\tget storagePath() { return that._storagePath.workspaceValue(extensionDescription)?.fsPath; },\n\t\t\t\tget globalStoragePath() { return that._storagePath.globalValue(extensionDescription).fsPath; },\n\t\t\t\tget logPath() { return path.join(that._initData.logsLocation.fsPath, extensionDescription.identifier.value); },\n\t\t\t\tget logUri() { return URI.joinPath(that._initData.logsLocation, extensionDescription.identifier.value); },\n\t\t\t\tget storageUri() { return that._storagePath.workspaceValue(extensionDescription); },\n\t\t\t\tget globalStorageUri() { return that._storagePath.globalValue(extensionDescription); },\n\t\t\t\tget extensionMode() { return extensionMode; },\n\t\t\t\tget extension() {\n\t\t\t\t\tif (extension === undefined) {\n\t\t\t\t\t\textension = new Extension(that, extensionDescription.identifier, extensionDescription, extensionKind, false);\n\t\t\t\t\t}\n\t\t\t\t\treturn extension;\n\t\t\t\t},\n\t\t\t\tget extensionRuntime() {\n\t\t\t\t\tcheckProposedApiEnabled(extensionDescription, 'extensionRuntime');\n\t\t\t\t\treturn that.extensionRuntime;\n\t\t\t\t},\n\t\t\t\tget environmentVariableCollection() { return that._extHostTerminalService.getEnvironmentVariableCollection(extensionDescription); },\n\t\t\t\tget messagePassingProtocol() {\n\t\t\t\t\tif (!messagePassingProtocol) {\n\t\t\t\t\t\tif (!messagePort) {\n\t\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst onDidReceiveMessage = Event.buffer(Event.fromDOMEventEmitter(messagePort, 'message', e => e.data));\n\t\t\t\t\t\tmessagePort.start();\n\t\t\t\t\t\tmessagePassingProtocol = {\n\t\t\t\t\t\t\tonDidReceiveMessage,\n\t\t\t\t\t\t\tpostMessage: messagePort.postMessage.bind(messagePort) as any\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t\treturn messagePassingProtocol;\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tprivate static _callActivate(logService: ILogService, extensionId: ExtensionIdentifier, extensionModule: IExtensionModule, context: vscode.ExtensionContext, activationTimesBuilder: ExtensionActivationTimesBuilder): Promise<ActivatedExtension> {\n\t\t// Make sure the extension's surface is not undefined\n\t\textensionModule = extensionModule || {\n\t\t\tactivate: undefined,\n\t\t\tdeactivate: undefined\n\t\t};\n\n\t\treturn this._callActivateOptional(logService, extensionId, extensionModule, context, activationTimesBuilder).then((extensionExports) => {\n\t\t\treturn new ActivatedExtension(false, null, activationTimesBuilder.build(), extensionModule, extensionExports, context.subscriptions);\n\t\t});\n\t}\n\n\tprivate static _callActivateOptional(logService: ILogService, extensionId: ExtensionIdentifier, extensionModule: IExtensionModule, context: vscode.ExtensionContext, activationTimesBuilder: ExtensionActivationTimesBuilder): Promise<IExtensionAPI> {\n\t\tif (typeof extensionModule.activate === 'function') {\n\t\t\ttry {\n\t\t\t\tactivationTimesBuilder.activateCallStart();\n\t\t\t\tlogService.trace(`ExtensionService#_callActivateOptional ${extensionId.value}`);\n\t\t\t\tconst scope = typeof global === 'object' ? global : self; // `global` is nodejs while `self` is for workers\n\t\t\t\tconst activateResult: Promise<IExtensionAPI> = extensionModule.activate.apply(scope, [context]);\n\t\t\t\tactivationTimesBuilder.activateCallStop();\n\n\t\t\t\tactivationTimesBuilder.activateResolveStart();\n\t\t\t\treturn Promise.resolve(activateResult).then((value) => {\n\t\t\t\t\tactivationTimesBuilder.activateResolveStop();\n\t\t\t\t\treturn value;\n\t\t\t\t});\n\t\t\t} catch (err) {\n\t\t\t\treturn Promise.reject(err);\n\t\t\t}\n\t\t} else {\n\t\t\t// No activate found => the module is the extension's exports\n\t\t\treturn Promise.resolve<IExtensionAPI>(extensionModule);\n\t\t}\n\t}\n\n\t// -- eager activation\n\n\tprivate _activateOneStartupFinished(desc: IExtensionDescription, activationEvent: string): void {\n\t\tthis._activateById(desc.identifier, {\n\t\t\tstartup: false,\n\t\t\textensionId: desc.identifier,\n\t\t\tactivationEvent: activationEvent\n\t\t}).then(undefined, (err) => {\n\t\t\tthis._logService.error(err);\n\t\t});\n\t}\n\n\tprivate _activateAllStartupFinished(): void {\n\t\t// startup is considered finished\n\t\tthis._mainThreadExtensionsProxy.$setPerformanceMarks(performance.getMarks());\n\n\t\tfor (const desc of this._myRegistry.getAllExtensionDescriptions()) {\n\t\t\tif (desc.activationEvents) {\n\t\t\t\tfor (const activationEvent of desc.activationEvents) {\n\t\t\t\t\tif (activationEvent === 'onStartupFinished') {\n\t\t\t\t\t\tthis._activateOneStartupFinished(desc, activationEvent);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Handle \"eager\" activation extensions\n\tprivate _handleEagerExtensions(): Promise<void> {\n\t\tconst starActivation = this._activateByEvent('*', true).then(undefined, (err) => {\n\t\t\tthis._logService.error(err);\n\t\t});\n\n\t\tthis._register(this._extHostWorkspace.onDidChangeWorkspace((e) => this._handleWorkspaceContainsEagerExtensions(e.added)));\n\t\tconst folders = this._extHostWorkspace.workspace ? this._extHostWorkspace.workspace.folders : [];\n\t\tconst workspaceContainsActivation = this._handleWorkspaceContainsEagerExtensions(folders);\n\t\tconst eagerExtensionsActivation = Promise.all([starActivation, workspaceContainsActivation]).then(() => { });\n\n\t\tPromise.race([eagerExtensionsActivation, timeout(10000)]).then(() => {\n\t\t\tthis._activateAllStartupFinished();\n\t\t});\n\n\t\treturn eagerExtensionsActivation;\n\t}\n\n\tprivate _handleWorkspaceContainsEagerExtensions(folders: ReadonlyArray<vscode.WorkspaceFolder>): Promise<void> {\n\t\tif (folders.length === 0) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\treturn Promise.all(\n\t\t\tthis._myRegistry.getAllExtensionDescriptions().map((desc) => {\n\t\t\t\treturn this._handleWorkspaceContainsEagerExtension(folders, desc);\n\t\t\t})\n\t\t).then(() => { });\n\t}\n\n\tprivate async _handleWorkspaceContainsEagerExtension(folders: ReadonlyArray<vscode.WorkspaceFolder>, desc: IExtensionDescription): Promise<void> {\n\t\tif (this.isActivated(desc.identifier)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst localWithRemote = !this._initData.remote.isRemote && !!this._initData.remote.authority;\n\t\tconst host: IExtensionActivationHost = {\n\t\t\tlogService: this._logService,\n\t\t\tfolders: folders.map(folder => folder.uri),\n\t\t\tforceUsingSearch: localWithRemote,\n\t\t\texists: (uri) => this._hostUtils.exists(uri.fsPath),\n\t\t\tcheckExists: (folders, includes, token) => this._mainThreadWorkspaceProxy.$checkExists(folders, includes, token)\n\t\t};\n\n\t\tconst result = await checkActivateWorkspaceContainsExtension(host, desc);\n\t\tif (!result) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn (\n\t\t\tthis._activateById(desc.identifier, { startup: true, extensionId: desc.identifier, activationEvent: result.activationEvent })\n\t\t\t\t.then(undefined, err => this._logService.error(err))\n\t\t);\n\t}\n\n\tpublic async $extensionTestsExecute(): Promise<number> {\n\t\tawait this._eagerExtensionsActivated.wait();\n\t\ttry {\n\t\t\treturn await this._doHandleExtensionTests();\n\t\t} catch (error) {\n\t\t\tconsole.error(error); // ensure any error message makes it onto the console\n\t\t\tthrow error;\n\t\t}\n\t}\n\n\tprivate async _doHandleExtensionTests(): Promise<number> {\n\t\tconst { extensionDevelopmentLocationURI, extensionTestsLocationURI } = this._initData.environment;\n\t\tif (!extensionDevelopmentLocationURI || !extensionTestsLocationURI) {\n\t\t\tthrow new Error(nls.localize('extensionTestError1', \"Cannot load test runner.\"));\n\t\t}\n\n\t\t// Require the test runner via node require from the provided path\n\t\tconst testRunner = await this._loadCommonJSModule<ITestRunner | INewTestRunner | undefined>(null, extensionTestsLocationURI, new ExtensionActivationTimesBuilder(false));\n\n\t\tif (!testRunner || typeof testRunner.run !== 'function') {\n\t\t\tthrow new Error(nls.localize('extensionTestError', \"Path {0} does not point to a valid extension test runner.\", extensionTestsLocationURI.toString()));\n\t\t}\n\n\t\t// Execute the runner if it follows the old `run` spec\n\t\treturn new Promise<number>((resolve, reject) => {\n\t\t\tconst oldTestRunnerCallback = (error: Error, failures: number | undefined) => {\n\t\t\t\tif (error) {\n\t\t\t\t\treject(error);\n\t\t\t\t} else {\n\t\t\t\t\tresolve((typeof failures === 'number' && failures > 0) ? 1 /* ERROR */ : 0 /* OK */);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tconst extensionTestsPath = originalFSPath(extensionTestsLocationURI); // for the old test runner API\n\n\t\t\tconst runResult = testRunner.run(extensionTestsPath, oldTestRunnerCallback);\n\n\t\t\t// Using the new API `run(): Promise<void>`\n\t\t\tif (runResult && runResult.then) {\n\t\t\t\trunResult\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tresolve(0);\n\t\t\t\t\t})\n\t\t\t\t\t.catch((err: unknown) => {\n\t\t\t\t\t\treject(err instanceof Error && err.stack ? err.stack : String(err));\n\t\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate _startExtensionHost(): Promise<void> {\n\t\tif (this._started) {\n\t\t\tthrow new Error(`Extension host is already started!`);\n\t\t}\n\t\tthis._started = true;\n\n\t\treturn this._readyToStartExtensionHost.wait()\n\t\t\t.then(() => this._readyToRunExtensions.open())\n\t\t\t.then(() => this._handleEagerExtensions())\n\t\t\t.then(() => {\n\t\t\t\tthis._eagerExtensionsActivated.open();\n\t\t\t\tthis._logService.info(`Eager extensions activated`);\n\t\t\t});\n\t}\n\n\t// -- called by extensions\n\n\tpublic registerRemoteAuthorityResolver(authorityPrefix: string, resolver: vscode.RemoteAuthorityResolver): vscode.Disposable {\n\t\tthis._resolvers[authorityPrefix] = resolver;\n\t\treturn toDisposable(() => {\n\t\t\tdelete this._resolvers[authorityPrefix];\n\t\t});\n\t}\n\n\t// -- called by main thread\n\n\tprivate async _activateAndGetResolver(remoteAuthority: string): Promise<{ authorityPrefix: string; resolver: vscode.RemoteAuthorityResolver | undefined }> {\n\t\tconst authorityPlusIndex = remoteAuthority.indexOf('+');\n\t\tif (authorityPlusIndex === -1) {\n\t\t\tthrow new Error(`Not an authority that can be resolved!`);\n\t\t}\n\t\tconst authorityPrefix = remoteAuthority.substr(0, authorityPlusIndex);\n\n\t\tawait this._almostReadyToRunExtensions.wait();\n\t\tawait this._activateByEvent(`onResolveRemoteAuthority:${authorityPrefix}`, false);\n\n\t\treturn { authorityPrefix, resolver: this._resolvers[authorityPrefix] };\n\t}\n\n\tpublic async $resolveAuthority(remoteAuthority: string, resolveAttempt: number): Promise<IResolveAuthorityResult> {\n\t\tthis._logService.info(`$resolveAuthority invoked for authority (${getRemoteAuthorityPrefix(remoteAuthority)})`);\n\n\t\tconst { authorityPrefix, resolver } = await this._activateAndGetResolver(remoteAuthority);\n\t\tif (!resolver) {\n\t\t\treturn {\n\t\t\t\ttype: 'error',\n\t\t\t\terror: {\n\t\t\t\t\tcode: RemoteAuthorityResolverErrorCode.NoResolverFound,\n\t\t\t\t\tmessage: `No remote extension installed to resolve ${authorityPrefix}.`,\n\t\t\t\t\tdetail: undefined\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\ttry {\n\t\t\tthis._register(await this._extHostTunnelService.setTunnelFactory(resolver));\n\t\t\tperformance.mark(`code/extHost/willResolveAuthority/${authorityPrefix}`);\n\t\t\tconst result = await resolver.resolve(remoteAuthority, { resolveAttempt });\n\t\t\tperformance.mark(`code/extHost/didResolveAuthorityOK/${authorityPrefix}`);\n\n\t\t\t// Split merged API result into separate authority/options\n\t\t\tconst authority: ResolvedAuthority = {\n\t\t\t\tauthority: remoteAuthority,\n\t\t\t\thost: result.host,\n\t\t\t\tport: result.port,\n\t\t\t\tconnectionToken: result.connectionToken\n\t\t\t};\n\t\t\tconst options: ResolvedOptions = {\n\t\t\t\textensionHostEnv: result.extensionHostEnv,\n\t\t\t\tisTrusted: result.isTrusted,\n\t\t\t\tauthenticationSession: result.authenticationSessionForInitializingExtensions ? { id: result.authenticationSessionForInitializingExtensions.id, providerId: result.authenticationSessionForInitializingExtensions.providerId } : undefined\n\t\t\t};\n\n\t\t\treturn {\n\t\t\t\ttype: 'ok',\n\t\t\t\tvalue: {\n\t\t\t\t\tauthority,\n\t\t\t\t\toptions,\n\t\t\t\t\ttunnelInformation: {\n\t\t\t\t\t\tenvironmentTunnels: result.environmentTunnels,\n\t\t\t\t\t\tfeatures: result.tunnelFeatures\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t} catch (err) {\n\t\t\tperformance.mark(`code/extHost/didResolveAuthorityError/${authorityPrefix}`);\n\t\t\tif (err instanceof RemoteAuthorityResolverError) {\n\t\t\t\treturn {\n\t\t\t\t\ttype: 'error',\n\t\t\t\t\terror: {\n\t\t\t\t\t\tcode: err._code,\n\t\t\t\t\t\tmessage: err._message,\n\t\t\t\t\t\tdetail: err._detail\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t\tthrow err;\n\t\t}\n\t}\n\n\tpublic async $getCanonicalURI(remoteAuthority: string, uriComponents: UriComponents): Promise<UriComponents | null> {\n\t\tthis._logService.info(`$getCanonicalURI invoked for authority (${getRemoteAuthorityPrefix(remoteAuthority)})`);\n\n\t\tconst { resolver } = await this._activateAndGetResolver(remoteAuthority);\n\t\tif (!resolver) {\n\t\t\t// Return `null` if no resolver for `remoteAuthority` is found.\n\t\t\treturn null;\n\t\t}\n\n\t\tconst uri = URI.revive(uriComponents);\n\n\t\tif (typeof resolver.getCanonicalURI === 'undefined') {\n\t\t\t// resolver cannot compute canonical URI\n\t\t\treturn uri;\n\t\t}\n\n\t\tconst result = await asPromise(() => resolver.getCanonicalURI!(uri));\n\t\tif (!result) {\n\t\t\treturn uri;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprivate static _applyExtensionsDelta(oldGlobalRegistry: ExtensionDescriptionRegistry, oldMyRegistry: ExtensionDescriptionRegistry, extensionsDelta: IExtensionDescriptionDelta) {\n\t\tconst globalRegistry = new ExtensionDescriptionRegistry(oldGlobalRegistry.getAllExtensionDescriptions());\n\t\tglobalRegistry.deltaExtensions(extensionsDelta.toAdd, extensionsDelta.toRemove);\n\n\t\tconst myExtensionsSet = extensionIdentifiersArrayToSet(oldMyRegistry.getAllExtensionDescriptions().map(extension => extension.identifier));\n\t\tfor (const extensionId of extensionsDelta.myToRemove) {\n\t\t\tmyExtensionsSet.delete(ExtensionIdentifier.toKey(extensionId));\n\t\t}\n\t\tfor (const extensionId of extensionsDelta.myToAdd) {\n\t\t\tmyExtensionsSet.add(ExtensionIdentifier.toKey(extensionId));\n\t\t}\n\t\tconst myExtensions = filterExtensions(globalRegistry, myExtensionsSet);\n\n\t\treturn { globalRegistry, myExtensions };\n\t}\n\n\tpublic $startExtensionHost(extensionsDelta: IExtensionDescriptionDelta): Promise<void> {\n\t\textensionsDelta.toAdd.forEach((extension) => (<any>extension).extensionLocation = URI.revive(extension.extensionLocation));\n\n\t\tconst { globalRegistry, myExtensions } = AbstractExtHostExtensionService._applyExtensionsDelta(this._globalRegistry, this._myRegistry, extensionsDelta);\n\t\tthis._globalRegistry.set(globalRegistry.getAllExtensionDescriptions());\n\t\tthis._myRegistry.set(myExtensions);\n\n\t\treturn this._startExtensionHost();\n\t}\n\n\tpublic $activateByEvent(activationEvent: string, activationKind: ActivationKind): Promise<void> {\n\t\tif (activationKind === ActivationKind.Immediate) {\n\t\t\treturn this._activateByEvent(activationEvent, false);\n\t\t}\n\n\t\treturn (\n\t\t\tthis._readyToRunExtensions.wait()\n\t\t\t\t.then(_ => this._activateByEvent(activationEvent, false))\n\t\t);\n\t}\n\n\tpublic async $activate(extensionId: ExtensionIdentifier, reason: ExtensionActivationReason): Promise<boolean> {\n\t\tawait this._readyToRunExtensions.wait();\n\t\tif (!this._myRegistry.getExtensionDescription(extensionId)) {\n\t\t\t// unknown extension => ignore\n\t\t\treturn false;\n\t\t}\n\t\tawait this._activateById(extensionId, reason);\n\t\treturn true;\n\t}\n\n\tpublic async $deltaExtensions(extensionsDelta: IExtensionDescriptionDelta): Promise<void> {\n\t\textensionsDelta.toAdd.forEach((extension) => (<any>extension).extensionLocation = URI.revive(extension.extensionLocation));\n\n\t\t// First build up and update the trie and only afterwards apply the delta\n\t\tconst { globalRegistry, myExtensions } = AbstractExtHostExtensionService._applyExtensionsDelta(this._globalRegistry, this._myRegistry, extensionsDelta);\n\t\tconst newSearchTree = await this._createExtensionPathIndex(myExtensions);\n\t\tconst extensionsPaths = await this.getExtensionPathIndex();\n\t\textensionsPaths.setSearchTree(newSearchTree);\n\t\tthis._globalRegistry.set(globalRegistry.getAllExtensionDescriptions());\n\t\tthis._myRegistry.set(myExtensions);\n\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\tpublic async $test_latency(n: number): Promise<number> {\n\t\treturn n;\n\t}\n\n\tpublic async $test_up(b: VSBuffer): Promise<number> {\n\t\treturn b.byteLength;\n\t}\n\n\tpublic async $test_down(size: number): Promise<VSBuffer> {\n\t\tconst buff = VSBuffer.alloc(size);\n\t\tconst value = Math.random() % 256;\n\t\tfor (let i = 0; i < size; i++) {\n\t\t\tbuff.writeUInt8(value, i);\n\t\t}\n\t\treturn buff;\n\t}\n\n\tpublic async $updateRemoteConnectionData(connectionData: IRemoteConnectionData): Promise<void> {\n\t\tthis._remoteConnectionData = connectionData;\n\t\tthis._onDidChangeRemoteConnectionData.fire();\n\t}\n\n\tprotected abstract _beforeAlmostReadyToRunExtensions(): Promise<void>;\n\tprotected abstract _getEntryPoint(extensionDescription: IExtensionDescription): string | undefined;\n\tprotected abstract _loadCommonJSModule<T extends object | undefined>(extensionId: ExtensionIdentifier | null, module: URI, activationTimesBuilder: ExtensionActivationTimesBuilder): Promise<T>;\n\tpublic abstract $setRemoteEnvironment(env: { [key: string]: string | null }): Promise<void>;\n}\n\n\ntype TelemetryActivationEvent = {\n\tid: string;\n\tname: string;\n\textensionVersion: string;\n\tpublisherDisplayName: string;\n\tactivationEvents: string | null;\n\tisBuiltin: boolean;\n\treason: string;\n\treasonId: string;\n};\n\nfunction getTelemetryActivationEvent(extensionDescription: IExtensionDescription, reason: ExtensionActivationReason): TelemetryActivationEvent {\n\tconst event = {\n\t\tid: extensionDescription.identifier.value,\n\t\tname: extensionDescription.name,\n\t\textensionVersion: extensionDescription.version,\n\t\tpublisherDisplayName: extensionDescription.publisher,\n\t\tactivationEvents: extensionDescription.activationEvents ? extensionDescription.activationEvents.join(',') : null,\n\t\tisBuiltin: extensionDescription.isBuiltin,\n\t\treason: reason.activationEvent,\n\t\treasonId: reason.extensionId.value,\n\t};\n\n\treturn event;\n}\n\n\nexport const IExtHostExtensionService = createDecorator<IExtHostExtensionService>('IExtHostExtensionService');\n\nexport interface IExtHostExtensionService extends AbstractExtHostExtensionService {\n\treadonly _serviceBrand: undefined;\n\tinitialize(): Promise<void>;\n\tterminate(reason: string): void;\n\tgetExtension(extensionId: string): Promise<IExtensionDescription | undefined>;\n\tisActivated(extensionId: ExtensionIdentifier): boolean;\n\tactivateByIdWithErrors(extensionId: ExtensionIdentifier, reason: ExtensionActivationReason): Promise<void>;\n\tgetExtensionExports(extensionId: ExtensionIdentifier): IExtensionAPI | null | undefined;\n\tgetExtensionRegistry(): Promise<ExtensionDescriptionRegistry>;\n\tgetExtensionPathIndex(): Promise<ExtensionPaths>;\n\tregisterRemoteAuthorityResolver(authorityPrefix: string, resolver: vscode.RemoteAuthorityResolver): vscode.Disposable;\n\n\tonDidChangeRemoteConnectionData: Event<void>;\n\tgetRemoteConnectionData(): IRemoteConnectionData | null;\n}\n\nexport class Extension<T extends object | null | undefined> implements vscode.Extension<T> {\n\n\t#extensionService: IExtHostExtensionService;\n\t#originExtensionId: ExtensionIdentifier;\n\t#identifier: ExtensionIdentifier;\n\n\treadonly id: string;\n\treadonly extensionUri: URI;\n\treadonly extensionPath: string;\n\treadonly packageJSON: IExtensionDescription;\n\treadonly extensionKind: vscode.ExtensionKind;\n\treadonly isFromDifferentExtensionHost: boolean;\n\n\tconstructor(extensionService: IExtHostExtensionService, originExtensionId: ExtensionIdentifier, description: IExtensionDescription, kind: ExtensionKind, isFromDifferentExtensionHost: boolean) {\n\t\tthis.#extensionService = extensionService;\n\t\tthis.#originExtensionId = originExtensionId;\n\t\tthis.#identifier = description.identifier;\n\t\tthis.id = description.identifier.value;\n\t\tthis.extensionUri = description.extensionLocation;\n\t\tthis.extensionPath = path.normalize(originalFSPath(description.extensionLocation));\n\t\tthis.packageJSON = description;\n\t\tthis.extensionKind = kind;\n\t\tthis.isFromDifferentExtensionHost = isFromDifferentExtensionHost;\n\t}\n\n\tget isActive(): boolean {\n\t\t// TODO@alexdima support this\n\t\treturn this.#extensionService.isActivated(this.#identifier);\n\t}\n\n\tget exports(): T {\n\t\tif (this.packageJSON.api === 'none' || this.isFromDifferentExtensionHost) {\n\t\t\treturn undefined!; // Strict nulloverride - Public api\n\t\t}\n\t\treturn <T>this.#extensionService.getExtensionExports(this.#identifier);\n\t}\n\n\tasync activate(): Promise<T> {\n\t\tif (this.isFromDifferentExtensionHost) {\n\t\t\tthrow new Error('Cannot activate foreign extension'); // TODO@alexdima support this\n\t\t}\n\t\tawait this.#extensionService.activateByIdWithErrors(this.#identifier, { startup: false, extensionId: this.#originExtensionId, activationEvent: 'api' });\n\t\treturn this.exports;\n\t}\n}\n\nfunction filterExtensions(globalRegistry: ExtensionDescriptionRegistry, desiredExtensions: Set<string>): IExtensionDescription[] {\n\treturn globalRegistry.getAllExtensionDescriptions().filter(\n\t\textension => desiredExtensions.has(ExtensionIdentifier.toKey(extension.identifier))\n\t);\n}\n\nfunction getRemoteAuthorityPrefix(remoteAuthority: string): string {\n\tconst plusIndex = remoteAuthority.indexOf('+');\n\tif (plusIndex === -1) {\n\t\treturn remoteAuthority;\n\t}\n\treturn remoteAuthority.substring(0, plusIndex);\n}\n\nexport class ExtensionPaths {\n\n\tconstructor(\n\t\tprivate _searchTree: TernarySearchTree<URI, IExtensionDescription>\n\t) { }\n\n\tsetSearchTree(searchTree: TernarySearchTree<URI, IExtensionDescription>): void {\n\t\tthis._searchTree = searchTree;\n\t}\n\n\tfindSubstr(key: URI): IExtensionDescription | undefined {\n\t\treturn this._searchTree.findSubstr(key);\n\t}\n\n\tforEach(callback: (value: IExtensionDescription, index: URI) => any): void {\n\t\treturn this._searchTree.forEach(callback);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as performance from 'vs/base/common/performance';\nimport { URI } from 'vs/base/common/uri';\nimport { MainThreadTelemetryShape, MainContext } from 'vs/workbench/api/common/extHost.protocol';\nimport { ExtHostConfigProvider, IExtHostConfiguration } from 'vs/workbench/api/common/extHostConfiguration';\nimport { nullExtensionDescription } from 'vs/workbench/services/extensions/common/extensions';\nimport * as vscode from 'vscode';\nimport { ExtensionIdentifier } from 'vs/platform/extensions/common/extensions';\nimport { IExtensionApiFactory, IExtensionRegistries } from 'vs/workbench/api/common/extHost.api.impl';\nimport { IExtHostRpcService } from 'vs/workbench/api/common/extHostRpcService';\nimport { IExtHostInitDataService } from 'vs/workbench/api/common/extHostInitDataService';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { ExtensionPaths, IExtHostExtensionService } from 'vs/workbench/api/common/extHostExtensionService';\nimport { platform } from 'vs/base/common/process';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { escapeRegExpCharacters } from 'vs/base/common/strings';\n\n\ninterface LoadFunction {\n\t(request: string): any;\n}\n\ninterface IAlternativeModuleProvider {\n\talternativeModuleName(name: string): string | undefined;\n}\n\ninterface INodeModuleFactory extends Partial<IAlternativeModuleProvider> {\n\treadonly nodeModuleName: string | string[];\n\tload(request: string, parent: URI, original: LoadFunction): any;\n}\n\nexport abstract class RequireInterceptor {\n\n\tprotected readonly _factories: Map<string, INodeModuleFactory>;\n\tprotected readonly _alternatives: ((moduleName: string) => string | undefined)[];\n\n\tconstructor(\n\t\tprivate _apiFactory: IExtensionApiFactory,\n\t\tprivate _extensionRegistry: IExtensionRegistries,\n\t\t@IInstantiationService private readonly _instaService: IInstantiationService,\n\t\t@IExtHostConfiguration private readonly _extHostConfiguration: IExtHostConfiguration,\n\t\t@IExtHostExtensionService private readonly _extHostExtensionService: IExtHostExtensionService,\n\t\t@IExtHostInitDataService private readonly _initData: IExtHostInitDataService,\n\t\t@ILogService private readonly _logService: ILogService,\n\t) {\n\t\tthis._factories = new Map<string, INodeModuleFactory>();\n\t\tthis._alternatives = [];\n\t}\n\n\tasync install(): Promise<void> {\n\n\t\tthis._installInterceptor();\n\n\t\tperformance.mark('code/extHost/willWaitForConfig');\n\t\tconst configProvider = await this._extHostConfiguration.getConfigProvider();\n\t\tperformance.mark('code/extHost/didWaitForConfig');\n\t\tconst extensionPaths = await this._extHostExtensionService.getExtensionPathIndex();\n\n\t\tthis.register(new VSCodeNodeModuleFactory(this._apiFactory, extensionPaths, this._extensionRegistry, configProvider, this._logService));\n\t\tthis.register(this._instaService.createInstance(KeytarNodeModuleFactory, extensionPaths));\n\t\tthis.register(this._instaService.createInstance(NodeModuleAliasingModuleFactory));\n\t\tif (this._initData.remote.isRemote) {\n\t\t\tthis.register(this._instaService.createInstance(OpenNodeModuleFactory, extensionPaths, this._initData.environment.appUriScheme));\n\t\t}\n\t}\n\n\tprotected abstract _installInterceptor(): void;\n\n\tpublic register(interceptor: INodeModuleFactory | IAlternativeModuleProvider): void {\n\t\tif ('nodeModuleName' in interceptor) {\n\t\t\tif (Array.isArray(interceptor.nodeModuleName)) {\n\t\t\t\tfor (const moduleName of interceptor.nodeModuleName) {\n\t\t\t\t\tthis._factories.set(moduleName, interceptor);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._factories.set(interceptor.nodeModuleName, interceptor);\n\t\t\t}\n\t\t}\n\n\t\tif (typeof interceptor.alternativeModuleName === 'function') {\n\t\t\tthis._alternatives.push((moduleName) => {\n\t\t\t\treturn interceptor.alternativeModuleName!(moduleName);\n\t\t\t});\n\t\t}\n\t}\n}\n\n//#region --- module renames\n\nclass NodeModuleAliasingModuleFactory implements IAlternativeModuleProvider {\n\t/**\n\t * Map of aliased internal node_modules, used to allow for modules to be\n\t * renamed without breaking extensions. In the form \"original -> new name\".\n\t */\n\tprivate static readonly aliased: ReadonlyMap<string, string> = new Map([\n\t\t['vscode-ripgrep', '@vscode/ripgrep'],\n\t\t['vscode-windows-registry', '@vscode/windows-registry'],\n\t]);\n\n\tprivate readonly re?: RegExp;\n\n\tconstructor(@IExtHostInitDataService initData: IExtHostInitDataService) {\n\t\tif (initData.environment.appRoot && NodeModuleAliasingModuleFactory.aliased.size) {\n\t\t\tconst root = escapeRegExpCharacters(this.forceForwardSlashes(initData.environment.appRoot.fsPath));\n\t\t\t// decompose ${appRoot}/node_modules/foo/bin to ['${appRoot}/node_modules/', 'foo', '/bin'],\n\t\t\t// and likewise the more complex form ${appRoot}/node_modules.asar.unpacked/@vcode/foo/bin\n\t\t\t// to ['${appRoot}/node_modules.asar.unpacked/',' @vscode/foo', '/bin'].\n\t\t\tconst npmIdChrs = `[a-z0-9_.-]`;\n\t\t\tconst npmModuleName = `@${npmIdChrs}+\\\\/${npmIdChrs}+|${npmIdChrs}+`;\n\t\t\tconst moduleFolders = 'node_modules|node_modules\\\\.asar(?:\\\\.unpacked)?';\n\t\t\tthis.re = new RegExp(`^(${root}/${moduleFolders}\\\\/)(${npmModuleName})(.*)$`, 'i');\n\t\t}\n\t}\n\n\tpublic alternativeModuleName(name: string): string | undefined {\n\t\tif (!this.re) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst result = this.re.exec(this.forceForwardSlashes(name));\n\t\tif (!result) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst [, prefix, moduleName, suffix] = result;\n\t\tconst dealiased = NodeModuleAliasingModuleFactory.aliased.get(moduleName);\n\t\tif (dealiased === undefined) {\n\t\t\treturn;\n\t\t}\n\n\t\tconsole.warn(`${moduleName} as been renamed to ${dealiased}, please update your imports`);\n\n\t\treturn prefix + dealiased + suffix;\n\t}\n\n\tprivate forceForwardSlashes(str: string) {\n\t\treturn str.replace(/\\\\/g, '/');\n\t}\n}\n\n//#endregion\n\n//#region --- vscode-module\n\nclass VSCodeNodeModuleFactory implements INodeModuleFactory {\n\tpublic readonly nodeModuleName = 'vscode';\n\n\tprivate readonly _extApiImpl = new Map<string, typeof vscode>();\n\tprivate _defaultApiImpl?: typeof vscode;\n\n\tconstructor(\n\t\tprivate readonly _apiFactory: IExtensionApiFactory,\n\t\tprivate readonly _extensionPaths: ExtensionPaths,\n\t\tprivate readonly _extensionRegistry: IExtensionRegistries,\n\t\tprivate readonly _configProvider: ExtHostConfigProvider,\n\t\tprivate readonly _logService: ILogService,\n\t) {\n\t}\n\n\tpublic load(_request: string, parent: URI): any {\n\n\t\t// get extension id from filename and api for extension\n\t\tconst ext = this._extensionPaths.findSubstr(parent);\n\t\tif (ext) {\n\t\t\tlet apiImpl = this._extApiImpl.get(ExtensionIdentifier.toKey(ext.identifier));\n\t\t\tif (!apiImpl) {\n\t\t\t\tapiImpl = this._apiFactory(ext, this._extensionRegistry, this._configProvider);\n\t\t\t\tthis._extApiImpl.set(ExtensionIdentifier.toKey(ext.identifier), apiImpl);\n\t\t\t}\n\t\t\treturn apiImpl;\n\t\t}\n\n\t\t// fall back to a default implementation\n\t\tif (!this._defaultApiImpl) {\n\t\t\tlet extensionPathsPretty = '';\n\t\t\tthis._extensionPaths.forEach((value, index) => extensionPathsPretty += `\\t${index} -> ${value.identifier.value}\\n`);\n\t\t\tthis._logService.warn(`Could not identify extension for 'vscode' require call from ${parent}. These are the extension path mappings: \\n${extensionPathsPretty}`);\n\t\t\tthis._defaultApiImpl = this._apiFactory(nullExtensionDescription, this._extensionRegistry, this._configProvider);\n\t\t}\n\t\treturn this._defaultApiImpl;\n\t}\n}\n\n//#endregion\n\n\n//#region --- keytar-module\n\ninterface IKeytarModule {\n\tgetPassword(service: string, account: string): Promise<string | null>;\n\tsetPassword(service: string, account: string, password: string): Promise<void>;\n\tdeletePassword(service: string, account: string): Promise<boolean>;\n\tfindPassword(service: string): Promise<string | null>;\n\tfindCredentials(service: string): Promise<Array<{ account: string; password: string }>>;\n}\n\nclass KeytarNodeModuleFactory implements INodeModuleFactory {\n\tpublic readonly nodeModuleName: string = 'keytar';\n\n\tprivate readonly _mainThreadTelemetry: MainThreadTelemetryShape;\n\tprivate alternativeNames: Set<string> | undefined;\n\tprivate _impl: IKeytarModule;\n\n\tconstructor(\n\t\tprivate readonly _extensionPaths: ExtensionPaths,\n\t\t@IExtHostRpcService rpcService: IExtHostRpcService,\n\t\t@IExtHostInitDataService initData: IExtHostInitDataService,\n\n\t) {\n\t\tthis._mainThreadTelemetry = rpcService.getProxy(MainContext.MainThreadTelemetry);\n\t\tconst { environment } = initData;\n\t\tconst mainThreadKeytar = rpcService.getProxy(MainContext.MainThreadKeytar);\n\n\t\tif (environment.appRoot) {\n\t\t\tlet appRoot = environment.appRoot.fsPath;\n\t\t\tif (platform === 'win32') {\n\t\t\t\tappRoot = appRoot.replace(/\\\\/g, '/');\n\t\t\t}\n\t\t\tif (appRoot[appRoot.length - 1] === '/') {\n\t\t\t\tappRoot = appRoot.substr(0, appRoot.length - 1);\n\t\t\t}\n\t\t\tthis.alternativeNames = new Set();\n\t\t\tthis.alternativeNames.add(`${appRoot}/node_modules.asar/keytar`);\n\t\t\tthis.alternativeNames.add(`${appRoot}/node_modules/keytar`);\n\t\t}\n\t\tthis._impl = {\n\t\t\tgetPassword: (service: string, account: string): Promise<string | null> => {\n\t\t\t\treturn mainThreadKeytar.$getPassword(service, account);\n\t\t\t},\n\t\t\tsetPassword: (service: string, account: string, password: string): Promise<void> => {\n\t\t\t\treturn mainThreadKeytar.$setPassword(service, account, password);\n\t\t\t},\n\t\t\tdeletePassword: (service: string, account: string): Promise<boolean> => {\n\t\t\t\treturn mainThreadKeytar.$deletePassword(service, account);\n\t\t\t},\n\t\t\tfindPassword: (service: string): Promise<string | null> => {\n\t\t\t\treturn mainThreadKeytar.$findPassword(service);\n\t\t\t},\n\t\t\tfindCredentials(service: string): Promise<Array<{ account: string; password: string }>> {\n\t\t\t\treturn mainThreadKeytar.$findCredentials(service);\n\t\t\t}\n\t\t};\n\t}\n\n\tpublic load(_request: string, parent: URI): any {\n\t\tconst ext = this._extensionPaths.findSubstr(parent);\n\t\ttype ShimmingKeytarClassification = {\n\t\t\towner: 'jrieken';\n\t\t\tcomment: 'Know when the keytar-shim was used';\n\t\t\textension: { classification: 'SystemMetaData'; purpose: 'FeatureInsight'; comment: 'The extension is question' };\n\t\t};\n\t\tthis._mainThreadTelemetry.$publicLog2<{ extension: string }, ShimmingKeytarClassification>('shimming.keytar', { extension: ext?.identifier.value ?? 'unknown_extension' });\n\t\treturn this._impl;\n\t}\n\n\tpublic alternativeModuleName(name: string): string | undefined {\n\t\tconst length = name.length;\n\t\t// We need at least something like: `?/keytar` which requires\n\t\t// more than 7 characters.\n\t\tif (length <= 7 || !this.alternativeNames) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst sep = length - 7;\n\t\tif ((name.charAt(sep) === '/' || name.charAt(sep) === '\\\\') && name.endsWith('keytar')) {\n\t\t\tname = name.replace(/\\\\/g, '/');\n\t\t\tif (this.alternativeNames.has(name)) {\n\t\t\t\treturn 'keytar';\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n}\n\n//#endregion\n\n\n//#region --- opn/open-module\n\ninterface OpenOptions {\n\twait: boolean;\n\tapp: string | string[];\n}\n\ninterface IOriginalOpen {\n\t(target: string, options?: OpenOptions): Thenable<any>;\n}\n\ninterface IOpenModule {\n\t(target: string, options?: OpenOptions): Thenable<void>;\n}\n\nclass OpenNodeModuleFactory implements INodeModuleFactory {\n\n\tpublic readonly nodeModuleName: string[] = ['open', 'opn'];\n\n\tprivate _extensionId: string | undefined;\n\tprivate _original?: IOriginalOpen;\n\tprivate _impl: IOpenModule;\n\tprivate _mainThreadTelemetry: MainThreadTelemetryShape;\n\n\tconstructor(\n\t\tprivate readonly _extensionPaths: ExtensionPaths,\n\t\tprivate readonly _appUriScheme: string,\n\t\t@IExtHostRpcService rpcService: IExtHostRpcService,\n\t) {\n\n\t\tthis._mainThreadTelemetry = rpcService.getProxy(MainContext.MainThreadTelemetry);\n\t\tconst mainThreadWindow = rpcService.getProxy(MainContext.MainThreadWindow);\n\n\t\tthis._impl = (target, options) => {\n\t\t\tconst uri: URI = URI.parse(target);\n\t\t\t// If we have options use the original method.\n\t\t\tif (options) {\n\t\t\t\treturn this.callOriginal(target, options);\n\t\t\t}\n\t\t\tif (uri.scheme === 'http' || uri.scheme === 'https') {\n\t\t\t\treturn mainThreadWindow.$openUri(uri, target, { allowTunneling: true });\n\t\t\t} else if (uri.scheme === 'mailto' || uri.scheme === this._appUriScheme) {\n\t\t\t\treturn mainThreadWindow.$openUri(uri, target, {});\n\t\t\t}\n\t\t\treturn this.callOriginal(target, options);\n\t\t};\n\t}\n\n\tpublic load(request: string, parent: URI, original: LoadFunction): any {\n\t\t// get extension id from filename and api for extension\n\t\tconst extension = this._extensionPaths.findSubstr(parent);\n\t\tif (extension) {\n\t\t\tthis._extensionId = extension.identifier.value;\n\t\t\tthis.sendShimmingTelemetry();\n\t\t}\n\n\t\tthis._original = original(request);\n\t\treturn this._impl;\n\t}\n\n\tprivate callOriginal(target: string, options: OpenOptions | undefined): Thenable<any> {\n\t\tthis.sendNoForwardTelemetry();\n\t\treturn this._original!(target, options);\n\t}\n\n\tprivate sendShimmingTelemetry(): void {\n\t\tif (!this._extensionId) {\n\t\t\treturn;\n\t\t}\n\t\ttype ShimmingOpenClassification = {\n\t\t\towner: 'jrieken';\n\t\t\tcomment: 'Know when the open-shim was used';\n\t\t\textension: { classification: 'SystemMetaData'; purpose: 'FeatureInsight'; comment: 'The extension is question' };\n\t\t};\n\t\tthis._mainThreadTelemetry.$publicLog2<{ extension: string }, ShimmingOpenClassification>('shimming.open', { extension: this._extensionId });\n\t}\n\n\tprivate sendNoForwardTelemetry(): void {\n\t\tif (!this._extensionId) {\n\t\t\treturn;\n\t\t}\n\t\ttype ShimmingOpenCallNoForwardClassification = {\n\t\t\towner: 'jrieken';\n\t\t\tcomment: 'Know when the open-shim was used';\n\t\t\textension: { classification: 'SystemMetaData'; purpose: 'FeatureInsight'; comment: 'The extension is question' };\n\t\t};\n\t\tthis._mainThreadTelemetry.$publicLog2<{ extension: string }, ShimmingOpenCallNoForwardClassification>('shimming.open.call.noForward', { extension: this._extensionId });\n\t}\n}\n\n//#endregion\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Lazy } from 'vs/base/common/lazy';\nimport { Disposable } from 'vs/base/common/lifecycle';\nimport * as path from 'vs/base/common/path';\nimport * as process from 'vs/base/common/process';\nimport { URI } from 'vs/base/common/uri';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { IExtHostDocumentsAndEditors } from 'vs/workbench/api/common/extHostDocumentsAndEditors';\nimport { IExtHostEditorTabs } from 'vs/workbench/api/common/extHostEditorTabs';\nimport { IExtHostExtensionService } from 'vs/workbench/api/common/extHostExtensionService';\nimport { CustomEditorTabInput, NotebookDiffEditorTabInput, NotebookEditorTabInput, TextDiffTabInput, TextTabInput } from 'vs/workbench/api/common/extHostTypes';\nimport { IExtHostWorkspace } from 'vs/workbench/api/common/extHostWorkspace';\nimport { IConfigurationResolverService } from 'vs/workbench/services/configurationResolver/common/configurationResolver';\nimport { AbstractVariableResolverService } from 'vs/workbench/services/configurationResolver/common/variableResolver';\nimport * as vscode from 'vscode';\nimport { ExtHostConfigProvider, IExtHostConfiguration } from './extHostConfiguration';\n\nexport interface IExtHostVariableResolverProvider {\n\treadonly _serviceBrand: undefined;\n\tgetResolver(): Promise<IConfigurationResolverService>;\n}\n\nexport const IExtHostVariableResolverProvider = createDecorator<IExtHostVariableResolverProvider>('IExtHostVariableResolverProvider');\n\ninterface DynamicContext {\n\tfolders: vscode.WorkspaceFolder[];\n}\n\nclass ExtHostVariableResolverService extends AbstractVariableResolverService {\n\n\tconstructor(\n\t\textensionService: IExtHostExtensionService,\n\t\tworkspaceService: IExtHostWorkspace,\n\t\teditorService: IExtHostDocumentsAndEditors,\n\t\teditorTabs: IExtHostEditorTabs,\n\t\tconfigProvider: ExtHostConfigProvider,\n\t\tcontext: DynamicContext,\n\t\thomeDir: string | undefined,\n\t) {\n\t\tfunction getActiveUri(): URI | undefined {\n\t\t\tif (editorService) {\n\t\t\t\tconst activeEditor = editorService.activeEditor();\n\t\t\t\tif (activeEditor) {\n\t\t\t\t\treturn activeEditor.document.uri;\n\t\t\t\t}\n\t\t\t\tconst activeTab = editorTabs.tabGroups.all.find(group => group.isActive)?.activeTab;\n\t\t\t\tif (activeTab !== undefined) {\n\t\t\t\t\t// Resolve a resource from the tab\n\t\t\t\t\tif (activeTab.input instanceof TextDiffTabInput || activeTab.input instanceof NotebookDiffEditorTabInput) {\n\t\t\t\t\t\treturn activeTab.input.modified;\n\t\t\t\t\t} else if (activeTab.input instanceof TextTabInput || activeTab.input instanceof NotebookEditorTabInput || activeTab.input instanceof CustomEditorTabInput) {\n\t\t\t\t\t\treturn activeTab.input.uri;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn undefined;\n\t\t}\n\n\t\tsuper({\n\t\t\tgetFolderUri: (folderName: string): URI | undefined => {\n\t\t\t\tconst found = context.folders.filter(f => f.name === folderName);\n\t\t\t\tif (found && found.length > 0) {\n\t\t\t\t\treturn found[0].uri;\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t},\n\t\t\tgetWorkspaceFolderCount: (): number => {\n\t\t\t\treturn context.folders.length;\n\t\t\t},\n\t\t\tgetConfigurationValue: (folderUri: URI | undefined, section: string): string | undefined => {\n\t\t\t\treturn configProvider.getConfiguration(undefined, folderUri).get<string>(section);\n\t\t\t},\n\t\t\tgetAppRoot: (): string | undefined => {\n\t\t\t\treturn process.cwd();\n\t\t\t},\n\t\t\tgetExecPath: (): string | undefined => {\n\t\t\t\treturn process.env['VSCODE_EXEC_PATH'];\n\t\t\t},\n\t\t\tgetFilePath: (): string | undefined => {\n\t\t\t\tconst activeUri = getActiveUri();\n\t\t\t\tif (activeUri) {\n\t\t\t\t\treturn path.normalize(activeUri.fsPath);\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t},\n\t\t\tgetWorkspaceFolderPathForFile: (): string | undefined => {\n\t\t\t\tif (workspaceService) {\n\t\t\t\t\tconst activeUri = getActiveUri();\n\t\t\t\t\tif (activeUri) {\n\t\t\t\t\t\tconst ws = workspaceService.getWorkspaceFolder(activeUri);\n\t\t\t\t\t\tif (ws) {\n\t\t\t\t\t\t\treturn path.normalize(ws.uri.fsPath);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t},\n\t\t\tgetSelectedText: (): string | undefined => {\n\t\t\t\tif (editorService) {\n\t\t\t\t\tconst activeEditor = editorService.activeEditor();\n\t\t\t\t\tif (activeEditor && !activeEditor.selection.isEmpty) {\n\t\t\t\t\t\treturn activeEditor.document.getText(activeEditor.selection);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t},\n\t\t\tgetLineNumber: (): string | undefined => {\n\t\t\t\tif (editorService) {\n\t\t\t\t\tconst activeEditor = editorService.activeEditor();\n\t\t\t\t\tif (activeEditor) {\n\t\t\t\t\t\treturn String(activeEditor.selection.end.line + 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t},\n\t\t\tgetExtension: (id) => {\n\t\t\t\treturn extensionService.getExtension(id);\n\t\t\t},\n\t\t}, undefined, homeDir ? Promise.resolve(homeDir) : undefined, Promise.resolve(process.env));\n\t}\n}\n\nexport class ExtHostVariableResolverProviderService extends Disposable implements IExtHostVariableResolverProvider {\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate _resolver = new Lazy(async () => {\n\t\tconst configProvider = await this.configurationService.getConfigProvider();\n\t\tconst folders = await this.workspaceService.getWorkspaceFolders2() || [];\n\n\t\tconst dynamic: DynamicContext = { folders };\n\t\tthis._register(this.workspaceService.onDidChangeWorkspace(async e => {\n\t\t\tdynamic.folders = await this.workspaceService.getWorkspaceFolders2() || [];\n\t\t}));\n\n\t\treturn new ExtHostVariableResolverService(\n\t\t\tthis.extensionService,\n\t\t\tthis.workspaceService,\n\t\t\tthis.editorService,\n\t\t\tthis.editorTabs,\n\t\t\tconfigProvider,\n\t\t\tdynamic,\n\t\t\tthis.homeDir(),\n\t\t);\n\t});\n\n\tconstructor(\n\t\t@IExtHostExtensionService private readonly extensionService: IExtHostExtensionService,\n\t\t@IExtHostWorkspace private readonly workspaceService: IExtHostWorkspace,\n\t\t@IExtHostDocumentsAndEditors private readonly editorService: IExtHostDocumentsAndEditors,\n\t\t@IExtHostConfiguration private readonly configurationService: IExtHostConfiguration,\n\t\t@IExtHostEditorTabs private readonly editorTabs: IExtHostEditorTabs,\n\t) {\n\t\tsuper();\n\t}\n\n\tpublic getResolver(): Promise<IConfigurationResolverService> {\n\t\treturn this._resolver.getValue();\n\t}\n\n\tprotected homeDir(): string | undefined {\n\t\treturn undefined;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { asPromise } from 'vs/base/common/async';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { withNullAsUndefined } from 'vs/base/common/types';\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { ISignService } from 'vs/platform/sign/common/sign';\nimport { IWorkspaceFolder } from 'vs/platform/workspace/common/workspace';\nimport { DebugSessionUUID, ExtHostDebugServiceShape, IBreakpointsDeltaDto, IDebugSessionDto, IFunctionBreakpointDto, ISourceMultiBreakpointDto, MainContext, MainThreadDebugServiceShape } from 'vs/workbench/api/common/extHost.protocol';\nimport { IExtHostEditorTabs } from 'vs/workbench/api/common/extHostEditorTabs';\nimport { IExtHostExtensionService } from 'vs/workbench/api/common/extHostExtensionService';\nimport { IExtHostRpcService } from 'vs/workbench/api/common/extHostRpcService';\nimport { DataBreakpoint, DebugAdapterExecutable, DebugAdapterInlineImplementation, DebugAdapterNamedPipeServer, DebugAdapterServer, DebugConsoleMode, Disposable, FunctionBreakpoint, Location, Position, SourceBreakpoint } from 'vs/workbench/api/common/extHostTypes';\nimport { IExtHostWorkspace } from 'vs/workbench/api/common/extHostWorkspace';\nimport { AbstractDebugAdapter } from 'vs/workbench/contrib/debug/common/abstractDebugAdapter';\nimport { IAdapterDescriptor, IConfig, IDebugAdapter, IDebugAdapterExecutable, IDebugAdapterNamedPipeServer, IDebugAdapterServer, IDebuggerContribution } from 'vs/workbench/contrib/debug/common/debug';\nimport { convertToDAPaths, convertToVSCPaths, isDebuggerMainContribution } from 'vs/workbench/contrib/debug/common/debugUtils';\nimport { ExtensionDescriptionRegistry } from 'vs/workbench/services/extensions/common/extensionDescriptionRegistry';\nimport { Dto } from 'vs/workbench/services/extensions/common/proxyIdentifier';\nimport type * as vscode from 'vscode';\nimport { IExtHostConfiguration } from '../common/extHostConfiguration';\nimport { IExtHostVariableResolverProvider } from './extHostVariableResolverService';\n\nexport const IExtHostDebugService = createDecorator<IExtHostDebugService>('IExtHostDebugService');\n\nexport interface IExtHostDebugService extends ExtHostDebugServiceShape {\n\n\treadonly _serviceBrand: undefined;\n\n\tonDidStartDebugSession: Event<vscode.DebugSession>;\n\tonDidTerminateDebugSession: Event<vscode.DebugSession>;\n\tonDidChangeActiveDebugSession: Event<vscode.DebugSession | undefined>;\n\tactiveDebugSession: vscode.DebugSession | undefined;\n\tactiveDebugConsole: vscode.DebugConsole;\n\tonDidReceiveDebugSessionCustomEvent: Event<vscode.DebugSessionCustomEvent>;\n\tonDidChangeBreakpoints: Event<vscode.BreakpointsChangeEvent>;\n\tbreakpoints: vscode.Breakpoint[];\n\n\taddBreakpoints(breakpoints0: readonly vscode.Breakpoint[]): Promise<void>;\n\tremoveBreakpoints(breakpoints0: readonly vscode.Breakpoint[]): Promise<void>;\n\tstartDebugging(folder: vscode.WorkspaceFolder | undefined, nameOrConfig: string | vscode.DebugConfiguration, options: vscode.DebugSessionOptions): Promise<boolean>;\n\tstopDebugging(session?: vscode.DebugSession): Promise<void>;\n\tregisterDebugConfigurationProvider(type: string, provider: vscode.DebugConfigurationProvider, trigger: vscode.DebugConfigurationProviderTriggerKind): vscode.Disposable;\n\tregisterDebugAdapterDescriptorFactory(extension: IExtensionDescription, type: string, factory: vscode.DebugAdapterDescriptorFactory): vscode.Disposable;\n\tregisterDebugAdapterTrackerFactory(type: string, factory: vscode.DebugAdapterTrackerFactory): vscode.Disposable;\n\tasDebugSourceUri(source: vscode.DebugProtocolSource, session?: vscode.DebugSession): vscode.Uri;\n}\n\nexport abstract class ExtHostDebugServiceBase implements IExtHostDebugService, ExtHostDebugServiceShape {\n\n\treadonly _serviceBrand: undefined;\n\n\tprivate _configProviderHandleCounter: number;\n\tprivate _configProviders: ConfigProviderTuple[];\n\n\tprivate _adapterFactoryHandleCounter: number;\n\tprivate _adapterFactories: DescriptorFactoryTuple[];\n\n\tprivate _trackerFactoryHandleCounter: number;\n\tprivate _trackerFactories: TrackerFactoryTuple[];\n\n\tprivate _debugServiceProxy: MainThreadDebugServiceShape;\n\tprivate _debugSessions: Map<DebugSessionUUID, ExtHostDebugSession> = new Map<DebugSessionUUID, ExtHostDebugSession>();\n\n\tprivate readonly _onDidStartDebugSession: Emitter<vscode.DebugSession>;\n\tget onDidStartDebugSession(): Event<vscode.DebugSession> { return this._onDidStartDebugSession.event; }\n\n\tprivate readonly _onDidTerminateDebugSession: Emitter<vscode.DebugSession>;\n\tget onDidTerminateDebugSession(): Event<vscode.DebugSession> { return this._onDidTerminateDebugSession.event; }\n\n\tprivate readonly _onDidChangeActiveDebugSession: Emitter<vscode.DebugSession | undefined>;\n\tget onDidChangeActiveDebugSession(): Event<vscode.DebugSession | undefined> { return this._onDidChangeActiveDebugSession.event; }\n\n\tprivate _activeDebugSession: ExtHostDebugSession | undefined;\n\tget activeDebugSession(): ExtHostDebugSession | undefined { return this._activeDebugSession; }\n\n\tprivate readonly _onDidReceiveDebugSessionCustomEvent: Emitter<vscode.DebugSessionCustomEvent>;\n\tget onDidReceiveDebugSessionCustomEvent(): Event<vscode.DebugSessionCustomEvent> { return this._onDidReceiveDebugSessionCustomEvent.event; }\n\n\tprivate _activeDebugConsole: ExtHostDebugConsole;\n\tget activeDebugConsole(): vscode.DebugConsole { return this._activeDebugConsole.value; }\n\n\tprivate _breakpoints: Map<string, vscode.Breakpoint>;\n\tprivate _breakpointEventsActive: boolean;\n\n\tprivate readonly _onDidChangeBreakpoints: Emitter<vscode.BreakpointsChangeEvent>;\n\n\tprivate _debugAdapters: Map<number, IDebugAdapter>;\n\tprivate _debugAdaptersTrackers: Map<number, vscode.DebugAdapterTracker>;\n\n\tprivate _signService: ISignService | undefined;\n\n\tconstructor(\n\t\t@IExtHostRpcService extHostRpcService: IExtHostRpcService,\n\t\t@IExtHostWorkspace protected _workspaceService: IExtHostWorkspace,\n\t\t@IExtHostExtensionService private _extensionService: IExtHostExtensionService,\n\t\t@IExtHostConfiguration protected _configurationService: IExtHostConfiguration,\n\t\t@IExtHostEditorTabs protected _editorTabs: IExtHostEditorTabs,\n\t\t@IExtHostVariableResolverProvider private _variableResolver: IExtHostVariableResolverProvider,\n\t) {\n\t\tthis._configProviderHandleCounter = 0;\n\t\tthis._configProviders = [];\n\n\t\tthis._adapterFactoryHandleCounter = 0;\n\t\tthis._adapterFactories = [];\n\n\t\tthis._trackerFactoryHandleCounter = 0;\n\t\tthis._trackerFactories = [];\n\n\t\tthis._debugAdapters = new Map();\n\t\tthis._debugAdaptersTrackers = new Map();\n\n\t\tthis._onDidStartDebugSession = new Emitter<vscode.DebugSession>();\n\t\tthis._onDidTerminateDebugSession = new Emitter<vscode.DebugSession>();\n\t\tthis._onDidChangeActiveDebugSession = new Emitter<vscode.DebugSession | undefined>();\n\t\tthis._onDidReceiveDebugSessionCustomEvent = new Emitter<vscode.DebugSessionCustomEvent>();\n\n\t\tthis._debugServiceProxy = extHostRpcService.getProxy(MainContext.MainThreadDebugService);\n\n\t\tthis._onDidChangeBreakpoints = new Emitter<vscode.BreakpointsChangeEvent>({\n\t\t\tonFirstListenerAdd: () => {\n\t\t\t\tthis.startBreakpoints();\n\t\t\t}\n\t\t});\n\n\t\tthis._activeDebugConsole = new ExtHostDebugConsole(this._debugServiceProxy);\n\n\t\tthis._breakpoints = new Map<string, vscode.Breakpoint>();\n\t\tthis._breakpointEventsActive = false;\n\n\t\tthis._extensionService.getExtensionRegistry().then((extensionRegistry: ExtensionDescriptionRegistry) => {\n\t\t\textensionRegistry.onDidChange(_ => {\n\t\t\t\tthis.registerAllDebugTypes(extensionRegistry);\n\t\t\t});\n\t\t\tthis.registerAllDebugTypes(extensionRegistry);\n\t\t});\n\t}\n\n\tpublic asDebugSourceUri(src: vscode.DebugProtocolSource, session?: vscode.DebugSession): URI {\n\n\t\tconst source = <any>src;\n\n\t\tif (typeof source.sourceReference === 'number' && source.sourceReference > 0) {\n\t\t\t// src can be retrieved via DAP's \"source\" request\n\n\t\t\tlet debug = `debug:${encodeURIComponent(source.path || '')}`;\n\t\t\tlet sep = '?';\n\n\t\t\tif (session) {\n\t\t\t\tdebug += `${sep}session=${encodeURIComponent(session.id)}`;\n\t\t\t\tsep = '&';\n\t\t\t}\n\n\t\t\tdebug += `${sep}ref=${source.sourceReference}`;\n\n\t\t\treturn URI.parse(debug);\n\t\t} else if (source.path) {\n\t\t\t// src is just a local file path\n\t\t\treturn URI.file(source.path);\n\t\t} else {\n\t\t\tthrow new Error(`cannot create uri from DAP 'source' object; properties 'path' and 'sourceReference' are both missing.`);\n\t\t}\n\t}\n\n\tprivate registerAllDebugTypes(extensionRegistry: ExtensionDescriptionRegistry) {\n\n\t\tconst debugTypes: string[] = [];\n\n\t\tfor (const ed of extensionRegistry.getAllExtensionDescriptions()) {\n\t\t\tif (ed.contributes) {\n\t\t\t\tconst debuggers = <IDebuggerContribution[]>ed.contributes['debuggers'];\n\t\t\t\tif (debuggers && debuggers.length > 0) {\n\t\t\t\t\tfor (const dbg of debuggers) {\n\t\t\t\t\t\tif (isDebuggerMainContribution(dbg)) {\n\t\t\t\t\t\t\tdebugTypes.push(dbg.type);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis._debugServiceProxy.$registerDebugTypes(debugTypes);\n\t}\n\n\t// extension debug API\n\n\tget onDidChangeBreakpoints(): Event<vscode.BreakpointsChangeEvent> {\n\t\treturn this._onDidChangeBreakpoints.event;\n\t}\n\n\tget breakpoints(): vscode.Breakpoint[] {\n\n\t\tthis.startBreakpoints();\n\n\t\tconst result: vscode.Breakpoint[] = [];\n\t\tthis._breakpoints.forEach(bp => result.push(bp));\n\t\treturn result;\n\t}\n\n\tpublic addBreakpoints(breakpoints0: vscode.Breakpoint[]): Promise<void> {\n\n\t\tthis.startBreakpoints();\n\n\t\t// filter only new breakpoints\n\t\tconst breakpoints = breakpoints0.filter(bp => {\n\t\t\tconst id = bp.id;\n\t\t\tif (!this._breakpoints.has(id)) {\n\t\t\t\tthis._breakpoints.set(id, bp);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\n\t\t// send notification for added breakpoints\n\t\tthis.fireBreakpointChanges(breakpoints, [], []);\n\n\t\t// convert added breakpoints to DTOs\n\t\tconst dtos: Array<ISourceMultiBreakpointDto | IFunctionBreakpointDto> = [];\n\t\tconst map = new Map<string, ISourceMultiBreakpointDto>();\n\t\tfor (const bp of breakpoints) {\n\t\t\tif (bp instanceof SourceBreakpoint) {\n\t\t\t\tlet dto = map.get(bp.location.uri.toString());\n\t\t\t\tif (!dto) {\n\t\t\t\t\tdto = <ISourceMultiBreakpointDto>{\n\t\t\t\t\t\ttype: 'sourceMulti',\n\t\t\t\t\t\turi: bp.location.uri,\n\t\t\t\t\t\tlines: []\n\t\t\t\t\t};\n\t\t\t\t\tmap.set(bp.location.uri.toString(), dto);\n\t\t\t\t\tdtos.push(dto);\n\t\t\t\t}\n\t\t\t\tdto.lines.push({\n\t\t\t\t\tid: bp.id,\n\t\t\t\t\tenabled: bp.enabled,\n\t\t\t\t\tcondition: bp.condition,\n\t\t\t\t\thitCondition: bp.hitCondition,\n\t\t\t\t\tlogMessage: bp.logMessage,\n\t\t\t\t\tline: bp.location.range.start.line,\n\t\t\t\t\tcharacter: bp.location.range.start.character\n\t\t\t\t});\n\t\t\t} else if (bp instanceof FunctionBreakpoint) {\n\t\t\t\tdtos.push({\n\t\t\t\t\ttype: 'function',\n\t\t\t\t\tid: bp.id,\n\t\t\t\t\tenabled: bp.enabled,\n\t\t\t\t\thitCondition: bp.hitCondition,\n\t\t\t\t\tlogMessage: bp.logMessage,\n\t\t\t\t\tcondition: bp.condition,\n\t\t\t\t\tfunctionName: bp.functionName\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t// send DTOs to VS Code\n\t\treturn this._debugServiceProxy.$registerBreakpoints(dtos);\n\t}\n\n\tpublic removeBreakpoints(breakpoints0: vscode.Breakpoint[]): Promise<void> {\n\n\t\tthis.startBreakpoints();\n\n\t\t// remove from array\n\t\tconst breakpoints = breakpoints0.filter(b => this._breakpoints.delete(b.id));\n\n\t\t// send notification\n\t\tthis.fireBreakpointChanges([], breakpoints, []);\n\n\t\t// unregister with VS Code\n\t\tconst ids = breakpoints.filter(bp => bp instanceof SourceBreakpoint).map(bp => bp.id);\n\t\tconst fids = breakpoints.filter(bp => bp instanceof FunctionBreakpoint).map(bp => bp.id);\n\t\tconst dids = breakpoints.filter(bp => bp instanceof DataBreakpoint).map(bp => bp.id);\n\t\treturn this._debugServiceProxy.$unregisterBreakpoints(ids, fids, dids);\n\t}\n\n\tpublic startDebugging(folder: vscode.WorkspaceFolder | undefined, nameOrConfig: string | vscode.DebugConfiguration, options: vscode.DebugSessionOptions): Promise<boolean> {\n\t\treturn this._debugServiceProxy.$startDebugging(folder ? folder.uri : undefined, nameOrConfig, {\n\t\t\tparentSessionID: options.parentSession ? options.parentSession.id : undefined,\n\t\t\tlifecycleManagedByParent: options.lifecycleManagedByParent,\n\t\t\trepl: options.consoleMode === DebugConsoleMode.MergeWithParent ? 'mergeWithParent' : 'separate',\n\t\t\tnoDebug: options.noDebug,\n\t\t\tcompact: options.compact,\n\t\t\tdebugUI: options.debugUI,\n\t\t\tsuppressSaveBeforeStart: options.suppressSaveBeforeStart\n\t\t});\n\t}\n\n\tpublic stopDebugging(session?: vscode.DebugSession): Promise<void> {\n\t\treturn this._debugServiceProxy.$stopDebugging(session ? session.id : undefined);\n\t}\n\n\tpublic registerDebugConfigurationProvider(type: string, provider: vscode.DebugConfigurationProvider, trigger: vscode.DebugConfigurationProviderTriggerKind): vscode.Disposable {\n\n\t\tif (!provider) {\n\t\t\treturn new Disposable(() => { });\n\t\t}\n\n\t\tconst handle = this._configProviderHandleCounter++;\n\t\tthis._configProviders.push({ type, handle, provider });\n\n\t\tthis._debugServiceProxy.$registerDebugConfigurationProvider(type, trigger,\n\t\t\t!!provider.provideDebugConfigurations,\n\t\t\t!!provider.resolveDebugConfiguration,\n\t\t\t!!provider.resolveDebugConfigurationWithSubstitutedVariables,\n\t\t\thandle);\n\n\t\treturn new Disposable(() => {\n\t\t\tthis._configProviders = this._configProviders.filter(p => p.provider !== provider);\t\t// remove\n\t\t\tthis._debugServiceProxy.$unregisterDebugConfigurationProvider(handle);\n\t\t});\n\t}\n\n\tpublic registerDebugAdapterDescriptorFactory(extension: IExtensionDescription, type: string, factory: vscode.DebugAdapterDescriptorFactory): vscode.Disposable {\n\n\t\tif (!factory) {\n\t\t\treturn new Disposable(() => { });\n\t\t}\n\n\t\t// a DebugAdapterDescriptorFactory can only be registered in the extension that contributes the debugger\n\t\tif (!this.definesDebugType(extension, type)) {\n\t\t\tthrow new Error(`a DebugAdapterDescriptorFactory can only be registered from the extension that defines the '${type}' debugger.`);\n\t\t}\n\n\t\t// make sure that only one factory for this type is registered\n\t\tif (this.getAdapterDescriptorFactoryByType(type)) {\n\t\t\tthrow new Error(`a DebugAdapterDescriptorFactory can only be registered once per a type.`);\n\t\t}\n\n\t\tconst handle = this._adapterFactoryHandleCounter++;\n\t\tthis._adapterFactories.push({ type, handle, factory });\n\n\t\tthis._debugServiceProxy.$registerDebugAdapterDescriptorFactory(type, handle);\n\n\t\treturn new Disposable(() => {\n\t\t\tthis._adapterFactories = this._adapterFactories.filter(p => p.factory !== factory);\t\t// remove\n\t\t\tthis._debugServiceProxy.$unregisterDebugAdapterDescriptorFactory(handle);\n\t\t});\n\t}\n\n\tpublic registerDebugAdapterTrackerFactory(type: string, factory: vscode.DebugAdapterTrackerFactory): vscode.Disposable {\n\n\t\tif (!factory) {\n\t\t\treturn new Disposable(() => { });\n\t\t}\n\n\t\tconst handle = this._trackerFactoryHandleCounter++;\n\t\tthis._trackerFactories.push({ type, handle, factory });\n\n\t\treturn new Disposable(() => {\n\t\t\tthis._trackerFactories = this._trackerFactories.filter(p => p.factory !== factory);\t\t// remove\n\t\t});\n\t}\n\n\t// RPC methods (ExtHostDebugServiceShape)\n\n\tpublic async $runInTerminal(args: DebugProtocol.RunInTerminalRequestArguments, sessionId: string): Promise<number | undefined> {\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\tpublic async $substituteVariables(folderUri: UriComponents | undefined, config: IConfig): Promise<IConfig> {\n\t\tlet ws: IWorkspaceFolder | undefined;\n\t\tconst folder = await this.getFolder(folderUri);\n\t\tif (folder) {\n\t\t\tws = {\n\t\t\t\turi: folder.uri,\n\t\t\t\tname: folder.name,\n\t\t\t\tindex: folder.index,\n\t\t\t\ttoResource: () => {\n\t\t\t\t\tthrow new Error('Not implemented');\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\tconst variableResolver = await this._variableResolver.getResolver();\n\t\treturn variableResolver.resolveAnyAsync(ws, config);\n\t}\n\n\tprotected createDebugAdapter(adapter: IAdapterDescriptor, session: ExtHostDebugSession): AbstractDebugAdapter | undefined {\n\t\tif (adapter.type === 'implementation') {\n\t\t\treturn new DirectDebugAdapter(adapter.implementation);\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprotected createSignService(): ISignService | undefined {\n\t\treturn undefined;\n\t}\n\n\tpublic async $startDASession(debugAdapterHandle: number, sessionDto: IDebugSessionDto): Promise<void> {\n\t\tconst mythis = this;\n\n\t\tconst session = await this.getSession(sessionDto);\n\n\t\treturn this.getAdapterDescriptor(this.getAdapterDescriptorFactoryByType(session.type), session).then(daDescriptor => {\n\n\t\t\tif (!daDescriptor) {\n\t\t\t\tthrow new Error(`Couldn't find a debug adapter descriptor for debug type '${session.type}' (extension might have failed to activate)`);\n\t\t\t}\n\n\t\t\tconst adapterDescriptor = this.convertToDto(daDescriptor);\n\n\t\t\tconst da = this.createDebugAdapter(adapterDescriptor, session);\n\t\t\tif (!da) {\n\t\t\t\tthrow new Error(`Couldn't create a debug adapter for type '${session.type}'.`);\n\t\t\t}\n\n\t\t\tconst debugAdapter = da;\n\n\t\t\tthis._debugAdapters.set(debugAdapterHandle, debugAdapter);\n\n\t\t\treturn this.getDebugAdapterTrackers(session).then(tracker => {\n\n\t\t\t\tif (tracker) {\n\t\t\t\t\tthis._debugAdaptersTrackers.set(debugAdapterHandle, tracker);\n\t\t\t\t}\n\n\t\t\t\tdebugAdapter.onMessage(async message => {\n\n\t\t\t\t\tif (message.type === 'request' && (<DebugProtocol.Request>message).command === 'handshake') {\n\n\t\t\t\t\t\tconst request = <DebugProtocol.Request>message;\n\n\t\t\t\t\t\tconst response: DebugProtocol.Response = {\n\t\t\t\t\t\t\ttype: 'response',\n\t\t\t\t\t\t\tseq: 0,\n\t\t\t\t\t\t\tcommand: request.command,\n\t\t\t\t\t\t\trequest_seq: request.seq,\n\t\t\t\t\t\t\tsuccess: true\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tif (!this._signService) {\n\t\t\t\t\t\t\tthis._signService = this.createSignService();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (this._signService) {\n\t\t\t\t\t\t\t\tconst signature = await this._signService.sign(request.arguments.value);\n\t\t\t\t\t\t\t\tresponse.body = {\n\t\t\t\t\t\t\t\t\tsignature: signature\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tdebugAdapter.sendResponse(response);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthrow new Error('no signer');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\tresponse.success = false;\n\t\t\t\t\t\t\tresponse.message = e.message;\n\t\t\t\t\t\t\tdebugAdapter.sendResponse(response);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (tracker && tracker.onDidSendMessage) {\n\t\t\t\t\t\t\ttracker.onDidSendMessage(message);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// DA -> VS Code\n\t\t\t\t\t\tmessage = convertToVSCPaths(message, true);\n\n\t\t\t\t\t\tmythis._debugServiceProxy.$acceptDAMessage(debugAdapterHandle, message);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tdebugAdapter.onError(err => {\n\t\t\t\t\tif (tracker && tracker.onError) {\n\t\t\t\t\t\ttracker.onError(err);\n\t\t\t\t\t}\n\t\t\t\t\tthis._debugServiceProxy.$acceptDAError(debugAdapterHandle, err.name, err.message, err.stack);\n\t\t\t\t});\n\t\t\t\tdebugAdapter.onExit((code: number | null) => {\n\t\t\t\t\tif (tracker && tracker.onExit) {\n\t\t\t\t\t\ttracker.onExit(withNullAsUndefined(code), undefined);\n\t\t\t\t\t}\n\t\t\t\t\tthis._debugServiceProxy.$acceptDAExit(debugAdapterHandle, withNullAsUndefined(code), undefined);\n\t\t\t\t});\n\n\t\t\t\tif (tracker && tracker.onWillStartSession) {\n\t\t\t\t\ttracker.onWillStartSession();\n\t\t\t\t}\n\n\t\t\t\treturn debugAdapter.startSession();\n\t\t\t});\n\t\t});\n\t}\n\n\tpublic $sendDAMessage(debugAdapterHandle: number, message: DebugProtocol.ProtocolMessage): void {\n\n\t\t// VS Code -> DA\n\t\tmessage = convertToDAPaths(message, false);\n\n\t\tconst tracker = this._debugAdaptersTrackers.get(debugAdapterHandle);\t// TODO@AW: same handle?\n\t\tif (tracker && tracker.onWillReceiveMessage) {\n\t\t\ttracker.onWillReceiveMessage(message);\n\t\t}\n\n\t\tconst da = this._debugAdapters.get(debugAdapterHandle);\n\t\tda?.sendMessage(message);\n\t}\n\n\tpublic $stopDASession(debugAdapterHandle: number): Promise<void> {\n\n\t\tconst tracker = this._debugAdaptersTrackers.get(debugAdapterHandle);\n\t\tthis._debugAdaptersTrackers.delete(debugAdapterHandle);\n\t\tif (tracker && tracker.onWillStopSession) {\n\t\t\ttracker.onWillStopSession();\n\t\t}\n\n\t\tconst da = this._debugAdapters.get(debugAdapterHandle);\n\t\tthis._debugAdapters.delete(debugAdapterHandle);\n\t\tif (da) {\n\t\t\treturn da.stopSession();\n\t\t} else {\n\t\t\treturn Promise.resolve(void 0);\n\t\t}\n\t}\n\n\tpublic $acceptBreakpointsDelta(delta: IBreakpointsDeltaDto): void {\n\n\t\tconst a: vscode.Breakpoint[] = [];\n\t\tconst r: vscode.Breakpoint[] = [];\n\t\tconst c: vscode.Breakpoint[] = [];\n\n\t\tif (delta.added) {\n\t\t\tfor (const bpd of delta.added) {\n\t\t\t\tconst id = bpd.id;\n\t\t\t\tif (id && !this._breakpoints.has(id)) {\n\t\t\t\t\tlet bp: vscode.Breakpoint;\n\t\t\t\t\tif (bpd.type === 'function') {\n\t\t\t\t\t\tbp = new FunctionBreakpoint(bpd.functionName, bpd.enabled, bpd.condition, bpd.hitCondition, bpd.logMessage);\n\t\t\t\t\t} else if (bpd.type === 'data') {\n\t\t\t\t\t\tbp = new DataBreakpoint(bpd.label, bpd.dataId, bpd.canPersist, bpd.enabled, bpd.hitCondition, bpd.condition, bpd.logMessage);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst uri = URI.revive(bpd.uri);\n\t\t\t\t\t\tbp = new SourceBreakpoint(new Location(uri, new Position(bpd.line, bpd.character)), bpd.enabled, bpd.condition, bpd.hitCondition, bpd.logMessage);\n\t\t\t\t\t}\n\t\t\t\t\t(bp as any)._id = id;\n\t\t\t\t\tthis._breakpoints.set(id, bp);\n\t\t\t\t\ta.push(bp);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (delta.removed) {\n\t\t\tfor (const id of delta.removed) {\n\t\t\t\tconst bp = this._breakpoints.get(id);\n\t\t\t\tif (bp) {\n\t\t\t\t\tthis._breakpoints.delete(id);\n\t\t\t\t\tr.push(bp);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (delta.changed) {\n\t\t\tfor (const bpd of delta.changed) {\n\t\t\t\tif (bpd.id) {\n\t\t\t\t\tconst bp = this._breakpoints.get(bpd.id);\n\t\t\t\t\tif (bp) {\n\t\t\t\t\t\tif (bp instanceof FunctionBreakpoint && bpd.type === 'function') {\n\t\t\t\t\t\t\tconst fbp = <any>bp;\n\t\t\t\t\t\t\tfbp.enabled = bpd.enabled;\n\t\t\t\t\t\t\tfbp.condition = bpd.condition;\n\t\t\t\t\t\t\tfbp.hitCondition = bpd.hitCondition;\n\t\t\t\t\t\t\tfbp.logMessage = bpd.logMessage;\n\t\t\t\t\t\t\tfbp.functionName = bpd.functionName;\n\t\t\t\t\t\t} else if (bp instanceof SourceBreakpoint && bpd.type === 'source') {\n\t\t\t\t\t\t\tconst sbp = <any>bp;\n\t\t\t\t\t\t\tsbp.enabled = bpd.enabled;\n\t\t\t\t\t\t\tsbp.condition = bpd.condition;\n\t\t\t\t\t\t\tsbp.hitCondition = bpd.hitCondition;\n\t\t\t\t\t\t\tsbp.logMessage = bpd.logMessage;\n\t\t\t\t\t\t\tsbp.location = new Location(URI.revive(bpd.uri), new Position(bpd.line, bpd.character));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tc.push(bp);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.fireBreakpointChanges(a, r, c);\n\t}\n\n\tpublic $provideDebugConfigurations(configProviderHandle: number, folderUri: UriComponents | undefined, token: CancellationToken): Promise<vscode.DebugConfiguration[]> {\n\t\treturn asPromise(async () => {\n\t\t\tconst provider = this.getConfigProviderByHandle(configProviderHandle);\n\t\t\tif (!provider) {\n\t\t\t\tthrow new Error('no DebugConfigurationProvider found');\n\t\t\t}\n\t\t\tif (!provider.provideDebugConfigurations) {\n\t\t\t\tthrow new Error('DebugConfigurationProvider has no method provideDebugConfigurations');\n\t\t\t}\n\t\t\tconst folder = await this.getFolder(folderUri);\n\t\t\treturn provider.provideDebugConfigurations(folder, token);\n\t\t}).then(debugConfigurations => {\n\t\t\tif (!debugConfigurations) {\n\t\t\t\tthrow new Error('nothing returned from DebugConfigurationProvider.provideDebugConfigurations');\n\t\t\t}\n\t\t\treturn debugConfigurations;\n\t\t});\n\t}\n\n\tpublic $resolveDebugConfiguration(configProviderHandle: number, folderUri: UriComponents | undefined, debugConfiguration: vscode.DebugConfiguration, token: CancellationToken): Promise<vscode.DebugConfiguration | null | undefined> {\n\t\treturn asPromise(async () => {\n\t\t\tconst provider = this.getConfigProviderByHandle(configProviderHandle);\n\t\t\tif (!provider) {\n\t\t\t\tthrow new Error('no DebugConfigurationProvider found');\n\t\t\t}\n\t\t\tif (!provider.resolveDebugConfiguration) {\n\t\t\t\tthrow new Error('DebugConfigurationProvider has no method resolveDebugConfiguration');\n\t\t\t}\n\t\t\tconst folder = await this.getFolder(folderUri);\n\t\t\treturn provider.resolveDebugConfiguration(folder, debugConfiguration, token);\n\t\t});\n\t}\n\n\tpublic $resolveDebugConfigurationWithSubstitutedVariables(configProviderHandle: number, folderUri: UriComponents | undefined, debugConfiguration: vscode.DebugConfiguration, token: CancellationToken): Promise<vscode.DebugConfiguration | null | undefined> {\n\t\treturn asPromise(async () => {\n\t\t\tconst provider = this.getConfigProviderByHandle(configProviderHandle);\n\t\t\tif (!provider) {\n\t\t\t\tthrow new Error('no DebugConfigurationProvider found');\n\t\t\t}\n\t\t\tif (!provider.resolveDebugConfigurationWithSubstitutedVariables) {\n\t\t\t\tthrow new Error('DebugConfigurationProvider has no method resolveDebugConfigurationWithSubstitutedVariables');\n\t\t\t}\n\t\t\tconst folder = await this.getFolder(folderUri);\n\t\t\treturn provider.resolveDebugConfigurationWithSubstitutedVariables(folder, debugConfiguration, token);\n\t\t});\n\t}\n\n\tpublic async $provideDebugAdapter(adapterFactoryHandle: number, sessionDto: IDebugSessionDto): Promise<Dto<IAdapterDescriptor>> {\n\t\tconst adapterDescriptorFactory = this.getAdapterDescriptorFactoryByHandle(adapterFactoryHandle);\n\t\tif (!adapterDescriptorFactory) {\n\t\t\treturn Promise.reject(new Error('no adapter descriptor factory found for handle'));\n\t\t}\n\t\tconst session = await this.getSession(sessionDto);\n\t\treturn this.getAdapterDescriptor(adapterDescriptorFactory, session).then(adapterDescriptor => {\n\t\t\tif (!adapterDescriptor) {\n\t\t\t\tthrow new Error(`Couldn't find a debug adapter descriptor for debug type '${session.type}'`);\n\t\t\t}\n\t\t\treturn this.convertToDto(adapterDescriptor);\n\t\t});\n\t}\n\n\tpublic async $acceptDebugSessionStarted(sessionDto: IDebugSessionDto): Promise<void> {\n\t\tconst session = await this.getSession(sessionDto);\n\t\tthis._onDidStartDebugSession.fire(session);\n\t}\n\n\tpublic async $acceptDebugSessionTerminated(sessionDto: IDebugSessionDto): Promise<void> {\n\t\tconst session = await this.getSession(sessionDto);\n\t\tif (session) {\n\t\t\tthis._onDidTerminateDebugSession.fire(session);\n\t\t\tthis._debugSessions.delete(session.id);\n\t\t}\n\t}\n\n\tpublic async $acceptDebugSessionActiveChanged(sessionDto: IDebugSessionDto | undefined): Promise<void> {\n\t\tthis._activeDebugSession = sessionDto ? await this.getSession(sessionDto) : undefined;\n\t\tthis._onDidChangeActiveDebugSession.fire(this._activeDebugSession);\n\t}\n\n\tpublic async $acceptDebugSessionNameChanged(sessionDto: IDebugSessionDto, name: string): Promise<void> {\n\t\tconst session = await this.getSession(sessionDto);\n\t\tsession?._acceptNameChanged(name);\n\t}\n\n\tpublic async $acceptDebugSessionCustomEvent(sessionDto: IDebugSessionDto, event: any): Promise<void> {\n\t\tconst session = await this.getSession(sessionDto);\n\t\tconst ee: vscode.DebugSessionCustomEvent = {\n\t\t\tsession: session,\n\t\t\tevent: event.event,\n\t\t\tbody: event.body\n\t\t};\n\t\tthis._onDidReceiveDebugSessionCustomEvent.fire(ee);\n\t}\n\n\t// private & dto helpers\n\n\tprivate convertToDto(x: vscode.DebugAdapterDescriptor): Dto<IAdapterDescriptor> {\n\n\t\tif (x instanceof DebugAdapterExecutable) {\n\t\t\treturn <IDebugAdapterExecutable>{\n\t\t\t\ttype: 'executable',\n\t\t\t\tcommand: x.command,\n\t\t\t\targs: x.args,\n\t\t\t\toptions: x.options\n\t\t\t};\n\t\t} else if (x instanceof DebugAdapterServer) {\n\t\t\treturn <IDebugAdapterServer>{\n\t\t\t\ttype: 'server',\n\t\t\t\tport: x.port,\n\t\t\t\thost: x.host\n\t\t\t};\n\t\t} else if (x instanceof DebugAdapterNamedPipeServer) {\n\t\t\treturn <IDebugAdapterNamedPipeServer>{\n\t\t\t\ttype: 'pipeServer',\n\t\t\t\tpath: x.path\n\t\t\t};\n\t\t} else if (x instanceof DebugAdapterInlineImplementation) {\n\t\t\treturn <Dto<IAdapterDescriptor>>{\n\t\t\t\ttype: 'implementation',\n\t\t\t\timplementation: x.implementation\n\t\t\t};\n\t\t} else {\n\t\t\tthrow new Error('convertToDto unexpected type');\n\t\t}\n\t}\n\n\tprivate getAdapterDescriptorFactoryByType(type: string): vscode.DebugAdapterDescriptorFactory | undefined {\n\t\tconst results = this._adapterFactories.filter(p => p.type === type);\n\t\tif (results.length > 0) {\n\t\t\treturn results[0].factory;\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprivate getAdapterDescriptorFactoryByHandle(handle: number): vscode.DebugAdapterDescriptorFactory | undefined {\n\t\tconst results = this._adapterFactories.filter(p => p.handle === handle);\n\t\tif (results.length > 0) {\n\t\t\treturn results[0].factory;\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprivate getConfigProviderByHandle(handle: number): vscode.DebugConfigurationProvider | undefined {\n\t\tconst results = this._configProviders.filter(p => p.handle === handle);\n\t\tif (results.length > 0) {\n\t\t\treturn results[0].provider;\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprivate definesDebugType(ed: IExtensionDescription, type: string) {\n\t\tif (ed.contributes) {\n\t\t\tconst debuggers = <IDebuggerContribution[]>ed.contributes['debuggers'];\n\t\t\tif (debuggers && debuggers.length > 0) {\n\t\t\t\tfor (const dbg of debuggers) {\n\t\t\t\t\t// only debugger contributions with a \"label\" are considered a \"defining\" debugger contribution\n\t\t\t\t\tif (dbg.label && dbg.type) {\n\t\t\t\t\t\tif (dbg.type === type) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate getDebugAdapterTrackers(session: ExtHostDebugSession): Promise<vscode.DebugAdapterTracker | undefined> {\n\n\t\tconst config = session.configuration;\n\t\tconst type = config.type;\n\n\t\tconst promises = this._trackerFactories\n\t\t\t.filter(tuple => tuple.type === type || tuple.type === '*')\n\t\t\t.map(tuple => asPromise<vscode.ProviderResult<vscode.DebugAdapterTracker>>(() => tuple.factory.createDebugAdapterTracker(session)).then(p => p, err => null));\n\n\t\treturn Promise.race([\n\t\t\tPromise.all(promises).then(result => {\n\t\t\t\tconst trackers = <vscode.DebugAdapterTracker[]>result.filter(t => !!t);\t// filter null\n\t\t\t\tif (trackers.length > 0) {\n\t\t\t\t\treturn new MultiTracker(trackers);\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t}),\n\t\t\tnew Promise<never>((resolve, reject) => {\n\t\t\t\tconst timeout = setTimeout(() => {\n\t\t\t\t\tclearTimeout(timeout);\n\t\t\t\t\treject(new Error('timeout'));\n\t\t\t\t}, 1000);\n\t\t\t})\n\t\t]).catch(err => {\n\t\t\t// ignore errors\n\t\t\treturn undefined;\n\t\t});\n\t}\n\n\tprivate async getAdapterDescriptor(adapterDescriptorFactory: vscode.DebugAdapterDescriptorFactory | undefined, session: ExtHostDebugSession): Promise<vscode.DebugAdapterDescriptor | undefined> {\n\n\t\t// a \"debugServer\" attribute in the launch config takes precedence\n\t\tconst serverPort = session.configuration.debugServer;\n\t\tif (typeof serverPort === 'number') {\n\t\t\treturn Promise.resolve(new DebugAdapterServer(serverPort));\n\t\t}\n\n\t\tif (adapterDescriptorFactory) {\n\t\t\tconst extensionRegistry = await this._extensionService.getExtensionRegistry();\n\t\t\treturn asPromise(() => adapterDescriptorFactory.createDebugAdapterDescriptor(session, this.daExecutableFromPackage(session, extensionRegistry))).then(daDescriptor => {\n\t\t\t\tif (daDescriptor) {\n\t\t\t\t\treturn daDescriptor;\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t});\n\t\t}\n\n\t\t// fallback: use executable information from package.json\n\t\tconst extensionRegistry = await this._extensionService.getExtensionRegistry();\n\t\treturn Promise.resolve(this.daExecutableFromPackage(session, extensionRegistry));\n\t}\n\n\tprotected daExecutableFromPackage(session: ExtHostDebugSession, extensionRegistry: ExtensionDescriptionRegistry): DebugAdapterExecutable | undefined {\n\t\treturn undefined;\n\t}\n\n\tprivate startBreakpoints() {\n\t\tif (!this._breakpointEventsActive) {\n\t\t\tthis._breakpointEventsActive = true;\n\t\t\tthis._debugServiceProxy.$startBreakpointEvents();\n\t\t}\n\t}\n\n\tprivate fireBreakpointChanges(added: vscode.Breakpoint[], removed: vscode.Breakpoint[], changed: vscode.Breakpoint[]) {\n\t\tif (added.length > 0 || removed.length > 0 || changed.length > 0) {\n\t\t\tthis._onDidChangeBreakpoints.fire(Object.freeze({\n\t\t\t\tadded,\n\t\t\t\tremoved,\n\t\t\t\tchanged,\n\t\t\t}));\n\t\t}\n\t}\n\n\tprivate async getSession(dto: IDebugSessionDto): Promise<ExtHostDebugSession> {\n\t\tif (dto) {\n\t\t\tif (typeof dto === 'string') {\n\t\t\t\tconst ds = this._debugSessions.get(dto);\n\t\t\t\tif (ds) {\n\t\t\t\t\treturn ds;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tlet ds = this._debugSessions.get(dto.id);\n\t\t\t\tif (!ds) {\n\t\t\t\t\tconst folder = await this.getFolder(dto.folderUri);\n\t\t\t\t\tconst parent = dto.parent ? this._debugSessions.get(dto.parent) : undefined;\n\t\t\t\t\tds = new ExtHostDebugSession(this._debugServiceProxy, dto.id, dto.type, dto.name, folder, dto.configuration, parent);\n\t\t\t\t\tthis._debugSessions.set(ds.id, ds);\n\t\t\t\t\tthis._debugServiceProxy.$sessionCached(ds.id);\n\t\t\t\t}\n\t\t\t\treturn ds;\n\t\t\t}\n\t\t}\n\t\tthrow new Error('cannot find session');\n\t}\n\n\tprivate getFolder(_folderUri: UriComponents | undefined): Promise<vscode.WorkspaceFolder | undefined> {\n\t\tif (_folderUri) {\n\t\t\tconst folderURI = URI.revive(_folderUri);\n\t\t\treturn this._workspaceService.resolveWorkspaceFolder(folderURI);\n\t\t}\n\t\treturn Promise.resolve(undefined);\n\t}\n}\n\nexport class ExtHostDebugSession implements vscode.DebugSession {\n\n\tconstructor(\n\t\tprivate _debugServiceProxy: MainThreadDebugServiceShape,\n\t\tprivate _id: DebugSessionUUID,\n\t\tprivate _type: string,\n\t\tprivate _name: string,\n\t\tprivate _workspaceFolder: vscode.WorkspaceFolder | undefined,\n\t\tprivate _configuration: vscode.DebugConfiguration,\n\t\tprivate _parentSession: vscode.DebugSession | undefined) {\n\t}\n\n\tpublic get id(): string {\n\t\treturn this._id;\n\t}\n\n\tpublic get type(): string {\n\t\treturn this._type;\n\t}\n\n\tpublic get name(): string {\n\t\treturn this._name;\n\t}\n\tpublic set name(name: string) {\n\t\tthis._name = name;\n\t\tthis._debugServiceProxy.$setDebugSessionName(this._id, name);\n\t}\n\n\tpublic get parentSession(): vscode.DebugSession | undefined {\n\t\treturn this._parentSession;\n\t}\n\n\t_acceptNameChanged(name: string) {\n\t\tthis._name = name;\n\t}\n\n\tpublic get workspaceFolder(): vscode.WorkspaceFolder | undefined {\n\t\treturn this._workspaceFolder;\n\t}\n\n\tpublic get configuration(): vscode.DebugConfiguration {\n\t\treturn this._configuration;\n\t}\n\n\tpublic customRequest(command: string, args: any): Promise<any> {\n\t\treturn this._debugServiceProxy.$customDebugAdapterRequest(this._id, command, args);\n\t}\n\n\tpublic getDebugProtocolBreakpoint(breakpoint: vscode.Breakpoint): Promise<vscode.DebugProtocolBreakpoint | undefined> {\n\t\treturn this._debugServiceProxy.$getDebugProtocolBreakpoint(this._id, breakpoint.id);\n\t}\n}\n\nexport class ExtHostDebugConsole {\n\n\treadonly value: vscode.DebugConsole;\n\n\tconstructor(proxy: MainThreadDebugServiceShape) {\n\n\t\tthis.value = Object.freeze({\n\t\t\tappend(value: string): void {\n\t\t\t\tproxy.$appendDebugConsole(value);\n\t\t\t},\n\t\t\tappendLine(value: string): void {\n\t\t\t\tthis.append(value + '\\n');\n\t\t\t}\n\t\t});\n\t}\n}\n\ninterface ConfigProviderTuple {\n\ttype: string;\n\thandle: number;\n\tprovider: vscode.DebugConfigurationProvider;\n}\n\ninterface DescriptorFactoryTuple {\n\ttype: string;\n\thandle: number;\n\tfactory: vscode.DebugAdapterDescriptorFactory;\n}\n\ninterface TrackerFactoryTuple {\n\ttype: string;\n\thandle: number;\n\tfactory: vscode.DebugAdapterTrackerFactory;\n}\n\nclass MultiTracker implements vscode.DebugAdapterTracker {\n\n\tconstructor(private trackers: vscode.DebugAdapterTracker[]) {\n\t}\n\n\tonWillStartSession(): void {\n\t\tthis.trackers.forEach(t => t.onWillStartSession ? t.onWillStartSession() : undefined);\n\t}\n\n\tonWillReceiveMessage(message: any): void {\n\t\tthis.trackers.forEach(t => t.onWillReceiveMessage ? t.onWillReceiveMessage(message) : undefined);\n\t}\n\n\tonDidSendMessage(message: any): void {\n\t\tthis.trackers.forEach(t => t.onDidSendMessage ? t.onDidSendMessage(message) : undefined);\n\t}\n\n\tonWillStopSession(): void {\n\t\tthis.trackers.forEach(t => t.onWillStopSession ? t.onWillStopSession() : undefined);\n\t}\n\n\tonError(error: Error): void {\n\t\tthis.trackers.forEach(t => t.onError ? t.onError(error) : undefined);\n\t}\n\n\tonExit(code: number, signal: string): void {\n\t\tthis.trackers.forEach(t => t.onExit ? t.onExit(code, signal) : undefined);\n\t}\n}\n\n/*\n * Call directly into a debug adapter implementation\n */\nclass DirectDebugAdapter extends AbstractDebugAdapter {\n\n\tconstructor(private implementation: vscode.DebugAdapter) {\n\t\tsuper();\n\n\t\timplementation.onDidSendMessage((message: vscode.DebugProtocolMessage) => {\n\t\t\tthis.acceptMessage(message as DebugProtocol.ProtocolMessage);\n\t\t});\n\t}\n\n\tstartSession(): Promise<void> {\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\tsendMessage(message: DebugProtocol.ProtocolMessage): void {\n\t\tthis.implementation.handleMessage(message);\n\t}\n\n\tstopSession(): Promise<void> {\n\t\tthis.implementation.dispose();\n\t\treturn Promise.resolve(undefined);\n\t}\n}\n\n\nexport class WorkerExtHostDebugService extends ExtHostDebugServiceBase {\n\tconstructor(\n\t\t@IExtHostRpcService extHostRpcService: IExtHostRpcService,\n\t\t@IExtHostWorkspace workspaceService: IExtHostWorkspace,\n\t\t@IExtHostExtensionService extensionService: IExtHostExtensionService,\n\t\t@IExtHostConfiguration configurationService: IExtHostConfiguration,\n\t\t@IExtHostEditorTabs editorTabs: IExtHostEditorTabs,\n\t\t@IExtHostVariableResolverProvider variableResolver: IExtHostVariableResolverProvider\n\t) {\n\t\tsuper(extHostRpcService, workspaceService, extensionService, configurationService, editorTabs, variableResolver);\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as errors from 'vs/base/common/errors';\nimport * as performance from 'vs/base/common/performance';\nimport { URI } from 'vs/base/common/uri';\nimport { IURITransformer } from 'vs/base/common/uriIpc';\nimport { IMessagePassingProtocol } from 'vs/base/parts/ipc/common/ipc';\nimport { MainContext, MainThreadConsoleShape } from 'vs/workbench/api/common/extHost.protocol';\nimport { IExtensionHostInitData } from 'vs/workbench/services/extensions/common/extensionHostProtocol';\nimport { RPCProtocol } from 'vs/workbench/services/extensions/common/rpcProtocol';\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { getSingletonServiceDescriptors } from 'vs/platform/instantiation/common/extensions';\nimport { ServiceCollection } from 'vs/platform/instantiation/common/serviceCollection';\nimport { IExtHostInitDataService } from 'vs/workbench/api/common/extHostInitDataService';\nimport { InstantiationService } from 'vs/platform/instantiation/common/instantiationService';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { IExtHostRpcService, ExtHostRpcService } from 'vs/workbench/api/common/extHostRpcService';\nimport { IURITransformerService, URITransformerService } from 'vs/workbench/api/common/extHostUriTransformerService';\nimport { IExtHostExtensionService, IHostUtils } from 'vs/workbench/api/common/extHostExtensionService';\n\nexport interface IExitFn {\n\t(code?: number): any;\n}\n\nexport interface IConsolePatchFn {\n\t(mainThreadConsole: MainThreadConsoleShape): any;\n}\n\nexport class ExtensionHostMain {\n\n\tprivate readonly _hostUtils: IHostUtils;\n\tprivate readonly _rpcProtocol: RPCProtocol;\n\tprivate readonly _extensionService: IExtHostExtensionService;\n\tprivate readonly _logService: ILogService;\n\n\tconstructor(\n\t\tprotocol: IMessagePassingProtocol,\n\t\tinitData: IExtensionHostInitData,\n\t\thostUtils: IHostUtils,\n\t\turiTransformer: IURITransformer | null,\n\t\tmessagePorts?: ReadonlyMap<string, MessagePort>\n\t) {\n\t\tthis._hostUtils = hostUtils;\n\t\tthis._rpcProtocol = new RPCProtocol(protocol, null, uriTransformer);\n\n\t\t// ensure URIs are transformed and revived\n\t\tinitData = ExtensionHostMain._transform(initData, this._rpcProtocol);\n\n\t\t// bootstrap services\n\t\tconst services = new ServiceCollection(...getSingletonServiceDescriptors());\n\t\tservices.set(IExtHostInitDataService, { _serviceBrand: undefined, ...initData, messagePorts });\n\t\tservices.set(IExtHostRpcService, new ExtHostRpcService(this._rpcProtocol));\n\t\tservices.set(IURITransformerService, new URITransformerService(uriTransformer));\n\t\tservices.set(IHostUtils, hostUtils);\n\n\t\tconst instaService: IInstantiationService = new InstantiationService(services, true);\n\n\t\t// ugly self - inject\n\t\tthis._logService = instaService.invokeFunction(accessor => accessor.get(ILogService));\n\n\t\tperformance.mark(`code/extHost/didCreateServices`);\n\t\tif (this._hostUtils.pid) {\n\t\t\tthis._logService.info(`Extension host with pid ${this._hostUtils.pid} started`);\n\t\t} else {\n\t\t\tthis._logService.info(`Extension host started`);\n\t\t}\n\t\tthis._logService.trace('initData', initData);\n\n\t\t// ugly self - inject\n\t\t// must call initialize *after* creating the extension service\n\t\t// because `initialize` itself creates instances that depend on it\n\t\tthis._extensionService = instaService.invokeFunction(accessor => accessor.get(IExtHostExtensionService));\n\t\tthis._extensionService.initialize();\n\n\t\t// error forwarding and stack trace scanning\n\t\tError.stackTraceLimit = 100; // increase number of stack frames (from 10, https://github.com/v8/v8/wiki/Stack-Trace-API)\n\t\tconst extensionErrors = new WeakMap<Error, IExtensionDescription | undefined>();\n\t\tthis._extensionService.getExtensionPathIndex().then(map => {\n\t\t\t(<any>Error).prepareStackTrace = (error: Error, stackTrace: errors.V8CallSite[]) => {\n\t\t\t\tlet stackTraceMessage = '';\n\t\t\t\tlet extension: IExtensionDescription | undefined;\n\t\t\t\tlet fileName: string;\n\t\t\t\tfor (const call of stackTrace) {\n\t\t\t\t\tstackTraceMessage += `\\n\\tat ${call.toString()}`;\n\t\t\t\t\tfileName = call.getFileName();\n\t\t\t\t\tif (!extension && fileName) {\n\t\t\t\t\t\textension = map.findSubstr(URI.file(fileName));\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\textensionErrors.set(error, extension);\n\t\t\t\treturn `${error.name || 'Error'}: ${error.message || ''}${stackTraceMessage}`;\n\t\t\t};\n\t\t});\n\n\t\tconst mainThreadExtensions = this._rpcProtocol.getProxy(MainContext.MainThreadExtensionService);\n\t\tconst mainThreadErrors = this._rpcProtocol.getProxy(MainContext.MainThreadErrors);\n\t\terrors.setUnexpectedErrorHandler(err => {\n\t\t\tconst data = errors.transformErrorForSerialization(err);\n\t\t\tconst extension = extensionErrors.get(err);\n\t\t\tif (extension) {\n\t\t\t\tmainThreadExtensions.$onExtensionRuntimeError(extension.identifier, data);\n\t\t\t} else {\n\t\t\t\tmainThreadErrors.$onUnexpectedError(data);\n\t\t\t}\n\t\t});\n\t}\n\n\tasync asBrowserUri(uri: URI): Promise<URI> {\n\t\tconst mainThreadExtensionsProxy = this._rpcProtocol.getProxy(MainContext.MainThreadExtensionService);\n\t\treturn URI.revive(await mainThreadExtensionsProxy.$asBrowserUri(uri));\n\t}\n\n\tterminate(reason: string): void {\n\t\tthis._extensionService.terminate(reason);\n\t}\n\n\tprivate static _transform(initData: IExtensionHostInitData, rpcProtocol: RPCProtocol): IExtensionHostInitData {\n\t\tinitData.allExtensions.forEach((ext) => (<any>ext).extensionLocation = URI.revive(rpcProtocol.transformIncomingURIs(ext.extensionLocation)));\n\t\tinitData.environment.appRoot = URI.revive(rpcProtocol.transformIncomingURIs(initData.environment.appRoot));\n\t\tconst extDevLocs = initData.environment.extensionDevelopmentLocationURI;\n\t\tif (extDevLocs) {\n\t\t\tinitData.environment.extensionDevelopmentLocationURI = extDevLocs.map(url => URI.revive(rpcProtocol.transformIncomingURIs(url)));\n\t\t}\n\t\tinitData.environment.extensionTestsLocationURI = URI.revive(rpcProtocol.transformIncomingURIs(initData.environment.extensionTestsLocationURI));\n\t\tinitData.environment.globalStorageHome = URI.revive(rpcProtocol.transformIncomingURIs(initData.environment.globalStorageHome));\n\t\tinitData.environment.workspaceStorageHome = URI.revive(rpcProtocol.transformIncomingURIs(initData.environment.workspaceStorageHome));\n\t\tinitData.logsLocation = URI.revive(rpcProtocol.transformIncomingURIs(initData.logsLocation));\n\t\tinitData.logFile = URI.revive(rpcProtocol.transformIncomingURIs(initData.logFile));\n\t\tinitData.workspace = rpcProtocol.transformIncomingURIs(initData.workspace);\n\t\treturn initData;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { flatten, mapArrayOrNot } from 'vs/base/common/arrays';\nimport { isThenable } from 'vs/base/common/async';\nimport { CancellationToken, CancellationTokenSource } from 'vs/base/common/cancellation';\nimport { toErrorMessage } from 'vs/base/common/errorMessage';\nimport { Schemas } from 'vs/base/common/network';\nimport * as path from 'vs/base/common/path';\nimport * as resources from 'vs/base/common/resources';\nimport { isArray } from 'vs/base/common/types';\nimport { URI } from 'vs/base/common/uri';\nimport { hasSiblingPromiseFn, IExtendedExtensionSearchOptions, IFileMatch, IFolderQuery, IPatternInfo, ISearchCompleteStats, ITextQuery, ITextSearchContext, ITextSearchMatch, ITextSearchResult, ITextSearchStats, QueryGlobTester, resolvePatternsForProvider } from 'vs/workbench/services/search/common/search';\nimport { Range, TextSearchComplete, TextSearchMatch, TextSearchOptions, TextSearchProvider, TextSearchQuery, TextSearchResult } from 'vs/workbench/services/search/common/searchExtTypes';\n\nexport interface IFileUtils {\n\treaddir: (resource: URI) => Promise<string[]>;\n\ttoCanonicalName: (encoding: string) => string;\n}\n\nexport class TextSearchManager {\n\n\tprivate collector: TextSearchResultsCollector | null = null;\n\n\tprivate isLimitHit = false;\n\tprivate resultCount = 0;\n\n\tconstructor(private query: ITextQuery, private provider: TextSearchProvider, private fileUtils: IFileUtils, private processType: ITextSearchStats['type']) { }\n\n\tsearch(onProgress: (matches: IFileMatch[]) => void, token: CancellationToken): Promise<ISearchCompleteStats> {\n\t\tconst folderQueries = this.query.folderQueries || [];\n\t\tconst tokenSource = new CancellationTokenSource();\n\t\ttoken.onCancellationRequested(() => tokenSource.cancel());\n\n\t\treturn new Promise<ISearchCompleteStats>((resolve, reject) => {\n\t\t\tthis.collector = new TextSearchResultsCollector(onProgress);\n\n\t\t\tlet isCanceled = false;\n\t\t\tconst onResult = (result: TextSearchResult, folderIdx: number) => {\n\t\t\t\tif (isCanceled) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!this.isLimitHit) {\n\t\t\t\t\tconst resultSize = this.resultSize(result);\n\t\t\t\t\tif (extensionResultIsMatch(result) && typeof this.query.maxResults === 'number' && this.resultCount + resultSize > this.query.maxResults) {\n\t\t\t\t\t\tthis.isLimitHit = true;\n\t\t\t\t\t\tisCanceled = true;\n\t\t\t\t\t\ttokenSource.cancel();\n\n\t\t\t\t\t\tresult = this.trimResultToSize(result, this.query.maxResults - this.resultCount);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst newResultSize = this.resultSize(result);\n\t\t\t\t\tthis.resultCount += newResultSize;\n\t\t\t\t\tif (newResultSize > 0 || !extensionResultIsMatch(result)) {\n\t\t\t\t\t\tthis.collector!.add(result, folderIdx);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// For each root folder\n\t\t\tPromise.all(folderQueries.map((fq, i) => {\n\t\t\t\treturn this.searchInFolder(fq, r => onResult(r, i), tokenSource.token);\n\t\t\t})).then(results => {\n\t\t\t\ttokenSource.dispose();\n\t\t\t\tthis.collector!.flush();\n\n\t\t\t\tconst someFolderHitLImit = results.some(result => !!result && !!result.limitHit);\n\t\t\t\tresolve({\n\t\t\t\t\tlimitHit: this.isLimitHit || someFolderHitLImit,\n\t\t\t\t\tmessages: flatten(results.map(result => {\n\t\t\t\t\t\tif (!result?.message) { return []; }\n\t\t\t\t\t\tif (isArray(result.message)) { return result.message; }\n\t\t\t\t\t\telse { return [result.message]; }\n\t\t\t\t\t})),\n\t\t\t\t\tstats: {\n\t\t\t\t\t\ttype: this.processType\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}, (err: Error) => {\n\t\t\t\ttokenSource.dispose();\n\t\t\t\tconst errMsg = toErrorMessage(err);\n\t\t\t\treject(new Error(errMsg));\n\t\t\t});\n\t\t});\n\t}\n\n\tprivate resultSize(result: TextSearchResult): number {\n\t\tif (extensionResultIsMatch(result)) {\n\t\t\treturn Array.isArray(result.ranges) ?\n\t\t\t\tresult.ranges.length :\n\t\t\t\t1;\n\t\t}\n\t\telse {\n\t\t\t// #104400 context lines shoudn't count towards result count\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\tprivate trimResultToSize(result: TextSearchMatch, size: number): TextSearchMatch {\n\t\tconst rangesArr = Array.isArray(result.ranges) ? result.ranges : [result.ranges];\n\t\tconst matchesArr = Array.isArray(result.preview.matches) ? result.preview.matches : [result.preview.matches];\n\n\t\treturn {\n\t\t\tranges: rangesArr.slice(0, size),\n\t\t\tpreview: {\n\t\t\t\tmatches: matchesArr.slice(0, size),\n\t\t\t\ttext: result.preview.text\n\t\t\t},\n\t\t\turi: result.uri\n\t\t};\n\t}\n\n\tprivate async searchInFolder(folderQuery: IFolderQuery<URI>, onResult: (result: TextSearchResult) => void, token: CancellationToken): Promise<TextSearchComplete | null | undefined> {\n\t\tconst queryTester = new QueryGlobTester(this.query, folderQuery);\n\t\tconst testingPs: Promise<void>[] = [];\n\t\tconst progress = {\n\t\t\treport: (result: TextSearchResult) => {\n\t\t\t\tif (!this.validateProviderResult(result)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst hasSibling = folderQuery.folder.scheme === Schemas.file ?\n\t\t\t\t\thasSiblingPromiseFn(() => {\n\t\t\t\t\t\treturn this.fileUtils.readdir(resources.dirname(result.uri));\n\t\t\t\t\t}) :\n\t\t\t\t\tundefined;\n\n\t\t\t\tconst relativePath = resources.relativePath(folderQuery.folder, result.uri);\n\t\t\t\tif (relativePath) {\n\t\t\t\t\t// This method is only async when the exclude contains sibling clauses\n\t\t\t\t\tconst included = queryTester.includedInQuery(relativePath, path.basename(relativePath), hasSibling);\n\t\t\t\t\tif (isThenable(included)) {\n\t\t\t\t\t\ttestingPs.push(\n\t\t\t\t\t\t\tincluded.then(isIncluded => {\n\t\t\t\t\t\t\t\tif (isIncluded) {\n\t\t\t\t\t\t\t\t\tonResult(result);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t} else if (included) {\n\t\t\t\t\t\tonResult(result);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tconst searchOptions = this.getSearchOptionsForFolder(folderQuery);\n\t\tconst result = await this.provider.provideTextSearchResults(patternInfoToQuery(this.query.contentPattern), searchOptions, progress, token);\n\t\tif (testingPs.length) {\n\t\t\tawait Promise.all(testingPs);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprivate validateProviderResult(result: TextSearchResult): boolean {\n\t\tif (extensionResultIsMatch(result)) {\n\t\t\tif (Array.isArray(result.ranges)) {\n\t\t\t\tif (!Array.isArray(result.preview.matches)) {\n\t\t\t\t\tconsole.warn('INVALID - A text search provider match\\'s`ranges` and`matches` properties must have the same type.');\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif ((<Range[]>result.preview.matches).length !== result.ranges.length) {\n\t\t\t\t\tconsole.warn('INVALID - A text search provider match\\'s`ranges` and`matches` properties must have the same length.');\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (Array.isArray(result.preview.matches)) {\n\t\t\t\t\tconsole.warn('INVALID - A text search provider match\\'s`ranges` and`matches` properties must have the same length.');\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tprivate getSearchOptionsForFolder(fq: IFolderQuery<URI>): TextSearchOptions {\n\t\tconst includes = resolvePatternsForProvider(this.query.includePattern, fq.includePattern);\n\t\tconst excludes = resolvePatternsForProvider(this.query.excludePattern, fq.excludePattern);\n\n\t\tconst options = <TextSearchOptions>{\n\t\t\tfolder: URI.from(fq.folder),\n\t\t\texcludes,\n\t\t\tincludes,\n\t\t\tuseIgnoreFiles: !fq.disregardIgnoreFiles,\n\t\t\tuseGlobalIgnoreFiles: !fq.disregardGlobalIgnoreFiles,\n\t\t\tuseParentIgnoreFiles: !fq.disregardParentIgnoreFiles,\n\t\t\tfollowSymlinks: !fq.ignoreSymlinks,\n\t\t\tencoding: fq.fileEncoding && this.fileUtils.toCanonicalName(fq.fileEncoding),\n\t\t\tmaxFileSize: this.query.maxFileSize,\n\t\t\tmaxResults: this.query.maxResults,\n\t\t\tpreviewOptions: this.query.previewOptions,\n\t\t\tafterContext: this.query.afterContext,\n\t\t\tbeforeContext: this.query.beforeContext\n\t\t};\n\t\t(<IExtendedExtensionSearchOptions>options).usePCRE2 = this.query.usePCRE2;\n\t\treturn options;\n\t}\n}\n\nfunction patternInfoToQuery(patternInfo: IPatternInfo): TextSearchQuery {\n\treturn <TextSearchQuery>{\n\t\tisCaseSensitive: patternInfo.isCaseSensitive || false,\n\t\tisRegExp: patternInfo.isRegExp || false,\n\t\tisWordMatch: patternInfo.isWordMatch || false,\n\t\tisMultiline: patternInfo.isMultiline || false,\n\t\tpattern: patternInfo.pattern\n\t};\n}\n\nexport class TextSearchResultsCollector {\n\tprivate _batchedCollector: BatchedCollector<IFileMatch>;\n\n\tprivate _currentFolderIdx: number = -1;\n\tprivate _currentUri: URI | undefined;\n\tprivate _currentFileMatch: IFileMatch | null = null;\n\n\tconstructor(private _onResult: (result: IFileMatch[]) => void) {\n\t\tthis._batchedCollector = new BatchedCollector<IFileMatch>(512, items => this.sendItems(items));\n\t}\n\n\tadd(data: TextSearchResult, folderIdx: number): void {\n\t\t// Collects TextSearchResults into IInternalFileMatches and collates using BatchedCollector.\n\t\t// This is efficient for ripgrep which sends results back one file at a time. It wouldn't be efficient for other search\n\t\t// providers that send results in random order. We could do this step afterwards instead.\n\t\tif (this._currentFileMatch && (this._currentFolderIdx !== folderIdx || !resources.isEqual(this._currentUri, data.uri))) {\n\t\t\tthis.pushToCollector();\n\t\t\tthis._currentFileMatch = null;\n\t\t}\n\n\t\tif (!this._currentFileMatch) {\n\t\t\tthis._currentFolderIdx = folderIdx;\n\t\t\tthis._currentFileMatch = {\n\t\t\t\tresource: data.uri,\n\t\t\t\tresults: []\n\t\t\t};\n\t\t}\n\n\t\tthis._currentFileMatch.results!.push(extensionResultToFrontendResult(data));\n\t}\n\n\tprivate pushToCollector(): void {\n\t\tconst size = this._currentFileMatch && this._currentFileMatch.results ?\n\t\t\tthis._currentFileMatch.results.length :\n\t\t\t0;\n\t\tthis._batchedCollector.addItem(this._currentFileMatch!, size);\n\t}\n\n\tflush(): void {\n\t\tthis.pushToCollector();\n\t\tthis._batchedCollector.flush();\n\t}\n\n\tprivate sendItems(items: IFileMatch[]): void {\n\t\tthis._onResult(items);\n\t}\n}\n\nfunction extensionResultToFrontendResult(data: TextSearchResult): ITextSearchResult {\n\t// Warning: result from RipgrepTextSearchEH has fake Range. Don't depend on any other props beyond these...\n\tif (extensionResultIsMatch(data)) {\n\t\treturn <ITextSearchMatch>{\n\t\t\tpreview: {\n\t\t\t\tmatches: mapArrayOrNot(data.preview.matches, m => ({\n\t\t\t\t\tstartLineNumber: m.start.line,\n\t\t\t\t\tstartColumn: m.start.character,\n\t\t\t\t\tendLineNumber: m.end.line,\n\t\t\t\t\tendColumn: m.end.character\n\t\t\t\t})),\n\t\t\t\ttext: data.preview.text\n\t\t\t},\n\t\t\tranges: mapArrayOrNot(data.ranges, r => ({\n\t\t\t\tstartLineNumber: r.start.line,\n\t\t\t\tstartColumn: r.start.character,\n\t\t\t\tendLineNumber: r.end.line,\n\t\t\t\tendColumn: r.end.character\n\t\t\t}))\n\t\t};\n\t} else {\n\t\treturn <ITextSearchContext>{\n\t\t\ttext: data.text,\n\t\t\tlineNumber: data.lineNumber\n\t\t};\n\t}\n}\n\nexport function extensionResultIsMatch(data: TextSearchResult): data is TextSearchMatch {\n\treturn !!(<TextSearchMatch>data).preview;\n}\n\n/**\n * Collects items that have a size - before the cumulative size of collected items reaches START_BATCH_AFTER_COUNT, the callback is called for every\n * set of items collected.\n * But after that point, the callback is called with batches of maxBatchSize.\n * If the batch isn't filled within some time, the callback is also called.\n */\nexport class BatchedCollector<T> {\n\tprivate static readonly TIMEOUT = 4000;\n\n\t// After START_BATCH_AFTER_COUNT items have been collected, stop flushing on timeout\n\tprivate static readonly START_BATCH_AFTER_COUNT = 50;\n\n\tprivate totalNumberCompleted = 0;\n\tprivate batch: T[] = [];\n\tprivate batchSize = 0;\n\tprivate timeoutHandle: any;\n\n\tconstructor(private maxBatchSize: number, private cb: (items: T[]) => void) {\n\t}\n\n\taddItem(item: T, size: number): void {\n\t\tif (!item) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.addItemToBatch(item, size);\n\t}\n\n\taddItems(items: T[], size: number): void {\n\t\tif (!items) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.addItemsToBatch(items, size);\n\t}\n\n\tprivate addItemToBatch(item: T, size: number): void {\n\t\tthis.batch.push(item);\n\t\tthis.batchSize += size;\n\t\tthis.onUpdate();\n\t}\n\n\tprivate addItemsToBatch(item: T[], size: number): void {\n\t\tthis.batch = this.batch.concat(item);\n\t\tthis.batchSize += size;\n\t\tthis.onUpdate();\n\t}\n\n\tprivate onUpdate(): void {\n\t\tif (this.totalNumberCompleted < BatchedCollector.START_BATCH_AFTER_COUNT) {\n\t\t\t// Flush because we aren't batching yet\n\t\t\tthis.flush();\n\t\t} else if (this.batchSize >= this.maxBatchSize) {\n\t\t\t// Flush because the batch is full\n\t\t\tthis.flush();\n\t\t} else if (!this.timeoutHandle) {\n\t\t\t// No timeout running, start a timeout to flush\n\t\t\tthis.timeoutHandle = setTimeout(() => {\n\t\t\t\tthis.flush();\n\t\t\t}, BatchedCollector.TIMEOUT);\n\t\t}\n\t}\n\n\tflush(): void {\n\t\tif (this.batchSize) {\n\t\t\tthis.totalNumberCompleted += this.batchSize;\n\t\t\tthis.cb(this.batch);\n\t\t\tthis.batch = [];\n\t\t\tthis.batchSize = 0;\n\n\t\t\tif (this.timeoutHandle) {\n\t\t\t\tclearTimeout(this.timeoutHandle);\n\t\t\t\tthis.timeoutHandle = 0;\n\t\t\t}\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IDisposable, toDisposable } from 'vs/base/common/lifecycle';\nimport type * as vscode from 'vscode';\nimport { ExtHostSearchShape, MainThreadSearchShape, MainContext } from '../common/extHost.protocol';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { FileSearchManager } from 'vs/workbench/services/search/common/fileSearchManager';\nimport { IExtHostRpcService } from 'vs/workbench/api/common/extHostRpcService';\nimport { IURITransformerService } from 'vs/workbench/api/common/extHostUriTransformerService';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { IRawFileQuery, ISearchCompleteStats, IFileQuery, IRawTextQuery, IRawQuery, ITextQuery, IFolderQuery } from 'vs/workbench/services/search/common/search';\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { TextSearchManager } from 'vs/workbench/services/search/common/textSearchManager';\n\nexport interface IExtHostSearch extends ExtHostSearchShape {\n\tregisterTextSearchProvider(scheme: string, provider: vscode.TextSearchProvider): IDisposable;\n\tregisterFileSearchProvider(scheme: string, provider: vscode.FileSearchProvider): IDisposable;\n}\n\nexport const IExtHostSearch = createDecorator<IExtHostSearch>('IExtHostSearch');\n\nexport class ExtHostSearch implements ExtHostSearchShape {\n\n\tprotected readonly _proxy: MainThreadSearchShape = this.extHostRpc.getProxy(MainContext.MainThreadSearch);\n\tprotected _handlePool: number = 0;\n\n\tprivate readonly _textSearchProvider = new Map<number, vscode.TextSearchProvider>();\n\tprivate readonly _textSearchUsedSchemes = new Set<string>();\n\tprivate readonly _fileSearchProvider = new Map<number, vscode.FileSearchProvider>();\n\tprivate readonly _fileSearchUsedSchemes = new Set<string>();\n\n\tprivate readonly _fileSearchManager = new FileSearchManager();\n\n\tconstructor(\n\t\t@IExtHostRpcService private extHostRpc: IExtHostRpcService,\n\t\t@IURITransformerService protected _uriTransformer: IURITransformerService,\n\t\t@ILogService protected _logService: ILogService\n\t) { }\n\n\tprotected _transformScheme(scheme: string): string {\n\t\treturn this._uriTransformer.transformOutgoingScheme(scheme);\n\t}\n\n\tregisterTextSearchProvider(scheme: string, provider: vscode.TextSearchProvider): IDisposable {\n\t\tif (this._textSearchUsedSchemes.has(scheme)) {\n\t\t\tthrow new Error(`a text search provider for the scheme '${scheme}' is already registered`);\n\t\t}\n\n\t\tthis._textSearchUsedSchemes.add(scheme);\n\t\tconst handle = this._handlePool++;\n\t\tthis._textSearchProvider.set(handle, provider);\n\t\tthis._proxy.$registerTextSearchProvider(handle, this._transformScheme(scheme));\n\t\treturn toDisposable(() => {\n\t\t\tthis._textSearchUsedSchemes.delete(scheme);\n\t\t\tthis._textSearchProvider.delete(handle);\n\t\t\tthis._proxy.$unregisterProvider(handle);\n\t\t});\n\t}\n\n\tregisterFileSearchProvider(scheme: string, provider: vscode.FileSearchProvider): IDisposable {\n\t\tif (this._fileSearchUsedSchemes.has(scheme)) {\n\t\t\tthrow new Error(`a file search provider for the scheme '${scheme}' is already registered`);\n\t\t}\n\n\t\tthis._fileSearchUsedSchemes.add(scheme);\n\t\tconst handle = this._handlePool++;\n\t\tthis._fileSearchProvider.set(handle, provider);\n\t\tthis._proxy.$registerFileSearchProvider(handle, this._transformScheme(scheme));\n\t\treturn toDisposable(() => {\n\t\t\tthis._fileSearchUsedSchemes.delete(scheme);\n\t\t\tthis._fileSearchProvider.delete(handle);\n\t\t\tthis._proxy.$unregisterProvider(handle);\n\t\t});\n\t}\n\n\t$provideFileSearchResults(handle: number, session: number, rawQuery: IRawFileQuery, token: vscode.CancellationToken): Promise<ISearchCompleteStats> {\n\t\tconst query = reviveQuery(rawQuery);\n\t\tconst provider = this._fileSearchProvider.get(handle);\n\t\tif (provider) {\n\t\t\treturn this._fileSearchManager.fileSearch(query, provider, batch => {\n\t\t\t\tthis._proxy.$handleFileMatch(handle, session, batch.map(p => p.resource));\n\t\t\t}, token);\n\t\t} else {\n\t\t\tthrow new Error('unknown provider: ' + handle);\n\t\t}\n\t}\n\n\t$clearCache(cacheKey: string): Promise<void> {\n\t\tthis._fileSearchManager.clearCache(cacheKey);\n\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\t$provideTextSearchResults(handle: number, session: number, rawQuery: IRawTextQuery, token: vscode.CancellationToken): Promise<ISearchCompleteStats> {\n\t\tconst provider = this._textSearchProvider.get(handle);\n\t\tif (!provider || !provider.provideTextSearchResults) {\n\t\t\tthrow new Error(`Unknown provider ${handle}`);\n\t\t}\n\n\t\tconst query = reviveQuery(rawQuery);\n\t\tconst engine = this.createTextSearchManager(query, provider);\n\t\treturn engine.search(progress => this._proxy.$handleTextMatch(handle, session, progress), token);\n\t}\n\n\t$enableExtensionHostSearch(): void { }\n\n\tprotected createTextSearchManager(query: ITextQuery, provider: vscode.TextSearchProvider): TextSearchManager {\n\t\treturn new TextSearchManager(query, provider, {\n\t\t\treaddir: resource => Promise.resolve([]), // TODO@rob implement\n\t\t\ttoCanonicalName: encoding => encoding\n\t\t}, 'textSearchProvider');\n\t}\n}\n\nexport function reviveQuery<U extends IRawQuery>(rawQuery: U): U extends IRawTextQuery ? ITextQuery : IFileQuery {\n\treturn {\n\t\t...<any>rawQuery, // TODO@rob ???\n\t\t...{\n\t\t\tfolderQueries: rawQuery.folderQueries && rawQuery.folderQueries.map(reviveFolderQuery),\n\t\t\textraFileResources: rawQuery.extraFileResources && rawQuery.extraFileResources.map(components => URI.revive(components))\n\t\t}\n\t};\n}\n\nfunction reviveFolderQuery(rawFolderQuery: IFolderQuery<UriComponents>): IFolderQuery<URI> {\n\treturn {\n\t\t...rawFolderQuery,\n\t\tfolder: URI.revive(rawFolderQuery.folder)\n\t};\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { registerSingleton } from 'vs/platform/instantiation/common/extensions';\nimport { IExtHostOutputService, ExtHostOutputService } from 'vs/workbench/api/common/extHostOutput';\nimport { IExtHostWorkspace, ExtHostWorkspace } from 'vs/workbench/api/common/extHostWorkspace';\nimport { IExtHostDecorations, ExtHostDecorations } from 'vs/workbench/api/common/extHostDecorations';\nimport { IExtHostConfiguration, ExtHostConfiguration } from 'vs/workbench/api/common/extHostConfiguration';\nimport { IExtHostCommands, ExtHostCommands } from 'vs/workbench/api/common/extHostCommands';\nimport { IExtHostDocumentsAndEditors, ExtHostDocumentsAndEditors } from 'vs/workbench/api/common/extHostDocumentsAndEditors';\nimport { IExtHostTerminalService, WorkerExtHostTerminalService } from 'vs/workbench/api/common/extHostTerminalService';\nimport { IExtHostTask, WorkerExtHostTask } from 'vs/workbench/api/common/extHostTask';\nimport { IExtHostDebugService, WorkerExtHostDebugService } from 'vs/workbench/api/common/extHostDebugService';\nimport { IExtHostSearch, ExtHostSearch } from 'vs/workbench/api/common/extHostSearch';\nimport { IExtHostStorage, ExtHostStorage } from 'vs/workbench/api/common/extHostStorage';\nimport { IExtHostTunnelService, ExtHostTunnelService } from 'vs/workbench/api/common/extHostTunnelService';\nimport { IExtHostApiDeprecationService, ExtHostApiDeprecationService, } from 'vs/workbench/api/common/extHostApiDeprecationService';\nimport { IExtHostWindow, ExtHostWindow } from 'vs/workbench/api/common/extHostWindow';\nimport { IExtHostConsumerFileSystem, ExtHostConsumerFileSystem } from 'vs/workbench/api/common/extHostFileSystemConsumer';\nimport { IExtHostFileSystemInfo, ExtHostFileSystemInfo } from 'vs/workbench/api/common/extHostFileSystemInfo';\nimport { IExtHostSecretState, ExtHostSecretState } from 'vs/workbench/api/common/exHostSecretState';\nimport { ExtHostTelemetry, IExtHostTelemetry } from 'vs/workbench/api/common/extHostTelemetry';\nimport { ExtHostEditorTabs, IExtHostEditorTabs } from 'vs/workbench/api/common/extHostEditorTabs';\nimport { ExtHostLoggerService } from 'vs/workbench/api/common/extHostLoggerService';\nimport { ILoggerService, ILogService } from 'vs/platform/log/common/log';\nimport { ExtHostLogService } from 'vs/workbench/api/common/extHostLogService';\nimport { ExtHostVariableResolverProviderService, IExtHostVariableResolverProvider } from 'vs/workbench/api/common/extHostVariableResolverService';\n\nregisterSingleton(ILoggerService, ExtHostLoggerService);\nregisterSingleton(ILogService, ExtHostLogService);\nregisterSingleton(IExtHostApiDeprecationService, ExtHostApiDeprecationService);\nregisterSingleton(IExtHostCommands, ExtHostCommands);\nregisterSingleton(IExtHostConfiguration, ExtHostConfiguration);\nregisterSingleton(IExtHostConsumerFileSystem, ExtHostConsumerFileSystem);\nregisterSingleton(IExtHostDebugService, WorkerExtHostDebugService);\nregisterSingleton(IExtHostDecorations, ExtHostDecorations);\nregisterSingleton(IExtHostDocumentsAndEditors, ExtHostDocumentsAndEditors);\nregisterSingleton(IExtHostFileSystemInfo, ExtHostFileSystemInfo);\nregisterSingleton(IExtHostOutputService, ExtHostOutputService);\nregisterSingleton(IExtHostSearch, ExtHostSearch);\nregisterSingleton(IExtHostStorage, ExtHostStorage);\nregisterSingleton(IExtHostTask, WorkerExtHostTask);\nregisterSingleton(IExtHostTerminalService, WorkerExtHostTerminalService);\nregisterSingleton(IExtHostTunnelService, ExtHostTunnelService);\nregisterSingleton(IExtHostWindow, ExtHostWindow);\nregisterSingleton(IExtHostWorkspace, ExtHostWorkspace);\nregisterSingleton(IExtHostSecretState, ExtHostSecretState);\nregisterSingleton(IExtHostTelemetry, ExtHostTelemetry);\nregisterSingleton(IExtHostEditorTabs, ExtHostEditorTabs);\nregisterSingleton(IExtHostVariableResolverProvider, ExtHostVariableResolverProviderService);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nexport interface ITreeViewsService<T, U, V> {\n\treadonly _serviceBrand: undefined;\n\n\tremoveDragOperationTransfer(uuid: string | undefined): Promise<T | undefined> | undefined;\n\taddDragOperationTransfer(uuid: string, transferPromise: Promise<T | undefined>): void;\n\n\tgetRenderedTreeElement(node: U): V | undefined;\n\taddRenderedTreeItemElement(node: U, element: V): void;\n\tremoveRenderedTreeItemElement(node: U): void;\n}\n\nexport class TreeviewsService<T, U, V> implements ITreeViewsService<T, U, V> {\n\t_serviceBrand: undefined;\n\tprivate _dragOperations: Map<string, Promise<T | undefined>> = new Map();\n\tprivate _renderedElements: Map<U, V> = new Map();\n\n\tremoveDragOperationTransfer(uuid: string | undefined): Promise<T | undefined> | undefined {\n\t\tif ((uuid && this._dragOperations.has(uuid))) {\n\t\t\tconst operation = this._dragOperations.get(uuid);\n\t\t\tthis._dragOperations.delete(uuid);\n\t\t\treturn operation;\n\t\t}\n\t\treturn undefined;\n\t}\n\n\taddDragOperationTransfer(uuid: string, transferPromise: Promise<T | undefined>): void {\n\t\tthis._dragOperations.set(uuid, transferPromise);\n\t}\n\n\n\tgetRenderedTreeElement(node: U): V | undefined {\n\t\tif (this._renderedElements.has(node)) {\n\t\t\treturn this._renderedElements.get(node);\n\t\t}\n\t\treturn undefined;\n\t}\n\n\taddRenderedTreeItemElement(node: U, element: V): void {\n\t\tthis._renderedElements.set(node, element);\n\t}\n\n\tremoveRenderedTreeItemElement(node: U): void {\n\t\tif (this._renderedElements.has(node)) {\n\t\t\tthis._renderedElements.delete(node);\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { localize } from 'vs/nls';\nimport type * as vscode from 'vscode';\nimport * as types from './extHostTypes';\nimport { basename } from 'vs/base/common/resources';\nimport { URI } from 'vs/base/common/uri';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { Disposable, DisposableStore, IDisposable } from 'vs/base/common/lifecycle';\nimport { DataTransferDTO, ExtHostTreeViewsShape, MainThreadTreeViewsShape } from './extHost.protocol';\nimport { ITreeItem, TreeViewItemHandleArg, ITreeItemLabel, IRevealOptions } from 'vs/workbench/common/views';\nimport { ExtHostCommands, CommandsConverter } from 'vs/workbench/api/common/extHostCommands';\nimport { asPromise } from 'vs/base/common/async';\nimport { TreeItemCollapsibleState, ThemeIcon, MarkdownString as MarkdownStringType, TreeItem } from 'vs/workbench/api/common/extHostTypes';\nimport { isUndefinedOrNull, isString } from 'vs/base/common/types';\nimport { equals, coalesce } from 'vs/base/common/arrays';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { MarkdownString, ViewBadge, DataTransfer } from 'vs/workbench/api/common/extHostTypeConverters';\nimport { IMarkdownString } from 'vs/base/common/htmlContent';\nimport { CancellationToken, CancellationTokenSource } from 'vs/base/common/cancellation';\nimport { Command } from 'vs/editor/common/languages';\nimport { ITreeViewsService, TreeviewsService } from 'vs/workbench/services/views/common/treeViewsService';\nimport { checkProposedApiEnabled } from 'vs/workbench/services/extensions/common/extensions';\n\ntype TreeItemHandle = string;\n\nfunction toTreeItemLabel(label: any, extension: IExtensionDescription): ITreeItemLabel | undefined {\n\tif (isString(label)) {\n\t\treturn { label };\n\t}\n\n\tif (label\n\t\t&& typeof label === 'object'\n\t\t&& typeof label.label === 'string') {\n\t\tlet highlights: [number, number][] | undefined = undefined;\n\t\tif (Array.isArray(label.highlights)) {\n\t\t\thighlights = (<[number, number][]>label.highlights).filter((highlight => highlight.length === 2 && typeof highlight[0] === 'number' && typeof highlight[1] === 'number'));\n\t\t\thighlights = highlights.length ? highlights : undefined;\n\t\t}\n\t\treturn { label: label.label, highlights };\n\t}\n\n\treturn undefined;\n}\n\n\nexport class ExtHostTreeViews implements ExtHostTreeViewsShape {\n\n\tprivate treeViews: Map<string, ExtHostTreeView<any>> = new Map<string, ExtHostTreeView<any>>();\n\tprivate treeDragAndDropService: ITreeViewsService<vscode.DataTransfer, any, any> = new TreeviewsService<vscode.DataTransfer, any, any>();\n\n\tconstructor(\n\t\tprivate _proxy: MainThreadTreeViewsShape,\n\t\tprivate commands: ExtHostCommands,\n\t\tprivate logService: ILogService\n\t) {\n\n\t\tfunction isTreeViewItemHandleArg(arg: any): boolean {\n\t\t\treturn arg && arg.$treeViewId && arg.$treeItemHandle;\n\t\t}\n\t\tcommands.registerArgumentProcessor({\n\t\t\tprocessArgument: arg => {\n\t\t\t\tif (isTreeViewItemHandleArg(arg)) {\n\t\t\t\t\treturn this.convertArgument(arg);\n\t\t\t\t} else if (Array.isArray(arg) && (arg.length > 0)) {\n\t\t\t\t\treturn arg.map(item => {\n\t\t\t\t\t\tif (isTreeViewItemHandleArg(item)) {\n\t\t\t\t\t\t\treturn this.convertArgument(item);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn item;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn arg;\n\t\t\t}\n\t\t});\n\t}\n\n\tregisterTreeDataProvider<T>(id: string, treeDataProvider: vscode.TreeDataProvider<T>, extension: IExtensionDescription): vscode.Disposable {\n\t\tconst treeView = this.createTreeView(id, { treeDataProvider }, extension);\n\t\treturn { dispose: () => treeView.dispose() };\n\t}\n\n\tcreateTreeView<T>(viewId: string, options: vscode.TreeViewOptions<T>, extension: IExtensionDescription): vscode.TreeView<T> {\n\t\tif (!options || !options.treeDataProvider) {\n\t\t\tthrow new Error('Options with treeDataProvider is mandatory');\n\t\t}\n\t\tconst dropMimeTypes = options.dragAndDropController?.dropMimeTypes ?? [];\n\t\tconst dragMimeTypes = options.dragAndDropController?.dragMimeTypes ?? [];\n\t\tconst hasHandleDrag = !!options.dragAndDropController?.handleDrag;\n\t\tconst hasHandleDrop = !!options.dragAndDropController?.handleDrop;\n\t\tconst registerPromise = this._proxy.$registerTreeViewDataProvider(viewId, { showCollapseAll: !!options.showCollapseAll, canSelectMany: !!options.canSelectMany, dropMimeTypes, dragMimeTypes, hasHandleDrag, hasHandleDrop });\n\t\tconst treeView = this.createExtHostTreeView(viewId, options, extension);\n\t\treturn {\n\t\t\tget onDidCollapseElement() { return treeView.onDidCollapseElement; },\n\t\t\tget onDidExpandElement() { return treeView.onDidExpandElement; },\n\t\t\tget selection() { return treeView.selectedElements; },\n\t\t\tget onDidChangeSelection() { return treeView.onDidChangeSelection; },\n\t\t\tget visible() { return treeView.visible; },\n\t\t\tget onDidChangeVisibility() { return treeView.onDidChangeVisibility; },\n\t\t\tget message() { return treeView.message; },\n\t\t\tset message(message: string) {\n\t\t\t\ttreeView.message = message;\n\t\t\t},\n\t\t\tget title() { return treeView.title; },\n\t\t\tset title(title: string) {\n\t\t\t\ttreeView.title = title;\n\t\t\t},\n\t\t\tget description() {\n\t\t\t\treturn treeView.description;\n\t\t\t},\n\t\t\tset description(description: string | undefined) {\n\t\t\t\ttreeView.description = description;\n\t\t\t},\n\t\t\tget badge() {\n\t\t\t\tcheckProposedApiEnabled(extension, 'badges');\n\t\t\t\treturn treeView.badge;\n\t\t\t},\n\t\t\tset badge(badge: vscode.ViewBadge | undefined) {\n\t\t\t\tcheckProposedApiEnabled(extension, 'badges');\n\t\t\t\ttreeView.badge = badge;\n\t\t\t},\n\t\t\treveal: (element: T, options?: IRevealOptions): Promise<void> => {\n\t\t\t\treturn treeView.reveal(element, options);\n\t\t\t},\n\t\t\tdispose: async () => {\n\t\t\t\t// Wait for the registration promise to finish before doing the dispose.\n\t\t\t\tawait registerPromise;\n\t\t\t\tthis.treeViews.delete(viewId);\n\t\t\t\ttreeView.dispose();\n\t\t\t}\n\t\t};\n\t}\n\n\t$getChildren(treeViewId: string, treeItemHandle?: string): Promise<ITreeItem[] | undefined> {\n\t\tconst treeView = this.treeViews.get(treeViewId);\n\t\tif (!treeView) {\n\t\t\treturn Promise.reject(new Error(localize('treeView.notRegistered', 'No tree view with id \\'{0}\\' registered.', treeViewId)));\n\t\t}\n\t\treturn treeView.getChildren(treeItemHandle);\n\t}\n\n\tasync $handleDrop(destinationViewId: string, requestId: number, treeDataTransferDTO: DataTransferDTO, targetItemHandle: string | undefined, token: CancellationToken,\n\t\toperationUuid?: string, sourceViewId?: string, sourceTreeItemHandles?: string[]): Promise<void> {\n\t\tconst treeView = this.treeViews.get(destinationViewId);\n\t\tif (!treeView) {\n\t\t\treturn Promise.reject(new Error(localize('treeView.notRegistered', 'No tree view with id \\'{0}\\' registered.', destinationViewId)));\n\t\t}\n\n\t\tconst treeDataTransfer = DataTransfer.toDataTransfer(treeDataTransferDTO, async dataItemIndex => {\n\t\t\treturn (await this._proxy.$resolveDropFileData(destinationViewId, requestId, dataItemIndex)).buffer;\n\t\t});\n\t\tif ((sourceViewId === destinationViewId) && sourceTreeItemHandles) {\n\t\t\tawait this.addAdditionalTransferItems(treeDataTransfer, treeView, sourceTreeItemHandles, token, operationUuid);\n\t\t}\n\t\treturn treeView.onDrop(treeDataTransfer, targetItemHandle, token);\n\t}\n\n\tprivate async addAdditionalTransferItems(treeDataTransfer: vscode.DataTransfer, treeView: ExtHostTreeView<any>,\n\t\tsourceTreeItemHandles: string[], token: CancellationToken, operationUuid?: string): Promise<vscode.DataTransfer | undefined> {\n\t\tconst existingTransferOperation = this.treeDragAndDropService.removeDragOperationTransfer(operationUuid);\n\t\tif (existingTransferOperation) {\n\t\t\t(await existingTransferOperation)?.forEach((value, key) => {\n\t\t\t\tif (value) {\n\t\t\t\t\ttreeDataTransfer.set(key, value);\n\t\t\t\t}\n\t\t\t});\n\t\t} else if (operationUuid && treeView.handleDrag) {\n\t\t\tconst willDropPromise = treeView.handleDrag(sourceTreeItemHandles, treeDataTransfer, token);\n\t\t\tthis.treeDragAndDropService.addDragOperationTransfer(operationUuid, willDropPromise);\n\t\t\tawait willDropPromise;\n\t\t}\n\t\treturn treeDataTransfer;\n\t}\n\n\tasync $handleDrag(sourceViewId: string, sourceTreeItemHandles: string[], operationUuid: string, token: CancellationToken): Promise<DataTransferDTO | undefined> {\n\t\tconst treeView = this.treeViews.get(sourceViewId);\n\t\tif (!treeView) {\n\t\t\treturn Promise.reject(new Error(localize('treeView.notRegistered', 'No tree view with id \\'{0}\\' registered.', sourceViewId)));\n\t\t}\n\n\t\tconst treeDataTransfer = await this.addAdditionalTransferItems(new types.DataTransfer(), treeView, sourceTreeItemHandles, token, operationUuid);\n\t\tif (!treeDataTransfer) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn DataTransfer.toDataTransferDTO(treeDataTransfer);\n\t}\n\n\tasync $hasResolve(treeViewId: string): Promise<boolean> {\n\t\tconst treeView = this.treeViews.get(treeViewId);\n\t\tif (!treeView) {\n\t\t\tthrow new Error(localize('treeView.notRegistered', 'No tree view with id \\'{0}\\' registered.', treeViewId));\n\t\t}\n\t\treturn treeView.hasResolve;\n\t}\n\n\t$resolve(treeViewId: string, treeItemHandle: string, token: vscode.CancellationToken): Promise<ITreeItem | undefined> {\n\t\tconst treeView = this.treeViews.get(treeViewId);\n\t\tif (!treeView) {\n\t\t\tthrow new Error(localize('treeView.notRegistered', 'No tree view with id \\'{0}\\' registered.', treeViewId));\n\t\t}\n\t\treturn treeView.resolveTreeItem(treeItemHandle, token);\n\t}\n\n\t$setExpanded(treeViewId: string, treeItemHandle: string, expanded: boolean): void {\n\t\tconst treeView = this.treeViews.get(treeViewId);\n\t\tif (!treeView) {\n\t\t\tthrow new Error(localize('treeView.notRegistered', 'No tree view with id \\'{0}\\' registered.', treeViewId));\n\t\t}\n\t\ttreeView.setExpanded(treeItemHandle, expanded);\n\t}\n\n\t$setSelection(treeViewId: string, treeItemHandles: string[]): void {\n\t\tconst treeView = this.treeViews.get(treeViewId);\n\t\tif (!treeView) {\n\t\t\tthrow new Error(localize('treeView.notRegistered', 'No tree view with id \\'{0}\\' registered.', treeViewId));\n\t\t}\n\t\ttreeView.setSelection(treeItemHandles);\n\t}\n\n\t$setVisible(treeViewId: string, isVisible: boolean): void {\n\t\tconst treeView = this.treeViews.get(treeViewId);\n\t\tif (!treeView) {\n\t\t\tthrow new Error(localize('treeView.notRegistered', 'No tree view with id \\'{0}\\' registered.', treeViewId));\n\t\t}\n\t\ttreeView.setVisible(isVisible);\n\t}\n\n\tprivate createExtHostTreeView<T>(id: string, options: vscode.TreeViewOptions<T>, extension: IExtensionDescription): ExtHostTreeView<T> {\n\t\tconst treeView = new ExtHostTreeView<T>(id, options, this._proxy, this.commands.converter, this.logService, extension);\n\t\tthis.treeViews.set(id, treeView);\n\t\treturn treeView;\n\t}\n\n\tprivate convertArgument(arg: TreeViewItemHandleArg): any {\n\t\tconst treeView = this.treeViews.get(arg.$treeViewId);\n\t\treturn treeView ? treeView.getExtensionElement(arg.$treeItemHandle) : null;\n\t}\n}\n\ntype Root = null | undefined | void;\ntype TreeData<T> = { message: boolean; element: T | T[] | Root | false };\n\ninterface TreeNode extends IDisposable {\n\titem: ITreeItem;\n\textensionItem: vscode.TreeItem;\n\tparent: TreeNode | Root;\n\tchildren?: TreeNode[];\n\tdisposableStore: DisposableStore;\n}\n\nclass ExtHostTreeView<T> extends Disposable {\n\n\tprivate static readonly LABEL_HANDLE_PREFIX = '0';\n\tprivate static readonly ID_HANDLE_PREFIX = '1';\n\n\tprivate readonly dataProvider: vscode.TreeDataProvider<T>;\n\tprivate readonly dndController: vscode.TreeDragAndDropController<T> | undefined;\n\n\tprivate roots: TreeNode[] | undefined = undefined;\n\tprivate elements: Map<TreeItemHandle, T> = new Map<TreeItemHandle, T>();\n\tprivate nodes: Map<T, TreeNode> = new Map<T, TreeNode>();\n\n\tprivate _visible: boolean = false;\n\tget visible(): boolean { return this._visible; }\n\n\tprivate _selectedHandles: TreeItemHandle[] = [];\n\tget selectedElements(): T[] { return <T[]>this._selectedHandles.map(handle => this.getExtensionElement(handle)).filter(element => !isUndefinedOrNull(element)); }\n\n\tprivate _onDidExpandElement: Emitter<vscode.TreeViewExpansionEvent<T>> = this._register(new Emitter<vscode.TreeViewExpansionEvent<T>>());\n\treadonly onDidExpandElement: Event<vscode.TreeViewExpansionEvent<T>> = this._onDidExpandElement.event;\n\n\tprivate _onDidCollapseElement: Emitter<vscode.TreeViewExpansionEvent<T>> = this._register(new Emitter<vscode.TreeViewExpansionEvent<T>>());\n\treadonly onDidCollapseElement: Event<vscode.TreeViewExpansionEvent<T>> = this._onDidCollapseElement.event;\n\n\tprivate _onDidChangeSelection: Emitter<vscode.TreeViewSelectionChangeEvent<T>> = this._register(new Emitter<vscode.TreeViewSelectionChangeEvent<T>>());\n\treadonly onDidChangeSelection: Event<vscode.TreeViewSelectionChangeEvent<T>> = this._onDidChangeSelection.event;\n\n\tprivate _onDidChangeVisibility: Emitter<vscode.TreeViewVisibilityChangeEvent> = this._register(new Emitter<vscode.TreeViewVisibilityChangeEvent>());\n\treadonly onDidChangeVisibility: Event<vscode.TreeViewVisibilityChangeEvent> = this._onDidChangeVisibility.event;\n\n\tprivate _onDidChangeData: Emitter<TreeData<T>> = this._register(new Emitter<TreeData<T>>());\n\n\tprivate refreshPromise: Promise<void> = Promise.resolve();\n\tprivate refreshQueue: Promise<void> = Promise.resolve();\n\n\tconstructor(\n\t\tprivate viewId: string, options: vscode.TreeViewOptions<T>,\n\t\tprivate proxy: MainThreadTreeViewsShape,\n\t\tprivate commands: CommandsConverter,\n\t\tprivate logService: ILogService,\n\t\tprivate extension: IExtensionDescription\n\t) {\n\t\tsuper();\n\t\tif (extension.contributes && extension.contributes.views) {\n\t\t\tfor (const location in extension.contributes.views) {\n\t\t\t\tfor (const view of extension.contributes.views[location]) {\n\t\t\t\t\tif (view.id === viewId) {\n\t\t\t\t\t\tthis._title = view.name;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.dataProvider = options.treeDataProvider;\n\t\tthis.dndController = options.dragAndDropController;\n\t\tif (this.dataProvider.onDidChangeTreeData) {\n\t\t\tthis._register(this.dataProvider.onDidChangeTreeData(elementOrElements => this._onDidChangeData.fire({ message: false, element: elementOrElements })));\n\t\t}\n\n\t\tlet refreshingPromise: Promise<void> | null;\n\t\tlet promiseCallback: () => void;\n\t\tthis._register(Event.debounce<TreeData<T>, { message: boolean; elements: (T | Root)[] }>(this._onDidChangeData.event, (result, current) => {\n\t\t\tif (!result) {\n\t\t\t\tresult = { message: false, elements: [] };\n\t\t\t}\n\t\t\tif (current.element !== false) {\n\t\t\t\tif (!refreshingPromise) {\n\t\t\t\t\t// New refresh has started\n\t\t\t\t\trefreshingPromise = new Promise(c => promiseCallback = c);\n\t\t\t\t\tthis.refreshPromise = this.refreshPromise.then(() => refreshingPromise!);\n\t\t\t\t}\n\t\t\t\tif (Array.isArray(current.element)) {\n\t\t\t\t\tresult.elements.push(...current.element);\n\t\t\t\t} else {\n\t\t\t\t\tresult.elements.push(current.element);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (current.message) {\n\t\t\t\tresult.message = true;\n\t\t\t}\n\t\t\treturn result;\n\t\t}, 200, true)(({ message, elements }) => {\n\t\t\tif (elements.length) {\n\t\t\t\tthis.refreshQueue = this.refreshQueue.then(() => {\n\t\t\t\t\tconst _promiseCallback = promiseCallback;\n\t\t\t\t\trefreshingPromise = null;\n\t\t\t\t\treturn this.refresh(elements).then(() => _promiseCallback());\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (message) {\n\t\t\t\tthis.proxy.$setMessage(this.viewId, this._message);\n\t\t\t}\n\t\t}));\n\t}\n\n\tasync getChildren(parentHandle: TreeItemHandle | Root): Promise<ITreeItem[] | undefined> {\n\t\tconst parentElement = parentHandle ? this.getExtensionElement(parentHandle) : undefined;\n\t\tif (parentHandle && !parentElement) {\n\t\t\tthis.logService.error(`No tree item with id \\'${parentHandle}\\' found.`);\n\t\t\treturn Promise.resolve([]);\n\t\t}\n\n\t\tlet childrenNodes: TreeNode[] | undefined = this.getChildrenNodes(parentHandle); // Get it from cache\n\n\t\tif (!childrenNodes) {\n\t\t\tchildrenNodes = await this.fetchChildrenNodes(parentElement);\n\t\t}\n\n\t\treturn childrenNodes ? childrenNodes.map(n => n.item) : undefined;\n\t}\n\n\tgetExtensionElement(treeItemHandle: TreeItemHandle): T | undefined {\n\t\treturn this.elements.get(treeItemHandle);\n\t}\n\n\treveal(element: T | undefined, options?: IRevealOptions): Promise<void> {\n\t\toptions = options ? options : { select: true, focus: false };\n\t\tconst select = isUndefinedOrNull(options.select) ? true : options.select;\n\t\tconst focus = isUndefinedOrNull(options.focus) ? false : options.focus;\n\t\tconst expand = isUndefinedOrNull(options.expand) ? false : options.expand;\n\n\t\tif (typeof this.dataProvider.getParent !== 'function') {\n\t\t\treturn Promise.reject(new Error(`Required registered TreeDataProvider to implement 'getParent' method to access 'reveal' method`));\n\t\t}\n\n\t\tif (element) {\n\t\t\treturn this.refreshPromise\n\t\t\t\t.then(() => this.resolveUnknownParentChain(element))\n\t\t\t\t.then(parentChain => this.resolveTreeNode(element, parentChain[parentChain.length - 1])\n\t\t\t\t\t.then(treeNode => this.proxy.$reveal(this.viewId, { item: treeNode.item, parentChain: parentChain.map(p => p.item) }, { select, focus, expand })), error => this.logService.error(error));\n\t\t} else {\n\t\t\treturn this.proxy.$reveal(this.viewId, undefined, { select, focus, expand });\n\t\t}\n\t}\n\n\tprivate _message: string = '';\n\tget message(): string {\n\t\treturn this._message;\n\t}\n\n\tset message(message: string) {\n\t\tthis._message = message;\n\t\tthis._onDidChangeData.fire({ message: true, element: false });\n\t}\n\n\tprivate _title: string = '';\n\tget title(): string {\n\t\treturn this._title;\n\t}\n\n\tset title(title: string) {\n\t\tthis._title = title;\n\t\tthis.proxy.$setTitle(this.viewId, title, this._description);\n\t}\n\n\tprivate _description: string | undefined;\n\tget description(): string | undefined {\n\t\treturn this._description;\n\t}\n\n\tset description(description: string | undefined) {\n\t\tthis._description = description;\n\t\tthis.proxy.$setTitle(this.viewId, this._title, description);\n\t}\n\n\tprivate _badge: vscode.ViewBadge | undefined;\n\tget badge(): vscode.ViewBadge | undefined {\n\t\treturn this._badge;\n\t}\n\n\tset badge(badge: vscode.ViewBadge | undefined) {\n\t\tif (this._badge?.value === badge?.value &&\n\t\t\tthis._badge?.tooltip === badge?.tooltip) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._badge = ViewBadge.from(badge);\n\t\tthis.proxy.$setBadge(this.viewId, badge);\n\t}\n\n\tsetExpanded(treeItemHandle: TreeItemHandle, expanded: boolean): void {\n\t\tconst element = this.getExtensionElement(treeItemHandle);\n\t\tif (element) {\n\t\t\tif (expanded) {\n\t\t\t\tthis._onDidExpandElement.fire(Object.freeze({ element }));\n\t\t\t} else {\n\t\t\t\tthis._onDidCollapseElement.fire(Object.freeze({ element }));\n\t\t\t}\n\t\t}\n\t}\n\n\tsetSelection(treeItemHandles: TreeItemHandle[]): void {\n\t\tif (!equals(this._selectedHandles, treeItemHandles)) {\n\t\t\tthis._selectedHandles = treeItemHandles;\n\t\t\tthis._onDidChangeSelection.fire(Object.freeze({ selection: this.selectedElements }));\n\t\t}\n\t}\n\n\tsetVisible(visible: boolean): void {\n\t\tif (visible !== this._visible) {\n\t\t\tthis._visible = visible;\n\t\t\tthis._onDidChangeVisibility.fire(Object.freeze({ visible: this._visible }));\n\t\t}\n\t}\n\n\tasync handleDrag(sourceTreeItemHandles: TreeItemHandle[], treeDataTransfer: vscode.DataTransfer, token: CancellationToken): Promise<vscode.DataTransfer | undefined> {\n\t\tconst extensionTreeItems: T[] = [];\n\t\tfor (const sourceHandle of sourceTreeItemHandles) {\n\t\t\tconst extensionItem = this.getExtensionElement(sourceHandle);\n\t\t\tif (extensionItem) {\n\t\t\t\textensionTreeItems.push(extensionItem);\n\t\t\t}\n\t\t}\n\n\t\tif (!this.dndController?.handleDrag || (extensionTreeItems.length === 0)) {\n\t\t\treturn;\n\t\t}\n\t\tawait this.dndController.handleDrag(extensionTreeItems, treeDataTransfer, token);\n\t\treturn treeDataTransfer;\n\t}\n\n\tget hasHandleDrag(): boolean {\n\t\treturn !!this.dndController?.handleDrag;\n\t}\n\n\tasync onDrop(treeDataTransfer: vscode.DataTransfer, targetHandleOrNode: TreeItemHandle | undefined, token: CancellationToken): Promise<void> {\n\t\tconst target = targetHandleOrNode ? this.getExtensionElement(targetHandleOrNode) : undefined;\n\t\tif ((!target && targetHandleOrNode) || !this.dndController?.handleDrop) {\n\t\t\treturn;\n\t\t}\n\t\treturn asPromise(() => this.dndController?.handleDrop\n\t\t\t? this.dndController.handleDrop(target, treeDataTransfer, token)\n\t\t\t: undefined);\n\t}\n\n\tget hasResolve(): boolean {\n\t\treturn !!this.dataProvider.resolveTreeItem;\n\t}\n\n\tasync resolveTreeItem(treeItemHandle: string, token: vscode.CancellationToken): Promise<ITreeItem | undefined> {\n\t\tif (!this.dataProvider.resolveTreeItem) {\n\t\t\treturn;\n\t\t}\n\t\tconst element = this.elements.get(treeItemHandle);\n\t\tif (element) {\n\t\t\tconst node = this.nodes.get(element);\n\t\t\tif (node) {\n\t\t\t\tconst resolve = await this.dataProvider.resolveTreeItem(node.extensionItem, element, token) ?? node.extensionItem;\n\t\t\t\tthis.validateTreeItem(resolve);\n\t\t\t\t// Resolvable elements. Currently only tooltip and command.\n\t\t\t\tnode.item.tooltip = this.getTooltip(resolve.tooltip);\n\t\t\t\tnode.item.command = this.getCommand(node.disposableStore, resolve.command);\n\t\t\t\treturn node.item;\n\t\t\t}\n\t\t}\n\t\treturn;\n\t}\n\n\tprivate resolveUnknownParentChain(element: T): Promise<TreeNode[]> {\n\t\treturn this.resolveParent(element)\n\t\t\t.then((parent) => {\n\t\t\t\tif (!parent) {\n\t\t\t\t\treturn Promise.resolve([]);\n\t\t\t\t}\n\t\t\t\treturn this.resolveUnknownParentChain(parent)\n\t\t\t\t\t.then(result => this.resolveTreeNode(parent, result[result.length - 1])\n\t\t\t\t\t\t.then(parentNode => {\n\t\t\t\t\t\t\tresult.push(parentNode);\n\t\t\t\t\t\t\treturn result;\n\t\t\t\t\t\t}));\n\t\t\t});\n\t}\n\n\tprivate resolveParent(element: T): Promise<T | Root> {\n\t\tconst node = this.nodes.get(element);\n\t\tif (node) {\n\t\t\treturn Promise.resolve(node.parent ? this.elements.get(node.parent.item.handle) : undefined);\n\t\t}\n\t\treturn asPromise(() => this.dataProvider.getParent!(element));\n\t}\n\n\tprivate resolveTreeNode(element: T, parent?: TreeNode): Promise<TreeNode> {\n\t\tconst node = this.nodes.get(element);\n\t\tif (node) {\n\t\t\treturn Promise.resolve(node);\n\t\t}\n\t\treturn asPromise(() => this.dataProvider.getTreeItem(element))\n\t\t\t.then(extTreeItem => this.createHandle(element, extTreeItem, parent, true))\n\t\t\t.then(handle => this.getChildren(parent ? parent.item.handle : undefined)\n\t\t\t\t.then(() => {\n\t\t\t\t\tconst cachedElement = this.getExtensionElement(handle);\n\t\t\t\t\tif (cachedElement) {\n\t\t\t\t\t\tconst node = this.nodes.get(cachedElement);\n\t\t\t\t\t\tif (node) {\n\t\t\t\t\t\t\treturn Promise.resolve(node);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthrow new Error(`Cannot resolve tree item for element ${handle}`);\n\t\t\t\t}));\n\t}\n\n\tprivate getChildrenNodes(parentNodeOrHandle: TreeNode | TreeItemHandle | Root): TreeNode[] | undefined {\n\t\tif (parentNodeOrHandle) {\n\t\t\tlet parentNode: TreeNode | undefined;\n\t\t\tif (typeof parentNodeOrHandle === 'string') {\n\t\t\t\tconst parentElement = this.getExtensionElement(parentNodeOrHandle);\n\t\t\t\tparentNode = parentElement ? this.nodes.get(parentElement) : undefined;\n\t\t\t} else {\n\t\t\t\tparentNode = parentNodeOrHandle;\n\t\t\t}\n\t\t\treturn parentNode ? parentNode.children || undefined : undefined;\n\t\t}\n\t\treturn this.roots;\n\t}\n\n\tprivate async fetchChildrenNodes(parentElement?: T): Promise<TreeNode[] | undefined> {\n\t\t// clear children cache\n\t\tthis.clearChildren(parentElement);\n\n\t\tconst cts = new CancellationTokenSource(this._refreshCancellationSource.token);\n\n\t\ttry {\n\t\t\tconst parentNode = parentElement ? this.nodes.get(parentElement) : undefined;\n\t\t\tconst elements = await this.dataProvider.getChildren(parentElement);\n\t\t\tif (cts.token.isCancellationRequested) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tconst items = await Promise.all(coalesce(elements || []).map(async element => {\n\t\t\t\tconst item = await this.dataProvider.getTreeItem(element);\n\t\t\t\treturn item && !cts.token.isCancellationRequested ? this.createAndRegisterTreeNode(element, item, parentNode) : null;\n\t\t\t}));\n\t\t\tif (cts.token.isCancellationRequested) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\treturn coalesce(items);\n\t\t} finally {\n\t\t\tcts.dispose();\n\t\t}\n\t}\n\n\tprivate _refreshCancellationSource = new CancellationTokenSource();\n\n\tprivate refresh(elements: (T | Root)[]): Promise<void> {\n\t\tconst hasRoot = elements.some(element => !element);\n\t\tif (hasRoot) {\n\t\t\t// Cancel any pending children fetches\n\t\t\tthis._refreshCancellationSource.dispose(true);\n\t\t\tthis._refreshCancellationSource = new CancellationTokenSource();\n\n\t\t\tthis.clearAll(); // clear cache\n\t\t\treturn this.proxy.$refresh(this.viewId);\n\t\t} else {\n\t\t\tconst handlesToRefresh = this.getHandlesToRefresh(<T[]>elements);\n\t\t\tif (handlesToRefresh.length) {\n\t\t\t\treturn this.refreshHandles(handlesToRefresh);\n\t\t\t}\n\t\t}\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\tprivate getHandlesToRefresh(elements: T[]): TreeItemHandle[] {\n\t\tconst elementsToUpdate = new Set<TreeItemHandle>();\n\t\tconst elementNodes = elements.map(element => this.nodes.get(element));\n\t\tfor (const elementNode of elementNodes) {\n\t\t\tif (elementNode && !elementsToUpdate.has(elementNode.item.handle)) {\n\t\t\t\t// check if an ancestor of extElement is already in the elements list\n\t\t\t\tlet currentNode: TreeNode | undefined = elementNode;\n\t\t\t\twhile (currentNode && currentNode.parent && elementNodes.findIndex(node => currentNode && currentNode.parent && node && node.item.handle === currentNode.parent.item.handle) === -1) {\n\t\t\t\t\tconst parentElement: T | undefined = this.elements.get(currentNode.parent.item.handle);\n\t\t\t\t\tcurrentNode = parentElement ? this.nodes.get(parentElement) : undefined;\n\t\t\t\t}\n\t\t\t\tif (currentNode && !currentNode.parent) {\n\t\t\t\t\telementsToUpdate.add(elementNode.item.handle);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst handlesToUpdate: TreeItemHandle[] = [];\n\t\t// Take only top level elements\n\t\telementsToUpdate.forEach((handle) => {\n\t\t\tconst element = this.elements.get(handle);\n\t\t\tif (element) {\n\t\t\t\tconst node = this.nodes.get(element);\n\t\t\t\tif (node && (!node.parent || !elementsToUpdate.has(node.parent.item.handle))) {\n\t\t\t\t\thandlesToUpdate.push(handle);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn handlesToUpdate;\n\t}\n\n\tprivate refreshHandles(itemHandles: TreeItemHandle[]): Promise<void> {\n\t\tconst itemsToRefresh: { [treeItemHandle: string]: ITreeItem } = {};\n\t\treturn Promise.all(itemHandles.map(treeItemHandle =>\n\t\t\tthis.refreshNode(treeItemHandle)\n\t\t\t\t.then(node => {\n\t\t\t\t\tif (node) {\n\t\t\t\t\t\titemsToRefresh[treeItemHandle] = node.item;\n\t\t\t\t\t}\n\t\t\t\t})))\n\t\t\t.then(() => Object.keys(itemsToRefresh).length ? this.proxy.$refresh(this.viewId, itemsToRefresh) : undefined);\n\t}\n\n\tprivate refreshNode(treeItemHandle: TreeItemHandle): Promise<TreeNode | null> {\n\t\tconst extElement = this.getExtensionElement(treeItemHandle);\n\t\tif (extElement) {\n\t\t\tconst existing = this.nodes.get(extElement);\n\t\t\tif (existing) {\n\t\t\t\tthis.clearChildren(extElement); // clear children cache\n\t\t\t\treturn asPromise(() => this.dataProvider.getTreeItem(extElement))\n\t\t\t\t\t.then(extTreeItem => {\n\t\t\t\t\t\tif (extTreeItem) {\n\t\t\t\t\t\t\tconst newNode = this.createTreeNode(extElement, extTreeItem, existing.parent);\n\t\t\t\t\t\t\tthis.updateNodeCache(extElement, newNode, existing, existing.parent);\n\t\t\t\t\t\t\texisting.dispose();\n\t\t\t\t\t\t\treturn newNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn Promise.resolve(null);\n\t}\n\n\tprivate createAndRegisterTreeNode(element: T, extTreeItem: vscode.TreeItem, parentNode: TreeNode | Root): TreeNode {\n\t\tconst node = this.createTreeNode(element, extTreeItem, parentNode);\n\t\tif (extTreeItem.id && this.elements.has(node.item.handle)) {\n\t\t\tthrow new Error(localize('treeView.duplicateElement', 'Element with id {0} is already registered', extTreeItem.id));\n\t\t}\n\t\tthis.addNodeToCache(element, node);\n\t\tthis.addNodeToParentCache(node, parentNode);\n\t\treturn node;\n\t}\n\n\tprivate getTooltip(tooltip?: string | vscode.MarkdownString): string | IMarkdownString | undefined {\n\t\tif (MarkdownStringType.isMarkdownString(tooltip)) {\n\t\t\treturn MarkdownString.from(tooltip);\n\t\t}\n\t\treturn tooltip;\n\t}\n\n\tprivate getCommand(disposable: DisposableStore, command?: vscode.Command): Command | undefined {\n\t\treturn command ? this.commands.toInternal(command, disposable) : undefined;\n\t}\n\n\tprivate validateTreeItem(extensionTreeItem: vscode.TreeItem) {\n\t\tif (!TreeItem.isTreeItem(extensionTreeItem)) {\n\t\t\t// TODO: #154757 we should consider throwing, but let's wait and see if there are tons of reports of this first.\n\t\t\tconsole.log(`Extension ${this.extension.identifier.value} has provided an invalid tree item.`);\n\t\t}\n\t}\n\n\tprivate createTreeNode(element: T, extensionTreeItem: vscode.TreeItem, parent: TreeNode | Root): TreeNode {\n\t\tthis.validateTreeItem(extensionTreeItem);\n\t\tconst disposableStore = new DisposableStore();\n\t\tconst handle = this.createHandle(element, extensionTreeItem, parent);\n\t\tconst icon = this.getLightIconPath(extensionTreeItem);\n\t\tconst item: ITreeItem = {\n\t\t\thandle,\n\t\t\tparentHandle: parent ? parent.item.handle : undefined,\n\t\t\tlabel: toTreeItemLabel(extensionTreeItem.label, this.extension),\n\t\t\tdescription: extensionTreeItem.description,\n\t\t\tresourceUri: extensionTreeItem.resourceUri,\n\t\t\ttooltip: this.getTooltip(extensionTreeItem.tooltip),\n\t\t\tcommand: this.getCommand(disposableStore, extensionTreeItem.command),\n\t\t\tcontextValue: extensionTreeItem.contextValue,\n\t\t\ticon,\n\t\t\ticonDark: this.getDarkIconPath(extensionTreeItem) || icon,\n\t\t\tthemeIcon: this.getThemeIcon(extensionTreeItem),\n\t\t\tcollapsibleState: isUndefinedOrNull(extensionTreeItem.collapsibleState) ? TreeItemCollapsibleState.None : extensionTreeItem.collapsibleState,\n\t\t\taccessibilityInformation: extensionTreeItem.accessibilityInformation\n\t\t};\n\n\t\treturn {\n\t\t\titem,\n\t\t\textensionItem: extensionTreeItem,\n\t\t\tparent,\n\t\t\tchildren: undefined,\n\t\t\tdisposableStore,\n\t\t\tdispose(): void { disposableStore.dispose(); }\n\t\t};\n\t}\n\n\tprivate getThemeIcon(extensionTreeItem: vscode.TreeItem): ThemeIcon | undefined {\n\t\treturn extensionTreeItem.iconPath instanceof ThemeIcon ? extensionTreeItem.iconPath : undefined;\n\t}\n\n\tprivate createHandle(element: T, { id, label, resourceUri }: vscode.TreeItem, parent: TreeNode | Root, returnFirst?: boolean): TreeItemHandle {\n\t\tif (id) {\n\t\t\treturn `${ExtHostTreeView.ID_HANDLE_PREFIX}/${id}`;\n\t\t}\n\n\t\tconst treeItemLabel = toTreeItemLabel(label, this.extension);\n\t\tconst prefix: string = parent ? parent.item.handle : ExtHostTreeView.LABEL_HANDLE_PREFIX;\n\t\tlet elementId = treeItemLabel ? treeItemLabel.label : resourceUri ? basename(resourceUri) : '';\n\t\telementId = elementId.indexOf('/') !== -1 ? elementId.replace('/', '//') : elementId;\n\t\tconst existingHandle = this.nodes.has(element) ? this.nodes.get(element)!.item.handle : undefined;\n\t\tconst childrenNodes = (this.getChildrenNodes(parent) || []);\n\n\t\tlet handle: TreeItemHandle;\n\t\tlet counter = 0;\n\t\tdo {\n\t\t\thandle = `${prefix}/${counter}:${elementId}`;\n\t\t\tif (returnFirst || !this.elements.has(handle) || existingHandle === handle) {\n\t\t\t\t// Return first if asked for or\n\t\t\t\t// Return if handle does not exist or\n\t\t\t\t// Return if handle is being reused\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcounter++;\n\t\t} while (counter <= childrenNodes.length);\n\n\t\treturn handle;\n\t}\n\n\tprivate getLightIconPath(extensionTreeItem: vscode.TreeItem): URI | undefined {\n\t\tif (extensionTreeItem.iconPath && !(extensionTreeItem.iconPath instanceof ThemeIcon)) {\n\t\t\tif (typeof extensionTreeItem.iconPath === 'string'\n\t\t\t\t|| URI.isUri(extensionTreeItem.iconPath)) {\n\t\t\t\treturn this.getIconPath(extensionTreeItem.iconPath);\n\t\t\t}\n\t\t\treturn this.getIconPath((<{ light: string | URI; dark: string | URI }>extensionTreeItem.iconPath).light);\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprivate getDarkIconPath(extensionTreeItem: vscode.TreeItem): URI | undefined {\n\t\tif (extensionTreeItem.iconPath && !(extensionTreeItem.iconPath instanceof ThemeIcon) && (<{ light: string | URI; dark: string | URI }>extensionTreeItem.iconPath).dark) {\n\t\t\treturn this.getIconPath((<{ light: string | URI; dark: string | URI }>extensionTreeItem.iconPath).dark);\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprivate getIconPath(iconPath: string | URI): URI {\n\t\tif (URI.isUri(iconPath)) {\n\t\t\treturn iconPath;\n\t\t}\n\t\treturn URI.file(iconPath);\n\t}\n\n\tprivate addNodeToCache(element: T, node: TreeNode): void {\n\t\tthis.elements.set(node.item.handle, element);\n\t\tthis.nodes.set(element, node);\n\t}\n\n\tprivate updateNodeCache(element: T, newNode: TreeNode, existing: TreeNode, parentNode: TreeNode | Root): void {\n\t\t// Remove from the cache\n\t\tthis.elements.delete(newNode.item.handle);\n\t\tthis.nodes.delete(element);\n\t\tif (newNode.item.handle !== existing.item.handle) {\n\t\t\tthis.elements.delete(existing.item.handle);\n\t\t}\n\n\t\t// Add the new node to the cache\n\t\tthis.addNodeToCache(element, newNode);\n\n\t\t// Replace the node in parent's children nodes\n\t\tconst childrenNodes = (this.getChildrenNodes(parentNode) || []);\n\t\tconst childNode = childrenNodes.filter(c => c.item.handle === existing.item.handle)[0];\n\t\tif (childNode) {\n\t\t\tchildrenNodes.splice(childrenNodes.indexOf(childNode), 1, newNode);\n\t\t}\n\t}\n\n\tprivate addNodeToParentCache(node: TreeNode, parentNode: TreeNode | Root): void {\n\t\tif (parentNode) {\n\t\t\tif (!parentNode.children) {\n\t\t\t\tparentNode.children = [];\n\t\t\t}\n\t\t\tparentNode.children.push(node);\n\t\t} else {\n\t\t\tif (!this.roots) {\n\t\t\t\tthis.roots = [];\n\t\t\t}\n\t\t\tthis.roots.push(node);\n\t\t}\n\t}\n\n\tprivate clearChildren(parentElement?: T): void {\n\t\tif (parentElement) {\n\t\t\tconst node = this.nodes.get(parentElement);\n\t\t\tif (node) {\n\t\t\t\tif (node.children) {\n\t\t\t\t\tfor (const child of node.children) {\n\t\t\t\t\t\tconst childElement = this.elements.get(child.item.handle);\n\t\t\t\t\t\tif (childElement) {\n\t\t\t\t\t\t\tthis.clear(childElement);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tnode.children = undefined;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.clearAll();\n\t\t}\n\t}\n\n\tprivate clear(element: T): void {\n\t\tconst node = this.nodes.get(element);\n\t\tif (node) {\n\t\t\tif (node.children) {\n\t\t\t\tfor (const child of node.children) {\n\t\t\t\t\tconst childElement = this.elements.get(child.item.handle);\n\t\t\t\t\tif (childElement) {\n\t\t\t\t\t\tthis.clear(childElement);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.nodes.delete(element);\n\t\t\tthis.elements.delete(node.item.handle);\n\t\t\tnode.dispose();\n\t\t}\n\t}\n\n\tprivate clearAll(): void {\n\t\tthis.roots = undefined;\n\t\tthis.elements.clear();\n\t\tthis.nodes.forEach(node => node.dispose());\n\t\tthis.nodes.clear();\n\t}\n\n\toverride dispose() {\n\t\tthis._refreshCancellationSource.dispose();\n\n\t\tthis.clearAll();\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancellationTokenSource } from 'vs/base/common/cancellation';\nimport * as errors from 'vs/base/common/errors';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport Severity from 'vs/base/common/severity';\nimport { URI } from 'vs/base/common/uri';\nimport { TextEditorCursorStyle } from 'vs/editor/common/config/editorOptions';\nimport { OverviewRulerLane } from 'vs/editor/common/model';\nimport * as languageConfiguration from 'vs/editor/common/languages/languageConfiguration';\nimport { score } from 'vs/editor/common/languageSelector';\nimport * as files from 'vs/platform/files/common/files';\nimport { ExtHostContext, MainContext, CandidatePortSource, ExtHostLogLevelServiceShape } from 'vs/workbench/api/common/extHost.protocol';\nimport { UIKind } from 'vs/workbench/services/extensions/common/extensionHostProtocol';\nimport { ExtHostApiCommands } from 'vs/workbench/api/common/extHostApiCommands';\nimport { ExtHostClipboard } from 'vs/workbench/api/common/extHostClipboard';\nimport { IExtHostCommands } from 'vs/workbench/api/common/extHostCommands';\nimport { createExtHostComments } from 'vs/workbench/api/common/extHostComments';\nimport { ExtHostConfigProvider, IExtHostConfiguration } from 'vs/workbench/api/common/extHostConfiguration';\nimport { ExtHostDiagnostics } from 'vs/workbench/api/common/extHostDiagnostics';\nimport { ExtHostDialogs } from 'vs/workbench/api/common/extHostDialogs';\nimport { ExtHostDocumentContentProvider } from 'vs/workbench/api/common/extHostDocumentContentProviders';\nimport { ExtHostDocumentSaveParticipant } from 'vs/workbench/api/common/extHostDocumentSaveParticipant';\nimport { ExtHostDocuments } from 'vs/workbench/api/common/extHostDocuments';\nimport { IExtHostDocumentsAndEditors } from 'vs/workbench/api/common/extHostDocumentsAndEditors';\nimport { Extension, IExtHostExtensionService } from 'vs/workbench/api/common/extHostExtensionService';\nimport { ExtHostFileSystem } from 'vs/workbench/api/common/extHostFileSystem';\nimport { ExtHostFileSystemEventService } from 'vs/workbench/api/common/extHostFileSystemEventService';\nimport { ExtHostLanguageFeatures } from 'vs/workbench/api/common/extHostLanguageFeatures';\nimport { ExtHostLanguages } from 'vs/workbench/api/common/extHostLanguages';\nimport { ExtHostMessageService } from 'vs/workbench/api/common/extHostMessageService';\nimport { IExtHostOutputService } from 'vs/workbench/api/common/extHostOutput';\nimport { ExtHostProgress } from 'vs/workbench/api/common/extHostProgress';\nimport { createExtHostQuickOpen } from 'vs/workbench/api/common/extHostQuickOpen';\nimport { ExtHostSCM } from 'vs/workbench/api/common/extHostSCM';\nimport { ExtHostStatusBar } from 'vs/workbench/api/common/extHostStatusBar';\nimport { IExtHostStorage } from 'vs/workbench/api/common/extHostStorage';\nimport { IExtHostTerminalService } from 'vs/workbench/api/common/extHostTerminalService';\nimport { ExtHostEditors } from 'vs/workbench/api/common/extHostTextEditors';\nimport { ExtHostTreeViews } from 'vs/workbench/api/common/extHostTreeViews';\nimport * as typeConverters from 'vs/workbench/api/common/extHostTypeConverters';\nimport * as extHostTypes from 'vs/workbench/api/common/extHostTypes';\nimport { ExtHostUrls } from 'vs/workbench/api/common/extHostUrls';\nimport { ExtHostWebviews } from 'vs/workbench/api/common/extHostWebview';\nimport { IExtHostWindow } from 'vs/workbench/api/common/extHostWindow';\nimport { IExtHostWorkspace } from 'vs/workbench/api/common/extHostWorkspace';\nimport { ProxyIdentifier } from 'vs/workbench/services/extensions/common/proxyIdentifier';\nimport { ExtensionDescriptionRegistry } from 'vs/workbench/services/extensions/common/extensionDescriptionRegistry';\nimport type * as vscode from 'vscode';\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { ExtHostEditorInsets } from 'vs/workbench/api/common/extHostCodeInsets';\nimport { ExtHostLabelService } from 'vs/workbench/api/common/extHostLabelService';\nimport { getRemoteName } from 'vs/platform/remote/common/remoteHosts';\nimport { ServicesAccessor } from 'vs/platform/instantiation/common/instantiation';\nimport { IExtHostDecorations } from 'vs/workbench/api/common/extHostDecorations';\nimport { IExtHostTask } from 'vs/workbench/api/common/extHostTask';\nimport { IExtHostDebugService } from 'vs/workbench/api/common/extHostDebugService';\nimport { IExtHostSearch } from 'vs/workbench/api/common/extHostSearch';\nimport { ILoggerService, ILogService } from 'vs/platform/log/common/log';\nimport { IURITransformerService } from 'vs/workbench/api/common/extHostUriTransformerService';\nimport { IExtHostRpcService } from 'vs/workbench/api/common/extHostRpcService';\nimport { IExtHostInitDataService } from 'vs/workbench/api/common/extHostInitDataService';\nimport { ExtHostNotebookController } from 'vs/workbench/api/common/extHostNotebook';\nimport { ExtHostTheming } from 'vs/workbench/api/common/extHostTheming';\nimport { IExtHostTunnelService } from 'vs/workbench/api/common/extHostTunnelService';\nimport { IExtHostApiDeprecationService } from 'vs/workbench/api/common/extHostApiDeprecationService';\nimport { ExtHostAuthentication } from 'vs/workbench/api/common/extHostAuthentication';\nimport { ExtHostTimeline } from 'vs/workbench/api/common/extHostTimeline';\nimport { IExtensionStoragePaths } from 'vs/workbench/api/common/extHostStoragePaths';\nimport { IExtHostConsumerFileSystem } from 'vs/workbench/api/common/extHostFileSystemConsumer';\nimport { ExtHostWebviewViews } from 'vs/workbench/api/common/extHostWebviewView';\nimport { ExtHostCustomEditors } from 'vs/workbench/api/common/extHostCustomEditors';\nimport { ExtHostWebviewPanels } from 'vs/workbench/api/common/extHostWebviewPanels';\nimport { ExtHostBulkEdits } from 'vs/workbench/api/common/extHostBulkEdits';\nimport { IExtHostFileSystemInfo } from 'vs/workbench/api/common/extHostFileSystemInfo';\nimport { ExtHostTesting } from 'vs/workbench/api/common/extHostTesting';\nimport { ExtHostUriOpeners } from 'vs/workbench/api/common/extHostUriOpener';\nimport { IExtHostSecretState } from 'vs/workbench/api/common/exHostSecretState';\nimport { IExtHostEditorTabs } from 'vs/workbench/api/common/extHostEditorTabs';\nimport { IExtHostTelemetry } from 'vs/workbench/api/common/extHostTelemetry';\nimport { ExtHostNotebookKernels } from 'vs/workbench/api/common/extHostNotebookKernels';\nimport { TextSearchCompleteMessageType } from 'vs/workbench/services/search/common/searchExtTypes';\nimport { ExtHostNotebookRenderers } from 'vs/workbench/api/common/extHostNotebookRenderers';\nimport { Schemas } from 'vs/base/common/network';\nimport { matchesScheme } from 'vs/platform/opener/common/opener';\nimport { ExtHostNotebookEditors } from 'vs/workbench/api/common/extHostNotebookEditors';\nimport { ExtHostNotebookDocuments } from 'vs/workbench/api/common/extHostNotebookDocuments';\nimport { ExtHostInteractive } from 'vs/workbench/api/common/extHostInteractive';\nimport { combinedDisposable } from 'vs/base/common/lifecycle';\nimport { checkProposedApiEnabled, ExtensionIdentifierSet, isProposedApiEnabled } from 'vs/workbench/services/extensions/common/extensions';\nimport { DebugConfigurationProviderTriggerKind } from 'vs/workbench/contrib/debug/common/debug';\nimport { equalsIgnoreCase } from 'vs/base/common/strings';\n\nexport interface IExtensionRegistries {\n\tmine: ExtensionDescriptionRegistry;\n\tall: ExtensionDescriptionRegistry;\n}\n\nexport interface IExtensionApiFactory {\n\t(extension: IExtensionDescription, extensionInfo: IExtensionRegistries, configProvider: ExtHostConfigProvider): typeof vscode;\n}\n\n/**\n * This method instantiates and returns the extension API surface\n */\nexport function createApiFactoryAndRegisterActors(accessor: ServicesAccessor): IExtensionApiFactory {\n\n\t// services\n\tconst initData = accessor.get(IExtHostInitDataService);\n\tconst extHostFileSystemInfo = accessor.get(IExtHostFileSystemInfo);\n\tconst extHostConsumerFileSystem = accessor.get(IExtHostConsumerFileSystem);\n\tconst extensionService = accessor.get(IExtHostExtensionService);\n\tconst extHostWorkspace = accessor.get(IExtHostWorkspace);\n\tconst extHostTelemetry = accessor.get(IExtHostTelemetry);\n\tconst extHostConfiguration = accessor.get(IExtHostConfiguration);\n\tconst uriTransformer = accessor.get(IURITransformerService);\n\tconst rpcProtocol = accessor.get(IExtHostRpcService);\n\tconst extHostStorage = accessor.get(IExtHostStorage);\n\tconst extensionStoragePaths = accessor.get(IExtensionStoragePaths);\n\tconst extHostLoggerService = accessor.get(ILoggerService);\n\tconst extHostLogService = accessor.get(ILogService);\n\tconst extHostTunnelService = accessor.get(IExtHostTunnelService);\n\tconst extHostApiDeprecation = accessor.get(IExtHostApiDeprecationService);\n\tconst extHostWindow = accessor.get(IExtHostWindow);\n\tconst extHostSecretState = accessor.get(IExtHostSecretState);\n\tconst extHostEditorTabs = accessor.get(IExtHostEditorTabs);\n\n\t// register addressable instances\n\trpcProtocol.set(ExtHostContext.ExtHostFileSystemInfo, extHostFileSystemInfo);\n\trpcProtocol.set(ExtHostContext.ExtHostLogLevelServiceShape, <ExtHostLogLevelServiceShape><any>extHostLoggerService);\n\trpcProtocol.set(ExtHostContext.ExtHostWorkspace, extHostWorkspace);\n\trpcProtocol.set(ExtHostContext.ExtHostConfiguration, extHostConfiguration);\n\trpcProtocol.set(ExtHostContext.ExtHostExtensionService, extensionService);\n\trpcProtocol.set(ExtHostContext.ExtHostStorage, extHostStorage);\n\trpcProtocol.set(ExtHostContext.ExtHostTunnelService, extHostTunnelService);\n\trpcProtocol.set(ExtHostContext.ExtHostWindow, extHostWindow);\n\trpcProtocol.set(ExtHostContext.ExtHostSecretState, extHostSecretState);\n\trpcProtocol.set(ExtHostContext.ExtHostTelemetry, extHostTelemetry);\n\trpcProtocol.set(ExtHostContext.ExtHostEditorTabs, extHostEditorTabs);\n\n\t// automatically create and register addressable instances\n\tconst extHostDecorations = rpcProtocol.set(ExtHostContext.ExtHostDecorations, accessor.get(IExtHostDecorations));\n\tconst extHostDocumentsAndEditors = rpcProtocol.set(ExtHostContext.ExtHostDocumentsAndEditors, accessor.get(IExtHostDocumentsAndEditors));\n\tconst extHostCommands = rpcProtocol.set(ExtHostContext.ExtHostCommands, accessor.get(IExtHostCommands));\n\tconst extHostTerminalService = rpcProtocol.set(ExtHostContext.ExtHostTerminalService, accessor.get(IExtHostTerminalService));\n\tconst extHostDebugService = rpcProtocol.set(ExtHostContext.ExtHostDebugService, accessor.get(IExtHostDebugService));\n\tconst extHostSearch = rpcProtocol.set(ExtHostContext.ExtHostSearch, accessor.get(IExtHostSearch));\n\tconst extHostTask = rpcProtocol.set(ExtHostContext.ExtHostTask, accessor.get(IExtHostTask));\n\tconst extHostOutputService = rpcProtocol.set(ExtHostContext.ExtHostOutputService, accessor.get(IExtHostOutputService));\n\n\t// manually create and register addressable instances\n\tconst extHostUrls = rpcProtocol.set(ExtHostContext.ExtHostUrls, new ExtHostUrls(rpcProtocol));\n\tconst extHostDocuments = rpcProtocol.set(ExtHostContext.ExtHostDocuments, new ExtHostDocuments(rpcProtocol, extHostDocumentsAndEditors));\n\tconst extHostDocumentContentProviders = rpcProtocol.set(ExtHostContext.ExtHostDocumentContentProviders, new ExtHostDocumentContentProvider(rpcProtocol, extHostDocumentsAndEditors, extHostLogService));\n\tconst extHostDocumentSaveParticipant = rpcProtocol.set(ExtHostContext.ExtHostDocumentSaveParticipant, new ExtHostDocumentSaveParticipant(extHostLogService, extHostDocuments, rpcProtocol.getProxy(MainContext.MainThreadBulkEdits)));\n\tconst extHostNotebook = rpcProtocol.set(ExtHostContext.ExtHostNotebook, new ExtHostNotebookController(rpcProtocol, extHostCommands, extHostDocumentsAndEditors, extHostDocuments, extensionStoragePaths));\n\tconst extHostNotebookDocuments = rpcProtocol.set(ExtHostContext.ExtHostNotebookDocuments, new ExtHostNotebookDocuments(extHostNotebook));\n\tconst extHostNotebookEditors = rpcProtocol.set(ExtHostContext.ExtHostNotebookEditors, new ExtHostNotebookEditors(extHostLogService, extHostNotebook));\n\tconst extHostNotebookKernels = rpcProtocol.set(ExtHostContext.ExtHostNotebookKernels, new ExtHostNotebookKernels(rpcProtocol, initData, extHostNotebook, extHostCommands, extHostLogService));\n\tconst extHostNotebookRenderers = rpcProtocol.set(ExtHostContext.ExtHostNotebookRenderers, new ExtHostNotebookRenderers(rpcProtocol, extHostNotebook));\n\tconst extHostEditors = rpcProtocol.set(ExtHostContext.ExtHostEditors, new ExtHostEditors(rpcProtocol, extHostDocumentsAndEditors));\n\tconst extHostTreeViews = rpcProtocol.set(ExtHostContext.ExtHostTreeViews, new ExtHostTreeViews(rpcProtocol.getProxy(MainContext.MainThreadTreeViews), extHostCommands, extHostLogService));\n\tconst extHostEditorInsets = rpcProtocol.set(ExtHostContext.ExtHostEditorInsets, new ExtHostEditorInsets(rpcProtocol.getProxy(MainContext.MainThreadEditorInsets), extHostEditors, initData.remote));\n\tconst extHostDiagnostics = rpcProtocol.set(ExtHostContext.ExtHostDiagnostics, new ExtHostDiagnostics(rpcProtocol, extHostLogService, extHostFileSystemInfo));\n\tconst extHostLanguages = rpcProtocol.set(ExtHostContext.ExtHostLanguages, new ExtHostLanguages(rpcProtocol, extHostDocuments, extHostCommands.converter, uriTransformer));\n\tconst extHostLanguageFeatures = rpcProtocol.set(ExtHostContext.ExtHostLanguageFeatures, new ExtHostLanguageFeatures(rpcProtocol, uriTransformer, extHostDocuments, extHostCommands, extHostDiagnostics, extHostLogService, extHostApiDeprecation));\n\tconst extHostFileSystem = rpcProtocol.set(ExtHostContext.ExtHostFileSystem, new ExtHostFileSystem(rpcProtocol, extHostLanguageFeatures));\n\tconst extHostFileSystemEvent = rpcProtocol.set(ExtHostContext.ExtHostFileSystemEventService, new ExtHostFileSystemEventService(rpcProtocol, extHostLogService, extHostDocumentsAndEditors));\n\tconst extHostQuickOpen = rpcProtocol.set(ExtHostContext.ExtHostQuickOpen, createExtHostQuickOpen(rpcProtocol, extHostWorkspace, extHostCommands));\n\tconst extHostSCM = rpcProtocol.set(ExtHostContext.ExtHostSCM, new ExtHostSCM(rpcProtocol, extHostCommands, extHostLogService));\n\tconst extHostComment = rpcProtocol.set(ExtHostContext.ExtHostComments, createExtHostComments(rpcProtocol, extHostCommands, extHostDocuments));\n\tconst extHostProgress = rpcProtocol.set(ExtHostContext.ExtHostProgress, new ExtHostProgress(rpcProtocol.getProxy(MainContext.MainThreadProgress)));\n\tconst extHostLabelService = rpcProtocol.set(ExtHostContext.ExtHosLabelService, new ExtHostLabelService(rpcProtocol));\n\tconst extHostTheming = rpcProtocol.set(ExtHostContext.ExtHostTheming, new ExtHostTheming(rpcProtocol));\n\tconst extHostAuthentication = rpcProtocol.set(ExtHostContext.ExtHostAuthentication, new ExtHostAuthentication(rpcProtocol));\n\tconst extHostTimeline = rpcProtocol.set(ExtHostContext.ExtHostTimeline, new ExtHostTimeline(rpcProtocol, extHostCommands));\n\tconst extHostWebviews = rpcProtocol.set(ExtHostContext.ExtHostWebviews, new ExtHostWebviews(rpcProtocol, initData.remote, extHostWorkspace, extHostLogService, extHostApiDeprecation));\n\tconst extHostWebviewPanels = rpcProtocol.set(ExtHostContext.ExtHostWebviewPanels, new ExtHostWebviewPanels(rpcProtocol, extHostWebviews, extHostWorkspace));\n\tconst extHostCustomEditors = rpcProtocol.set(ExtHostContext.ExtHostCustomEditors, new ExtHostCustomEditors(rpcProtocol, extHostDocuments, extensionStoragePaths, extHostWebviews, extHostWebviewPanels));\n\tconst extHostWebviewViews = rpcProtocol.set(ExtHostContext.ExtHostWebviewViews, new ExtHostWebviewViews(rpcProtocol, extHostWebviews));\n\tconst extHostTesting = rpcProtocol.set(ExtHostContext.ExtHostTesting, new ExtHostTesting(rpcProtocol, extHostCommands));\n\tconst extHostUriOpeners = rpcProtocol.set(ExtHostContext.ExtHostUriOpeners, new ExtHostUriOpeners(rpcProtocol));\n\trpcProtocol.set(ExtHostContext.ExtHostInteractive, new ExtHostInteractive(rpcProtocol, extHostNotebook, extHostDocumentsAndEditors, extHostCommands, extHostLogService));\n\n\t// Check that no named customers are missing\n\tconst expected = Object.values<ProxyIdentifier<any>>(ExtHostContext);\n\trpcProtocol.assertRegistered(expected);\n\n\t// Other instances\n\tconst extHostBulkEdits = new ExtHostBulkEdits(rpcProtocol, extHostDocumentsAndEditors);\n\tconst extHostClipboard = new ExtHostClipboard(rpcProtocol);\n\tconst extHostMessageService = new ExtHostMessageService(rpcProtocol, extHostLogService);\n\tconst extHostDialogs = new ExtHostDialogs(rpcProtocol);\n\tconst extHostStatusBar = new ExtHostStatusBar(rpcProtocol, extHostCommands.converter);\n\n\t// Register API-ish commands\n\tExtHostApiCommands.register(extHostCommands);\n\n\treturn function (extension: IExtensionDescription, extensionInfo: IExtensionRegistries, configProvider: ExtHostConfigProvider): typeof vscode {\n\n\t\t// Check document selectors for being overly generic. Technically this isn't a problem but\n\t\t// in practice many extensions say they support `fooLang` but need fs-access to do so. Those\n\t\t// extension should specify then the `file`-scheme, e.g. `{ scheme: 'fooLang', language: 'fooLang' }`\n\t\t// We only inform once, it is not a warning because we just want to raise awareness and because\n\t\t// we cannot say if the extension is doing it right or wrong...\n\t\tconst checkSelector = (function () {\n\t\t\tlet done = !extension.isUnderDevelopment;\n\t\t\tfunction informOnce() {\n\t\t\t\tif (!done) {\n\t\t\t\t\textHostLogService.info(`Extension '${extension.identifier.value}' uses a document selector without scheme. Learn more about this: https://go.microsoft.com/fwlink/?linkid=872305`);\n\t\t\t\t\tdone = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn function perform(selector: vscode.DocumentSelector): vscode.DocumentSelector {\n\t\t\t\tif (Array.isArray(selector)) {\n\t\t\t\t\tselector.forEach(perform);\n\t\t\t\t} else if (typeof selector === 'string') {\n\t\t\t\t\tinformOnce();\n\t\t\t\t} else {\n\t\t\t\t\tconst filter = selector as vscode.DocumentFilter; // TODO: microsoft/TypeScript#42768\n\t\t\t\t\tif (typeof filter.scheme === 'undefined') {\n\t\t\t\t\t\tinformOnce();\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof filter.exclusive === 'boolean') {\n\t\t\t\t\t\tcheckProposedApiEnabled(extension, 'documentFiltersExclusive');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn selector;\n\t\t\t};\n\t\t})();\n\n\t\tconst authentication: typeof vscode.authentication = {\n\t\t\tgetSession(providerId: string, scopes: readonly string[], options?: vscode.AuthenticationGetSessionOptions) {\n\t\t\t\treturn extHostAuthentication.getSession(extension, providerId, scopes, options as any);\n\t\t\t},\n\t\t\t// TODO: remove this after GHPR and Codespaces move off of it\n\t\t\tasync hasSession(providerId: string, scopes: readonly string[]) {\n\t\t\t\tcheckProposedApiEnabled(extension, 'authSession');\n\t\t\t\treturn !!(await extHostAuthentication.getSession(extension, providerId, scopes, { silent: true } as any));\n\t\t\t},\n\t\t\tget onDidChangeSessions(): Event<vscode.AuthenticationSessionsChangeEvent> {\n\t\t\t\treturn extHostAuthentication.onDidChangeSessions;\n\t\t\t},\n\t\t\tregisterAuthenticationProvider(id: string, label: string, provider: vscode.AuthenticationProvider, options?: vscode.AuthenticationProviderOptions): vscode.Disposable {\n\t\t\t\treturn extHostAuthentication.registerAuthenticationProvider(id, label, provider, options);\n\t\t\t}\n\t\t};\n\n\t\t// namespace: commands\n\t\tconst commands: typeof vscode.commands = {\n\t\t\tregisterCommand(id: string, command: <T>(...args: any[]) => T | Thenable<T>, thisArgs?: any): vscode.Disposable {\n\t\t\t\treturn extHostCommands.registerCommand(true, id, command, thisArgs, undefined, extension);\n\t\t\t},\n\t\t\tregisterTextEditorCommand(id: string, callback: (textEditor: vscode.TextEditor, edit: vscode.TextEditorEdit, ...args: any[]) => void, thisArg?: any): vscode.Disposable {\n\t\t\t\treturn extHostCommands.registerCommand(true, id, (...args: any[]): any => {\n\t\t\t\t\tconst activeTextEditor = extHostEditors.getActiveTextEditor();\n\t\t\t\t\tif (!activeTextEditor) {\n\t\t\t\t\t\textHostLogService.warn('Cannot execute ' + id + ' because there is no active text editor.');\n\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn activeTextEditor.edit((edit: vscode.TextEditorEdit) => {\n\t\t\t\t\t\tcallback.apply(thisArg, [activeTextEditor, edit, ...args]);\n\n\t\t\t\t\t}).then((result) => {\n\t\t\t\t\t\tif (!result) {\n\t\t\t\t\t\t\textHostLogService.warn('Edits from command ' + id + ' were not applied.');\n\t\t\t\t\t\t}\n\t\t\t\t\t}, (err) => {\n\t\t\t\t\t\textHostLogService.warn('An error occurred while running command ' + id, err);\n\t\t\t\t\t});\n\t\t\t\t}, undefined, undefined, extension);\n\t\t\t},\n\t\t\tregisterDiffInformationCommand: (id: string, callback: (diff: vscode.LineChange[], ...args: any[]) => any, thisArg?: any): vscode.Disposable => {\n\t\t\t\tcheckProposedApiEnabled(extension, 'diffCommand');\n\t\t\t\treturn extHostCommands.registerCommand(true, id, async (...args: any[]): Promise<any> => {\n\t\t\t\t\tconst activeTextEditor = extHostDocumentsAndEditors.activeEditor(true);\n\t\t\t\t\tif (!activeTextEditor) {\n\t\t\t\t\t\textHostLogService.warn('Cannot execute ' + id + ' because there is no active text editor.');\n\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst diff = await extHostEditors.getDiffInformation(activeTextEditor.id);\n\t\t\t\t\tcallback.apply(thisArg, [diff, ...args]);\n\t\t\t\t}, undefined, undefined, extension);\n\t\t\t},\n\t\t\texecuteCommand<T>(id: string, ...args: any[]): Thenable<T> {\n\t\t\t\treturn extHostCommands.executeCommand<T>(id, ...args);\n\t\t\t},\n\t\t\tgetCommands(filterInternal: boolean = false): Thenable<string[]> {\n\t\t\t\treturn extHostCommands.getCommands(filterInternal);\n\t\t\t}\n\t\t};\n\n\t\t// namespace: env\n\t\tconst env: typeof vscode.env = {\n\t\t\tget machineId() { return initData.telemetryInfo.machineId; },\n\t\t\tget sessionId() { return initData.telemetryInfo.sessionId; },\n\t\t\tget language() { return initData.environment.appLanguage; },\n\t\t\tget appName() { return initData.environment.appName; },\n\t\t\tget appRoot() { return initData.environment.appRoot?.fsPath ?? ''; },\n\t\t\tget appHost() { return initData.environment.appHost; },\n\t\t\tget uriScheme() { return initData.environment.appUriScheme; },\n\t\t\tget clipboard(): vscode.Clipboard { return extHostClipboard.value; },\n\t\t\tget shell() {\n\t\t\t\treturn extHostTerminalService.getDefaultShell(false);\n\t\t\t},\n\t\t\tget isTelemetryEnabled() {\n\t\t\t\treturn extHostTelemetry.getTelemetryConfiguration();\n\t\t\t},\n\t\t\tget onDidChangeTelemetryEnabled(): Event<boolean> {\n\t\t\t\treturn extHostTelemetry.onDidChangeTelemetryEnabled;\n\t\t\t},\n\t\t\tget telemetryConfiguration(): vscode.TelemetryConfiguration {\n\t\t\t\tcheckProposedApiEnabled(extension, 'telemetry');\n\t\t\t\treturn extHostTelemetry.getTelemetryDetails();\n\t\t\t},\n\t\t\tget onDidChangeTelemetryConfiguration(): Event<vscode.TelemetryConfiguration> {\n\t\t\t\tcheckProposedApiEnabled(extension, 'telemetry');\n\t\t\t\treturn extHostTelemetry.onDidChangeTelemetryConfiguration;\n\t\t\t},\n\t\t\tget isNewAppInstall() {\n\t\t\t\tconst installAge = Date.now() - new Date(initData.telemetryInfo.firstSessionDate).getTime();\n\t\t\t\treturn isNaN(installAge) ? false : installAge < 1000 * 60 * 60 * 24; // install age is less than a day\n\t\t\t},\n\t\t\topenExternal(uri: URI, options?: { allowContributedOpeners?: boolean | string }) {\n\t\t\t\treturn extHostWindow.openUri(uri, {\n\t\t\t\t\tallowTunneling: !!initData.remote.authority,\n\t\t\t\t\tallowContributedOpeners: options?.allowContributedOpeners,\n\t\t\t\t});\n\t\t\t},\n\t\t\tasync asExternalUri(uri: URI) {\n\t\t\t\tif (uri.scheme === initData.environment.appUriScheme) {\n\t\t\t\t\treturn extHostUrls.createAppUri(uri);\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\treturn await extHostWindow.asExternalUri(uri, { allowTunneling: !!initData.remote.authority });\n\t\t\t\t} catch (err) {\n\t\t\t\t\tif (matchesScheme(uri, Schemas.http) || matchesScheme(uri, Schemas.https)) {\n\t\t\t\t\t\treturn uri;\n\t\t\t\t\t}\n\n\t\t\t\t\tthrow err;\n\t\t\t\t}\n\t\t\t},\n\t\t\tget remoteName() {\n\t\t\t\treturn getRemoteName(initData.remote.authority);\n\t\t\t},\n\t\t\tget remoteAuthority() {\n\t\t\t\tcheckProposedApiEnabled(extension, 'resolvers');\n\t\t\t\treturn initData.remote.authority;\n\t\t\t},\n\t\t\tget uiKind() {\n\t\t\t\treturn initData.uiKind;\n\t\t\t}\n\t\t};\n\t\tif (!initData.environment.extensionTestsLocationURI) {\n\t\t\t// allow to patch env-function when running tests\n\t\t\tObject.freeze(env);\n\t\t}\n\n\t\t// namespace: tests\n\t\tconst tests: typeof vscode.tests = {\n\t\t\tcreateTestController(provider, label, refreshHandler?: (token: vscode.CancellationToken) => Thenable<void> | void) {\n\t\t\t\treturn extHostTesting.createTestController(provider, label, refreshHandler);\n\t\t\t},\n\t\t\tcreateTestObserver() {\n\t\t\t\tcheckProposedApiEnabled(extension, 'testObserver');\n\t\t\t\treturn extHostTesting.createTestObserver();\n\t\t\t},\n\t\t\trunTests(provider) {\n\t\t\t\tcheckProposedApiEnabled(extension, 'testObserver');\n\t\t\t\treturn extHostTesting.runTests(provider);\n\t\t\t},\n\t\t\tget onDidChangeTestResults() {\n\t\t\t\tcheckProposedApiEnabled(extension, 'testObserver');\n\t\t\t\treturn extHostTesting.onResultsChanged;\n\t\t\t},\n\t\t\tget testResults() {\n\t\t\t\tcheckProposedApiEnabled(extension, 'testObserver');\n\t\t\t\treturn extHostTesting.results;\n\t\t\t},\n\t\t};\n\n\t\t// namespace: extensions\n\t\tconst extensionKind = initData.remote.isRemote\n\t\t\t? extHostTypes.ExtensionKind.Workspace\n\t\t\t: extHostTypes.ExtensionKind.UI;\n\n\t\tconst extensions: typeof vscode.extensions = {\n\t\t\tgetExtension(extensionId: string, includeFromDifferentExtensionHosts?: boolean): vscode.Extension<any> | undefined {\n\t\t\t\tif (equalsIgnoreCase(extensionId, 'ms-vscode.references-view')) {\n\t\t\t\t\textHostApiDeprecation.report(`The extension 'ms-vscode.references-view' has been renamed.`, extension, `Use 'vscode.references-view' instead.`);\n\t\t\t\t\textensionId = 'vscode.references-view';\n\t\t\t\t}\n\n\t\t\t\tif (!isProposedApiEnabled(extension, 'extensionsAny')) {\n\t\t\t\t\tincludeFromDifferentExtensionHosts = false;\n\t\t\t\t}\n\t\t\t\tconst mine = extensionInfo.mine.getExtensionDescription(extensionId);\n\t\t\t\tif (mine) {\n\t\t\t\t\treturn new Extension(extensionService, extension.identifier, mine, extensionKind, false);\n\t\t\t\t}\n\t\t\t\tif (includeFromDifferentExtensionHosts) {\n\t\t\t\t\tconst foreign = extensionInfo.all.getExtensionDescription(extensionId);\n\t\t\t\t\tif (foreign) {\n\t\t\t\t\t\treturn new Extension(extensionService, extension.identifier, foreign, extensionKind /* TODO@alexdima THIS IS WRONG */, true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t},\n\t\t\tget all(): vscode.Extension<any>[] {\n\t\t\t\tconst result: vscode.Extension<any>[] = [];\n\t\t\t\tfor (const desc of extensionInfo.mine.getAllExtensionDescriptions()) {\n\t\t\t\t\tresult.push(new Extension(extensionService, extension.identifier, desc, extensionKind, false));\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\tget allAcrossExtensionHosts(): vscode.Extension<any>[] {\n\t\t\t\tcheckProposedApiEnabled(extension, 'extensionsAny');\n\t\t\t\tconst local = new ExtensionIdentifierSet(extensionInfo.mine.getAllExtensionDescriptions().map(desc => desc.identifier));\n\t\t\t\tconst result: vscode.Extension<any>[] = [];\n\t\t\t\tfor (const desc of extensionInfo.all.getAllExtensionDescriptions()) {\n\t\t\t\t\tconst isFromDifferentExtensionHost = !local.has(desc.identifier);\n\t\t\t\t\tresult.push(new Extension(extensionService, extension.identifier, desc, extensionKind /* TODO@alexdima THIS IS WRONG */, isFromDifferentExtensionHost));\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\tget onDidChange() {\n\t\t\t\tif (isProposedApiEnabled(extension, 'extensionsAny')) {\n\t\t\t\t\treturn Event.any(extensionInfo.mine.onDidChange, extensionInfo.all.onDidChange);\n\t\t\t\t}\n\t\t\t\treturn extensionInfo.mine.onDidChange;\n\t\t\t}\n\t\t};\n\n\t\t// namespace: languages\n\t\tconst languages: typeof vscode.languages = {\n\t\t\tcreateDiagnosticCollection(name?: string): vscode.DiagnosticCollection {\n\t\t\t\treturn extHostDiagnostics.createDiagnosticCollection(extension.identifier, name);\n\t\t\t},\n\t\t\tget onDidChangeDiagnostics() {\n\t\t\t\treturn extHostDiagnostics.onDidChangeDiagnostics;\n\t\t\t},\n\t\t\tgetDiagnostics: (resource?: vscode.Uri) => {\n\t\t\t\treturn <any>extHostDiagnostics.getDiagnostics(resource);\n\t\t\t},\n\t\t\tgetLanguages(): Thenable<string[]> {\n\t\t\t\treturn extHostLanguages.getLanguages();\n\t\t\t},\n\t\t\tsetTextDocumentLanguage(document: vscode.TextDocument, languageId: string): Thenable<vscode.TextDocument> {\n\t\t\t\treturn extHostLanguages.changeLanguage(document.uri, languageId);\n\t\t\t},\n\t\t\tmatch(selector: vscode.DocumentSelector, document: vscode.TextDocument): number {\n\t\t\t\tconst notebook = extHostDocuments.getDocumentData(document.uri)?.notebook;\n\t\t\t\treturn score(typeConverters.LanguageSelector.from(selector), document.uri, document.languageId, true, notebook?.uri, notebook?.notebookType);\n\t\t\t},\n\t\t\tregisterCodeActionsProvider(selector: vscode.DocumentSelector, provider: vscode.CodeActionProvider, metadata?: vscode.CodeActionProviderMetadata): vscode.Disposable {\n\t\t\t\treturn extHostLanguageFeatures.registerCodeActionProvider(extension, checkSelector(selector), provider, metadata);\n\t\t\t},\n\t\t\tregisterDocumentPasteEditProvider(selector: vscode.DocumentSelector, provider: vscode.DocumentPasteEditProvider, metadata: vscode.DocumentPasteProviderMetadata): vscode.Disposable {\n\t\t\t\tcheckProposedApiEnabled(extension, 'documentPaste');\n\t\t\t\treturn extHostLanguageFeatures.registerDocumentPasteEditProvider(extension, checkSelector(selector), provider, metadata);\n\t\t\t},\n\t\t\tregisterCodeLensProvider(selector: vscode.DocumentSelector, provider: vscode.CodeLensProvider): vscode.Disposable {\n\t\t\t\treturn extHostLanguageFeatures.registerCodeLensProvider(extension, checkSelector(selector), provider);\n\t\t\t},\n\t\t\tregisterDefinitionProvider(selector: vscode.DocumentSelector, provider: vscode.DefinitionProvider): vscode.Disposable {\n\t\t\t\treturn extHostLanguageFeatures.registerDefinitionProvider(extension, checkSelector(selector), provider);\n\t\t\t},\n\t\t\tregisterDeclarationProvider(selector: vscode.DocumentSelector, provider: vscode.DeclarationProvider): vscode.Disposable {\n\t\t\t\treturn extHostLanguageFeatures.registerDeclarationProvider(extension, checkSelector(selector), provider);\n\t\t\t},\n\t\t\tregisterImplementationProvider(selector: vscode.DocumentSelector, provider: vscode.ImplementationProvider): vscode.Disposable {\n\t\t\t\treturn extHostLanguageFeatures.registerImplementationProvider(extension, checkSelector(selector), provider);\n\t\t\t},\n\t\t\tregisterTypeDefinitionProvider(selector: vscode.DocumentSelector, provider: vscode.TypeDefinitionProvider): vscode.Disposable {\n\t\t\t\treturn extHostLanguageFeatures.registerTypeDefinitionProvider(extension, checkSelector(selector), provider);\n\t\t\t},\n\t\t\tregisterHoverProvider(selector: vscode.DocumentSelector, provider: vscode.HoverProvider): vscode.Disposable {\n\t\t\t\treturn extHostLanguageFeatures.registerHoverProvider(extension, checkSelector(selector), provider, extension.identifier);\n\t\t\t},\n\t\t\tregisterEvaluatableExpressionProvider(selector: vscode.DocumentSelector, provider: vscode.EvaluatableExpressionProvider): vscode.Disposable {\n\t\t\t\treturn extHostLanguageFeatures.registerEvaluatableExpressionProvider(extension, checkSelector(selector), provider, extension.identifier);\n\t\t\t},\n\t\t\tregisterInlineValuesProvider(selector: vscode.DocumentSelector, provider: vscode.InlineValuesProvider): vscode.Disposable {\n\t\t\t\treturn extHostLanguageFeatures.registerInlineValuesProvider(extension, checkSelector(selector), provider, extension.identifier);\n\t\t\t},\n\t\t\tregisterDocumentHighlightProvider(selector: vscode.DocumentSelector, provider: vscode.DocumentHighlightProvider): vscode.Disposable {\n\t\t\t\treturn extHostLanguageFeatures.registerDocumentHighlightProvider(extension, checkSelector(selector), provider);\n\t\t\t},\n\t\t\tregisterLinkedEditingRangeProvider(selector: vscode.DocumentSelector, provider: vscode.LinkedEditingRangeProvider): vscode.Disposable {\n\t\t\t\treturn extHostLanguageFeatures.registerLinkedEditingRangeProvider(extension, checkSelector(selector), provider);\n\t\t\t},\n\t\t\tregisterReferenceProvider(selector: vscode.DocumentSelector, provider: vscode.ReferenceProvider): vscode.Disposable {\n\t\t\t\treturn extHostLanguageFeatures.registerReferenceProvider(extension, checkSelector(selector), provider);\n\t\t\t},\n\t\t\tregisterRenameProvider(selector: vscode.DocumentSelector, provider: vscode.RenameProvider): vscode.Disposable {\n\t\t\t\treturn extHostLanguageFeatures.registerRenameProvider(extension, checkSelector(selector), provider);\n\t\t\t},\n\t\t\tregisterDocumentSymbolProvider(selector: vscode.DocumentSelector, provider: vscode.DocumentSymbolProvider, metadata?: vscode.DocumentSymbolProviderMetadata): vscode.Disposable {\n\t\t\t\treturn extHostLanguageFeatures.registerDocumentSymbolProvider(extension, checkSelector(selector), provider, metadata);\n\t\t\t},\n\t\t\tregisterWorkspaceSymbolProvider(provider: vscode.WorkspaceSymbolProvider): vscode.Disposable {\n\t\t\t\treturn extHostLanguageFeatures.registerWorkspaceSymbolProvider(extension, provider);\n\t\t\t},\n\t\t\tregisterDocumentFormattingEditProvider(selector: vscode.DocumentSelector, provider: vscode.DocumentFormattingEditProvider): vscode.Disposable {\n\t\t\t\treturn extHostLanguageFeatures.registerDocumentFormattingEditProvider(extension, checkSelector(selector), provider);\n\t\t\t},\n\t\t\tregisterDocumentRangeFormattingEditProvider(selector: vscode.DocumentSelector, provider: vscode.DocumentRangeFormattingEditProvider): vscode.Disposable {\n\t\t\t\treturn extHostLanguageFeatures.registerDocumentRangeFormattingEditProvider(extension, checkSelector(selector), provider);\n\t\t\t},\n\t\t\tregisterOnTypeFormattingEditProvider(selector: vscode.DocumentSelector, provider: vscode.OnTypeFormattingEditProvider, firstTriggerCharacter: string, ...moreTriggerCharacters: string[]): vscode.Disposable {\n\t\t\t\treturn extHostLanguageFeatures.registerOnTypeFormattingEditProvider(extension, checkSelector(selector), provider, [firstTriggerCharacter].concat(moreTriggerCharacters));\n\t\t\t},\n\t\t\tregisterDocumentSemanticTokensProvider(selector: vscode.DocumentSelector, provider: vscode.DocumentSemanticTokensProvider, legend: vscode.SemanticTokensLegend): vscode.Disposable {\n\t\t\t\treturn extHostLanguageFeatures.registerDocumentSemanticTokensProvider(extension, checkSelector(selector), provider, legend);\n\t\t\t},\n\t\t\tregisterDocumentRangeSemanticTokensProvider(selector: vscode.DocumentSelector, provider: vscode.DocumentRangeSemanticTokensProvider, legend: vscode.SemanticTokensLegend): vscode.Disposable {\n\t\t\t\treturn extHostLanguageFeatures.registerDocumentRangeSemanticTokensProvider(extension, checkSelector(selector), provider, legend);\n\t\t\t},\n\t\t\tregisterSignatureHelpProvider(selector: vscode.DocumentSelector, provider: vscode.SignatureHelpProvider, firstItem?: string | vscode.SignatureHelpProviderMetadata, ...remaining: string[]): vscode.Disposable {\n\t\t\t\tif (typeof firstItem === 'object') {\n\t\t\t\t\treturn extHostLanguageFeatures.registerSignatureHelpProvider(extension, checkSelector(selector), provider, firstItem);\n\t\t\t\t}\n\t\t\t\treturn extHostLanguageFeatures.registerSignatureHelpProvider(extension, checkSelector(selector), provider, typeof firstItem === 'undefined' ? [] : [firstItem, ...remaining]);\n\t\t\t},\n\t\t\tregisterCompletionItemProvider(selector: vscode.DocumentSelector, provider: vscode.CompletionItemProvider, ...triggerCharacters: string[]): vscode.Disposable {\n\t\t\t\treturn extHostLanguageFeatures.registerCompletionItemProvider(extension, checkSelector(selector), provider, triggerCharacters);\n\t\t\t},\n\t\t\tregisterInlineCompletionItemProvider(selector: vscode.DocumentSelector, provider: vscode.InlineCompletionItemProvider): vscode.Disposable {\n\t\t\t\tif (provider.handleDidShowCompletionItem) {\n\t\t\t\t\tcheckProposedApiEnabled(extension, 'inlineCompletionsAdditions');\n\t\t\t\t}\n\t\t\t\treturn extHostLanguageFeatures.registerInlineCompletionsProvider(extension, checkSelector(selector), provider);\n\t\t\t},\n\t\t\tregisterInlineCompletionItemProviderNew(selector: vscode.DocumentSelector, provider: vscode.InlineCompletionItemProviderNew): vscode.Disposable {\n\t\t\t\tcheckProposedApiEnabled(extension, 'inlineCompletionsNew');\n\t\t\t\tif (provider.handleDidShowCompletionItem && !isProposedApiEnabled(extension, 'inlineCompletionsAdditions')) {\n\t\t\t\t\tthrow new Error(`When the method \"handleDidShowCompletionItem\" is implemented on a provider, the usage of the proposed api 'inlineCompletionsAdditions' must be declared!`);\n\t\t\t\t}\n\t\t\t\treturn extHostLanguageFeatures.registerInlineCompletionsProviderNew(extension, checkSelector(selector), provider);\n\t\t\t},\n\t\t\tregisterDocumentLinkProvider(selector: vscode.DocumentSelector, provider: vscode.DocumentLinkProvider): vscode.Disposable {\n\t\t\t\treturn extHostLanguageFeatures.registerDocumentLinkProvider(extension, checkSelector(selector), provider);\n\t\t\t},\n\t\t\tregisterColorProvider(selector: vscode.DocumentSelector, provider: vscode.DocumentColorProvider): vscode.Disposable {\n\t\t\t\treturn extHostLanguageFeatures.registerColorProvider(extension, checkSelector(selector), provider);\n\t\t\t},\n\t\t\tregisterFoldingRangeProvider(selector: vscode.DocumentSelector, provider: vscode.FoldingRangeProvider): vscode.Disposable {\n\t\t\t\treturn extHostLanguageFeatures.registerFoldingRangeProvider(extension, checkSelector(selector), provider);\n\t\t\t},\n\t\t\tregisterSelectionRangeProvider(selector: vscode.DocumentSelector, provider: vscode.SelectionRangeProvider): vscode.Disposable {\n\t\t\t\treturn extHostLanguageFeatures.registerSelectionRangeProvider(extension, selector, provider);\n\t\t\t},\n\t\t\tregisterCallHierarchyProvider(selector: vscode.DocumentSelector, provider: vscode.CallHierarchyProvider): vscode.Disposable {\n\t\t\t\treturn extHostLanguageFeatures.registerCallHierarchyProvider(extension, selector, provider);\n\t\t\t},\n\t\t\tregisterTypeHierarchyProvider(selector: vscode.DocumentSelector, provider: vscode.TypeHierarchyProvider): vscode.Disposable {\n\t\t\t\treturn extHostLanguageFeatures.registerTypeHierarchyProvider(extension, selector, provider);\n\t\t\t},\n\t\t\tsetLanguageConfiguration: (language: string, configuration: vscode.LanguageConfiguration): vscode.Disposable => {\n\t\t\t\treturn extHostLanguageFeatures.setLanguageConfiguration(extension, language, configuration);\n\t\t\t},\n\t\t\tgetTokenInformationAtPosition(doc: vscode.TextDocument, pos: vscode.Position) {\n\t\t\t\tcheckProposedApiEnabled(extension, 'tokenInformation');\n\t\t\t\treturn extHostLanguages.tokenAtPosition(doc, pos);\n\t\t\t},\n\t\t\tregisterInlayHintsProvider(selector: vscode.DocumentSelector, provider: vscode.InlayHintsProvider): vscode.Disposable {\n\t\t\t\treturn extHostLanguageFeatures.registerInlayHintsProvider(extension, selector, provider);\n\t\t\t},\n\t\t\tcreateLanguageStatusItem(id: string, selector: vscode.DocumentSelector): vscode.LanguageStatusItem {\n\t\t\t\treturn extHostLanguages.createLanguageStatusItem(extension, id, selector);\n\t\t\t},\n\t\t\tregisterDocumentDropEditProvider(selector: vscode.DocumentSelector, provider: vscode.DocumentDropEditProvider): vscode.Disposable {\n\t\t\t\treturn extHostLanguageFeatures.registerDocumentOnDropEditProvider(extension, selector, provider);\n\t\t\t}\n\t\t};\n\n\t\t// namespace: window\n\t\tconst window: typeof vscode.window = {\n\t\t\tget activeTextEditor() {\n\t\t\t\treturn extHostEditors.getActiveTextEditor();\n\t\t\t},\n\t\t\tget visibleTextEditors() {\n\t\t\t\treturn extHostEditors.getVisibleTextEditors();\n\t\t\t},\n\t\t\tget activeTerminal() {\n\t\t\t\treturn extHostTerminalService.activeTerminal;\n\t\t\t},\n\t\t\tget terminals() {\n\t\t\t\treturn extHostTerminalService.terminals;\n\t\t\t},\n\t\t\tasync showTextDocument(documentOrUri: vscode.TextDocument | vscode.Uri, columnOrOptions?: vscode.ViewColumn | vscode.TextDocumentShowOptions, preserveFocus?: boolean): Promise<vscode.TextEditor> {\n\t\t\t\tconst document = await (URI.isUri(documentOrUri)\n\t\t\t\t\t? Promise.resolve(workspace.openTextDocument(documentOrUri))\n\t\t\t\t\t: Promise.resolve(<vscode.TextDocument>documentOrUri));\n\n\t\t\t\treturn extHostEditors.showTextDocument(document, columnOrOptions, preserveFocus);\n\t\t\t},\n\t\t\tcreateTextEditorDecorationType(options: vscode.DecorationRenderOptions): vscode.TextEditorDecorationType {\n\t\t\t\treturn extHostEditors.createTextEditorDecorationType(extension, options);\n\t\t\t},\n\t\t\tonDidChangeActiveTextEditor(listener, thisArg?, disposables?) {\n\t\t\t\treturn extHostEditors.onDidChangeActiveTextEditor(listener, thisArg, disposables);\n\t\t\t},\n\t\t\tonDidChangeVisibleTextEditors(listener, thisArg, disposables) {\n\t\t\t\treturn extHostEditors.onDidChangeVisibleTextEditors(listener, thisArg, disposables);\n\t\t\t},\n\t\t\tonDidChangeTextEditorSelection(listener: (e: vscode.TextEditorSelectionChangeEvent) => any, thisArgs?: any, disposables?: extHostTypes.Disposable[]) {\n\t\t\t\treturn extHostEditors.onDidChangeTextEditorSelection(listener, thisArgs, disposables);\n\t\t\t},\n\t\t\tonDidChangeTextEditorOptions(listener: (e: vscode.TextEditorOptionsChangeEvent) => any, thisArgs?: any, disposables?: extHostTypes.Disposable[]) {\n\t\t\t\treturn extHostEditors.onDidChangeTextEditorOptions(listener, thisArgs, disposables);\n\t\t\t},\n\t\t\tonDidChangeTextEditorVisibleRanges(listener: (e: vscode.TextEditorVisibleRangesChangeEvent) => any, thisArgs?: any, disposables?: extHostTypes.Disposable[]) {\n\t\t\t\treturn extHostEditors.onDidChangeTextEditorVisibleRanges(listener, thisArgs, disposables);\n\t\t\t},\n\t\t\tonDidChangeTextEditorViewColumn(listener, thisArg?, disposables?) {\n\t\t\t\treturn extHostEditors.onDidChangeTextEditorViewColumn(listener, thisArg, disposables);\n\t\t\t},\n\t\t\tonDidCloseTerminal(listener, thisArg?, disposables?) {\n\t\t\t\treturn extHostTerminalService.onDidCloseTerminal(listener, thisArg, disposables);\n\t\t\t},\n\t\t\tonDidOpenTerminal(listener, thisArg?, disposables?) {\n\t\t\t\treturn extHostTerminalService.onDidOpenTerminal(listener, thisArg, disposables);\n\t\t\t},\n\t\t\tonDidChangeActiveTerminal(listener, thisArg?, disposables?) {\n\t\t\t\treturn extHostTerminalService.onDidChangeActiveTerminal(listener, thisArg, disposables);\n\t\t\t},\n\t\t\tonDidChangeTerminalDimensions(listener, thisArg?, disposables?) {\n\t\t\t\tcheckProposedApiEnabled(extension, 'terminalDimensions');\n\t\t\t\treturn extHostTerminalService.onDidChangeTerminalDimensions(listener, thisArg, disposables);\n\t\t\t},\n\t\t\tonDidChangeTerminalState(listener, thisArg?, disposables?) {\n\t\t\t\treturn extHostTerminalService.onDidChangeTerminalState(listener, thisArg, disposables);\n\t\t\t},\n\t\t\tonDidWriteTerminalData(listener, thisArg?, disposables?) {\n\t\t\t\tcheckProposedApiEnabled(extension, 'terminalDataWriteEvent');\n\t\t\t\treturn extHostTerminalService.onDidWriteTerminalData(listener, thisArg, disposables);\n\t\t\t},\n\t\t\tget state() {\n\t\t\t\treturn extHostWindow.state;\n\t\t\t},\n\t\t\tonDidChangeWindowState(listener, thisArg?, disposables?) {\n\t\t\t\treturn extHostWindow.onDidChangeWindowState(listener, thisArg, disposables);\n\t\t\t},\n\t\t\tshowInformationMessage(message: string, ...rest: Array<vscode.MessageOptions | string | vscode.MessageItem>) {\n\t\t\t\treturn <Thenable<any>>extHostMessageService.showMessage(extension, Severity.Info, message, rest[0], <Array<string | vscode.MessageItem>>rest.slice(1));\n\t\t\t},\n\t\t\tshowWarningMessage(message: string, ...rest: Array<vscode.MessageOptions | string | vscode.MessageItem>) {\n\t\t\t\treturn <Thenable<any>>extHostMessageService.showMessage(extension, Severity.Warning, message, rest[0], <Array<string | vscode.MessageItem>>rest.slice(1));\n\t\t\t},\n\t\t\tshowErrorMessage(message: string, ...rest: Array<vscode.MessageOptions | string | vscode.MessageItem>) {\n\t\t\t\treturn <Thenable<any>>extHostMessageService.showMessage(extension, Severity.Error, message, rest[0], <Array<string | vscode.MessageItem>>rest.slice(1));\n\t\t\t},\n\t\t\tshowQuickPick(items: any, options?: vscode.QuickPickOptions, token?: vscode.CancellationToken): any {\n\t\t\t\treturn extHostQuickOpen.showQuickPick(items, options, token);\n\t\t\t},\n\t\t\tshowWorkspaceFolderPick(options?: vscode.WorkspaceFolderPickOptions) {\n\t\t\t\treturn extHostQuickOpen.showWorkspaceFolderPick(options);\n\t\t\t},\n\t\t\tshowInputBox(options?: vscode.InputBoxOptions, token?: vscode.CancellationToken) {\n\t\t\t\treturn extHostQuickOpen.showInput(options, token);\n\t\t\t},\n\t\t\tshowOpenDialog(options) {\n\t\t\t\treturn extHostDialogs.showOpenDialog(options);\n\t\t\t},\n\t\t\tshowSaveDialog(options) {\n\t\t\t\treturn extHostDialogs.showSaveDialog(options);\n\t\t\t},\n\t\t\tcreateStatusBarItem(alignmentOrId?: vscode.StatusBarAlignment | string, priorityOrAlignment?: number | vscode.StatusBarAlignment, priorityArg?: number): vscode.StatusBarItem {\n\t\t\t\tlet id: string | undefined;\n\t\t\t\tlet alignment: number | undefined;\n\t\t\t\tlet priority: number | undefined;\n\n\t\t\t\tif (typeof alignmentOrId === 'string') {\n\t\t\t\t\tid = alignmentOrId;\n\t\t\t\t\talignment = priorityOrAlignment;\n\t\t\t\t\tpriority = priorityArg;\n\t\t\t\t} else {\n\t\t\t\t\talignment = alignmentOrId;\n\t\t\t\t\tpriority = priorityOrAlignment;\n\t\t\t\t}\n\n\t\t\t\treturn extHostStatusBar.createStatusBarEntry(extension, id, alignment, priority);\n\t\t\t},\n\t\t\tsetStatusBarMessage(text: string, timeoutOrThenable?: number | Thenable<any>): vscode.Disposable {\n\t\t\t\treturn extHostStatusBar.setStatusBarMessage(text, timeoutOrThenable);\n\t\t\t},\n\t\t\twithScmProgress<R>(task: (progress: vscode.Progress<number>) => Thenable<R>) {\n\t\t\t\textHostApiDeprecation.report('window.withScmProgress', extension,\n\t\t\t\t\t`Use 'withProgress' instead.`);\n\n\t\t\t\treturn extHostProgress.withProgress(extension, { location: extHostTypes.ProgressLocation.SourceControl }, (progress, token) => task({ report(n: number) { /*noop*/ } }));\n\t\t\t},\n\t\t\twithProgress<R>(options: vscode.ProgressOptions, task: (progress: vscode.Progress<{ message?: string; worked?: number }>, token: vscode.CancellationToken) => Thenable<R>) {\n\t\t\t\treturn extHostProgress.withProgress(extension, options, task);\n\t\t\t},\n\t\t\tcreateOutputChannel(name: string, languageId?: string): vscode.OutputChannel {\n\t\t\t\treturn extHostOutputService.createOutputChannel(name, languageId, extension);\n\t\t\t},\n\t\t\tcreateWebviewPanel(viewType: string, title: string, showOptions: vscode.ViewColumn | { viewColumn: vscode.ViewColumn; preserveFocus?: boolean }, options?: vscode.WebviewPanelOptions & vscode.WebviewOptions): vscode.WebviewPanel {\n\t\t\t\treturn extHostWebviewPanels.createWebviewPanel(extension, viewType, title, showOptions, options);\n\t\t\t},\n\t\t\tcreateWebviewTextEditorInset(editor: vscode.TextEditor, line: number, height: number, options?: vscode.WebviewOptions): vscode.WebviewEditorInset {\n\t\t\t\tcheckProposedApiEnabled(extension, 'editorInsets');\n\t\t\t\treturn extHostEditorInsets.createWebviewEditorInset(editor, line, height, options, extension);\n\t\t\t},\n\t\t\tcreateTerminal(nameOrOptions?: vscode.TerminalOptions | vscode.ExtensionTerminalOptions | string, shellPath?: string, shellArgs?: readonly string[] | string): vscode.Terminal {\n\t\t\t\tif (typeof nameOrOptions === 'object') {\n\t\t\t\t\tif ('pty' in nameOrOptions) {\n\t\t\t\t\t\treturn extHostTerminalService.createExtensionTerminal(nameOrOptions);\n\t\t\t\t\t}\n\t\t\t\t\treturn extHostTerminalService.createTerminalFromOptions(nameOrOptions);\n\t\t\t\t}\n\t\t\t\treturn extHostTerminalService.createTerminal(nameOrOptions, shellPath, shellArgs);\n\t\t\t},\n\t\t\tregisterTerminalLinkProvider(provider: vscode.TerminalLinkProvider): vscode.Disposable {\n\t\t\t\treturn extHostTerminalService.registerLinkProvider(provider);\n\t\t\t},\n\t\t\tregisterTerminalProfileProvider(id: string, provider: vscode.TerminalProfileProvider): vscode.Disposable {\n\t\t\t\treturn extHostTerminalService.registerProfileProvider(extension, id, provider);\n\t\t\t},\n\t\t\tregisterTreeDataProvider(viewId: string, treeDataProvider: vscode.TreeDataProvider<any>): vscode.Disposable {\n\t\t\t\treturn extHostTreeViews.registerTreeDataProvider(viewId, treeDataProvider, extension);\n\t\t\t},\n\t\t\tcreateTreeView(viewId: string, options: { treeDataProvider: vscode.TreeDataProvider<any> }): vscode.TreeView<any> {\n\t\t\t\treturn extHostTreeViews.createTreeView(viewId, options, extension);\n\t\t\t},\n\t\t\tregisterWebviewPanelSerializer: (viewType: string, serializer: vscode.WebviewPanelSerializer) => {\n\t\t\t\treturn extHostWebviewPanels.registerWebviewPanelSerializer(extension, viewType, serializer);\n\t\t\t},\n\t\t\tregisterCustomEditorProvider: (viewType: string, provider: vscode.CustomTextEditorProvider | vscode.CustomReadonlyEditorProvider, options: { webviewOptions?: vscode.WebviewPanelOptions; supportsMultipleEditorsPerDocument?: boolean } = {}) => {\n\t\t\t\treturn extHostCustomEditors.registerCustomEditorProvider(extension, viewType, provider, options);\n\t\t\t},\n\t\t\tregisterFileDecorationProvider(provider: vscode.FileDecorationProvider) {\n\t\t\t\treturn extHostDecorations.registerFileDecorationProvider(provider, extension.identifier);\n\t\t\t},\n\t\t\tregisterUriHandler(handler: vscode.UriHandler) {\n\t\t\t\treturn extHostUrls.registerUriHandler(extension.identifier, handler);\n\t\t\t},\n\t\t\tcreateQuickPick<T extends vscode.QuickPickItem>(): vscode.QuickPick<T> {\n\t\t\t\treturn extHostQuickOpen.createQuickPick(extension);\n\t\t\t},\n\t\t\tcreateInputBox(): vscode.InputBox {\n\t\t\t\treturn extHostQuickOpen.createInputBox(extension);\n\t\t\t},\n\t\t\tget activeColorTheme(): vscode.ColorTheme {\n\t\t\t\treturn extHostTheming.activeColorTheme;\n\t\t\t},\n\t\t\tonDidChangeActiveColorTheme(listener, thisArg?, disposables?) {\n\t\t\t\treturn extHostTheming.onDidChangeActiveColorTheme(listener, thisArg, disposables);\n\t\t\t},\n\t\t\tregisterWebviewViewProvider(viewId: string, provider: vscode.WebviewViewProvider, options?: {\n\t\t\t\twebviewOptions?: {\n\t\t\t\t\tretainContextWhenHidden?: boolean;\n\t\t\t\t};\n\t\t\t}) {\n\t\t\t\treturn extHostWebviewViews.registerWebviewViewProvider(extension, viewId, provider, options?.webviewOptions);\n\t\t\t},\n\t\t\tget activeNotebookEditor(): vscode.NotebookEditor | undefined {\n\t\t\t\treturn extHostNotebook.activeNotebookEditor;\n\t\t\t},\n\t\t\tonDidChangeActiveNotebookEditor(listener, thisArgs?, disposables?) {\n\t\t\t\treturn extHostNotebook.onDidChangeActiveNotebookEditor(listener, thisArgs, disposables);\n\t\t\t},\n\t\t\tget visibleNotebookEditors() {\n\t\t\t\treturn extHostNotebook.visibleNotebookEditors;\n\t\t\t},\n\t\t\tget onDidChangeVisibleNotebookEditors() {\n\t\t\t\treturn extHostNotebook.onDidChangeVisibleNotebookEditors;\n\t\t\t},\n\t\t\tonDidChangeNotebookEditorSelection(listener, thisArgs?, disposables?) {\n\t\t\t\treturn extHostNotebookEditors.onDidChangeNotebookEditorSelection(listener, thisArgs, disposables);\n\t\t\t},\n\t\t\tonDidChangeNotebookEditorVisibleRanges(listener, thisArgs?, disposables?) {\n\t\t\t\treturn extHostNotebookEditors.onDidChangeNotebookEditorVisibleRanges(listener, thisArgs, disposables);\n\t\t\t},\n\t\t\tshowNotebookDocument(uriOrDocument, options?) {\n\t\t\t\tif (URI.isUri(uriOrDocument)) {\n\t\t\t\t\textHostApiDeprecation.report('window.showNotebookDocument(uri)', extension,\n\t\t\t\t\t\t`Please use 'workspace.openNotebookDocument' and 'window.showNotebookDocument'`);\n\t\t\t\t}\n\t\t\t\treturn extHostNotebook.showNotebookDocument(uriOrDocument, options);\n\t\t\t},\n\t\t\tregisterExternalUriOpener(id: string, opener: vscode.ExternalUriOpener, metadata: vscode.ExternalUriOpenerMetadata) {\n\t\t\t\tcheckProposedApiEnabled(extension, 'externalUriOpener');\n\t\t\t\treturn extHostUriOpeners.registerExternalUriOpener(extension.identifier, id, opener, metadata);\n\t\t\t},\n\t\t\tget tabGroups(): vscode.TabGroups {\n\t\t\t\treturn extHostEditorTabs.tabGroups;\n\t\t\t},\n\t\t};\n\n\t\t// namespace: workspace\n\n\t\tconst workspace: typeof vscode.workspace = {\n\t\t\tget rootPath() {\n\t\t\t\textHostApiDeprecation.report('workspace.rootPath', extension,\n\t\t\t\t\t`Please use 'workspace.workspaceFolders' instead. More details: https://aka.ms/vscode-eliminating-rootpath`);\n\n\t\t\t\treturn extHostWorkspace.getPath();\n\t\t\t},\n\t\t\tset rootPath(value) {\n\t\t\t\tthrow errors.readonly();\n\t\t\t},\n\t\t\tgetWorkspaceFolder(resource) {\n\t\t\t\treturn extHostWorkspace.getWorkspaceFolder(resource);\n\t\t\t},\n\t\t\tget workspaceFolders() {\n\t\t\t\treturn extHostWorkspace.getWorkspaceFolders();\n\t\t\t},\n\t\t\tget name() {\n\t\t\t\treturn extHostWorkspace.name;\n\t\t\t},\n\t\t\tset name(value) {\n\t\t\t\tthrow errors.readonly();\n\t\t\t},\n\t\t\tget workspaceFile() {\n\t\t\t\treturn extHostWorkspace.workspaceFile;\n\t\t\t},\n\t\t\tset workspaceFile(value) {\n\t\t\t\tthrow errors.readonly();\n\t\t\t},\n\t\t\tupdateWorkspaceFolders: (index, deleteCount, ...workspaceFoldersToAdd) => {\n\t\t\t\treturn extHostWorkspace.updateWorkspaceFolders(extension, index, deleteCount || 0, ...workspaceFoldersToAdd);\n\t\t\t},\n\t\t\tonDidChangeWorkspaceFolders: function (listener, thisArgs?, disposables?) {\n\t\t\t\treturn extHostWorkspace.onDidChangeWorkspace(listener, thisArgs, disposables);\n\t\t\t},\n\t\t\tasRelativePath: (pathOrUri, includeWorkspace?) => {\n\t\t\t\treturn extHostWorkspace.getRelativePath(pathOrUri, includeWorkspace);\n\t\t\t},\n\t\t\tfindFiles: (include, exclude, maxResults?, token?) => {\n\t\t\t\t// Note, undefined/null have different meanings on \"exclude\"\n\t\t\t\treturn extHostWorkspace.findFiles(include, exclude, maxResults, extension.identifier, token);\n\t\t\t},\n\t\t\tfindTextInFiles: (query: vscode.TextSearchQuery, optionsOrCallback: vscode.FindTextInFilesOptions | ((result: vscode.TextSearchResult) => void), callbackOrToken?: vscode.CancellationToken | ((result: vscode.TextSearchResult) => void), token?: vscode.CancellationToken) => {\n\t\t\t\tcheckProposedApiEnabled(extension, 'findTextInFiles');\n\t\t\t\tlet options: vscode.FindTextInFilesOptions;\n\t\t\t\tlet callback: (result: vscode.TextSearchResult) => void;\n\n\t\t\t\tif (typeof optionsOrCallback === 'object') {\n\t\t\t\t\toptions = optionsOrCallback;\n\t\t\t\t\tcallback = callbackOrToken as (result: vscode.TextSearchResult) => void;\n\t\t\t\t} else {\n\t\t\t\t\toptions = {};\n\t\t\t\t\tcallback = optionsOrCallback;\n\t\t\t\t\ttoken = callbackOrToken as vscode.CancellationToken;\n\t\t\t\t}\n\n\t\t\t\treturn extHostWorkspace.findTextInFiles(query, options || {}, callback, extension.identifier, token);\n\t\t\t},\n\t\t\tsaveAll: (includeUntitled?) => {\n\t\t\t\treturn extHostWorkspace.saveAll(includeUntitled);\n\t\t\t},\n\t\t\tapplyEdit(edit: vscode.WorkspaceEdit): Thenable<boolean> {\n\t\t\t\treturn extHostBulkEdits.applyWorkspaceEdit(edit, extension);\n\t\t\t},\n\t\t\tcreateFileSystemWatcher: (pattern, ignoreCreate, ignoreChange, ignoreDelete): vscode.FileSystemWatcher => {\n\t\t\t\treturn extHostFileSystemEvent.createFileSystemWatcher(extHostWorkspace, extension, pattern, ignoreCreate, ignoreChange, ignoreDelete);\n\t\t\t},\n\t\t\tget textDocuments() {\n\t\t\t\treturn extHostDocuments.getAllDocumentData().map(data => data.document);\n\t\t\t},\n\t\t\tset textDocuments(value) {\n\t\t\t\tthrow errors.readonly();\n\t\t\t},\n\t\t\topenTextDocument(uriOrFileNameOrOptions?: vscode.Uri | string | { language?: string; content?: string }) {\n\t\t\t\tlet uriPromise: Thenable<URI>;\n\n\t\t\t\tconst options = uriOrFileNameOrOptions as { language?: string; content?: string };\n\t\t\t\tif (typeof uriOrFileNameOrOptions === 'string') {\n\t\t\t\t\turiPromise = Promise.resolve(URI.file(uriOrFileNameOrOptions));\n\t\t\t\t} else if (URI.isUri(uriOrFileNameOrOptions)) {\n\t\t\t\t\turiPromise = Promise.resolve(uriOrFileNameOrOptions);\n\t\t\t\t} else if (!options || typeof options === 'object') {\n\t\t\t\t\turiPromise = extHostDocuments.createDocumentData(options);\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error('illegal argument - uriOrFileNameOrOptions');\n\t\t\t\t}\n\n\t\t\t\treturn uriPromise.then(uri => {\n\t\t\t\t\treturn extHostDocuments.ensureDocumentData(uri).then(documentData => {\n\t\t\t\t\t\treturn documentData.document;\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tonDidOpenTextDocument: (listener, thisArgs?, disposables?) => {\n\t\t\t\treturn extHostDocuments.onDidAddDocument(listener, thisArgs, disposables);\n\t\t\t},\n\t\t\tonDidCloseTextDocument: (listener, thisArgs?, disposables?) => {\n\t\t\t\treturn extHostDocuments.onDidRemoveDocument(listener, thisArgs, disposables);\n\t\t\t},\n\t\t\tonDidChangeTextDocument: (listener, thisArgs?, disposables?) => {\n\t\t\t\treturn extHostDocuments.onDidChangeDocument(listener, thisArgs, disposables);\n\t\t\t},\n\t\t\tonDidSaveTextDocument: (listener, thisArgs?, disposables?) => {\n\t\t\t\treturn extHostDocuments.onDidSaveDocument(listener, thisArgs, disposables);\n\t\t\t},\n\t\t\tonWillSaveTextDocument: (listener, thisArgs?, disposables?) => {\n\t\t\t\treturn extHostDocumentSaveParticipant.getOnWillSaveTextDocumentEvent(extension)(listener, thisArgs, disposables);\n\t\t\t},\n\t\t\tget notebookDocuments(): vscode.NotebookDocument[] {\n\t\t\t\treturn extHostNotebook.notebookDocuments.map(d => d.apiNotebook);\n\t\t\t},\n\t\t\tasync openNotebookDocument(uriOrType?: URI | string, content?: vscode.NotebookData) {\n\t\t\t\tlet uri: URI;\n\t\t\t\tif (URI.isUri(uriOrType)) {\n\t\t\t\t\turi = uriOrType;\n\t\t\t\t\tawait extHostNotebook.openNotebookDocument(uriOrType);\n\t\t\t\t} else if (typeof uriOrType === 'string') {\n\t\t\t\t\turi = URI.revive(await extHostNotebook.createNotebookDocument({ viewType: uriOrType, content }));\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error('Invalid arguments');\n\t\t\t\t}\n\t\t\t\treturn extHostNotebook.getNotebookDocument(uri).apiNotebook;\n\t\t\t},\n\t\t\tonDidSaveNotebookDocument(listener, thisArg, disposables) {\n\t\t\t\treturn extHostNotebookDocuments.onDidSaveNotebookDocument(listener, thisArg, disposables);\n\t\t\t},\n\t\t\tonDidChangeNotebookDocument(listener, thisArg, disposables) {\n\t\t\t\treturn extHostNotebookDocuments.onDidChangeNotebookDocument(listener, thisArg, disposables);\n\t\t\t},\n\t\t\tget onDidOpenNotebookDocument(): Event<vscode.NotebookDocument> {\n\t\t\t\treturn extHostNotebook.onDidOpenNotebookDocument;\n\t\t\t},\n\t\t\tget onDidCloseNotebookDocument(): Event<vscode.NotebookDocument> {\n\t\t\t\treturn extHostNotebook.onDidCloseNotebookDocument;\n\t\t\t},\n\t\t\tregisterNotebookSerializer(viewType: string, serializer: vscode.NotebookSerializer, options?: vscode.NotebookDocumentContentOptions, registration?: vscode.NotebookRegistrationData) {\n\t\t\t\treturn extHostNotebook.registerNotebookSerializer(extension, viewType, serializer, options, isProposedApiEnabled(extension, 'notebookLiveShare') ? registration : undefined);\n\t\t\t},\n\t\t\tregisterNotebookContentProvider: (viewType: string, provider: vscode.NotebookContentProvider, options?: vscode.NotebookDocumentContentOptions, registration?: vscode.NotebookRegistrationData) => {\n\t\t\t\tcheckProposedApiEnabled(extension, 'notebookContentProvider');\n\n\t\t\t\textHostApiDeprecation.report('workspace.registerNotebookContentProvider', extension,\n\t\t\t\t\t`The notebookContentProvider API is not on track for finalization and will be removed.`);\n\n\t\t\t\treturn extHostNotebook.registerNotebookContentProvider(extension, viewType, provider, options, isProposedApiEnabled(extension, 'notebookLiveShare') ? registration : undefined);\n\t\t\t},\n\t\t\tonDidChangeConfiguration: (listener: (_: any) => any, thisArgs?: any, disposables?: extHostTypes.Disposable[]) => {\n\t\t\t\treturn configProvider.onDidChangeConfiguration(listener, thisArgs, disposables);\n\t\t\t},\n\t\t\tgetConfiguration(section?: string, scope?: vscode.ConfigurationScope | null): vscode.WorkspaceConfiguration {\n\t\t\t\tscope = arguments.length === 1 ? undefined : scope;\n\t\t\t\treturn configProvider.getConfiguration(section, scope, extension);\n\t\t\t},\n\t\t\tregisterTextDocumentContentProvider(scheme: string, provider: vscode.TextDocumentContentProvider) {\n\t\t\t\treturn extHostDocumentContentProviders.registerTextDocumentContentProvider(scheme, provider);\n\t\t\t},\n\t\t\tregisterTaskProvider: (type: string, provider: vscode.TaskProvider) => {\n\t\t\t\textHostApiDeprecation.report('window.registerTaskProvider', extension,\n\t\t\t\t\t`Use the corresponding function on the 'tasks' namespace instead`);\n\n\t\t\t\treturn extHostTask.registerTaskProvider(extension, type, provider);\n\t\t\t},\n\t\t\tregisterFileSystemProvider(scheme, provider, options) {\n\t\t\t\treturn combinedDisposable(\n\t\t\t\t\textHostFileSystem.registerFileSystemProvider(extension, scheme, provider, options),\n\t\t\t\t\textHostConsumerFileSystem.addFileSystemProvider(scheme, provider)\n\t\t\t\t);\n\t\t\t},\n\t\t\tget fs() {\n\t\t\t\treturn extHostConsumerFileSystem.value;\n\t\t\t},\n\t\t\tregisterFileSearchProvider: (scheme: string, provider: vscode.FileSearchProvider) => {\n\t\t\t\tcheckProposedApiEnabled(extension, 'fileSearchProvider');\n\t\t\t\treturn extHostSearch.registerFileSearchProvider(scheme, provider);\n\t\t\t},\n\t\t\tregisterTextSearchProvider: (scheme: string, provider: vscode.TextSearchProvider) => {\n\t\t\t\tcheckProposedApiEnabled(extension, 'textSearchProvider');\n\t\t\t\treturn extHostSearch.registerTextSearchProvider(scheme, provider);\n\t\t\t},\n\t\t\tregisterRemoteAuthorityResolver: (authorityPrefix: string, resolver: vscode.RemoteAuthorityResolver) => {\n\t\t\t\tcheckProposedApiEnabled(extension, 'resolvers');\n\t\t\t\treturn extensionService.registerRemoteAuthorityResolver(authorityPrefix, resolver);\n\t\t\t},\n\t\t\tregisterResourceLabelFormatter: (formatter: vscode.ResourceLabelFormatter) => {\n\t\t\t\tcheckProposedApiEnabled(extension, 'resolvers');\n\t\t\t\treturn extHostLabelService.$registerResourceLabelFormatter(formatter);\n\t\t\t},\n\t\t\tonDidCreateFiles: (listener, thisArg, disposables) => {\n\t\t\t\treturn extHostFileSystemEvent.onDidCreateFile(listener, thisArg, disposables);\n\t\t\t},\n\t\t\tonDidDeleteFiles: (listener, thisArg, disposables) => {\n\t\t\t\treturn extHostFileSystemEvent.onDidDeleteFile(listener, thisArg, disposables);\n\t\t\t},\n\t\t\tonDidRenameFiles: (listener, thisArg, disposables) => {\n\t\t\t\treturn extHostFileSystemEvent.onDidRenameFile(listener, thisArg, disposables);\n\t\t\t},\n\t\t\tonWillCreateFiles: (listener: (e: vscode.FileWillCreateEvent) => any, thisArg?: any, disposables?: vscode.Disposable[]) => {\n\t\t\t\treturn extHostFileSystemEvent.getOnWillCreateFileEvent(extension)(listener, thisArg, disposables);\n\t\t\t},\n\t\t\tonWillDeleteFiles: (listener: (e: vscode.FileWillDeleteEvent) => any, thisArg?: any, disposables?: vscode.Disposable[]) => {\n\t\t\t\treturn extHostFileSystemEvent.getOnWillDeleteFileEvent(extension)(listener, thisArg, disposables);\n\t\t\t},\n\t\t\tonWillRenameFiles: (listener: (e: vscode.FileWillRenameEvent) => any, thisArg?: any, disposables?: vscode.Disposable[]) => {\n\t\t\t\treturn extHostFileSystemEvent.getOnWillRenameFileEvent(extension)(listener, thisArg, disposables);\n\t\t\t},\n\t\t\topenTunnel: (forward: vscode.TunnelOptions) => {\n\t\t\t\tcheckProposedApiEnabled(extension, 'resolvers');\n\t\t\t\treturn extHostTunnelService.openTunnel(extension, forward).then(value => {\n\t\t\t\t\tif (!value) {\n\t\t\t\t\t\tthrow new Error('cannot open tunnel');\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t});\n\t\t\t},\n\t\t\tget tunnels() {\n\t\t\t\tcheckProposedApiEnabled(extension, 'resolvers');\n\t\t\t\treturn extHostTunnelService.getTunnels();\n\t\t\t},\n\t\t\tonDidChangeTunnels: (listener, thisArg?, disposables?) => {\n\t\t\t\tcheckProposedApiEnabled(extension, 'resolvers');\n\t\t\t\treturn extHostTunnelService.onDidChangeTunnels(listener, thisArg, disposables);\n\t\t\t},\n\t\t\tregisterPortAttributesProvider: (portSelector: { pid?: number; portRange?: [number, number]; commandMatcher?: RegExp }, provider: vscode.PortAttributesProvider) => {\n\t\t\t\tcheckProposedApiEnabled(extension, 'portsAttributes');\n\t\t\t\treturn extHostTunnelService.registerPortsAttributesProvider(portSelector, provider);\n\t\t\t},\n\t\t\tregisterTimelineProvider: (scheme: string | string[], provider: vscode.TimelineProvider) => {\n\t\t\t\tcheckProposedApiEnabled(extension, 'timeline');\n\t\t\t\treturn extHostTimeline.registerTimelineProvider(scheme, provider, extension.identifier, extHostCommands.converter);\n\t\t\t},\n\t\t\tget isTrusted() {\n\t\t\t\treturn extHostWorkspace.trusted;\n\t\t\t},\n\t\t\trequestWorkspaceTrust: (options?: vscode.WorkspaceTrustRequestOptions) => {\n\t\t\t\tcheckProposedApiEnabled(extension, 'workspaceTrust');\n\t\t\t\treturn extHostWorkspace.requestWorkspaceTrust(options);\n\t\t\t},\n\t\t\tonDidGrantWorkspaceTrust: (listener, thisArgs?, disposables?) => {\n\t\t\t\treturn extHostWorkspace.onDidGrantWorkspaceTrust(listener, thisArgs, disposables);\n\t\t\t}\n\t\t};\n\n\t\t// namespace: scm\n\t\tconst scm: typeof vscode.scm = {\n\t\t\tget inputBox() {\n\t\t\t\textHostApiDeprecation.report('scm.inputBox', extension,\n\t\t\t\t\t`Use 'SourceControl.inputBox' instead`);\n\n\t\t\t\treturn extHostSCM.getLastInputBox(extension)!; // Strict null override - Deprecated api\n\t\t\t},\n\t\t\tcreateSourceControl(id: string, label: string, rootUri?: vscode.Uri) {\n\t\t\t\treturn extHostSCM.createSourceControl(extension, id, label, rootUri);\n\t\t\t}\n\t\t};\n\n\t\t// namespace: comments\n\t\tconst comments: typeof vscode.comments = {\n\t\t\tcreateCommentController(id: string, label: string) {\n\t\t\t\treturn extHostComment.createCommentController(extension, id, label);\n\t\t\t}\n\t\t};\n\n\t\t// namespace: debug\n\t\tconst debug: typeof vscode.debug = {\n\t\t\tget activeDebugSession() {\n\t\t\t\treturn extHostDebugService.activeDebugSession;\n\t\t\t},\n\t\t\tget activeDebugConsole() {\n\t\t\t\treturn extHostDebugService.activeDebugConsole;\n\t\t\t},\n\t\t\tget breakpoints() {\n\t\t\t\treturn extHostDebugService.breakpoints;\n\t\t\t},\n\t\t\tonDidStartDebugSession(listener, thisArg?, disposables?) {\n\t\t\t\treturn extHostDebugService.onDidStartDebugSession(listener, thisArg, disposables);\n\t\t\t},\n\t\t\tonDidTerminateDebugSession(listener, thisArg?, disposables?) {\n\t\t\t\treturn extHostDebugService.onDidTerminateDebugSession(listener, thisArg, disposables);\n\t\t\t},\n\t\t\tonDidChangeActiveDebugSession(listener, thisArg?, disposables?) {\n\t\t\t\treturn extHostDebugService.onDidChangeActiveDebugSession(listener, thisArg, disposables);\n\t\t\t},\n\t\t\tonDidReceiveDebugSessionCustomEvent(listener, thisArg?, disposables?) {\n\t\t\t\treturn extHostDebugService.onDidReceiveDebugSessionCustomEvent(listener, thisArg, disposables);\n\t\t\t},\n\t\t\tonDidChangeBreakpoints(listener, thisArgs?, disposables?) {\n\t\t\t\treturn extHostDebugService.onDidChangeBreakpoints(listener, thisArgs, disposables);\n\t\t\t},\n\t\t\tregisterDebugConfigurationProvider(debugType: string, provider: vscode.DebugConfigurationProvider, triggerKind?: vscode.DebugConfigurationProviderTriggerKind) {\n\t\t\t\treturn extHostDebugService.registerDebugConfigurationProvider(debugType, provider, triggerKind || DebugConfigurationProviderTriggerKind.Initial);\n\t\t\t},\n\t\t\tregisterDebugAdapterDescriptorFactory(debugType: string, factory: vscode.DebugAdapterDescriptorFactory) {\n\t\t\t\treturn extHostDebugService.registerDebugAdapterDescriptorFactory(extension, debugType, factory);\n\t\t\t},\n\t\t\tregisterDebugAdapterTrackerFactory(debugType: string, factory: vscode.DebugAdapterTrackerFactory) {\n\t\t\t\treturn extHostDebugService.registerDebugAdapterTrackerFactory(debugType, factory);\n\t\t\t},\n\t\t\tstartDebugging(folder: vscode.WorkspaceFolder | undefined, nameOrConfig: string | vscode.DebugConfiguration, parentSessionOrOptions?: vscode.DebugSession | vscode.DebugSessionOptions) {\n\t\t\t\tif (!parentSessionOrOptions || (typeof parentSessionOrOptions === 'object' && 'configuration' in parentSessionOrOptions)) {\n\t\t\t\t\treturn extHostDebugService.startDebugging(folder, nameOrConfig, { parentSession: parentSessionOrOptions });\n\t\t\t\t}\n\t\t\t\treturn extHostDebugService.startDebugging(folder, nameOrConfig, parentSessionOrOptions || {});\n\t\t\t},\n\t\t\tstopDebugging(session?: vscode.DebugSession) {\n\t\t\t\treturn extHostDebugService.stopDebugging(session);\n\t\t\t},\n\t\t\taddBreakpoints(breakpoints: readonly vscode.Breakpoint[]) {\n\t\t\t\treturn extHostDebugService.addBreakpoints(breakpoints);\n\t\t\t},\n\t\t\tremoveBreakpoints(breakpoints: readonly vscode.Breakpoint[]) {\n\t\t\t\treturn extHostDebugService.removeBreakpoints(breakpoints);\n\t\t\t},\n\t\t\tasDebugSourceUri(source: vscode.DebugProtocolSource, session?: vscode.DebugSession): vscode.Uri {\n\t\t\t\treturn extHostDebugService.asDebugSourceUri(source, session);\n\t\t\t}\n\t\t};\n\n\t\tconst tasks: typeof vscode.tasks = {\n\t\t\tregisterTaskProvider: (type: string, provider: vscode.TaskProvider) => {\n\t\t\t\treturn extHostTask.registerTaskProvider(extension, type, provider);\n\t\t\t},\n\t\t\tfetchTasks: (filter?: vscode.TaskFilter): Thenable<vscode.Task[]> => {\n\t\t\t\treturn extHostTask.fetchTasks(filter);\n\t\t\t},\n\t\t\texecuteTask: (task: vscode.Task): Thenable<vscode.TaskExecution> => {\n\t\t\t\treturn extHostTask.executeTask(extension, task);\n\t\t\t},\n\t\t\tget taskExecutions(): vscode.TaskExecution[] {\n\t\t\t\treturn extHostTask.taskExecutions;\n\t\t\t},\n\t\t\tonDidStartTask: (listeners, thisArgs?, disposables?) => {\n\t\t\t\treturn extHostTask.onDidStartTask(listeners, thisArgs, disposables);\n\t\t\t},\n\t\t\tonDidEndTask: (listeners, thisArgs?, disposables?) => {\n\t\t\t\treturn extHostTask.onDidEndTask(listeners, thisArgs, disposables);\n\t\t\t},\n\t\t\tonDidStartTaskProcess: (listeners, thisArgs?, disposables?) => {\n\t\t\t\treturn extHostTask.onDidStartTaskProcess(listeners, thisArgs, disposables);\n\t\t\t},\n\t\t\tonDidEndTaskProcess: (listeners, thisArgs?, disposables?) => {\n\t\t\t\treturn extHostTask.onDidEndTaskProcess(listeners, thisArgs, disposables);\n\t\t\t}\n\t\t};\n\n\t\t// namespace: notebook\n\t\tconst notebooks: typeof vscode.notebooks = {\n\t\t\tcreateNotebookController(id: string, notebookType: string, label: string, handler?, rendererScripts?: vscode.NotebookRendererScript[]) {\n\t\t\t\treturn extHostNotebookKernels.createNotebookController(extension, id, notebookType, label, handler, isProposedApiEnabled(extension, 'notebookMessaging') ? rendererScripts : undefined);\n\t\t\t},\n\t\t\tregisterNotebookCellStatusBarItemProvider: (notebookType: string, provider: vscode.NotebookCellStatusBarItemProvider) => {\n\t\t\t\treturn extHostNotebook.registerNotebookCellStatusBarItemProvider(extension, notebookType, provider);\n\t\t\t},\n\t\t\tcreateRendererMessaging(rendererId) {\n\t\t\t\treturn extHostNotebookRenderers.createRendererMessaging(extension, rendererId);\n\t\t\t},\n\t\t\tonDidChangeNotebookCellExecutionState(listener, thisArgs?, disposables?) {\n\t\t\t\tcheckProposedApiEnabled(extension, 'notebookCellExecutionState');\n\t\t\t\treturn extHostNotebookKernels.onDidChangeNotebookCellExecutionState(listener, thisArgs, disposables);\n\t\t\t}\n\t\t};\n\n\t\treturn <typeof vscode>{\n\t\t\tversion: initData.version,\n\t\t\t// namespaces\n\t\t\tauthentication,\n\t\t\tcommands,\n\t\t\tcomments,\n\t\t\tdebug,\n\t\t\tenv,\n\t\t\textensions,\n\t\t\tlanguages,\n\t\t\tnotebooks,\n\t\t\tscm,\n\t\t\ttasks,\n\t\t\ttests,\n\t\t\twindow,\n\t\t\tworkspace,\n\t\t\t// types\n\t\t\tBreakpoint: extHostTypes.Breakpoint,\n\t\t\tCallHierarchyIncomingCall: extHostTypes.CallHierarchyIncomingCall,\n\t\t\tCallHierarchyItem: extHostTypes.CallHierarchyItem,\n\t\t\tCallHierarchyOutgoingCall: extHostTypes.CallHierarchyOutgoingCall,\n\t\t\tCancellationError: errors.CancellationError,\n\t\t\tCancellationTokenSource: CancellationTokenSource,\n\t\t\tCandidatePortSource: CandidatePortSource,\n\t\t\tCodeAction: extHostTypes.CodeAction,\n\t\t\tCodeActionKind: extHostTypes.CodeActionKind,\n\t\t\tCodeActionTriggerKind: extHostTypes.CodeActionTriggerKind,\n\t\t\tCodeLens: extHostTypes.CodeLens,\n\t\t\tColor: extHostTypes.Color,\n\t\t\tColorInformation: extHostTypes.ColorInformation,\n\t\t\tColorPresentation: extHostTypes.ColorPresentation,\n\t\t\tColorThemeKind: extHostTypes.ColorThemeKind,\n\t\t\tCommentMode: extHostTypes.CommentMode,\n\t\t\tCommentThreadCollapsibleState: extHostTypes.CommentThreadCollapsibleState,\n\t\t\tCommentThreadState: extHostTypes.CommentThreadState,\n\t\t\tCompletionItem: extHostTypes.CompletionItem,\n\t\t\tCompletionItemKind: extHostTypes.CompletionItemKind,\n\t\t\tCompletionItemTag: extHostTypes.CompletionItemTag,\n\t\t\tCompletionList: extHostTypes.CompletionList,\n\t\t\tCompletionTriggerKind: extHostTypes.CompletionTriggerKind,\n\t\t\tConfigurationTarget: extHostTypes.ConfigurationTarget,\n\t\t\tCustomExecution: extHostTypes.CustomExecution,\n\t\t\tDebugAdapterExecutable: extHostTypes.DebugAdapterExecutable,\n\t\t\tDebugAdapterInlineImplementation: extHostTypes.DebugAdapterInlineImplementation,\n\t\t\tDebugAdapterNamedPipeServer: extHostTypes.DebugAdapterNamedPipeServer,\n\t\t\tDebugAdapterServer: extHostTypes.DebugAdapterServer,\n\t\t\tDebugConfigurationProviderTriggerKind: DebugConfigurationProviderTriggerKind,\n\t\t\tDebugConsoleMode: extHostTypes.DebugConsoleMode,\n\t\t\tDecorationRangeBehavior: extHostTypes.DecorationRangeBehavior,\n\t\t\tDiagnostic: extHostTypes.Diagnostic,\n\t\t\tDiagnosticRelatedInformation: extHostTypes.DiagnosticRelatedInformation,\n\t\t\tDiagnosticSeverity: extHostTypes.DiagnosticSeverity,\n\t\t\tDiagnosticTag: extHostTypes.DiagnosticTag,\n\t\t\tDisposable: extHostTypes.Disposable,\n\t\t\tDocumentHighlight: extHostTypes.DocumentHighlight,\n\t\t\tDocumentHighlightKind: extHostTypes.DocumentHighlightKind,\n\t\t\tDocumentLink: extHostTypes.DocumentLink,\n\t\t\tDocumentSymbol: extHostTypes.DocumentSymbol,\n\t\t\tEndOfLine: extHostTypes.EndOfLine,\n\t\t\tEnvironmentVariableMutatorType: extHostTypes.EnvironmentVariableMutatorType,\n\t\t\tEvaluatableExpression: extHostTypes.EvaluatableExpression,\n\t\t\tInlineValueText: extHostTypes.InlineValueText,\n\t\t\tInlineValueVariableLookup: extHostTypes.InlineValueVariableLookup,\n\t\t\tInlineValueEvaluatableExpression: extHostTypes.InlineValueEvaluatableExpression,\n\t\t\tInlineCompletionTriggerKind: extHostTypes.InlineCompletionTriggerKind,\n\t\t\tInlineCompletionTriggerKindNew: extHostTypes.InlineCompletionTriggerKindNew,\n\t\t\tEventEmitter: Emitter,\n\t\t\tExtensionKind: extHostTypes.ExtensionKind,\n\t\t\tExtensionMode: extHostTypes.ExtensionMode,\n\t\t\tExternalUriOpenerPriority: extHostTypes.ExternalUriOpenerPriority,\n\t\t\tFileChangeType: extHostTypes.FileChangeType,\n\t\t\tFileDecoration: extHostTypes.FileDecoration,\n\t\t\tFileSystemError: extHostTypes.FileSystemError,\n\t\t\tFileType: files.FileType,\n\t\t\tFilePermission: files.FilePermission,\n\t\t\tFoldingRange: extHostTypes.FoldingRange,\n\t\t\tFoldingRangeKind: extHostTypes.FoldingRangeKind,\n\t\t\tFunctionBreakpoint: extHostTypes.FunctionBreakpoint,\n\t\t\tInlineCompletionItem: extHostTypes.InlineSuggestion,\n\t\t\tInlineCompletionItemNew: extHostTypes.InlineSuggestionNew,\n\t\t\tInlineCompletionList: extHostTypes.InlineSuggestionList,\n\t\t\tInlineCompletionListNew: extHostTypes.InlineSuggestionsNew,\n\t\t\tHover: extHostTypes.Hover,\n\t\t\tIndentAction: languageConfiguration.IndentAction,\n\t\t\tLocation: extHostTypes.Location,\n\t\t\tMarkdownString: extHostTypes.MarkdownString,\n\t\t\tOverviewRulerLane: OverviewRulerLane,\n\t\t\tParameterInformation: extHostTypes.ParameterInformation,\n\t\t\tPortAutoForwardAction: extHostTypes.PortAutoForwardAction,\n\t\t\tPosition: extHostTypes.Position,\n\t\t\tProcessExecution: extHostTypes.ProcessExecution,\n\t\t\tProgressLocation: extHostTypes.ProgressLocation,\n\t\t\tQuickInputButtons: extHostTypes.QuickInputButtons,\n\t\t\tRange: extHostTypes.Range,\n\t\t\tRelativePattern: extHostTypes.RelativePattern,\n\t\t\tSelection: extHostTypes.Selection,\n\t\t\tSelectionRange: extHostTypes.SelectionRange,\n\t\t\tSemanticTokens: extHostTypes.SemanticTokens,\n\t\t\tSemanticTokensBuilder: extHostTypes.SemanticTokensBuilder,\n\t\t\tSemanticTokensEdit: extHostTypes.SemanticTokensEdit,\n\t\t\tSemanticTokensEdits: extHostTypes.SemanticTokensEdits,\n\t\t\tSemanticTokensLegend: extHostTypes.SemanticTokensLegend,\n\t\t\tShellExecution: extHostTypes.ShellExecution,\n\t\t\tShellQuoting: extHostTypes.ShellQuoting,\n\t\t\tSignatureHelp: extHostTypes.SignatureHelp,\n\t\t\tSignatureHelpTriggerKind: extHostTypes.SignatureHelpTriggerKind,\n\t\t\tSignatureInformation: extHostTypes.SignatureInformation,\n\t\t\tSnippetString: extHostTypes.SnippetString,\n\t\t\tSourceBreakpoint: extHostTypes.SourceBreakpoint,\n\t\t\tStandardTokenType: extHostTypes.StandardTokenType,\n\t\t\tStatusBarAlignment: extHostTypes.StatusBarAlignment,\n\t\t\tSymbolInformation: extHostTypes.SymbolInformation,\n\t\t\tSymbolKind: extHostTypes.SymbolKind,\n\t\t\tSymbolTag: extHostTypes.SymbolTag,\n\t\t\tTask: extHostTypes.Task,\n\t\t\tTaskGroup: extHostTypes.TaskGroup,\n\t\t\tTaskPanelKind: extHostTypes.TaskPanelKind,\n\t\t\tTaskRevealKind: extHostTypes.TaskRevealKind,\n\t\t\tTaskScope: extHostTypes.TaskScope,\n\t\t\tTerminalLink: extHostTypes.TerminalLink,\n\t\t\tTerminalLocation: extHostTypes.TerminalLocation,\n\t\t\tTerminalProfile: extHostTypes.TerminalProfile,\n\t\t\tTextDocumentSaveReason: extHostTypes.TextDocumentSaveReason,\n\t\t\tTextEdit: extHostTypes.TextEdit,\n\t\t\tTextEditorCursorStyle: TextEditorCursorStyle,\n\t\t\tTextEditorLineNumbersStyle: extHostTypes.TextEditorLineNumbersStyle,\n\t\t\tTextEditorRevealType: extHostTypes.TextEditorRevealType,\n\t\t\tTextEditorSelectionChangeKind: extHostTypes.TextEditorSelectionChangeKind,\n\t\t\tTextDocumentChangeReason: extHostTypes.TextDocumentChangeReason,\n\t\t\tThemeColor: extHostTypes.ThemeColor,\n\t\t\tThemeIcon: extHostTypes.ThemeIcon,\n\t\t\tTreeItem: extHostTypes.TreeItem,\n\t\t\tTreeItemCollapsibleState: extHostTypes.TreeItemCollapsibleState,\n\t\t\tTypeHierarchyItem: extHostTypes.TypeHierarchyItem,\n\t\t\tUIKind: UIKind,\n\t\t\tUri: URI,\n\t\t\tViewColumn: extHostTypes.ViewColumn,\n\t\t\tWorkspaceEdit: extHostTypes.WorkspaceEdit,\n\t\t\t// proposed api types\n\t\t\tDocumentDropEdit: extHostTypes.DocumentDropEdit,\n\t\t\tDocumentPasteEdit: extHostTypes.DocumentPasteEdit,\n\t\t\tInlayHint: extHostTypes.InlayHint,\n\t\t\tInlayHintLabelPart: extHostTypes.InlayHintLabelPart,\n\t\t\tInlayHintKind: extHostTypes.InlayHintKind,\n\t\t\tRemoteAuthorityResolverError: extHostTypes.RemoteAuthorityResolverError,\n\t\t\tResolvedAuthority: extHostTypes.ResolvedAuthority,\n\t\t\tSourceControlInputBoxValidationType: extHostTypes.SourceControlInputBoxValidationType,\n\t\t\tExtensionRuntime: extHostTypes.ExtensionRuntime,\n\t\t\tTimelineItem: extHostTypes.TimelineItem,\n\t\t\tNotebookRange: extHostTypes.NotebookRange,\n\t\t\tNotebookCellKind: extHostTypes.NotebookCellKind,\n\t\t\tNotebookCellExecutionState: extHostTypes.NotebookCellExecutionState,\n\t\t\tNotebookCellData: extHostTypes.NotebookCellData,\n\t\t\tNotebookData: extHostTypes.NotebookData,\n\t\t\tNotebookRendererScript: extHostTypes.NotebookRendererScript,\n\t\t\tNotebookCellStatusBarAlignment: extHostTypes.NotebookCellStatusBarAlignment,\n\t\t\tNotebookEditorRevealType: extHostTypes.NotebookEditorRevealType,\n\t\t\tNotebookCellOutput: extHostTypes.NotebookCellOutput,\n\t\t\tNotebookCellOutputItem: extHostTypes.NotebookCellOutputItem,\n\t\t\tNotebookCellStatusBarItem: extHostTypes.NotebookCellStatusBarItem,\n\t\t\tNotebookControllerAffinity: extHostTypes.NotebookControllerAffinity,\n\t\t\tNotebookEdit: extHostTypes.NotebookEdit,\n\t\t\tPortAttributes: extHostTypes.PortAttributes,\n\t\t\tLinkedEditingRanges: extHostTypes.LinkedEditingRanges,\n\t\t\tTestResultState: extHostTypes.TestResultState,\n\t\t\tTestRunRequest: extHostTypes.TestRunRequest,\n\t\t\tTestMessage: extHostTypes.TestMessage,\n\t\t\tTestTag: extHostTypes.TestTag,\n\t\t\tTestRunProfileKind: extHostTypes.TestRunProfileKind,\n\t\t\tTextSearchCompleteMessageType: TextSearchCompleteMessageType,\n\t\t\tDataTransfer: extHostTypes.DataTransfer,\n\t\t\tDataTransferItem: extHostTypes.DataTransferItem,\n\t\t\tCoveredCount: extHostTypes.CoveredCount,\n\t\t\tFileCoverage: extHostTypes.FileCoverage,\n\t\t\tStatementCoverage: extHostTypes.StatementCoverage,\n\t\t\tBranchCoverage: extHostTypes.BranchCoverage,\n\t\t\tFunctionCoverage: extHostTypes.FunctionCoverage,\n\t\t\tWorkspaceTrustState: extHostTypes.WorkspaceTrustState,\n\t\t\tLanguageStatusSeverity: extHostTypes.LanguageStatusSeverity,\n\t\t\tQuickPickItemKind: extHostTypes.QuickPickItemKind,\n\t\t\tInputBoxValidationSeverity: extHostTypes.InputBoxValidationSeverity,\n\t\t\tTabInputText: extHostTypes.TextTabInput,\n\t\t\tTabInputTextDiff: extHostTypes.TextDiffTabInput,\n\t\t\tTabInputTextMerge: extHostTypes.TextMergeTabInput,\n\t\t\tTabInputCustom: extHostTypes.CustomEditorTabInput,\n\t\t\tTabInputNotebook: extHostTypes.NotebookEditorTabInput,\n\t\t\tTabInputNotebookDiff: extHostTypes.NotebookDiffEditorTabInput,\n\t\t\tTabInputWebview: extHostTypes.WebviewEditorTabInput,\n\t\t\tTabInputTerminal: extHostTypes.TerminalEditorTabInput,\n\t\t\tTabInputInteractiveWindow: extHostTypes.InteractiveWindowInput,\n\t\t\tTerminalExitReason: extHostTypes.TerminalExitReason\n\t\t};\n\t};\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { createApiFactoryAndRegisterActors } from 'vs/workbench/api/common/extHost.api.impl';\nimport { ExtensionActivationTimesBuilder } from 'vs/workbench/api/common/extHostExtensionActivator';\nimport { AbstractExtHostExtensionService } from 'vs/workbench/api/common/extHostExtensionService';\nimport { URI } from 'vs/base/common/uri';\nimport { RequireInterceptor } from 'vs/workbench/api/common/extHostRequireInterceptor';\nimport { ExtensionIdentifier, IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { ExtensionRuntime } from 'vs/workbench/api/common/extHostTypes';\nimport { timeout } from 'vs/base/common/async';\nimport { ExtHostConsoleForwarder } from 'vs/workbench/api/worker/extHostConsoleForwarder';\n\nclass WorkerRequireInterceptor extends RequireInterceptor {\n\n\t_installInterceptor() { }\n\n\tgetModule(request: string, parent: URI): undefined | any {\n\t\tfor (const alternativeModuleName of this._alternatives) {\n\t\t\tconst alternative = alternativeModuleName(request);\n\t\t\tif (alternative) {\n\t\t\t\trequest = alternative;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (this._factories.has(request)) {\n\t\t\treturn this._factories.get(request)!.load(request, parent, () => { throw new Error('CANNOT LOAD MODULE from here.'); });\n\t\t}\n\t\treturn undefined;\n\t}\n}\n\nexport class ExtHostExtensionService extends AbstractExtHostExtensionService {\n\treadonly extensionRuntime = ExtensionRuntime.Webworker;\n\n\tprivate _fakeModules?: WorkerRequireInterceptor;\n\n\tprotected async _beforeAlmostReadyToRunExtensions(): Promise<void> {\n\t\t// make sure console.log calls make it to the render\n\t\tthis._instaService.createInstance(ExtHostConsoleForwarder);\n\n\t\t// initialize API and register actors\n\t\tconst apiFactory = this._instaService.invokeFunction(createApiFactoryAndRegisterActors);\n\t\tthis._fakeModules = this._instaService.createInstance(WorkerRequireInterceptor, apiFactory, { mine: this._myRegistry, all: this._globalRegistry });\n\t\tawait this._fakeModules.install();\n\t\tperformance.mark('code/extHost/didInitAPI');\n\n\t\tawait this._waitForDebuggerAttachment();\n\t}\n\n\tprotected _getEntryPoint(extensionDescription: IExtensionDescription): string | undefined {\n\t\treturn extensionDescription.browser;\n\t}\n\n\tprotected async _loadCommonJSModule<T extends object | undefined>(extensionId: ExtensionIdentifier | null, module: URI, activationTimesBuilder: ExtensionActivationTimesBuilder): Promise<T> {\n\t\tmodule = module.with({ path: ensureSuffix(module.path, '.js') });\n\t\tif (extensionId) {\n\t\t\tperformance.mark(`code/extHost/willFetchExtensionCode/${extensionId.value}`);\n\t\t}\n\n\t\t// First resolve the extension entry point URI to something we can load using `fetch`\n\t\t// This needs to be done on the main thread due to a potential `resourceUriProvider` (workbench api)\n\t\t// which is only available in the main thread\n\t\tconst browserUri = URI.revive(await this._mainThreadExtensionsProxy.$asBrowserUri(module));\n\t\tconst response = await fetch(browserUri.toString(true));\n\t\tif (extensionId) {\n\t\t\tperformance.mark(`code/extHost/didFetchExtensionCode/${extensionId.value}`);\n\t\t}\n\n\t\tif (response.status !== 200) {\n\t\t\tthrow new Error(response.statusText);\n\t\t}\n\n\t\t// fetch JS sources as text and create a new function around it\n\t\tconst source = await response.text();\n\t\t// Here we append #vscode-extension to serve as a marker, such that source maps\n\t\t// can be adjusted for the extra wrapping function.\n\t\tconst sourceURL = `${module.toString(true)}#vscode-extension`;\n\t\tconst fullSource = `${source}\\n//# sourceURL=${sourceURL}`;\n\t\tlet initFn: Function;\n\t\ttry {\n\t\t\tinitFn = new Function('module', 'exports', 'require', fullSource);\n\t\t} catch (err) {\n\t\t\tif (extensionId) {\n\t\t\t\tconsole.error(`Loading code for extension ${extensionId.value} failed: ${err.message}`);\n\t\t\t} else {\n\t\t\t\tconsole.error(`Loading code failed: ${err.message}`);\n\t\t\t}\n\t\t\tconsole.error(`${module.toString(true)}${typeof err.line === 'number' ? ` line ${err.line}` : ''}${typeof err.column === 'number' ? ` column ${err.column}` : ''}`);\n\t\t\tconsole.error(err);\n\t\t\tthrow err;\n\t\t}\n\n\t\t// define commonjs globals: `module`, `exports`, and `require`\n\t\tconst _exports = {};\n\t\tconst _module = { exports: _exports };\n\t\tconst _require = (request: string) => {\n\t\t\tconst result = this._fakeModules!.getModule(request, module);\n\t\t\tif (result === undefined) {\n\t\t\t\tthrow new Error(`Cannot load module '${request}'`);\n\t\t\t}\n\t\t\treturn result;\n\t\t};\n\n\t\ttry {\n\t\t\tactivationTimesBuilder.codeLoadingStart();\n\t\t\tif (extensionId) {\n\t\t\t\tperformance.mark(`code/extHost/willLoadExtensionCode/${extensionId.value}`);\n\t\t\t}\n\t\t\tinitFn(_module, _exports, _require);\n\t\t\treturn <T>(_module.exports !== _exports ? _module.exports : _exports);\n\t\t} finally {\n\t\t\tif (extensionId) {\n\t\t\t\tperformance.mark(`code/extHost/didLoadExtensionCode/${extensionId.value}`);\n\t\t\t}\n\t\t\tactivationTimesBuilder.codeLoadingStop();\n\t\t}\n\t}\n\n\tasync $setRemoteEnvironment(_env: { [key: string]: string | null }): Promise<void> {\n\t\treturn;\n\t}\n\n\tprivate async _waitForDebuggerAttachment(waitTimeout = 5000) {\n\t\t// debugger attaches async, waiting for it fixes #106698 and #99222\n\t\tif (!this._initData.environment.isExtensionDevelopmentDebug) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst deadline = Date.now() + waitTimeout;\n\t\twhile (Date.now() < deadline && !('__jsDebugIsReady' in globalThis)) {\n\t\t\tawait timeout(10);\n\t\t}\n\t}\n}\n\nfunction ensureSuffix(path: string, suffix: string): string {\n\treturn path.endsWith(suffix) ? path : path + suffix;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { registerSingleton } from 'vs/platform/instantiation/common/extensions';\nimport { IExtHostExtensionService } from 'vs/workbench/api/common/extHostExtensionService';\nimport { ExtensionStoragePaths, IExtensionStoragePaths } from 'vs/workbench/api/common/extHostStoragePaths';\nimport { ExtHostExtensionService } from 'vs/workbench/api/worker/extHostExtensionService';\n\n// #########################################################################\n// ###                                                                   ###\n// ### !!! PLEASE ADD COMMON IMPORTS INTO extHost.common.services.ts !!! ###\n// ###                                                                   ###\n// #########################################################################\n\nregisterSingleton(IExtHostExtensionService, ExtHostExtensionService);\nregisterSingleton(IExtensionStoragePaths, ExtensionStoragePaths);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IMessagePassingProtocol } from 'vs/base/parts/ipc/common/ipc';\nimport { VSBuffer } from 'vs/base/common/buffer';\nimport { Emitter } from 'vs/base/common/event';\nimport { isMessageOfType, MessageType, createMessageOfType, IExtensionHostInitData } from 'vs/workbench/services/extensions/common/extensionHostProtocol';\nimport { ExtensionHostMain } from 'vs/workbench/api/common/extensionHostMain';\nimport { IHostUtils } from 'vs/workbench/api/common/extHostExtensionService';\nimport { NestedWorker } from 'vs/workbench/services/extensions/worker/polyfillNestedWorker';\nimport * as path from 'vs/base/common/path';\nimport * as performance from 'vs/base/common/performance';\n\nimport 'vs/workbench/api/common/extHost.common.services';\nimport 'vs/workbench/api/worker/extHost.worker.services';\nimport { FileAccess } from 'vs/base/common/network';\nimport { URI } from 'vs/base/common/uri';\n\n//#region --- Define, capture, and override some globals\n\ndeclare function postMessage(data: any, transferables?: Transferable[]): void;\n\ndeclare type _Fetch = typeof fetch;\n\ndeclare namespace self {\n\tlet close: any;\n\tlet postMessage: any;\n\tlet addEventListener: any;\n\tlet removeEventListener: any;\n\tlet dispatchEvent: any;\n\tlet indexedDB: { open: any;[k: string]: any };\n\tlet caches: { open: any;[k: string]: any };\n\tlet importScripts: any;\n\tlet fetch: _Fetch;\n\tlet XMLHttpRequest: any;\n}\n\nconst nativeClose = self.close.bind(self);\nself.close = () => console.trace(`'close' has been blocked`);\n\nconst nativePostMessage = postMessage.bind(self);\nself.postMessage = () => console.trace(`'postMessage' has been blocked`);\n\nfunction shouldTransformUri(uri: string): boolean {\n\t// In principle, we could convert any URI, but we have concerns\n\t// that parsing https URIs might end up decoding escape characters\n\t// and result in an unintended transformation\n\treturn /^(file|vscode-remote):/i.test(uri);\n}\n\nconst nativeFetch = fetch.bind(self);\nfunction patchFetching(asBrowserUri: (uri: URI) => Promise<URI>) {\n\tself.fetch = async function (input, init) {\n\t\tif (input instanceof Request) {\n\t\t\t// Request object - massage not supported\n\t\t\treturn nativeFetch(input, init);\n\t\t}\n\t\tif (shouldTransformUri(String(input))) {\n\t\t\tinput = (await asBrowserUri(URI.parse(String(input)))).toString(true);\n\t\t}\n\t\treturn nativeFetch(input, init);\n\t};\n\n\tself.XMLHttpRequest = class extends XMLHttpRequest {\n\t\toverride open(method: string, url: string | URL, async?: boolean, username?: string | null, password?: string | null): void {\n\t\t\t(async () => {\n\t\t\t\tif (shouldTransformUri(url.toString())) {\n\t\t\t\t\turl = (await asBrowserUri(URI.parse(url.toString()))).toString(true);\n\t\t\t\t}\n\t\t\t\tsuper.open(method, url, async ?? true, username, password);\n\t\t\t})();\n\t\t}\n\t};\n}\n\nself.importScripts = () => { throw new Error(`'importScripts' has been blocked`); };\n\n// const nativeAddEventListener = addEventListener.bind(self);\nself.addEventListener = () => console.trace(`'addEventListener' has been blocked`);\n\n(<any>self)['AMDLoader'] = undefined;\n(<any>self)['NLSLoaderPlugin'] = undefined;\n(<any>self)['define'] = undefined;\n(<any>self)['require'] = undefined;\n(<any>self)['webkitRequestFileSystem'] = undefined;\n(<any>self)['webkitRequestFileSystemSync'] = undefined;\n(<any>self)['webkitResolveLocalFileSystemSyncURL'] = undefined;\n(<any>self)['webkitResolveLocalFileSystemURL'] = undefined;\n\nif ((<any>self).Worker) {\n\n\t// make sure new Worker(...) always uses blob: (to maintain current origin)\n\tconst _Worker = (<any>self).Worker;\n\tWorker = <any>function (stringUrl: string | URL, options?: WorkerOptions) {\n\t\tif (/^file:/i.test(stringUrl.toString())) {\n\t\t\tstringUrl = FileAccess.asBrowserUri(URI.parse(stringUrl.toString())).toString(true);\n\t\t} else if (/^vscode-remote:/i.test(stringUrl.toString())) {\n\t\t\t// Supporting transformation of vscode-remote URIs requires an async call to the main thread,\n\t\t\t// but we cannot do this call from within the embedded Worker, and the only way out would be\n\t\t\t// to use templating instead of a function in the web api (`resourceUriProvider`)\n\t\t\tthrow new Error(`Creating workers from remote extensions is currently not supported.`);\n\t\t}\n\n\t\t// IMPORTANT: bootstrapFn is stringified and injected as worker blob-url. Because of that it CANNOT\n\t\t// have dependencies on other functions or variables. Only constant values are supported. Due to\n\t\t// that logic of FileAccess.asBrowserUri had to be copied, see `asWorkerBrowserUrl` (below).\n\t\tconst bootstrapFnSource = (function bootstrapFn(workerUrl: string) {\n\t\t\tfunction asWorkerBrowserUrl(url: string | URL | TrustedScriptURL): any {\n\t\t\t\tif (typeof url === 'string' || url instanceof URL) {\n\t\t\t\t\treturn String(url).replace(/^file:\\/\\//i, 'vscode-file://vscode-app');\n\t\t\t\t}\n\t\t\t\treturn url;\n\t\t\t}\n\n\t\t\tconst nativeFetch = fetch.bind(self);\n\t\t\tself.fetch = function (input, init) {\n\t\t\t\tif (input instanceof Request) {\n\t\t\t\t\t// Request object - massage not supported\n\t\t\t\t\treturn nativeFetch(input, init);\n\t\t\t\t}\n\t\t\t\treturn nativeFetch(asWorkerBrowserUrl(input), init);\n\t\t\t};\n\t\t\tself.XMLHttpRequest = class extends XMLHttpRequest {\n\t\t\t\toverride open(method: string, url: string | URL, async?: boolean, username?: string | null, password?: string | null): void {\n\t\t\t\t\treturn super.open(method, asWorkerBrowserUrl(url), async ?? true, username, password);\n\t\t\t\t}\n\t\t\t};\n\t\t\tconst nativeImportScripts = importScripts.bind(self);\n\t\t\tself.importScripts = (...urls: string[]) => {\n\t\t\t\tnativeImportScripts(...urls.map(asWorkerBrowserUrl));\n\t\t\t};\n\n\t\t\tnativeImportScripts(workerUrl);\n\t\t}).toString();\n\n\t\tconst js = `(${bootstrapFnSource}('${stringUrl}'))`;\n\t\toptions = options || {};\n\t\toptions.name = options.name || path.basename(stringUrl.toString());\n\t\tconst blob = new Blob([js], { type: 'application/javascript' });\n\t\tconst blobUrl = URL.createObjectURL(blob);\n\t\treturn new _Worker(blobUrl, options);\n\t};\n\n} else {\n\t(<any>self).Worker = class extends NestedWorker {\n\t\tconstructor(stringOrUrl: string | URL, options?: WorkerOptions) {\n\t\t\tsuper(nativePostMessage, stringOrUrl, { name: path.basename(stringOrUrl.toString()), ...options });\n\t\t}\n\t};\n}\n\n//#endregion ---\n\nconst hostUtil = new class implements IHostUtils {\n\tdeclare readonly _serviceBrand: undefined;\n\tpublic readonly pid = undefined;\n\texit(_code?: number | undefined): void {\n\t\tnativeClose();\n\t}\n\tasync exists(_path: string): Promise<boolean> {\n\t\treturn true;\n\t}\n\tasync realpath(path: string): Promise<string> {\n\t\treturn path;\n\t}\n};\n\n\nclass ExtensionWorker {\n\n\t// protocol\n\treadonly protocol: IMessagePassingProtocol;\n\n\tconstructor() {\n\n\t\tconst channel = new MessageChannel();\n\t\tconst emitter = new Emitter<VSBuffer>();\n\t\tlet terminating = false;\n\n\t\t// send over port2, keep port1\n\t\tnativePostMessage(channel.port2, [channel.port2]);\n\n\t\tchannel.port1.onmessage = event => {\n\t\t\tconst { data } = event;\n\t\t\tif (!(data instanceof ArrayBuffer)) {\n\t\t\t\tconsole.warn('UNKNOWN data received', data);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst msg = VSBuffer.wrap(new Uint8Array(data, 0, data.byteLength));\n\t\t\tif (isMessageOfType(msg, MessageType.Terminate)) {\n\t\t\t\t// handle terminate-message right here\n\t\t\t\tterminating = true;\n\t\t\t\tonTerminate('received terminate message from renderer');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// emit non-terminate messages to the outside\n\t\t\temitter.fire(msg);\n\t\t};\n\n\t\tthis.protocol = {\n\t\t\tonMessage: emitter.event,\n\t\t\tsend: vsbuf => {\n\t\t\t\tif (!terminating) {\n\t\t\t\t\tconst data = vsbuf.buffer.buffer.slice(vsbuf.buffer.byteOffset, vsbuf.buffer.byteOffset + vsbuf.buffer.byteLength);\n\t\t\t\t\tchannel.port1.postMessage(data, [data]);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n}\n\ninterface IRendererConnection {\n\tprotocol: IMessagePassingProtocol;\n\tinitData: IExtensionHostInitData;\n}\nfunction connectToRenderer(protocol: IMessagePassingProtocol): Promise<IRendererConnection> {\n\treturn new Promise<IRendererConnection>(resolve => {\n\t\tconst once = protocol.onMessage(raw => {\n\t\t\tonce.dispose();\n\t\t\tconst initData = <IExtensionHostInitData>JSON.parse(raw.toString());\n\t\t\tprotocol.send(createMessageOfType(MessageType.Initialized));\n\t\t\tresolve({ protocol, initData });\n\t\t});\n\t\tprotocol.send(createMessageOfType(MessageType.Ready));\n\t});\n}\n\nlet onTerminate = (reason: string) => nativeClose();\n\ninterface IInitMessage {\n\treadonly type: 'vscode.init';\n\treadonly data: ReadonlyMap<string, MessagePort>;\n}\n\nfunction isInitMessage(a: any): a is IInitMessage {\n\treturn !!a && typeof a === 'object' && a.type === 'vscode.init' && a.data instanceof Map;\n}\n\nexport function create(): { onmessage: (message: any) => void } {\n\tperformance.mark(`code/extHost/willConnectToRenderer`);\n\tconst res = new ExtensionWorker();\n\n\treturn {\n\t\tonmessage(message: any) {\n\t\t\tif (!isInitMessage(message)) {\n\t\t\t\treturn; // silently ignore foreign messages\n\t\t\t}\n\n\t\t\tconnectToRenderer(res.protocol).then(data => {\n\t\t\t\tperformance.mark(`code/extHost/didWaitForInitData`);\n\t\t\t\tconst extHostMain = new ExtensionHostMain(\n\t\t\t\t\tdata.protocol,\n\t\t\t\t\tdata.initData,\n\t\t\t\t\thostUtil,\n\t\t\t\t\tnull,\n\t\t\t\t\tmessage.data\n\t\t\t\t);\n\n\t\t\t\tpatchFetching(uri => extHostMain.asBrowserUri(uri));\n\n\t\t\t\tonTerminate = (reason: string) => extHostMain.terminate(reason);\n\t\t\t});\n\t\t}\n\t};\n}\n"],"mappings":"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","names":[],"file":"extensionHostWorker.js"}